Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id 67FAF42A231
	for <lists+qemu-devel@lfdr.de>; Tue, 12 Oct 2021 12:34:14 +0200 (CEST)
Received: from localhost ([::1]:42408 helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>)
	id 1maF6r-0004nK-Fx
	for lists+qemu-devel@lfdr.de; Tue, 12 Oct 2021 06:34:13 -0400
Received: from eggs.gnu.org ([2001:470:142:3::10]:50372)
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1maEl0-0000aP-J1
 for qemu-devel@nongnu.org; Tue, 12 Oct 2021 06:11:40 -0400
Received: from alexa-out-sd-02.qualcomm.com ([199.106.114.39]:64084)
 by eggs.gnu.org with esmtps (TLS1.2:RSA_AES_256_CBC_SHA1:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1maEkx-0006yI-A4
 for qemu-devel@nongnu.org; Tue, 12 Oct 2021 06:11:38 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=quicinc.com; i=@quicinc.com; q=dns/txt; s=qcdkim;
 t=1634033495; x=1665569495;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version:content-transfer-encoding;
 bh=zDEi7v7WMqd9gW84fqKaNv8xkilLQNuceISmGJOqKaE=;
 b=GCPXR44+hAm+/Lt2xRoIF++wBqMqUyZDIvyUR+y6MwEonN5P0pA68ScH
 wEd65ZYokLzaed6hCCulYMPjP7/vOYxLznPniKT9WYepasJWxa8Qjtn0b
 BkBdGTNC/StGq54clz4JKJ4k0g19HhcXbHMbD/+hnMVeWxpc7ndLXSLxb 8=;
Received: from unknown (HELO ironmsg01-sd.qualcomm.com) ([10.53.140.141])
 by alexa-out-sd-02.qualcomm.com with ESMTP; 12 Oct 2021 03:11:24 -0700
X-QCInternal: smtphost
Received: from vu-tsimpson-aus.qualcomm.com (HELO
 vu-tsimpson1-aus.qualcomm.com) ([10.222.150.1])
 by ironmsg01-sd.qualcomm.com with ESMTP; 12 Oct 2021 03:11:23 -0700
Received: by vu-tsimpson1-aus.qualcomm.com (Postfix, from userid 47164)
 id 53BE614DD; Tue, 12 Oct 2021 05:11:22 -0500 (CDT)
From: Taylor Simpson <tsimpson@quicinc.com>
To: qemu-devel@nongnu.org
Subject: [PATCH v4 11/30] Hexagon HVX (target/hexagon) helper functions
Date: Tue, 12 Oct 2021 05:10:49 -0500
Message-Id: <1634033468-23566-12-git-send-email-tsimpson@quicinc.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1634033468-23566-1-git-send-email-tsimpson@quicinc.com>
References: <1634033468-23566-1-git-send-email-tsimpson@quicinc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Received-SPF: pass client-ip=199.106.114.39;
 envelope-from=tsimpson@qualcomm.com; helo=alexa-out-sd-02.qualcomm.com
X-Spam_score_int: -40
X-Spam_score: -4.1
X-Spam_bar: ----
X-Spam_report: (-4.1 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, HEADER_FROM_DIFFERENT_DOMAINS=0.249,
 RCVD_IN_DNSWL_MED=-2.3, SPF_HELO_NONE=0.001,
 SPF_PASS=-0.001 autolearn=ham autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Cc: ale@rev.ng, bcain@quicinc.com, tsimpson@quicinc.com,
 richard.henderson@linaro.org, f4bug@amsat.org
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: "Qemu-devel" <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>

UHJvYmUgYW5kIGNvbW1pdCB2ZWN0b3Igc3RvcmVzIChtYXNrZWQgYW5kIHNjYXR0ZXIvZ2F0aGVy
KQpMb2cgdmVjdG9yIHJlZ2lzdGVyIHdyaXRlcwpBZGQgdGhlIGV4ZWN1dGlvbiBjb3VudGVycyB0
byB0aGUgZGVidWcgbG9nCkhpc3RvZ3JhbSBpbnN0cnVjdGlvbnMKClNpZ25lZC1vZmYtYnk6IFRh
eWxvciBTaW1wc29uIDx0c2ltcHNvbkBxdWljaW5jLmNvbT4KLS0tCiB0YXJnZXQvaGV4YWdvbi9o
ZWxwZXIuaCAgICB8ICAxNiArKysKIHRhcmdldC9oZXhhZ29uL29wX2hlbHBlci5jIHwgMjgyICsr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrLQogMiBmaWxlcyBjaGFu
Z2VkLCAyOTYgaW5zZXJ0aW9ucygrKSwgMiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS90YXJn
ZXQvaGV4YWdvbi9oZWxwZXIuaCBiL3RhcmdldC9oZXhhZ29uL2hlbHBlci5oCmluZGV4IDg5ZGUy
YTMuLmM4OWFhNGUgMTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29uL2hlbHBlci5oCisrKyBiL3Rh
cmdldC9oZXhhZ29uL2hlbHBlci5oCkBAIC0yMyw2ICsyMyw4IEBAIERFRl9IRUxQRVJfMShkZWJ1
Z19zdGFydF9wYWNrZXQsIHZvaWQsIGVudikKIERFRl9IRUxQRVJfRkxBR1NfMyhkZWJ1Z19jaGVj
a19zdG9yZV93aWR0aCwgVENHX0NBTExfTk9fV0csIHZvaWQsIGVudiwgaW50LCBpbnQpCiBERUZf
SEVMUEVSX0ZMQUdTXzMoZGVidWdfY29tbWl0X2VuZCwgVENHX0NBTExfTk9fV0csIHZvaWQsIGVu
diwgaW50LCBpbnQpCiBERUZfSEVMUEVSXzIoY29tbWl0X3N0b3JlLCB2b2lkLCBlbnYsIGludCkK
K0RFRl9IRUxQRVJfMyhnYXRoZXJfc3RvcmUsIHZvaWQsIGVudiwgaTMyLCBpbnQpCitERUZfSEVM
UEVSXzEoY29tbWl0X2h2eF9zdG9yZXMsIHZvaWQsIGVudikKIERFRl9IRUxQRVJfRkxBR1NfNChm
Y2lyY2FkZCwgVENHX0NBTExfTk9fUldHX1NFLCBzMzIsIHMzMiwgczMyLCBzMzIsIHMzMikKIERF
Rl9IRUxQRVJfRkxBR1NfMShmYnJldiwgVENHX0NBTExfTk9fUldHX1NFLCBpMzIsIGkzMikKIERF
Rl9IRUxQRVJfMyhzZnJlY2lwYSwgaTY0LCBlbnYsIGYzMiwgZjMyKQpAQCAtOTAsNCArOTIsMTgg
QEAgREVGX0hFTFBFUl80KHNmZm1zX2xpYiwgZjMyLCBlbnYsIGYzMiwgZjMyLCBmMzIpCiBERUZf
SEVMUEVSXzMoZGZtcHlmaXgsIGY2NCwgZW52LCBmNjQsIGY2NCkKIERFRl9IRUxQRVJfNChkZm1w
eWhoLCBmNjQsIGVudiwgZjY0LCBmNjQsIGY2NCkKIAorLyogSGlzdG9ncmFtIGluc3RydWN0aW9u
cyAqLworREVGX0hFTFBFUl8xKHZoaXN0LCB2b2lkLCBlbnYpCitERUZfSEVMUEVSXzEodmhpc3Rx
LCB2b2lkLCBlbnYpCitERUZfSEVMUEVSXzEodndoaXN0MjU2LCB2b2lkLCBlbnYpCitERUZfSEVM
UEVSXzEodndoaXN0MjU2cSwgdm9pZCwgZW52KQorREVGX0hFTFBFUl8xKHZ3aGlzdDI1Nl9zYXQs
IHZvaWQsIGVudikKK0RFRl9IRUxQRVJfMSh2d2hpc3QyNTZxX3NhdCwgdm9pZCwgZW52KQorREVG
X0hFTFBFUl8xKHZ3aGlzdDEyOCwgdm9pZCwgZW52KQorREVGX0hFTFBFUl8xKHZ3aGlzdDEyOHEs
IHZvaWQsIGVudikKK0RFRl9IRUxQRVJfMih2d2hpc3QxMjhtLCB2b2lkLCBlbnYsIHMzMikKK0RF
Rl9IRUxQRVJfMih2d2hpc3QxMjhxbSwgdm9pZCwgZW52LCBzMzIpCisKIERFRl9IRUxQRVJfMihw
cm9iZV9wa3Rfc2NhbGFyX3N0b3JlX3MwLCB2b2lkLCBlbnYsIGludCkKK0RFRl9IRUxQRVJfMihw
cm9iZV9odnhfc3RvcmVzLCB2b2lkLCBlbnYsIGludCkKK0RFRl9IRUxQRVJfMyhwcm9iZV9wa3Rf
c2NhbGFyX2h2eF9zdG9yZXMsIHZvaWQsIGVudiwgaW50LCBpbnQpCmRpZmYgLS1naXQgYS90YXJn
ZXQvaGV4YWdvbi9vcF9oZWxwZXIuYyBiL3RhcmdldC9oZXhhZ29uL29wX2hlbHBlci5jCmluZGV4
IGFmMzJkZTQuLmE2N2ExNDggMTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29uL29wX2hlbHBlci5j
CisrKyBiL3RhcmdldC9oZXhhZ29uL29wX2hlbHBlci5jCkBAIC0yNyw2ICsyNyw4IEBACiAjaW5j
bHVkZSAiYXJjaC5oIgogI2luY2x1ZGUgImhleF9hcmNoX3R5cGVzLmgiCiAjaW5jbHVkZSAiZm1h
X2VtdS5oIgorI2luY2x1ZGUgIm1tdmVjL21tdmVjLmgiCisjaW5jbHVkZSAibW12ZWMvbWFjcm9z
LmgiCiAKICNkZWZpbmUgU0ZfQklBUyAgICAgICAgMTI3CiAjZGVmaW5lIFNGX01BTlRCSVRTICAg
IDIzCkBAIC0xNjQsNiArMTY2LDU3IEBAIHZvaWQgSEVMUEVSKGNvbW1pdF9zdG9yZSkoQ1BVSGV4
YWdvblN0YXRlICplbnYsIGludCBzbG90X251bSkKICAgICB9CiB9CiAKK3ZvaWQgSEVMUEVSKGdh
dGhlcl9zdG9yZSkoQ1BVSGV4YWdvblN0YXRlICplbnYsIHVpbnQzMl90IGFkZHIsIGludCBzbG90
KQoreworICAgIG1lbV9nYXRoZXJfc3RvcmUoZW52LCBhZGRyLCBzbG90KTsKK30KKwordm9pZCBI
RUxQRVIoY29tbWl0X2h2eF9zdG9yZXMpKENQVUhleGFnb25TdGF0ZSAqZW52KQoreworICAgIHVp
bnRwdHJfdCByYSA9IEdFVFBDKCk7CisgICAgaW50IGk7CisKKyAgICAvKiBOb3JtYWwgKHBvc3Np
Ymx5IG1hc2tlZCkgdmVjdG9yIHN0b3JlICovCisgICAgZm9yIChpID0gMDsgaSA8IFZTVE9SRVNf
TUFYOyBpKyspIHsKKyAgICAgICAgaWYgKGVudi0+dnN0b3JlX3BlbmRpbmdbaV0pIHsKKyAgICAg
ICAgICAgIGVudi0+dnN0b3JlX3BlbmRpbmdbaV0gPSAwOworICAgICAgICAgICAgdGFyZ2V0X3Vs
b25nIHZhID0gZW52LT52c3RvcmVbaV0udmE7CisgICAgICAgICAgICBpbnQgc2l6ZSA9IGVudi0+
dnN0b3JlW2ldLnNpemU7CisgICAgICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IHNpemU7IGor
KykgeworICAgICAgICAgICAgICAgIGlmICh0ZXN0X2JpdChqLCBlbnYtPnZzdG9yZVtpXS5tYXNr
KSkgeworICAgICAgICAgICAgICAgICAgICBjcHVfc3RiX2RhdGFfcmEoZW52LCB2YSArIGosIGVu
di0+dnN0b3JlW2ldLmRhdGEudWJbal0sIHJhKTsKKyAgICAgICAgICAgICAgICB9CisgICAgICAg
ICAgICB9CisgICAgICAgIH0KKyAgICB9CisKKyAgICAvKiBTY2F0dGVyIHN0b3JlICovCisgICAg
aWYgKGVudi0+dnRjbV9wZW5kaW5nKSB7CisgICAgICAgIGVudi0+dnRjbV9wZW5kaW5nID0gZmFs
c2U7CisgICAgICAgIGlmIChlbnYtPnZ0Y21fbG9nLm9wKSB7CisgICAgICAgICAgICAvKiBOZWVk
IHRvIHBlcmZvcm0gdGhlIHNjYXR0ZXIgcmVhZC9tb2RpZnkvd3JpdGUgYXQgY29tbWl0IHRpbWUg
Ki8KKyAgICAgICAgICAgIGlmIChlbnYtPnZ0Y21fbG9nLm9wX3NpemUgPT0gMikgeworICAgICAg
ICAgICAgICAgIFNDQVRURVJfT1BfV1JJVEVfVE9fTUVNKHVpbnQxNl90KTsKKyAgICAgICAgICAg
IH0gZWxzZSBpZiAoZW52LT52dGNtX2xvZy5vcF9zaXplID09IDQpIHsKKyAgICAgICAgICAgICAg
ICAvKiBXb3JkIFNjYXR0ZXIgKz0gKi8KKyAgICAgICAgICAgICAgICBTQ0FUVEVSX09QX1dSSVRF
X1RPX01FTSh1aW50MzJfdCk7CisgICAgICAgICAgICB9IGVsc2UgeworICAgICAgICAgICAgICAg
IGdfYXNzZXJ0X25vdF9yZWFjaGVkKCk7CisgICAgICAgICAgICB9CisgICAgICAgIH0gZWxzZSB7
CisgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgZW52LT52dGNtX2xvZy5zaXplOyBpKyspIHsK
KyAgICAgICAgICAgICAgICBpZiAodGVzdF9iaXQoaSwgZW52LT52dGNtX2xvZy5tYXNrKSkgewor
ICAgICAgICAgICAgICAgICAgICBjcHVfc3RiX2RhdGFfcmEoZW52LCBlbnYtPnZ0Y21fbG9nLnZh
W2ldLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW52LT52dGNtX2xvZy5k
YXRhLnViW2ldLCByYSk7CisgICAgICAgICAgICAgICAgICAgIGNsZWFyX2JpdChpLCBlbnYtPnZ0
Y21fbG9nLm1hc2spOworICAgICAgICAgICAgICAgICAgICBlbnYtPnZ0Y21fbG9nLmRhdGEudWJb
aV0gPSAwOworICAgICAgICAgICAgICAgIH0KKworICAgICAgICAgICAgfQorICAgICAgICB9Cisg
ICAgfQorfQorCiBzdGF0aWMgdm9pZCBwcmludF9zdG9yZShDUFVIZXhhZ29uU3RhdGUgKmVudiwg
aW50IHNsb3QpCiB7CiAgICAgaWYgKCEoZW52LT5zbG90X2NhbmNlbGxlZCAmICgxIDw8IHNsb3Qp
KSkgewpAQCAtMjQyLDkgKzI5NSwxMCBAQCB2b2lkIEhFTFBFUihkZWJ1Z19jb21taXRfZW5kKShD
UFVIZXhhZ29uU3RhdGUgKmVudiwgaW50IGhhc19zdDAsIGludCBoYXNfc3QxKQogICAgIEhFWF9E
RUJVR19MT0coIk5leHQgUEMgPSAiIFRBUkdFVF9GTVRfbHggIlxuIiwgZW52LT5uZXh0X1BDKTsK
ICAgICBIRVhfREVCVUdfTE9HKCJFeGVjIGNvdW50ZXJzOiBwa3QgPSAiIFRBUkdFVF9GTVRfbHgK
ICAgICAgICAgICAgICAgICAgICIsIGluc24gPSAiIFRBUkdFVF9GTVRfbHgKLSAgICAgICAgICAg
ICAgICAgICJcbiIsCisgICAgICAgICAgICAgICAgICAiLCBodnggPSAiIFRBUkdFVF9GTVRfbHgg
IlxuIiwKICAgICAgICAgICAgICAgICAgIGVudi0+Z3ByW0hFWF9SRUdfUUVNVV9QS1RfQ05UXSwK
LSAgICAgICAgICAgICAgICAgIGVudi0+Z3ByW0hFWF9SRUdfUUVNVV9JTlNOX0NOVF0pOworICAg
ICAgICAgICAgICAgICAgZW52LT5ncHJbSEVYX1JFR19RRU1VX0lOU05fQ05UXSwKKyAgICAgICAg
ICAgICAgICAgIGVudi0+Z3ByW0hFWF9SRUdfUUVNVV9IVlhfQ05UXSk7CiAKIH0KIApAQCAtMzkz
LDYgKzQ0Nyw2NSBAQCB2b2lkIEhFTFBFUihwcm9iZV9wa3Rfc2NhbGFyX3N0b3JlX3MwKShDUFVI
ZXhhZ29uU3RhdGUgKmVudiwgaW50IG1tdV9pZHgpCiAgICAgcHJvYmVfc3RvcmUoZW52LCAwLCBt
bXVfaWR4KTsKIH0KIAordm9pZCBIRUxQRVIocHJvYmVfaHZ4X3N0b3JlcykoQ1BVSGV4YWdvblN0
YXRlICplbnYsIGludCBtbXVfaWR4KQoreworICAgIHVpbnRwdHJfdCByZXRhZGRyID0gR0VUUEMo
KTsKKyAgICBpbnQgaTsKKworICAgIC8qIE5vcm1hbCAocG9zc2libHkgbWFza2VkKSB2ZWN0b3Ig
c3RvcmUgKi8KKyAgICBmb3IgKGkgPSAwOyBpIDwgVlNUT1JFU19NQVg7IGkrKykgeworICAgICAg
ICBpZiAoZW52LT52c3RvcmVfcGVuZGluZ1tpXSkgeworICAgICAgICAgICAgdGFyZ2V0X3Vsb25n
IHZhID0gZW52LT52c3RvcmVbaV0udmE7CisgICAgICAgICAgICBpbnQgc2l6ZSA9IGVudi0+dnN0
b3JlW2ldLnNpemU7CisgICAgICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IHNpemU7IGorKykg
eworICAgICAgICAgICAgICAgIGlmICh0ZXN0X2JpdChqLCBlbnYtPnZzdG9yZVtpXS5tYXNrKSkg
eworICAgICAgICAgICAgICAgICAgICBwcm9iZV93cml0ZShlbnYsIHZhICsgaiwgMSwgbW11X2lk
eCwgcmV0YWRkcik7CisgICAgICAgICAgICAgICAgfQorICAgICAgICAgICAgfQorICAgICAgICB9
CisgICAgfQorCisgICAgLyogU2NhdHRlciBzdG9yZSAqLworICAgIGlmIChlbnYtPnZ0Y21fcGVu
ZGluZykgeworICAgICAgICBpZiAoZW52LT52dGNtX2xvZy5vcCkgeworICAgICAgICAgICAgLyog
TmVlZCB0byBwZXJmb3JtIHRoZSBzY2F0dGVyIHJlYWQvbW9kaWZ5L3dyaXRlIGF0IGNvbW1pdCB0
aW1lICovCisgICAgICAgICAgICBpZiAoZW52LT52dGNtX2xvZy5vcF9zaXplID09IDIpIHsKKyAg
ICAgICAgICAgICAgICBTQ0FUVEVSX09QX1BST0JFX01FTShzaXplMnVfdCwgbW11X2lkeCwgcmV0
YWRkcik7CisgICAgICAgICAgICB9IGVsc2UgaWYgKGVudi0+dnRjbV9sb2cub3Bfc2l6ZSA9PSA0
KSB7CisgICAgICAgICAgICAgICAgLyogV29yZCBTY2F0dGVyICs9ICovCisgICAgICAgICAgICAg
ICAgU0NBVFRFUl9PUF9QUk9CRV9NRU0oc2l6ZTR1X3QsIG1tdV9pZHgsIHJldGFkZHIpOworICAg
ICAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgICAgICBnX2Fzc2VydF9ub3RfcmVhY2hlZCgp
OworICAgICAgICAgICAgfQorICAgICAgICB9IGVsc2UgeworICAgICAgICAgICAgZm9yIChpbnQg
aSA9IDA7IGkgPCBlbnYtPnZ0Y21fbG9nLnNpemU7IGkrKykgeworICAgICAgICAgICAgICAgIGlm
ICh0ZXN0X2JpdChpLCBlbnYtPnZ0Y21fbG9nLm1hc2spKSB7CisgICAgICAgICAgICAgICAgICAg
IHByb2JlX3dyaXRlKGVudiwgZW52LT52dGNtX2xvZy52YVtpXSwgMSwgbW11X2lkeCwgcmV0YWRk
cik7CisgICAgICAgICAgICAgICAgfQorCisgICAgICAgICAgICB9CisgICAgICAgIH0KKyAgICB9
Cit9CisKK3ZvaWQgSEVMUEVSKHByb2JlX3BrdF9zY2FsYXJfaHZ4X3N0b3JlcykoQ1BVSGV4YWdv
blN0YXRlICplbnYsIGludCBtYXNrLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBpbnQgbW11X2lkeCkKK3sKKyAgICBib29sIGhhc19zdDAgICAgICAgID0gKG1hc2sg
Pj4gMCkgJiAxOworICAgIGJvb2wgaGFzX3N0MSAgICAgICAgPSAobWFzayA+PiAxKSAmIDE7Cisg
ICAgYm9vbCBoYXNfaHZ4X3N0b3JlcyA9IChtYXNrID4+IDIpICYgMTsKKworICAgIGlmIChoYXNf
c3QwKSB7CisgICAgICAgIHByb2JlX3N0b3JlKGVudiwgMCwgbW11X2lkeCk7CisgICAgfQorICAg
IGlmIChoYXNfc3QxKSB7CisgICAgICAgIHByb2JlX3N0b3JlKGVudiwgMSwgbW11X2lkeCk7Cisg
ICAgfQorICAgIGlmIChoYXNfaHZ4X3N0b3JlcykgeworICAgICAgICBIRUxQRVIocHJvYmVfaHZ4
X3N0b3JlcykoZW52LCBtbXVfaWR4KTsKKyAgICB9Cit9CisKIC8qCiAgKiBtZW1fbm9zaHVmCiAg
KiBTZWN0aW9uIDUuNSBvZiB0aGUgSGV4YWdvbiBWNjcgUHJvZ3JhbW1lcidzIFJlZmVyZW5jZSBN
YW51YWwKQEAgLTExODEsNiArMTI5NCwxNzEgQEAgZmxvYXQ2NCBIRUxQRVIoZGZtcHloaCkoQ1BV
SGV4YWdvblN0YXRlICplbnYsIGZsb2F0NjQgUnh4ViwKICAgICByZXR1cm4gUnh4VjsKIH0KIAor
LyogSGlzdG9ncmFtIGluc3RydWN0aW9ucyAqLworCit2b2lkIEhFTFBFUih2aGlzdCkoQ1BVSGV4
YWdvblN0YXRlICplbnYpCit7CisgICAgTU1WZWN0b3IgKmlucHV0ID0gJmVudi0+dG1wX1ZSZWdz
WzBdOworCisgICAgZm9yIChpbnQgbGFuZSA9IDA7IGxhbmUgPCA4OyBsYW5lKyspIHsKKyAgICAg
ICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzaXplb2YoTU1WZWN0b3IpIC8gODsgKytpKSB7CisgICAg
ICAgICAgICB1bnNpZ25lZCBjaGFyIHZhbHVlID0gaW5wdXQtPnViWyhzaXplb2YoTU1WZWN0b3Ip
IC8gOCkgKiBsYW5lICsgaV07CisgICAgICAgICAgICB1bnNpZ25lZCBjaGFyIHJlZ25vID0gdmFs
dWUgPj4gMzsKKyAgICAgICAgICAgIHVuc2lnbmVkIGNoYXIgZWxlbWVudCA9IHZhbHVlICYgNzsK
KworICAgICAgICAgICAgZW52LT5WUmVnc1tyZWdub10udWhbKHNpemVvZihNTVZlY3RvcikgLyAx
NikgKiBsYW5lICsgZWxlbWVudF0rKzsKKyAgICAgICAgfQorICAgIH0KK30KKwordm9pZCBIRUxQ
RVIodmhpc3RxKShDUFVIZXhhZ29uU3RhdGUgKmVudikKK3sKKyAgICBNTVZlY3RvciAqaW5wdXQg
PSAmZW52LT50bXBfVlJlZ3NbMF07CisKKyAgICBmb3IgKGludCBsYW5lID0gMDsgbGFuZSA8IDg7
IGxhbmUrKykgeworICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHNpemVvZihNTVZlY3Rvcikg
LyA4OyArK2kpIHsKKyAgICAgICAgICAgIHVuc2lnbmVkIGNoYXIgdmFsdWUgPSBpbnB1dC0+dWJb
KHNpemVvZihNTVZlY3RvcikgLyA4KSAqIGxhbmUgKyBpXTsKKyAgICAgICAgICAgIHVuc2lnbmVk
IGNoYXIgcmVnbm8gPSB2YWx1ZSA+PiAzOworICAgICAgICAgICAgdW5zaWduZWQgY2hhciBlbGVt
ZW50ID0gdmFsdWUgJiA3OworCisgICAgICAgICAgICBpZiAoZkdFVFFCSVQoZW52LT5xdG1wLCBz
aXplb2YoTU1WZWN0b3IpIC8gOCAqIGxhbmUgKyBpKSkgeworICAgICAgICAgICAgICAgIGVudi0+
VlJlZ3NbcmVnbm9dLnVoWworICAgICAgICAgICAgICAgICAgICAoc2l6ZW9mKE1NVmVjdG9yKSAv
IDE2KSAqIGxhbmUgKyBlbGVtZW50XSsrOworICAgICAgICAgICAgfQorICAgICAgICB9CisgICAg
fQorfQorCit2b2lkIEhFTFBFUih2d2hpc3QyNTYpKENQVUhleGFnb25TdGF0ZSAqZW52KQorewor
ICAgIE1NVmVjdG9yICppbnB1dCA9ICZlbnYtPnRtcF9WUmVnc1swXTsKKworICAgIGZvciAoaW50
IGkgPSAwOyBpIDwgKHNpemVvZihNTVZlY3RvcikgLyAyKTsgaSsrKSB7CisgICAgICAgIHVuc2ln
bmVkIGludCBidWNrZXQgPSBmR0VUVUJZVEUoMCwgaW5wdXQtPmhbaV0pOworICAgICAgICB1bnNp
Z25lZCBpbnQgd2VpZ2h0ID0gZkdFVFVCWVRFKDEsIGlucHV0LT5oW2ldKTsKKyAgICAgICAgdW5z
aWduZWQgaW50IHZpbmRleCA9IChidWNrZXQgPj4gMykgJiAweDFGOworICAgICAgICB1bnNpZ25l
ZCBpbnQgZWxpbmRleCA9ICgoaSA+PiAwKSAmICh+NykpIHwgKChidWNrZXQgPj4gMCkgJiA3KTsK
KworICAgICAgICBlbnYtPlZSZWdzW3ZpbmRleF0udWhbZWxpbmRleF0gPQorICAgICAgICAgICAg
ZW52LT5WUmVnc1t2aW5kZXhdLnVoW2VsaW5kZXhdICsgd2VpZ2h0OworICAgIH0KK30KKwordm9p
ZCBIRUxQRVIodndoaXN0MjU2cSkoQ1BVSGV4YWdvblN0YXRlICplbnYpCit7CisgICAgTU1WZWN0
b3IgKmlucHV0ID0gJmVudi0+dG1wX1ZSZWdzWzBdOworCisgICAgZm9yIChpbnQgaSA9IDA7IGkg
PCAoc2l6ZW9mKE1NVmVjdG9yKSAvIDIpOyBpKyspIHsKKyAgICAgICAgdW5zaWduZWQgaW50IGJ1
Y2tldCA9IGZHRVRVQllURSgwLCBpbnB1dC0+aFtpXSk7CisgICAgICAgIHVuc2lnbmVkIGludCB3
ZWlnaHQgPSBmR0VUVUJZVEUoMSwgaW5wdXQtPmhbaV0pOworICAgICAgICB1bnNpZ25lZCBpbnQg
dmluZGV4ID0gKGJ1Y2tldCA+PiAzKSAmIDB4MUY7CisgICAgICAgIHVuc2lnbmVkIGludCBlbGlu
ZGV4ID0gKChpID4+IDApICYgKH43KSkgfCAoKGJ1Y2tldCA+PiAwKSAmIDcpOworCisgICAgICAg
IGlmIChmR0VUUUJJVChlbnYtPnF0bXAsIDIgKiBpKSkgeworICAgICAgICAgICAgZW52LT5WUmVn
c1t2aW5kZXhdLnVoW2VsaW5kZXhdID0KKyAgICAgICAgICAgICAgICBlbnYtPlZSZWdzW3ZpbmRl
eF0udWhbZWxpbmRleF0gKyB3ZWlnaHQ7CisgICAgICAgIH0KKyAgICB9Cit9CisKK3ZvaWQgSEVM
UEVSKHZ3aGlzdDI1Nl9zYXQpKENQVUhleGFnb25TdGF0ZSAqZW52KQoreworICAgIE1NVmVjdG9y
ICppbnB1dCA9ICZlbnYtPnRtcF9WUmVnc1swXTsKKworICAgIGZvciAoaW50IGkgPSAwOyBpIDwg
KHNpemVvZihNTVZlY3RvcikgLyAyKTsgaSsrKSB7CisgICAgICAgIHVuc2lnbmVkIGludCBidWNr
ZXQgPSBmR0VUVUJZVEUoMCwgaW5wdXQtPmhbaV0pOworICAgICAgICB1bnNpZ25lZCBpbnQgd2Vp
Z2h0ID0gZkdFVFVCWVRFKDEsIGlucHV0LT5oW2ldKTsKKyAgICAgICAgdW5zaWduZWQgaW50IHZp
bmRleCA9IChidWNrZXQgPj4gMykgJiAweDFGOworICAgICAgICB1bnNpZ25lZCBpbnQgZWxpbmRl
eCA9ICgoaSA+PiAwKSAmICh+NykpIHwgKChidWNrZXQgPj4gMCkgJiA3KTsKKworICAgICAgICBl
bnYtPlZSZWdzW3ZpbmRleF0udWhbZWxpbmRleF0gPQorICAgICAgICAgICAgZlZTQVRVSChlbnYt
PlZSZWdzW3ZpbmRleF0udWhbZWxpbmRleF0gKyB3ZWlnaHQpOworICAgIH0KK30KKwordm9pZCBI
RUxQRVIodndoaXN0MjU2cV9zYXQpKENQVUhleGFnb25TdGF0ZSAqZW52KQoreworICAgIE1NVmVj
dG9yICppbnB1dCA9ICZlbnYtPnRtcF9WUmVnc1swXTsKKworICAgIGZvciAoaW50IGkgPSAwOyBp
IDwgKHNpemVvZihNTVZlY3RvcikgLyAyKTsgaSsrKSB7CisgICAgICAgIHVuc2lnbmVkIGludCBi
dWNrZXQgPSBmR0VUVUJZVEUoMCwgaW5wdXQtPmhbaV0pOworICAgICAgICB1bnNpZ25lZCBpbnQg
d2VpZ2h0ID0gZkdFVFVCWVRFKDEsIGlucHV0LT5oW2ldKTsKKyAgICAgICAgdW5zaWduZWQgaW50
IHZpbmRleCA9IChidWNrZXQgPj4gMykgJiAweDFGOworICAgICAgICB1bnNpZ25lZCBpbnQgZWxp
bmRleCA9ICgoaSA+PiAwKSAmICh+NykpIHwgKChidWNrZXQgPj4gMCkgJiA3KTsKKworICAgICAg
ICBpZiAoZkdFVFFCSVQoZW52LT5xdG1wLCAyICogaSkpIHsKKyAgICAgICAgICAgIGVudi0+VlJl
Z3NbdmluZGV4XS51aFtlbGluZGV4XSA9CisgICAgICAgICAgICAgICAgZlZTQVRVSChlbnYtPlZS
ZWdzW3ZpbmRleF0udWhbZWxpbmRleF0gKyB3ZWlnaHQpOworICAgICAgICB9CisgICAgfQorfQor
Cit2b2lkIEhFTFBFUih2d2hpc3QxMjgpKENQVUhleGFnb25TdGF0ZSAqZW52KQoreworICAgIE1N
VmVjdG9yICppbnB1dCA9ICZlbnYtPnRtcF9WUmVnc1swXTsKKworICAgIGZvciAoaW50IGkgPSAw
OyBpIDwgKHNpemVvZihNTVZlY3RvcikgLyAyKTsgaSsrKSB7CisgICAgICAgIHVuc2lnbmVkIGlu
dCBidWNrZXQgPSBmR0VUVUJZVEUoMCwgaW5wdXQtPmhbaV0pOworICAgICAgICB1bnNpZ25lZCBp
bnQgd2VpZ2h0ID0gZkdFVFVCWVRFKDEsIGlucHV0LT5oW2ldKTsKKyAgICAgICAgdW5zaWduZWQg
aW50IHZpbmRleCA9IChidWNrZXQgPj4gMykgJiAweDFGOworICAgICAgICB1bnNpZ25lZCBpbnQg
ZWxpbmRleCA9ICgoaSA+PiAxKSAmICh+MykpIHwgKChidWNrZXQgPj4gMSkgJiAzKTsKKworICAg
ICAgICBlbnYtPlZSZWdzW3ZpbmRleF0udXdbZWxpbmRleF0gPQorICAgICAgICAgICAgZW52LT5W
UmVnc1t2aW5kZXhdLnV3W2VsaW5kZXhdICsgd2VpZ2h0OworICAgIH0KK30KKwordm9pZCBIRUxQ
RVIodndoaXN0MTI4cSkoQ1BVSGV4YWdvblN0YXRlICplbnYpCit7CisgICAgTU1WZWN0b3IgKmlu
cHV0ID0gJmVudi0+dG1wX1ZSZWdzWzBdOworCisgICAgZm9yIChpbnQgaSA9IDA7IGkgPCAoc2l6
ZW9mKE1NVmVjdG9yKSAvIDIpOyBpKyspIHsKKyAgICAgICAgdW5zaWduZWQgaW50IGJ1Y2tldCA9
IGZHRVRVQllURSgwLCBpbnB1dC0+aFtpXSk7CisgICAgICAgIHVuc2lnbmVkIGludCB3ZWlnaHQg
PSBmR0VUVUJZVEUoMSwgaW5wdXQtPmhbaV0pOworICAgICAgICB1bnNpZ25lZCBpbnQgdmluZGV4
ID0gKGJ1Y2tldCA+PiAzKSAmIDB4MUY7CisgICAgICAgIHVuc2lnbmVkIGludCBlbGluZGV4ID0g
KChpID4+IDEpICYgKH4zKSkgfCAoKGJ1Y2tldCA+PiAxKSAmIDMpOworCisgICAgICAgIGlmIChm
R0VUUUJJVChlbnYtPnF0bXAsIDIgKiBpKSkgeworICAgICAgICAgICAgZW52LT5WUmVnc1t2aW5k
ZXhdLnV3W2VsaW5kZXhdID0KKyAgICAgICAgICAgICAgICBlbnYtPlZSZWdzW3ZpbmRleF0udXdb
ZWxpbmRleF0gKyB3ZWlnaHQ7CisgICAgICAgIH0KKyAgICB9Cit9CisKK3ZvaWQgSEVMUEVSKHZ3
aGlzdDEyOG0pKENQVUhleGFnb25TdGF0ZSAqZW52LCBpbnQzMl90IHVpVikKK3sKKyAgICBNTVZl
Y3RvciAqaW5wdXQgPSAmZW52LT50bXBfVlJlZ3NbMF07CisKKyAgICBmb3IgKGludCBpID0gMDsg
aSA8IChzaXplb2YoTU1WZWN0b3IpIC8gMik7IGkrKykgeworICAgICAgICB1bnNpZ25lZCBpbnQg
YnVja2V0ID0gZkdFVFVCWVRFKDAsIGlucHV0LT5oW2ldKTsKKyAgICAgICAgdW5zaWduZWQgaW50
IHdlaWdodCA9IGZHRVRVQllURSgxLCBpbnB1dC0+aFtpXSk7CisgICAgICAgIHVuc2lnbmVkIGlu
dCB2aW5kZXggPSAoYnVja2V0ID4+IDMpICYgMHgxRjsKKyAgICAgICAgdW5zaWduZWQgaW50IGVs
aW5kZXggPSAoKGkgPj4gMSkgJiAofjMpKSB8ICgoYnVja2V0ID4+IDEpICYgMyk7CisKKyAgICAg
ICAgaWYgKChidWNrZXQgJiAxKSA9PSB1aVYpIHsKKyAgICAgICAgICAgIGVudi0+VlJlZ3Nbdmlu
ZGV4XS51d1tlbGluZGV4XSA9CisgICAgICAgICAgICAgICAgZW52LT5WUmVnc1t2aW5kZXhdLnV3
W2VsaW5kZXhdICsgd2VpZ2h0OworICAgICAgICB9CisgICAgfQorfQorCit2b2lkIEhFTFBFUih2
d2hpc3QxMjhxbSkoQ1BVSGV4YWdvblN0YXRlICplbnYsIGludDMyX3QgdWlWKQoreworICAgIE1N
VmVjdG9yICppbnB1dCA9ICZlbnYtPnRtcF9WUmVnc1swXTsKKworICAgIGZvciAoaW50IGkgPSAw
OyBpIDwgKHNpemVvZihNTVZlY3RvcikgLyAyKTsgaSsrKSB7CisgICAgICAgIHVuc2lnbmVkIGlu
dCBidWNrZXQgPSBmR0VUVUJZVEUoMCwgaW5wdXQtPmhbaV0pOworICAgICAgICB1bnNpZ25lZCBp
bnQgd2VpZ2h0ID0gZkdFVFVCWVRFKDEsIGlucHV0LT5oW2ldKTsKKyAgICAgICAgdW5zaWduZWQg
aW50IHZpbmRleCA9IChidWNrZXQgPj4gMykgJiAweDFGOworICAgICAgICB1bnNpZ25lZCBpbnQg
ZWxpbmRleCA9ICgoaSA+PiAxKSAmICh+MykpIHwgKChidWNrZXQgPj4gMSkgJiAzKTsKKworICAg
ICAgICBpZiAoKChidWNrZXQgJiAxKSA9PSB1aVYpICYmIGZHRVRRQklUKGVudi0+cXRtcCwgMiAq
IGkpKSB7CisgICAgICAgICAgICBlbnYtPlZSZWdzW3ZpbmRleF0udXdbZWxpbmRleF0gPQorICAg
ICAgICAgICAgICAgIGVudi0+VlJlZ3NbdmluZGV4XS51d1tlbGluZGV4XSArIHdlaWdodDsKKyAg
ICAgICAgfQorICAgIH0KK30KKwogc3RhdGljIHZvaWQgY2FuY2VsX3Nsb3QoQ1BVSGV4YWdvblN0
YXRlICplbnYsIHVpbnQzMl90IHNsb3QpCiB7CiAgICAgSEVYX0RFQlVHX0xPRygiU2xvdCAlZCBj
YW5jZWxsZWRcbiIsIHNsb3QpOwotLSAKMi43LjQKCg==

