Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id E08B0168DF7
	for <lists+qemu-devel@lfdr.de>; Sat, 22 Feb 2020 10:04:52 +0100 (CET)
Received: from localhost ([::1]:40630 helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>)
	id 1j5QiR-0004UR-VF
	for lists+qemu-devel@lfdr.de; Sat, 22 Feb 2020 04:04:51 -0500
Received: from eggs.gnu.org ([2001:470:142:3::10]:39102)
 by lists.gnu.org with esmtp (Exim 4.90_1)
 (envelope-from <stefanha@redhat.com>) id 1j5QZJ-0004zz-U4
 for qemu-devel@nongnu.org; Sat, 22 Feb 2020 03:55:27 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
 (envelope-from <stefanha@redhat.com>) id 1j5QZH-0003Qf-Vd
 for qemu-devel@nongnu.org; Sat, 22 Feb 2020 03:55:25 -0500
Received: from us-smtp-delivery-1.mimecast.com ([205.139.110.120]:26390
 helo=us-smtp-1.mimecast.com)
 by eggs.gnu.org with esmtps (TLS1.0:DHE_RSA_AES_256_CBC_SHA1:32)
 (Exim 4.71) (envelope-from <stefanha@redhat.com>) id 1j5QZH-0003QO-Qz
 for qemu-devel@nongnu.org; Sat, 22 Feb 2020 03:55:23 -0500
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1582361723;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=IHM3ZwPhBO9gWJ5DuuAJ9IG1kYCtT3DRDLP4Ms1Hlb0=;
 b=DnnZHIoXfbTr+NZUoUDn868EWRbROc6L7N3QYFi6wDUkuj2o2HfenVPHRy+QdJGmqho4rC
 PlAdnZEaA1syrcUWINIBW9qL5l+ENhA0Zs+8O/GGvOn31xRq1VQeaJZ7YzqWya3zseHy7F
 cTFtgapB+9eMkvhCdtQITU+fINdly2A=
Received: from mimecast-mx01.redhat.com (mimecast-mx01.redhat.com
 [209.132.183.4]) (Using TLS) by relay.mimecast.com with ESMTP id
 us-mta-314-KjExZRrqPWafllIp6DOVsg-1; Sat, 22 Feb 2020 03:55:21 -0500
X-MC-Unique: KjExZRrqPWafllIp6DOVsg-1
Received: from smtp.corp.redhat.com (int-mx08.intmail.prod.int.phx2.redhat.com
 [10.5.11.23])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mimecast-mx01.redhat.com (Postfix) with ESMTPS id 99C5D8017CC;
 Sat, 22 Feb 2020 08:55:19 +0000 (UTC)
Received: from localhost (ovpn-116-74.ams2.redhat.com [10.36.116.74])
 by smtp.corp.redhat.com (Postfix) with ESMTP id D3E3319C7F;
 Sat, 22 Feb 2020 08:55:07 +0000 (UTC)
From: Stefan Hajnoczi <stefanha@redhat.com>
To: qemu-devel@nongnu.org
Subject: [PULL 25/31] fuzz: add support for qos-assisted fuzz targets
Date: Sat, 22 Feb 2020 08:50:24 +0000
Message-Id: <20200222085030.1760640-26-stefanha@redhat.com>
In-Reply-To: <20200222085030.1760640-1-stefanha@redhat.com>
References: <20200222085030.1760640-1-stefanha@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.84 on 10.5.11.23
X-Mimecast-Spam-Score: 0
X-Mimecast-Originator: redhat.com
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: base64
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.2.x-3.x [generic]
X-Received-From: 205.139.110.120
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Cc: Kevin Wolf <kwolf@redhat.com>, Peter Maydell <peter.maydell@linaro.org>,
 Thomas Huth <thuth@redhat.com>, Eduardo Habkost <ehabkost@redhat.com>,
 qemu-block@nongnu.org, "Michael S. Tsirkin" <mst@redhat.com>,
 Laurent Vivier <lvivier@redhat.com>, Max Reitz <mreitz@redhat.com>,
 Alexander Bulekov <alxndr@bu.edu>, Bandan Das <bsd@redhat.com>,
 Stefan Hajnoczi <stefanha@redhat.com>,
 =?UTF-8?q?Marc-Andr=C3=A9=20Lureau?= <marcandre.lureau@redhat.com>,
 Paolo Bonzini <pbonzini@redhat.com>, Fam Zheng <fam@euphon.net>,
 Darren Kenny <darren.kenny@oracle.com>, Richard Henderson <rth@twiddle.net>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: "Qemu-devel" <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>

RnJvbTogQWxleGFuZGVyIEJ1bGVrb3YgPGFseG5kckBidS5lZHU+CgpTaWduZWQtb2ZmLWJ5OiBB
bGV4YW5kZXIgQnVsZWtvdiA8YWx4bmRyQGJ1LmVkdT4KUmV2aWV3ZWQtYnk6IFN0ZWZhbiBIYWpu
b2N6aSA8c3RlZmFuaGFAcmVkaGF0LmNvbT4KUmV2aWV3ZWQtYnk6IERhcnJlbiBLZW5ueSA8ZGFy
cmVuLmtlbm55QG9yYWNsZS5jb20+Ck1lc3NhZ2UtaWQ6IDIwMjAwMjIwMDQxMTE4LjIzMjY0LTE3
LWFseG5kckBidS5lZHUKU2lnbmVkLW9mZi1ieTogU3RlZmFuIEhham5vY3ppIDxzdGVmYW5oYUBy
ZWRoYXQuY29tPgotLS0KIHRlc3RzL3F0ZXN0L2Z1enovTWFrZWZpbGUuaW5jbHVkZSB8ICAgMiAr
CiB0ZXN0cy9xdGVzdC9mdXp6L3Fvc19mdXp6LmMgICAgICAgfCAyMzQgKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrCiB0ZXN0cy9xdGVzdC9mdXp6L3Fvc19mdXp6LmggICAgICAgfCAgMzMg
KysrKysKIDMgZmlsZXMgY2hhbmdlZCwgMjY5IGluc2VydGlvbnMoKykKIGNyZWF0ZSBtb2RlIDEw
MDY0NCB0ZXN0cy9xdGVzdC9mdXp6L3Fvc19mdXp6LmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCB0ZXN0
cy9xdGVzdC9mdXp6L3Fvc19mdXp6LmgKCmRpZmYgLS1naXQgYS90ZXN0cy9xdGVzdC9mdXp6L01h
a2VmaWxlLmluY2x1ZGUgYi90ZXN0cy9xdGVzdC9mdXp6L01ha2VmaWxlLmluY2x1ZGUKaW5kZXgg
YTkwOTE1ZDU2ZC4uZTNiZGQzM2ZmNCAxMDA2NDQKLS0tIGEvdGVzdHMvcXRlc3QvZnV6ei9NYWtl
ZmlsZS5pbmNsdWRlCisrKyBiL3Rlc3RzL3F0ZXN0L2Z1enovTWFrZWZpbGUuaW5jbHVkZQpAQCAt
MSw4ICsxLDEwIEBACiBRRU1VX1BST0dfRlVaWj1xZW11LWZ1enotJChUQVJHRVRfTkFNRSkkKEVY
RVNVRikKIAogZnV6ei1vYmoteSArPSB0ZXN0cy9xdGVzdC9saWJxdGVzdC5vCitmdXp6LW9iai15
ICs9ICQobGlicW9zLW9iai15KQogZnV6ei1vYmoteSArPSB0ZXN0cy9xdGVzdC9mdXp6L2Z1enou
byAjIEZ1enplciBza2VsZXRvbgogZnV6ei1vYmoteSArPSB0ZXN0cy9xdGVzdC9mdXp6L2Zvcmtf
ZnV6ei5vCitmdXp6LW9iai15ICs9IHRlc3RzL3F0ZXN0L2Z1enovcW9zX2Z1enoubwogCiBGVVpa
X0NGTEFHUyArPSAtSSQoU1JDX1BBVEgpL3Rlc3RzIC1JJChTUkNfUEFUSCkvdGVzdHMvcXRlc3QK
IApkaWZmIC0tZ2l0IGEvdGVzdHMvcXRlc3QvZnV6ei9xb3NfZnV6ei5jIGIvdGVzdHMvcXRlc3Qv
ZnV6ei9xb3NfZnV6ei5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAuLmJi
YjE3NDcwZmYKLS0tIC9kZXYvbnVsbAorKysgYi90ZXN0cy9xdGVzdC9mdXp6L3Fvc19mdXp6LmMK
QEAgLTAsMCArMSwyMzQgQEAKKy8qCisgKiBRT1MtYXNzaXN0ZWQgZnV6emluZyBoZWxwZXJzCisg
KgorICogQ29weXJpZ2h0IChjKSAyMDE4IEVtYW51ZWxlIEdpdXNlcHBlIEVzcG9zaXRvIDxlLmVt
YW51ZWxlZ2l1c2VwcGVAZ21haWwuY29tPgorICoKKyAqIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNv
ZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKKyAqIG1vZGlmeSBpdCB1bmRl
ciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAqIExpY2Vuc2Ug
dmVyc2lvbiAyIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLgor
ICoKKyAqIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdp
bGwgYmUgdXNlZnVsLAorICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4g
dGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZP
UiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VCisgKiBMZXNzZXIgR2VuZXJhbCBQ
dWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorICoKKyAqIFlvdSBzaG91bGQgaGF2ZSBy
ZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAqIExpY2Vu
c2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5v
cmcvbGljZW5zZXMvPgorICovCisKKyNpbmNsdWRlICJxZW11L29zZGVwLmgiCisjaW5jbHVkZSAi
cWVtdS91bml0cy5oIgorI2luY2x1ZGUgInFhcGkvZXJyb3IuaCIKKyNpbmNsdWRlICJxZW11LWNv
bW1vbi5oIgorI2luY2x1ZGUgImV4ZWMvbWVtb3J5LmgiCisjaW5jbHVkZSAiZXhlYy9hZGRyZXNz
LXNwYWNlcy5oIgorI2luY2x1ZGUgInN5c2VtdS9zeXNlbXUuaCIKKyNpbmNsdWRlICJxZW11L21h
aW4tbG9vcC5oIgorCisjaW5jbHVkZSAidGVzdHMvcXRlc3QvbGlicXRlc3QuaCIKKyNpbmNsdWRl
ICJ0ZXN0cy9xdGVzdC9saWJxb3MvbWFsbG9jLmgiCisjaW5jbHVkZSAidGVzdHMvcXRlc3QvbGli
cW9zL3FncmFwaC5oIgorI2luY2x1ZGUgInRlc3RzL3F0ZXN0L2xpYnFvcy9xZ3JhcGhfaW50ZXJu
YWwuaCIKKyNpbmNsdWRlICJ0ZXN0cy9xdGVzdC9saWJxb3MvcW9zX2V4dGVybmFsLmgiCisKKyNp
bmNsdWRlICJmdXp6LmgiCisjaW5jbHVkZSAicW9zX2Z1enouaCIKKworI2luY2x1ZGUgInFhcGkv
cWFwaS1jb21tYW5kcy1tYWNoaW5lLmgiCisjaW5jbHVkZSAicWFwaS9xYXBpLWNvbW1hbmRzLXFv
bS5oIgorI2luY2x1ZGUgInFhcGkvcW1wL3FsaXN0LmgiCisKKwordm9pZCAqZnV6el9xb3Nfb2Jq
OworUUd1ZXN0QWxsb2NhdG9yICpmdXp6X3Fvc19hbGxvYzsKKworc3RhdGljIGNvbnN0IGNoYXIg
KmZ1enpfdGFyZ2V0X25hbWU7CitzdGF0aWMgY2hhciAqKmZ1enpfcGF0aF92ZWM7CisKKy8qCisg
KiBSZXBsYWNlZCB0aGUgcW1wIGNvbW1hbmRzIHdpdGggZGlyZWN0IHFtcF9tYXJzaGFsIGNhbGxz
LgorICogUHJvYmFibHkgdGhlcmUgaXMgYSBiZXR0ZXIgd2F5IHRvIGRvIHRoaXMKKyAqLworc3Rh
dGljIHZvaWQgcW9zX3NldF9tYWNoaW5lc19kZXZpY2VzX2F2YWlsYWJsZSh2b2lkKQoreworICAg
IFFEaWN0ICpyZXEgPSBxZGljdF9uZXcoKTsKKyAgICBRT2JqZWN0ICpyZXNwb25zZTsKKyAgICBR
RGljdCAqYXJncyA9IHFkaWN0X25ldygpOworICAgIFFMaXN0ICpsc3Q7CisgICAgRXJyb3IgKmVy
ciA9IE5VTEw7CisKKyAgICBxbXBfbWFyc2hhbF9xdWVyeV9tYWNoaW5lcyhOVUxMLCAmcmVzcG9u
c2UsICZlcnIpOworICAgIGFzc2VydCghZXJyKTsKKyAgICBsc3QgPSBxb2JqZWN0X3RvKFFMaXN0
LCByZXNwb25zZSk7CisgICAgYXBwbHlfdG9fcWxpc3QobHN0LCB0cnVlKTsKKworICAgIHFvYmpl
Y3RfdW5yZWYocmVzcG9uc2UpOworCisKKyAgICBxZGljdF9wdXRfc3RyKHJlcSwgImV4ZWN1dGUi
LCAicW9tLWxpc3QtdHlwZXMiKTsKKyAgICBxZGljdF9wdXRfc3RyKGFyZ3MsICJpbXBsZW1lbnRz
IiwgImRldmljZSIpOworICAgIHFkaWN0X3B1dF9ib29sKGFyZ3MsICJhYnN0cmFjdCIsIHRydWUp
OworICAgIHFkaWN0X3B1dF9vYmoocmVxLCAiYXJndW1lbnRzIiwgKFFPYmplY3QgKikgYXJncyk7
CisKKyAgICBxbXBfbWFyc2hhbF9xb21fbGlzdF90eXBlcyhhcmdzLCAmcmVzcG9uc2UsICZlcnIp
OworICAgIGFzc2VydCghZXJyKTsKKyAgICBsc3QgPSBxb2JqZWN0X3RvKFFMaXN0LCByZXNwb25z
ZSk7CisgICAgYXBwbHlfdG9fcWxpc3QobHN0LCBmYWxzZSk7CisgICAgcW9iamVjdF91bnJlZihy
ZXNwb25zZSk7CisgICAgcW9iamVjdF91bnJlZihyZXEpOworfQorCitzdGF0aWMgY2hhciAqKmN1
cnJlbnRfcGF0aDsKKwordm9pZCAqcW9zX2FsbG9jYXRlX29iamVjdHMoUVRlc3RTdGF0ZSAqcXRz
LCBRR3Vlc3RBbGxvY2F0b3IgKipwX2FsbG9jKQoreworICAgIHJldHVybiBhbGxvY2F0ZV9vYmpl
Y3RzKHF0cywgY3VycmVudF9wYXRoICsgMSwgcF9hbGxvYyk7Cit9CisKK3N0YXRpYyBjb25zdCBj
aGFyICpxb3NfYnVpbGRfbWFpbl9hcmdzKHZvaWQpCit7CisgICAgY2hhciAqKnBhdGggPSBmdXp6
X3BhdGhfdmVjOworICAgIFFPU0dyYXBoTm9kZSAqdGVzdF9ub2RlOworICAgIEdTdHJpbmcgKmNt
ZF9saW5lID0gZ19zdHJpbmdfbmV3KHBhdGhbMF0pOworICAgIHZvaWQgKnRlc3RfYXJnOworCisg
ICAgaWYgKCFwYXRoKSB7CisgICAgICAgIGZwcmludGYoc3RkZXJyLCAiUU9TIFBhdGggbm90IGZv
dW5kXG4iKTsKKyAgICAgICAgYWJvcnQoKTsKKyAgICB9CisKKyAgICAvKiBCZWZvcmUgdGVzdCAq
LworICAgIGN1cnJlbnRfcGF0aCA9IHBhdGg7CisgICAgdGVzdF9ub2RlID0gcW9zX2dyYXBoX2dl
dF9ub2RlKHBhdGhbKGdfc3Rydl9sZW5ndGgocGF0aCkgLSAxKV0pOworICAgIHRlc3RfYXJnID0g
dGVzdF9ub2RlLT51LnRlc3QuYXJnOworICAgIGlmICh0ZXN0X25vZGUtPnUudGVzdC5iZWZvcmUp
IHsKKyAgICAgICAgdGVzdF9hcmcgPSB0ZXN0X25vZGUtPnUudGVzdC5iZWZvcmUoY21kX2xpbmUs
IHRlc3RfYXJnKTsKKyAgICB9CisgICAgLyogUHJlcGVuZCB0aGUgYXJndW1lbnRzIHRoYXQgd2Ug
bmVlZCAqLworICAgIGdfc3RyaW5nX3ByZXBlbmQoY21kX2xpbmUsCisgICAgICAgICAgICBUQVJH
RVRfTkFNRSAiIC1kaXNwbGF5IG5vbmUgLW1hY2hpbmUgYWNjZWw9cXRlc3QgLW0gNjQgIik7Cisg
ICAgcmV0dXJuIGNtZF9saW5lLT5zdHI7Cit9CisKKy8qCisgKiBUaGlzIGZ1bmN0aW9uIGlzIGxh
cmdlbHkgYSBjb3B5IG9mIHFvcy10ZXN0LmM6d2Fsa19wYXRoLiBTaW5jZSB3YWxrX3BhdGgKKyAq
IGlzIGl0c2VsZiBhIGNhbGxiYWNrLCBpdHMgYSBsaXR0bGUgYW5ub3lpbmcgdG8gYWRkIGFub3Ro
ZXIgYXJndW1lbnQvbGF5ZXIgb2YKKyAqIGluZGlyZWN0aW9uCisgKi8KK3N0YXRpYyB2b2lkIHdh
bGtfcGF0aChRT1NHcmFwaE5vZGUgKm9yaWdfcGF0aCwgaW50IGxlbikKK3sKKyAgICBRT1NHcmFw
aE5vZGUgKnBhdGg7CisgICAgUU9TR3JhcGhFZGdlICplZGdlOworCisgICAgLyogZXR5cGUgc2V0
IHRvIFFFREdFX0NPTlNVTUVEX0JZIHNvIHRoYXQgbWFjaGluZSBjYW4gYWRkIHRvIHRoZSBjb21t
YW5kIGxpbmUgKi8KKyAgICBRT1NFZGdlVHlwZSBldHlwZSA9IFFFREdFX0NPTlNVTUVEX0JZOwor
CisgICAgLyogdHdpY2UgUU9TX1BBVEhfTUFYX0VMRU1FTlRfU0laRSBzaW5jZSBlYWNoIGVkZ2Ug
Y2FuIGhhdmUgaXRzIGFyZyAqLworICAgIGNoYXIgKipwYXRoX3ZlYyA9IGdfbmV3MChjaGFyICos
IChRT1NfUEFUSF9NQVhfRUxFTUVOVF9TSVpFICogMikpOworICAgIGludCBwYXRoX3ZlY19zaXpl
ID0gMDsKKworICAgIGNoYXIgKmFmdGVyX2NtZCwgKmJlZm9yZV9jbWQsICphZnRlcl9kZXZpY2U7
CisgICAgR1N0cmluZyAqYWZ0ZXJfZGV2aWNlX3N0ciA9IGdfc3RyaW5nX25ldygiIik7CisgICAg
Y2hhciAqbm9kZV9uYW1lID0gb3JpZ19wYXRoLT5uYW1lLCAqcGF0aF9zdHI7CisKKyAgICBHU3Ry
aW5nICpjbWRfbGluZSA9IGdfc3RyaW5nX25ldygiIik7CisgICAgR1N0cmluZyAqY21kX2xpbmUy
ID0gZ19zdHJpbmdfbmV3KCIiKTsKKworICAgIHBhdGggPSBxb3NfZ3JhcGhfZ2V0X25vZGUobm9k
ZV9uYW1lKTsgLyogcm9vdCAqLworICAgIG5vZGVfbmFtZSA9IHFvc19ncmFwaF9lZGdlX2dldF9k
ZXN0KHBhdGgtPnBhdGhfZWRnZSk7IC8qIG1hY2hpbmUgbmFtZSAqLworCisgICAgcGF0aF92ZWNb
cGF0aF92ZWNfc2l6ZSsrXSA9IG5vZGVfbmFtZTsKKyAgICBwYXRoX3ZlY1twYXRoX3ZlY19zaXpl
KytdID0gcW9zX2dldF9tYWNoaW5lX3R5cGUobm9kZV9uYW1lKTsKKworICAgIGZvciAoOzspIHsK
KyAgICAgICAgcGF0aCA9IHFvc19ncmFwaF9nZXRfbm9kZShub2RlX25hbWUpOworICAgICAgICBp
ZiAoIXBhdGgtPnBhdGhfZWRnZSkgeworICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIH0KKwor
ICAgICAgICBub2RlX25hbWUgPSBxb3NfZ3JhcGhfZWRnZV9nZXRfZGVzdChwYXRoLT5wYXRoX2Vk
Z2UpOworCisgICAgICAgIC8qIGFwcGVuZCBub2RlIGNvbW1hbmQgbGluZSArIHByZXZpb3VzIGVk
Z2UgY29tbWFuZCBsaW5lICovCisgICAgICAgIGlmIChwYXRoLT5jb21tYW5kX2xpbmUgJiYgZXR5
cGUgPT0gUUVER0VfQ09OU1VNRURfQlkpIHsKKyAgICAgICAgICAgIGdfc3RyaW5nX2FwcGVuZChj
bWRfbGluZSwgcGF0aC0+Y29tbWFuZF9saW5lKTsKKyAgICAgICAgICAgIGdfc3RyaW5nX2FwcGVu
ZChjbWRfbGluZSwgYWZ0ZXJfZGV2aWNlX3N0ci0+c3RyKTsKKyAgICAgICAgICAgIGdfc3RyaW5n
X3RydW5jYXRlKGFmdGVyX2RldmljZV9zdHIsIDApOworICAgICAgICB9CisKKyAgICAgICAgcGF0
aF92ZWNbcGF0aF92ZWNfc2l6ZSsrXSA9IHFvc19ncmFwaF9lZGdlX2dldF9uYW1lKHBhdGgtPnBh
dGhfZWRnZSk7CisgICAgICAgIC8qIGRldGVjdCBpZiBlZGdlIGhhcyBjb21tYW5kIGxpbmUgYXJn
cyAqLworICAgICAgICBhZnRlcl9jbWQgPSBxb3NfZ3JhcGhfZWRnZV9nZXRfYWZ0ZXJfY21kX2xp
bmUocGF0aC0+cGF0aF9lZGdlKTsKKyAgICAgICAgYWZ0ZXJfZGV2aWNlID0gcW9zX2dyYXBoX2Vk
Z2VfZ2V0X2V4dHJhX2RldmljZV9vcHRzKHBhdGgtPnBhdGhfZWRnZSk7CisgICAgICAgIGJlZm9y
ZV9jbWQgPSBxb3NfZ3JhcGhfZWRnZV9nZXRfYmVmb3JlX2NtZF9saW5lKHBhdGgtPnBhdGhfZWRn
ZSk7CisgICAgICAgIGVkZ2UgPSBxb3NfZ3JhcGhfZ2V0X2VkZ2UocGF0aC0+bmFtZSwgbm9kZV9u
YW1lKTsKKyAgICAgICAgZXR5cGUgPSBxb3NfZ3JhcGhfZWRnZV9nZXRfdHlwZShlZGdlKTsKKwor
ICAgICAgICBpZiAoYmVmb3JlX2NtZCkgeworICAgICAgICAgICAgZ19zdHJpbmdfYXBwZW5kKGNt
ZF9saW5lLCBiZWZvcmVfY21kKTsKKyAgICAgICAgfQorICAgICAgICBpZiAoYWZ0ZXJfY21kKSB7
CisgICAgICAgICAgICBnX3N0cmluZ19hcHBlbmQoY21kX2xpbmUyLCBhZnRlcl9jbWQpOworICAg
ICAgICB9CisgICAgICAgIGlmIChhZnRlcl9kZXZpY2UpIHsKKyAgICAgICAgICAgIGdfc3RyaW5n
X2FwcGVuZChhZnRlcl9kZXZpY2Vfc3RyLCBhZnRlcl9kZXZpY2UpOworICAgICAgICB9CisgICAg
fQorCisgICAgcGF0aF92ZWNbcGF0aF92ZWNfc2l6ZSsrXSA9IE5VTEw7CisgICAgZ19zdHJpbmdf
YXBwZW5kKGNtZF9saW5lLCBhZnRlcl9kZXZpY2Vfc3RyLT5zdHIpOworICAgIGdfc3RyaW5nX2Zy
ZWUoYWZ0ZXJfZGV2aWNlX3N0ciwgdHJ1ZSk7CisKKyAgICBnX3N0cmluZ19hcHBlbmQoY21kX2xp
bmUsIGNtZF9saW5lMi0+c3RyKTsKKyAgICBnX3N0cmluZ19mcmVlKGNtZF9saW5lMiwgdHJ1ZSk7
CisKKyAgICAvKgorICAgICAqIGhlcmUgcG9zaXRpb24gMCBoYXMgPGFyY2g+LzxtYWNoaW5lPiwg
cG9zaXRpb24gMSBoYXMgPG1hY2hpbmU+LgorICAgICAqIFRoZSBwYXRoIG11c3Qgbm90IGhhdmUg
dGhlIDxhcmNoPiwgcXRlc3RfYWRkX2RhdGFfZnVuYyBhZGRzIGl0LgorICAgICAqLworICAgIHBh
dGhfc3RyID0gZ19zdHJqb2ludigiLyIsIHBhdGhfdmVjICsgMSk7CisKKyAgICAvKiBDaGVjayB0
aGF0IHRoaXMgaXMgdGhlIHRlc3Qgd2UgY2FyZSBhYm91dDogKi8KKyAgICBjaGFyICp0ZXN0X25h
bWUgPSBzdHJyY2hyKHBhdGhfc3RyLCAnLycpICsgMTsKKyAgICBpZiAoc3RyY21wKHRlc3RfbmFt
ZSwgZnV6el90YXJnZXRfbmFtZSkgPT0gMCkgeworICAgICAgICAvKgorICAgICAgICAgKiBwdXQg
YXJjaC9tYWNoaW5lIGluIHBvc2l0aW9uIDEgc28gcnVuX29uZV90ZXN0IGNhbiBkbyBpdHMgd29y
aworICAgICAgICAgKiBhbmQgYWRkIHRoZSBjb21tYW5kIGxpbmUgYXQgcG9zaXRpb24gMC4KKyAg
ICAgICAgICovCisgICAgICAgIHBhdGhfdmVjWzFdID0gcGF0aF92ZWNbMF07CisgICAgICAgIHBh
dGhfdmVjWzBdID0gZ19zdHJpbmdfZnJlZShjbWRfbGluZSwgZmFsc2UpOworCisgICAgICAgIGZ1
enpfcGF0aF92ZWMgPSBwYXRoX3ZlYzsKKyAgICB9IGVsc2UgeworICAgICAgICBnX2ZyZWUocGF0
aF92ZWMpOworICAgIH0KKworICAgIGdfZnJlZShwYXRoX3N0cik7Cit9CisKK3N0YXRpYyBjb25z
dCBjaGFyICpxb3NfZ2V0X2NtZGxpbmUoRnV6elRhcmdldCAqdCkKK3sKKyAgICAvKgorICAgICAq
IFNldCBhIGdsb2JhbCB2YXJpYWJsZSB0aGF0IHdlIHVzZSB0byBpZGVudGlmeSB0aGUgcW9zX3Bh
dGggZm9yIG91cgorICAgICAqIGZ1enpfdGFyZ2V0CisgICAgICovCisgICAgZnV6el90YXJnZXRf
bmFtZSA9IHQtPm5hbWU7CisgICAgcW9zX3NldF9tYWNoaW5lc19kZXZpY2VzX2F2YWlsYWJsZSgp
OworICAgIHFvc19ncmFwaF9mb3JlYWNoX3Rlc3RfcGF0aCh3YWxrX3BhdGgpOworICAgIHJldHVy
biBxb3NfYnVpbGRfbWFpbl9hcmdzKCk7Cit9CisKK3ZvaWQgZnV6el9hZGRfcW9zX3RhcmdldCgK
KyAgICAgICAgRnV6elRhcmdldCAqZnV6el9vcHRzLAorICAgICAgICBjb25zdCBjaGFyICppbnRl
cmZhY2UsCisgICAgICAgIFFPU0dyYXBoVGVzdE9wdGlvbnMgKm9wdHMKKyAgICAgICAgKQorewor
ICAgIHFvc19hZGRfdGVzdChmdXp6X29wdHMtPm5hbWUsIGludGVyZmFjZSwgTlVMTCwgb3B0cyk7
CisgICAgZnV6el9vcHRzLT5nZXRfaW5pdF9jbWRsaW5lID0gcW9zX2dldF9jbWRsaW5lOworICAg
IGZ1enpfYWRkX3RhcmdldChmdXp6X29wdHMpOworfQorCit2b2lkIHFvc19pbml0X3BhdGgoUVRl
c3RTdGF0ZSAqcykKK3sKKyAgICBmdXp6X3Fvc19vYmogPSBxb3NfYWxsb2NhdGVfb2JqZWN0cyhz
ICwgJmZ1enpfcW9zX2FsbG9jKTsKK30KZGlmZiAtLWdpdCBhL3Rlc3RzL3F0ZXN0L2Z1enovcW9z
X2Z1enouaCBiL3Rlc3RzL3F0ZXN0L2Z1enovcW9zX2Z1enouaApuZXcgZmlsZSBtb2RlIDEwMDY0
NAppbmRleCAwMDAwMDAwMDAwLi40NzdmMTFiMDJiCi0tLSAvZGV2L251bGwKKysrIGIvdGVzdHMv
cXRlc3QvZnV6ei9xb3NfZnV6ei5oCkBAIC0wLDAgKzEsMzMgQEAKKy8qCisgKiBRT1MtYXNzaXN0
ZWQgZnV6emluZyBoZWxwZXJzCisgKgorICogQ29weXJpZ2h0IFJlZCBIYXQgSW5jLiwgMjAxOQor
ICoKKyAqIEF1dGhvcnM6CisgKiAgQWxleGFuZGVyIEJ1bGVrb3YgICA8YWx4bmRyQGJ1LmVkdT4K
KyAqCisgKiBUaGlzIHdvcmsgaXMgbGljZW5zZWQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUg
R1BMLCB2ZXJzaW9uIDIgb3IgbGF0ZXIuCisgKiBTZWUgdGhlIENPUFlJTkcgZmlsZSBpbiB0aGUg
dG9wLWxldmVsIGRpcmVjdG9yeS4KKyAqLworCisjaWZuZGVmIF9RT1NfRlVaWl9IXworI2RlZmlu
ZSBfUU9TX0ZVWlpfSF8KKworI2luY2x1ZGUgInRlc3RzL3F0ZXN0L2Z1enovZnV6ei5oIgorI2lu
Y2x1ZGUgInRlc3RzL3F0ZXN0L2xpYnFvcy9xZ3JhcGguaCIKKworaW50IHFvc19mdXp6KGNvbnN0
IHVuc2lnbmVkIGNoYXIgKkRhdGEsIHNpemVfdCBTaXplKTsKK3ZvaWQgcW9zX3NldHVwKHZvaWQp
OworCitleHRlcm4gdm9pZCAqZnV6el9xb3Nfb2JqOworZXh0ZXJuIFFHdWVzdEFsbG9jYXRvciAq
ZnV6el9xb3NfYWxsb2M7CisKK3ZvaWQgZnV6el9hZGRfcW9zX3RhcmdldCgKKyAgICAgICAgRnV6
elRhcmdldCAqZnV6el9vcHRzLAorICAgICAgICBjb25zdCBjaGFyICppbnRlcmZhY2UsCisgICAg
ICAgIFFPU0dyYXBoVGVzdE9wdGlvbnMgKm9wdHMKKyAgICAgICAgKTsKKwordm9pZCBxb3NfaW5p
dF9wYXRoKFFUZXN0U3RhdGUgKik7CisKKyNlbmRpZgotLSAKMi4yNC4xCgo=


