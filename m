Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id A125549C753
	for <lists+qemu-devel@lfdr.de>; Wed, 26 Jan 2022 11:19:01 +0100 (CET)
Received: from localhost ([::1]:48630 helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>)
	id 1nCfOG-0006Rz-9n
	for lists+qemu-devel@lfdr.de; Wed, 26 Jan 2022 05:19:00 -0500
Received: from eggs.gnu.org ([209.51.188.92]:42326)
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <thanos.makatos@nutanix.com>)
 id 1nCfNI-0005Ix-Nl
 for qemu-devel@nongnu.org; Wed, 26 Jan 2022 05:18:00 -0500
Received: from mx0a-002c1b01.pphosted.com ([148.163.151.68]:25164)
 by eggs.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <thanos.makatos@nutanix.com>)
 id 1nCfNF-00084h-Hg
 for qemu-devel@nongnu.org; Wed, 26 Jan 2022 05:18:00 -0500
Received: from pps.filterd (m0127840.ppops.net [127.0.0.1])
 by mx0a-002c1b01.pphosted.com (8.16.1.2/8.16.1.2) with ESMTP id 20Q9FA3N009709;
 Wed, 26 Jan 2022 02:17:52 -0800
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=nutanix.com;
 h=from : to : subject
 : date : message-id : references : in-reply-to : content-type :
 content-transfer-encoding : mime-version; s=proofpoint20171006;
 bh=nEQz6Pg+IQthiXUphGeAmB0lrajbgKcoWtDT+PqatuU=;
 b=IGq2FeySTyC6t+tBUU/ffj/FazLIKYAuC3wlXMiEz0zfHHd8NEmJC2J0mkpK0JdWn/9/
 Y1+/203pAXYw2axIleXmGGYeqFy26+r6ry5WsjcowMtgRhmXglpxaIDJ4icsAA3GYZbK
 L0P2FGtAShwjvDNIPZuxJ+xRRjJuV9ZDV1L6Ty6d1XTKy5LORAH4uiraNEaj0rIDm/5i
 +1S1DuszgDfMZ4zK7MkgNKvYUYvX7MfFzQxKYHNRHCbuni4csPdW6u4gga85pJwOU0ZI
 R7utqBHS8DY6s8/ZCttOHgwVXm1KUCFFy1fTkOGl3z6snNSUEVLFmGXr80qiY5UdUFyW 3g== 
Received: from nam12-dm6-obe.outbound.protection.outlook.com
 (mail-dm6nam12lp2174.outbound.protection.outlook.com [104.47.59.174])
 by mx0a-002c1b01.pphosted.com (PPS) with ESMTPS id 3dtjhja267-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Wed, 26 Jan 2022 02:17:52 -0800
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=ATIN1DCVfCVbiIG8dnUnwLbJeEi6VsaT3hEKCoKn1L8xIK4eJ2WSi+w670R/VMb8EPEluEwcY9ztzooHc6m71RZA4LkVxJkYoojRG+orMckiRdOEbCJqpnSvI5Ws/Grt0isDqOHT6HJI0cY/iGFbQSUZjOZRgont9gUTlUWRo4frkdCPHEhS8iDoL0KDOlaz276s+hnOSNFWRZoQzgFvTk/Gp0y559EkyTyfVgLgKOXqpXTFQ0iqksTDEcYgLwz7j9u8BQDRPbBRY286BrQXH7bJxFU5IqJnZ2MX62p/EOLB23IpLpgGwgpy1hc6WSW9OAZvvJvq5P0W+gk9Uh/8qw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=nEQz6Pg+IQthiXUphGeAmB0lrajbgKcoWtDT+PqatuU=;
 b=lMuYqbQ2WUce37fdiHRRd8JM0qYwxcYd8w7XrhjrGUtRUzZ2aJxO2pPibuE2629SM7WBs4k3Xg9sCPQs2dQ/nZUUnoh7LZrYxKX6b/dSH9r9Uq8Df8p/ooALZEdzD8HBQzo0K0Jri2LUvlN8fC5NhtIdf6jbRs6b32OIWmoG05/lTkmCkG2/JhE0uRHGN88kD1rJJChYmlE5oGhKu859ouXsx91+dYRFdFLjOOTcfvdhmVlwvsspUGLAe2yty8GGdrIqv8t1AzvNd97fp6B9gPHofqjLGYjD6CNat6WAGNWVPCu4Uq9d9EfuHjQHTIMpE997h9AIff4bV6y3heCarw==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=none; dmarc=none;
 dkim=none; arc=none
Received: from DM8PR02MB8005.namprd02.prod.outlook.com (2603:10b6:8:16::16) by
 BYAPR02MB5879.namprd02.prod.outlook.com (2603:10b6:a03:121::13) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.4930.15; Wed, 26 Jan
 2022 10:17:50 +0000
Received: from DM8PR02MB8005.namprd02.prod.outlook.com
 ([fe80::b94a:5302:b5e4:441]) by DM8PR02MB8005.namprd02.prod.outlook.com
 ([fe80::b94a:5302:b5e4:441%7]) with mapi id 15.20.4909.017; Wed, 26 Jan 2022
 10:17:50 +0000
From: Thanos Makatos <thanos.makatos@nutanix.com>
To: John Johnson <john.g.johnson@oracle.com>, "qemu-devel@nongnu.org"
 <qemu-devel@nongnu.org>
Subject: RE: [RFC v4 09/21] vfio-user: define socket send functions
Thread-Topic: [RFC v4 09/21] vfio-user: define socket send functions
Thread-Index: AQHYB0yplFqAG4WQMEaApZArrAZZfax1LRKQ
Date: Wed, 26 Jan 2022 10:17:50 +0000
Message-ID: <DM8PR02MB8005B4D97069BFB0204F87EA8B209@DM8PR02MB8005.namprd02.prod.outlook.com>
References: <cover.1641584316.git.john.g.johnson@oracle.com>
 <62f4ed7290dc1ac50187fb7287ba4d109ea96b9d.1641584317.git.john.g.johnson@oracle.com>
In-Reply-To: <62f4ed7290dc1ac50187fb7287ba4d109ea96b9d.1641584317.git.john.g.johnson@oracle.com>
Accept-Language: en-GB, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 6cd7a094-3776-44da-4780-08d9e0b51b63
x-ms-traffictypediagnostic: BYAPR02MB5879:EE_
x-microsoft-antispam-prvs: <BYAPR02MB5879B8DF376CCA2E37AD17658B209@BYAPR02MB5879.namprd02.prod.outlook.com>
x-proofpoint-crosstenant: true
x-ms-oob-tlc-oobclassifiers: OLM:3044;
x-ms-exchange-senderadcheck: 1
x-ms-exchange-antispam-relay: 0
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: gLQNIVENela6llXhAl4zI7vP/P4wFZiMZytPbm7ruyVIx8XyNuhZsfR+UZvh5ogKsZHNGoCQoj8xQocAVD9fBndPwDP1Mgn5KviVP1pfeEHG6wPRlg9ahHiBnhLNxDs+Y4dH9SlvilCn4Cu8kBDjMre4gA+HAapCy7Vfcinyk+prs+WeYeRbiVRV5Q4gwUbFzcuOETAE8Z1dbAPEkLYLORz1c/eSPxDTWDCNEY4UAcFEHNdRkOyN+Z0MbcuGKF8BkLLXAc2YoxUVuSgD7rHplT0NEIWU5mg8yUmnxFAPRqEazEjwdmsojqa4yrDIPKy+sQ+cHrcZT+O9dwNlqXHHt6GsCX8eC186a4ZUqRB0qnNvc8my3n+IWYxGltRCxCaDDewp0gf93qghmrQFzls3JhKL+/1cg6JWsXqqrigZPJeRsznKT9dKNABg5ldJg2q9WLvERnuzcjxqfbaRwGQl10F7l1OrthgJNbR+ycy9G9Ai9m77s66TiIIav+eNRmH0bbG+ERp3q5O7p8QvDPzxAdtseU/8YDxwhVTHIqb4QD+fX/71FFDyob/wX2+HRCO05MjQ8IthCjv1Hj3JHDr8030ke5Qyeq6nBwQ6bxv8Fe/apdCRlPQg7jXSwvBmCWxgF8ndZhvsgwWazY7E/xIA9Eij1La5c2rlfNHjEsovgGjkWUtfYVQew75GqTv6ke3DanlUcWw9P4p+qol/BO8Bvg==
x-forefront-antispam-report: CIP:255.255.255.255; CTRY:; LANG:en; SCL:1; SRV:;
 IPV:NLI; SFV:NSPM; H:DM8PR02MB8005.namprd02.prod.outlook.com; PTR:; CAT:NONE;
 SFS:(13230001)(366004)(53546011)(6506007)(7696005)(9686003)(122000001)(52536014)(26005)(2906002)(55016003)(33656002)(5660300002)(44832011)(186003)(38070700005)(86362001)(110136005)(508600001)(38100700002)(71200400001)(8676002)(66946007)(316002)(83380400001)(8936002)(64756008)(66446008)(66476007)(66556008)(76116006)(20210929001);
 DIR:OUT; SFP:1102; 
x-ms-exchange-antispam-messagedata-chunkcount: 1
x-ms-exchange-antispam-messagedata-0: =?utf-8?B?cFQyd25sSU9ERll1ek90Qmk2ZEMweWZ6bUwwUUNyeU1yU3B5d2Y4ZXMwZVZr?=
 =?utf-8?B?Rjgra1dpMGNQNWFIMDZxV0l3dWMzVkpjczdoV3FheGh4MlBQQlBWMWdBZE9u?=
 =?utf-8?B?RjJIK0tyanhHeE9zTVVEN0RVYUxQWWE4aGNlZ2NLakJSSDJqd24raVk0OXJs?=
 =?utf-8?B?NlNRS2hZUnNwbHBsREQxNElWcSs5VUphdmsvaU44WGFDeUd5TVJvV3B2MXAv?=
 =?utf-8?B?dTdEa0tyTmFkK2h1NUoraTJyd0ZLN3dGV2JpRFZiZ2pKbVpnUEFXWWQ2TVp3?=
 =?utf-8?B?SWFiUkwvdmhzTVR6TkliNHlDWkE4MnFFbXlTd2ZVT1l1U0c4cnFjaGFpZE5D?=
 =?utf-8?B?NGVFWm1BL05DQnRjR1psZHBYR2tPQVdCZm9tbHVMeE16RU5jVVA4Rkc2ci9i?=
 =?utf-8?B?bDlFT2pqT0xxS0hjRG1CODdvUVVKdkdkdTJQMXo3cUFIanArb1B4YkMxeTlz?=
 =?utf-8?B?YTcrRFNNeHA2TEN3TU9mdCsvUW9KbTlSUUU2Q1VUSXViN1ltV2NjWGc2WWJC?=
 =?utf-8?B?WDFyVlVqRWdlcVBZSEpIWEMyZUxVNVhhVmd4VG84M1Y4K3J4S3JYc0ZIZ0ow?=
 =?utf-8?B?aWpUbU5zTFlIeVNwT0E1Vkt3aWwwdHBYWCt4WUZkUUY0bjQ2WjlxT1dqbitR?=
 =?utf-8?B?NmFTYmc2TWVYWS9JeEdWYzNsWXpSUENpWUhSZm1nSlVtK3NFTTIraFVXdEZO?=
 =?utf-8?B?OWlaQWt6aEN6Q0JyR0xyV0FHWnIvQWVKQkxrYzBtNUNsNlI2d2ZNMUVCbU9m?=
 =?utf-8?B?UnZ1YmlQZmNKRkxueFRxTjE2VGhvK0NaeFc1anRuRGczSkI1dSttK1pWL2xs?=
 =?utf-8?B?Y1ZDSlFDQ1JVbkV5VXIrQzgrbDYrSGNlZDRJU1ZJTlcwQXdZYTJHZU1SR3k5?=
 =?utf-8?B?a3FOSG9ML2xJNlZhMGtIUkVjY0xzN3o4cDQ0Tks4blpYVTZEVDdFZnNPOW9h?=
 =?utf-8?B?Yk01QitLVFZMWUY5VHJDNUhnTlBhTkdEeW85alo1T1FTVlpvTWtwNDhlZTdO?=
 =?utf-8?B?UmlOOExHVGpSR3lDeTBTTWxzbWZnUVhJaHk5TkQrbnlXTUlpd1hUeHRVOS8w?=
 =?utf-8?B?cFY3NTM4VURDZVRlbVY4clpmSXNRcktuWjhUZjV6VksvNmN4ZUVBbU10WGNj?=
 =?utf-8?B?bFVES3IyanVmS3B2MWxiUm9uUGNrUGxXTlRHVVM3MzQ2akttMGVEZ3c5SGho?=
 =?utf-8?B?TXJHUTgvT0h6eHFUb0JkMGY2MmZ2V1Y1VUNUV3RLOWhVVkhmT0hJUWtIMGh2?=
 =?utf-8?B?UTNUbjV6TFdMWjBtWXUzdVV2eGdrbGdVVm9nMjFkdWI5cDk5TkxTWkg0cXd0?=
 =?utf-8?B?QlRHYXlHdW5Md1p0WFBmQmxzdzIyZ1B2NW1BeGlrV1FxNHlOcGhJd1dsbFNB?=
 =?utf-8?B?Vyt5RHZydWpUbWdjcG1weGVuTzk1eTlXWXAwbVN1cVZpRStHUURQaXNoMHF2?=
 =?utf-8?B?aWw3Ui9rOTh3UlVTQXpNMnJGblVSNGZmM2lBQnBDWk5xZm9ac21za3d1V3F5?=
 =?utf-8?B?TzlkZkV3ajc4OW1qWlZnd2FIemYxRTZnbjU3cGhjZW52MUR0QnNlaDVkVHBD?=
 =?utf-8?B?UW1ZU1kxNFEvbW9YZEtmYlVXdmRJeVVmbVlVZDJRS01zcmREMnpmR3I5ekYz?=
 =?utf-8?B?NTZYREplYWR4MFFtRmlCemI2cXFBU2NhMWFQYXVXTUdRNXQzcXFqWjVxaE5t?=
 =?utf-8?B?a2ZpenVqajhYa0NnMlFHcm5pWnRNZTZIa1ptMkZIYTBxbmYyZUVNaEJmYVc5?=
 =?utf-8?B?Zk1DVUErZGoraUNWSFh4MCsvUEE3MUFleGlmelEyOG1Ea0hldzFTVUI0WHJV?=
 =?utf-8?B?eFZ6d0dnSWc0US9ONHIycnc0Y0crblkvMjZUcjQ1ODF5OTFva2QxMVRUOXB6?=
 =?utf-8?B?NG16T2ttbVc2aU5ydURRWEkwK3ZEUlNPbFJ3VWpsNmhjK3hxOVQxNm84MUt4?=
 =?utf-8?B?bVpZK2RDdWczZUZUdTB5SGd2Q2tiQTBhZjhEUWgrbmhHRDZRbm9Jc0dTZFhR?=
 =?utf-8?B?MmtjQWdNZ3oydkpMNUw1S2JSL3FuRzhrNmlWVWZuaE1Fa01KcmNkRndjSjRu?=
 =?utf-8?B?MVRRTDBUYm5PbWRFK2F1dmdHZTcvSWxRQWc1VDVwS0VxbjdQV2pXMm9hRnRT?=
 =?utf-8?B?MWlJY2ZDRVZ5cE9xUXdpc1lZbVNXRVRVOU5ZblpCSlcrWFI4STFhVDVtODUy?=
 =?utf-8?B?QWV1NXRac0RUSDkrQjFlcUlGZ2NYYlZNVnlQUkNaRGI4QlZxYTBXSTI3QStH?=
 =?utf-8?B?RTdScVJvemw4bk9ZVW14RWNxdEJRPT0=?=
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: nutanix.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-AuthSource: DM8PR02MB8005.namprd02.prod.outlook.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 6cd7a094-3776-44da-4780-08d9e0b51b63
X-MS-Exchange-CrossTenant-originalarrivaltime: 26 Jan 2022 10:17:50.2048 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: bb047546-786f-4de1-bd75-24e5b6f79043
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: fthZmoKrfsBhTKWJFCwXV5+clDMtmZ8NHf8j0+q2Yz+qC696/EDczmWoXdhH0V4zMSMA2CfI76T771rSbByFr7QAAiXV2d8m9wNQIWbluvQ=
X-MS-Exchange-Transport-CrossTenantHeadersStamped: BYAPR02MB5879
X-Proofpoint-GUID: p6x7qxBYKy2WKnkiP8eeuiCVFAsfa2Bk
X-Proofpoint-ORIG-GUID: p6x7qxBYKy2WKnkiP8eeuiCVFAsfa2Bk
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.205,Aquarius:18.0.816,Hydra:6.0.425,FMLib:17.11.62.513
 definitions=2022-01-26_02,2022-01-26_01,2021-12-02_01
X-Proofpoint-Spam-Reason: safe
Received-SPF: pass client-ip=148.163.151.68;
 envelope-from=thanos.makatos@nutanix.com; helo=mx0a-002c1b01.pphosted.com
X-Spam_score_int: -22
X-Spam_score: -2.3
X-Spam_bar: --
X-Spam_report: (-2.3 / 5.0 requ) BAYES_00=-1.9, DKIMWL_WL_HIGH=-0.155,
 DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, DKIM_VALID_EF=-0.1,
 RCVD_IN_MSPIKE_H2=-0.001, SPF_HELO_NONE=0.001,
 SPF_PASS=-0.001 autolearn=ham autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: "Qemu-devel" <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>

PiAtLS0tLU9yaWdpbmFsIE1lc3NhZ2UtLS0tLQ0KPiBGcm9tOiBRZW11LWRldmVsIDxxZW11LWRl
dmVsLQ0KPiBib3VuY2VzK3RoYW5vcy5tYWthdG9zPW51dGFuaXguY29tQG5vbmdudS5vcmc+IE9u
IEJlaGFsZiBPZiBKb2huDQo+IEpvaG5zb24NCj4gU2VudDogMTIgSmFudWFyeSAyMDIyIDAwOjQ0
DQo+IFRvOiBxZW11LWRldmVsQG5vbmdudS5vcmcNCj4gU3ViamVjdDogW1JGQyB2NCAwOS8yMV0g
dmZpby11c2VyOiBkZWZpbmUgc29ja2V0IHNlbmQgZnVuY3Rpb25zDQo+IA0KPiBBbHNvIG5lZ290
aWF0ZSBwcm90b2NvbCB2ZXJzaW9uIHdpdGggcmVtb3RlIHNlcnZlcg0KPiANCj4gU2lnbmVkLW9m
Zi1ieTogSmFnYW5uYXRoYW4gUmFtYW4gPGphZy5yYW1hbkBvcmFjbGUuY29tPg0KPiBTaWduZWQt
b2ZmLWJ5OiBFbGVuYSBVZmltdHNldmEgPGVsZW5hLnVmaW10c2V2YUBvcmFjbGUuY29tPg0KPiBT
aWduZWQtb2ZmLWJ5OiBKb2huIEcgSm9obnNvbiA8am9obi5nLmpvaG5zb25Ab3JhY2xlLmNvbT4N
Cj4gLS0tDQo+ICBody92ZmlvL3BjaS5oICAgICAgICAgICB8ICAgMSArDQo+ICBody92ZmlvL3Vz
ZXItcHJvdG9jb2wuaCB8ICA0MSArKysrKw0KPiAgaHcvdmZpby91c2VyLmggICAgICAgICAgfCAg
IDIgKw0KPiAgaHcvdmZpby9wY2kuYyAgICAgICAgICAgfCAgMTYgKysNCj4gIGh3L3ZmaW8vdXNl
ci5jICAgICAgICAgIHwgNDE0DQo+ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrLQ0KPiAgNSBmaWxlcyBjaGFuZ2VkLCA0NzMgaW5zZXJ0aW9ucygrKSwgMSBk
ZWxldGlvbigtKQ0KPiANCj4gZGlmZiAtLWdpdCBhL2h3L3ZmaW8vcGNpLmggYi9ody92ZmlvL3Bj
aS5oDQo+IGluZGV4IDU5ZTYzNmMuLmVjOWYzNDUgMTAwNjQ0DQo+IC0tLSBhL2h3L3ZmaW8vcGNp
LmgNCj4gKysrIGIvaHcvdmZpby9wY2kuaA0KPiBAQCAtMTkzLDYgKzE5Myw3IEBAIE9CSkVDVF9E
RUNMQVJFX1NJTVBMRV9UWVBFKFZGSU9Vc2VyUENJRGV2aWNlLA0KPiBWRklPX1VTRVJfUENJKQ0K
PiAgc3RydWN0IFZGSU9Vc2VyUENJRGV2aWNlIHsNCj4gICAgICBWRklPUENJRGV2aWNlIGRldmlj
ZTsNCj4gICAgICBjaGFyICpzb2NrX25hbWU7DQo+ICsgICAgYm9vbCBzZW5kX3F1ZXVlZDsgICAv
KiBhbGwgc2VuZHMgYXJlIHF1ZXVlZCAqLw0KPiAgfTsNCj4gDQo+ICAvKiBVc2UgdWluMzJfdCBm
b3IgdmVuZG9yICYgZGV2aWNlIHNvIFBDSV9BTllfSUQgZXhwYW5kcyBhbmQgY2Fubm90IG1hdGNo
DQo+IGh3ICovDQo+IGRpZmYgLS1naXQgYS9ody92ZmlvL3VzZXItcHJvdG9jb2wuaCBiL2h3L3Zm
aW8vdXNlci1wcm90b2NvbC5oDQo+IGluZGV4IGQyMzg3N2MuLmEwODg5ZjYgMTAwNjQ0DQo+IC0t
LSBhL2h3L3ZmaW8vdXNlci1wcm90b2NvbC5oDQo+ICsrKyBiL2h3L3ZmaW8vdXNlci1wcm90b2Nv
bC5oDQo+IEBAIC01MSw0ICs1MSw0NSBAQCBlbnVtIHZmaW9fdXNlcl9jb21tYW5kIHsNCj4gICNk
ZWZpbmUgVkZJT19VU0VSX05PX1JFUExZICAgICAgMHgxMA0KPiAgI2RlZmluZSBWRklPX1VTRVJf
RVJST1IgICAgICAgICAweDIwDQo+IA0KPiArDQo+ICsvKg0KPiArICogVkZJT19VU0VSX1ZFUlNJ
T04NCj4gKyAqLw0KPiArdHlwZWRlZiBzdHJ1Y3Qgew0KPiArICAgIFZGSU9Vc2VySGRyIGhkcjsN
Cj4gKyAgICB1aW50MTZfdCBtYWpvcjsNCj4gKyAgICB1aW50MTZfdCBtaW5vcjsNCj4gKyAgICBj
aGFyIGNhcGFiaWxpdGllc1tdOw0KPiArfSBWRklPVXNlclZlcnNpb247DQo+ICsNCj4gKyNkZWZp
bmUgVkZJT19VU0VSX01BSk9SX1ZFUiAgICAgMA0KPiArI2RlZmluZSBWRklPX1VTRVJfTUlOT1Jf
VkVSICAgICAwDQo+ICsNCj4gKyNkZWZpbmUgVkZJT19VU0VSX0NBUCAgICAgICAgICAgImNhcGFi
aWxpdGllcyINCj4gKw0KPiArLyogImNhcGFiaWxpdGllcyIgbWVtYmVycyAqLw0KPiArI2RlZmlu
ZSBWRklPX1VTRVJfQ0FQX01BWF9GRFMgICAibWF4X21zZ19mZHMiDQo+ICsjZGVmaW5lIFZGSU9f
VVNFUl9DQVBfTUFYX1hGRVIgICJtYXhfZGF0YV94ZmVyX3NpemUiDQo+ICsjZGVmaW5lIFZGSU9f
VVNFUl9DQVBfTUlHUiAgICAgICJtaWdyYXRpb24iDQo+ICsNCj4gKy8qICJtaWdyYXRpb24iIG1l
bWJlciAqLw0KPiArI2RlZmluZSBWRklPX1VTRVJfQ0FQX1BHU0laRSAgICAicGdzaXplIg0KPiAr
DQo+ICsvKg0KPiArICogTWF4IEZEcyBtYWlubHkgY29tZXMgaW50byBwbGF5IHdoZW4gYSBkZXZp
Y2Ugc3VwcG9ydHMgbXVsdGlwbGUgaW50ZXJydXB0cw0KPiArICogd2hlcmUgZWFjaCBvbmVzIHVz
ZXMgYW4gZXZlbnRmZCB0byBpbmplY3QgaXQgaW50byB0aGUgZ3Vlc3QuDQo+ICsgKiBJdCBpcyBj
bGFtcGVkIGJ5IHRoZSB0aGUgbnVtYmVyIG9mIEZEcyB0aGUgcWlvIGNoYW5uZWwgc3VwcG9ydHMg
aW4gYQ0KPiArICogc2luZ2xlIG1lc3NhZ2UuDQo+ICsgKi8NCj4gKyNkZWZpbmUgVkZJT19VU0VS
X0RFRl9NQVhfRkRTICAgOA0KPiArI2RlZmluZSBWRklPX1VTRVJfTUFYX01BWF9GRFMgICAxNg0K
PiArDQo+ICsvKg0KPiArICogTWF4IHRyYW5zZmVyIGxpbWl0cyB0aGUgYW1vdW50IG9mIGRhdGEg
aW4gcmVnaW9uIGFuZCBETUEgbWVzc2FnZXMuDQo+ICsgKiBSZWdpb24gUi9XIHdpbGwgYmUgdmVy
eSBzbWFsbCAobGltaXRlZCBieSBob3cgbXVjaCBhIHNpbmdsZSBpbnN0cnVjdGlvbg0KPiArICog
Y2FuIHByb2Nlc3MpIHNvIGp1c3QgdXNlIGEgcmVhc29uYWJsZSBsaW1pdCBoZXJlLg0KPiArICov
DQo+ICsjZGVmaW5lIFZGSU9fVVNFUl9ERUZfTUFYX1hGRVIgICgxMDI0ICogMTAyNCkNCj4gKyNk
ZWZpbmUgVkZJT19VU0VSX01BWF9NQVhfWEZFUiAgKDY0ICogMTAyNCAqIDEwMjQpDQo+ICsNCj4g
ICNlbmRpZiAvKiBWRklPX1VTRVJfUFJPVE9DT0xfSCAqLw0KPiBkaWZmIC0tZ2l0IGEvaHcvdmZp
by91c2VyLmggYi9ody92ZmlvL3VzZXIuaA0KPiBpbmRleCA3MmVlZmE3Li43ZWYzYzk1IDEwMDY0
NA0KPiAtLS0gYS9ody92ZmlvL3VzZXIuaA0KPiArKysgYi9ody92ZmlvL3VzZXIuaA0KPiBAQCAt
NzQsMTEgKzc0LDEzIEBAIHR5cGVkZWYgc3RydWN0IFZGSU9Qcm94eSB7DQo+IA0KPiAgLyogVkZJ
T1Byb3h5IGZsYWdzICovDQo+ICAjZGVmaW5lIFZGSU9fUFJPWFlfQ0xJRU5UICAgICAgICAweDEN
Cj4gKyNkZWZpbmUgVkZJT19QUk9YWV9GT1JDRV9RVUVVRUQgIDB4NA0KPiANCj4gIFZGSU9Qcm94
eSAqdmZpb191c2VyX2Nvbm5lY3RfZGV2KFNvY2tldEFkZHJlc3MgKmFkZHIsIEVycm9yICoqZXJy
cCk7DQo+ICB2b2lkIHZmaW9fdXNlcl9kaXNjb25uZWN0KFZGSU9Qcm94eSAqcHJveHkpOw0KPiAg
dm9pZCB2ZmlvX3VzZXJfc2V0X2hhbmRsZXIoVkZJT0RldmljZSAqdmJhc2VkZXYsDQo+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB2b2lkICgqaGFuZGxlcikodm9pZCAqb3BhcXVlLCBWRklP
VXNlck1zZyAqbXNnKSwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKnJlcWFy
Zyk7DQo+ICtpbnQgdmZpb191c2VyX3ZhbGlkYXRlX3ZlcnNpb24oVkZJT0RldmljZSAqdmJhc2Vk
ZXYsIEVycm9yICoqZXJycCk7DQo+IA0KPiAgI2VuZGlmIC8qIFZGSU9fVVNFUl9IICovDQo+IGRp
ZmYgLS1naXQgYS9ody92ZmlvL3BjaS5jIGIvaHcvdmZpby9wY2kuYw0KPiBpbmRleCAwZGU5MTVk
Li4zMDgwYmQ0IDEwMDY0NA0KPiAtLS0gYS9ody92ZmlvL3BjaS5jDQo+ICsrKyBiL2h3L3ZmaW8v
cGNpLmMNCj4gQEAgLTM0MzksMTIgKzM0MzksMjcgQEAgc3RhdGljIHZvaWQgdmZpb191c2VyX3Bj
aV9yZWFsaXplKFBDSURldmljZSAqcGRldiwNCj4gRXJyb3IgKiplcnJwKQ0KPiAgICAgIHZiYXNl
ZGV2LT5wcm94eSA9IHByb3h5Ow0KPiAgICAgIHZmaW9fdXNlcl9zZXRfaGFuZGxlcih2YmFzZWRl
diwgdmZpb191c2VyX3BjaV9wcm9jZXNzX3JlcSwgdmRldik7DQo+IA0KPiArICAgIGlmICh1ZGV2
LT5zZW5kX3F1ZXVlZCkgew0KPiArICAgICAgICBwcm94eS0+ZmxhZ3MgfD0gVkZJT19QUk9YWV9G
T1JDRV9RVUVVRUQ7DQo+ICsgICAgfQ0KPiArDQo+ICsgICAgdmZpb191c2VyX3ZhbGlkYXRlX3Zl
cnNpb24odmJhc2VkZXYsICZlcnIpOw0KPiArICAgIGlmIChlcnIgIT0gTlVMTCkgew0KPiArICAg
ICAgICBlcnJvcl9wcm9wYWdhdGUoZXJycCwgZXJyKTsNCj4gKyAgICAgICAgZ290byBlcnJvcjsN
Cj4gKyAgICB9DQo+ICsNCj4gICAgICB2YmFzZWRldi0+bmFtZSA9IGdfc3RyZHVwX3ByaW50Zigi
VkZJTyB1c2VyIDwlcz4iLCB1ZGV2LT5zb2NrX25hbWUpOw0KPiAgICAgIHZiYXNlZGV2LT5kZXYg
PSBERVZJQ0UodmRldik7DQo+ICAgICAgdmJhc2VkZXYtPmZkID0gLTE7DQo+ICAgICAgdmJhc2Vk
ZXYtPnR5cGUgPSBWRklPX0RFVklDRV9UWVBFX1BDSTsNCj4gICAgICB2YmFzZWRldi0+b3BzID0g
JnZmaW9fdXNlcl9wY2lfb3BzOw0KPiANCj4gKyAgICByZXR1cm47DQo+ICsNCj4gK2Vycm9yOg0K
PiArICAgIHZmaW9fdXNlcl9kaXNjb25uZWN0KHByb3h5KTsNCj4gKyAgICBlcnJvcl9wcmVwZW5k
KGVycnAsIFZGSU9fTVNHX1BSRUZJWCwgdmRldi0+dmJhc2VkZXYubmFtZSk7DQo+ICB9DQo+IA0K
PiAgc3RhdGljIHZvaWQgdmZpb191c2VyX2luc3RhbmNlX2ZpbmFsaXplKE9iamVjdCAqb2JqKQ0K
PiBAQCAtMzQ2MSw2ICszNDc2LDcgQEAgc3RhdGljIHZvaWQgdmZpb191c2VyX2luc3RhbmNlX2Zp
bmFsaXplKE9iamVjdCAqb2JqKQ0KPiANCj4gIHN0YXRpYyBQcm9wZXJ0eSB2ZmlvX3VzZXJfcGNp
X2Rldl9wcm9wZXJ0aWVzW10gPSB7DQo+ICAgICAgREVGSU5FX1BST1BfU1RSSU5HKCJzb2NrZXQi
LCBWRklPVXNlclBDSURldmljZSwgc29ja19uYW1lKSwNCj4gKyAgICBERUZJTkVfUFJPUF9CT09M
KCJ4LXNlbmQtcXVldWVkIiwgVkZJT1VzZXJQQ0lEZXZpY2UsIHNlbmRfcXVldWVkLA0KPiBmYWxz
ZSksDQo+ICAgICAgREVGSU5FX1BST1BfRU5EX09GX0xJU1QoKSwNCj4gIH07DQo+IA0KPiBkaWZm
IC0tZ2l0IGEvaHcvdmZpby91c2VyLmMgYi9ody92ZmlvL3VzZXIuYw0KPiBpbmRleCBlMWRmZDVk
Li5mZDFlMGE4IDEwMDY0NA0KPiAtLS0gYS9ody92ZmlvL3VzZXIuYw0KPiArKysgYi9ody92Zmlv
L3VzZXIuYw0KPiBAQCAtMjMsMTIgKzIzLDIwIEBADQo+ICAjaW5jbHVkZSAiaW8vY2hhbm5lbC1z
b2NrZXQuaCINCj4gICNpbmNsdWRlICJpby9jaGFubmVsLXV0aWwuaCINCj4gICNpbmNsdWRlICJz
eXNlbXUvaW90aHJlYWQuaCINCj4gKyNpbmNsdWRlICJxYXBpL3FtcC9xZGljdC5oIg0KPiArI2lu
Y2x1ZGUgInFhcGkvcW1wL3Fqc29uLmgiDQo+ICsjaW5jbHVkZSAicWFwaS9xbXAvcW51bGwuaCIN
Cj4gKyNpbmNsdWRlICJxYXBpL3FtcC9xc3RyaW5nLmgiDQo+ICsjaW5jbHVkZSAicWFwaS9xbXAv
cW51bS5oIg0KPiAgI2luY2x1ZGUgInVzZXIuaCINCj4gDQo+IC1zdGF0aWMgdWludDY0X3QgbWF4
X3hmZXJfc2l6ZTsNCj4gK3N0YXRpYyB1aW50NjRfdCBtYXhfeGZlcl9zaXplID0gVkZJT19VU0VS
X0RFRl9NQVhfWEZFUjsNCj4gK3N0YXRpYyB1aW50NjRfdCBtYXhfc2VuZF9mZHMgPSBWRklPX1VT
RVJfREVGX01BWF9GRFM7DQo+ICtzdGF0aWMgaW50IHdhaXRfdGltZSA9IDEwMDA7ICAgLyogd2Fp
dCAxIHNlYyBmb3IgcmVwbGllcyAqLw0KDQpDb3VsZCB3ZSBtYWtlIHRoaXMgY29uZmlndXJhYmxl
IHZpYSB0aGUgY29tbWFuZCBsaW5lIGFzIGl0IGhlbHBzIGRlYnVnZ2luZz8NCg0KPiAgc3RhdGlj
IElPVGhyZWFkICp2ZmlvX3VzZXJfaW90aHJlYWQ7DQo+IA0KPiAgc3RhdGljIHZvaWQgdmZpb191
c2VyX3NodXRkb3duKFZGSU9Qcm94eSAqcHJveHkpOw0KPiArc3RhdGljIGludCB2ZmlvX3VzZXJf
c2VuZF9xaW8oVkZJT1Byb3h5ICpwcm94eSwgVkZJT1VzZXJNc2cgKm1zZyk7DQo+ICBzdGF0aWMg
VkZJT1VzZXJNc2cgKnZmaW9fdXNlcl9nZXRtc2coVkZJT1Byb3h5ICpwcm94eSwgVkZJT1VzZXJI
ZHIgKmhkciwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWRklPVXNl
ckZEcyAqZmRzKTsNCj4gIHN0YXRpYyBWRklPVXNlckZEcyAqdmZpb191c2VyX2dldGZkcyhpbnQg
bnVtZmRzKTsNCj4gQEAgLTM2LDkgKzQ0LDE2IEBAIHN0YXRpYyB2b2lkIHZmaW9fdXNlcl9yZWN5
Y2xlKFZGSU9Qcm94eSAqcHJveHksDQo+IFZGSU9Vc2VyTXNnICptc2cpOw0KPiANCj4gIHN0YXRp
YyB2b2lkIHZmaW9fdXNlcl9yZWN2KHZvaWQgKm9wYXF1ZSk7DQo+ICBzdGF0aWMgaW50IHZmaW9f
dXNlcl9yZWN2X29uZShWRklPUHJveHkgKnByb3h5KTsNCj4gK3N0YXRpYyB2b2lkIHZmaW9fdXNl
cl9zZW5kKHZvaWQgKm9wYXF1ZSk7DQo+ICtzdGF0aWMgaW50IHZmaW9fdXNlcl9zZW5kX29uZShW
RklPUHJveHkgKnByb3h5LCBWRklPVXNlck1zZyAqbXNnKTsNCj4gIHN0YXRpYyB2b2lkIHZmaW9f
dXNlcl9jYih2b2lkICpvcGFxdWUpOw0KPiANCj4gIHN0YXRpYyB2b2lkIHZmaW9fdXNlcl9yZXF1
ZXN0KHZvaWQgKm9wYXF1ZSk7DQo+ICtzdGF0aWMgaW50IHZmaW9fdXNlcl9zZW5kX3F1ZXVlZChW
RklPUHJveHkgKnByb3h5LCBWRklPVXNlck1zZyAqbXNnKTsNCj4gK3N0YXRpYyB2b2lkIHZmaW9f
dXNlcl9zZW5kX3dhaXQoVkZJT1Byb3h5ICpwcm94eSwgVkZJT1VzZXJIZHIgKmhkciwNCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVkZJT1VzZXJGRHMgKmZkcywgaW50IHJzaXpl
LCBib29sIG5vYnFsKTsNCj4gK3N0YXRpYyB2b2lkIHZmaW9fdXNlcl9yZXF1ZXN0X21zZyhWRklP
VXNlckhkciAqaGRyLCB1aW50MTZfdCBjbWQsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdWludDMyX3Qgc2l6ZSwgdWludDMyX3QgZmxhZ3MpOw0KPiANCj4gIHN0YXRpYyBp
bmxpbmUgdm9pZCB2ZmlvX3VzZXJfc2V0X2Vycm9yKFZGSU9Vc2VySGRyICpoZHIsIHVpbnQzMl90
IGVycikNCj4gIHsNCj4gQEAgLTU2LDYgKzcxLDMyIEBAIHN0YXRpYyB2b2lkIHZmaW9fdXNlcl9z
aHV0ZG93bihWRklPUHJveHkgKnByb3h5KQ0KPiAgICAgIHFpb19jaGFubmVsX3NldF9haW9fZmRf
aGFuZGxlcihwcm94eS0+aW9jLCBwcm94eS0+Y3R4LCBOVUxMLCBOVUxMLCBOVUxMKTsNCj4gIH0N
Cj4gDQo+ICtzdGF0aWMgaW50IHZmaW9fdXNlcl9zZW5kX3FpbyhWRklPUHJveHkgKnByb3h5LCBW
RklPVXNlck1zZyAqbXNnKQ0KPiArew0KPiArICAgIFZGSU9Vc2VyRkRzICpmZHMgPSAgbXNnLT5m
ZHM7DQo+ICsgICAgc3RydWN0IGlvdmVjIGlvdiA9IHsNCj4gKyAgICAgICAgLmlvdl9iYXNlID0g
bXNnLT5oZHIsDQo+ICsgICAgICAgIC5pb3ZfbGVuID0gbXNnLT5oZHItPnNpemUsDQo+ICsgICAg
fTsNCj4gKyAgICBzaXplX3QgbnVtZmRzID0gMDsNCj4gKyAgICBpbnQgcmV0LCAqZmRwID0gTlVM
TDsNCj4gKyAgICBFcnJvciAqbG9jYWxfZXJyID0gTlVMTDsNCj4gKw0KPiArICAgIGlmIChmZHMg
IT0gTlVMTCAmJiBmZHMtPnNlbmRfZmRzICE9IDApIHsNCj4gKyAgICAgICAgbnVtZmRzID0gZmRz
LT5zZW5kX2ZkczsNCj4gKyAgICAgICAgZmRwID0gZmRzLT5mZHM7DQo+ICsgICAgfQ0KPiArDQo+
ICsgICAgcmV0ID0gcWlvX2NoYW5uZWxfd3JpdGV2X2Z1bGwocHJveHktPmlvYywgJmlvdiwgMSwg
ZmRwLCBudW1mZHMsICZsb2NhbF9lcnIpOw0KPiArDQo+ICsgICAgaWYgKHJldCA9PSAtMSkgew0K
PiArICAgICAgICB2ZmlvX3VzZXJfc2V0X2Vycm9yKG1zZy0+aGRyLCBFSU8pOw0KPiArICAgICAg
ICB2ZmlvX3VzZXJfc2h1dGRvd24ocHJveHkpOw0KPiArICAgICAgICBlcnJvcl9yZXBvcnRfZXJy
KGxvY2FsX2Vycik7DQo+ICsgICAgfQ0KPiArICAgIHJldHVybiByZXQ7DQo+ICt9DQo+ICsNCj4g
IHN0YXRpYyBWRklPVXNlck1zZyAqdmZpb191c2VyX2dldG1zZyhWRklPUHJveHkgKnByb3h5LCBW
RklPVXNlckhkciAqaGRyLA0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFZGSU9Vc2VyRkRzICpmZHMpDQo+ICB7DQo+IEBAIC0zMTEsNiArMzUyLDUzIEBAIGVycjoNCj4g
ICAgICByZXR1cm4gLTE7DQo+ICB9DQo+IA0KPiArLyoNCj4gKyAqIFNlbmQgbWVzc2FnZXMgZnJv
bSBvdXRnb2luZyBxdWV1ZSB3aGVuIHRoZSBzb2NrZXQgYnVmZmVyIGhhcyBzcGFjZS4NCj4gKyAq
IElmIHdlIGRlcGxldGUgJ291dGdvaW5nJywgcmVtb3ZlIG91cnNlbHZlcyBmcm9tIHRoZSBwb2xs
IGxpc3QuDQo+ICsgKi8NCj4gK3N0YXRpYyB2b2lkIHZmaW9fdXNlcl9zZW5kKHZvaWQgKm9wYXF1
ZSkNCj4gK3sNCj4gKyAgICBWRklPUHJveHkgKnByb3h5ID0gb3BhcXVlOw0KPiArICAgIFZGSU9V
c2VyTXNnICptc2c7DQo+ICsNCj4gKyAgICBRRU1VX0xPQ0tfR1VBUkQoJnByb3h5LT5sb2NrKTsN
Cj4gKw0KPiArICAgIGlmIChwcm94eS0+c3RhdGUgPT0gVkZJT19QUk9YWV9DT05ORUNURUQpIHsN
Cj4gKyAgICAgICAgd2hpbGUgKCFRVEFJTFFfRU1QVFkoJnByb3h5LT5vdXRnb2luZykpIHsNCj4g
KyAgICAgICAgICAgIG1zZyA9IFFUQUlMUV9GSVJTVCgmcHJveHktPm91dGdvaW5nKTsNCj4gKyAg
ICAgICAgICAgIGlmICh2ZmlvX3VzZXJfc2VuZF9vbmUocHJveHksIG1zZykgPCAwKSB7DQo+ICsg
ICAgICAgICAgICAgICAgcmV0dXJuOw0KPiArICAgICAgICAgICAgfQ0KPiArICAgICAgICB9DQo+
ICsgICAgICAgIHFpb19jaGFubmVsX3NldF9haW9fZmRfaGFuZGxlcihwcm94eS0+aW9jLCBwcm94
eS0+Y3R4LA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmZpb191
c2VyX3JlY3YsIE5VTEwsIHByb3h5KTsNCj4gKyAgICB9DQo+ICt9DQo+ICsNCj4gKy8qDQo+ICsg
KiBTZW5kIGEgc2luZ2xlIG1lc3NhZ2UuDQo+ICsgKg0KPiArICogU2VudCBhc3luYyBtZXNzYWdl
cyBhcmUgZnJlZWQsIG90aGVycyBhcmUgbW92ZWQgdG8gcGVuZGluZyBxdWV1ZS4NCj4gKyAqLw0K
PiArc3RhdGljIGludCB2ZmlvX3VzZXJfc2VuZF9vbmUoVkZJT1Byb3h5ICpwcm94eSwgVkZJT1Vz
ZXJNc2cgKm1zZykNCj4gK3sNCj4gKyAgICBpbnQgcmV0Ow0KPiArDQo+ICsgICAgcmV0ID0gdmZp
b191c2VyX3NlbmRfcWlvKHByb3h5LCBtc2cpOw0KPiArICAgIGlmIChyZXQgPCAwKSB7DQo+ICsg
ICAgICAgIHJldHVybiByZXQ7DQo+ICsgICAgfQ0KPiArDQo+ICsgICAgUVRBSUxRX1JFTU9WRSgm
cHJveHktPm91dGdvaW5nLCBtc2csIG5leHQpOw0KPiArICAgIGlmIChtc2ctPnR5cGUgPT0gVkZJ
T19NU0dfQVNZTkMpIHsNCj4gKyAgICAgICAgdmZpb191c2VyX3JlY3ljbGUocHJveHksIG1zZyk7
DQo+ICsgICAgfSBlbHNlIHsNCj4gKyAgICAgICAgUVRBSUxRX0lOU0VSVF9UQUlMKCZwcm94eS0+
cGVuZGluZywgbXNnLCBuZXh0KTsNCj4gKyAgICB9DQo+ICsNCj4gKyAgICByZXR1cm4gMDsNCj4g
K30NCj4gKw0KPiAgc3RhdGljIHZvaWQgdmZpb191c2VyX2NiKHZvaWQgKm9wYXF1ZSkNCj4gIHsN
Cj4gICAgICBWRklPUHJveHkgKnByb3h5ID0gb3BhcXVlOw0KPiBAQCAtMzcxLDYgKzQ1OSwxMzAg
QEAgc3RhdGljIHZvaWQgdmZpb191c2VyX3JlcXVlc3Qodm9pZCAqb3BhcXVlKQ0KPiAgICAgIH0N
Cj4gIH0NCj4gDQo+ICsvKg0KPiArICogTWVzc2FnZXMgYXJlIHF1ZXVlZCBvbnRvIHRoZSBwcm94
eSdzIG91dGdvaW5nIGxpc3QuDQo+ICsgKg0KPiArICogSXQgaGFuZGxlcyAzIHR5cGVzIG9mIG1l
c3NhZ2VzOg0KPiArICoNCj4gKyAqIGFzeW5jIG1lc3NhZ2VzIC0gcmVwbGllcyBhbmQgcG9zdGVk
IHdyaXRlcw0KPiArICoNCj4gKyAqIFRoZXJlIHdpbGwgYmUgbm8gcmVwbHkgZnJvbSB0aGUgc2Vy
dmVyLCBzbyBtZXNzYWdlDQo+ICsgKiBidWZmZXJzIGFyZSBmcmVlZCBhZnRlciB0aGV5J3JlIHNl
bnQuDQo+ICsgKg0KPiArICogbm93YWl0IG1lc3NhZ2VzIC0gbWFwL3VubWFwIGR1cmluZyBhZGRy
ZXNzIHNwYWNlIHRyYW5zYWN0aW9ucw0KPiArICoNCj4gKyAqIFRoZXNlIGFyZSBhbHNvIHNlbnQg
YXN5bmMsIGJ1dCBhIHJlcGx5IGlzIGV4cGVjdGVkIHNvIHRoYXQNCj4gKyAqIHZmaW9fd2FpdF9y
ZXFzKCkgY2FuIHdhaXQgZm9yIHRoZSB5b3VuZ2VzdCBub3dhaXQgcmVxdWVzdC4NCj4gKyAqIFRo
ZXkgdHJhbnNpdGlvbiBmcm9tIHRoZSBvdXRnb2luZyBsaXN0IHRvIHRoZSBwZW5kaW5nIGxpc3QN
Cj4gKyAqIHdoZW4gc2VudCwgYW5kIGFyZSBmcmVlZCB3aGVuIHRoZSByZXBseSBpcyByZWNlaXZl
ZC4NCj4gKyAqDQo+ICsgKiB3YWl0IG1lc3NhZ2VzIC0gYWxsIG90aGVyIHJlcXVlc3RzDQo+ICsg
Kg0KPiArICogVGhlIHJlcGx5IHRvIHRoZXNlIG1lc3NhZ2VzIGlzIHdhaXRlZCBmb3IgYnkgdGhl
aXIgY2FsbGVyLg0KPiArICogVGhleSBhbHNvIHRyYW5zaXRpb24gZnJvbSBvdXRnb2luZyB0byBw
ZW5kaW5nIHdoZW4gc2VudCwgYnV0DQo+ICsgKiB0aGUgbWVzc2FnZSBidWZmZXIgaXMgcmV0dXJu
ZWQgdG8gdGhlIGNhbGxlciB3aXRoIHRoZSByZXBseQ0KPiArICogY29udGVudHMuICBUaGUgY2Fs
bGVyIGlzIHJlc3BvbnNpYmxlIGZvciBmcmVlaW5nIHRoZXNlIG1lc3NhZ2VzLg0KPiArICoNCj4g
KyAqIEFzIGFuIG9wdGltaXphdGlvbiwgaWYgdGhlIG91dGdvaW5nIGxpc3QgYW5kIHRoZSBzb2Nr
ZXQgc2VuZA0KPiArICogYnVmZmVyIGFyZSBlbXB0eSwgdGhlIG1lc3NhZ2UgaXMgc2VudCBpbmxp
bmUgaW5zdGVhZCBvZiBiZWluZw0KPiArICogYWRkZWQgdG8gdGhlIG91dGdvaW5nIGxpc3QuICBU
aGUgcmVzdCBvZiB0aGUgdHJhbnNpdGlvbnMgYXJlDQo+ICsgKiB1bmNoYW5nZWQuDQo+ICsgKg0K
PiArICogcmV0dXJucyAwIGlmIHRoZSBtZXNzYWdlIHdhcyBzZW50IG9yIHF1ZXVlZA0KPiArICog
cmV0dXJucyAtMSBvbiBzZW5kIGVycm9yDQo+ICsgKi8NCj4gK3N0YXRpYyBpbnQgdmZpb191c2Vy
X3NlbmRfcXVldWVkKFZGSU9Qcm94eSAqcHJveHksIFZGSU9Vc2VyTXNnICptc2cpDQo+ICt7DQo+
ICsgICAgaW50IHJldDsNCj4gKw0KPiArICAgIC8qDQo+ICsgICAgICogVW5zZW50IG91dGdvaW5n
IG1zZ3MgLSBhZGQgdG8gdGFpbA0KPiArICAgICAqLw0KPiArICAgIGlmICghUVRBSUxRX0VNUFRZ
KCZwcm94eS0+b3V0Z29pbmcpKSB7DQo+ICsgICAgICAgIFFUQUlMUV9JTlNFUlRfVEFJTCgmcHJv
eHktPm91dGdvaW5nLCBtc2csIG5leHQpOw0KPiArICAgICAgICByZXR1cm4gMDsNCj4gKyAgICB9
DQo+ICsNCj4gKyAgICAvKg0KPiArICAgICAqIFRyeSBpbmxpbmUgLSBpZiBibG9ja2VkLCBxdWV1
ZSBpdCBhbmQga2ljayBzZW5kIHBvbGxlcg0KPiArICAgICAqLw0KPiArICAgIGlmIChwcm94eS0+
ZmxhZ3MgJiBWRklPX1BST1hZX0ZPUkNFX1FVRVVFRCkgew0KPiArICAgICAgICByZXQgPSBRSU9f
Q0hBTk5FTF9FUlJfQkxPQ0s7DQo+ICsgICAgfSBlbHNlIHsNCj4gKyAgICAgICAgcmV0ID0gdmZp
b191c2VyX3NlbmRfcWlvKHByb3h5LCBtc2cpOw0KPiArICAgIH0NCj4gKyAgICBpZiAocmV0ID09
IFFJT19DSEFOTkVMX0VSUl9CTE9DSykgew0KPiArICAgICAgICBRVEFJTFFfSU5TRVJUX0hFQUQo
JnByb3h5LT5vdXRnb2luZywgbXNnLCBuZXh0KTsNCj4gKyAgICAgICAgcWlvX2NoYW5uZWxfc2V0
X2Fpb19mZF9oYW5kbGVyKHByb3h5LT5pb2MsIHByb3h5LT5jdHgsDQo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB2ZmlvX3VzZXJfcmVjdiwgdmZpb191c2VyX3NlbmQs
DQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm94eSk7DQo+ICsg
ICAgICAgIHJldHVybiAwOw0KPiArICAgIH0NCj4gKyAgICBpZiAocmV0ID09IC0xKSB7DQo+ICsg
ICAgICAgIHJldHVybiByZXQ7DQo+ICsgICAgfQ0KPiArDQo+ICsgICAgLyoNCj4gKyAgICAgKiBT
ZW50IC0gZnJlZSBhc3luYywgYWRkIG90aGVycyB0byBwZW5kaW5nDQo+ICsgICAgICovDQo+ICsg
ICAgaWYgKG1zZy0+dHlwZSA9PSBWRklPX01TR19BU1lOQykgew0KPiArICAgICAgICB2ZmlvX3Vz
ZXJfcmVjeWNsZShwcm94eSwgbXNnKTsNCj4gKyAgICB9IGVsc2Ugew0KPiArICAgICAgICBRVEFJ
TFFfSU5TRVJUX1RBSUwoJnByb3h5LT5wZW5kaW5nLCBtc2csIG5leHQpOw0KPiArICAgIH0NCj4g
Kw0KPiArICAgIHJldHVybiAwOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMgdm9pZCB2ZmlvX3VzZXJf
c2VuZF93YWl0KFZGSU9Qcm94eSAqcHJveHksIFZGSU9Vc2VySGRyICpoZHIsDQo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFZGSU9Vc2VyRkRzICpmZHMsIGludCByc2l6ZSwgYm9v
bCBub2JxbCkNCj4gK3sNCj4gKyAgICBWRklPVXNlck1zZyAqbXNnOw0KPiArICAgIGJvb2wgaW9s
b2NrID0gZmFsc2U7DQo+ICsgICAgaW50IHJldDsNCj4gKw0KPiArICAgIGlmIChoZHItPmZsYWdz
ICYgVkZJT19VU0VSX05PX1JFUExZKSB7DQo+ICsgICAgICAgIGVycm9yX3ByaW50ZigidmZpb191
c2VyX3NlbmRfd2FpdCBvbiBhc3luYyBtZXNzYWdlXG4iKTsNCj4gKyAgICAgICAgcmV0dXJuOw0K
PiArICAgIH0NCj4gKw0KPiArICAgIC8qDQo+ICsgICAgICogV2UgbWF5IGJsb2NrIGxhdGVyLCBz
byB1c2UgYSBwZXItcHJveHkgbG9jayBhbmQgZHJvcA0KPiArICAgICAqIEJRTCB3aGlsZSB3ZSBz
bGVlcCB1bmxlc3MgJ25vYnFsJyBzYXlzIG5vdCB0by4NCj4gKyAgICAgKi8NCj4gKyAgICBxZW11
X211dGV4X2xvY2soJnByb3h5LT5sb2NrKTsNCj4gKyAgICBpZiAoIW5vYnFsKSB7DQo+ICsgICAg
ICAgIGlvbG9jayA9IHFlbXVfbXV0ZXhfaW90aHJlYWRfbG9ja2VkKCk7DQo+ICsgICAgICAgIGlm
IChpb2xvY2spIHsNCj4gKyAgICAgICAgICAgIHFlbXVfbXV0ZXhfdW5sb2NrX2lvdGhyZWFkKCk7
DQo+ICsgICAgICAgIH0NCj4gKyAgICB9DQo+ICsNCj4gKyAgICBtc2cgPSB2ZmlvX3VzZXJfZ2V0
bXNnKHByb3h5LCBoZHIsIGZkcyk7DQo+ICsgICAgbXNnLT5pZCA9IGhkci0+aWQ7DQo+ICsgICAg
bXNnLT5yc2l6ZSA9IHJzaXplID8gcnNpemUgOiBoZHItPnNpemU7DQo+ICsgICAgbXNnLT50eXBl
ID0gVkZJT19NU0dfV0FJVDsNCj4gKw0KPiArICAgIHJldCA9IHZmaW9fdXNlcl9zZW5kX3F1ZXVl
ZChwcm94eSwgbXNnKTsNCj4gKw0KPiArICAgIGlmIChyZXQgPT0gMCkgew0KPiArICAgICAgICB3
aGlsZSAoIW1zZy0+Y29tcGxldGUpIHsNCj4gKyAgICAgICAgICAgIGlmICghcWVtdV9jb25kX3Rp
bWVkd2FpdCgmbXNnLT5jdiwgJnByb3h5LT5sb2NrLCB3YWl0X3RpbWUpKSB7DQo+ICsgICAgICAg
ICAgICAgICAgUVRBSUxRX1JFTU9WRSgmcHJveHktPnBlbmRpbmcsIG1zZywgbmV4dCk7DQo+ICsg
ICAgICAgICAgICAgICAgdmZpb191c2VyX3NldF9lcnJvcihoZHIsIEVUSU1FRE9VVCk7DQo+ICsg
ICAgICAgICAgICAgICAgYnJlYWs7DQo+ICsgICAgICAgICAgICB9DQo+ICsgICAgICAgIH0NCj4g
KyAgICB9DQo+ICsgICAgdmZpb191c2VyX3JlY3ljbGUocHJveHksIG1zZyk7DQo+ICsNCj4gKyAg
ICAvKiBsb2NrIG9yZGVyIGlzIEJRTC0+cHJveHkgLSBkb24ndCBob2xkIHByb3h5IHdoZW4gZ2V0
dGluZyBCUUwgKi8NCj4gKyAgICBxZW11X211dGV4X3VubG9jaygmcHJveHktPmxvY2spOw0KPiAr
ICAgIGlmIChpb2xvY2spIHsNCj4gKyAgICAgICAgcWVtdV9tdXRleF9sb2NrX2lvdGhyZWFkKCk7
DQo+ICsgICAgfQ0KPiArfQ0KPiArDQo+ICBzdGF0aWMgUUxJU1RfSEVBRCgsIFZGSU9Qcm94eSkg
dmZpb191c2VyX3NvY2tldHMgPQ0KPiAgICAgIFFMSVNUX0hFQURfSU5JVElBTElaRVIodmZpb191
c2VyX3NvY2tldHMpOw0KPiANCj4gQEAgLTQ5NSwzICs3MDcsMjAzIEBAIHZvaWQgdmZpb191c2Vy
X2Rpc2Nvbm5lY3QoVkZJT1Byb3h5ICpwcm94eSkNCj4gICAgICBnX2ZyZWUocHJveHktPnNvY2tu
YW1lKTsNCj4gICAgICBnX2ZyZWUocHJveHkpOw0KPiAgfQ0KPiArDQo+ICtzdGF0aWMgdm9pZCB2
ZmlvX3VzZXJfcmVxdWVzdF9tc2coVkZJT1VzZXJIZHIgKmhkciwgdWludDE2X3QgY21kLA0KPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHNpemUsIHVpbnQzMl90
IGZsYWdzKQ0KPiArew0KPiArICAgIHN0YXRpYyB1aW50MTZfdCBuZXh0X2lkOw0KPiArDQo+ICsg
ICAgaGRyLT5pZCA9IHFhdG9taWNfZmV0Y2hfaW5jKCZuZXh0X2lkKTsNCj4gKyAgICBoZHItPmNv
bW1hbmQgPSBjbWQ7DQo+ICsgICAgaGRyLT5zaXplID0gc2l6ZTsNCj4gKyAgICBoZHItPmZsYWdz
ID0gKGZsYWdzICYgflZGSU9fVVNFUl9UWVBFKSB8IFZGSU9fVVNFUl9SRVFVRVNUOw0KPiArICAg
IGhkci0+ZXJyb3JfcmVwbHkgPSAwOw0KPiArfQ0KPiArDQo+ICtzdHJ1Y3QgY2FwX2VudHJ5IHsN
Cj4gKyAgICBjb25zdCBjaGFyICpuYW1lOw0KPiArICAgIGludCAoKmNoZWNrKShRT2JqZWN0ICpx
b2JqLCBFcnJvciAqKmVycnApOw0KPiArfTsNCj4gKw0KPiArc3RhdGljIGludCBjYXBzX3BhcnNl
KFFEaWN0ICpxZGljdCwgc3RydWN0IGNhcF9lbnRyeSBjYXBzW10sIEVycm9yICoqZXJycCkNCj4g
K3sNCj4gKyAgICBRT2JqZWN0ICpxb2JqOw0KPiArICAgIHN0cnVjdCBjYXBfZW50cnkgKnA7DQo+
ICsNCj4gKyAgICBmb3IgKHAgPSBjYXBzOyBwLT5uYW1lICE9IE5VTEw7IHArKykgew0KPiArICAg
ICAgICBxb2JqID0gcWRpY3RfZ2V0KHFkaWN0LCBwLT5uYW1lKTsNCj4gKyAgICAgICAgaWYgKHFv
YmogIT0gTlVMTCkgew0KPiArICAgICAgICAgICAgaWYgKHAtPmNoZWNrKHFvYmosIGVycnApKSB7
DQo+ICsgICAgICAgICAgICAgICAgcmV0dXJuIC0xOw0KPiArICAgICAgICAgICAgfQ0KPiArICAg
ICAgICAgICAgcWRpY3RfZGVsKHFkaWN0LCBwLT5uYW1lKTsNCj4gKyAgICAgICAgfQ0KPiArICAg
IH0NCj4gKw0KPiArICAgIC8qIHdhcm5pbmcsIGZvciBub3cgKi8NCj4gKyAgICBpZiAocWRpY3Rf
c2l6ZShxZGljdCkgIT0gMCkgew0KPiArICAgICAgICBlcnJvcl9wcmludGYoInNwdXJpb3VzIGNh
cGFiaWxpdGllc1xuIik7DQo+ICsgICAgfQ0KPiArICAgIHJldHVybiAwOw0KPiArfQ0KPiArDQo+
ICtzdGF0aWMgaW50IGNoZWNrX3Bnc2l6ZShRT2JqZWN0ICpxb2JqLCBFcnJvciAqKmVycnApDQo+
ICt7DQo+ICsgICAgUU51bSAqcW4gPSBxb2JqZWN0X3RvKFFOdW0sIHFvYmopOw0KPiArICAgIHVp
bnQ2NF90IHBnc2l6ZTsNCj4gKw0KPiArICAgIGlmIChxbiA9PSBOVUxMIHx8ICFxbnVtX2dldF90
cnlfdWludChxbiwgJnBnc2l6ZSkpIHsNCj4gKyAgICAgICAgZXJyb3Jfc2V0ZyhlcnJwLCAibWFs
Zm9ybWVkICVzIiwgVkZJT19VU0VSX0NBUF9QR1NJWkUpOw0KPiArICAgICAgICByZXR1cm4gLTE7
DQo+ICsgICAgfQ0KPiArICAgIHJldHVybiBwZ3NpemUgPT0gNDA5NiA/IDAgOiAtMTsNCj4gK30N
Cj4gKw0KPiArc3RhdGljIHN0cnVjdCBjYXBfZW50cnkgY2Fwc19taWdyW10gPSB7DQo+ICsgICAg
eyBWRklPX1VTRVJfQ0FQX1BHU0laRSwgY2hlY2tfcGdzaXplIH0sDQo+ICsgICAgeyBOVUxMIH0N
Cj4gK307DQo+ICsNCj4gK3N0YXRpYyBpbnQgY2hlY2tfbWF4X2ZkcyhRT2JqZWN0ICpxb2JqLCBF
cnJvciAqKmVycnApDQo+ICt7DQo+ICsgICAgUU51bSAqcW4gPSBxb2JqZWN0X3RvKFFOdW0sIHFv
YmopOw0KPiArDQo+ICsgICAgaWYgKHFuID09IE5VTEwgfHwgIXFudW1fZ2V0X3RyeV91aW50KHFu
LCAmbWF4X3NlbmRfZmRzKSB8fA0KPiArICAgICAgICBtYXhfc2VuZF9mZHMgPiBWRklPX1VTRVJf
TUFYX01BWF9GRFMpIHsNCj4gKyAgICAgICAgZXJyb3Jfc2V0ZyhlcnJwLCAibWFsZm9ybWVkICVz
IiwgVkZJT19VU0VSX0NBUF9NQVhfRkRTKTsNCj4gKyAgICAgICAgcmV0dXJuIC0xOw0KPiArICAg
IH0NCj4gKyAgICByZXR1cm4gMDsNCj4gK30NCj4gKw0KPiArc3RhdGljIGludCBjaGVja19tYXhf
eGZlcihRT2JqZWN0ICpxb2JqLCBFcnJvciAqKmVycnApDQo+ICt7DQo+ICsgICAgUU51bSAqcW4g
PSBxb2JqZWN0X3RvKFFOdW0sIHFvYmopOw0KPiArDQo+ICsgICAgaWYgKHFuID09IE5VTEwgfHwg
IXFudW1fZ2V0X3RyeV91aW50KHFuLCAmbWF4X3hmZXJfc2l6ZSkgfHwNCj4gKyAgICAgICAgbWF4
X3hmZXJfc2l6ZSA+IFZGSU9fVVNFUl9NQVhfTUFYX1hGRVIpIHsNCj4gKyAgICAgICAgZXJyb3Jf
c2V0ZyhlcnJwLCAibWFsZm9ybWVkICVzIiwgVkZJT19VU0VSX0NBUF9NQVhfWEZFUik7DQo+ICsg
ICAgICAgIHJldHVybiAtMTsNCj4gKyAgICB9DQo+ICsgICAgcmV0dXJuIDA7DQo+ICt9DQo+ICsN
Cj4gK3N0YXRpYyBpbnQgY2hlY2tfbWlncihRT2JqZWN0ICpxb2JqLCBFcnJvciAqKmVycnApDQo+
ICt7DQo+ICsgICAgUURpY3QgKnFkaWN0ID0gcW9iamVjdF90byhRRGljdCwgcW9iaik7DQo+ICsN
Cj4gKyAgICBpZiAocWRpY3QgPT0gTlVMTCkgew0KPiArICAgICAgICBlcnJvcl9zZXRnKGVycnAs
ICJtYWxmb3JtZWQgJXMiLCBWRklPX1VTRVJfQ0FQX01BWF9GRFMpOw0KPiArICAgICAgICByZXR1
cm4gLTE7DQo+ICsgICAgfQ0KPiArICAgIHJldHVybiBjYXBzX3BhcnNlKHFkaWN0LCBjYXBzX21p
Z3IsIGVycnApOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMgc3RydWN0IGNhcF9lbnRyeSBjYXBzX2Nh
cFtdID0gew0KPiArICAgIHsgVkZJT19VU0VSX0NBUF9NQVhfRkRTLCBjaGVja19tYXhfZmRzIH0s
DQo+ICsgICAgeyBWRklPX1VTRVJfQ0FQX01BWF9YRkVSLCBjaGVja19tYXhfeGZlciB9LA0KPiAr
ICAgIHsgVkZJT19VU0VSX0NBUF9NSUdSLCBjaGVja19taWdyIH0sDQo+ICsgICAgeyBOVUxMIH0N
Cj4gK307DQo+ICsNCj4gK3N0YXRpYyBpbnQgY2hlY2tfY2FwKFFPYmplY3QgKnFvYmosIEVycm9y
ICoqZXJycCkNCj4gK3sNCj4gKyAgIFFEaWN0ICpxZGljdCA9IHFvYmplY3RfdG8oUURpY3QsIHFv
YmopOw0KPiArDQo+ICsgICAgaWYgKHFkaWN0ID09IE5VTEwpIHsNCj4gKyAgICAgICAgZXJyb3Jf
c2V0ZyhlcnJwLCAibWFsZm9ybWVkICVzIiwgVkZJT19VU0VSX0NBUCk7DQo+ICsgICAgICAgIHJl
dHVybiAtMTsNCj4gKyAgICB9DQo+ICsgICAgcmV0dXJuIGNhcHNfcGFyc2UocWRpY3QsIGNhcHNf
Y2FwLCBlcnJwKTsNCj4gK30NCj4gKw0KPiArc3RhdGljIHN0cnVjdCBjYXBfZW50cnkgdmVyXzBf
MFtdID0gew0KPiArICAgIHsgVkZJT19VU0VSX0NBUCwgY2hlY2tfY2FwIH0sDQo+ICsgICAgeyBO
VUxMIH0NCj4gK307DQo+ICsNCj4gK3N0YXRpYyBpbnQgY2Fwc19jaGVjayhpbnQgbWlub3IsIGNv
bnN0IGNoYXIgKmNhcHMsIEVycm9yICoqZXJycCkNCj4gK3sNCj4gKyAgICBRT2JqZWN0ICpxb2Jq
Ow0KPiArICAgIFFEaWN0ICpxZGljdDsNCj4gKyAgICBpbnQgcmV0Ow0KPiArDQo+ICsgICAgcW9i
aiA9IHFvYmplY3RfZnJvbV9qc29uKGNhcHMsIE5VTEwpOw0KPiArICAgIGlmIChxb2JqID09IE5V
TEwpIHsNCj4gKyAgICAgICAgZXJyb3Jfc2V0ZyhlcnJwLCAibWFsZm9ybWVkIGNhcGFiaWxpdGll
cyAlcyIsIGNhcHMpOw0KPiArICAgICAgICByZXR1cm4gLTE7DQo+ICsgICAgfQ0KPiArICAgIHFk
aWN0ID0gcW9iamVjdF90byhRRGljdCwgcW9iaik7DQo+ICsgICAgaWYgKHFkaWN0ID09IE5VTEwp
IHsNCj4gKyAgICAgICAgZXJyb3Jfc2V0ZyhlcnJwLCAiY2FwYWJpbGl0aWVzICVzIG5vdCBhbiBv
YmplY3QiLCBjYXBzKTsNCj4gKyAgICAgICAgcW9iamVjdF91bnJlZihxb2JqKTsNCj4gKyAgICAg
ICAgcmV0dXJuIC0xOw0KPiArICAgIH0NCj4gKyAgICByZXQgPSBjYXBzX3BhcnNlKHFkaWN0LCB2
ZXJfMF8wLCBlcnJwKTsNCj4gKw0KPiArICAgIHFvYmplY3RfdW5yZWYocW9iaik7DQo+ICsgICAg
cmV0dXJuIHJldDsNCj4gK30NCj4gKw0KPiArc3RhdGljIEdTdHJpbmcgKmNhcHNfanNvbih2b2lk
KQ0KPiArew0KPiArICAgIFFEaWN0ICpkaWN0ID0gcWRpY3RfbmV3KCk7DQo+ICsgICAgUURpY3Qg
KmNhcGRpY3QgPSBxZGljdF9uZXcoKTsNCj4gKyAgICBRRGljdCAqbWlnZGljdCA9IHFkaWN0X25l
dygpOw0KPiArICAgIEdTdHJpbmcgKnN0cjsNCj4gKw0KPiArICAgIHFkaWN0X3B1dF9pbnQobWln
ZGljdCwgVkZJT19VU0VSX0NBUF9QR1NJWkUsIDQwOTYpOw0KPiArICAgIHFkaWN0X3B1dF9vYmoo
Y2FwZGljdCwgVkZJT19VU0VSX0NBUF9NSUdSLCBRT0JKRUNUKG1pZ2RpY3QpKTsNCj4gKw0KPiAr
ICAgIHFkaWN0X3B1dF9pbnQoY2FwZGljdCwgVkZJT19VU0VSX0NBUF9NQVhfRkRTLA0KPiBWRklP
X1VTRVJfTUFYX01BWF9GRFMpOw0KPiArICAgIHFkaWN0X3B1dF9pbnQoY2FwZGljdCwgVkZJT19V
U0VSX0NBUF9NQVhfWEZFUiwNCj4gVkZJT19VU0VSX0RFRl9NQVhfWEZFUik7DQo+ICsNCj4gKyAg
ICBxZGljdF9wdXRfb2JqKGRpY3QsIFZGSU9fVVNFUl9DQVAsIFFPQkpFQ1QoY2FwZGljdCkpOw0K
PiArDQo+ICsgICAgc3RyID0gcW9iamVjdF90b19qc29uKFFPQkpFQ1QoZGljdCkpOw0KPiArICAg
IHFvYmplY3RfdW5yZWYoZGljdCk7DQo+ICsgICAgcmV0dXJuIHN0cjsNCj4gK30NCj4gKw0KPiAr
aW50IHZmaW9fdXNlcl92YWxpZGF0ZV92ZXJzaW9uKFZGSU9EZXZpY2UgKnZiYXNlZGV2LCBFcnJv
ciAqKmVycnApDQo+ICt7DQo+ICsgICAgZ19hdXRvZnJlZSBWRklPVXNlclZlcnNpb24gKm1zZ3A7
DQo+ICsgICAgR1N0cmluZyAqY2FwczsNCj4gKyAgICBjaGFyICpyZXBseTsNCj4gKyAgICBpbnQg
c2l6ZSwgY2FwbGVuOw0KPiArDQo+ICsgICAgY2FwcyA9IGNhcHNfanNvbigpOw0KPiArICAgIGNh
cGxlbiA9IGNhcHMtPmxlbiArIDE7DQo+ICsgICAgc2l6ZSA9IHNpemVvZigqbXNncCkgKyBjYXBs
ZW47DQo+ICsgICAgbXNncCA9IGdfbWFsbG9jMChzaXplKTsNCj4gKw0KPiArICAgIHZmaW9fdXNl
cl9yZXF1ZXN0X21zZygmbXNncC0+aGRyLCBWRklPX1VTRVJfVkVSU0lPTiwgc2l6ZSwgMCk7DQo+
ICsgICAgbXNncC0+bWFqb3IgPSBWRklPX1VTRVJfTUFKT1JfVkVSOw0KPiArICAgIG1zZ3AtPm1p
bm9yID0gVkZJT19VU0VSX01JTk9SX1ZFUjsNCj4gKyAgICBtZW1jcHkoJm1zZ3AtPmNhcGFiaWxp
dGllcywgY2Fwcy0+c3RyLCBjYXBsZW4pOw0KPiArICAgIGdfc3RyaW5nX2ZyZWUoY2FwcywgdHJ1
ZSk7DQo+ICsNCj4gKyAgICB2ZmlvX3VzZXJfc2VuZF93YWl0KHZiYXNlZGV2LT5wcm94eSwgJm1z
Z3AtPmhkciwgTlVMTCwgMCwgZmFsc2UpOw0KPiArICAgIGlmIChtc2dwLT5oZHIuZmxhZ3MgJiBW
RklPX1VTRVJfRVJST1IpIHsNCj4gKyAgICAgICAgZXJyb3Jfc2V0Z19lcnJubyhlcnJwLCBtc2dw
LT5oZHIuZXJyb3JfcmVwbHksICJ2ZXJzaW9uIHJlcGx5Iik7DQo+ICsgICAgICAgIHJldHVybiAt
MTsNCj4gKyAgICB9DQo+ICsNCj4gKyAgICBpZiAobXNncC0+bWFqb3IgIT0gVkZJT19VU0VSX01B
Sk9SX1ZFUiB8fA0KPiArICAgICAgICBtc2dwLT5taW5vciA+IFZGSU9fVVNFUl9NSU5PUl9WRVIp
IHsNCj4gKyAgICAgICAgZXJyb3Jfc2V0ZyhlcnJwLCAiaW5jb21wYXRpYmxlIHNlcnZlciB2ZXJz
aW9uIik7DQo+ICsgICAgICAgIHJldHVybiAtMTsNCj4gKyAgICB9DQo+ICsNCj4gKyAgICByZXBs
eSA9IG1zZ3AtPmNhcGFiaWxpdGllczsNCj4gKyAgICBpZiAocmVwbHlbbXNncC0+aGRyLnNpemUg
LSBzaXplb2YoKm1zZ3ApIC0gMV0gIT0gJ1wwJykgew0KPiArICAgICAgICBlcnJvcl9zZXRnKGVy
cnAsICJjb3JydXB0IHZlcnNpb24gcmVwbHkiKTsNCj4gKyAgICAgICAgcmV0dXJuIC0xOw0KPiAr
ICAgIH0NCj4gKw0KPiArICAgIGlmIChjYXBzX2NoZWNrKG1zZ3AtPm1pbm9yLCByZXBseSwgZXJy
cCkgIT0gMCkgew0KPiArICAgICAgICByZXR1cm4gLTE7DQo+ICsgICAgfQ0KPiArDQo+ICsgICAg
cmV0dXJuIDA7DQo+ICt9DQo+IC0tDQo+IDEuOC4zLjENCj4gDQoNCg==

