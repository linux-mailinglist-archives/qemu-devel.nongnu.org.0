Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id 27BD06839C9
	for <lists+qemu-devel@lfdr.de>; Tue, 31 Jan 2023 23:57:48 +0100 (CET)
Received: from localhost ([::1] helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces@nongnu.org>)
	id 1pMzYw-0000ng-MY; Tue, 31 Jan 2023 17:57:14 -0500
Received: from eggs.gnu.org ([2001:470:142:3::10])
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1pMzYn-0000gb-CV
 for qemu-devel@nongnu.org; Tue, 31 Jan 2023 17:57:05 -0500
Received: from mx0a-0031df01.pphosted.com ([205.220.168.131])
 by eggs.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1pMzYh-0003uD-RJ
 for qemu-devel@nongnu.org; Tue, 31 Jan 2023 17:57:05 -0500
Received: from pps.filterd (m0279865.ppops.net [127.0.0.1])
 by mx0a-0031df01.pphosted.com (8.17.1.19/8.17.1.19) with ESMTP id
 30VMg3Us026273; Tue, 31 Jan 2023 22:56:55 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=quicinc.com;
 h=from : to : cc :
 subject : date : message-id : in-reply-to : references : mime-version :
 content-type : content-transfer-encoding; s=qcppdkim1;
 bh=lNYvxMCEMh5AfjOCm57m8UfQm9+zPVf4WE7bUeKU6zc=;
 b=AvS0C+BPY1LsFzSJdEGlYyHpx19Byty03T5ULdas7/h3LlXTR1Syq4r4EPyDpPMMQV35
 8uYUaBKvBiERNlJJupUmJ8walxAgtdcqmv85/ztF8IcflCbw0qvOk/T24y0Vdcns5Yq/
 gjc2Af76jBgoHub6wp2WpkFuHxbcFVB/ZMmIkdldY2Npnk1SCePDYl1YcVKckjPohS96
 D8Pbs5KzD42soNtav0oT6IMupDe9LWgXVgtocwYro1rfKlEdJ7GwSPD0uetlDe7ElWc4
 ZLQamvlaQ58hd3v4M7e1MWY6ixgOgRTiVuXnaaMXs4Rawo8LF4MYt571BcAi1Iy3n1j4 dQ== 
Received: from nalasppmta04.qualcomm.com (Global_NAT1.qualcomm.com
 [129.46.96.20])
 by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 3nexg41u5v-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Tue, 31 Jan 2023 22:56:55 +0000
Received: from pps.filterd (NALASPPMTA04.qualcomm.com [127.0.0.1])
 by NALASPPMTA04.qualcomm.com (8.17.1.5/8.17.1.5) with ESMTP id 30VMus8b026086; 
 Tue, 31 Jan 2023 22:56:54 GMT
Received: from pps.reinject (localhost [127.0.0.1])
 by NALASPPMTA04.qualcomm.com (PPS) with ESMTPS id 3ncvskts9g-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NO);
 Tue, 31 Jan 2023 22:56:54 +0000
Received: from NALASPPMTA04.qualcomm.com (NALASPPMTA04.qualcomm.com
 [127.0.0.1])
 by pps.reinject (8.17.1.5/8.17.1.5) with ESMTP id 30VMusaH026069;
 Tue, 31 Jan 2023 22:56:54 GMT
Received: from hu-devc-lv-u18-c.qualcomm.com (hu-tsimpson-lv.qualcomm.com
 [10.47.235.220])
 by NALASPPMTA04.qualcomm.com (PPS) with ESMTP id 30VMureV026062;
 Tue, 31 Jan 2023 22:56:54 +0000
Received: by hu-devc-lv-u18-c.qualcomm.com (Postfix, from userid 47164)
 id 028275000B1; Tue, 31 Jan 2023 14:56:53 -0800 (PST)
From: Taylor Simpson <tsimpson@quicinc.com>
To: qemu-devel@nongnu.org
Cc: tsimpson@quicinc.com, richard.henderson@linaro.org, philmd@linaro.org,
 ale@rev.ng, anjo@rev.ng, bcain@quicinc.com, quic_mathbern@quicinc.com
Subject: [PATCH v5 05/14] Hexagon (target/hexagon) Analyze packet before
 generating TCG
Date: Tue, 31 Jan 2023 14:56:38 -0800
Message-Id: <20230131225647.25274-6-tsimpson@quicinc.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20230131225647.25274-1-tsimpson@quicinc.com>
References: <20230131225647.25274-1-tsimpson@quicinc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
X-QCInternal: smtphost
X-QCInternal: smtphost
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-GUID: 9GOGf7WE3OajOTkWM9O62OJV36aGnyXs
X-Proofpoint-ORIG-GUID: 9GOGf7WE3OajOTkWM9O62OJV36aGnyXs
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.219,Aquarius:18.0.930,Hydra:6.0.562,FMLib:17.11.122.1
 definitions=2023-01-31_08,2023-01-31_01,2022-06-22_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 malwarescore=0
 lowpriorityscore=0 suspectscore=0 spamscore=0 phishscore=0 adultscore=0
 priorityscore=1501 impostorscore=0 mlxscore=0 clxscore=1015
 mlxlogscore=731 bulkscore=0 classifier=spam adjust=0 reason=mlx
 scancount=1 engine=8.12.0-2212070000 definitions=main-2301310197
Received-SPF: pass client-ip=205.220.168.131;
 envelope-from=tsimpson@qualcomm.com; helo=mx0a-0031df01.pphosted.com
X-Spam_score_int: -24
X-Spam_score: -2.5
X-Spam_bar: --
X-Spam_report: (-2.5 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, HEADER_FROM_DIFFERENT_DOMAINS=0.25,
 RCVD_IN_DNSWL_LOW=-0.7, SPF_HELO_NONE=0.001,
 SPF_PASS=-0.001 autolearn=ham autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org

V2UgY3JlYXRlIGEgbmV3IGdlbmVyYXRvciB0aGF0IGNyZWF0ZXMgYW4gYW5hbHl6ZV88dGFnPiBm
dW5jdGlvbiBmb3IKZWFjaCBpbnN0cnVjdGlvbi4gIEN1cnJlbnRseSwgdGhlc2UgZnVuY3Rpb25z
IHJlY29yZCB0aGUgd3JpdGVzIHRvClIsIFAsIGFuZCBDIHJlZ2lzdGVycyBieSBjYWxsaW5nIGN0
eF9sb2dfcmVnX3dyaXRlW19wYWlyXSBvcgpjdHhfbG9nX3ByZWRfd3JpdGUuCgpEdXJpbmcgZ2Vu
X3N0YXJ0X3BhY2tldCwgd2UgaW52b2tlIHRoZSBhbmFseXplXzx0YWc+IGZ1bmN0aW9uIGZvcgpl
YWNoIGluc3RydWN0aW9uIGluIHRoZSBwYWNrZXQsIGFuZCB3ZSBtYXJrIHRoZSBpbXBsaWNpdCBy
ZWdpc3RlcgphbmQgcHJlZGljYXRlIHdyaXRlcy4KCkRvaW5nIHRoZSBhbmFseXNpcyB1cCBmcm9u
dCBoYXMgc2V2ZXJhbCBhZHZhbnRhZ2VzCi0gV2UgcmVtb3ZlIGNhbGxzIHRvIGN0eF9sb2dfKiBm
cm9tIGdlbl90Y2dfZnVuY3MucHkgYW5kIGdlbnB0ci5jCi0gQWZ0ZXIgdGhlIGFuYWx5c2lzIGlz
IHBlcmZvcm1lZCwgd2UgY2FuIGluaXRpYWxpemUgaGV4X25ld192YWx1ZQogIGZvciBlYWNoIG9m
IHRoZSBwcmVkaWNhdGVkIGFzc2lnbm1lbnRzIHJhdGhlciB0aGFuIGR1cmluZyBUQ0cKICBnZW5l
cmF0aW9uIGZvciB0aGUgaW5zdHJ1Y3Rpb25zCi0gVGhpcyBpcyBhIHN0ZXBwaW5nIHN0b25lIGZv
ciBmdXR1cmUgd29yayB3aGVyZSB0aGUgYW5hbHlzaXMgd2lsbAogIGluY2x1ZGUgdGhlIHNldCBv
ZiByZWdpc3RlcnMgdGhhdCBhcmUgcmVhZC4gIEluIGNhc2VzIHdoZXJlCiAgdGhlIHBhY2tldCBk
b2Vzbid0IGhhdmUgYW4gb3ZlcmxhcCBiZXR3ZWVuIHRoZSByZWdpc3RlcnMgdGhhdCBhcmUKICB3
cml0dGVuIGFuZCByZWdpc3RlcnMgdGhhdCBhcmUgcmVhZCwgd2UgY2FuIGF2b2lkIHRoZSBpbnRl
cm1lZGlhdGUKICBzdGVwIG9mIHdyaXRpbmcgdG8gaGV4X25ld192YWx1ZS4gIE5vdGUgdGhhdCBv
dGhlciBjaGVja3Mgd2lsbCBhbHNvCiAgYmUgbmVlZGVkIChlLmcuLCBubyBpbnN0cnVjdGlvbnMg
Y2FuIHJhaXNlIGFuIGV4Y2VwdGlvbikuCgpTaWduZWQtb2ZmLWJ5OiBUYXlsb3IgU2ltcHNvbiA8
dHNpbXBzb25AcXVpY2luYy5jb20+Ci0tLQogdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmggICAg
ICAgICAgICAgICAgICB8ICA0NiArKy0tCiB0YXJnZXQvaGV4YWdvbi9nZW5wdHIuYyAgICAgICAg
ICAgICAgICAgICAgIHwgICA1ICstCiB0YXJnZXQvaGV4YWdvbi9pZGVmLXBhcnNlci9wYXJzZXIt
aGVscGVycy5jIHwgICA3ICstCiB0YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuYyAgICAgICAgICAg
ICAgICAgIHwgMTYyICsrKysrKystLS0tLS0KIHRhcmdldC9oZXhhZ29uL1JFQURNRSAgICAgICAg
ICAgICAgICAgICAgICAgfCAgMTAgKy0KIHRhcmdldC9oZXhhZ29uL2dlbl9hbmFseXplX2Z1bmNz
LnB5ICAgICAgICAgfCAyMzcgKysrKysrKysrKysrKysrKysrKysKIHRhcmdldC9oZXhhZ29uL2dl
bl90Y2dfZnVuY3MucHkgICAgICAgICAgICAgfCAgMjMgKy0KIHRhcmdldC9oZXhhZ29uL21lc29u
LmJ1aWxkICAgICAgICAgICAgICAgICAgfCAgMTEgKy0KIDggZmlsZXMgY2hhbmdlZCwgMzgzIGlu
c2VydGlvbnMoKyksIDExOCBkZWxldGlvbnMoLSkKIGNyZWF0ZSBtb2RlIDEwMDc1NSB0YXJnZXQv
aGV4YWdvbi9nZW5fYW5hbHl6ZV9mdW5jcy5weQoKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29u
L3RyYW5zbGF0ZS5oIGIvdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmgKaW5kZXggZDk3MWY0ZjA5
NS4uZDQ1ZDNhNGJiMCAxMDA2NDQKLS0tIGEvdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmgKKysr
IGIvdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmgKQEAgLTEsNSArMSw1IEBACiAvKgotICogIENv
cHlyaWdodChjKSAyMDE5LTIwMjIgUXVhbGNvbW0gSW5ub3ZhdGlvbiBDZW50ZXIsIEluYy4gQWxs
IFJpZ2h0cyBSZXNlcnZlZC4KKyAqICBDb3B5cmlnaHQoYykgMjAxOS0yMDIzIFF1YWxjb21tIElu
bm92YXRpb24gQ2VudGVyLCBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAgKgogICogIFRoaXMg
cHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3Ig
bW9kaWZ5CiAgKiAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMg
TGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKQEAgLTM4LDYgKzM4LDcgQEAgdHlwZWRlZiBzdHJ1Y3Qg
RGlzYXNDb250ZXh0IHsKICAgICBpbnQgcmVnX2xvZ1tSRUdfV1JJVEVTX01BWF07CiAgICAgaW50
IHJlZ19sb2dfaWR4OwogICAgIERFQ0xBUkVfQklUTUFQKHJlZ3Nfd3JpdHRlbiwgVE9UQUxfUEVS
X1RIUkVBRF9SRUdTKTsKKyAgICBERUNMQVJFX0JJVE1BUChwcmVkaWNhdGVkX3JlZ3MsIFRPVEFM
X1BFUl9USFJFQURfUkVHUyk7CiAgICAgaW50IHByZWdfbG9nW1BSRURfV1JJVEVTX01BWF07CiAg
ICAgaW50IHByZWdfbG9nX2lkeDsKICAgICBERUNMQVJFX0JJVE1BUChwcmVnc193cml0dGVuLCBO
VU1fUFJFR1MpOwpAQCAtNjIsMzIgKzYzLDM5IEBAIHR5cGVkZWYgc3RydWN0IERpc2FzQ29udGV4
dCB7CiAgICAgYm9vbCBpc190aWdodF9sb29wOwogfSBEaXNhc0NvbnRleHQ7CiAKLXN0YXRpYyBp
bmxpbmUgdm9pZCBjdHhfbG9nX3JlZ193cml0ZShEaXNhc0NvbnRleHQgKmN0eCwgaW50IHJudW0p
CitzdGF0aWMgaW5saW5lIHZvaWQgY3R4X2xvZ19wcmVkX3dyaXRlKERpc2FzQ29udGV4dCAqY3R4
LCBpbnQgcG51bSkKIHsKLSAgICBpZiAodGVzdF9iaXQocm51bSwgY3R4LT5yZWdzX3dyaXR0ZW4p
KSB7Ci0gICAgICAgIEhFWF9ERUJVR19MT0coIldBUk5JTkc6IE11bHRpcGxlIHdyaXRlcyB0byBy
JWRcbiIsIHJudW0pOworICAgIGlmICghdGVzdF9iaXQocG51bSwgY3R4LT5wcmVnc193cml0dGVu
KSkgeworICAgICAgICBjdHgtPnByZWdfbG9nW2N0eC0+cHJlZ19sb2dfaWR4XSA9IHBudW07Cisg
ICAgICAgIGN0eC0+cHJlZ19sb2dfaWR4Kys7CisgICAgICAgIHNldF9iaXQocG51bSwgY3R4LT5w
cmVnc193cml0dGVuKTsKICAgICB9Ci0gICAgY3R4LT5yZWdfbG9nW2N0eC0+cmVnX2xvZ19pZHhd
ID0gcm51bTsKLSAgICBjdHgtPnJlZ19sb2dfaWR4Kys7Ci0gICAgc2V0X2JpdChybnVtLCBjdHgt
PnJlZ3Nfd3JpdHRlbik7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgdm9pZCBjdHhfbG9nX3JlZ193cml0
ZV9wYWlyKERpc2FzQ29udGV4dCAqY3R4LCBpbnQgcm51bSkKLXsKLSAgICBjdHhfbG9nX3JlZ193
cml0ZShjdHgsIHJudW0pOwotICAgIGN0eF9sb2dfcmVnX3dyaXRlKGN0eCwgcm51bSArIDEpOwog
fQogCi1zdGF0aWMgaW5saW5lIHZvaWQgY3R4X2xvZ19wcmVkX3dyaXRlKERpc2FzQ29udGV4dCAq
Y3R4LCBpbnQgcG51bSkKK3N0YXRpYyBpbmxpbmUgdm9pZCBjdHhfbG9nX3JlZ193cml0ZShEaXNh
c0NvbnRleHQgKmN0eCwgaW50IHJudW0sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgYm9vbCBpc19wcmVkaWNhdGVkKQogewotICAgIGN0eC0+cHJlZ19sb2dbY3R4LT5wcmVn
X2xvZ19pZHhdID0gcG51bTsKLSAgICBjdHgtPnByZWdfbG9nX2lkeCsrOwotICAgIHNldF9iaXQo
cG51bSwgY3R4LT5wcmVnc193cml0dGVuKTsKKyAgICBpZiAocm51bSA9PSBIRVhfUkVHX1AzXzBf
QUxJQVNFRCkgeworICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IE5VTV9QUkVHUzsgaSsrKSB7
CisgICAgICAgICAgICBjdHhfbG9nX3ByZWRfd3JpdGUoY3R4LCBpKTsKKyAgICAgICAgfQorICAg
IH0gZWxzZSB7CisgICAgICAgIGlmICghdGVzdF9iaXQocm51bSwgY3R4LT5yZWdzX3dyaXR0ZW4p
KSB7CisgICAgICAgICAgICBjdHgtPnJlZ19sb2dbY3R4LT5yZWdfbG9nX2lkeF0gPSBybnVtOwor
ICAgICAgICAgICAgY3R4LT5yZWdfbG9nX2lkeCsrOworICAgICAgICAgICAgc2V0X2JpdChybnVt
LCBjdHgtPnJlZ3Nfd3JpdHRlbik7CisgICAgICAgIH0KKyAgICAgICAgaWYgKGlzX3ByZWRpY2F0
ZWQpIHsKKyAgICAgICAgICAgIHNldF9iaXQocm51bSwgY3R4LT5wcmVkaWNhdGVkX3JlZ3MpOwor
ICAgICAgICB9CisgICAgfQogfQogCi1zdGF0aWMgaW5saW5lIGJvb2wgaXNfcHJlbG9hZGVkKERp
c2FzQ29udGV4dCAqY3R4LCBpbnQgbnVtKQorc3RhdGljIGlubGluZSB2b2lkIGN0eF9sb2dfcmVn
X3dyaXRlX3BhaXIoRGlzYXNDb250ZXh0ICpjdHgsIGludCBybnVtLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCBpc19wcmVkaWNhdGVkKQogewotICAgIHJl
dHVybiB0ZXN0X2JpdChudW0sIGN0eC0+cmVnc193cml0dGVuKTsKKyAgICBjdHhfbG9nX3JlZ193
cml0ZShjdHgsIHJudW0sIGlzX3ByZWRpY2F0ZWQpOworICAgIGN0eF9sb2dfcmVnX3dyaXRlKGN0
eCwgcm51bSArIDEsIGlzX3ByZWRpY2F0ZWQpOwogfQogCiBzdGF0aWMgaW5saW5lIGJvb2wgaXNf
dnJlZ19wcmVsb2FkZWQoRGlzYXNDb250ZXh0ICpjdHgsIGludCBudW0pCmRpZmYgLS1naXQgYS90
YXJnZXQvaGV4YWdvbi9nZW5wdHIuYyBiL3RhcmdldC9oZXhhZ29uL2dlbnB0ci5jCmluZGV4IGVm
ZDM2Zjc2MGYuLjY3ZWMzYWM1NTEgMTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29uL2dlbnB0ci5j
CisrKyBiL3RhcmdldC9oZXhhZ29uL2dlbnB0ci5jCkBAIC0xODksNiArMTg5LDcgQEAgdm9pZCBn
ZW5fbG9nX3ByZWRfd3JpdGUoRGlzYXNDb250ZXh0ICpjdHgsIGludCBwbnVtLCBUQ0d2IHZhbCkK
ICAgICAgICAgICAgICAgICAgICAgICAgaGV4X25ld19wcmVkX3ZhbHVlW3BudW1dLCBiYXNlX3Zh
bCk7CiAgICAgfQogICAgIHRjZ19nZW5fb3JpX3RsKGhleF9wcmVkX3dyaXR0ZW4sIGhleF9wcmVk
X3dyaXR0ZW4sIDEgPDwgcG51bSk7CisgICAgc2V0X2JpdChwbnVtLCBjdHgtPnByZWdzX3dyaXR0
ZW4pOwogCiAgICAgdGNnX3RlbXBfZnJlZShiYXNlX3ZhbCk7CiB9CkBAIC0yNzEsNyArMjcyLDYg
QEAgc3RhdGljIHZvaWQgZ2VuX3dyaXRlX3AzXzAoRGlzYXNDb250ZXh0ICpjdHgsIFRDR3YgY29u
dHJvbF9yZWcpCiAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBOVU1fUFJFR1M7IGkrKykgewogICAg
ICAgICB0Y2dfZ2VuX2V4dHJhY3RfdGwoaGV4X3A4LCBjb250cm9sX3JlZywgaSAqIDgsIDgpOwog
ICAgICAgICBnZW5fbG9nX3ByZWRfd3JpdGUoY3R4LCBpLCBoZXhfcDgpOwotICAgICAgICBjdHhf
bG9nX3ByZWRfd3JpdGUoY3R4LCBpKTsKICAgICB9CiAgICAgdGNnX3RlbXBfZnJlZShoZXhfcDgp
OwogfQpAQCAtMjkwLDcgKzI5MCw2IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBnZW5fd3JpdGVfY3Ry
bF9yZWcoRGlzYXNDb250ZXh0ICpjdHgsIGludCByZWdfbnVtLAogICAgICAgICBnZW5fd3JpdGVf
cDNfMChjdHgsIHZhbCk7CiAgICAgfSBlbHNlIHsKICAgICAgICAgZ2VuX2xvZ19yZWdfd3JpdGUo
cmVnX251bSwgdmFsKTsKLSAgICAgICAgY3R4X2xvZ19yZWdfd3JpdGUoY3R4LCByZWdfbnVtKTsK
ICAgICAgICAgaWYgKHJlZ19udW0gPT0gSEVYX1JFR19RRU1VX1BLVF9DTlQpIHsKICAgICAgICAg
ICAgIGN0eC0+bnVtX3BhY2tldHMgPSAwOwogICAgICAgICB9CkBAIC0zMTMsMTAgKzMxMiw4IEBA
IHN0YXRpYyBpbmxpbmUgdm9pZCBnZW5fd3JpdGVfY3RybF9yZWdfcGFpcihEaXNhc0NvbnRleHQg
KmN0eCwgaW50IHJlZ19udW0sCiAgICAgICAgIHRjZ19nZW5fZXh0cmhfaTY0X2kzMih2YWwzMiwg
dmFsKTsKICAgICAgICAgZ2VuX2xvZ19yZWdfd3JpdGUocmVnX251bSArIDEsIHZhbDMyKTsKICAg
ICAgICAgdGNnX3RlbXBfZnJlZSh2YWwzMik7Ci0gICAgICAgIGN0eF9sb2dfcmVnX3dyaXRlKGN0
eCwgcmVnX251bSArIDEpOwogICAgIH0gZWxzZSB7CiAgICAgICAgIGdlbl9sb2dfcmVnX3dyaXRl
X3BhaXIocmVnX251bSwgdmFsKTsKLSAgICAgICAgY3R4X2xvZ19yZWdfd3JpdGVfcGFpcihjdHgs
IHJlZ19udW0pOwogICAgICAgICBpZiAocmVnX251bSA9PSBIRVhfUkVHX1FFTVVfUEtUX0NOVCkg
ewogICAgICAgICAgICAgY3R4LT5udW1fcGFja2V0cyA9IDA7CiAgICAgICAgICAgICBjdHgtPm51
bV9pbnNucyA9IDA7CmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi9pZGVmLXBhcnNlci9wYXJz
ZXItaGVscGVycy5jIGIvdGFyZ2V0L2hleGFnb24vaWRlZi1wYXJzZXIvcGFyc2VyLWhlbHBlcnMu
YwppbmRleCA4MTEwNjg2YzUxLi5kZTk4Mzg4MDZiIDEwMDY0NAotLS0gYS90YXJnZXQvaGV4YWdv
bi9pZGVmLXBhcnNlci9wYXJzZXItaGVscGVycy5jCisrKyBiL3RhcmdldC9oZXhhZ29uL2lkZWYt
cGFyc2VyL3BhcnNlci1oZWxwZXJzLmMKQEAgLTEsNSArMSw1IEBACiAvKgotICogIENvcHlyaWdo
dChjKSAyMDE5LTIwMjIgcmV2Lm5nIExhYnMgU3JsLiBBbGwgUmlnaHRzIFJlc2VydmVkLgorICog
IENvcHlyaWdodChjKSAyMDE5LTIwMjMgcmV2Lm5nIExhYnMgU3JsLiBBbGwgUmlnaHRzIFJlc2Vy
dmVkLgogICoKICAqICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRp
c3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQogICogIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUg
R05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5CkBAIC0xNDM4LDEwICsx
NDM4LDYgQEAgdm9pZCBnZW5fd3JpdGVfcmVnKENvbnRleHQgKmMsIFlZTFRZUEUgKmxvY3AsIEhl
eFZhbHVlICpyZWcsIEhleFZhbHVlICp2YWx1ZSkKICAgICAgICAgbG9jcCwKICAgICAgICAgImdl
bl9sb2dfcmVnX3dyaXRlKCIsICZyZWctPnJlZy5pZCwgIiwgIiwKICAgICAgICAgJnZhbHVlX20s
ICIpO1xuIik7Ci0gICAgT1VUKGMsCi0gICAgICAgIGxvY3AsCi0gICAgICAgICJjdHhfbG9nX3Jl
Z193cml0ZShjdHgsICIsICZyZWctPnJlZy5pZCwKLSAgICAgICAgIik7XG4iKTsKICAgICBnZW5f
cnZhbHVlX2ZyZWUoYywgbG9jcCwgcmVnKTsKICAgICBnZW5fcnZhbHVlX2ZyZWUoYywgbG9jcCwg
JnZhbHVlX20pOwogfQpAQCAtMTg5NCw3ICsxODkwLDYgQEAgdm9pZCBnZW5fcHJlZF9hc3NpZ24o
Q29udGV4dCAqYywgWVlMVFlQRSAqbG9jcCwgSGV4VmFsdWUgKmxlZnRfcHJlZCwKICAgICBpZiAo
aXNfZGlyZWN0KSB7CiAgICAgICAgIE9VVChjLCBsb2NwLCAiZ2VuX2xvZ19wcmVkX3dyaXRlKGN0
eCwgIiwgcHJlZF9pZCwgIiwgIiwgbGVmdF9wcmVkLAogICAgICAgICAgICAgIik7XG4iKTsKLSAg
ICAgICAgT1VUKGMsIGxvY3AsICJjdHhfbG9nX3ByZWRfd3JpdGUoY3R4LCAiLCBwcmVkX2lkLCAi
KTtcbiIpOwogICAgICAgICBnZW5fcnZhbHVlX2ZyZWUoYywgbG9jcCwgbGVmdF9wcmVkKTsKICAg
ICB9CiAgICAgLyogRnJlZSB0ZW1wb3JhcnkgdmFsdWUgKi8KZGlmZiAtLWdpdCBhL3RhcmdldC9o
ZXhhZ29uL3RyYW5zbGF0ZS5jIGIvdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmMKaW5kZXggNzVm
MjhlMDhhZC4uZmVkY2Y4NzMwYyAxMDA2NDQKLS0tIGEvdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRl
LmMKKysrIGIvdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmMKQEAgLTEsNSArMSw1IEBACiAvKgot
ICogIENvcHlyaWdodChjKSAyMDE5LTIwMjIgUXVhbGNvbW0gSW5ub3ZhdGlvbiBDZW50ZXIsIElu
Yy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KKyAqICBDb3B5cmlnaHQoYykgMjAxOS0yMDIzIFF1YWxj
b21tIElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAgKgogICog
IFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBh
bmQvb3IgbW9kaWZ5CiAgKiAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQ
dWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKQEAgLTI5LDYgKzI5LDE1IEBACiAjaW5jbHVk
ZSAidHJhbnNsYXRlLmgiCiAjaW5jbHVkZSAicHJpbnRpbnNuLmgiCiAKKyNpbmNsdWRlICJhbmFs
eXplX2Z1bmNzX2dlbmVyYXRlZC5jLmluYyIKKwordHlwZWRlZiB2b2lkICgqQW5hbHl6ZUluc24p
KERpc2FzQ29udGV4dCAqY3R4KTsKK3N0YXRpYyBjb25zdCBBbmFseXplSW5zbiBvcGNvZGVfYW5h
bHl6ZVtYWF9MQVNUX09QQ09ERV0gPSB7CisjZGVmaW5lIE9QQ09ERShYKSAgICBbWF0gPSBhbmFs
eXplXyMjWAorI2luY2x1ZGUgIm9wY29kZXNfZGVmX2dlbmVyYXRlZC5oLmluYyIKKyN1bmRlZiBP
UENPREUKK307CisKIFRDR3YgaGV4X2dwcltUT1RBTF9QRVJfVEhSRUFEX1JFR1NdOwogVENHdiBo
ZXhfcHJlZFtOVU1fUFJFR1NdOwogVENHdiBoZXhfdGhpc19QQzsKQEAgLTI2NSw2ICsyNzQsNzYg
QEAgc3RhdGljIGJvb2wgbmVlZF9uZXh0X1BDKERpc2FzQ29udGV4dCAqY3R4KQogICAgIHJldHVy
biBmYWxzZTsKIH0KIAorLyoKKyAqIFRoZSBvcGNvZGVfYW5hbHl6ZSBmdW5jdGlvbnMgbWFyayBt
b3N0IG9mIHRoZSB3cml0ZXMgaW4gYSBwYWNrZXQKKyAqIEhvd2V2ZXIsIHRoZXJlIGFyZSBzb21l
IGltcGxpY2l0IHdyaXRlcyBtYXJrZWQgYXMgYXR0cmlidXRlcworICogb2YgdGhlIGFwcGxpY2Fi
bGUgaW5zdHJ1Y3Rpb25zLgorICovCitzdGF0aWMgdm9pZCBtYXJrX2ltcGxpY2l0X3JlZ193cml0
ZShEaXNhc0NvbnRleHQgKmN0eCwgaW50IGF0dHJpYiwgaW50IHJudW0pCit7CisgICAgdWludDE2
X3Qgb3Bjb2RlID0gY3R4LT5pbnNuLT5vcGNvZGU7CisgICAgaWYgKEdFVF9BVFRSSUIob3Bjb2Rl
LCBhdHRyaWIpKSB7CisgICAgICAgIC8qCisgICAgICAgICAqIFVTUiBpcyB1c2VkIHRvIHNldCBv
dmVyZmxvdyBhbmQgRlAgZXhjZXB0aW9ucywKKyAgICAgICAgICogc28gdHJlYXQgaXQgYXMgY29u
ZGl0aW9uYWwKKyAgICAgICAgICovCisgICAgICAgIGJvb2wgaXNfcHJlZGljYXRlZCA9IEdFVF9B
VFRSSUIob3Bjb2RlLCBBX0NPTkRFWEVDKSB8fAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBybnVtID09IEhFWF9SRUdfVVNSOworCisgICAgICAgIC8qIExDMC9MQzEgaXMgY29uZGl0aW9u
YWxseSB3cml0dGVuIGJ5IGVuZGxvb3AgaW5zdHJ1Y3Rpb25zICovCisgICAgICAgIGlmICgocm51
bSA9PSBIRVhfUkVHX0xDMCB8fCBybnVtID09IEhFWF9SRUdfTEMxKSAmJgorICAgICAgICAgICAg
KG9wY29kZSA9PSBKMl9lbmRsb29wMCB8fAorICAgICAgICAgICAgIG9wY29kZSA9PSBKMl9lbmRs
b29wMSB8fAorICAgICAgICAgICAgIG9wY29kZSA9PSBKMl9lbmRsb29wMDEpKSB7CisgICAgICAg
ICAgICBpc19wcmVkaWNhdGVkID0gdHJ1ZTsKKyAgICAgICAgfQorCisgICAgICAgIGN0eF9sb2df
cmVnX3dyaXRlKGN0eCwgcm51bSwgaXNfcHJlZGljYXRlZCk7CisgICAgfQorfQorCitzdGF0aWMg
dm9pZCBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZXMoRGlzYXNDb250ZXh0ICpjdHgpCit7CisgICAg
bWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19GUCwgIEhFWF9S
RUdfRlApOworICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklU
RVNfU1AsICBIRVhfUkVHX1NQKTsKKyAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFf
SU1QTElDSVRfV1JJVEVTX0xSLCAgSEVYX1JFR19MUik7CisgICAgbWFya19pbXBsaWNpdF9yZWdf
d3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19MQzAsIEhFWF9SRUdfTEMwKTsKKyAgICBtYXJr
X2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX1NBMCwgSEVYX1JFR19T
QTApOworICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNf
TEMxLCBIRVhfUkVHX0xDMSk7CisgICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0lN
UExJQ0lUX1dSSVRFU19TQTEsIEhFWF9SRUdfU0ExKTsKKyAgICBtYXJrX2ltcGxpY2l0X3JlZ193
cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX1VTUiwgSEVYX1JFR19VU1IpOworICAgIG1hcmtf
aW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9GUE9QLCBIRVhfUkVHX1VTUik7Cit9CisKK3N0YXRp
YyB2b2lkIG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZShEaXNhc0NvbnRleHQgKmN0eCwgaW50IGF0
dHJpYiwgaW50IHBudW0pCit7CisgICAgaWYgKEdFVF9BVFRSSUIoY3R4LT5pbnNuLT5vcGNvZGUs
IGF0dHJpYikpIHsKKyAgICAgICAgY3R4X2xvZ19wcmVkX3dyaXRlKGN0eCwgcG51bSk7CisgICAg
fQorfQorCitzdGF0aWMgdm9pZCBtYXJrX2ltcGxpY2l0X3ByZWRfd3JpdGVzKERpc2FzQ29udGV4
dCAqY3R4KQoreworICAgIG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZShjdHgsIEFfSU1QTElDSVRf
V1JJVEVTX1AwLCAwKTsKKyAgICBtYXJrX2ltcGxpY2l0X3ByZWRfd3JpdGUoY3R4LCBBX0lNUExJ
Q0lUX1dSSVRFU19QMSwgMSk7CisgICAgbWFya19pbXBsaWNpdF9wcmVkX3dyaXRlKGN0eCwgQV9J
TVBMSUNJVF9XUklURVNfUDIsIDIpOworICAgIG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZShjdHgs
IEFfSU1QTElDSVRfV1JJVEVTX1AzLCAzKTsKK30KKworc3RhdGljIHZvaWQgYW5hbHl6ZV9wYWNr
ZXQoRGlzYXNDb250ZXh0ICpjdHgpCit7CisgICAgUGFja2V0ICpwa3QgPSBjdHgtPnBrdDsKKyAg
ICBmb3IgKGludCBpID0gMDsgaSA8IHBrdC0+bnVtX2luc25zOyBpKyspIHsKKyAgICAgICAgSW5z
biAqaW5zbiA9ICZwa3QtPmluc25baV07CisgICAgICAgIGN0eC0+aW5zbiA9IGluc247CisgICAg
ICAgIGlmIChvcGNvZGVfYW5hbHl6ZVtpbnNuLT5vcGNvZGVdKSB7CisgICAgICAgICAgICBvcGNv
ZGVfYW5hbHl6ZVtpbnNuLT5vcGNvZGVdKGN0eCk7CisgICAgICAgIH0KKyAgICAgICAgbWFya19p
bXBsaWNpdF9yZWdfd3JpdGVzKGN0eCk7CisgICAgICAgIG1hcmtfaW1wbGljaXRfcHJlZF93cml0
ZXMoY3R4KTsKKyAgICB9Cit9CisKIHN0YXRpYyB2b2lkIGdlbl9zdGFydF9wYWNrZXQoRGlzYXND
b250ZXh0ICpjdHgpCiB7CiAgICAgUGFja2V0ICpwa3QgPSBjdHgtPnBrdDsKQEAgLTI3NSw2ICsz
NTQsNyBAQCBzdGF0aWMgdm9pZCBnZW5fc3RhcnRfcGFja2V0KERpc2FzQ29udGV4dCAqY3R4KQog
ICAgIGN0eC0+bmV4dF9QQyA9IG5leHRfUEM7CiAgICAgY3R4LT5yZWdfbG9nX2lkeCA9IDA7CiAg
ICAgYml0bWFwX3plcm8oY3R4LT5yZWdzX3dyaXR0ZW4sIFRPVEFMX1BFUl9USFJFQURfUkVHUyk7
CisgICAgYml0bWFwX3plcm8oY3R4LT5wcmVkaWNhdGVkX3JlZ3MsIFRPVEFMX1BFUl9USFJFQURf
UkVHUyk7CiAgICAgY3R4LT5wcmVnX2xvZ19pZHggPSAwOwogICAgIGJpdG1hcF96ZXJvKGN0eC0+
cHJlZ3Nfd3JpdHRlbiwgTlVNX1BSRUdTKTsKICAgICBjdHgtPmZ1dHVyZV92cmVnc19pZHggPSAw
OwpAQCAtMjkxLDYgKzM3MSwxNCBAQCBzdGF0aWMgdm9pZCBnZW5fc3RhcnRfcGFja2V0KERpc2Fz
Q29udGV4dCAqY3R4KQogICAgIGN0eC0+czFfc3RvcmVfcHJvY2Vzc2VkID0gZmFsc2U7CiAgICAg
Y3R4LT5wcmVfY29tbWl0ID0gdHJ1ZTsKIAorICAgIGFuYWx5emVfcGFja2V0KGN0eCk7CisKKyAg
ICAvKgorICAgICAqIHByZWdzX3dyaXR0ZW4gaXMgdXNlZCBib3RoIGluIHRoZSBhbmFseXplIHBo
YXNlIGFzIHdlbGwgYXMgdGhlIGNvZGUKKyAgICAgKiBnZW4gcGhhc2UsIHNvIGNsZWFyIGl0IGFn
YWluLgorICAgICAqLworICAgIGJpdG1hcF96ZXJvKGN0eC0+cHJlZ3Nfd3JpdHRlbiwgTlVNX1BS
RUdTKTsKKwogICAgIGlmIChIRVhfREVCVUcpIHsKICAgICAgICAgLyogSGFuZHkgcGxhY2UgdG8g
c2V0IGEgYnJlYWtwb2ludCBiZWZvcmUgdGhlIHBhY2tldCBleGVjdXRlcyAqLwogICAgICAgICBn
ZW5faGVscGVyX2RlYnVnX3N0YXJ0X3BhY2tldChjcHVfZW52KTsKQEAgLTMxMyw2ICs0MDEsMTYg
QEAgc3RhdGljIHZvaWQgZ2VuX3N0YXJ0X3BhY2tldChEaXNhc0NvbnRleHQgKmN0eCkKICAgICAg
ICAgdGNnX2dlbl9tb3ZpX3RsKGhleF9wcmVkX3dyaXR0ZW4sIDApOwogICAgIH0KIAorICAgIC8q
IFByZWxvYWQgdGhlIHByZWRpY2F0ZWQgcmVnaXN0ZXJzIGludG8gaGV4X25ld192YWx1ZVtpXSAq
LworICAgIGlmICghYml0bWFwX2VtcHR5KGN0eC0+cHJlZGljYXRlZF9yZWdzLCBUT1RBTF9QRVJf
VEhSRUFEX1JFR1MpKSB7CisgICAgICAgIGludCBpID0gZmluZF9maXJzdF9iaXQoY3R4LT5wcmVk
aWNhdGVkX3JlZ3MsIFRPVEFMX1BFUl9USFJFQURfUkVHUyk7CisgICAgICAgIHdoaWxlIChpIDwg
VE9UQUxfUEVSX1RIUkVBRF9SRUdTKSB7CisgICAgICAgICAgICB0Y2dfZ2VuX21vdl90bChoZXhf
bmV3X3ZhbHVlW2ldLCBoZXhfZ3ByW2ldKTsKKyAgICAgICAgICAgIGkgPSBmaW5kX25leHRfYml0
KGN0eC0+cHJlZGljYXRlZF9yZWdzLCBUT1RBTF9QRVJfVEhSRUFEX1JFR1MsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBpICsgMSk7CisgICAgICAgIH0KKyAgICB9CisKICAgICBpZiAo
cGt0LT5wa3RfaGFzX2h2eCkgewogICAgICAgICB0Y2dfZ2VuX21vdmlfdGwoaGV4X1ZSZWdzX3Vw
ZGF0ZWQsIDApOwogICAgICAgICB0Y2dfZ2VuX21vdmlfdGwoaGV4X1FSZWdzX3VwZGF0ZWQsIDAp
OwpAQCAtMzM2LDY2ICs0MzQsNiBAQCBib29sIGlzX2dhdGhlcl9zdG9yZV9pbnNuKERpc2FzQ29u
dGV4dCAqY3R4KQogICAgIHJldHVybiBmYWxzZTsKIH0KIAotLyoKLSAqIFRoZSBMT0dfKl9XUklU
RSBtYWNyb3MgbWFyayBtb3N0IG9mIHRoZSB3cml0ZXMgaW4gYSBwYWNrZXQKLSAqIEhvd2V2ZXIs
IHRoZXJlIGFyZSBzb21lIGltcGxpY2l0IHdyaXRlcyBtYXJrZWQgYXMgYXR0cmlidXRlcwotICog
b2YgdGhlIGFwcGxpY2FibGUgaW5zdHJ1Y3Rpb25zLgotICovCi1zdGF0aWMgdm9pZCBtYXJrX2lt
cGxpY2l0X3JlZ193cml0ZShEaXNhc0NvbnRleHQgKmN0eCwgaW50IGF0dHJpYiwgaW50IHJudW0p
Ci17Ci0gICAgdWludDE2X3Qgb3Bjb2RlID0gY3R4LT5pbnNuLT5vcGNvZGU7Ci0gICAgaWYgKEdF
VF9BVFRSSUIob3Bjb2RlLCBhdHRyaWIpKSB7Ci0gICAgICAgIC8qCi0gICAgICAgICAqIFVTUiBp
cyB1c2VkIHRvIHNldCBvdmVyZmxvdyBhbmQgRlAgZXhjZXB0aW9ucywKLSAgICAgICAgICogc28g
dHJlYXQgaXQgYXMgY29uZGl0aW9uYWwKLSAgICAgICAgICovCi0gICAgICAgIGJvb2wgaXNfcHJl
ZGljYXRlZCA9IEdFVF9BVFRSSUIob3Bjb2RlLCBBX0NPTkRFWEVDKSB8fAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBybnVtID09IEhFWF9SRUdfVVNSOwotCi0gICAgICAgIC8qIExDMC9M
QzEgaXMgY29uZGl0aW9uYWxseSB3cml0dGVuIGJ5IGVuZGxvb3AgaW5zdHJ1Y3Rpb25zICovCi0g
ICAgICAgIGlmICgocm51bSA9PSBIRVhfUkVHX0xDMCB8fCBybnVtID09IEhFWF9SRUdfTEMxKSAm
JgotICAgICAgICAgICAgKG9wY29kZSA9PSBKMl9lbmRsb29wMCB8fAotICAgICAgICAgICAgIG9w
Y29kZSA9PSBKMl9lbmRsb29wMSB8fAotICAgICAgICAgICAgIG9wY29kZSA9PSBKMl9lbmRsb29w
MDEpKSB7Ci0gICAgICAgICAgICBpc19wcmVkaWNhdGVkID0gdHJ1ZTsKLSAgICAgICAgfQotCi0g
ICAgICAgIGlmIChpc19wcmVkaWNhdGVkICYmICFpc19wcmVsb2FkZWQoY3R4LCBybnVtKSkgewot
ICAgICAgICAgICAgdGNnX2dlbl9tb3ZfdGwoaGV4X25ld192YWx1ZVtybnVtXSwgaGV4X2dwclty
bnVtXSk7Ci0gICAgICAgIH0KLQotICAgICAgICBjdHhfbG9nX3JlZ193cml0ZShjdHgsIHJudW0p
OwotICAgIH0KLX0KLQotc3RhdGljIHZvaWQgbWFya19pbXBsaWNpdF9wcmVkX3dyaXRlKERpc2Fz
Q29udGV4dCAqY3R4LCBpbnQgYXR0cmliLCBpbnQgcG51bSkKLXsKLSAgICBpZiAoR0VUX0FUVFJJ
QihjdHgtPmluc24tPm9wY29kZSwgYXR0cmliKSkgewotICAgICAgICBjdHhfbG9nX3ByZWRfd3Jp
dGUoY3R4LCBwbnVtKTsKLSAgICB9Ci19Ci0KLXN0YXRpYyB2b2lkIG1hcmtfaW1wbGljaXRfcmVn
X3dyaXRlcyhEaXNhc0NvbnRleHQgKmN0eCkKLXsKLSAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0
ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX0ZQLCAgSEVYX1JFR19GUCk7Ci0gICAgbWFya19pbXBs
aWNpdF9yZWdfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19TUCwgIEhFWF9SRUdfU1ApOwot
ICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfTFIsICBI
RVhfUkVHX0xSKTsKLSAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRf
V1JJVEVTX0xDMCwgSEVYX1JFR19MQzApOwotICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0
eCwgQV9JTVBMSUNJVF9XUklURVNfU0EwLCBIRVhfUkVHX1NBMCk7Ci0gICAgbWFya19pbXBsaWNp
dF9yZWdfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19MQzEsIEhFWF9SRUdfTEMxKTsKLSAg
ICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX1NBMSwgSEVY
X1JFR19TQTEpOwotICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9X
UklURVNfVVNSLCBIRVhfUkVHX1VTUik7Ci0gICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4
LCBBX0ZQT1AsIEhFWF9SRUdfVVNSKTsKLX0KLQotc3RhdGljIHZvaWQgbWFya19pbXBsaWNpdF9w
cmVkX3dyaXRlcyhEaXNhc0NvbnRleHQgKmN0eCkKLXsKLSAgICBtYXJrX2ltcGxpY2l0X3ByZWRf
d3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19QMCwgMCk7Ci0gICAgbWFya19pbXBsaWNpdF9w
cmVkX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfUDEsIDEpOwotICAgIG1hcmtfaW1wbGlj
aXRfcHJlZF93cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX1AyLCAyKTsKLSAgICBtYXJrX2lt
cGxpY2l0X3ByZWRfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19QMywgMyk7Ci19Ci0KIHN0
YXRpYyB2b2lkIG1hcmtfc3RvcmVfd2lkdGgoRGlzYXNDb250ZXh0ICpjdHgpCiB7CiAgICAgdWlu
dDE2X3Qgb3Bjb2RlID0gY3R4LT5pbnNuLT5vcGNvZGU7CkBAIC00MjMsOSArNDYxLDcgQEAgc3Rh
dGljIHZvaWQgbWFya19zdG9yZV93aWR0aChEaXNhc0NvbnRleHQgKmN0eCkKIHN0YXRpYyB2b2lk
IGdlbl9pbnNuKERpc2FzQ29udGV4dCAqY3R4KQogewogICAgIGlmIChjdHgtPmluc24tPmdlbmVy
YXRlKSB7Ci0gICAgICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlcyhjdHgpOwogICAgICAgICBj
dHgtPmluc24tPmdlbmVyYXRlKGN0eCk7Ci0gICAgICAgIG1hcmtfaW1wbGljaXRfcHJlZF93cml0
ZXMoY3R4KTsKICAgICAgICAgbWFya19zdG9yZV93aWR0aChjdHgpOwogICAgIH0gZWxzZSB7CiAg
ICAgICAgIGdlbl9leGNlcHRpb25fZW5kX3RiKGN0eCwgSEVYX0VYQ1BfSU5WQUxJRF9PUENPREUp
OwpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vUkVBRE1FIGIvdGFyZ2V0L2hleGFnb24vUkVB
RE1FCmluZGV4IDZjYjVhZmZkZGIuLmQ5MjczMWUzNDYgMTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhh
Z29uL1JFQURNRQorKysgYi90YXJnZXQvaGV4YWdvbi9SRUFETUUKQEAgLTUyLDYgKzUyLDcgQEAg
aGVhZGVyIGZpbGVzIGluIDxCVUlMRF9ESVI+L3RhcmdldC9oZXhhZ29uCiAgICAgICAgIGdlbl90
Y2dfZnVuY190YWJsZS5weSAgICAgICAgICAgLT4gdGNnX2Z1bmNfdGFibGVfZ2VuZXJhdGVkLmMu
aW5jCiAgICAgICAgIGdlbl9oZWxwZXJfZnVuY3MucHkgICAgICAgICAgICAgLT4gaGVscGVyX2Z1
bmNzX2dlbmVyYXRlZC5jLmluYwogICAgICAgICBnZW5faWRlZl9wYXJzZXJfZnVuY3MucHkgICAg
ICAgIC0+IGlkZWZfcGFyc2VyX2lucHV0LmgKKyAgICAgICAgZ2VuX2FuYWx5emVfZnVuY3MucHkg
ICAgICAgICAgICAtPiBhbmFseXplX2Z1bmNzX2dlbmVyYXRlZC5jLmluYwogCiBRZW11IGhlbHBl
ciBmdW5jdGlvbnMgaGF2ZSAzIHBhcnRzCiAgICAgREVGX0hFTFBFUiBkZWNsYXJhdGlvbiBpbmRp
Y2F0ZXMgdGhlIHNpZ25hdHVyZSBvZiB0aGUgaGVscGVyCkBAIC04Nyw3ICs4OCw2IEBAIHRjZ19m
dW5jc19nZW5lcmF0ZWQuYy5pbmMKICAgICAgICAgVENHdiBSdFYgPSBoZXhfZ3ByW2luc24tPnJl
Z25vWzJdXTsKICAgICAgICAgZ2VuX2hlbHBlcl9BMl9hZGQoUmRWLCBjcHVfZW52LCBSc1YsIFJ0
Vik7CiAgICAgICAgIGdlbl9sb2dfcmVnX3dyaXRlKFJkTiwgUmRWKTsKLSAgICAgICAgY3R4X2xv
Z19yZWdfd3JpdGUoY3R4LCBSZE4pOwogICAgICAgICB0Y2dfdGVtcF9mcmVlKFJkVik7CiAgICAg
fQogCkBAIC0xNjIsNyArMTYyLDYgQEAgaXN0cnVjdGlvbi4KICAgICAgICAgZ2VuX2hlbHBlcl9W
Nl92YWRkdyhjcHVfZW52LCBWZFYsIFZ1ViwgVnZWLCBzbG90KTsKICAgICAgICAgdGNnX3RlbXBf
ZnJlZShzbG90KTsKICAgICAgICAgZ2VuX2xvZ192cmVnX3dyaXRlKGN0eCwgVmRWX29mZiwgVmRO
LCBFWFRfREZMLCBpbnNuLT5zbG90LCBmYWxzZSk7Ci0gICAgICAgIGN0eF9sb2dfdnJlZ193cml0
ZShjdHgsIFZkTiwgRVhUX0RGTCwgZmFsc2UpOwogICAgICAgICB0Y2dfdGVtcF9mcmVlX3B0cihW
ZFYpOwogICAgICAgICB0Y2dfdGVtcF9mcmVlX3B0cihWdVYpOwogICAgICAgICB0Y2dfdGVtcF9m
cmVlX3B0cihWdlYpOwpAQCAtMTk1LDkgKzE5NCwxNCBAQCB3aGVuIHRoZSBvdmVycmlkZSBpcyBw
cmVzZW50LgogICAgICAgICAgICAgdnJlZ19zcmNfb2ZmKGN0eCwgVnZOKTsKICAgICAgICAgZkdF
Tl9UQ0dfVjZfdmFkZHcoeyBmSElERShpbnQgaTspIGZWRk9SRUFDSCgzMiwgaSkgeyBWZFYud1tp
XSA9IFZ1Vi53W2ldICsgVnZWLndbaV0gOyB9IH0pOwogICAgICAgICBnZW5fbG9nX3ZyZWdfd3Jp
dGUoY3R4LCBWZFZfb2ZmLCBWZE4sIEVYVF9ERkwsIGluc24tPnNsb3QsIGZhbHNlKTsKLSAgICAg
ICAgY3R4X2xvZ192cmVnX3dyaXRlKGN0eCwgVmROLCBFWFRfREZMLCBmYWxzZSk7CiAgICAgfQog
CitXZSBhbHNvIGdlbmVyYXRlIGFuIGFuYWx5emVfPHRhZz4gZnVuY3Rpb24gZm9yIGVhY2ggaW5z
dHJ1Y3Rpb24uICBDdXJyZW50bHksCit0aGVzZSBmdW5jdGlvbnMgcmVjb3JkIHRoZSB3cml0ZXMg
dG8gcmVnaXN0ZXJzIGJ5IGNhbGxpbmcgY3R4X2xvZ18qLiAgRHVyaW5nCitnZW5fc3RhcnRfcGFj
a2V0LCB3ZSBpbnZva2UgdGhlIGFuYWx5emVfPHRhZz4gZnVuY3Rpb24gZm9yIGVhY2ggaW5zdHJ1
Y3Rpb24gaW4KK3RoZSBwYWNrZXQsIGFuZCB3ZSBtYXJrIHRoZSBpbXBsaWNpdCB3cml0ZXMuICBB
ZnRlciB0aGUgYW5hbHlzaXMgaXMgcGVyZm9ybWVkLAord2UgaW5pdGlhbGl6ZSBoZXhfbmV3X3Zh
bHVlIGZvciBlYWNoIG9mIHRoZSBwcmVkaWNhdGVkIGFzc2lnbm1lbnRzLgorCiBJbiBhZGRpdGlv
biB0byBpbnN0cnVjdGlvbiBzZW1hbnRpY3MsIHdlIHVzZSBhIGdlbmVyYXRvciB0byBjcmVhdGUg
dGhlIGRlY29kZQogdHJlZS4gIFRoaXMgZ2VuZXJhdGlvbiBpcyBhbHNvIGEgdHdvIHN0ZXAgcHJv
Y2Vzcy4gIFRoZSBmaXJzdCBzdGVwIGlzIHRvIHJ1bgogdGFyZ2V0L2hleGFnb24vZ2VuX2RlY3Ry
ZWVfaW1wb3J0LmMgdG8gcHJvZHVjZQpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vZ2VuX2Fu
YWx5emVfZnVuY3MucHkgYi90YXJnZXQvaGV4YWdvbi9nZW5fYW5hbHl6ZV9mdW5jcy5weQpuZXcg
ZmlsZSBtb2RlIDEwMDc1NQppbmRleCAwMDAwMDAwMDAwLi5jNDU2OTZiZWM4Ci0tLSAvZGV2L251
bGwKKysrIGIvdGFyZ2V0L2hleGFnb24vZ2VuX2FuYWx5emVfZnVuY3MucHkKQEAgLTAsMCArMSwy
MzcgQEAKKyMhL3Vzci9iaW4vZW52IHB5dGhvbjMKKworIyMKKyMjICBDb3B5cmlnaHQoYykgMjAy
Mi0yMDIzIFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2
ZWQuCisjIworIyMgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlz
dHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CisjIyAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBH
TlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKKyMjICB0aGUgRnJlZSBT
b2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvcgor
IyMgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisjIworIyMgIFRoaXMgcHJv
Z3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAor
IyMgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdh
cnJhbnR5IG9mCisjIyAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxB
UiBQVVJQT1NFLiAgU2VlIHRoZQorIyMgIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBt
b3JlIGRldGFpbHMuCisjIworIyMgIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2Yg
dGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCisjIyAgYWxvbmcgd2l0aCB0aGlzIHByb2dy
YW07IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KKyMjCisKK2lt
cG9ydCBzeXMKK2ltcG9ydCByZQoraW1wb3J0IHN0cmluZworaW1wb3J0IGhleF9jb21tb24KKwor
IyMKKyMjIEhlbHBlcnMgZm9yIGdlbl9hbmFseXplX2Z1bmMKKyMjCitkZWYgaXNfcHJlZGljYXRl
ZCh0YWcpOgorICAgIHJldHVybiAnQV9DT05ERVhFQycgaW4gaGV4X2NvbW1vbi5hdHRyaWJkaWN0
W3RhZ10KKworZGVmIGFuYWx5emVfb3BuX29sZChmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCByZWdu
byk6CisgICAgcmVnTiA9ICIlcyVzTiIgJSAocmVndHlwZSwgcmVnaWQpCisgICAgcHJlZGljYXRl
ZCA9ICJ0cnVlIiBpZiBpc19wcmVkaWNhdGVkKHRhZykgZWxzZSAiZmFsc2UiCisgICAgaWYgKHJl
Z3R5cGUgPT0gIlIiKToKKyAgICAgICAgaWYgKHJlZ2lkIGluIHsic3MiLCAidHQifSk6CisgICAg
ICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4i
ICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVsaWYgKHJlZ2lk
IGluIHsiZGQiLCAiZWUiLCAieHgiLCAieXkifSk6CisgICAgICAgICAgICBmLndyaXRlKCIgICAg
Y29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIChyZWdOLCByZWdubykpCisgICAg
ICAgICAgICBmLndyaXRlKCIgICAgY3R4X2xvZ19yZWdfd3JpdGVfcGFpcihjdHgsICVzLCAlcyk7
XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCBwcmVkaWNhdGVkKSkKKyAgICAgICAgZWxp
ZiAocmVnaWQgaW4geyJzIiwgInQiLCAidSIsICJ2In0pOgorICAgICAgICAgICAgZi53cml0ZSgi
Ly8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwKKyAgICAgICAgICAg
ICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7ImQiLCAiZSIsICJ4
IiwgInkifSk6CisgICAgICAgICAgICBmLndyaXRlKCIgICAgY29uc3QgaW50ICVzID0gaW5zbi0+
cmVnbm9bJWRdO1xuIiAlIChyZWdOLCByZWdubykpCisgICAgICAgICAgICBmLndyaXRlKCIgICAg
Y3R4X2xvZ19yZWdfd3JpdGUoY3R4LCAlcywgJXMpO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAo
cmVnTiwgcHJlZGljYXRlZCkpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFk
IHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKyAgICBlbGlmIChyZWd0eXBlID09
ICJQIik6CisgICAgICAgIGlmIChyZWdpZCBpbiB7InMiLCAidCIsICJ1IiwgInYifSk6CisgICAg
ICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4i
ICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVsaWYgKHJlZ2lk
IGluIHsiZCIsICJlIiwgIngifSk6CisgICAgICAgICAgICBmLndyaXRlKCIgICAgY29uc3QgaW50
ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIChyZWdOLCByZWdubykpCisgICAgICAgICAgICBm
LndyaXRlKCIgICAgY3R4X2xvZ19wcmVkX3dyaXRlKGN0eCwgJXMpO1xuIiAlIChyZWdOKSkKKyAg
ICAgICAgZWxzZToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJl
Z3R5cGUsIHJlZ2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIkMiKToKKyAgICAgICAgaWYgKHJl
Z2lkID09ICJzcyIpOgorICAgICAgICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0g
aW5zbi0+cmVnbm9bJWRdICsgSEVYX1JFR19TQTA7XG4iICUgXAorICAgICAgICAgICAgICAgIChy
ZWdOLCByZWdubykpCisgICAgICAgIGVsaWYgKHJlZ2lkID09ICJkZCIpOgorICAgICAgICAgICAg
Zi53cml0ZSgiICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVkXSArIEhFWF9SRUdfU0Ew
O1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICAgICAgZi53
cml0ZSgiICAgIGN0eF9sb2dfcmVnX3dyaXRlX3BhaXIoY3R4LCAlcywgJXMpO1xuIiAlIFwKKyAg
ICAgICAgICAgICAgICAocmVnTiwgcHJlZGljYXRlZCkpCisgICAgICAgIGVsaWYgKHJlZ2lkID09
ICJzIik6CisgICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5y
ZWdub1slZF0gKyBIRVhfUkVHX1NBMDtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJl
Z25vKSkKKyAgICAgICAgZWxpZiAocmVnaWQgPT0gImQiKToKKyAgICAgICAgICAgIGYud3JpdGUo
IiAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF0gKyBIRVhfUkVHX1NBMDtcbiIgJSBc
CisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgICAgIGYud3JpdGUoIiAg
ICBjdHhfbG9nX3JlZ193cml0ZShjdHgsICVzLCAlcyk7XG4iICUgXAorICAgICAgICAgICAgICAg
IChyZWdOLCBwcmVkaWNhdGVkKSkKKyAgICAgICAgZWxzZToKKyAgICAgICAgICAgIHByaW50KCJC
YWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQorICAgIGVsaWYgKHJlZ3R5cGUg
PT0gIk0iKToKKyAgICAgICAgaWYgKHJlZ2lkID09ICJ1Iik6CisgICAgICAgICAgICBmLndyaXRl
KCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4iJSBcCisgICAgICAgICAg
ICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxzZToKKyAgICAgICAgICAgIHByaW50KCJC
YWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQorICAgIGVsaWYgKHJlZ3R5cGUg
PT0gIlYiKToKKyAgICAgICAgaWYgKHJlZ2lkIGluIHsiZGQiLCAieHgifSk6CisgICAgICAgICAg
ICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4iICVcCisg
ICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxpZiAocmVnaWQgaW4geyJ1
dSIsICJ2diJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGlu
c24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAg
ICAgICAgZWxpZiAocmVnaWQgaW4geyJzIiwgInUiLCAidiIsICJ3In0pOgorICAgICAgICAgICAg
Zi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwKKyAg
ICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7ImQi
LCAieCIsICJ5In0pOgorICAgICAgICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0g
aW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQor
ICAgICAgICBlbHNlOgorICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwg
cmVndHlwZSwgcmVnaWQpCisgICAgZWxpZiAocmVndHlwZSA9PSAiUSIpOgorICAgICAgICBpZiAo
cmVnaWQgaW4geyJkIiwgImUiLCAieCJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNv
bnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJl
Z04sIHJlZ25vKSkKKyAgICAgICAgZWxpZiAocmVnaWQgaW4geyJzIiwgInQiLCAidSIsICJ2In0p
OgorICAgICAgICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9b
JWRdO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbHNl
OgorICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVn
aWQpCisgICAgZWxpZiAocmVndHlwZSA9PSAiRyIpOgorICAgICAgICBpZiAocmVnaWQgaW4geyJk
ZCJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJl
Z25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAg
ZWxpZiAocmVnaWQgaW4geyJkIn0pOgorICAgICAgICAgICAgZi53cml0ZSgiLy8gICAgY29uc3Qg
aW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwg
cmVnbm8pKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7InNzIn0pOgorICAgICAgICAgICAgZi53
cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwKKyAgICAg
ICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7InMifSk6
CisgICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1sl
ZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVsc2U6
CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdp
ZCkKKyAgICBlbGlmIChyZWd0eXBlID09ICJTIik6CisgICAgICAgIGlmIChyZWdpZCBpbiB7ImRk
In0pOgorICAgICAgICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVn
bm9bJWRdO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBl
bGlmIChyZWdpZCBpbiB7ImQifSk6CisgICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBp
bnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCBy
ZWdubykpCisgICAgICAgIGVsaWYgKHJlZ2lkIGluIHsic3MifSk6CisgICAgICAgICAgICBmLndy
aXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4iICUgXAorICAgICAg
ICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVsaWYgKHJlZ2lkIGluIHsicyJ9KToK
KyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVk
XTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxzZToK
KyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lk
KQorICAgIGVsc2U6CisgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5
cGUsIHJlZ2lkKQorCitkZWYgYW5hbHl6ZV9vcG5fbmV3KGYsIHRhZywgcmVndHlwZSwgcmVnaWQs
IHJlZ25vKToKKyAgICByZWdOID0gIiVzJXNOIiAlIChyZWd0eXBlLCByZWdpZCkKKyAgICBpZiAo
cmVndHlwZSA9PSAiTiIpOgorICAgICAgICBpZiAocmVnaWQgaW4geyJzIiwgInQifSk6CisgICAg
ICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4i
ICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVsc2U6CisgICAg
ICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKyAg
ICBlbGlmIChyZWd0eXBlID09ICJQIik6CisgICAgICAgIGlmIChyZWdpZCBpbiB7InQiLCAidSIs
ICJ2In0pOgorICAgICAgICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+
cmVnbm9bJWRdO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAg
ICBlbHNlOgorICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlw
ZSwgcmVnaWQpCisgICAgZWxpZiAocmVndHlwZSA9PSAiTyIpOgorICAgICAgICBpZiAocmVnaWQg
PT0gInMiKToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24t
PnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAg
ICAgZWxzZToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5
cGUsIHJlZ2lkKQorICAgIGVsc2U6CisgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6
ICIsIHJlZ3R5cGUsIHJlZ2lkKQorCitkZWYgYW5hbHl6ZV9vcG4oZiwgdGFnLCByZWd0eXBlLCBy
ZWdpZCwgdG9zcywgbnVtcmVncywgaSk6CisgICAgaWYgKGhleF9jb21tb24uaXNfcGFpcihyZWdp
ZCkpOgorICAgICAgICBhbmFseXplX29wbl9vbGQoZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgaSkK
KyAgICBlbGlmIChoZXhfY29tbW9uLmlzX3NpbmdsZShyZWdpZCkpOgorICAgICAgICBpZiBoZXhf
Y29tbW9uLmlzX29sZF92YWwocmVndHlwZSwgcmVnaWQsIHRhZyk6CisgICAgICAgICAgICBhbmFs
eXplX29wbl9vbGQoZix0YWcsIHJlZ3R5cGUsIHJlZ2lkLCBpKQorICAgICAgICBlbGlmIGhleF9j
b21tb24uaXNfbmV3X3ZhbChyZWd0eXBlLCByZWdpZCwgdGFnKToKKyAgICAgICAgICAgIGFuYWx5
emVfb3BuX25ldyhmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCBpKQorICAgICAgICBlbHNlOgorICAg
ICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQsIHRv
c3MsIG51bXJlZ3MpCisgICAgZWxzZToKKyAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJz
ZTogIiwgcmVndHlwZSwgcmVnaWQsIHRvc3MsIG51bXJlZ3MpCisKKyMjCisjIyBHZW5lcmF0ZSB0
aGUgY29kZSB0byBhbmFseXplIHRoZSBpbnN0cnVjdGlvbgorIyMgICAgIEZvciBBMl9hZGQ6IFJk
MzI9YWRkKFJzMzIsUnQzMiksIHsgUmRWPVJzVitSdFY7fQorIyMgICAgIFdlIHByb2R1Y2U6Cisj
IyAgICAgc3RhdGljIHZvaWQgYW5hbHl6ZV9BMl9hZGQoRGlzYXNDb250ZXh0ICpjdHgpCisjIyAg
ICAgeworIyMgICAgICAgICBJbnNuICppbnNuIF9fYXR0cmlidXRlX18oKHVudXNlZCkpID0gY3R4
LT5pbnNuOworIyMgICAgICAgICBjb25zdCBpbnQgUmROID0gaW5zbi0+cmVnbm9bMF07CisjIyAg
ICAgICAgIGN0eF9sb2dfcmVnX3dyaXRlKGN0eCwgUmROLCBmYWxzZSk7CisjIyAgICAgLy8gICAg
Y29uc3QgaW50IFJzTiA9IGluc24tPnJlZ25vWzFdOworIyMgICAgIC8vICAgIGNvbnN0IGludCBS
dE4gPSBpbnNuLT5yZWdub1syXTsKKyMjICAgICB9CisjIworZGVmIGdlbl9hbmFseXplX2Z1bmMo
ZiwgdGFnLCByZWdzLCBpbW1zKToKKyAgICBmLndyaXRlKCJzdGF0aWMgdm9pZCBhbmFseXplXyVz
KERpc2FzQ29udGV4dCAqY3R4KVxuIiAldGFnKQorICAgIGYud3JpdGUoJ3tcbicpCisKKyAgICBm
LndyaXRlKCIgICAgSW5zbiAqaW5zbiBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSA9IGN0eC0+aW5z
bjtcbiIpCisKKyAgICBpPTAKKyAgICAjIyBBbmFseXplIGFsbCB0aGUgcmVnaXN0ZXJzCisgICAg
Zm9yIHJlZ3R5cGUsIHJlZ2lkLCB0b3NzLCBudW1yZWdzIGluIHJlZ3M6CisgICAgICAgIGFuYWx5
emVfb3BuKGYsIHRhZywgcmVndHlwZSwgcmVnaWQsIHRvc3MsIG51bXJlZ3MsIGkpCisgICAgICAg
IGkgKz0gMQorCisKKyAgICBmLndyaXRlKCJ9XG5cbiIpCisKK2RlZiBtYWluKCk6CisgICAgaGV4
X2NvbW1vbi5yZWFkX3NlbWFudGljc19maWxlKHN5cy5hcmd2WzFdKQorICAgIGhleF9jb21tb24u
cmVhZF9hdHRyaWJzX2ZpbGUoc3lzLmFyZ3ZbMl0pCisgICAgaGV4X2NvbW1vbi5yZWFkX292ZXJy
aWRlc19maWxlKHN5cy5hcmd2WzNdKQorICAgIGhleF9jb21tb24ucmVhZF9vdmVycmlkZXNfZmls
ZShzeXMuYXJndls0XSkKKyAgICAjIyBXaGV0aGVyIG9yIG5vdCBpZGVmLXBhcnNlciBpcyBlbmFi
bGVkIGlzCisgICAgIyMgZGV0ZXJtaW5lZCBieSB0aGUgbnVtYmVyIG9mIGFyZ3VtZW50cyB0bwor
ICAgICMjIHRoaXMgc2NyaXB0OgorICAgICMjCisgICAgIyMgICA1IGFyZ3MuIC0+IG5vdCBlbmFi
bGVkLAorICAgICMjICAgNiBhcmdzLiAtPiBpZGVmLXBhcnNlciBlbmFibGVkLgorICAgICMjCisg
ICAgIyMgVGhlIDY6dGggYXJnLiB0aGVuIGhvbGRzIGEgbGlzdCBvZiB0aGUgc3VjY2Vzc2Z1bGx5
CisgICAgIyMgcGFyc2VkIGluc3RydWN0aW9ucy4KKyAgICBpc19pZGVmX3BhcnNlcl9lbmFibGVk
ID0gbGVuKHN5cy5hcmd2KSA+IDYKKyAgICBpZiBpc19pZGVmX3BhcnNlcl9lbmFibGVkOgorICAg
ICAgICBoZXhfY29tbW9uLnJlYWRfaWRlZl9wYXJzZXJfZW5hYmxlZF9maWxlKHN5cy5hcmd2WzVd
KQorICAgIGhleF9jb21tb24uY2FsY3VsYXRlX2F0dHJpYnMoKQorICAgIHRhZ3JlZ3MgPSBoZXhf
Y29tbW9uLmdldF90YWdyZWdzKCkKKyAgICB0YWdpbW1zID0gaGV4X2NvbW1vbi5nZXRfdGFnaW1t
cygpCisKKyAgICB3aXRoIG9wZW4oc3lzLmFyZ3ZbLTFdLCAndycpIGFzIGY6CisgICAgICAgIGYu
d3JpdGUoIiNpZm5kZWYgSEVYQUdPTl9UQ0dfRlVOQ1NfSFxuIikKKyAgICAgICAgZi53cml0ZSgi
I2RlZmluZSBIRVhBR09OX1RDR19GVU5DU19IXG5cbiIpCisKKyAgICAgICAgZm9yIHRhZyBpbiBo
ZXhfY29tbW9uLnRhZ3M6CisgICAgICAgICAgICBnZW5fYW5hbHl6ZV9mdW5jKGYsIHRhZywgdGFn
cmVnc1t0YWddLCB0YWdpbW1zW3RhZ10pCisKKyAgICAgICAgZi53cml0ZSgiI2VuZGlmICAgIC8q
IEhFWEFHT05fVENHX0ZVTkNTX0ggKi9cbiIpCisKK2lmIF9fbmFtZV9fID09ICJfX21haW5fXyI6
CisgICAgbWFpbigpCmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi9nZW5fdGNnX2Z1bmNzLnB5
IGIvdGFyZ2V0L2hleGFnb24vZ2VuX3RjZ19mdW5jcy5weQppbmRleCA3ZThiYTE3Y2EyLi41ZDY4
NmViY2YxIDEwMDc1NQotLS0gYS90YXJnZXQvaGV4YWdvbi9nZW5fdGNnX2Z1bmNzLnB5CisrKyBi
L3RhcmdldC9oZXhhZ29uL2dlbl90Y2dfZnVuY3MucHkKQEAgLTEsNyArMSw3IEBACiAjIS91c3Iv
YmluL2VudiBweXRob24zCiAKICMjCi0jIyAgQ29weXJpZ2h0KGMpIDIwMTktMjAyMiBRdWFsY29t
bSBJbm5vdmF0aW9uIENlbnRlciwgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLgorIyMgIENvcHly
aWdodChjKSAyMDE5LTIwMjMgUXVhbGNvbW0gSW5ub3ZhdGlvbiBDZW50ZXIsIEluYy4gQWxsIFJp
Z2h0cyBSZXNlcnZlZC4KICMjCiAjIyAgVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlv
dSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKICMjICBpdCB1bmRlciB0aGUgdGVy
bXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQpAQCAt
NDQsMTUgKzQ0LDYgQEAgZGVmIGdlbnB0cl9kZWNsX3BhaXJfd3JpdGFibGUoZiwgdGFnLCByZWd0
eXBlLCByZWdpZCwgcmVnbm8pOgogICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKICAgICBlbHNl
OgogICAgICAgICBmLndyaXRlKCIgICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xu
IiAlIChyZWdOLCByZWdubykpCi0gICAgaWYgKCdBX0NPTkRFWEVDJyBpbiBoZXhfY29tbW9uLmF0
dHJpYmRpY3RbdGFnXSk6Ci0gICAgICAgIGYud3JpdGUoIiAgICBpZiAoIWlzX3ByZWxvYWRlZChj
dHgsICVzKSkge1xuIiAlIHJlZ04pCi0gICAgICAgIGYud3JpdGUoIiAgICAgICAgdGNnX2dlbl9t
b3ZfdGwoaGV4X25ld192YWx1ZVslc10sIGhleF9ncHJbJXNdKTtcbiIgJSBcCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIChyZWdOLCByZWdOKSkKLSAgICAgICAgZi53cml0ZSgiICAgIH1c
biIpCi0gICAgICAgIGYud3JpdGUoIiAgICBpZiAoIWlzX3ByZWxvYWRlZChjdHgsICVzICsgMSkp
IHtcbiIgJSByZWdOKQotICAgICAgICBmLndyaXRlKCIgICAgICAgIHRjZ19nZW5fbW92X3RsKGhl
eF9uZXdfdmFsdWVbJXMgKyAxXSwgaGV4X2dwclslcyArIDFdKTtcbiIgJSBcCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIChyZWdOLCByZWdOKSkKLSAgICAgICAgZi53cml0ZSgiICAgIH1c
biIpCiAKIGRlZiBnZW5wdHJfZGVjbF93cml0YWJsZShmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCBy
ZWdubyk6CiAgICAgcmVnTj0iJXMlc04iICUgKHJlZ3R5cGUscmVnaWQpCkBAIC02MywxMSArNTQs
NiBAQCBkZWYgZ2VucHRyX2RlY2xfd3JpdGFibGUoZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgcmVn
bm8pOgogICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKICAgICBlbHNlOgogICAgICAgICBmLndy
aXRlKCIgICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIChyZWdOLCByZWdu
bykpCi0gICAgaWYgKCdBX0NPTkRFWEVDJyBpbiBoZXhfY29tbW9uLmF0dHJpYmRpY3RbdGFnXSk6
Ci0gICAgICAgIGYud3JpdGUoIiAgICBpZiAoIWlzX3ByZWxvYWRlZChjdHgsICVzKSkge1xuIiAl
IHJlZ04pCi0gICAgICAgIGYud3JpdGUoIiAgICAgICAgdGNnX2dlbl9tb3ZfdGwoaGV4X25ld192
YWx1ZVslc10sIGhleF9ncHJbJXNdKTtcbiIgJSBcCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIChyZWdOLCByZWdOKSkKLSAgICAgICAgZi53cml0ZSgiICAgIH1cbiIpCiAKIGRlZiBnZW5w
dHJfZGVjbChmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCByZWdubyk6CiAgICAgcmVnTj0iJXMlc04i
ICUgKHJlZ3R5cGUscmVnaWQpCkBAIC00NjUsOCArNDUxLDYgQEAgZGVmIGdlbnB0cl9kc3Rfd3Jp
dGVfcGFpcihmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkKToKICAgICBlbHNlOgogICAgICAgICBmLndy
aXRlKCIgICAgZ2VuX2xvZ19yZWdfd3JpdGVfcGFpciglcyVzTiwgJXMlc1YpO1xuIiAlIFwKICAg
ICAgICAgICAgIChyZWd0eXBlLCByZWdpZCwgcmVndHlwZSwgcmVnaWQpKQotICAgIGYud3JpdGUo
IiAgICBjdHhfbG9nX3JlZ193cml0ZV9wYWlyKGN0eCwgJXMlc04pO1xuIiAlIFwKLSAgICAgICAg
KHJlZ3R5cGUsIHJlZ2lkKSkKIAogZGVmIGdlbnB0cl9kc3Rfd3JpdGUoZiwgdGFnLCByZWd0eXBl
LCByZWdpZCk6CiAgICAgaWYgKHJlZ3R5cGUgPT0gIlIiKToKQEAgLTQ4MCwxNiArNDY0LDEyIEBA
IGRlZiBnZW5wdHJfZHN0X3dyaXRlKGYsIHRhZywgcmVndHlwZSwgcmVnaWQpOgogICAgICAgICAg
ICAgZWxzZToKICAgICAgICAgICAgICAgICBmLndyaXRlKCIgICAgZ2VuX2xvZ19yZWdfd3JpdGUo
JXMlc04sICVzJXNWKTtcbiIgJSBcCiAgICAgICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdp
ZCwgcmVndHlwZSwgcmVnaWQpKQotICAgICAgICAgICAgZi53cml0ZSgiICAgIGN0eF9sb2dfcmVn
X3dyaXRlKGN0eCwgJXMlc04pO1xuIiAlIFwKLSAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVn
aWQpKQogICAgICAgICBlbHNlOgogICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJz
ZTogIiwgcmVndHlwZSwgcmVnaWQpCiAgICAgZWxpZiAocmVndHlwZSA9PSAiUCIpOgogICAgICAg
ICBpZiAocmVnaWQgaW4geyJkIiwgImUiLCAieCJ9KToKICAgICAgICAgICAgIGYud3JpdGUoIiAg
ICBnZW5fbG9nX3ByZWRfd3JpdGUoY3R4LCAlcyVzTiwgJXMlc1YpO1xuIiAlIFwKICAgICAgICAg
ICAgICAgICAocmVndHlwZSwgcmVnaWQsIHJlZ3R5cGUsIHJlZ2lkKSkKLSAgICAgICAgICAgIGYu
d3JpdGUoIiAgICBjdHhfbG9nX3ByZWRfd3JpdGUoY3R4LCAlcyVzTik7XG4iICUgXAotICAgICAg
ICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkpCiAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICBw
cmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKICAgICBlbGlmIChy
ZWd0eXBlID09ICJDIik6CkBAIC01ODEsNyArNTYxLDYgQEAgZGVmIGdlbnB0cl9kc3Rfd3JpdGVf
b3BuKGYscmVndHlwZSwgcmVnaWQsIHRhZyk6CiAjIyAgICAgICAgICAgVENHdiBSdFYgPSBoZXhf
Z3ByW2luc24tPnJlZ25vWzJdXTsKICMjICAgICAgICAgICA8R0VOPgogIyMgICAgICAgICAgIGdl
bl9sb2dfcmVnX3dyaXRlKFJkTiwgUmRWKTsKLSMjICAgICAgICAgICBjdHhfbG9nX3JlZ193cml0
ZShjdHgsIFJkTik7CiAjIyAgICAgICAgICAgdGNnX3RlbXBfZnJlZShSZFYpOwogIyMgICAgICAg
fQogIyMKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29uL21lc29uLmJ1aWxkIGIvdGFyZ2V0L2hl
eGFnb24vbWVzb24uYnVpbGQKaW5kZXggYzlkMzFkMDk1Yy4uNDhjOWY1M2NmYSAxMDA2NDQKLS0t
IGEvdGFyZ2V0L2hleGFnb24vbWVzb24uYnVpbGQKKysrIGIvdGFyZ2V0L2hleGFnb24vbWVzb24u
YnVpbGQKQEAgLTEsNSArMSw1IEBACiAjIwotIyMgIENvcHlyaWdodChjKSAyMDIwLTIwMjEgUXVh
bGNvbW0gSW5ub3ZhdGlvbiBDZW50ZXIsIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KKyMjICBD
b3B5cmlnaHQoYykgMjAyMC0yMDIzIFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFs
bCBSaWdodHMgUmVzZXJ2ZWQuCiAjIwogIyMgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJl
OyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAjIyAgaXQgdW5kZXIgdGhl
IHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkK
QEAgLTI3Niw0ICsyNzYsMTMgQEAgdGNnX2Z1bmNzX2dlbmVyYXRlZCA9IGN1c3RvbV90YXJnZXQo
CiApCiBoZXhhZ29uX3NzLmFkZCh0Y2dfZnVuY3NfZ2VuZXJhdGVkKQogCithbmFseXplX2Z1bmNz
X2dlbmVyYXRlZCA9IGN1c3RvbV90YXJnZXQoCisgICAgJ2FuYWx5emVfZnVuY3NfZ2VuZXJhdGVk
LmMuaW5jJywKKyAgICBvdXRwdXQ6ICdhbmFseXplX2Z1bmNzX2dlbmVyYXRlZC5jLmluYycsCisg
ICAgZGVwZW5kczogaGVscGVyX2RlcCwKKyAgICBkZXBlbmRfZmlsZXM6IFtoZXhfY29tbW9uX3B5
LCBhdHRyaWJzX2RlZiwgZ2VuX3RjZ19oLCBnZW5fdGNnX2h2eF9oXSwKKyAgICBjb21tYW5kOiBb
cHl0aG9uLCBmaWxlcygnZ2VuX2FuYWx5emVfZnVuY3MucHknKSwgaGVscGVyX2luLCAnQE9VVFBV
VEAnXSwKKykKK2hleGFnb25fc3MuYWRkKGFuYWx5emVfZnVuY3NfZ2VuZXJhdGVkKQorCiB0YXJn
ZXRfYXJjaCArPSB7J2hleGFnb24nOiBoZXhhZ29uX3NzfQotLSAKMi4xNy4xCgo=

