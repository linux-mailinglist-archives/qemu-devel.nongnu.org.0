Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id A2AAF18CBA7
	for <lists+qemu-devel@lfdr.de>; Fri, 20 Mar 2020 11:32:50 +0100 (CET)
Received: from localhost ([::1]:50610 helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>)
	id 1jFExN-0005XI-K3
	for lists+qemu-devel@lfdr.de; Fri, 20 Mar 2020 06:32:49 -0400
Received: from eggs.gnu.org ([2001:470:142:3::10]:37237)
 by lists.gnu.org with esmtp (Exim 4.90_1)
 (envelope-from <stefanha@redhat.com>) id 1jFEvo-0004Fd-WE
 for qemu-devel@nongnu.org; Fri, 20 Mar 2020 06:31:15 -0400
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
 (envelope-from <stefanha@redhat.com>) id 1jFEvn-00018u-77
 for qemu-devel@nongnu.org; Fri, 20 Mar 2020 06:31:12 -0400
Received: from us-smtp-delivery-74.mimecast.com ([216.205.24.74]:20573)
 by eggs.gnu.org with esmtps (TLS1.0:DHE_RSA_AES_256_CBC_SHA1:32)
 (Exim 4.71) (envelope-from <stefanha@redhat.com>) id 1jFEvn-00018f-3o
 for qemu-devel@nongnu.org; Fri, 20 Mar 2020 06:31:11 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1584700270;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=YJhMB++vOK7g4a4RMh+UMtMgWzKOV3Ns5UnGJbhKJM4=;
 b=ZwwLNynA1BNsr2Pc5gmX81Qr0279WjdnzTP5xGsWpNpgX3f7NVMvNlQdwWvFmqpsd7h+1Y
 5PdJ7g7dnru2I1r6tuHZDUbIG+NboqbmC+ISnGSGbfTP7wCFhsW/RJpnURdlZYHeHaawjp
 NzKyPXoJEPS7DNU7BpaMraQnmIF8UNU=
Received: from mimecast-mx01.redhat.com (mimecast-mx01.redhat.com
 [209.132.183.4]) (Using TLS) by relay.mimecast.com with ESMTP id
 us-mta-193-Ag49-QQbPDCTohpzfJZIyw-1; Fri, 20 Mar 2020 06:31:07 -0400
X-MC-Unique: Ag49-QQbPDCTohpzfJZIyw-1
Received: from smtp.corp.redhat.com (int-mx08.intmail.prod.int.phx2.redhat.com
 [10.5.11.23])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mimecast-mx01.redhat.com (Postfix) with ESMTPS id 07288801A01;
 Fri, 20 Mar 2020 10:31:06 +0000 (UTC)
Received: from localhost (ovpn-114-252.ams2.redhat.com [10.36.114.252])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 2B83819756;
 Fri, 20 Mar 2020 10:31:04 +0000 (UTC)
From: Stefan Hajnoczi <stefanha@redhat.com>
To: qemu-devel@nongnu.org
Subject: [PATCH RESEND v3 2/4] virtio-scsi: default num_queues to -smp N
Date: Fri, 20 Mar 2020 10:30:39 +0000
Message-Id: <20200320103041.129527-3-stefanha@redhat.com>
In-Reply-To: <20200320103041.129527-1-stefanha@redhat.com>
References: <20200320103041.129527-1-stefanha@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.84 on 10.5.11.23
X-Mimecast-Spam-Score: 0
X-Mimecast-Originator: redhat.com
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: base64
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.2.x-3.x [generic]
 [fuzzy]
X-Received-From: 216.205.24.74
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Cc: Fam Zheng <fam@euphon.net>, Kevin Wolf <kwolf@redhat.com>,
 Eduardo Habkost <ehabkost@redhat.com>, slp@redhat.com,
 "Michael S. Tsirkin" <mst@redhat.com>, cohuck@redhat.com,
 Max Reitz <mreitz@redhat.com>, Stefan Hajnoczi <stefanha@redhat.com>,
 Paolo Bonzini <pbonzini@redhat.com>, qemu-block@nongnu.org
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: "Qemu-devel" <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>

QXV0b21hdGljYWxseSBzaXplIHRoZSBudW1iZXIgb2YgdmlydGlvLXNjc2ktcGNpLCB2aG9zdC1z
Y3NpLXBjaSwgYW5kCnZob3N0LXVzZXItc2NzaS1wY2kgcmVxdWVzdCB2aXJ0cXVldWVzIHRvIG1h
dGNoIHRoZSBudW1iZXIgb2YgdkNQVXMuCk90aGVyIHRyYW5zcG9ydHMgY29udGludWUgdG8gZGVm
YXVsdCB0byAxIHJlcXVlc3QgdmlydHF1ZXVlLgoKQSAxOjEgdmlydHF1ZXVlOnZDUFUgbWFwcGlu
ZyBlbnN1cmVzIHRoYXQgY29tcGxldGlvbiBpbnRlcnJ1cHRzIGFyZQpoYW5kbGVkIG9uIHRoZSBz
YW1lIHZDUFUgdGhhdCBzdWJtaXR0ZWQgdGhlIHJlcXVlc3QuICBObyBJUEkgaXMKbmVjZXNzYXJ5
IHRvIGNvbXBsZXRlIGFuIEkvTyByZXF1ZXN0IGFuZCBwZXJmb3JtYW5jZSBpcyBpbXByb3ZlZC4K
ClNpZ25lZC1vZmYtYnk6IFN0ZWZhbiBIYWpub2N6aSA8c3RlZmFuaGFAcmVkaGF0LmNvbT4KLS0t
CiBody9jb3JlL21hY2hpbmUuYyAgICAgICAgICAgICAgIHwgIDMgKysrCiBody9zY3NpL3Zob3N0
LXNjc2kuYyAgICAgICAgICAgIHwgIDMgKystCiBody9zY3NpL3Zob3N0LXVzZXItc2NzaS5jICAg
ICAgIHwgIDMgKystCiBody9zY3NpL3ZpcnRpby1zY3NpLmMgICAgICAgICAgIHwgIDYgKysrKyst
CiBody92aXJ0aW8vdmhvc3Qtc2NzaS1wY2kuYyAgICAgIHwgMTAgKysrKysrKystLQogaHcvdmly
dGlvL3Zob3N0LXVzZXItc2NzaS1wY2kuYyB8IDEwICsrKysrKysrLS0KIGh3L3ZpcnRpby92aXJ0
aW8tc2NzaS1wY2kuYyAgICAgfCAxMCArKysrKysrKy0tCiBpbmNsdWRlL2h3L3ZpcnRpby92aXJ0
aW8tc2NzaS5oIHwgIDIgKysKIDggZmlsZXMgY2hhbmdlZCwgMzggaW5zZXJ0aW9ucygrKSwgOSBk
ZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9ody9jb3JlL21hY2hpbmUuYyBiL2h3L2NvcmUvbWFj
aGluZS5jCmluZGV4IDllOGMwNjAzNmYuLjRiYmNlYzhmYmQgMTAwNjQ0Ci0tLSBhL2h3L2NvcmUv
bWFjaGluZS5jCisrKyBiL2h3L2NvcmUvbWFjaGluZS5jCkBAIC0zMyw4ICszMywxMSBAQCBHbG9i
YWxQcm9wZXJ0eSBod19jb21wYXRfNF8yW10gPSB7CiAgICAgeyAidmlydGlvLXNjc2ktZGV2aWNl
IiwgInZpcnRxdWV1ZV9zaXplIiwgIjEyOCJ9LAogICAgIHsgInZpcnRpby1ibGstZGV2aWNlIiwg
IngtZW5hYmxlLXdjZS1pZi1jb25maWctd2NlIiwgIm9mZiIgfSwKICAgICB7ICJ2aXJ0aW8tYmxr
LWRldmljZSIsICJzZWctbWF4LWFkanVzdCIsICJvZmYifSwKKyAgICB7ICJ2aXJ0aW8tc2NzaS1k
ZXZpY2UiLCAibnVtX3F1ZXVlcyIsICIxIn0sCiAgICAgeyAidmlydGlvLXNjc2ktZGV2aWNlIiwg
InNlZ19tYXhfYWRqdXN0IiwgIm9mZiJ9LAogICAgIHsgInZob3N0LWJsay1kZXZpY2UiLCAic2Vn
X21heF9hZGp1c3QiLCAib2ZmIn0sCisgICAgeyAidmhvc3Qtc2NzaSIsICJudW1fcXVldWVzIiwg
IjEifSwKKyAgICB7ICJ2aG9zdC11c2VyLXNjc2kiLCAibnVtX3F1ZXVlcyIsICIxIn0sCiAgICAg
eyAidXNiLWhvc3QiLCAic3VwcHJlc3MtcmVtb3RlLXdha2UiLCAib2ZmIiB9LAogICAgIHsgInVz
Yi1yZWRpciIsICJzdXBwcmVzcy1yZW1vdGUtd2FrZSIsICJvZmYiIH0sCiAgICAgeyAicXhsIiwg
InJldmlzaW9uIiwgIjQiIH0sCmRpZmYgLS1naXQgYS9ody9zY3NpL3Zob3N0LXNjc2kuYyBiL2h3
L3Njc2kvdmhvc3Qtc2NzaS5jCmluZGV4IGYwNTIzNzdiN2UuLjhjYjdlMzgyNWYgMTAwNjQ0Ci0t
LSBhL2h3L3Njc2kvdmhvc3Qtc2NzaS5jCisrKyBiL2h3L3Njc2kvdmhvc3Qtc2NzaS5jCkBAIC0y
NzIsNyArMjcyLDggQEAgc3RhdGljIFByb3BlcnR5IHZob3N0X3Njc2lfcHJvcGVydGllc1tdID0g
ewogICAgIERFRklORV9QUk9QX1NUUklORygidmhvc3RmZCIsIFZpcnRJT1NDU0lDb21tb24sIGNv
bmYudmhvc3RmZCksCiAgICAgREVGSU5FX1BST1BfU1RSSU5HKCJ3d3BuIiwgVmlydElPU0NTSUNv
bW1vbiwgY29uZi53d3BuKSwKICAgICBERUZJTkVfUFJPUF9VSU5UMzIoImJvb3RfdHBndCIsIFZp
cnRJT1NDU0lDb21tb24sIGNvbmYuYm9vdF90cGd0LCAwKSwKLSAgICBERUZJTkVfUFJPUF9VSU5U
MzIoIm51bV9xdWV1ZXMiLCBWaXJ0SU9TQ1NJQ29tbW9uLCBjb25mLm51bV9xdWV1ZXMsIDEpLAor
ICAgIERFRklORV9QUk9QX1VJTlQzMigibnVtX3F1ZXVlcyIsIFZpcnRJT1NDU0lDb21tb24sIGNv
bmYubnVtX3F1ZXVlcywKKyAgICAgICAgICAgICAgICAgICAgICAgVklSVElPX1NDU0lfQVVUT19O
VU1fUVVFVUVTKSwKICAgICBERUZJTkVfUFJPUF9VSU5UMzIoInZpcnRxdWV1ZV9zaXplIiwgVmly
dElPU0NTSUNvbW1vbiwgY29uZi52aXJ0cXVldWVfc2l6ZSwKICAgICAgICAgICAgICAgICAgICAg
ICAgMTI4KSwKICAgICBERUZJTkVfUFJPUF9CT09MKCJzZWdfbWF4X2FkanVzdCIsIFZpcnRJT1ND
U0lDb21tb24sIGNvbmYuc2VnX21heF9hZGp1c3QsCmRpZmYgLS1naXQgYS9ody9zY3NpL3Zob3N0
LXVzZXItc2NzaS5jIGIvaHcvc2NzaS92aG9zdC11c2VyLXNjc2kuYwppbmRleCBlOTc1MmJhYTg5
Li5mMGE3ZTc2MjgwIDEwMDY0NAotLS0gYS9ody9zY3NpL3Zob3N0LXVzZXItc2NzaS5jCisrKyBi
L2h3L3Njc2kvdmhvc3QtdXNlci1zY3NpLmMKQEAgLTE2Myw3ICsxNjMsOCBAQCBzdGF0aWMgdm9p
ZCB2aG9zdF91c2VyX3Njc2lfdW5yZWFsaXplKERldmljZVN0YXRlICpkZXYsIEVycm9yICoqZXJy
cCkKIHN0YXRpYyBQcm9wZXJ0eSB2aG9zdF91c2VyX3Njc2lfcHJvcGVydGllc1tdID0gewogICAg
IERFRklORV9QUk9QX0NIUigiY2hhcmRldiIsIFZpcnRJT1NDU0lDb21tb24sIGNvbmYuY2hhcmRl
diksCiAgICAgREVGSU5FX1BST1BfVUlOVDMyKCJib290X3RwZ3QiLCBWaXJ0SU9TQ1NJQ29tbW9u
LCBjb25mLmJvb3RfdHBndCwgMCksCi0gICAgREVGSU5FX1BST1BfVUlOVDMyKCJudW1fcXVldWVz
IiwgVmlydElPU0NTSUNvbW1vbiwgY29uZi5udW1fcXVldWVzLCAxKSwKKyAgICBERUZJTkVfUFJP
UF9VSU5UMzIoIm51bV9xdWV1ZXMiLCBWaXJ0SU9TQ1NJQ29tbW9uLCBjb25mLm51bV9xdWV1ZXMs
CisgICAgICAgICAgICAgICAgICAgICAgIFZJUlRJT19TQ1NJX0FVVE9fTlVNX1FVRVVFUyksCiAg
ICAgREVGSU5FX1BST1BfVUlOVDMyKCJ2aXJ0cXVldWVfc2l6ZSIsIFZpcnRJT1NDU0lDb21tb24s
IGNvbmYudmlydHF1ZXVlX3NpemUsCiAgICAgICAgICAgICAgICAgICAgICAgIDEyOCksCiAgICAg
REVGSU5FX1BST1BfVUlOVDMyKCJtYXhfc2VjdG9ycyIsIFZpcnRJT1NDU0lDb21tb24sIGNvbmYu
bWF4X3NlY3RvcnMsCmRpZmYgLS1naXQgYS9ody9zY3NpL3ZpcnRpby1zY3NpLmMgYi9ody9zY3Np
L3ZpcnRpby1zY3NpLmMKaW5kZXggNDI3YWQ4M2M1MC4uM2JmOTc4MzZkOSAxMDA2NDQKLS0tIGEv
aHcvc2NzaS92aXJ0aW8tc2NzaS5jCisrKyBiL2h3L3Njc2kvdmlydGlvLXNjc2kuYwpAQCAtODkx
LDYgKzg5MSw5IEBAIHZvaWQgdmlydGlvX3Njc2lfY29tbW9uX3JlYWxpemUoRGV2aWNlU3RhdGUg
KmRldiwKICAgICB2aXJ0aW9faW5pdCh2ZGV2LCAidmlydGlvLXNjc2kiLCBWSVJUSU9fSURfU0NT
SSwKICAgICAgICAgICAgICAgICBzaXplb2YoVmlydElPU0NTSUNvbmZpZykpOwogCisgICAgaWYg
KHMtPmNvbmYubnVtX3F1ZXVlcyA9PSBWSVJUSU9fU0NTSV9BVVRPX05VTV9RVUVVRVMpIHsKKyAg
ICAgICAgcy0+Y29uZi5udW1fcXVldWVzID0gMTsKKyAgICB9CiAgICAgaWYgKHMtPmNvbmYubnVt
X3F1ZXVlcyA9PSAwIHx8CiAgICAgICAgICAgICBzLT5jb25mLm51bV9xdWV1ZXMgPiBWSVJUSU9f
UVVFVUVfTUFYIC0gVklSVElPX1NDU0lfVlFfTlVNX0ZJWEVEKSB7CiAgICAgICAgIGVycm9yX3Nl
dGcoZXJycCwgIkludmFsaWQgbnVtYmVyIG9mIHF1ZXVlcyAoPSAlIiBQUkl1MzIgIiksICIKQEAg
LTk2NCw3ICs5NjcsOCBAQCBzdGF0aWMgdm9pZCB2aXJ0aW9fc2NzaV9kZXZpY2VfdW5yZWFsaXpl
KERldmljZVN0YXRlICpkZXYsIEVycm9yICoqZXJycCkKIH0KIAogc3RhdGljIFByb3BlcnR5IHZp
cnRpb19zY3NpX3Byb3BlcnRpZXNbXSA9IHsKLSAgICBERUZJTkVfUFJPUF9VSU5UMzIoIm51bV9x
dWV1ZXMiLCBWaXJ0SU9TQ1NJLCBwYXJlbnRfb2JqLmNvbmYubnVtX3F1ZXVlcywgMSksCisgICAg
REVGSU5FX1BST1BfVUlOVDMyKCJudW1fcXVldWVzIiwgVmlydElPU0NTSSwgcGFyZW50X29iai5j
b25mLm51bV9xdWV1ZXMsCisgICAgICAgICAgICAgICAgICAgICAgIFZJUlRJT19TQ1NJX0FVVE9f
TlVNX1FVRVVFUyksCiAgICAgREVGSU5FX1BST1BfVUlOVDMyKCJ2aXJ0cXVldWVfc2l6ZSIsIFZp
cnRJT1NDU0ksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVu
dF9vYmouY29uZi52aXJ0cXVldWVfc2l6ZSwgMjU2KSwKICAgICBERUZJTkVfUFJPUF9CT09MKCJz
ZWdfbWF4X2FkanVzdCIsIFZpcnRJT1NDU0ksCmRpZmYgLS1naXQgYS9ody92aXJ0aW8vdmhvc3Qt
c2NzaS1wY2kuYyBiL2h3L3ZpcnRpby92aG9zdC1zY3NpLXBjaS5jCmluZGV4IDVkY2U2NDBlYWYu
LmEwYjdjZGMxYWMgMTAwNjQ0Ci0tLSBhL2h3L3ZpcnRpby92aG9zdC1zY3NpLXBjaS5jCisrKyBi
L2h3L3ZpcnRpby92aG9zdC1zY3NpLXBjaS5jCkBAIC0xNyw2ICsxNyw3IEBACiAjaW5jbHVkZSAi
cWVtdS9vc2RlcC5oIgogCiAjaW5jbHVkZSAic3RhbmRhcmQtaGVhZGVycy9saW51eC92aXJ0aW9f
cGNpLmgiCisjaW5jbHVkZSAiaHcvYm9hcmRzLmgiCiAjaW5jbHVkZSAiaHcvcWRldi1wcm9wZXJ0
aWVzLmgiCiAjaW5jbHVkZSAiaHcvdmlydGlvL3Zob3N0LXNjc2kuaCIKICNpbmNsdWRlICJxYXBp
L2Vycm9yLmgiCkBAIC00NywxMCArNDgsMTUgQEAgc3RhdGljIHZvaWQgdmhvc3Rfc2NzaV9wY2lf
cmVhbGl6ZShWaXJ0SU9QQ0lQcm94eSAqdnBjaV9kZXYsIEVycm9yICoqZXJycCkKIHsKICAgICBW
SG9zdFNDU0lQQ0kgKmRldiA9IFZIT1NUX1NDU0lfUENJKHZwY2lfZGV2KTsKICAgICBEZXZpY2VT
dGF0ZSAqdmRldiA9IERFVklDRSgmZGV2LT52ZGV2KTsKLSAgICBWaXJ0SU9TQ1NJQ29tbW9uICp2
cyA9IFZJUlRJT19TQ1NJX0NPTU1PTih2ZGV2KTsKKyAgICBWaXJ0SU9TQ1NJQ29uZiAqY29uZiA9
ICZkZXYtPnZkZXYucGFyZW50X29iai5wYXJlbnRfb2JqLmNvbmY7CisKKyAgICAvKiAxOjEgdnEg
dG8gdmNwdSBtYXBwaW5nIGlzIGlkZWFsIGJlY2F1c2UgaXQgYXZvaWRzIElQSXMgKi8KKyAgICBp
ZiAoY29uZi0+bnVtX3F1ZXVlcyA9PSBWSVJUSU9fU0NTSV9BVVRPX05VTV9RVUVVRVMpIHsKKyAg
ICAgICAgY29uZi0+bnVtX3F1ZXVlcyA9IGN1cnJlbnRfbWFjaGluZS0+c21wLmNwdXM7CisgICAg
fQogCiAgICAgaWYgKHZwY2lfZGV2LT5udmVjdG9ycyA9PSBERVZfTlZFQ1RPUlNfVU5TUEVDSUZJ
RUQpIHsKLSAgICAgICAgdnBjaV9kZXYtPm52ZWN0b3JzID0gdnMtPmNvbmYubnVtX3F1ZXVlcyAr
IDM7CisgICAgICAgIHZwY2lfZGV2LT5udmVjdG9ycyA9IGNvbmYtPm51bV9xdWV1ZXMgKyBWSVJU
SU9fU0NTSV9WUV9OVU1fRklYRUQgKyAxOwogICAgIH0KIAogICAgIHFkZXZfc2V0X3BhcmVudF9i
dXModmRldiwgQlVTKCZ2cGNpX2Rldi0+YnVzKSk7CmRpZmYgLS1naXQgYS9ody92aXJ0aW8vdmhv
c3QtdXNlci1zY3NpLXBjaS5jIGIvaHcvdmlydGlvL3Zob3N0LXVzZXItc2NzaS1wY2kuYwppbmRl
eCAzMmZlYmIyZGFhLi4yNzg3MTIzYzhkIDEwMDY0NAotLS0gYS9ody92aXJ0aW8vdmhvc3QtdXNl
ci1zY3NpLXBjaS5jCisrKyBiL2h3L3ZpcnRpby92aG9zdC11c2VyLXNjc2ktcGNpLmMKQEAgLTE4
LDYgKzE4LDcgQEAKICNpbmNsdWRlICJxZW11L29zZGVwLmgiCiAKICNpbmNsdWRlICJzdGFuZGFy
ZC1oZWFkZXJzL2xpbnV4L3ZpcnRpb19wY2kuaCIKKyNpbmNsdWRlICJody9ib2FyZHMuaCIKICNp
bmNsdWRlICJody92aXJ0aW8vdmhvc3QtdXNlci1zY3NpLmgiCiAjaW5jbHVkZSAiaHcvdmlydGlv
L3ZpcnRpby5oIgogI2luY2x1ZGUgImh3L3ZpcnRpby92aXJ0aW8tc2NzaS5oIgpAQCAtNTMsMTAg
KzU0LDE1IEBAIHN0YXRpYyB2b2lkIHZob3N0X3VzZXJfc2NzaV9wY2lfcmVhbGl6ZShWaXJ0SU9Q
Q0lQcm94eSAqdnBjaV9kZXYsIEVycm9yICoqZXJycCkKIHsKICAgICBWSG9zdFVzZXJTQ1NJUENJ
ICpkZXYgPSBWSE9TVF9VU0VSX1NDU0lfUENJKHZwY2lfZGV2KTsKICAgICBEZXZpY2VTdGF0ZSAq
dmRldiA9IERFVklDRSgmZGV2LT52ZGV2KTsKLSAgICBWaXJ0SU9TQ1NJQ29tbW9uICp2cyA9IFZJ
UlRJT19TQ1NJX0NPTU1PTih2ZGV2KTsKKyAgICBWaXJ0SU9TQ1NJQ29uZiAqY29uZiA9ICZkZXYt
PnZkZXYucGFyZW50X29iai5wYXJlbnRfb2JqLmNvbmY7CisKKyAgICAvKiAxOjEgdnEgdG8gdmNw
dSBtYXBwaW5nIGlzIGlkZWFsIGJlY2F1c2UgaXQgYXZvaWRzIElQSXMgKi8KKyAgICBpZiAoY29u
Zi0+bnVtX3F1ZXVlcyA9PSBWSVJUSU9fU0NTSV9BVVRPX05VTV9RVUVVRVMpIHsKKyAgICAgICAg
Y29uZi0+bnVtX3F1ZXVlcyA9IGN1cnJlbnRfbWFjaGluZS0+c21wLmNwdXM7CisgICAgfQogCiAg
ICAgaWYgKHZwY2lfZGV2LT5udmVjdG9ycyA9PSBERVZfTlZFQ1RPUlNfVU5TUEVDSUZJRUQpIHsK
LSAgICAgICAgdnBjaV9kZXYtPm52ZWN0b3JzID0gdnMtPmNvbmYubnVtX3F1ZXVlcyArIDM7Cisg
ICAgICAgIHZwY2lfZGV2LT5udmVjdG9ycyA9IGNvbmYtPm51bV9xdWV1ZXMgKyBWSVJUSU9fU0NT
SV9WUV9OVU1fRklYRUQgKyAxOwogICAgIH0KIAogICAgIHFkZXZfc2V0X3BhcmVudF9idXModmRl
diwgQlVTKCZ2cGNpX2Rldi0+YnVzKSk7CmRpZmYgLS1naXQgYS9ody92aXJ0aW8vdmlydGlvLXNj
c2ktcGNpLmMgYi9ody92aXJ0aW8vdmlydGlvLXNjc2ktcGNpLmMKaW5kZXggZTgyZTdlNTY4MC4u
NDU2MThlZDJkMSAxMDA2NDQKLS0tIGEvaHcvdmlydGlvL3ZpcnRpby1zY3NpLXBjaS5jCisrKyBi
L2h3L3ZpcnRpby92aXJ0aW8tc2NzaS1wY2kuYwpAQCAtMTUsNiArMTUsNyBAQAogCiAjaW5jbHVk
ZSAicWVtdS9vc2RlcC5oIgogCisjaW5jbHVkZSAiaHcvYm9hcmRzLmgiCiAjaW5jbHVkZSAiaHcv
cWRldi1wcm9wZXJ0aWVzLmgiCiAjaW5jbHVkZSAiaHcvdmlydGlvL3ZpcnRpby1zY3NpLmgiCiAj
aW5jbHVkZSAicWVtdS9tb2R1bGUuaCIKQEAgLTQ2LDEyICs0NywxNyBAQCBzdGF0aWMgdm9pZCB2
aXJ0aW9fc2NzaV9wY2lfcmVhbGl6ZShWaXJ0SU9QQ0lQcm94eSAqdnBjaV9kZXYsIEVycm9yICoq
ZXJycCkKIHsKICAgICBWaXJ0SU9TQ1NJUENJICpkZXYgPSBWSVJUSU9fU0NTSV9QQ0kodnBjaV9k
ZXYpOwogICAgIERldmljZVN0YXRlICp2ZGV2ID0gREVWSUNFKCZkZXYtPnZkZXYpOwotICAgIFZp
cnRJT1NDU0lDb21tb24gKnZzID0gVklSVElPX1NDU0lfQ09NTU9OKHZkZXYpOwogICAgIERldmlj
ZVN0YXRlICpwcm94eSA9IERFVklDRSh2cGNpX2Rldik7CisgICAgVmlydElPU0NTSUNvbmYgKmNv
bmYgPSAmZGV2LT52ZGV2LnBhcmVudF9vYmouY29uZjsKICAgICBjaGFyICpidXNfbmFtZTsKIAor
ICAgIC8qIDE6MSB2cSB0byB2Y3B1IG1hcHBpbmcgaXMgaWRlYWwgYmVjYXVzZSBpdCBhdm9pZHMg
SVBJcyAqLworICAgIGlmIChjb25mLT5udW1fcXVldWVzID09IFZJUlRJT19TQ1NJX0FVVE9fTlVN
X1FVRVVFUykgeworICAgICAgICBjb25mLT5udW1fcXVldWVzID0gY3VycmVudF9tYWNoaW5lLT5z
bXAuY3B1czsKKyAgICB9CisKICAgICBpZiAodnBjaV9kZXYtPm52ZWN0b3JzID09IERFVl9OVkVD
VE9SU19VTlNQRUNJRklFRCkgewotICAgICAgICB2cGNpX2Rldi0+bnZlY3RvcnMgPSB2cy0+Y29u
Zi5udW1fcXVldWVzICsgMzsKKyAgICAgICAgdnBjaV9kZXYtPm52ZWN0b3JzID0gY29uZi0+bnVt
X3F1ZXVlcyArIFZJUlRJT19TQ1NJX1ZRX05VTV9GSVhFRCArIDE7CiAgICAgfQogCiAgICAgLyoK
ZGlmZiAtLWdpdCBhL2luY2x1ZGUvaHcvdmlydGlvL3ZpcnRpby1zY3NpLmggYi9pbmNsdWRlL2h3
L3ZpcnRpby92aXJ0aW8tc2NzaS5oCmluZGV4IDlmMjkzYmNiODAuLmMwYjhlNGRkN2UgMTAwNjQ0
Ci0tLSBhL2luY2x1ZGUvaHcvdmlydGlvL3ZpcnRpby1zY3NpLmgKKysrIGIvaW5jbHVkZS9ody92
aXJ0aW8vdmlydGlvLXNjc2kuaApAQCAtMzksNiArMzksOCBAQAogLyogTnVtYmVyIG9mIHZpcnRx
dWV1ZXMgdGhhdCBhcmUgYWx3YXlzIHByZXNlbnQgKi8KICNkZWZpbmUgVklSVElPX1NDU0lfVlFf
TlVNX0ZJWEVEICAgIDIKIAorI2RlZmluZSBWSVJUSU9fU0NTSV9BVVRPX05VTV9RVUVVRVMgVUlO
VDMyX01BWAorCiB0eXBlZGVmIHN0cnVjdCB2aXJ0aW9fc2NzaV9jbWRfcmVxIFZpcnRJT1NDU0lD
bWRSZXE7CiB0eXBlZGVmIHN0cnVjdCB2aXJ0aW9fc2NzaV9jbWRfcmVzcCBWaXJ0SU9TQ1NJQ21k
UmVzcDsKIHR5cGVkZWYgc3RydWN0IHZpcnRpb19zY3NpX2N0cmxfdG1mX3JlcSBWaXJ0SU9TQ1NJ
Q3RybFRNRlJlcTsKLS0gCjIuMjQuMQoK


