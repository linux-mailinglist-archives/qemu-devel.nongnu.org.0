Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id D8276168DFB
	for <lists+qemu-devel@lfdr.de>; Sat, 22 Feb 2020 10:06:38 +0100 (CET)
Received: from localhost ([::1]:40672 helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>)
	id 1j5Qk9-0007cN-Tu
	for lists+qemu-devel@lfdr.de; Sat, 22 Feb 2020 04:06:37 -0500
Received: from eggs.gnu.org ([2001:470:142:3::10]:38874)
 by lists.gnu.org with esmtp (Exim 4.90_1)
 (envelope-from <stefanha@redhat.com>) id 1j5QYS-0002fP-8J
 for qemu-devel@nongnu.org; Sat, 22 Feb 2020 03:54:34 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
 (envelope-from <stefanha@redhat.com>) id 1j5QYQ-0001z6-GI
 for qemu-devel@nongnu.org; Sat, 22 Feb 2020 03:54:32 -0500
Received: from us-smtp-2.mimecast.com ([205.139.110.61]:21332
 helo=us-smtp-delivery-1.mimecast.com)
 by eggs.gnu.org with esmtps (TLS1.0:DHE_RSA_AES_256_CBC_SHA1:32)
 (Exim 4.71) (envelope-from <stefanha@redhat.com>) id 1j5QYQ-0001y4-Ap
 for qemu-devel@nongnu.org; Sat, 22 Feb 2020 03:54:30 -0500
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1582361669;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=FrfWFsmGTvET4upelhz2XbaCKhrk7vwMcYuAPuPE6eU=;
 b=eSumE4siaP77nZFuTsJJ4WXCy7Adii9C24TtLHOSveV2LFTGtxIjd8C6IO+1E3Xa3cTmcw
 VWyBSSU/FGdYm7IUMUivt2xV734Cpw2sJaX6EL+lISvXXII1zmv13XWoPVtq7lErRFBlyQ
 6kc3ZzP9JoJe26lnLyk5SOsehr+60UM=
Received: from mimecast-mx01.redhat.com (mimecast-mx01.redhat.com
 [209.132.183.4]) (Using TLS) by relay.mimecast.com with ESMTP id
 us-mta-464-eTjI6qAeOv6oMR9ZLyv-Ew-1; Sat, 22 Feb 2020 03:54:27 -0500
X-MC-Unique: eTjI6qAeOv6oMR9ZLyv-Ew-1
Received: from smtp.corp.redhat.com (int-mx08.intmail.prod.int.phx2.redhat.com
 [10.5.11.23])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mimecast-mx01.redhat.com (Postfix) with ESMTPS id 7F96E800D54;
 Sat, 22 Feb 2020 08:54:26 +0000 (UTC)
Received: from localhost (ovpn-116-74.ams2.redhat.com [10.36.116.74])
 by smtp.corp.redhat.com (Postfix) with ESMTP id B19F819C7F;
 Sat, 22 Feb 2020 08:54:25 +0000 (UTC)
From: Stefan Hajnoczi <stefanha@redhat.com>
To: qemu-devel@nongnu.org
Subject: [PULL 21/31] fuzz: add fuzzer skeleton
Date: Sat, 22 Feb 2020 08:50:20 +0000
Message-Id: <20200222085030.1760640-22-stefanha@redhat.com>
In-Reply-To: <20200222085030.1760640-1-stefanha@redhat.com>
References: <20200222085030.1760640-1-stefanha@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.84 on 10.5.11.23
X-Mimecast-Spam-Score: 0
X-Mimecast-Originator: redhat.com
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: base64
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.2.x-3.x [generic]
X-Received-From: 205.139.110.61
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Cc: Kevin Wolf <kwolf@redhat.com>, Peter Maydell <peter.maydell@linaro.org>,
 Thomas Huth <thuth@redhat.com>, Eduardo Habkost <ehabkost@redhat.com>,
 qemu-block@nongnu.org, "Michael S. Tsirkin" <mst@redhat.com>,
 Laurent Vivier <lvivier@redhat.com>, Max Reitz <mreitz@redhat.com>,
 Alexander Bulekov <alxndr@bu.edu>, Bandan Das <bsd@redhat.com>,
 Stefan Hajnoczi <stefanha@redhat.com>,
 =?UTF-8?q?Marc-Andr=C3=A9=20Lureau?= <marcandre.lureau@redhat.com>,
 Paolo Bonzini <pbonzini@redhat.com>, Fam Zheng <fam@euphon.net>,
 Darren Kenny <darren.kenny@oracle.com>, Richard Henderson <rth@twiddle.net>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: "Qemu-devel" <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>

RnJvbTogQWxleGFuZGVyIEJ1bGVrb3YgPGFseG5kckBidS5lZHU+Cgp0ZXN0cy9mdXp6L2Z1enou
YyBzZXJ2ZXMgYXMgdGhlIGVudHJ5IHBvaW50IGZvciB0aGUgdmlydHVhbC1kZXZpY2UKZnV6emVy
LiBOYW1lbHksIGxpYmZ1enplciBpbnZva2VzIHRoZSBMTFZNRnV6emVySW5pdGlhbGl6ZSBhbmQK
TExWTUZ1enplclRlc3RPbmVJbnB1dCBmdW5jdGlvbnMsIGJvdGggb2Ygd2hpY2ggYXJlIGRlZmlu
ZWQgaW4gdGhpcwpmaWxlLiBUaGlzIGNoYW5nZSBhZGRzIGEgIkZ1enpUYXJnZXQiIHN0cnVjdCwg
YWxvbmcgd2l0aCB0aGUKZnV6el9hZGRfdGFyZ2V0IGZ1bmN0aW9uLCB3aGljaCBzaG91bGQgYmUg
dXNlZCB0byBkZWZpbmUgbmV3IGZ1enoKdGFyZ2V0cy4KClNpZ25lZC1vZmYtYnk6IEFsZXhhbmRl
ciBCdWxla292IDxhbHhuZHJAYnUuZWR1PgpSZXZpZXdlZC1ieTogU3RlZmFuIEhham5vY3ppIDxz
dGVmYW5oYUByZWRoYXQuY29tPgpSZXZpZXdlZC1ieTogRGFycmVuIEtlbm55IDxkYXJyZW4ua2Vu
bnlAb3JhY2xlLmNvbT4KTWVzc2FnZS1pZDogMjAyMDAyMjAwNDExMTguMjMyNjQtMTMtYWx4bmRy
QGJ1LmVkdQpTaWduZWQtb2ZmLWJ5OiBTdGVmYW4gSGFqbm9jemkgPHN0ZWZhbmhhQHJlZGhhdC5j
b20+Ci0tLQogTUFJTlRBSU5FUlMgICAgICAgICAgICAgICAgICAgICAgIHwgICA4ICsrCiB0ZXN0
cy9xdGVzdC9mdXp6L01ha2VmaWxlLmluY2x1ZGUgfCAgIDYgKwogdGVzdHMvcXRlc3QvZnV6ei9m
dXp6LmMgICAgICAgICAgIHwgMTc5ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKwogdGVz
dHMvcXRlc3QvZnV6ei9mdXp6LmggICAgICAgICAgIHwgIDk1ICsrKysrKysrKysrKysrKysKIDQg
ZmlsZXMgY2hhbmdlZCwgMjg4IGluc2VydGlvbnMoKykKIGNyZWF0ZSBtb2RlIDEwMDY0NCB0ZXN0
cy9xdGVzdC9mdXp6L01ha2VmaWxlLmluY2x1ZGUKIGNyZWF0ZSBtb2RlIDEwMDY0NCB0ZXN0cy9x
dGVzdC9mdXp6L2Z1enouYwogY3JlYXRlIG1vZGUgMTAwNjQ0IHRlc3RzL3F0ZXN0L2Z1enovZnV6
ei5oCgpkaWZmIC0tZ2l0IGEvTUFJTlRBSU5FUlMgYi9NQUlOVEFJTkVSUwppbmRleCA5NjkzMjlm
ODNlLi4xOTVkZDU4Y2FjIDEwMDY0NAotLS0gYS9NQUlOVEFJTkVSUworKysgYi9NQUlOVEFJTkVS
UwpAQCAtMjE4NCw2ICsyMTg0LDE0IEBAIEY6IHF0ZXN0LmMKIEY6IGFjY2VsL3F0ZXN0LmMKIEY6
IHRlc3RzL3F0ZXN0LwogCitEZXZpY2UgRnV6emluZworTTogQWxleGFuZGVyIEJ1bGVrb3YgPGFs
eG5kckBidS5lZHU+CitSOiBQYW9sbyBCb256aW5pIDxwYm9uemluaUByZWRoYXQuY29tPgorUjog
QmFuZGFuIERhcyA8YnNkQHJlZGhhdC5jb20+CitSOiBTdGVmYW4gSGFqbm9jemkgPHN0ZWZhbmhh
QHJlZGhhdC5jb20+CitTOiBNYWludGFpbmVkCitGOiB0ZXN0cy9xdGVzdC9mdXp6LworCiBSZWdp
c3RlciBBUEkKIE06IEFsaXN0YWlyIEZyYW5jaXMgPGFsaXN0YWlyQGFsaXN0YWlyMjMubWU+CiBT
OiBNYWludGFpbmVkCmRpZmYgLS1naXQgYS90ZXN0cy9xdGVzdC9mdXp6L01ha2VmaWxlLmluY2x1
ZGUgYi90ZXN0cy9xdGVzdC9mdXp6L01ha2VmaWxlLmluY2x1ZGUKbmV3IGZpbGUgbW9kZSAxMDA2
NDQKaW5kZXggMDAwMDAwMDAwMC4uODYzMmJiODlmNAotLS0gL2Rldi9udWxsCisrKyBiL3Rlc3Rz
L3F0ZXN0L2Z1enovTWFrZWZpbGUuaW5jbHVkZQpAQCAtMCwwICsxLDYgQEAKK1FFTVVfUFJPR19G
VVpaPXFlbXUtZnV6ei0kKFRBUkdFVF9OQU1FKSQoRVhFU1VGKQorCitmdXp6LW9iai15ICs9IHRl
c3RzL3F0ZXN0L2xpYnF0ZXN0Lm8KK2Z1enotb2JqLXkgKz0gdGVzdHMvcXRlc3QvZnV6ei9mdXp6
Lm8gIyBGdXp6ZXIgc2tlbGV0b24KKworRlVaWl9DRkxBR1MgKz0gLUkkKFNSQ19QQVRIKS90ZXN0
cyAtSSQoU1JDX1BBVEgpL3Rlc3RzL3F0ZXN0CmRpZmYgLS1naXQgYS90ZXN0cy9xdGVzdC9mdXp6
L2Z1enouYyBiL3Rlc3RzL3F0ZXN0L2Z1enovZnV6ei5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0Cmlu
ZGV4IDAwMDAwMDAwMDAuLjBkNzhhYzhkMzYKLS0tIC9kZXYvbnVsbAorKysgYi90ZXN0cy9xdGVz
dC9mdXp6L2Z1enouYwpAQCAtMCwwICsxLDE3OSBAQAorLyoKKyAqIGZ1enppbmcgZHJpdmVyCisg
KgorICogQ29weXJpZ2h0IFJlZCBIYXQgSW5jLiwgMjAxOQorICoKKyAqIEF1dGhvcnM6CisgKiAg
QWxleGFuZGVyIEJ1bGVrb3YgICA8YWx4bmRyQGJ1LmVkdT4KKyAqCisgKiBUaGlzIHdvcmsgaXMg
bGljZW5zZWQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR1BMLCB2ZXJzaW9uIDIgb3IgbGF0
ZXIuCisgKiBTZWUgdGhlIENPUFlJTkcgZmlsZSBpbiB0aGUgdG9wLWxldmVsIGRpcmVjdG9yeS4K
KyAqCisgKi8KKworI2luY2x1ZGUgInFlbXUvb3NkZXAuaCIKKworI2luY2x1ZGUgPHdvcmRleHAu
aD4KKworI2luY2x1ZGUgInN5c2VtdS9xdGVzdC5oIgorI2luY2x1ZGUgInN5c2VtdS9ydW5zdGF0
ZS5oIgorI2luY2x1ZGUgInN5c2VtdS9zeXNlbXUuaCIKKyNpbmNsdWRlICJxZW11L21haW4tbG9v
cC5oIgorI2luY2x1ZGUgInRlc3RzL3F0ZXN0L2xpYnF0ZXN0LmgiCisjaW5jbHVkZSAidGVzdHMv
cXRlc3QvbGlicW9zL3FncmFwaC5oIgorI2luY2x1ZGUgImZ1enouaCIKKworI2RlZmluZSBNQVhf
RVZFTlRfTE9PUFMgMTAKKwordHlwZWRlZiBzdHJ1Y3QgRnV6elRhcmdldFN0YXRlIHsKKyAgICAg
ICAgRnV6elRhcmdldCAqdGFyZ2V0OworICAgICAgICBRU0xJU1RfRU5UUlkoRnV6elRhcmdldFN0
YXRlKSB0YXJnZXRfbGlzdDsKK30gRnV6elRhcmdldFN0YXRlOworCit0eXBlZGVmIFFTTElTVF9I
RUFEKCwgRnV6elRhcmdldFN0YXRlKSBGdXp6VGFyZ2V0TGlzdDsKKworc3RhdGljIGNvbnN0IGNo
YXIgKmZ1enpfYXJjaCA9IFRBUkdFVF9OQU1FOworCitzdGF0aWMgRnV6elRhcmdldExpc3QgKmZ1
enpfdGFyZ2V0X2xpc3Q7CitzdGF0aWMgRnV6elRhcmdldCAqZnV6el90YXJnZXQ7CitzdGF0aWMg
UVRlc3RTdGF0ZSAqZnV6el9xdHM7CisKKworCit2b2lkIGZsdXNoX2V2ZW50cyhRVGVzdFN0YXRl
ICpzKQoreworICAgIGludCBpID0gTUFYX0VWRU5UX0xPT1BTOworICAgIHdoaWxlIChnX21haW5f
Y29udGV4dF9wZW5kaW5nKE5VTEwpICYmIGktLSA+IDApIHsKKyAgICAgICAgbWFpbl9sb29wX3dh
aXQoZmFsc2UpOworICAgIH0KK30KKworc3RhdGljIFFUZXN0U3RhdGUgKnF0ZXN0X3NldHVwKHZv
aWQpCit7CisgICAgcXRlc3Rfc2VydmVyX3NldF9zZW5kX2hhbmRsZXIoJnF0ZXN0X2NsaWVudF9p
bnByb2NfcmVjdiwgJmZ1enpfcXRzKTsKKyAgICByZXR1cm4gcXRlc3RfaW5wcm9jX2luaXQoJmZ1
enpfcXRzLCBmYWxzZSwgZnV6el9hcmNoLAorICAgICAgICAgICAgJnF0ZXN0X3NlcnZlcl9pbnBy
b2NfcmVjdik7Cit9CisKK3ZvaWQgZnV6el9hZGRfdGFyZ2V0KGNvbnN0IEZ1enpUYXJnZXQgKnRh
cmdldCkKK3sKKyAgICBGdXp6VGFyZ2V0U3RhdGUgKnRtcDsKKyAgICBGdXp6VGFyZ2V0U3RhdGUg
KnRhcmdldF9zdGF0ZTsKKyAgICBpZiAoIWZ1enpfdGFyZ2V0X2xpc3QpIHsKKyAgICAgICAgZnV6
el90YXJnZXRfbGlzdCA9IGdfbmV3MChGdXp6VGFyZ2V0TGlzdCwgMSk7CisgICAgfQorCisgICAg
UVNMSVNUX0ZPUkVBQ0godG1wLCBmdXp6X3RhcmdldF9saXN0LCB0YXJnZXRfbGlzdCkgeworICAg
ICAgICBpZiAoZ19zdHJjbXAwKHRtcC0+dGFyZ2V0LT5uYW1lLCB0YXJnZXQtPm5hbWUpID09IDAp
IHsKKyAgICAgICAgICAgIGZwcmludGYoc3RkZXJyLCAiRXJyb3I6IEZ1enogdGFyZ2V0IG5hbWUg
JXMgYWxyZWFkeSBpbiB1c2VcbiIsCisgICAgICAgICAgICAgICAgICAgIHRhcmdldC0+bmFtZSk7
CisgICAgICAgICAgICBhYm9ydCgpOworICAgICAgICB9CisgICAgfQorICAgIHRhcmdldF9zdGF0
ZSA9IGdfbmV3MChGdXp6VGFyZ2V0U3RhdGUsIDEpOworICAgIHRhcmdldF9zdGF0ZS0+dGFyZ2V0
ID0gZ19uZXcwKEZ1enpUYXJnZXQsIDEpOworICAgICoodGFyZ2V0X3N0YXRlLT50YXJnZXQpID0g
KnRhcmdldDsKKyAgICBRU0xJU1RfSU5TRVJUX0hFQUQoZnV6el90YXJnZXRfbGlzdCwgdGFyZ2V0
X3N0YXRlLCB0YXJnZXRfbGlzdCk7Cit9CisKKworCitzdGF0aWMgdm9pZCB1c2FnZShjaGFyICpw
YXRoKQoreworICAgIHByaW50ZigiVXNhZ2U6ICVzIC0tZnV6ei10YXJnZXQ9RlVaWl9UQVJHRVQg
W0xJQkZVWlpFUiBBUkdVTUVOVFNdXG4iLCBwYXRoKTsKKyAgICBwcmludGYoIndoZXJlIEZVWlpf
VEFSR0VUIGlzIG9uZSBvZjpcbiIpOworICAgIEZ1enpUYXJnZXRTdGF0ZSAqdG1wOworICAgIGlm
ICghZnV6el90YXJnZXRfbGlzdCkgeworICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIkZ1enogdGFy
Z2V0IGxpc3Qgbm90IGluaXRpYWxpemVkXG4iKTsKKyAgICAgICAgYWJvcnQoKTsKKyAgICB9Cisg
ICAgUVNMSVNUX0ZPUkVBQ0godG1wLCBmdXp6X3RhcmdldF9saXN0LCB0YXJnZXRfbGlzdCkgewor
ICAgICAgICBwcmludGYoIiAqICVzICA6ICVzXG4iLCB0bXAtPnRhcmdldC0+bmFtZSwKKyAgICAg
ICAgICAgICAgICB0bXAtPnRhcmdldC0+ZGVzY3JpcHRpb24pOworICAgIH0KKyAgICBleGl0KDAp
OworfQorCitzdGF0aWMgRnV6elRhcmdldCAqZnV6el9nZXRfdGFyZ2V0KGNoYXIqIG5hbWUpCit7
CisgICAgRnV6elRhcmdldFN0YXRlICp0bXA7CisgICAgaWYgKCFmdXp6X3RhcmdldF9saXN0KSB7
CisgICAgICAgIGZwcmludGYoc3RkZXJyLCAiRnV6eiB0YXJnZXQgbGlzdCBub3QgaW5pdGlhbGl6
ZWRcbiIpOworICAgICAgICBhYm9ydCgpOworICAgIH0KKworICAgIFFTTElTVF9GT1JFQUNIKHRt
cCwgZnV6el90YXJnZXRfbGlzdCwgdGFyZ2V0X2xpc3QpIHsKKyAgICAgICAgaWYgKHN0cmNtcCh0
bXAtPnRhcmdldC0+bmFtZSwgbmFtZSkgPT0gMCkgeworICAgICAgICAgICAgcmV0dXJuIHRtcC0+
dGFyZ2V0OworICAgICAgICB9CisgICAgfQorICAgIHJldHVybiBOVUxMOworfQorCisKKy8qIEV4
ZWN1dGVkIGZvciBlYWNoIGZ1enppbmctaW5wdXQgKi8KK2ludCBMTFZNRnV6emVyVGVzdE9uZUlu
cHV0KGNvbnN0IHVuc2lnbmVkIGNoYXIgKkRhdGEsIHNpemVfdCBTaXplKQoreworICAgIC8qCisg
ICAgICogRG8gdGhlIHByZS1mdXp6LWluaXRpYWxpemF0aW9uIGJlZm9yZSB0aGUgZmlyc3QgZnV6
emluZyBpdGVyYXRpb24sCisgICAgICogaW5zdGVhZCBvZiBiZWZvcmUgdGhlIGFjdHVhbCBmdXp6
IGxvb3AuIFRoaXMgaXMgbmVlZGVkIHNpbmNlIGxpYmZ1enplcgorICAgICAqIG1heSBmb3JrIG9m
ZiBhZGRpdGlvbmFsIHdvcmtlcnMsIHByaW9yIHRvIHRoZSBmdXp6aW5nIGxvb3AsIGFuZCBpZgor
ICAgICAqIHByZV9mdXp6KCkgc2V0cyB1cCBlLmcuIHNoYXJlZCBtZW1vcnksIHRoaXMgc2hvdWxk
IGJlIGRvbmUgZm9yIHRoZQorICAgICAqIGluZGl2aWR1YWwgd29ya2VyIHByb2Nlc3NlcworICAg
ICAqLworICAgIHN0YXRpYyBpbnQgcHJlX2Z1enpfZG9uZTsKKyAgICBpZiAoIXByZV9mdXp6X2Rv
bmUgJiYgZnV6el90YXJnZXQtPnByZV9mdXp6KSB7CisgICAgICAgIGZ1enpfdGFyZ2V0LT5wcmVf
ZnV6eihmdXp6X3F0cyk7CisgICAgICAgIHByZV9mdXp6X2RvbmUgPSB0cnVlOworICAgIH0KKwor
ICAgIGZ1enpfdGFyZ2V0LT5mdXp6KGZ1enpfcXRzLCBEYXRhLCBTaXplKTsKKyAgICByZXR1cm4g
MDsKK30KKworLyogRXhlY3V0ZWQgb25jZSwgcHJpb3IgdG8gZnV6emluZyAqLworaW50IExMVk1G
dXp6ZXJJbml0aWFsaXplKGludCAqYXJnYywgY2hhciAqKiphcmd2LCBjaGFyICoqKmVudnApCit7
CisKKyAgICBjaGFyICp0YXJnZXRfbmFtZTsKKworICAgIC8qIEluaXRpYWxpemUgcWdyYXBoIGFu
ZCBtb2R1bGVzICovCisgICAgcW9zX2dyYXBoX2luaXQoKTsKKyAgICBtb2R1bGVfY2FsbF9pbml0
KE1PRFVMRV9JTklUX0ZVWlpfVEFSR0VUKTsKKyAgICBtb2R1bGVfY2FsbF9pbml0KE1PRFVMRV9J
TklUX1FPTSk7CisgICAgbW9kdWxlX2NhbGxfaW5pdChNT0RVTEVfSU5JVF9MSUJRT1MpOworCisg
ICAgaWYgKCphcmdjIDw9IDEpIHsKKyAgICAgICAgdXNhZ2UoKiphcmd2KTsKKyAgICB9CisKKyAg
ICAvKiBJZGVudGlmeSB0aGUgZnV6eiB0YXJnZXQgKi8KKyAgICB0YXJnZXRfbmFtZSA9ICgqYXJn
dilbMV07CisgICAgaWYgKCFzdHJzdHIodGFyZ2V0X25hbWUsICItLWZ1enotdGFyZ2V0PSIpKSB7
CisgICAgICAgIHVzYWdlKCoqYXJndik7CisgICAgfQorCisgICAgdGFyZ2V0X25hbWUgKz0gc3Ry
bGVuKCItLWZ1enotdGFyZ2V0PSIpOworCisgICAgZnV6el90YXJnZXQgPSBmdXp6X2dldF90YXJn
ZXQodGFyZ2V0X25hbWUpOworICAgIGlmICghZnV6el90YXJnZXQpIHsKKyAgICAgICAgdXNhZ2Uo
Kiphcmd2KTsKKyAgICB9CisKKyAgICBmdXp6X3F0cyA9IHF0ZXN0X3NldHVwKCk7CisKKyAgICBp
ZiAoZnV6el90YXJnZXQtPnByZV92bV9pbml0KSB7CisgICAgICAgIGZ1enpfdGFyZ2V0LT5wcmVf
dm1faW5pdCgpOworICAgIH0KKworICAgIC8qIFJ1biBRRU1VJ3Mgc29mdG1tdSBtYWluIHdpdGgg
dGhlIGZ1enotdGFyZ2V0IGRlcGVuZGVudCBhcmd1bWVudHMgKi8KKyAgICBjb25zdCBjaGFyICpp
bml0X2NtZGxpbmUgPSBmdXp6X3RhcmdldC0+Z2V0X2luaXRfY21kbGluZShmdXp6X3RhcmdldCk7
CisKKyAgICAvKiBTcGxpdCB0aGUgcnVuY21kIGludG8gYW4gYXJndiBhbmQgYXJnYyAqLworICAg
IHdvcmRleHBfdCByZXN1bHQ7CisgICAgd29yZGV4cChpbml0X2NtZGxpbmUsICZyZXN1bHQsIDAp
OworCisgICAgcWVtdV9pbml0KHJlc3VsdC53ZV93b3JkYywgcmVzdWx0LndlX3dvcmR2LCBOVUxM
KTsKKworICAgIHJldHVybiAwOworfQpkaWZmIC0tZ2l0IGEvdGVzdHMvcXRlc3QvZnV6ei9mdXp6
LmggYi90ZXN0cy9xdGVzdC9mdXp6L2Z1enouaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAw
MDAwMDAwMDAwLi4wMzkwMWQ0MTRlCi0tLSAvZGV2L251bGwKKysrIGIvdGVzdHMvcXRlc3QvZnV6
ei9mdXp6LmgKQEAgLTAsMCArMSw5NSBAQAorLyoKKyAqIGZ1enppbmcgZHJpdmVyCisgKgorICog
Q29weXJpZ2h0IFJlZCBIYXQgSW5jLiwgMjAxOQorICoKKyAqIEF1dGhvcnM6CisgKiAgQWxleGFu
ZGVyIEJ1bGVrb3YgICA8YWx4bmRyQGJ1LmVkdT4KKyAqCisgKiBUaGlzIHdvcmsgaXMgbGljZW5z
ZWQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR1BMLCB2ZXJzaW9uIDIgb3IgbGF0ZXIuCisg
KiBTZWUgdGhlIENPUFlJTkcgZmlsZSBpbiB0aGUgdG9wLWxldmVsIGRpcmVjdG9yeS4KKyAqCisg
Ki8KKworI2lmbmRlZiBGVVpaRVJfSF8KKyNkZWZpbmUgRlVaWkVSX0hfCisKKyNpbmNsdWRlICJx
ZW11L29zZGVwLmgiCisjaW5jbHVkZSAicWVtdS91bml0cy5oIgorI2luY2x1ZGUgInFhcGkvZXJy
b3IuaCIKKworI2luY2x1ZGUgInRlc3RzL3F0ZXN0L2xpYnF0ZXN0LmgiCisKKy8qKgorICogQSBs
aWJmdXp6ZXIgZnV6emluZyB0YXJnZXQKKyAqCisgKiBUaGUgUUVNVSBmdXp6aW5nIGJpbmFyeSBp
cyBidWlsdCB3aXRoIGFsbCBhdmFpbGFibGUgdGFyZ2V0cywgZWFjaAorICogd2l0aCBhIHVuaXF1
ZSBAbmFtZSB0aGF0IGNhbiBiZSBzcGVjaWZpZWQgb24gdGhlIGNvbW1hbmQtbGluZSB0bworICog
c2VsZWN0IHdoaWNoIHRhcmdldCBzaG91bGQgcnVuLgorICoKKyAqIEEgdGFyZ2V0IG11c3QgaW1w
bGVtZW50IC0+ZnV6eigpIHRvIHByb2Nlc3MgYSByYW5kb20gaW5wdXQuICBJZiBRRU1VCisgKiBj
cmFzaGVzIGluIC0+ZnV6eigpIHRoZW4gbGliZnV6emVyIHdpbGwgcmVjb3JkIGEgZmFpbHVyZS4K
KyAqCisgKiBGdXp6aW5nIHRhcmdldHMgYXJlIHJlZ2lzdGVyZWQgd2l0aCBmdXp6X2FkZF90YXJn
ZXQoKToKKyAqCisgKiAgIHN0YXRpYyBjb25zdCBGdXp6VGFyZ2V0IGZ1enpfdGFyZ2V0ID0gewor
ICogICAgICAgLm5hbWUgPSAibXktZGV2aWNlLWZpZm8iLAorICogICAgICAgLmRlc2NyaXB0aW9u
ID0gIkZ1enogdGhlIEZJRk8gYnVmZmVyIHJlZ2lzdGVycyBvZiBteS1kZXZpY2UiLAorICogICAg
ICAgLi4uCisgKiAgIH07CisgKgorICogICBzdGF0aWMgdm9pZCByZWdpc3Rlcl9mdXp6X3Rhcmdl
dCh2b2lkKQorICogICB7CisgKiAgICAgICBmdXp6X2FkZF90YXJnZXQoJmZ1enpfdGFyZ2V0KTsK
KyAqICAgfQorICogICBmdXp6X3RhcmdldF9pbml0KHJlZ2lzdGVyX2Z1enpfdGFyZ2V0KTsKKyAq
LwordHlwZWRlZiBzdHJ1Y3QgRnV6elRhcmdldCB7CisgICAgY29uc3QgY2hhciAqbmFtZTsgICAg
ICAgICAvKiB0YXJnZXQgaWRlbnRpZmllciAocGFzc2VkIHRvIC0tZnV6ei10YXJnZXQ9KSovCisg
ICAgY29uc3QgY2hhciAqZGVzY3JpcHRpb247ICAvKiBoZWxwIHRleHQgKi8KKworCisgICAgLyoK
KyAgICAgKiByZXR1cm5zIHRoZSBhcmctbGlzdCB0aGF0IGlzIHBhc3NlZCB0byBxZW11L3NvZnRt
bXUgaW5pdCgpCisgICAgICogQ2Fubm90IGJlIE5VTEwKKyAgICAgKi8KKyAgICBjb25zdCBjaGFy
KiAoKmdldF9pbml0X2NtZGxpbmUpKHN0cnVjdCBGdXp6VGFyZ2V0ICopOworCisgICAgLyoKKyAg
ICAgKiB3aWxsIHJ1biBvbmNlLCBwcmlvciB0byBydW5uaW5nIHFlbXUvc29mdG1tdSBpbml0Lgor
ICAgICAqIGVnOiBzZXQgdXAgc2hhcmVkLW1lbW9yeSBmb3IgY29tbXVuaWNhdGlvbiB3aXRoIHRo
ZSBjaGlsZC1wcm9jZXNzCisgICAgICogQ2FuIGJlIE5VTEwKKyAgICAgKi8KKyAgICB2b2lkKCpw
cmVfdm1faW5pdCkodm9pZCk7CisKKyAgICAvKgorICAgICAqIHdpbGwgcnVuIG9uY2UsIGFmdGVy
IFFFTVUgaGFzIGJlZW4gaW5pdGlhbGl6ZWQsIHByaW9yIHRvIHRoZSBmdXp6LWxvb3AuCisgICAg
ICogZWc6IGRldGVjdCB0aGUgbWVtb3J5IG1hcAorICAgICAqIENhbiBiZSBOVUxMCisgICAgICov
CisgICAgdm9pZCgqcHJlX2Z1enopKFFUZXN0U3RhdGUgKik7CisKKyAgICAvKgorICAgICAqIGFj
Y2VwdHMgYW5kIGV4ZWN1dGVzIGFuIGlucHV0IGZyb20gbGliZnV6emVyLiB0aGlzIGlzIHJlcGVh
dGVkbHkKKyAgICAgKiBleGVjdXRlZCBkdXJpbmcgdGhlIGZ1enppbmcgbG9vcC4gSXRzIHNob3Vs
ZCBoYW5kbGUgc2V0dXAsIGlucHV0CisgICAgICogZXhlY3V0aW9uIGFuZCBjbGVhbnVwLgorICAg
ICAqIENhbm5vdCBiZSBOVUxMCisgICAgICovCisgICAgdm9pZCgqZnV6eikoUVRlc3RTdGF0ZSAq
LCBjb25zdCB1bnNpZ25lZCBjaGFyICosIHNpemVfdCk7CisKK30gRnV6elRhcmdldDsKKwordm9p
ZCBmbHVzaF9ldmVudHMoUVRlc3RTdGF0ZSAqKTsKK3ZvaWQgcmVib290KFFUZXN0U3RhdGUgKik7
CisKKy8qCisgKiBtYWtlcyBhIGNvcHkgb2YgKnRhcmdldCBhbmQgYWRkcyBpdCB0byB0aGUgdGFy
Z2V0LWxpc3QuCisgKiBpLmUuIGZpbmUgdG8gc2V0IHVwIHRhcmdldCBvbiB0aGUgY2FsbGVyJ3Mg
c3RhY2sKKyAqLwordm9pZCBmdXp6X2FkZF90YXJnZXQoY29uc3QgRnV6elRhcmdldCAqdGFyZ2V0
KTsKKworaW50IExMVk1GdXp6ZXJUZXN0T25lSW5wdXQoY29uc3QgdW5zaWduZWQgY2hhciAqRGF0
YSwgc2l6ZV90IFNpemUpOworaW50IExMVk1GdXp6ZXJJbml0aWFsaXplKGludCAqYXJnYywgY2hh
ciAqKiphcmd2LCBjaGFyICoqKmVudnApOworCisjZW5kaWYKKwotLSAKMi4yNC4xCgo=


