Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id 6D5F161A0FF
	for <lists+qemu-devel@lfdr.de>; Fri,  4 Nov 2022 20:29:05 +0100 (CET)
Received: from localhost ([::1] helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces@nongnu.org>)
	id 1or2L2-0001a0-Pf; Fri, 04 Nov 2022 15:26:48 -0400
Received: from eggs.gnu.org ([2001:470:142:3::10])
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1or2Kw-0001XN-Ev
 for qemu-devel@nongnu.org; Fri, 04 Nov 2022 15:26:42 -0400
Received: from mx0a-0031df01.pphosted.com ([205.220.168.131])
 by eggs.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1or2Kt-0002Lq-4o
 for qemu-devel@nongnu.org; Fri, 04 Nov 2022 15:26:42 -0400
Received: from pps.filterd (m0279862.ppops.net [127.0.0.1])
 by mx0a-0031df01.pphosted.com (8.17.1.19/8.17.1.19) with ESMTP id
 2A4JCh8O003158; Fri, 4 Nov 2022 19:26:35 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=quicinc.com;
 h=from : to : cc :
 subject : date : message-id : in-reply-to : references : mime-version :
 content-type : content-transfer-encoding; s=qcppdkim1;
 bh=KooyDAiPsKVURKC1JccYBJ2yaSVVKR0ZT8axl1ljm6A=;
 b=bFU2poJQNUHWJxHWn0XKeh8ZQRzjO1hSWgYhR+vKx1KnO1ARRqdQhB4O1FlbR0QCC1u9
 KaEG0EgWlbsnEntNPVRHaVwIDCm+uW+5XvQMeYbv9RE3h3xR/N+DynwAKiwKgBuY5EC5
 gmChjYDQ/VpA2HibL+o8GO8bUXmUmjfP4xzLlnlsP+RUwzaX9zKa2k6TvDOuUJQkaAP7
 z/4oGnnjUHCWZrbqv8EmpXmWWFehO69LRQ6ufauRVBX0dwMYSBsOeTOcjpNLulhnhTxo
 H+cbA6+bOQ0HR+e3KsG0uyb6aRiE0pw9NV1fSZywPsY3yL1M6nrYFQslE3sxKpr010dq dg== 
Received: from nalasppmta05.qualcomm.com (Global_NAT1.qualcomm.com
 [129.46.96.20])
 by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 3kn74608h2-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Fri, 04 Nov 2022 19:26:35 +0000
Received: from pps.filterd (NALASPPMTA05.qualcomm.com [127.0.0.1])
 by NALASPPMTA05.qualcomm.com (8.17.1.5/8.17.1.5) with ESMTP id 2A4JQZat001491; 
 Fri, 4 Nov 2022 19:26:35 GMT
Received: from pps.reinject (localhost [127.0.0.1])
 by NALASPPMTA05.qualcomm.com (PPS) with ESMTPS id 3khdmjykju-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NO);
 Fri, 04 Nov 2022 19:26:35 +0000
Received: from NALASPPMTA05.qualcomm.com (NALASPPMTA05.qualcomm.com
 [127.0.0.1])
 by pps.reinject (8.17.1.5/8.17.1.5) with ESMTP id 2A4JQY9w001479;
 Fri, 4 Nov 2022 19:26:34 GMT
Received: from hu-devc-lv-u18-c.qualcomm.com (hu-tsimpson-lv.qualcomm.com
 [10.47.235.220])
 by NALASPPMTA05.qualcomm.com (PPS) with ESMTP id 2A4JQX6i001477;
 Fri, 04 Nov 2022 19:26:34 +0000
Received: by hu-devc-lv-u18-c.qualcomm.com (Postfix, from userid 47164)
 id 16F22500118; Fri,  4 Nov 2022 12:26:33 -0700 (PDT)
From: Taylor Simpson <tsimpson@quicinc.com>
To: qemu-devel@nongnu.org
Cc: tsimpson@quicinc.com, richard.henderson@linaro.org, philmd@linaro.org,
 ale@rev.ng, anjo@rev.ng, bcain@quicinc.com, quic_mathbern@quicinc.com
Subject: [PATCH v3 11/11] Hexagon (target/hexagon) Use direct block chaining
 for tight loops
Date: Fri,  4 Nov 2022 12:26:31 -0700
Message-Id: <20221104192631.29434-12-tsimpson@quicinc.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20221104192631.29434-1-tsimpson@quicinc.com>
References: <20221104192631.29434-1-tsimpson@quicinc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
X-QCInternal: smtphost
X-QCInternal: smtphost
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-GUID: PyvdttwQ4yxJ_2U1hKqT8mpvGmJGZu6r
X-Proofpoint-ORIG-GUID: PyvdttwQ4yxJ_2U1hKqT8mpvGmJGZu6r
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.219,Aquarius:18.0.895,Hydra:6.0.545,FMLib:17.11.122.1
 definitions=2022-11-04_11,2022-11-03_01,2022-06-22_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 priorityscore=1501
 malwarescore=0 mlxlogscore=400 impostorscore=0 phishscore=0 adultscore=0
 mlxscore=0 suspectscore=0 spamscore=0 bulkscore=0 lowpriorityscore=0
 clxscore=1015 classifier=spam adjust=0 reason=mlx scancount=1
 engine=8.12.0-2210170000 definitions=main-2211040121
Received-SPF: pass client-ip=205.220.168.131;
 envelope-from=tsimpson@qualcomm.com; helo=mx0a-0031df01.pphosted.com
X-Spam_score_int: -17
X-Spam_score: -1.8
X-Spam_bar: -
X-Spam_report: (-1.8 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, HEADER_FROM_DIFFERENT_DOMAINS=0.249,
 RCVD_IN_DNSWL_NONE=-0.0001, SPF_HELO_NONE=0.001,
 SPF_PASS=-0.001 autolearn=no autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Sender: "Qemu-devel" <qemu-devel-bounces@nongnu.org>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org

RGlyZWN0IGJsb2NrIGNoYWluaW5nIGlzIGRvY3VtZW50ZWQgaGVyZQpodHRwczovL3FlbXUucmVh
ZHRoZWRvY3MuaW8vZW4vbGF0ZXN0L2RldmVsL3RjZy5odG1sI2RpcmVjdC1ibG9jay1jaGFpbmlu
ZwoKSGV4YWdvbiBpbm5lciBsb29wcyBlbmQgd2l0aCB0aGUgZW5kbG9vcDAgaW5zdHJ1Y3Rpb24K
VG8gZ28gYmFjayB0byB0aGUgYmVnaW5uaW5nIG9mIHRoZSBsb29wLCB0aGlzIGluc3RydWN0aW9u
cyB3cml0ZXMgdG8gUEMKZnJvbSByZWdpc3RlciBTQTAgKHN0YXJ0IGFkZHJlc3MgMCkuICBUbyB1
c2UgZGlyZWN0IGJsb2NrIGNoYWluaW5nLCB3ZQpoYXZlIHRvIGFzc2lnbiBQQyB3aXRoIGEgY29u
c3RhbnQgdmFsdWUuICBTbywgd2Ugc3BlY2lhbGl6ZSB0aGUgY29kZQpnZW5lcmF0aW9uIHdoZW4g
dGhlIHN0YXJ0IG9mIHRoZSB0cmFuc2xhdGlvbiBibG9jayBpcyBlcXVhbCB0byBTQTAuCgpXaGVu
IHRoaXMgaXMgdGhlIGNhc2UsIHdlIGRlZmVyIHRoZSBjb21wYXJlL2JyYW5jaCBmcm9tIGVuZGxv
b3AwIHRvCmdlbl9lbmRfdGIuICBXaGVuIHRoaXMgaXMgZG9uZSwgd2UgY2FuIGFzc2lnbiB0aGUg
c3RhcnQgYWRkcmVzcyBvZiB0aGUgVEIKdG8gUEMuCgpTaWduZWQtb2ZmLWJ5OiBUYXlsb3IgU2lt
cHNvbiA8dHNpbXBzb25AcXVpY2luYy5jb20+Ci0tLQogdGFyZ2V0L2hleGFnb24vY3B1LmggICAg
ICAgfCAxNyArKysrKysrKy0tLS0KIHRhcmdldC9oZXhhZ29uL2dlbl90Y2cuaCAgIHwgIDMgKysK
IHRhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5oIHwgIDEgKwogdGFyZ2V0L2hleGFnb24vZ2VucHRy
LmMgICAgfCA1NyArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKwogdGFyZ2V0
L2hleGFnb24vdHJhbnNsYXRlLmMgfCAzNCArKysrKysrKysrKysrKysrKysrKysrKwogNSBmaWxl
cyBjaGFuZ2VkLCAxMDcgaW5zZXJ0aW9ucygrKSwgNSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQg
YS90YXJnZXQvaGV4YWdvbi9jcHUuaCBiL3RhcmdldC9oZXhhZ29uL2NwdS5oCmluZGV4IGZmOGMy
NjI3MmQuLjUyNjBlMGYxMjcgMTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29uL2NwdS5oCisrKyBi
L3RhcmdldC9oZXhhZ29uL2NwdS5oCkBAIC0xNTIsMTYgKzE1MiwyMyBAQCBzdHJ1Y3QgQXJjaENQ
VSB7CiAKICNpbmNsdWRlICJjcHVfYml0cy5oIgogCit0eXBlZGVmIHVuaW9uIHsKKyAgICB1aW50
MzJfdCBpOworICAgIHN0cnVjdCB7CisgICAgICAgIGJvb2wgaXNfdGlnaHRfbG9vcDoxOworICAg
IH07Cit9IEhleFN0YXRlRmxhZ3M7CisKIHN0YXRpYyBpbmxpbmUgdm9pZCBjcHVfZ2V0X3RiX2Nw
dV9zdGF0ZShDUFVIZXhhZ29uU3RhdGUgKmVudiwgdGFyZ2V0X3Vsb25nICpwYywKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRfdWxvbmcgKmNzX2Jhc2UsIHVp
bnQzMl90ICpmbGFncykKIHsKKyAgICBIZXhTdGF0ZUZsYWdzIGhleF9mbGFncyA9IHsgMCB9Owog
ICAgICpwYyA9IGVudi0+Z3ByW0hFWF9SRUdfUENdOwogICAgICpjc19iYXNlID0gMDsKLSNpZmRl
ZiBDT05GSUdfVVNFUl9PTkxZCi0gICAgKmZsYWdzID0gMDsKLSNlbHNlCi0jZXJyb3IgU3lzdGVt
IG1vZGUgbm90IHN1cHBvcnRlZCBvbiBIZXhhZ29uIHlldAotI2VuZGlmCisgICAgaWYgKCpwYyA9
PSBlbnYtPmdwcltIRVhfUkVHX1NBMF0pIHsKKyAgICAgICAgaGV4X2ZsYWdzLmlzX3RpZ2h0X2xv
b3AgPSB0cnVlOworICAgIH0KKyAgICAqZmxhZ3MgPSBoZXhfZmxhZ3MuaTsKIH0KIAogc3RhdGlj
IGlubGluZSBpbnQgY3B1X21tdV9pbmRleChDUFVIZXhhZ29uU3RhdGUgKmVudiwgYm9vbCBpZmV0
Y2gpCmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi9nZW5fdGNnLmggYi90YXJnZXQvaGV4YWdv
bi9nZW5fdGNnLmgKaW5kZXggOTNhZmEwMTE1Ni4uMGYwYzAyNzUyMyAxMDA2NDQKLS0tIGEvdGFy
Z2V0L2hleGFnb24vZ2VuX3RjZy5oCisrKyBiL3RhcmdldC9oZXhhZ29uL2dlbl90Y2cuaApAQCAt
NjIwLDYgKzYyMCw5IEBACiAjZGVmaW5lIGZHRU5fVENHX0oyX2NhbGxmKFNIT1JUQ09ERSkgXAog
ICAgIGdlbl9jb25kX2NhbGwoY3R4LCBQdVYsIGZhbHNlLCByaVYpCiAKKyNkZWZpbmUgZkdFTl9U
Q0dfSjJfZW5kbG9vcDAoU0hPUlRDT0RFKSBcCisgICAgZ2VuX2VuZGxvb3AwKGN0eCkKKwogLyoK
ICAqIENvbXBvdW5kIGNvbXBhcmUgYW5kIGp1bXAgaW5zdHJ1Y3Rpb25zCiAgKiBIZXJlIGlzIGEg
cHJpbWVyIHRvIHVuZGVyc3RhbmQgdGhlIHRhZyBuYW1lcwpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hl
eGFnb24vdHJhbnNsYXRlLmggYi90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuaAppbmRleCAwODQx
ZTg0MThlLi43ZmMwNjZjMTlhIDEwMDY0NAotLS0gYS90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUu
aAorKysgYi90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuaApAQCAtNjAsNiArNjAsNyBAQCB0eXBl
ZGVmIHN0cnVjdCBEaXNhc0NvbnRleHQgewogICAgIGJvb2wgaGFzX3NpbmdsZV9kaXJlY3RfYnJh
bmNoOwogICAgIFRDR3YgYnJhbmNoX2NvbmQ7CiAgICAgdGFyZ2V0X3Vsb25nIGJyYW5jaF9kZXN0
OworICAgIGJvb2wgaXNfdGlnaHRfbG9vcDsKIH0gRGlzYXNDb250ZXh0OwogCiBzdGF0aWMgaW5s
aW5lIHZvaWQgY3R4X2xvZ19yZWdfd3JpdGUoRGlzYXNDb250ZXh0ICpjdHgsIGludCBybnVtKQpk
aWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vZ2VucHRyLmMgYi90YXJnZXQvaGV4YWdvbi9nZW5w
dHIuYwppbmRleCAyMzVlYTlkMjEwLi43NGI3YjNhYzVkIDEwMDY0NAotLS0gYS90YXJnZXQvaGV4
YWdvbi9nZW5wdHIuYworKysgYi90YXJnZXQvaGV4YWdvbi9nZW5wdHIuYwpAQCAtNjM1LDYgKzYz
NSw2MyBAQCBzdGF0aWMgdm9pZCBnZW5fY29uZF9jYWxsKERpc2FzQ29udGV4dCAqY3R4LCBUQ0d2
IHByZWQsIGJvb2wgc2Vuc2UsIGludCBwY19vZmYpCiAgICAgZ2VuX3NldF9sYWJlbChza2lwKTsK
IH0KIAorc3RhdGljIHZvaWQgZ2VuX2VuZGxvb3AwKERpc2FzQ29udGV4dCAqY3R4KQoreworICAg
IFRDR3YgbHBjZmcgPSB0Y2dfdGVtcF9sb2NhbF9uZXcoKTsKKworICAgIEdFVF9VU1JfRklFTEQo
VVNSX0xQQ0ZHLCBscGNmZyk7CisKKyAgICAvKgorICAgICAqICAgIGlmIChscGNmZyA9PSAxKSB7
CisgICAgICogICAgICAgIGhleF9uZXdfcHJlZF92YWx1ZVszXSA9IDB4ZmY7CisgICAgICogICAg
ICAgIGhleF9wcmVkX3dyaXR0ZW4gfD0gMSA8PCAzOworICAgICAqICAgIH0KKyAgICAgKi8KKyAg
ICBUQ0dMYWJlbCAqbGFiZWwxID0gZ2VuX25ld19sYWJlbCgpOworICAgIHRjZ19nZW5fYnJjb25k
aV90bChUQ0dfQ09ORF9ORSwgbHBjZmcsIDEsIGxhYmVsMSk7CisgICAgeworICAgICAgICB0Y2df
Z2VuX21vdmlfdGwoaGV4X25ld19wcmVkX3ZhbHVlWzNdLCAweGZmKTsKKyAgICAgICAgdGNnX2dl
bl9vcmlfdGwoaGV4X3ByZWRfd3JpdHRlbiwgaGV4X3ByZWRfd3JpdHRlbiwgMSA8PCAzKTsKKyAg
ICB9CisgICAgZ2VuX3NldF9sYWJlbChsYWJlbDEpOworCisgICAgLyoKKyAgICAgKiAgICBpZiAo
bHBjZmcpIHsKKyAgICAgKiAgICAgICAgU0VUX1VTUl9GSUVMRChVU1JfTFBDRkcsIGxwY2ZnIC0g
MSk7CisgICAgICogICAgfQorICAgICAqLworICAgIFRDR0xhYmVsICpsYWJlbDIgPSBnZW5fbmV3
X2xhYmVsKCk7CisgICAgdGNnX2dlbl9icmNvbmRpX3RsKFRDR19DT05EX0VRLCBscGNmZywgMCwg
bGFiZWwyKTsKKyAgICB7CisgICAgICAgIHRjZ19nZW5fc3ViaV90bChscGNmZywgbHBjZmcsIDEp
OworICAgICAgICBTRVRfVVNSX0ZJRUxEKFVTUl9MUENGRywgbHBjZmcpOworICAgIH0KKyAgICBn
ZW5fc2V0X2xhYmVsKGxhYmVsMik7CisKKyAgICAvKgorICAgICAqIElmIHdlJ3JlIGluIGEgdGln
aHQgbG9vcCwgd2UnbGwgZG8gdGhpcyBhdCB0aGUgZW5kIG9mIHRoZSBUQiB0byB0YWtlCisgICAg
ICogYWR2YW50YWdlIG9mIGRpcmVjdCBibG9jayBjaGFpbmluZy4KKyAgICAgKi8KKyAgICBpZiAo
IWN0eC0+aXNfdGlnaHRfbG9vcCkgeworICAgICAgICAvKgorICAgICAgICAgKiAgICBpZiAoaGV4
X2dwcltIRVhfUkVHX0xDMF0gPiAxKSB7CisgICAgICAgICAqICAgICAgICBQQyA9IGhleF9ncHJb
SEVYX1JFR19TQTBdOworICAgICAgICAgKiAgICAgICAgaGV4X25ld192YWx1ZVtIRVhfUkVHX0xD
MF0gPSBoZXhfZ3ByW0hFWF9SRUdfTEMwXSAtIDE7CisgICAgICAgICAqICAgIH0KKyAgICAgICAg
ICovCisgICAgICAgIFRDR0xhYmVsICpsYWJlbDMgPSBnZW5fbmV3X2xhYmVsKCk7CisgICAgICAg
IHRjZ19nZW5fYnJjb25kaV90bChUQ0dfQ09ORF9MRVUsIGhleF9ncHJbSEVYX1JFR19MQzBdLCAx
LCBsYWJlbDMpOworICAgICAgICB7CisgICAgICAgICAgICBnZW5fanVtcHIoY3R4LCBoZXhfZ3By
W0hFWF9SRUdfU0EwXSk7CisgICAgICAgICAgICB0Y2dfZ2VuX3N1YmlfdGwoaGV4X25ld192YWx1
ZVtIRVhfUkVHX0xDMF0sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGV4X2dwcltIRVhf
UkVHX0xDMF0sIDEpOworICAgICAgICB9CisgICAgICAgIGdlbl9zZXRfbGFiZWwobGFiZWwzKTsK
KyAgICB9CisKKyAgICB0Y2dfdGVtcF9mcmVlKGxwY2ZnKTsKK30KKwogc3RhdGljIHZvaWQgZ2Vu
X2NtcF9qdW1wbnYoRGlzYXNDb250ZXh0ICpjdHgsCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBUQ0dDb25kIGNvbmQsIFRDR3YgdmFsLCBUQ0d2IHNyYywgaW50IHBjX29mZikKIHsKZGlmZiAt
LWdpdCBhL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5jIGIvdGFyZ2V0L2hleGFnb24vdHJhbnNs
YXRlLmMKaW5kZXggOGMwMDdjNmYwNy4uNzMxZWM4NTcwNyAxMDA2NDQKLS0tIGEvdGFyZ2V0L2hl
eGFnb24vdHJhbnNsYXRlLmMKKysrIGIvdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmMKQEAgLTEz
NSw2ICsxMzUsOCBAQCBzdGF0aWMgdm9pZCBnZW5fZ290b190YihEaXNhc0NvbnRleHQgKmN0eCwg
aW50IGlkeCwgdGFyZ2V0X3Vsb25nIGRlc3QpCiAKIHN0YXRpYyB2b2lkIGdlbl9lbmRfdGIoRGlz
YXNDb250ZXh0ICpjdHgpCiB7CisgICAgUGFja2V0ICpwa3QgPSBjdHgtPnBrdDsKKwogICAgIGdl
bl9leGVjX2NvdW50ZXJzKGN0eCk7CiAKICAgICBpZiAoY3R4LT5oYXNfc2luZ2xlX2RpcmVjdF9i
cmFuY2gpIHsKQEAgLTE0OSw2ICsxNTEsMTggQEAgc3RhdGljIHZvaWQgZ2VuX2VuZF90YihEaXNh
c0NvbnRleHQgKmN0eCkKICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgIGdlbl9nb3RvX3Ri
KGN0eCwgMCwgY3R4LT5icmFuY2hfZGVzdCk7CiAgICAgICAgIH0KKyAgICB9IGVsc2UgaWYgKGN0
eC0+aXNfdGlnaHRfbG9vcCAmJgorICAgICAgICBwa3QtPmluc25bcGt0LT5udW1faW5zbnMgLSAx
XS5vcGNvZGUgPT0gSjJfZW5kbG9vcDApIHsKKyAgICAgICAgLyoKKyAgICAgICAgICogV2hlbiB3
ZSdyZSBpbiBhIHRpZ2h0IGxvb3AsIHdlIGRlZmVyIHRoZSBlbmRsb29wMCBwcm9jZXNzaW5nCisg
ICAgICAgICAqIHRvIHRha2UgYWR2YW50YWdlIG9mIGRpcmVjdCBibG9jayBjaGFpbmluZworICAg
ICAgICAgKi8KKyAgICAgICAgVENHTGFiZWwgKnNraXAgPSBnZW5fbmV3X2xhYmVsKCk7CisgICAg
ICAgIHRjZ19nZW5fYnJjb25kaV90bChUQ0dfQ09ORF9MRVUsIGhleF9ncHJbSEVYX1JFR19MQzBd
LCAxLCBza2lwKTsKKyAgICAgICAgdGNnX2dlbl9zdWJpX3RsKGhleF9ncHJbSEVYX1JFR19MQzBd
LCBoZXhfZ3ByW0hFWF9SRUdfTEMwXSwgMSk7CisgICAgICAgIGdlbl9nb3RvX3RiKGN0eCwgMCwg
Y3R4LT5iYXNlLnRiLT5wYyk7CisgICAgICAgIGdlbl9zZXRfbGFiZWwoc2tpcCk7CisgICAgICAg
IGdlbl9nb3RvX3RiKGN0eCwgMSwgY3R4LT5uZXh0X1BDKTsKICAgICB9IGVsc2UgewogICAgICAg
ICB0Y2dfZ2VuX2xvb2t1cF9hbmRfZ290b19wdHIoKTsKICAgICB9CkBAIC0zNDAsNiArMzU0LDE1
IEBAIHN0YXRpYyB2b2lkIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKERpc2FzQ29udGV4dCAqY3R4
LCBpbnQgYXR0cmliLCBpbnQgcm51bSkKICAgICAgICAgICovCiAgICAgICAgIGJvb2wgaXNfcHJl
ZGljYXRlZCA9IEdFVF9BVFRSSUIob3Bjb2RlLCBBX0NPTkRFWEVDKSB8fAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBybnVtID09IEhFWF9SRUdfVVNSOworCisgICAgICAgIC8qIExDMC9M
QzEgaXMgY29uZGl0aW9uYWxseSB3cml0dGVuIGJ5IGVuZGxvb3AgaW5zdHJ1Y3Rpb25zICovCisg
ICAgICAgIGlmICgocm51bSA9PSBIRVhfUkVHX0xDMCB8fCBybnVtID09IEhFWF9SRUdfTEMxKSAm
JgorICAgICAgICAgICAgKG9wY29kZSA9PSBKMl9lbmRsb29wMCB8fAorICAgICAgICAgICAgIG9w
Y29kZSA9PSBKMl9lbmRsb29wMSB8fAorICAgICAgICAgICAgIG9wY29kZSA9PSBKMl9lbmRsb29w
MDEpKSB7CisgICAgICAgICAgICBpc19wcmVkaWNhdGVkID0gdHJ1ZTsKKyAgICAgICAgfQorCiAg
ICAgICAgIGlmIChpc19wcmVkaWNhdGVkICYmICFpc19wcmVsb2FkZWQoY3R4LCBybnVtKSkgewog
ICAgICAgICAgICAgdGNnX2dlbl9tb3ZfdGwoaGV4X25ld192YWx1ZVtybnVtXSwgaGV4X2dwclty
bnVtXSk7CiAgICAgICAgIH0KQEAgLTQyMyw2ICs0NDYsMTQgQEAgc3RhdGljIHZvaWQgZ2VuX3Jl
Z193cml0ZXMoRGlzYXNDb250ZXh0ICpjdHgpCiAgICAgICAgIGludCByZWdfbnVtID0gY3R4LT5y
ZWdfbG9nW2ldOwogCiAgICAgICAgIHRjZ19nZW5fbW92X3RsKGhleF9ncHJbcmVnX251bV0sIGhl
eF9uZXdfdmFsdWVbcmVnX251bV0pOworCisgICAgICAgIC8qCisgICAgICAgICAqIGN0eC0+aXNf
dGlnaHRfbG9vcCBpcyBzZXQgd2hlbiBTQTAgcG9pbnRzIHRvIHRoZSBiZWdpbm5pbmcgb2YgdGhl
IFRCLgorICAgICAgICAgKiBJZiB3ZSB3cml0ZSB0byBTQTAsIHdlIGhhdmUgdG8gdHVybiBvZmYg
dGlnaHQgbG9vcCBoYW5kbGluZy4KKyAgICAgICAgICovCisgICAgICAgIGlmIChyZWdfbnVtID09
IEhFWF9SRUdfU0EwKSB7CisgICAgICAgICAgICBjdHgtPmlzX3RpZ2h0X2xvb3AgPSBmYWxzZTsK
KyAgICAgICAgfQogICAgIH0KIH0KIApAQCAtODQ2LDggKzg3NywxMSBAQCBzdGF0aWMgdm9pZCBo
ZXhhZ29uX3RyX2luaXRfZGlzYXNfY29udGV4dChEaXNhc0NvbnRleHRCYXNlICpkY2Jhc2UsCiBz
dGF0aWMgdm9pZCBoZXhhZ29uX3RyX3RiX3N0YXJ0KERpc2FzQ29udGV4dEJhc2UgKmRiLCBDUFVT
dGF0ZSAqY3B1KQogewogICAgIERpc2FzQ29udGV4dCAqY3R4ID0gY29udGFpbmVyX29mKGRiLCBE
aXNhc0NvbnRleHQsIGJhc2UpOworICAgIEhleFN0YXRlRmxhZ3MgaGV4X2ZsYWdzID0geyBkYi0+
dGItPmZsYWdzIH07CisKICAgICBjdHgtPmhhc19zaW5nbGVfZGlyZWN0X2JyYW5jaCA9IGZhbHNl
OwogICAgIGN0eC0+YnJhbmNoX2NvbmQgPSBOVUxMOworICAgIGN0eC0+aXNfdGlnaHRfbG9vcCA9
IGhleF9mbGFncy5pc190aWdodF9sb29wOwogfQogCiBzdGF0aWMgdm9pZCBoZXhhZ29uX3RyX2lu
c25fc3RhcnQoRGlzYXNDb250ZXh0QmFzZSAqZGNiYXNlLCBDUFVTdGF0ZSAqY3B1KQotLSAKMi4x
Ny4xCgo=

