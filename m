Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id E98CB2FC9A0
	for <lists+qemu-devel@lfdr.de>; Wed, 20 Jan 2021 04:56:10 +0100 (CET)
Received: from localhost ([::1]:50716 helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>)
	id 1l24bK-0002RX-1d
	for lists+qemu-devel@lfdr.de; Tue, 19 Jan 2021 22:56:10 -0500
Received: from eggs.gnu.org ([2001:470:142:3::10]:47826)
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1l24Cd-0008BU-Uj
 for qemu-devel@nongnu.org; Tue, 19 Jan 2021 22:30:40 -0500
Received: from alexa-out-sd-01.qualcomm.com ([199.106.114.38]:5511)
 by eggs.gnu.org with esmtps (TLS1.2:RSA_AES_256_CBC_SHA1:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1l24Ca-0007VU-TM
 for qemu-devel@nongnu.org; Tue, 19 Jan 2021 22:30:39 -0500
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
 d=quicinc.com; i=@quicinc.com; q=dns/txt; s=qcdkim;
 t=1611113436; x=1642649436;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version:content-transfer-encoding;
 bh=VDYDyDwXUwcfEi67Fx61cCqTkBX2OeOibBWlV76q490=;
 b=QRXH/8cRjq+DS3mT9zRRfZ+YtihChk+R7JV16sP3sLUa4BYpm/8GMs1V
 Pv5jITA82e3dfrB6GlRZD0A/t06ZyzSmnoQZyvW0iudkmWsKbYMePLi9n
 nUgTc7C58YrumWw0ZHEhLvKC8DMiTG+WYrdTDXfmiJgmPoGTdY+nOEsRq Y=;
Received: from unknown (HELO ironmsg03-sd.qualcomm.com) ([10.53.140.143])
 by alexa-out-sd-01.qualcomm.com with ESMTP; 19 Jan 2021 19:29:28 -0800
X-QCInternal: smtphost
Received: from vu-tsimpson-aus.qualcomm.com (HELO
 vu-tsimpson1-aus.qualcomm.com) ([10.222.150.1])
 by ironmsg03-sd.qualcomm.com with ESMTP; 19 Jan 2021 19:29:27 -0800
Received: by vu-tsimpson1-aus.qualcomm.com (Postfix, from userid 47164)
 id 83C38295E; Tue, 19 Jan 2021 21:29:27 -0600 (CST)
From: Taylor Simpson <tsimpson@quicinc.com>
To: qemu-devel@nongnu.org
Subject: [PATCH v7 29/35] Hexagon (target/hexagon) translation
Date: Tue, 19 Jan 2021 21:29:02 -0600
Message-Id: <1611113349-24906-30-git-send-email-tsimpson@quicinc.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1611113349-24906-1-git-send-email-tsimpson@quicinc.com>
References: <1611113349-24906-1-git-send-email-tsimpson@quicinc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Received-SPF: pass client-ip=199.106.114.38;
 envelope-from=tsimpson@qualcomm.com; helo=alexa-out-sd-01.qualcomm.com
X-Spam_score_int: -40
X-Spam_score: -4.1
X-Spam_bar: ----
X-Spam_report: (-4.1 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, HEADER_FROM_DIFFERENT_DOMAINS=0.248,
 RCVD_IN_DNSWL_MED=-2.3, SPF_HELO_NONE=0.001,
 SPF_PASS=-0.001 autolearn=ham autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Cc: ale@rev.ng, bcain@quicinc.com, philmd@redhat.com,
 richard.henderson@linaro.org, laurent@vivier.eu, tsimpson@quicinc.com,
 alex.bennee@linaro.org
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: "Qemu-devel" <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>

UmVhZCB0aGUgaW5zdHJ1Y3Rpb24gbWVtb3J5CkNyZWF0ZSBhIHBhY2tldCBkYXRhIHN0cnVjdHVy
ZQpHZW5lcmF0ZSBUQ0cgY29kZSBmb3IgdGhlIHN0YXJ0IG9mIHRoZSBwYWNrZXQKSW52b2tlIHRo
ZSBnZW5lcmF0ZSBmdW5jdGlvbiBmb3IgZWFjaCBpbnN0cnVjdGlvbgpHZW5lcmF0ZSBUQ0cgY29k
ZSBmb3IgdGhlIGVuZCBvZiB0aGUgcGFja2V0CgpTaWduZWQtb2ZmLWJ5OiBUYXlsb3IgU2ltcHNv
biA8dHNpbXBzb25AcXVpY2luYy5jb20+Ci0tLQogdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmgg
fCAgOTEgKysrKysrCiB0YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuYyB8IDY5MyArKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysKIDIgZmlsZXMgY2hhbmdlZCwgNzg0
IGluc2VydGlvbnMoKykKIGNyZWF0ZSBtb2RlIDEwMDY0NCB0YXJnZXQvaGV4YWdvbi90cmFuc2xh
dGUuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IHRhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5jCgpkaWZm
IC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmggYi90YXJnZXQvaGV4YWdvbi90cmFu
c2xhdGUuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi41MDQ0OTBlCi0tLSAv
ZGV2L251bGwKKysrIGIvdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmgKQEAgLTAsMCArMSw5MSBA
QAorLyoKKyAqICBDb3B5cmlnaHQoYykgMjAxOS0yMDIxIFF1YWxjb21tIElubm92YXRpb24gQ2Vu
dGVyLCBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCisgKgorICogIFRoaXMgcHJvZ3JhbSBpcyBm
cmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CisgKiAg
aXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBw
dWJsaXNoZWQgYnkKKyAqICB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVy
c2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvcgorICogIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVy
IHZlcnNpb24uCisgKgorICogIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9w
ZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICogIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsg
d2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgKiAgTUVSQ0hBTlRBQklMSVRZ
IG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQorICogIEdOVSBH
ZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisgKgorICogIFlvdSBzaG91
bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
CisgKiAgYWxvbmcgd2l0aCB0aGlzIHByb2dyYW07IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3Lmdu
dS5vcmcvbGljZW5zZXMvPi4KKyAqLworCisjaWZuZGVmIEhFWEFHT05fVFJBTlNMQVRFX0gKKyNk
ZWZpbmUgSEVYQUdPTl9UUkFOU0xBVEVfSAorCisjaW5jbHVkZSAicWVtdS9iaXRtYXAuaCIKKyNp
bmNsdWRlICJjcHUuaCIKKyNpbmNsdWRlICJleGVjL3RyYW5zbGF0b3IuaCIKKyNpbmNsdWRlICJ0
Y2cvdGNnLW9wLmgiCisjaW5jbHVkZSAiaW50ZXJuYWwuaCIKKwordHlwZWRlZiBzdHJ1Y3QgRGlz
YXNDb250ZXh0IHsKKyAgICBEaXNhc0NvbnRleHRCYXNlIGJhc2U7CisgICAgdWludDMyX3QgbWVt
X2lkeDsKKyAgICBpbnQgcmVnX2xvZ1tSRUdfV1JJVEVTX01BWF07CisgICAgaW50IHJlZ19sb2df
aWR4OworICAgIERFQ0xBUkVfQklUTUFQKHJlZ3Nfd3JpdHRlbiwgVE9UQUxfUEVSX1RIUkVBRF9S
RUdTKTsKKyAgICBpbnQgcHJlZ19sb2dbUFJFRF9XUklURVNfTUFYXTsKKyAgICBpbnQgcHJlZ19s
b2dfaWR4OworICAgIHVpbnQ4X3Qgc3RvcmVfd2lkdGhbU1RPUkVTX01BWF07CisgICAgdWludDhf
dCBzMV9zdG9yZV9wcm9jZXNzZWQ7Cit9IERpc2FzQ29udGV4dDsKKworc3RhdGljIGlubGluZSB2
b2lkIGN0eF9sb2dfcmVnX3dyaXRlKERpc2FzQ29udGV4dCAqY3R4LCBpbnQgcm51bSkKK3sKKyNp
ZiBIRVhfREVCVUcKKyAgICBpZiAodGVzdF9iaXQocm51bSwgY3R4LT5yZWdzX3dyaXR0ZW4pKSB7
CisgICAgICAgIEhFWF9ERUJVR19MT0coIldBUk5JTkc6IE11bHRpcGxlIHdyaXRlcyB0byByJWRc
biIsIHJudW0pOworICAgIH0KKyNlbmRpZgorICAgIGN0eC0+cmVnX2xvZ1tjdHgtPnJlZ19sb2df
aWR4XSA9IHJudW07CisgICAgY3R4LT5yZWdfbG9nX2lkeCsrOworICAgIHNldF9iaXQocm51bSwg
Y3R4LT5yZWdzX3dyaXR0ZW4pOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQgY3R4X2xvZ19yZWdf
d3JpdGVfcGFpcihEaXNhc0NvbnRleHQgKmN0eCwgaW50IHJudW0pCit7CisgICAgY3R4X2xvZ19y
ZWdfd3JpdGUoY3R4LCBybnVtKTsKKyAgICBjdHhfbG9nX3JlZ193cml0ZShjdHgsIHJudW0gKyAx
KTsKK30KKworc3RhdGljIGlubGluZSB2b2lkIGN0eF9sb2dfcHJlZF93cml0ZShEaXNhc0NvbnRl
eHQgKmN0eCwgaW50IHBudW0pCit7CisgICAgY3R4LT5wcmVnX2xvZ1tjdHgtPnByZWdfbG9nX2lk
eF0gPSBwbnVtOworICAgIGN0eC0+cHJlZ19sb2dfaWR4Kys7Cit9CisKK3N0YXRpYyBpbmxpbmUg
Ym9vbCBpc19wcmVsb2FkZWQoRGlzYXNDb250ZXh0ICpjdHgsIGludCBudW0pCit7CisgICAgcmV0
dXJuIHRlc3RfYml0KG51bSwgY3R4LT5yZWdzX3dyaXR0ZW4pOworfQorCitleHRlcm4gVENHdiBo
ZXhfZ3ByW1RPVEFMX1BFUl9USFJFQURfUkVHU107CitleHRlcm4gVENHdiBoZXhfcHJlZFtOVU1f
UFJFR1NdOworZXh0ZXJuIFRDR3YgaGV4X25leHRfUEM7CitleHRlcm4gVENHdiBoZXhfdGhpc19Q
QzsKK2V4dGVybiBUQ0d2IGhleF9zbG90X2NhbmNlbGxlZDsKK2V4dGVybiBUQ0d2IGhleF9icmFu
Y2hfdGFrZW47CitleHRlcm4gVENHdiBoZXhfbmV3X3ZhbHVlW1RPVEFMX1BFUl9USFJFQURfUkVH
U107CitleHRlcm4gVENHdiBoZXhfcmVnX3dyaXR0ZW5bVE9UQUxfUEVSX1RIUkVBRF9SRUdTXTsK
K2V4dGVybiBUQ0d2IGhleF9uZXdfcHJlZF92YWx1ZVtOVU1fUFJFR1NdOworZXh0ZXJuIFRDR3Yg
aGV4X3ByZWRfd3JpdHRlbjsKK2V4dGVybiBUQ0d2IGhleF9zdG9yZV9hZGRyW1NUT1JFU19NQVhd
OworZXh0ZXJuIFRDR3YgaGV4X3N0b3JlX3dpZHRoW1NUT1JFU19NQVhdOworZXh0ZXJuIFRDR3Yg
aGV4X3N0b3JlX3ZhbDMyW1NUT1JFU19NQVhdOworZXh0ZXJuIFRDR3ZfaTY0IGhleF9zdG9yZV92
YWw2NFtTVE9SRVNfTUFYXTsKK2V4dGVybiBUQ0d2IGhleF9kY3plcm9fYWRkcjsKK2V4dGVybiBU
Q0d2IGhleF9sbHNjX2FkZHI7CitleHRlcm4gVENHdiBoZXhfbGxzY192YWw7CitleHRlcm4gVENH
dl9pNjQgaGV4X2xsc2NfdmFsX2k2NDsKKworZXh0ZXJuIHZvaWQgZ2VuX2V4Y2VwdGlvbihpbnQg
ZXhjcCk7CitleHRlcm4gdm9pZCBnZW5fZXhjZXB0aW9uX2RlYnVnKHZvaWQpOworCitleHRlcm4g
dm9pZCBwcm9jZXNzX3N0b3JlKERpc2FzQ29udGV4dCAqY3R4LCBpbnQgc2xvdF9udW0pOworI2Vu
ZGlmCmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuYyBiL3RhcmdldC9oZXhh
Z29uL3RyYW5zbGF0ZS5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLmI2N2Y5
YzgKLS0tIC9kZXYvbnVsbAorKysgYi90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuYwpAQCAtMCww
ICsxLDY5MyBAQAorLyoKKyAqICBDb3B5cmlnaHQoYykgMjAxOS0yMDIxIFF1YWxjb21tIElubm92
YXRpb24gQ2VudGVyLCBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCisgKgorICogIFRoaXMgcHJv
Z3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9k
aWZ5CisgKiAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGlj
ZW5zZSBhcyBwdWJsaXNoZWQgYnkKKyAqICB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBl
aXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvcgorICogIChhdCB5b3VyIG9wdGlvbikg
YW55IGxhdGVyIHZlcnNpb24uCisgKgorICogIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBp
biB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICogIGJ1dCBXSVRIT1VUIEFOWSBX
QVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgKiAgTUVSQ0hB
TlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQor
ICogIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisgKgorICog
IFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1Ymxp
YyBMaWNlbnNlCisgKiAgYWxvbmcgd2l0aCB0aGlzIHByb2dyYW07IGlmIG5vdCwgc2VlIDxodHRw
Oi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KKyAqLworCisjZGVmaW5lIFFFTVVfR0VORVJBVEUK
KyNpbmNsdWRlICJxZW11L29zZGVwLmgiCisjaW5jbHVkZSAiY3B1LmgiCisjaW5jbHVkZSAidGNn
L3RjZy1vcC5oIgorI2luY2x1ZGUgImV4ZWMvY3B1X2xkc3QuaCIKKyNpbmNsdWRlICJleGVjL2xv
Zy5oIgorI2luY2x1ZGUgImludGVybmFsLmgiCisjaW5jbHVkZSAiYXR0cmlicy5oIgorI2luY2x1
ZGUgImluc24uaCIKKyNpbmNsdWRlICJkZWNvZGUuaCIKKyNpbmNsdWRlICJ0cmFuc2xhdGUuaCIK
KyNpbmNsdWRlICJwcmludGluc24uaCIKKworVENHdiBoZXhfZ3ByW1RPVEFMX1BFUl9USFJFQURf
UkVHU107CitUQ0d2IGhleF9wcmVkW05VTV9QUkVHU107CitUQ0d2IGhleF9uZXh0X1BDOworVENH
diBoZXhfdGhpc19QQzsKK1RDR3YgaGV4X3Nsb3RfY2FuY2VsbGVkOworVENHdiBoZXhfYnJhbmNo
X3Rha2VuOworVENHdiBoZXhfbmV3X3ZhbHVlW1RPVEFMX1BFUl9USFJFQURfUkVHU107CisjaWYg
SEVYX0RFQlVHCitUQ0d2IGhleF9yZWdfd3JpdHRlbltUT1RBTF9QRVJfVEhSRUFEX1JFR1NdOwor
I2VuZGlmCitUQ0d2IGhleF9uZXdfcHJlZF92YWx1ZVtOVU1fUFJFR1NdOworVENHdiBoZXhfcHJl
ZF93cml0dGVuOworVENHdiBoZXhfc3RvcmVfYWRkcltTVE9SRVNfTUFYXTsKK1RDR3YgaGV4X3N0
b3JlX3dpZHRoW1NUT1JFU19NQVhdOworVENHdiBoZXhfc3RvcmVfdmFsMzJbU1RPUkVTX01BWF07
CitUQ0d2X2k2NCBoZXhfc3RvcmVfdmFsNjRbU1RPUkVTX01BWF07CitUQ0d2IGhleF9wa3RfaGFz
X3N0b3JlX3MxOworVENHdiBoZXhfZGN6ZXJvX2FkZHI7CitUQ0d2IGhleF9sbHNjX2FkZHI7CitU
Q0d2IGhleF9sbHNjX3ZhbDsKK1RDR3ZfaTY0IGhleF9sbHNjX3ZhbF9pNjQ7CisKK3N0YXRpYyBj
b25zdCBjaGFyICogY29uc3QgaGV4YWdvbl9wcmVkbmFtZXNbXSA9IHsKKyAgInAwIiwgInAxIiwg
InAyIiwgInAzIgorfTsKKwordm9pZCBnZW5fZXhjZXB0aW9uKGludCBleGNwKQoreworICAgIFRD
R3ZfaTMyIGhlbHBlcl90bXAgPSB0Y2dfY29uc3RfaTMyKGV4Y3ApOworICAgIGdlbl9oZWxwZXJf
cmFpc2VfZXhjZXB0aW9uKGNwdV9lbnYsIGhlbHBlcl90bXApOworICAgIHRjZ190ZW1wX2ZyZWVf
aTMyKGhlbHBlcl90bXApOworfQorCit2b2lkIGdlbl9leGNlcHRpb25fZGVidWcodm9pZCkKK3sK
KyAgICBnZW5fZXhjZXB0aW9uKEVYQ1BfREVCVUcpOworfQorCisjaWYgSEVYX0RFQlVHCisjZGVm
aW5lIFBBQ0tFVF9CVUZGRVJfTEVOICAgICAgICAgICAgICAxMDI4CitzdGF0aWMgdm9pZCBwcmlu
dF9wa3QoUGFja2V0ICpwa3QpCit7CisgICAgR1N0cmluZyAqYnVmID0gZ19zdHJpbmdfc2l6ZWRf
bmV3KFBBQ0tFVF9CVUZGRVJfTEVOKTsKKyAgICBzbnByaW50X2FfcGt0X2RlYnVnKGJ1ZiwgcGt0
KTsKKyAgICBIRVhfREVCVUdfTE9HKCIlcyIsIGJ1Zi0+c3RyKTsKKyAgICBnX3N0cmluZ19mcmVl
KGJ1ZiwgdHJ1ZSk7Cit9CisjZGVmaW5lIEhFWF9ERUJVR19QUklOVF9QS1QocGt0KSAgcHJpbnRf
cGt0KHBrdCkKKyNlbHNlCisjZGVmaW5lIEhFWF9ERUJVR19QUklOVF9QS1QocGt0KSAgLyogbm90
aGluZyAqLworI2VuZGlmCisKK3N0YXRpYyBpbnQgcmVhZF9wYWNrZXRfd29yZHMoQ1BVSGV4YWdv
blN0YXRlICplbnYsIERpc2FzQ29udGV4dCAqY3R4LAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB1aW50MzJfdCB3b3Jkc1tdKQoreworICAgIGJvb2wgZm91bmRfZW5kID0gZmFsc2U7Cisg
ICAgaW50IG53b3JkcywgbWF4X3dvcmRzOworCisgICAgbWVtc2V0KHdvcmRzLCAwLCBQQUNLRVRf
V09SRFNfTUFYICogc2l6ZW9mKHVpbnQzMl90KSk7CisgICAgZm9yIChud29yZHMgPSAwOyAhZm91
bmRfZW5kICYmIG53b3JkcyA8IFBBQ0tFVF9XT1JEU19NQVg7IG53b3JkcysrKSB7CisgICAgICAg
IHdvcmRzW253b3Jkc10gPSBjcHVfbGRsX2NvZGUoZW52LAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBjdHgtPmJhc2UucGNfbmV4dCArIG53b3JkcyAqIHNpemVvZih1aW50MzJfdCkp
OworICAgICAgICBmb3VuZF9lbmQgPSBpc19wYWNrZXRfZW5kKHdvcmRzW253b3Jkc10pOworICAg
IH0KKyAgICBpZiAoIWZvdW5kX2VuZCkgeworICAgICAgICAvKiBSZWFkIHRvbyBtYW55IHdvcmRz
IHdpdGhvdXQgZmluZGluZyB0aGUgZW5kICovCisgICAgICAgIHJldHVybiAwOworICAgIH0KKwor
ICAgIC8qIENoZWNrIGZvciBwYWdlIGJvdW5kYXJ5IGNyb3NzaW5nICovCisgICAgbWF4X3dvcmRz
ID0gLShjdHgtPmJhc2UucGNfbmV4dCB8IFRBUkdFVF9QQUdFX01BU0spIC8gc2l6ZW9mKHVpbnQz
Ml90KTsKKyAgICBpZiAobndvcmRzID4gbWF4X3dvcmRzKSB7CisgICAgICAgIC8qIFdlIGNhbiBv
bmx5IGNyb3NzIGEgcGFnZSBib3VuZGFyeSBhdCB0aGUgYmVnaW5uaW5nIG9mIGEgVEIgKi8KKyAg
ICAgICAgZ19hc3NlcnQoY3R4LT5iYXNlLm51bV9pbnNucyA9PSAxKTsKKyAgICB9CisKKyAgICBI
RVhfREVCVUdfTE9HKCJkZWNvZGVfcGFja2V0OiBwYyA9IDB4JXhcbiIsIGN0eC0+YmFzZS5wY19u
ZXh0KTsKKyAgICBIRVhfREVCVUdfTE9HKCIgICAgd29yZHMgPSB7ICIpOworICAgIGZvciAoaW50
IGkgPSAwOyBpIDwgbndvcmRzOyBpKyspIHsKKyAgICAgICAgSEVYX0RFQlVHX0xPRygiMHgleCwg
Iiwgd29yZHNbaV0pOworICAgIH0KKyAgICBIRVhfREVCVUdfTE9HKCJ9XG4iKTsKKworICAgIHJl
dHVybiBud29yZHM7Cit9CisKK3N0YXRpYyB2b2lkIGdlbl9zdGFydF9wYWNrZXQoRGlzYXNDb250
ZXh0ICpjdHgsIFBhY2tldCAqcGt0KQoreworICAgIHRhcmdldF91bG9uZyBuZXh0X1BDID0gY3R4
LT5iYXNlLnBjX25leHQgKyBwa3QtPmVuY29kX3BrdF9zaXplX2luX2J5dGVzOworICAgIGludCBp
OworCisgICAgLyogQ2xlYXIgb3V0IHRoZSBkaXNhc3NlbWJseSBjb250ZXh0ICovCisgICAgY3R4
LT5yZWdfbG9nX2lkeCA9IDA7CisgICAgYml0bWFwX3plcm8oY3R4LT5yZWdzX3dyaXR0ZW4sIFRP
VEFMX1BFUl9USFJFQURfUkVHUyk7CisgICAgY3R4LT5wcmVnX2xvZ19pZHggPSAwOworICAgIGZv
ciAoaSA9IDA7IGkgPCBTVE9SRVNfTUFYOyBpKyspIHsKKyAgICAgICAgY3R4LT5zdG9yZV93aWR0
aFtpXSA9IDA7CisgICAgfQorICAgIHRjZ19nZW5fbW92aV90bChoZXhfcGt0X2hhc19zdG9yZV9z
MSwgcGt0LT5wa3RfaGFzX3N0b3JlX3MxKTsKKyAgICBjdHgtPnMxX3N0b3JlX3Byb2Nlc3NlZCA9
IDA7CisKKyNpZiBIRVhfREVCVUcKKyAgICAvKiBIYW5keSBwbGFjZSB0byBzZXQgYSBicmVha3Bv
aW50IGJlZm9yZSB0aGUgcGFja2V0IGV4ZWN1dGVzICovCisgICAgZ2VuX2hlbHBlcl9kZWJ1Z19z
dGFydF9wYWNrZXQoY3B1X2Vudik7CisgICAgdGNnX2dlbl9tb3ZpX3RsKGhleF90aGlzX1BDLCBj
dHgtPmJhc2UucGNfbmV4dCk7CisjZW5kaWYKKworICAgIC8qIEluaXRpYWxpemUgdGhlIHJ1bnRp
bWUgc3RhdGUgZm9yIHBhY2tldCBzZW1hbnRpY3MgKi8KKyAgICB0Y2dfZ2VuX21vdmlfdGwoaGV4
X2dwcltIRVhfUkVHX1BDXSwgY3R4LT5iYXNlLnBjX25leHQpOworICAgIHRjZ19nZW5fbW92aV90
bChoZXhfc2xvdF9jYW5jZWxsZWQsIDApOworICAgIGlmIChwa3QtPnBrdF9oYXNfY29mKSB7Cisg
ICAgICAgIHRjZ19nZW5fbW92aV90bChoZXhfYnJhbmNoX3Rha2VuLCAwKTsKKyAgICAgICAgdGNn
X2dlbl9tb3ZpX3RsKGhleF9uZXh0X1BDLCBuZXh0X1BDKTsKKyAgICB9CisgICAgdGNnX2dlbl9t
b3ZpX3RsKGhleF9wcmVkX3dyaXR0ZW4sIDApOworfQorCisvKgorICogVGhlIExPR18qX1dSSVRF
IG1hY3JvcyBtYXJrIG1vc3Qgb2YgdGhlIHdyaXRlcyBpbiBhIHBhY2tldAorICogSG93ZXZlciwg
dGhlcmUgYXJlIHNvbWUgaW1wbGljaXQgd3JpdGVzIG1hcmtlZCBhcyBhdHRyaWJ1dGVzCisgKiBv
ZiB0aGUgYXBwbGljYWJsZSBpbnN0cnVjdGlvbnMuCisgKi8KK3N0YXRpYyB2b2lkIG1hcmtfaW1w
bGljaXRfcmVnX3dyaXRlKERpc2FzQ29udGV4dCAqY3R4LCBJbnNuICppbnNuLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGF0dHJpYiwgaW50IHJudW0pCit7CisgICAg
aWYgKEdFVF9BVFRSSUIoaW5zbi0+b3Bjb2RlLCBhdHRyaWIpKSB7CisgICAgICAgIGludCBpc19w
cmVkaWNhdGVkID0gR0VUX0FUVFJJQihpbnNuLT5vcGNvZGUsIEFfQ09OREVYRUMpOworICAgICAg
ICBpZiAoaXNfcHJlZGljYXRlZCAmJiAhaXNfcHJlbG9hZGVkKGN0eCwgcm51bSkpIHsKKyAgICAg
ICAgICAgIHRjZ19nZW5fbW92X3RsKGhleF9uZXdfdmFsdWVbcm51bV0sIGhleF9ncHJbcm51bV0p
OworICAgICAgICB9CisKKyAgICAgICAgY3R4X2xvZ19yZWdfd3JpdGUoY3R4LCBybnVtKTsKKyAg
ICB9Cit9CisKK3N0YXRpYyB2b2lkIG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZShEaXNhc0NvbnRl
eHQgKmN0eCwgSW5zbiAqaW5zbiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBpbnQgYXR0cmliLCBpbnQgcG51bSkKK3sKKyAgICBpZiAoR0VUX0FUVFJJQihpbnNuLT5vcGNv
ZGUsIGF0dHJpYikpIHsKKyAgICAgICAgY3R4X2xvZ19wcmVkX3dyaXRlKGN0eCwgcG51bSk7Cisg
ICAgfQorfQorCitzdGF0aWMgdm9pZCBtYXJrX2ltcGxpY2l0X3dyaXRlcyhEaXNhc0NvbnRleHQg
KmN0eCwgSW5zbiAqaW5zbikKK3sKKyAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIGlu
c24sIEFfSU1QTElDSVRfV1JJVEVTX0ZQLCAgSEVYX1JFR19GUCk7CisgICAgbWFya19pbXBsaWNp
dF9yZWdfd3JpdGUoY3R4LCBpbnNuLCBBX0lNUExJQ0lUX1dSSVRFU19TUCwgIEhFWF9SRUdfU1Ap
OworICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgaW5zbiwgQV9JTVBMSUNJVF9XUklU
RVNfTFIsICBIRVhfUkVHX0xSKTsKKyAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIGlu
c24sIEFfSU1QTElDSVRfV1JJVEVTX0xDMCwgSEVYX1JFR19MQzApOworICAgIG1hcmtfaW1wbGlj
aXRfcmVnX3dyaXRlKGN0eCwgaW5zbiwgQV9JTVBMSUNJVF9XUklURVNfU0EwLCBIRVhfUkVHX1NB
MCk7CisgICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBpbnNuLCBBX0lNUExJQ0lUX1dS
SVRFU19MQzEsIEhFWF9SRUdfTEMxKTsKKyAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgs
IGluc24sIEFfSU1QTElDSVRfV1JJVEVTX1NBMSwgSEVYX1JFR19TQTEpOworCisgICAgbWFya19p
bXBsaWNpdF9wcmVkX3dyaXRlKGN0eCwgaW5zbiwgQV9JTVBMSUNJVF9XUklURVNfUDAsIDApOwor
ICAgIG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZShjdHgsIGluc24sIEFfSU1QTElDSVRfV1JJVEVT
X1AxLCAxKTsKKyAgICBtYXJrX2ltcGxpY2l0X3ByZWRfd3JpdGUoY3R4LCBpbnNuLCBBX0lNUExJ
Q0lUX1dSSVRFU19QMiwgMik7CisgICAgbWFya19pbXBsaWNpdF9wcmVkX3dyaXRlKGN0eCwgaW5z
biwgQV9JTVBMSUNJVF9XUklURVNfUDMsIDMpOworfQorCitzdGF0aWMgdm9pZCBnZW5faW5zbihD
UFVIZXhhZ29uU3RhdGUgKmVudiwgRGlzYXNDb250ZXh0ICpjdHgsCisgICAgICAgICAgICAgICAg
ICAgICBJbnNuICppbnNuLCBQYWNrZXQgKnBrdCkKK3sKKyAgICBpZiAoaW5zbi0+Z2VuZXJhdGUp
IHsKKyAgICAgICAgbWFya19pbXBsaWNpdF93cml0ZXMoY3R4LCBpbnNuKTsKKyAgICAgICAgaW5z
bi0+Z2VuZXJhdGUoZW52LCBjdHgsIGluc24sIHBrdCk7CisgICAgfSBlbHNlIHsKKyAgICAgICAg
Z2VuX2V4Y2VwdGlvbihIRVhfRVhDUF9JTlZBTElEX09QQ09ERSk7CisgICAgICAgIGN0eC0+YmFz
ZS5pc19qbXAgPSBESVNBU19OT1JFVFVSTjsKKyAgICB9Cit9CisKKy8qCisgKiBIZWxwZXJzIGZv
ciBnZW5lcmF0aW5nIHRoZSBwYWNrZXQgY29tbWl0CisgKi8KK3N0YXRpYyB2b2lkIGdlbl9yZWdf
d3JpdGVzKERpc2FzQ29udGV4dCAqY3R4KQoreworICAgIGludCBpOworCisgICAgZm9yIChpID0g
MDsgaSA8IGN0eC0+cmVnX2xvZ19pZHg7IGkrKykgeworICAgICAgICBpbnQgcmVnX251bSA9IGN0
eC0+cmVnX2xvZ1tpXTsKKworICAgICAgICB0Y2dfZ2VuX21vdl90bChoZXhfZ3ByW3JlZ19udW1d
LCBoZXhfbmV3X3ZhbHVlW3JlZ19udW1dKTsKKyAgICB9Cit9CisKK3N0YXRpYyB2b2lkIGdlbl9w
cmVkX3dyaXRlcyhEaXNhc0NvbnRleHQgKmN0eCwgUGFja2V0ICpwa3QpCit7CisgICAgVENHdiB6
ZXJvLCBjb250cm9sX3JlZywgcHZhbDsKKyAgICBpbnQgaTsKKworICAgIC8qIEVhcmx5IGV4aXQg
aWYgdGhlIGxvZyBpcyBlbXB0eSAqLworICAgIGlmICghY3R4LT5wcmVnX2xvZ19pZHgpIHsKKyAg
ICAgICAgcmV0dXJuOworICAgIH0KKworICAgIHplcm8gPSB0Y2dfY29uc3RfdGwoMCk7CisgICAg
Y29udHJvbF9yZWcgPSB0Y2dfdGVtcF9uZXcoKTsKKyAgICBwdmFsID0gdGNnX3RlbXBfbmV3KCk7
CisKKyAgICAvKgorICAgICAqIE9ubHkgZW5kbG9vcCBpbnN0cnVjdGlvbnMgd2lsbCBjb25kaXRp
b25hbGx5CisgICAgICogd3JpdGUgYSBwcmVkaWNhdGUuICBJZiB0aGVyZSBhcmUgbm8gZW5kbG9v
cAorICAgICAqIGluc3RydWN0aW9ucywgd2UgY2FuIHVzZSB0aGUgbm9uLWNvbmRpdGlvbmFsCisg
ICAgICogd3JpdGUgb2YgdGhlIHByZWRpY2F0ZXMuCisgICAgICovCisgICAgaWYgKHBrdC0+cGt0
X2hhc19lbmRsb29wKSB7CisgICAgICAgIFRDR3YgcHJlZF93cml0dGVuID0gdGNnX3RlbXBfbmV3
KCk7CisgICAgICAgIGZvciAoaSA9IDA7IGkgPCBjdHgtPnByZWdfbG9nX2lkeDsgaSsrKSB7Cisg
ICAgICAgICAgICBpbnQgcHJlZF9udW0gPSBjdHgtPnByZWdfbG9nW2ldOworCisgICAgICAgICAg
ICB0Y2dfZ2VuX2FuZGlfdGwocHJlZF93cml0dGVuLCBoZXhfcHJlZF93cml0dGVuLCAxIDw8IHBy
ZWRfbnVtKTsKKyAgICAgICAgICAgIHRjZ19nZW5fbW92Y29uZF90bChUQ0dfQ09ORF9ORSwgaGV4
X3ByZWRbcHJlZF9udW1dLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZWRfd3Jp
dHRlbiwgemVybywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZXhfbmV3X3ByZWRf
dmFsdWVbcHJlZF9udW1dLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhleF9wcmVk
W3ByZWRfbnVtXSk7CisgICAgICAgIH0KKyAgICAgICAgdGNnX3RlbXBfZnJlZShwcmVkX3dyaXR0
ZW4pOworICAgIH0gZWxzZSB7CisgICAgICAgIGZvciAoaSA9IDA7IGkgPCBjdHgtPnByZWdfbG9n
X2lkeDsgaSsrKSB7CisgICAgICAgICAgICBpbnQgcHJlZF9udW0gPSBjdHgtPnByZWdfbG9nW2ld
OworICAgICAgICAgICAgdGNnX2dlbl9tb3ZfdGwoaGV4X3ByZWRbcHJlZF9udW1dLCBoZXhfbmV3
X3ByZWRfdmFsdWVbcHJlZF9udW1dKTsKKyNpZiBIRVhfREVCVUcKKyAgICAgICAgICAgIC8qIERv
IHRoaXMgc28gSEVMUEVSKGRlYnVnX2NvbW1pdF9lbmQpIHdpbGwga25vdyAqLworICAgICAgICAg
ICAgdGNnX2dlbl9vcmlfdGwoaGV4X3ByZWRfd3JpdHRlbiwgaGV4X3ByZWRfd3JpdHRlbiwgMSA8
PCBwcmVkX251bSk7CisjZW5kaWYKKyAgICAgICAgfQorICAgIH0KKworICAgIHRjZ190ZW1wX2Zy
ZWUoemVybyk7CisgICAgdGNnX3RlbXBfZnJlZShjb250cm9sX3JlZyk7CisgICAgdGNnX3RlbXBf
ZnJlZShwdmFsKTsKK30KKworI2lmIEhFWF9ERUJVRworc3RhdGljIGlubGluZSB2b2lkIGdlbl9j
aGVja19zdG9yZV93aWR0aChEaXNhc0NvbnRleHQgKmN0eCwgaW50IHNsb3RfbnVtKQoreworICAg
IFRDR3Ygc2xvdCA9IHRjZ19jb25zdF90bChzbG90X251bSk7CisgICAgVENHdiBjaGVjayA9IHRj
Z19jb25zdF90bChjdHgtPnN0b3JlX3dpZHRoW3Nsb3RfbnVtXSk7CisgICAgZ2VuX2hlbHBlcl9k
ZWJ1Z19jaGVja19zdG9yZV93aWR0aChjcHVfZW52LCBzbG90LCBjaGVjayk7CisgICAgdGNnX3Rl
bXBfZnJlZShzbG90KTsKKyAgICB0Y2dfdGVtcF9mcmVlKGNoZWNrKTsKK30KKyNkZWZpbmUgSEVY
X0RFQlVHX0dFTl9DSEVDS19TVE9SRV9XSURUSChjdHgsIHNsb3RfbnVtKSBcCisgICAgZ2VuX2No
ZWNrX3N0b3JlX3dpZHRoKGN0eCwgc2xvdF9udW0pCisjZWxzZQorI2RlZmluZSBIRVhfREVCVUdf
R0VOX0NIRUNLX1NUT1JFX1dJRFRIKGN0eCwgc2xvdF9udW0pICAvKiBub3RoaW5nICovCisjZW5k
aWYKKwordm9pZCBwcm9jZXNzX3N0b3JlKERpc2FzQ29udGV4dCAqY3R4LCBpbnQgc2xvdF9udW0p
Cit7CisgICAgVENHdiBjYW5jZWxsZWQ7CisgICAgVENHTGFiZWwgKmxhYmVsX2VuZDsKKworICAg
IC8qCisgICAgICogV2UgbWF5IGhhdmUgYWxyZWFkeSBwcm9jZXNzZWQgdGhpcyBzdG9yZQorICAg
ICAqIFNlZSBDSEVDS19OT1NIVUYgaW4gbWFjcm9zLmgKKyAgICAgKi8KKyAgICBpZiAoc2xvdF9u
dW0gPT0gMSAmJiBjdHgtPnMxX3N0b3JlX3Byb2Nlc3NlZCkgeworICAgICAgICByZXR1cm47Cisg
ICAgfQorICAgIGN0eC0+czFfc3RvcmVfcHJvY2Vzc2VkID0gMTsKKworICAgIGNhbmNlbGxlZCA9
IHRjZ190ZW1wX25ldygpOworICAgIGxhYmVsX2VuZCA9IGdlbl9uZXdfbGFiZWwoKTsKKworICAg
IC8qIERvbid0IGRvIGFueXRoaW5nIGlmIHRoZSBzbG90IHdhcyBjYW5jZWxsZWQgKi8KKyAgICB0
Y2dfZ2VuX2V4dHJhY3RfdGwoY2FuY2VsbGVkLCBoZXhfc2xvdF9jYW5jZWxsZWQsIHNsb3RfbnVt
LCAxKTsKKyAgICB0Y2dfZ2VuX2JyY29uZGlfdGwoVENHX0NPTkRfTkUsIGNhbmNlbGxlZCwgMCwg
bGFiZWxfZW5kKTsKKyAgICB0Y2dfdGVtcF9mcmVlKGNhbmNlbGxlZCk7CisgICAgeworICAgICAg
ICBUQ0d2IGFkZHJlc3MgPSB0Y2dfdGVtcF9sb2NhbF9uZXcoKTsKKyAgICAgICAgdGNnX2dlbl9t
b3ZfdGwoYWRkcmVzcywgaGV4X3N0b3JlX2FkZHJbc2xvdF9udW1dKTsKKworICAgICAgICAvKgor
ICAgICAgICAgKiBJZiB3ZSBrbm93IHRoZSB3aWR0aCBmcm9tIHRoZSBEaXNhc0NvbnRleHQsIHdl
IGNhbgorICAgICAgICAgKiBnZW5lcmF0ZSBtdWNoIGNsZWFuZXIgY29kZS4KKyAgICAgICAgICog
VW5mb3J0dW5hdGVseSwgbm90IGFsbCBpbnN0cnVjdGlvbnMgZXhlY3V0ZSB0aGUgZlNUT1JFCisg
ICAgICAgICAqIG1hY3JvIGR1cmluZyBjb2RlIGdlbmVyYXRpb24uICBBbnl0aGluZyB0aGF0IHVz
ZXMgdGhlCisgICAgICAgICAqIGdlbmVyaWMgaGVscGVyIHdpbGwgaGF2ZSB0aGlzIHByb2JsZW0u
ICBJbnN0cnVjdGlvbnMKKyAgICAgICAgICogdGhhdCB1c2UgZldSQVAgdG8gZ2VuZXJhdGUgcHJv
cGVyIFRDRyBjb2RlIHdpbGwgYmUgT0suCisgICAgICAgICAqLworICAgICAgICBzd2l0Y2ggKGN0
eC0+c3RvcmVfd2lkdGhbc2xvdF9udW1dKSB7CisgICAgICAgIGNhc2UgMToKKyAgICAgICAgICAg
IEhFWF9ERUJVR19HRU5fQ0hFQ0tfU1RPUkVfV0lEVEgoY3R4LCBzbG90X251bSk7CisgICAgICAg
ICAgICB0Y2dfZ2VuX3FlbXVfc3Q4KGhleF9zdG9yZV92YWwzMltzbG90X251bV0sCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGhleF9zdG9yZV9hZGRyW3Nsb3RfbnVtXSwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgY3R4LT5tZW1faWR4KTsKKyAgICAgICAgICAgIGJyZWFrOwor
ICAgICAgICBjYXNlIDI6CisgICAgICAgICAgICBIRVhfREVCVUdfR0VOX0NIRUNLX1NUT1JFX1dJ
RFRIKGN0eCwgc2xvdF9udW0pOworICAgICAgICAgICAgdGNnX2dlbl9xZW11X3N0MTYoaGV4X3N0
b3JlX3ZhbDMyW3Nsb3RfbnVtXSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhleF9z
dG9yZV9hZGRyW3Nsb3RfbnVtXSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC0+
bWVtX2lkeCk7CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgY2FzZSA0OgorICAgICAgICAg
ICAgSEVYX0RFQlVHX0dFTl9DSEVDS19TVE9SRV9XSURUSChjdHgsIHNsb3RfbnVtKTsKKyAgICAg
ICAgICAgIHRjZ19nZW5fcWVtdV9zdDMyKGhleF9zdG9yZV92YWwzMltzbG90X251bV0sCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBoZXhfc3RvcmVfYWRkcltzbG90X251bV0sCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgtPm1lbV9pZHgpOworICAgICAgICAgICAgYnJl
YWs7CisgICAgICAgIGNhc2UgODoKKyAgICAgICAgICAgIEhFWF9ERUJVR19HRU5fQ0hFQ0tfU1RP
UkVfV0lEVEgoY3R4LCBzbG90X251bSk7CisgICAgICAgICAgICB0Y2dfZ2VuX3FlbXVfc3Q2NCho
ZXhfc3RvcmVfdmFsNjRbc2xvdF9udW1dLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
aGV4X3N0b3JlX2FkZHJbc2xvdF9udW1dLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
Y3R4LT5tZW1faWR4KTsKKyAgICAgICAgICAgIGJyZWFrOworICAgICAgICBkZWZhdWx0OgorICAg
ICAgICAgICAgeworICAgICAgICAgICAgICAgIC8qCisgICAgICAgICAgICAgICAgICogSWYgd2Ug
Z2V0IHRvIGhlcmUsIHdlIGRvbid0IGtub3cgdGhlIHdpZHRoIGF0CisgICAgICAgICAgICAgICAg
ICogVENHIGdlbmVyYXRpb24gdGltZSwgd2UnbGwgdXNlIGEgaGVscGVyIHRvCisgICAgICAgICAg
ICAgICAgICogYXZvaWQgYnJhbmNoaW5nIGJhc2VkIG9uIHRoZSB3aWR0aCBhdCBydW50aW1lLgor
ICAgICAgICAgICAgICAgICAqLworICAgICAgICAgICAgICAgIFRDR3Ygc2xvdCA9IHRjZ19jb25z
dF90bChzbG90X251bSk7CisgICAgICAgICAgICAgICAgZ2VuX2hlbHBlcl9jb21taXRfc3RvcmUo
Y3B1X2Vudiwgc2xvdCk7CisgICAgICAgICAgICAgICAgdGNnX3RlbXBfZnJlZShzbG90KTsKKyAg
ICAgICAgICAgIH0KKyAgICAgICAgfQorICAgICAgICB0Y2dfdGVtcF9mcmVlKGFkZHJlc3MpOwor
ICAgIH0KKyAgICBnZW5fc2V0X2xhYmVsKGxhYmVsX2VuZCk7Cit9CisKK3N0YXRpYyB2b2lkIHBy
b2Nlc3Nfc3RvcmVfbG9nKERpc2FzQ29udGV4dCAqY3R4LCBQYWNrZXQgKnBrdCkKK3sKKyAgICAv
KgorICAgICAqICBXaGVuIGEgcGFja2V0IGhhcyB0d28gc3RvcmVzLCB0aGUgaGFyZHdhcmUgcHJv
Y2Vzc2VzCisgICAgICogIHNsb3QgMSBhbmQgdGhlbiBzbG90IDIuICBUaGlzIHdpbGwgYmUgaW1w
b3J0YW50IHdoZW4KKyAgICAgKiAgdGhlIG1lbW9yeSBhY2Nlc3NlcyBvdmVybGFwLgorICAgICAq
LworICAgIGlmIChwa3QtPnBrdF9oYXNfc3RvcmVfczEgJiYgIXBrdC0+cGt0X2hhc19kY3plcm9h
KSB7CisgICAgICAgIHByb2Nlc3Nfc3RvcmUoY3R4LCAxKTsKKyAgICB9CisgICAgaWYgKHBrdC0+
cGt0X2hhc19zdG9yZV9zMCAmJiAhcGt0LT5wa3RfaGFzX2RjemVyb2EpIHsKKyAgICAgICAgcHJv
Y2Vzc19zdG9yZShjdHgsIDApOworICAgIH0KK30KKworLyogWmVybyBvdXQgYSAzMi1iaXQgY2Fj
aGUgbGluZSAqLworc3RhdGljIHZvaWQgcHJvY2Vzc19kY3plcm9hKERpc2FzQ29udGV4dCAqY3R4
LCBQYWNrZXQgKnBrdCkKK3sKKyAgICBpZiAocGt0LT5wa3RfaGFzX2RjemVyb2EpIHsKKyAgICAg
ICAgLyogU3RvcmUgMzIgYnl0ZXMgb2YgemVybyBzdGFydGluZyBhdCAoYWRkciAmIH4weDFmKSAq
LworICAgICAgICBUQ0d2IGFkZHIgPSB0Y2dfdGVtcF9uZXcoKTsKKyAgICAgICAgVENHdl9pNjQg
emVybyA9IHRjZ19jb25zdF9pNjQoMCk7CisKKyAgICAgICAgdGNnX2dlbl9hbmRpX3RsKGFkZHIs
IGhleF9kY3plcm9fYWRkciwgfjB4MWYpOworICAgICAgICB0Y2dfZ2VuX3FlbXVfc3Q2NCh6ZXJv
LCBhZGRyLCBjdHgtPm1lbV9pZHgpOworICAgICAgICB0Y2dfZ2VuX2FkZGlfdGwoYWRkciwgYWRk
ciwgOCk7CisgICAgICAgIHRjZ19nZW5fcWVtdV9zdDY0KHplcm8sIGFkZHIsIGN0eC0+bWVtX2lk
eCk7CisgICAgICAgIHRjZ19nZW5fYWRkaV90bChhZGRyLCBhZGRyLCA4KTsKKyAgICAgICAgdGNn
X2dlbl9xZW11X3N0NjQoemVybywgYWRkciwgY3R4LT5tZW1faWR4KTsKKyAgICAgICAgdGNnX2dl
bl9hZGRpX3RsKGFkZHIsIGFkZHIsIDgpOworICAgICAgICB0Y2dfZ2VuX3FlbXVfc3Q2NCh6ZXJv
LCBhZGRyLCBjdHgtPm1lbV9pZHgpOworCisgICAgICAgIHRjZ190ZW1wX2ZyZWUoYWRkcik7Cisg
ICAgICAgIHRjZ190ZW1wX2ZyZWVfaTY0KHplcm8pOworICAgIH0KK30KKworc3RhdGljIHZvaWQg
Z2VuX2V4ZWNfY291bnRlcnMoUGFja2V0ICpwa3QpCit7CisgICAgaW50IG51bV9pbnNucyA9IHBr
dC0+bnVtX2luc25zOworICAgIGludCBudW1fcmVhbF9pbnNucyA9IDA7CisgICAgaW50IGk7CisK
KyAgICBmb3IgKGkgPSAwOyBpIDwgbnVtX2luc25zOyBpKyspIHsKKyAgICAgICAgaWYgKCFwa3Qt
Pmluc25baV0uaXNfZW5kbG9vcCAmJgorICAgICAgICAgICAgIXBrdC0+aW5zbltpXS5wYXJ0MSAm
JgorICAgICAgICAgICAgIUdFVF9BVFRSSUIocGt0LT5pbnNuW2ldLm9wY29kZSwgQV9JVF9OT1Ap
KSB7CisgICAgICAgICAgICBudW1fcmVhbF9pbnNucysrOworICAgICAgICB9CisgICAgfQorCisg
ICAgdGNnX2dlbl9hZGRpX3RsKGhleF9ncHJbSEVYX1JFR19RRU1VX1BLVF9DTlRdLAorICAgICAg
ICAgICAgICAgICAgICBoZXhfZ3ByW0hFWF9SRUdfUUVNVV9QS1RfQ05UXSwgMSk7CisgICAgdGNn
X2dlbl9hZGRpX3RsKGhleF9ncHJbSEVYX1JFR19RRU1VX0lOU05fQ05UXSwKKyAgICAgICAgICAg
ICAgICAgICAgaGV4X2dwcltIRVhfUkVHX1FFTVVfSU5TTl9DTlRdLCBudW1fcmVhbF9pbnNucyk7
Cit9CisKK3N0YXRpYyB2b2lkIGdlbl9jb21taXRfcGFja2V0KERpc2FzQ29udGV4dCAqY3R4LCBQ
YWNrZXQgKnBrdCkKK3sKKyAgICBnZW5fcmVnX3dyaXRlcyhjdHgpOworICAgIGdlbl9wcmVkX3dy
aXRlcyhjdHgsIHBrdCk7CisgICAgcHJvY2Vzc19zdG9yZV9sb2coY3R4LCBwa3QpOworICAgIHBy
b2Nlc3NfZGN6ZXJvYShjdHgsIHBrdCk7CisgICAgZ2VuX2V4ZWNfY291bnRlcnMocGt0KTsKKyNp
ZiBIRVhfREVCVUcKKyAgICB7CisgICAgICAgIFRDR3YgaGFzX3N0MCA9CisgICAgICAgICAgICB0
Y2dfY29uc3RfdGwocGt0LT5wa3RfaGFzX3N0b3JlX3MwICYmICFwa3QtPnBrdF9oYXNfZGN6ZXJv
YSk7CisgICAgICAgIFRDR3YgaGFzX3N0MSA9CisgICAgICAgICAgICB0Y2dfY29uc3RfdGwocGt0
LT5wa3RfaGFzX3N0b3JlX3MxICYmICFwa3QtPnBrdF9oYXNfZGN6ZXJvYSk7CisKKyAgICAgICAg
LyogSGFuZHkgcGxhY2UgdG8gc2V0IGEgYnJlYWtwb2ludCBhdCB0aGUgZW5kIG9mIGV4ZWN1dGlv
biAqLworICAgICAgICBnZW5faGVscGVyX2RlYnVnX2NvbW1pdF9lbmQoY3B1X2VudiwgaGFzX3N0
MCwgaGFzX3N0MSk7CisKKyAgICAgICAgdGNnX3RlbXBfZnJlZShoYXNfc3QwKTsKKyAgICAgICAg
dGNnX3RlbXBfZnJlZShoYXNfc3QxKTsKKyAgICB9CisjZW5kaWYKKworICAgIGlmIChwa3QtPnBr
dF9oYXNfY29mKSB7CisgICAgICAgIGN0eC0+YmFzZS5pc19qbXAgPSBESVNBU19OT1JFVFVSTjsK
KyAgICB9Cit9CisKK3N0YXRpYyB2b2lkIGRlY29kZV9hbmRfdHJhbnNsYXRlX3BhY2tldChDUFVI
ZXhhZ29uU3RhdGUgKmVudiwgRGlzYXNDb250ZXh0ICpjdHgpCit7CisgICAgdWludDMyX3Qgd29y
ZHNbUEFDS0VUX1dPUkRTX01BWF07CisgICAgaW50IG53b3JkczsKKyAgICBQYWNrZXQgcGt0Owor
ICAgIGludCBpOworCisgICAgbndvcmRzID0gcmVhZF9wYWNrZXRfd29yZHMoZW52LCBjdHgsIHdv
cmRzKTsKKyAgICBpZiAoIW53b3JkcykgeworICAgICAgICBnZW5fZXhjZXB0aW9uKEhFWF9FWENQ
X0lOVkFMSURfUEFDS0VUKTsKKyAgICAgICAgY3R4LT5iYXNlLmlzX2ptcCA9IERJU0FTX05PUkVU
VVJOOworICAgICAgICByZXR1cm47CisgICAgfQorCisgICAgaWYgKGRlY29kZV9wYWNrZXQobndv
cmRzLCB3b3JkcywgJnBrdCwgZmFsc2UpID4gMCkgeworICAgICAgICBIRVhfREVCVUdfUFJJTlRf
UEtUKCZwa3QpOworICAgICAgICBnZW5fc3RhcnRfcGFja2V0KGN0eCwgJnBrdCk7CisgICAgICAg
IGZvciAoaSA9IDA7IGkgPCBwa3QubnVtX2luc25zOyBpKyspIHsKKyAgICAgICAgICAgIGdlbl9p
bnNuKGVudiwgY3R4LCAmcGt0Lmluc25baV0sICZwa3QpOworICAgICAgICB9CisgICAgICAgIGdl
bl9jb21taXRfcGFja2V0KGN0eCwgJnBrdCk7CisgICAgICAgIGN0eC0+YmFzZS5wY19uZXh0ICs9
IHBrdC5lbmNvZF9wa3Rfc2l6ZV9pbl9ieXRlczsKKyAgICB9IGVsc2UgeworICAgICAgICBnZW5f
ZXhjZXB0aW9uKEhFWF9FWENQX0lOVkFMSURfUEFDS0VUKTsKKyAgICAgICAgY3R4LT5iYXNlLmlz
X2ptcCA9IERJU0FTX05PUkVUVVJOOworICAgIH0KK30KKworc3RhdGljIHZvaWQgaGV4YWdvbl90
cl9pbml0X2Rpc2FzX2NvbnRleHQoRGlzYXNDb250ZXh0QmFzZSAqZGNiYXNlLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1BVU3RhdGUgKmNzKQoreworICAgIERp
c2FzQ29udGV4dCAqY3R4ID0gY29udGFpbmVyX29mKGRjYmFzZSwgRGlzYXNDb250ZXh0LCBiYXNl
KTsKKworICAgIGN0eC0+bWVtX2lkeCA9IE1NVV9VU0VSX0lEWDsKK30KKworc3RhdGljIHZvaWQg
aGV4YWdvbl90cl90Yl9zdGFydChEaXNhc0NvbnRleHRCYXNlICpkYiwgQ1BVU3RhdGUgKmNwdSkK
K3sKK30KKworc3RhdGljIHZvaWQgaGV4YWdvbl90cl9pbnNuX3N0YXJ0KERpc2FzQ29udGV4dEJh
c2UgKmRjYmFzZSwgQ1BVU3RhdGUgKmNwdSkKK3sKKyAgICBEaXNhc0NvbnRleHQgKmN0eCA9IGNv
bnRhaW5lcl9vZihkY2Jhc2UsIERpc2FzQ29udGV4dCwgYmFzZSk7CisKKyAgICB0Y2dfZ2VuX2lu
c25fc3RhcnQoY3R4LT5iYXNlLnBjX25leHQpOworfQorCitzdGF0aWMgYm9vbCBoZXhhZ29uX3Ry
X2JyZWFrcG9pbnRfY2hlY2soRGlzYXNDb250ZXh0QmFzZSAqZGNiYXNlLCBDUFVTdGF0ZSAqY3B1
LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IENQVUJyZWFr
cG9pbnQgKmJwKQoreworICAgIERpc2FzQ29udGV4dCAqY3R4ID0gY29udGFpbmVyX29mKGRjYmFz
ZSwgRGlzYXNDb250ZXh0LCBiYXNlKTsKKworICAgIHRjZ19nZW5fbW92aV90bChoZXhfZ3ByW0hF
WF9SRUdfUENdLCBjdHgtPmJhc2UucGNfbmV4dCk7CisgICAgY3R4LT5iYXNlLmlzX2ptcCA9IERJ
U0FTX05PUkVUVVJOOworICAgIGdlbl9leGNlcHRpb25fZGVidWcoKTsKKyAgICAvKgorICAgICAq
IFRoZSBhZGRyZXNzIGNvdmVyZWQgYnkgdGhlIGJyZWFrcG9pbnQgbXVzdCBiZSBpbmNsdWRlZCBp
bgorICAgICAqIFt0Yi0+cGMsIHRiLT5wYyArIHRiLT5zaXplKSBpbiBvcmRlciB0byBmb3IgaXQg
dG8gYmUKKyAgICAgKiBwcm9wZXJseSBjbGVhcmVkIC0tIHRodXMgd2UgaW5jcmVtZW50IHRoZSBQ
QyBoZXJlIHNvIHRoYXQKKyAgICAgKiB0aGUgbG9naWMgc2V0dGluZyB0Yi0+c2l6ZSBiZWxvdyBk
b2VzIHRoZSByaWdodCB0aGluZy4KKyAgICAgKi8KKyAgICBjdHgtPmJhc2UucGNfbmV4dCArPSA0
OworICAgIHJldHVybiB0cnVlOworfQorCitzdGF0aWMgYm9vbCBwa3RfY3Jvc3Nlc19wYWdlKENQ
VUhleGFnb25TdGF0ZSAqZW52LCBEaXNhc0NvbnRleHQgKmN0eCkKK3sKKyAgICB0YXJnZXRfdWxv
bmcgcGFnZV9zdGFydCA9IGN0eC0+YmFzZS5wY19maXJzdCAmIFRBUkdFVF9QQUdFX01BU0s7Cisg
ICAgYm9vbCBmb3VuZF9lbmQgPSBmYWxzZTsKKyAgICBpbnQgbndvcmRzOworCisgICAgZm9yIChu
d29yZHMgPSAwOyAhZm91bmRfZW5kICYmIG53b3JkcyA8IFBBQ0tFVF9XT1JEU19NQVg7IG53b3Jk
cysrKSB7CisgICAgICAgIHVpbnQzMl90IHdvcmQgPSBjcHVfbGRsX2NvZGUoZW52LAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGN0eC0+YmFzZS5wY19uZXh0ICsgbndvcmRzICogc2l6ZW9m
KHVpbnQzMl90KSk7CisgICAgICAgIGZvdW5kX2VuZCA9IGlzX3BhY2tldF9lbmQod29yZCk7Cisg
ICAgfQorICAgIHVpbnQzMl90IG5leHRfcHRyID0gIGN0eC0+YmFzZS5wY19uZXh0ICsgbndvcmRz
ICogc2l6ZW9mKHVpbnQzMl90KTsKKyAgICByZXR1cm4gZm91bmRfZW5kICYmIG5leHRfcHRyIC0g
cGFnZV9zdGFydCA+PSBUQVJHRVRfUEFHRV9TSVpFOworfQorCitzdGF0aWMgdm9pZCBoZXhhZ29u
X3RyX3RyYW5zbGF0ZV9wYWNrZXQoRGlzYXNDb250ZXh0QmFzZSAqZGNiYXNlLCBDUFVTdGF0ZSAq
Y3B1KQoreworICAgIERpc2FzQ29udGV4dCAqY3R4ID0gY29udGFpbmVyX29mKGRjYmFzZSwgRGlz
YXNDb250ZXh0LCBiYXNlKTsKKyAgICBDUFVIZXhhZ29uU3RhdGUgKmVudiA9IGNwdS0+ZW52X3B0
cjsKKworICAgIGRlY29kZV9hbmRfdHJhbnNsYXRlX3BhY2tldChlbnYsIGN0eCk7CisKKyAgICBp
ZiAoY3R4LT5iYXNlLmlzX2ptcCA9PSBESVNBU19ORVhUKSB7CisgICAgICAgIHRhcmdldF91bG9u
ZyBwYWdlX3N0YXJ0ID0gY3R4LT5iYXNlLnBjX2ZpcnN0ICYgVEFSR0VUX1BBR0VfTUFTSzsKKyAg
ICAgICAgdGFyZ2V0X3Vsb25nIGJ5dGVzX21heCA9IFBBQ0tFVF9XT1JEU19NQVggKiBzaXplb2Yo
dGFyZ2V0X3Vsb25nKTsKKworICAgICAgICBpZiAoY3R4LT5iYXNlLnBjX25leHQgLSBwYWdlX3N0
YXJ0ID49IFRBUkdFVF9QQUdFX1NJWkUgfHwKKyAgICAgICAgICAgIChjdHgtPmJhc2UucGNfbmV4
dCAtIHBhZ2Vfc3RhcnQgPj0gVEFSR0VUX1BBR0VfU0laRSAtIGJ5dGVzX21heCAmJgorICAgICAg
ICAgICAgIHBrdF9jcm9zc2VzX3BhZ2UoZW52LCBjdHgpKSkgeworICAgICAgICAgICAgY3R4LT5i
YXNlLmlzX2ptcCA9IERJU0FTX1RPT19NQU5ZOworICAgICAgICB9CisKKyAgICAgICAgLyoKKyAg
ICAgICAgICogVGhlIENQVSBsb2cgaXMgdXNlZCB0byBjb21wYXJlIGFnYWluc3QgTExEQiBzaW5n
bGUgc3RlcHBpbmcsCisgICAgICAgICAqIHNvIGVuZCB0aGUgVExCIGFmdGVyIGV2ZXJ5IHBhY2tl
dC4KKyAgICAgICAgICovCisgICAgICAgIEhleGFnb25DUFUgKmhleF9jcHUgPSBjb250YWluZXJf
b2YoZW52LCBIZXhhZ29uQ1BVLCBlbnYpOworICAgICAgICBpZiAoaGV4X2NwdS0+bGxkYl9jb21w
YXQgJiYgcWVtdV9sb2dsZXZlbF9tYXNrKENQVV9MT0dfVEJfQ1BVKSkgeworICAgICAgICAgICAg
Y3R4LT5iYXNlLmlzX2ptcCA9IERJU0FTX1RPT19NQU5ZOworICAgICAgICB9CisjaWYgSEVYX0RF
QlVHCisgICAgICAgIC8qIFdoZW4gZGVidWdnaW5nLCBvbmx5IHB1dCBvbmUgcGFja2V0IHBlciBU
QiAqLworICAgICAgICBjdHgtPmJhc2UuaXNfam1wID0gRElTQVNfVE9PX01BTlk7CisjZW5kaWYK
KyAgICB9Cit9CisKK3N0YXRpYyB2b2lkIGhleGFnb25fdHJfdGJfc3RvcChEaXNhc0NvbnRleHRC
YXNlICpkY2Jhc2UsIENQVVN0YXRlICpjcHUpCit7CisgICAgRGlzYXNDb250ZXh0ICpjdHggPSBj
b250YWluZXJfb2YoZGNiYXNlLCBEaXNhc0NvbnRleHQsIGJhc2UpOworCisgICAgc3dpdGNoIChj
dHgtPmJhc2UuaXNfam1wKSB7CisgICAgY2FzZSBESVNBU19UT09fTUFOWToKKyAgICAgICAgdGNn
X2dlbl9tb3ZpX3RsKGhleF9ncHJbSEVYX1JFR19QQ10sIGN0eC0+YmFzZS5wY19uZXh0KTsKKyAg
ICAgICAgaWYgKGN0eC0+YmFzZS5zaW5nbGVzdGVwX2VuYWJsZWQpIHsKKyAgICAgICAgICAgIGdl
bl9leGNlcHRpb25fZGVidWcoKTsKKyAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgIHRjZ19n
ZW5fZXhpdF90YihOVUxMLCAwKTsKKyAgICAgICAgfQorICAgICAgICBicmVhazsKKyAgICBjYXNl
IERJU0FTX05PUkVUVVJOOgorICAgICAgICB0Y2dfZ2VuX21vdl90bChoZXhfZ3ByW0hFWF9SRUdf
UENdLCBoZXhfbmV4dF9QQyk7CisgICAgICAgIGlmIChjdHgtPmJhc2Uuc2luZ2xlc3RlcF9lbmFi
bGVkKSB7CisgICAgICAgICAgICBnZW5fZXhjZXB0aW9uX2RlYnVnKCk7CisgICAgICAgIH0gZWxz
ZSB7CisgICAgICAgICAgICB0Y2dfZ2VuX2V4aXRfdGIoTlVMTCwgMCk7CisgICAgICAgIH0KKyAg
ICAgICAgYnJlYWs7CisgICAgZGVmYXVsdDoKKyAgICAgICAgZ19hc3NlcnRfbm90X3JlYWNoZWQo
KTsKKyAgICB9Cit9CisKK3N0YXRpYyB2b2lkIGhleGFnb25fdHJfZGlzYXNfbG9nKGNvbnN0IERp
c2FzQ29udGV4dEJhc2UgKmRjYmFzZSwgQ1BVU3RhdGUgKmNwdSkKK3sKKyAgICBxZW11X2xvZygi
SU46ICVzXG4iLCBsb29rdXBfc3ltYm9sKGRjYmFzZS0+cGNfZmlyc3QpKTsKKyAgICBsb2dfdGFy
Z2V0X2Rpc2FzKGNwdSwgZGNiYXNlLT5wY19maXJzdCwgZGNiYXNlLT50Yi0+c2l6ZSk7Cit9CisK
Kworc3RhdGljIGNvbnN0IFRyYW5zbGF0b3JPcHMgaGV4YWdvbl90cl9vcHMgPSB7CisgICAgLmlu
aXRfZGlzYXNfY29udGV4dCA9IGhleGFnb25fdHJfaW5pdF9kaXNhc19jb250ZXh0LAorICAgIC50
Yl9zdGFydCAgICAgICAgICAgPSBoZXhhZ29uX3RyX3RiX3N0YXJ0LAorICAgIC5pbnNuX3N0YXJ0
ICAgICAgICAgPSBoZXhhZ29uX3RyX2luc25fc3RhcnQsCisgICAgLmJyZWFrcG9pbnRfY2hlY2sg
ICA9IGhleGFnb25fdHJfYnJlYWtwb2ludF9jaGVjaywKKyAgICAudHJhbnNsYXRlX2luc24gICAg
ID0gaGV4YWdvbl90cl90cmFuc2xhdGVfcGFja2V0LAorICAgIC50Yl9zdG9wICAgICAgICAgICAg
PSBoZXhhZ29uX3RyX3RiX3N0b3AsCisgICAgLmRpc2FzX2xvZyAgICAgICAgICA9IGhleGFnb25f
dHJfZGlzYXNfbG9nLAorfTsKKwordm9pZCBnZW5faW50ZXJtZWRpYXRlX2NvZGUoQ1BVU3RhdGUg
KmNzLCBUcmFuc2xhdGlvbkJsb2NrICp0YiwgaW50IG1heF9pbnNucykKK3sKKyAgICBEaXNhc0Nv
bnRleHQgY3R4OworCisgICAgdHJhbnNsYXRvcl9sb29wKCZoZXhhZ29uX3RyX29wcywgJmN0eC5i
YXNlLCBjcywgdGIsIG1heF9pbnNucyk7Cit9CisKKyNkZWZpbmUgTkFNRV9MRU4gICAgICAgICAg
ICAgICA2NAorc3RhdGljIGNoYXIgbmV3X3ZhbHVlX25hbWVzW1RPVEFMX1BFUl9USFJFQURfUkVH
U11bTkFNRV9MRU5dOworI2lmIEhFWF9ERUJVRworc3RhdGljIGNoYXIgcmVnX3dyaXR0ZW5fbmFt
ZXNbVE9UQUxfUEVSX1RIUkVBRF9SRUdTXVtOQU1FX0xFTl07CisjZW5kaWYKK3N0YXRpYyBjaGFy
IG5ld19wcmVkX3ZhbHVlX25hbWVzW05VTV9QUkVHU11bTkFNRV9MRU5dOworc3RhdGljIGNoYXIg
c3RvcmVfYWRkcl9uYW1lc1tTVE9SRVNfTUFYXVtOQU1FX0xFTl07CitzdGF0aWMgY2hhciBzdG9y
ZV93aWR0aF9uYW1lc1tTVE9SRVNfTUFYXVtOQU1FX0xFTl07CitzdGF0aWMgY2hhciBzdG9yZV92
YWwzMl9uYW1lc1tTVE9SRVNfTUFYXVtOQU1FX0xFTl07CitzdGF0aWMgY2hhciBzdG9yZV92YWw2
NF9uYW1lc1tTVE9SRVNfTUFYXVtOQU1FX0xFTl07CisKK3ZvaWQgaGV4YWdvbl90cmFuc2xhdGVf
aW5pdCh2b2lkKQoreworICAgIGludCBpOworCisgICAgb3Bjb2RlX2luaXQoKTsKKworI2lmIEhF
WF9ERUJVRworICAgIGlmICghcWVtdV9sb2dmaWxlKSB7CisgICAgICAgIHFlbXVfc2V0X2xvZyhx
ZW11X2xvZ2xldmVsKTsKKyAgICB9CisjZW5kaWYKKworICAgIGZvciAoaSA9IDA7IGkgPCBUT1RB
TF9QRVJfVEhSRUFEX1JFR1M7IGkrKykgeworICAgICAgICBoZXhfZ3ByW2ldID0gdGNnX2dsb2Jh
bF9tZW1fbmV3KGNwdV9lbnYsCisgICAgICAgICAgICBvZmZzZXRvZihDUFVIZXhhZ29uU3RhdGUs
IGdwcltpXSksCisgICAgICAgICAgICBoZXhhZ29uX3JlZ25hbWVzW2ldKTsKKworICAgICAgICBz
bnByaW50ZihuZXdfdmFsdWVfbmFtZXNbaV0sIE5BTUVfTEVOLCAibmV3XyVzIiwgaGV4YWdvbl9y
ZWduYW1lc1tpXSk7CisgICAgICAgIGhleF9uZXdfdmFsdWVbaV0gPSB0Y2dfZ2xvYmFsX21lbV9u
ZXcoY3B1X2VudiwKKyAgICAgICAgICAgIG9mZnNldG9mKENQVUhleGFnb25TdGF0ZSwgbmV3X3Zh
bHVlW2ldKSwKKyAgICAgICAgICAgIG5ld192YWx1ZV9uYW1lc1tpXSk7CisKKyNpZiBIRVhfREVC
VUcKKyAgICAgICAgc25wcmludGYocmVnX3dyaXR0ZW5fbmFtZXNbaV0sIE5BTUVfTEVOLCAicmVn
X3dyaXR0ZW5fJXMiLAorICAgICAgICAgICAgICAgICBoZXhhZ29uX3JlZ25hbWVzW2ldKTsKKyAg
ICAgICAgaGV4X3JlZ193cml0dGVuW2ldID0gdGNnX2dsb2JhbF9tZW1fbmV3KGNwdV9lbnYsCisg
ICAgICAgICAgICBvZmZzZXRvZihDUFVIZXhhZ29uU3RhdGUsIHJlZ193cml0dGVuW2ldKSwKKyAg
ICAgICAgICAgIHJlZ193cml0dGVuX25hbWVzW2ldKTsKKyNlbmRpZgorICAgIH0KKyAgICBmb3Ig
KGkgPSAwOyBpIDwgTlVNX1BSRUdTOyBpKyspIHsKKyAgICAgICAgaGV4X3ByZWRbaV0gPSB0Y2df
Z2xvYmFsX21lbV9uZXcoY3B1X2VudiwKKyAgICAgICAgICAgIG9mZnNldG9mKENQVUhleGFnb25T
dGF0ZSwgcHJlZFtpXSksCisgICAgICAgICAgICBoZXhhZ29uX3ByZWRuYW1lc1tpXSk7CisKKyAg
ICAgICAgc25wcmludGYobmV3X3ByZWRfdmFsdWVfbmFtZXNbaV0sIE5BTUVfTEVOLCAibmV3X3By
ZWRfJXMiLAorICAgICAgICAgICAgICAgICBoZXhhZ29uX3ByZWRuYW1lc1tpXSk7CisgICAgICAg
IGhleF9uZXdfcHJlZF92YWx1ZVtpXSA9IHRjZ19nbG9iYWxfbWVtX25ldyhjcHVfZW52LAorICAg
ICAgICAgICAgb2Zmc2V0b2YoQ1BVSGV4YWdvblN0YXRlLCBuZXdfcHJlZF92YWx1ZVtpXSksCisg
ICAgICAgICAgICBuZXdfcHJlZF92YWx1ZV9uYW1lc1tpXSk7CisgICAgfQorICAgIGhleF9wcmVk
X3dyaXR0ZW4gPSB0Y2dfZ2xvYmFsX21lbV9uZXcoY3B1X2VudiwKKyAgICAgICAgb2Zmc2V0b2Yo
Q1BVSGV4YWdvblN0YXRlLCBwcmVkX3dyaXR0ZW4pLCAicHJlZF93cml0dGVuIik7CisgICAgaGV4
X25leHRfUEMgPSB0Y2dfZ2xvYmFsX21lbV9uZXcoY3B1X2VudiwKKyAgICAgICAgb2Zmc2V0b2Yo
Q1BVSGV4YWdvblN0YXRlLCBuZXh0X1BDKSwgIm5leHRfUEMiKTsKKyAgICBoZXhfdGhpc19QQyA9
IHRjZ19nbG9iYWxfbWVtX25ldyhjcHVfZW52LAorICAgICAgICBvZmZzZXRvZihDUFVIZXhhZ29u
U3RhdGUsIHRoaXNfUEMpLCAidGhpc19QQyIpOworICAgIGhleF9zbG90X2NhbmNlbGxlZCA9IHRj
Z19nbG9iYWxfbWVtX25ldyhjcHVfZW52LAorICAgICAgICBvZmZzZXRvZihDUFVIZXhhZ29uU3Rh
dGUsIHNsb3RfY2FuY2VsbGVkKSwgInNsb3RfY2FuY2VsbGVkIik7CisgICAgaGV4X2JyYW5jaF90
YWtlbiA9IHRjZ19nbG9iYWxfbWVtX25ldyhjcHVfZW52LAorICAgICAgICBvZmZzZXRvZihDUFVI
ZXhhZ29uU3RhdGUsIGJyYW5jaF90YWtlbiksICJicmFuY2hfdGFrZW4iKTsKKyAgICBoZXhfcGt0
X2hhc19zdG9yZV9zMSA9IHRjZ19nbG9iYWxfbWVtX25ldyhjcHVfZW52LAorICAgICAgICBvZmZz
ZXRvZihDUFVIZXhhZ29uU3RhdGUsIHBrdF9oYXNfc3RvcmVfczEpLCAicGt0X2hhc19zdG9yZV9z
MSIpOworICAgIGhleF9kY3plcm9fYWRkciA9IHRjZ19nbG9iYWxfbWVtX25ldyhjcHVfZW52LAor
ICAgICAgICBvZmZzZXRvZihDUFVIZXhhZ29uU3RhdGUsIGRjemVyb19hZGRyKSwgImRjemVyb19h
ZGRyIik7CisgICAgaGV4X2xsc2NfYWRkciA9IHRjZ19nbG9iYWxfbWVtX25ldyhjcHVfZW52LAor
ICAgICAgICBvZmZzZXRvZihDUFVIZXhhZ29uU3RhdGUsIGxsc2NfYWRkciksICJsbHNjX2FkZHIi
KTsKKyAgICBoZXhfbGxzY192YWwgPSB0Y2dfZ2xvYmFsX21lbV9uZXcoY3B1X2VudiwKKyAgICAg
ICAgb2Zmc2V0b2YoQ1BVSGV4YWdvblN0YXRlLCBsbHNjX3ZhbCksICJsbHNjX3ZhbCIpOworICAg
IGhleF9sbHNjX3ZhbF9pNjQgPSB0Y2dfZ2xvYmFsX21lbV9uZXdfaTY0KGNwdV9lbnYsCisgICAg
ICAgIG9mZnNldG9mKENQVUhleGFnb25TdGF0ZSwgbGxzY192YWxfaTY0KSwgImxsc2NfdmFsX2k2
NCIpOworICAgIGZvciAoaSA9IDA7IGkgPCBTVE9SRVNfTUFYOyBpKyspIHsKKyAgICAgICAgc25w
cmludGYoc3RvcmVfYWRkcl9uYW1lc1tpXSwgTkFNRV9MRU4sICJzdG9yZV9hZGRyXyVkIiwgaSk7
CisgICAgICAgIGhleF9zdG9yZV9hZGRyW2ldID0gdGNnX2dsb2JhbF9tZW1fbmV3KGNwdV9lbnYs
CisgICAgICAgICAgICBvZmZzZXRvZihDUFVIZXhhZ29uU3RhdGUsIG1lbV9sb2dfc3RvcmVzW2ld
LnZhKSwKKyAgICAgICAgICAgIHN0b3JlX2FkZHJfbmFtZXNbaV0pOworCisgICAgICAgIHNucHJp
bnRmKHN0b3JlX3dpZHRoX25hbWVzW2ldLCBOQU1FX0xFTiwgInN0b3JlX3dpZHRoXyVkIiwgaSk7
CisgICAgICAgIGhleF9zdG9yZV93aWR0aFtpXSA9IHRjZ19nbG9iYWxfbWVtX25ldyhjcHVfZW52
LAorICAgICAgICAgICAgb2Zmc2V0b2YoQ1BVSGV4YWdvblN0YXRlLCBtZW1fbG9nX3N0b3Jlc1tp
XS53aWR0aCksCisgICAgICAgICAgICBzdG9yZV93aWR0aF9uYW1lc1tpXSk7CisKKyAgICAgICAg
c25wcmludGYoc3RvcmVfdmFsMzJfbmFtZXNbaV0sIE5BTUVfTEVOLCAic3RvcmVfdmFsMzJfJWQi
LCBpKTsKKyAgICAgICAgaGV4X3N0b3JlX3ZhbDMyW2ldID0gdGNnX2dsb2JhbF9tZW1fbmV3KGNw
dV9lbnYsCisgICAgICAgICAgICBvZmZzZXRvZihDUFVIZXhhZ29uU3RhdGUsIG1lbV9sb2dfc3Rv
cmVzW2ldLmRhdGEzMiksCisgICAgICAgICAgICBzdG9yZV92YWwzMl9uYW1lc1tpXSk7CisKKyAg
ICAgICAgc25wcmludGYoc3RvcmVfdmFsNjRfbmFtZXNbaV0sIE5BTUVfTEVOLCAic3RvcmVfdmFs
NjRfJWQiLCBpKTsKKyAgICAgICAgaGV4X3N0b3JlX3ZhbDY0W2ldID0gdGNnX2dsb2JhbF9tZW1f
bmV3X2k2NChjcHVfZW52LAorICAgICAgICAgICAgb2Zmc2V0b2YoQ1BVSGV4YWdvblN0YXRlLCBt
ZW1fbG9nX3N0b3Jlc1tpXS5kYXRhNjQpLAorICAgICAgICAgICAgc3RvcmVfdmFsNjRfbmFtZXNb
aV0pOworICAgIH0KK30KLS0gCjIuNy40Cgo=

