Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id 4EFD7275D58
	for <lists+qemu-devel@lfdr.de>; Wed, 23 Sep 2020 18:26:08 +0200 (CEST)
Received: from localhost ([::1]:53070 helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>)
	id 1kL7ap-0002Wr-6j
	for lists+qemu-devel@lfdr.de; Wed, 23 Sep 2020 12:26:07 -0400
Received: from eggs.gnu.org ([2001:470:142:3::10]:47464)
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <stefanha@redhat.com>)
 id 1kL7N3-00046S-Ck
 for qemu-devel@nongnu.org; Wed, 23 Sep 2020 12:11:54 -0400
Received: from us-smtp-delivery-124.mimecast.com ([216.205.24.124]:31431)
 by eggs.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_CBC_SHA1:256)
 (Exim 4.90_1) (envelope-from <stefanha@redhat.com>)
 id 1kL7Mw-0006Kp-4F
 for qemu-devel@nongnu.org; Wed, 23 Sep 2020 12:11:53 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1600877503;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=nV8mmOqfFJScAU2+iT7STDuUWAxEjVU5Ot+vd14N2BE=;
 b=FEJ6ds73FRzzVz+oLjflGacRqJC35x7WInuCDugIkxCY0/xVpeNfBQqSfOzZvGrJ02bpSq
 2dorIs9rcW0CyDlKhv5qm4vV2JWING108LaPvA6BJJV/Um45kU5Oh3VHpNpCyINSD/ibsD
 +JGRvsubmQqBG8F+KscbdX4xMdeE3+g=
Received: from mimecast-mx01.redhat.com (mimecast-mx01.redhat.com
 [209.132.183.4]) (Using TLS) by relay.mimecast.com with ESMTP id
 us-mta-87-v2i0xV1uM6CRQdVWy3rI1w-1; Wed, 23 Sep 2020 12:11:38 -0400
X-MC-Unique: v2i0xV1uM6CRQdVWy3rI1w-1
Received: from smtp.corp.redhat.com (int-mx03.intmail.prod.int.phx2.redhat.com
 [10.5.11.13])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mimecast-mx01.redhat.com (Postfix) with ESMTPS id D78C3186DD29;
 Wed, 23 Sep 2020 16:11:37 +0000 (UTC)
Received: from localhost (ovpn-113-77.ams2.redhat.com [10.36.113.77])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 4311073668;
 Wed, 23 Sep 2020 16:11:33 +0000 (UTC)
From: Stefan Hajnoczi <stefanha@redhat.com>
To: qemu-devel@nongnu.org,
	Peter Maydell <peter.maydell@linaro.org>
Subject: [PULL 13/13] qemu/atomic.h: rename atomic_ to qatomic_
Date: Wed, 23 Sep 2020 17:10:31 +0100
Message-Id: <20200923161031.69474-14-stefanha@redhat.com>
In-Reply-To: <20200923161031.69474-1-stefanha@redhat.com>
References: <20200923161031.69474-1-stefanha@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.13
Authentication-Results: relay.mimecast.com;
 auth=pass smtp.auth=CUSA124A263 smtp.mailfrom=stefanha@redhat.com
X-Mimecast-Spam-Score: 0
X-Mimecast-Originator: redhat.com
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: base64
Received-SPF: pass client-ip=216.205.24.124; envelope-from=stefanha@redhat.com;
 helo=us-smtp-delivery-124.mimecast.com
X-detected-operating-system: by eggs.gnu.org: First seen = 2020/09/22 23:02:20
X-ACL-Warn: Detected OS   = Linux 2.2.x-3.x [generic] [fuzzy]
X-Spam_score_int: -32
X-Spam_score: -3.3
X-Spam_bar: ---
X-Spam_report: (-3.3 / 5.0 requ) BAYES_00=-1.9, DKIMWL_WL_HIGH=-1.228,
 DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, DKIM_VALID_EF=-0.1,
 RCVD_IN_DNSWL_NONE=-0.0001, RCVD_IN_MSPIKE_H5=0.001, RCVD_IN_MSPIKE_WL=0.001,
 SPF_HELO_NONE=0.001, SPF_PASS=-0.001 autolearn=unavailable autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Cc: =?UTF-8?q?Philippe=20Mathieu-Daud=C3=A9?= <philmd@redhat.com>,
 Stefan Hajnoczi <stefanha@redhat.com>,
 "Dr. David Alan Gilbert" <dgilbert@redhat.com>, qemu-block@nongnu.org,
 Paolo Bonzini <pbonzini@redhat.com>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: "Qemu-devel" <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>

Y2xhbmcncyBDMTEgYXRvbWljX2ZldGNoXyooKSBmdW5jdGlvbnMgb25seSB0YWtlIGEgQzExIGF0
b21pYyB0eXBlCnBvaW50ZXIgYXJndW1lbnQuIFFFTVUgdXNlcyBkaXJlY3QgdHlwZXMgKGludCwg
ZXRjKSBhbmQgdGhpcyBjYXVzZXMgYQpjb21waWxlciBlcnJvciB3aGVuIGEgUUVNVSBjb2RlIGNh
bGxzIHRoZXNlIGZ1bmN0aW9ucyBpbiBhIHNvdXJjZSBmaWxlCnRoYXQgYWxzbyBpbmNsdWRlZCA8
c3RkYXRvbWljLmg+IHZpYSBhIHN5c3RlbSBoZWFkZXIgZmlsZToKCiAgJCBDQz1jbGFuZyBDWFg9
Y2xhbmcrKyAuL2NvbmZpZ3VyZSAuLi4gJiYgbWFrZQogIC4uL3V0aWwvYXN5bmMuYzo3OToxNzog
ZXJyb3I6IGFkZHJlc3MgYXJndW1lbnQgdG8gYXRvbWljIG9wZXJhdGlvbiBtdXN0IGJlIGEgcG9p
bnRlciB0byBfQXRvbWljIHR5cGUgKCd1bnNpZ25lZCBpbnQgKicgaW52YWxpZCkKCkF2b2lkIHVz
aW5nIGF0b21pY18qKCkgbmFtZXMgaW4gUUVNVSdzIGF0b21pYy5oIHNpbmNlIHRoYXQgbmFtZXNw
YWNlIGlzCnVzZWQgYnkgPHN0ZGF0b21pYy5oPi4gUHJlZml4IFFFTVUncyBBUElzIHdpdGggJ3En
IHNvIHRoYXQgYXRvbWljLmgKYW5kIDxzdGRhdG9taWMuaD4gY2FuIGNvLWV4aXN0LiBJIGNoZWNr
ZWQgL3Vzci9pbmNsdWRlIG9uIG15IG1hY2hpbmUgYW5kCnNlYXJjaGVkIEdpdEh1YiBmb3IgZXhp
c3RpbmcgInFhdG9taWNfIiB1c2VycyBidXQgdGhlcmUgc2VlbSB0byBiZSBub25lLgoKVGhpcyBw
YXRjaCB3YXMgZ2VuZXJhdGVkIHVzaW5nOgoKICAkIGdpdCBncmVwIC1oIC1vICdcPGF0b21pY1wo
NjRcKVw/X1thLXowLTlfXVwrJyBpbmNsdWRlL3FlbXUvYXRvbWljLmggfCBcCiAgICBzb3J0IC11
ID4vdG1wL2NoYW5nZWRfaWRlbnRpZmllcnMKICAkIGZvciBpZGVudGlmaWVyIGluICQoPC90bXAv
Y2hhbmdlZF9pZGVudGlmaWVycyk7IGRvCiAgICAgICAgc2VkIC1pICJzJVw8JGlkZW50aWZpZXJc
PiVxJGlkZW50aWZpZXIlZyIgXAogICAgICAgICAgICAkKGdpdCBncmVwIC1JIC1sICJcPCRpZGVu
dGlmaWVyXD4iKQogICAgZG9uZQoKSSBtYW51YWxseSBmaXhlZCBsaW5lLXdyYXAgaXNzdWVzIGFu
ZCBtaXNhbGlnbmVkIHJTVCB0YWJsZXMuCgpTaWduZWQtb2ZmLWJ5OiBTdGVmYW4gSGFqbm9jemkg
PHN0ZWZhbmhhQHJlZGhhdC5jb20+ClJldmlld2VkLWJ5OiBQaGlsaXBwZSBNYXRoaWV1LURhdWTD
qSA8cGhpbG1kQHJlZGhhdC5jb20+CkFja2VkLWJ5OiBQYW9sbyBCb256aW5pIDxwYm9uemluaUBy
ZWRoYXQuY29tPgpNZXNzYWdlLUlkOiA8MjAyMDA5MjMxMDU2NDYuNDc4NjQtMS1zdGVmYW5oYUBy
ZWRoYXQuY29tPgotLS0KIGluY2x1ZGUvcWVtdS9hdG9taWMuaCAgICAgICAgICAgICAgICAgICAg
ICAgICB8IDI0OCArKysrKysrKystLS0tLS0tLS0KIGRvY3MvZGV2ZWwvbG9ja2NudC50eHQgICAg
ICAgICAgICAgICAgICAgICAgICB8ICAgOCArLQogZG9jcy9kZXZlbC9yY3UudHh0ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHwgIDM0ICstLQogYWNjZWwvdGNnL2F0b21pY190ZW1wbGF0ZS5o
ICAgICAgICAgICAgICAgICAgIHwgIDIwICstCiBpbmNsdWRlL2Jsb2NrL2Fpby13YWl0LmggICAg
ICAgICAgICAgICAgICAgICAgfCAgIDQgKy0KIGluY2x1ZGUvYmxvY2svYWlvLmggICAgICAgICAg
ICAgICAgICAgICAgICAgICB8ICAgOCArLQogaW5jbHVkZS9leGVjL2NwdV9sZHN0LmggICAgICAg
ICAgICAgICAgICAgICAgIHwgICAyICstCiBpbmNsdWRlL2V4ZWMvZXhlYy1hbGwuaCAgICAgICAg
ICAgICAgICAgICAgICAgfCAgIDYgKy0KIGluY2x1ZGUvZXhlYy9sb2cuaCAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB8ICAgNiArLQogaW5jbHVkZS9leGVjL21lbW9yeS5oICAgICAgICAgICAg
ICAgICAgICAgICAgIHwgICAyICstCiBpbmNsdWRlL2V4ZWMvcmFtX2FkZHIuaCAgICAgICAgICAg
ICAgICAgICAgICAgfCAgMjYgKy0KIGluY2x1ZGUvZXhlYy9yYW1saXN0LmggICAgICAgICAgICAg
ICAgICAgICAgICB8ICAgMiArLQogaW5jbHVkZS9leGVjL3RiLWxvb2t1cC5oICAgICAgICAgICAg
ICAgICAgICAgIHwgICA0ICstCiBpbmNsdWRlL2h3L2NvcmUvY3B1LmggICAgICAgICAgICAgICAg
ICAgICAgICAgfCAgIDIgKy0KIGluY2x1ZGUvcWVtdS9hdG9taWMxMjguaCAgICAgICAgICAgICAg
ICAgICAgICB8ICAgNiArLQogaW5jbHVkZS9xZW11L2JpdG9wcy5oICAgICAgICAgICAgICAgICAg
ICAgICAgIHwgICAyICstCiBpbmNsdWRlL3FlbXUvY29yb3V0aW5lLmggICAgICAgICAgICAgICAg
ICAgICAgfCAgIDIgKy0KIGluY2x1ZGUvcWVtdS9sb2cuaCAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB8ICAgNiArLQogaW5jbHVkZS9xZW11L3F1ZXVlLmggICAgICAgICAgICAgICAgICAgICAg
ICAgIHwgICA3ICstCiBpbmNsdWRlL3FlbXUvcmN1LmggICAgICAgICAgICAgICAgICAgICAgICAg
ICAgfCAgMTAgKy0KIGluY2x1ZGUvcWVtdS9yY3VfcXVldWUuaCAgICAgICAgICAgICAgICAgICAg
ICB8IDEwMCArKystLS0tCiBpbmNsdWRlL3FlbXUvc2VxbG9jay5oICAgICAgICAgICAgICAgICAg
ICAgICAgfCAgIDggKy0KIGluY2x1ZGUvcWVtdS9zdGF0czY0LmggICAgICAgICAgICAgICAgICAg
ICAgICB8ICAyOCArLQogaW5jbHVkZS9xZW11L3RocmVhZC5oICAgICAgICAgICAgICAgICAgICAg
ICAgIHwgIDI0ICstCiAuLi4vaW5maW5pYmFuZC9ody92bXdfcHZyZG1hL3B2cmRtYV9yaW5nLmgg
ICAgfCAgMTQgKy0KIGxpbnV4LXVzZXIvcWVtdS5oICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB8ICAgMiArLQogdGNnL2kzODYvdGNnLXRhcmdldC5oICAgICAgICAgICAgICAgICAgICAgICAg
IHwgICAyICstCiB0Y2cvczM5MC90Y2ctdGFyZ2V0LmggICAgICAgICAgICAgICAgICAgICAgICAg
fCAgIDIgKy0KIHRjZy90Y2kvdGNnLXRhcmdldC5oICAgICAgICAgICAgICAgICAgICAgICAgICB8
ICAgMiArLQogYWNjZWwva3ZtL2t2bS1hbGwuYyAgICAgICAgICAgICAgICAgICAgICAgICAgIHwg
IDEyICstCiBhY2NlbC90Y2cvY3B1LWV4ZWMuYyAgICAgICAgICAgICAgICAgICAgICAgICAgfCAg
MTUgKy0KIGFjY2VsL3RjZy9jcHV0bGIuYyAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAy
NCArLQogYWNjZWwvdGNnL3RjZy1hbGwuYyAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAy
ICstCiBhY2NlbC90Y2cvdHJhbnNsYXRlLWFsbC5jICAgICAgICAgICAgICAgICAgICAgfCAgNTUg
KystLQogYXVkaW8vamFja2F1ZGlvLmMgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDE4
ICstCiBibG9jay5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDQg
Ky0KIGJsb2NrL2Jsb2NrLWJhY2tlbmQuYyAgICAgICAgICAgICAgICAgICAgICAgICB8ICAxNSAr
LQogYmxvY2svaW8uYyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDQ4ICsr
LS0KIGJsb2NrL25mcy5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgMiAr
LQogYmxvY2svc2hlZXBkb2cuYyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAyICst
CiBibG9jay90aHJvdHRsZS1ncm91cHMuYyAgICAgICAgICAgICAgICAgICAgICAgfCAgMTIgKy0K
IGJsb2NrL3Rocm90dGxlLmMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgNCArLQog
YmxvY2tkZXYuYyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAyICstCiBi
bG9ja2pvYi5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDIgKy0KIGNv
bnRyaWIvbGlidmhvc3QtdXNlci9saWJ2aG9zdC11c2VyLmMgICAgICAgICB8ICAgMiArLQogY3B1
cy1jb21tb24uYyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDI2ICstCiBkdW1w
L2R1bXAuYyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDggKy0KIGV4ZWMu
YyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICA0OSArKy0tCiBody9j
b3JlL2NwdS5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDYgKy0KIGh3L2Rp
c3BsYXkvcXhsLmMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgNCArLQogaHcvaHlw
ZXJ2L2h5cGVydi5jICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDEwICstCiBody9oeXBl
cnYvdm1idXMuYyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDIgKy0KIGh3L2kzODYv
eGVuL3hlbi1odm0uYyAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgMiArLQogaHcvaW50Yy9y
eF9pY3UuYyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDEyICstCiBody9pbnRjL3Np
Zml2ZV9wbGljLmMgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDQgKy0KIGh3L21pc2MvZWR1
LmMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAxNiArLQogaHcvbmV0L3ZpcnRp
by1uZXQuYyAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDEwICstCiBody9yZG1hL3JkbWFf
YmFja2VuZC5jICAgICAgICAgICAgICAgICAgICAgICAgfCAgMTggKy0KIGh3L3JkbWEvcmRtYV9y
bS5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgMiArLQogaHcvcmRtYS92bXcvcHZy
ZG1hX2Rldl9yaW5nLmMgICAgICAgICAgICAgICAgIHwgICA0ICstCiBody9zMzkweC9zMzkwLXBj
aS1idXMuYyAgICAgICAgICAgICAgICAgICAgICAgfCAgIDIgKy0KIGh3L3MzOTB4L3ZpcnRpby1j
Y3cuYyAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgMiArLQogaHcvdmlydGlvL3Zob3N0LmMg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAyICstCiBody92aXJ0aW8vdmlydGlvLW1t
aW8uYyAgICAgICAgICAgICAgICAgICAgICAgfCAgIDYgKy0KIGh3L3ZpcnRpby92aXJ0aW8tcGNp
LmMgICAgICAgICAgICAgICAgICAgICAgICB8ICAgNiArLQogaHcvdmlydGlvL3ZpcnRpby5jICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDE2ICstCiBody94dGVuc2EvcGljX2NwdS5jICAg
ICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDQgKy0KIGlvdGhyZWFkLmMgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB8ICAgNiArLQogbGludXgtdXNlci9ocHBhL2NwdV9sb29w
LmMgICAgICAgICAgICAgICAgICAgIHwgIDExICstCiBsaW51eC11c2VyL3NpZ25hbC5jICAgICAg
ICAgICAgICAgICAgICAgICAgICAgfCAgIDggKy0KIG1pZ3JhdGlvbi9jb2xvLWZhaWxvdmVyLmMg
ICAgICAgICAgICAgICAgICAgICB8ICAgNCArLQogbWlncmF0aW9uL21pZ3JhdGlvbi5jICAgICAg
ICAgICAgICAgICAgICAgICAgIHwgICA4ICstCiBtaWdyYXRpb24vbXVsdGlmZC5jICAgICAgICAg
ICAgICAgICAgICAgICAgICAgfCAgMTggKy0KIG1pZ3JhdGlvbi9wb3N0Y29weS1yYW0uYyAgICAg
ICAgICAgICAgICAgICAgICB8ICAzNCArLS0KIG1pZ3JhdGlvbi9yZG1hLmMgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB8ICAzNCArLS0KIG1vbml0b3IvaG1wLmMgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB8ICAgNiArLQogbW9uaXRvci9taXNjLmMgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHwgICAyICstCiBtb25pdG9yL21vbml0b3IuYyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgfCAgIDYgKy0KIHFlbXUtbmJkLmMgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB8ICAgMiArLQogcWdhL2NvbW1hbmRzLmMgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHwgIDEyICstCiBxb20vb2JqZWN0LmMgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgfCAgMjAgKy0KIHNjc2kvcWVtdS1wci1oZWxwZXIuYyAgICAgICAgICAgICAg
ICAgICAgICAgICB8ICAgNCArLQogc29mdG1tdS9jcHUtdGhyb3R0bGUuYyAgICAgICAgICAgICAg
ICAgICAgICAgIHwgIDEwICstCiBzb2Z0bW11L2NwdXMuYyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgfCAgNDIgKy0tCiBzb2Z0bW11L21lbW9yeS5jICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgfCAgIDYgKy0KIHNvZnRtbXUvdmwuYyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB8ICAgMiArLQogdGFyZ2V0L2FybS9tdGVfaGVscGVyLmMgICAgICAgICAgICAgICAg
ICAgICAgIHwgICA2ICstCiB0YXJnZXQvaHBwYS9vcF9oZWxwZXIuYyAgICAgICAgICAgICAgICAg
ICAgICAgfCAgIDIgKy0KIHRhcmdldC9pMzg2L21lbV9oZWxwZXIuYyAgICAgICAgICAgICAgICAg
ICAgICB8ICAgMiArLQogdGFyZ2V0L2kzODYvd2hweC1hbGwuYyAgICAgICAgICAgICAgICAgICAg
ICAgIHwgICA2ICstCiB0YXJnZXQvcmlzY3YvY3B1X2hlbHBlci5jICAgICAgICAgICAgICAgICAg
ICAgfCAgIDIgKy0KIHRhcmdldC9zMzkweC9tZW1faGVscGVyLmMgICAgICAgICAgICAgICAgICAg
ICB8ICAgNCArLQogdGFyZ2V0L3h0ZW5zYS9leGNfaGVscGVyLmMgICAgICAgICAgICAgICAgICAg
IHwgICA0ICstCiB0YXJnZXQveHRlbnNhL29wX2hlbHBlci5jICAgICAgICAgICAgICAgICAgICAg
fCAgIDIgKy0KIHRjZy90Y2cuYyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8
ICA1OCArKy0tCiB0Y2cvdGNpLmMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
fCAgIDIgKy0KIHRlc3RzL2F0b21pYzY0LWJlbmNoLmMgICAgICAgICAgICAgICAgICAgICAgICB8
ICAxNCArLQogdGVzdHMvYXRvbWljX2FkZC1iZW5jaC5jICAgICAgICAgICAgICAgICAgICAgIHwg
IDE0ICstCiB0ZXN0cy9pb3RocmVhZC5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAg
IDIgKy0KIHRlc3RzL3FodC1iZW5jaC5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAx
MiArLQogdGVzdHMvcmN1dG9ydHVyZS5jICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDI0
ICstCiB0ZXN0cy90ZXN0LWFpby1tdWx0aXRocmVhZC5jICAgICAgICAgICAgICAgICAgfCAgNTIg
KystLQogdGVzdHMvdGVzdC1sb2dnaW5nLmMgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICA0
ICstCiB0ZXN0cy90ZXN0LXJjdS1saXN0LmMgICAgICAgICAgICAgICAgICAgICAgICAgfCAgMzgg
Ky0tCiB0ZXN0cy90ZXN0LXRocmVhZC1wb29sLmMgICAgICAgICAgICAgICAgICAgICAgfCAgMTAg
Ky0KIHV0aWwvYWlvLXBvc2l4LmMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAxNCAr
LQogdXRpbC9haW8td2FpdC5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAyICst
CiB1dGlsL2Fpby13aW4zMi5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDUgKy0K
IHV0aWwvYXN5bmMuYyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAyOCArLQog
dXRpbC9hdG9taWM2NC5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDEwICstCiB1
dGlsL2JpdG1hcC5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgMTQgKy0KIHV0
aWwvY2FjaGVpbmZvLmMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgMiArLQogdXRp
bC9mZG1vbi1lcG9sbC5jICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICA0ICstCiB1dGls
L2ZkbW9uLWlvX3VyaW5nLmMgICAgICAgICAgICAgICAgICAgICAgICAgfCAgMTIgKy0KIHV0aWwv
bG9ja2NudC5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICA1MiArKy0tCiB1dGls
L2xvZy5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgMTAgKy0KIHV0aWwv
cWVtdS1jb3JvdXRpbmUtbG9jay5jICAgICAgICAgICAgICAgICAgICB8ICAxOCArLQogdXRpbC9x
ZW11LWNvcm91dGluZS1zbGVlcC5jICAgICAgICAgICAgICAgICAgIHwgICA0ICstCiB1dGlsL3Fl
bXUtY29yb3V0aW5lLmMgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDYgKy0KIHV0aWwvcWVt
dS1zb2NrZXRzLmMgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgNCArLQogdXRpbC9xZW11
LXRocmVhZC1wb3NpeC5jICAgICAgICAgICAgICAgICAgICAgIHwgIDEyICstCiB1dGlsL3FlbXUt
dGhyZWFkLXdpbjMyLmMgICAgICAgICAgICAgICAgICAgICAgfCAgMTIgKy0KIHV0aWwvcWVtdS10
aW1lci5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAxMiArLQogdXRpbC9xaHQuYyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDU3ICsrLS0KIHV0aWwvcXNwLmMg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICA1MCArKy0tCiB1dGlsL3JjdS5j
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgMzYgKy0tCiB1dGlsL3N0YXRz
NjQuYyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgMzQgKy0tCiBkb2NzL2RldmVs
L2F0b21pY3MucnN0ICAgICAgICAgICAgICAgICAgICAgICAgfCAxMzQgKysrKystLS0tLQogc2Ny
aXB0cy9rZXJuZWwtZG9jICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAyICstCiB0Y2cv
YWFyY2g2NC90Y2ctdGFyZ2V0LmMuaW5jICAgICAgICAgICAgICAgICAgfCAgIDIgKy0KIHRjZy9t
aXBzL3RjZy10YXJnZXQuYy5pbmMgICAgICAgICAgICAgICAgICAgICB8ICAgMiArLQogdGNnL3Bw
Yy90Y2ctdGFyZ2V0LmMuaW5jICAgICAgICAgICAgICAgICAgICAgIHwgICA2ICstCiB0Y2cvc3Bh
cmMvdGNnLXRhcmdldC5jLmluYyAgICAgICAgICAgICAgICAgICAgfCAgIDUgKy0KIDEzMyBmaWxl
cyBjaGFuZ2VkLCAxMDQxIGluc2VydGlvbnMoKyksIDEwMTggZGVsZXRpb25zKC0pCgpkaWZmIC0t
Z2l0IGEvaW5jbHVkZS9xZW11L2F0b21pYy5oIGIvaW5jbHVkZS9xZW11L2F0b21pYy5oCmluZGV4
IGZmNzJkYjUxMTUuLmMxZDIxMWEzNTEgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvcWVtdS9hdG9taWMu
aAorKysgYi9pbmNsdWRlL3FlbXUvYXRvbWljLmgKQEAgLTEyNSw0OSArMTI1LDQ5IEBACiAgKiBu
byBlZmZlY3Qgb24gdGhlIGdlbmVyYXRlZCBjb2RlIGJ1dCBub3QgdXNpbmcgdGhlIGF0b21pYyBw
cmltaXRpdmVzCiAgKiB3aWxsIGdldCBmbGFnZ2VkIGJ5IHNhbml0aXplcnMgYXMgYSB2aW9sYXRp
b24uCiAgKi8KLSNkZWZpbmUgYXRvbWljX3JlYWRfX25vY2hlY2socHRyKSBcCisjZGVmaW5lIHFh
dG9taWNfcmVhZF9fbm9jaGVjayhwdHIpIFwKICAgICBfX2F0b21pY19sb2FkX24ocHRyLCBfX0FU
T01JQ19SRUxBWEVEKQogCi0jZGVmaW5lIGF0b21pY19yZWFkKHB0cikgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBcCi0gICAgKHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBcCisjZGVmaW5lIHFhdG9taWNfcmVhZChwdHIpICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgXAorICAgICh7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIFwKICAgICBRRU1VX0JVSUxEX0JVR19PTihzaXplb2YoKnB0cikgPiBB
VE9NSUNfUkVHX1NJWkUpOyBcCi0gICAgYXRvbWljX3JlYWRfX25vY2hlY2socHRyKTsgICAgICAg
ICAgICAgICAgICAgICAgICBcCisgICAgcWF0b21pY19yZWFkX19ub2NoZWNrKHB0cik7ICAgICAg
ICAgICAgICAgICAgICAgICAgXAogICAgIH0pCiAKLSNkZWZpbmUgYXRvbWljX3NldF9fbm9jaGVj
ayhwdHIsIGkpIFwKKyNkZWZpbmUgcWF0b21pY19zZXRfX25vY2hlY2socHRyLCBpKSBcCiAgICAg
X19hdG9taWNfc3RvcmVfbihwdHIsIGksIF9fQVRPTUlDX1JFTEFYRUQpCiAKLSNkZWZpbmUgYXRv
bWljX3NldChwdHIsIGkpICBkbyB7ICAgICAgICAgICAgICAgICAgICAgIFwKKyNkZWZpbmUgcWF0
b21pY19zZXQocHRyLCBpKSAgZG8geyAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgUUVNVV9C
VUlMRF9CVUdfT04oc2l6ZW9mKCpwdHIpID4gQVRPTUlDX1JFR19TSVpFKTsgXAotICAgIGF0b21p
Y19zZXRfX25vY2hlY2socHRyLCBpKTsgICAgICAgICAgICAgICAgICAgICAgXAorICAgIHFhdG9t
aWNfc2V0X19ub2NoZWNrKHB0ciwgaSk7ICAgICAgICAgICAgICAgICAgICAgIFwKIH0gd2hpbGUo
MCkKIAogLyogU2VlIGFib3ZlOiBtb3N0IGNvbXBpbGVycyBjdXJyZW50bHkgdHJlYXQgY29uc3Vt
ZSBhbmQgYWNxdWlyZSB0aGUKLSAqIHNhbWUsIGJ1dCB0aGlzIHNsb3dzIGRvd24gYXRvbWljX3Jj
dV9yZWFkIHVubmVjZXNzYXJpbHkuCisgKiBzYW1lLCBidXQgdGhpcyBzbG93cyBkb3duIHFhdG9t
aWNfcmN1X3JlYWQgdW5uZWNlc3NhcmlseS4KICAqLwogI2lmZGVmIF9fU0FOSVRJWkVfVEhSRUFE
X18KLSNkZWZpbmUgYXRvbWljX3JjdV9yZWFkX19ub2NoZWNrKHB0ciwgdmFscHRyKSAgICAgICAg
ICAgXAorI2RlZmluZSBxYXRvbWljX3JjdV9yZWFkX19ub2NoZWNrKHB0ciwgdmFscHRyKSAgICAg
ICAgICAgXAogICAgIF9fYXRvbWljX2xvYWQocHRyLCB2YWxwdHIsIF9fQVRPTUlDX0NPTlNVTUUp
OwogI2Vsc2UKLSNkZWZpbmUgYXRvbWljX3JjdV9yZWFkX19ub2NoZWNrKHB0ciwgdmFscHRyKSAg
ICAgICAgICAgXAotICAgIF9fYXRvbWljX2xvYWQocHRyLCB2YWxwdHIsIF9fQVRPTUlDX1JFTEFY
RUQpOyAgICAgICBcCisjZGVmaW5lIHFhdG9taWNfcmN1X3JlYWRfX25vY2hlY2socHRyLCB2YWxw
dHIpICAgICAgICAgICBcCisgICAgX19hdG9taWNfbG9hZChwdHIsIHZhbHB0ciwgX19BVE9NSUNf
UkVMQVhFRCk7ICAgICAgICBcCiAgICAgc21wX3JlYWRfYmFycmllcl9kZXBlbmRzKCk7CiAjZW5k
aWYKIAotI2RlZmluZSBhdG9taWNfcmN1X3JlYWQocHRyKSAgICAgICAgICAgICAgICAgICAgICAg
ICAgXAotICAgICh7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXAorI2RlZmluZSBxYXRvbWljX3JjdV9yZWFkKHB0cikgICAgICAgICAgICAgICAgICAgICAg
ICAgIFwKKyAgICAoeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBcCiAgICAgUUVNVV9CVUlMRF9CVUdfT04oc2l6ZW9mKCpwdHIpID4gQVRPTUlDX1JFR19T
SVpFKTsgXAotICAgIHR5cGVvZl9zdHJpcF9xdWFsKCpwdHIpIF92YWw7ICAgICAgICAgICAgICAg
ICAgICAgXAotICAgIGF0b21pY19yY3VfcmVhZF9fbm9jaGVjayhwdHIsICZfdmFsKTsgICAgICAg
ICAgICAgXAotICAgIF92YWw7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgXAorICAgIHR5cGVvZl9zdHJpcF9xdWFsKCpwdHIpIF92YWw7ICAgICAgICAgICAgICAg
ICAgICAgIFwKKyAgICBxYXRvbWljX3JjdV9yZWFkX19ub2NoZWNrKHB0ciwgJl92YWwpOyAgICAg
ICAgICAgICBcCisgICAgX3ZhbDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgXAogICAgIH0pCiAKLSNkZWZpbmUgYXRvbWljX3JjdV9zZXQocHRyLCBpKSBkbyB7
ICAgICAgICAgICAgICAgICAgIFwKKyNkZWZpbmUgcWF0b21pY19yY3Vfc2V0KHB0ciwgaSkgZG8g
eyAgICAgICAgICAgICAgICAgICBcCiAgICAgUUVNVV9CVUlMRF9CVUdfT04oc2l6ZW9mKCpwdHIp
ID4gQVRPTUlDX1JFR19TSVpFKTsgXAotICAgIF9fYXRvbWljX3N0b3JlX24ocHRyLCBpLCBfX0FU
T01JQ19SRUxFQVNFKTsgICAgICAgXAorICAgIF9fYXRvbWljX3N0b3JlX24ocHRyLCBpLCBfX0FU
T01JQ19SRUxFQVNFKTsgICAgICAgIFwKIH0gd2hpbGUoMCkKIAotI2RlZmluZSBhdG9taWNfbG9h
ZF9hY3F1aXJlKHB0cikgICAgICAgICAgICAgICAgICAgICAgICBcCisjZGVmaW5lIHFhdG9taWNf
bG9hZF9hY3F1aXJlKHB0cikgICAgICAgICAgICAgICAgICAgICAgIFwKICAgICAoeyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogICAgIFFFTVVfQlVJ
TERfQlVHX09OKHNpemVvZigqcHRyKSA+IEFUT01JQ19SRUdfU0laRSk7ICBcCiAgICAgdHlwZW9m
X3N0cmlwX3F1YWwoKnB0cikgX3ZhbDsgICAgICAgICAgICAgICAgICAgICAgIFwKQEAgLTE3NSw3
ICsxNzUsNyBAQAogICAgIF92YWw7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBcCiAgICAgfSkKIAotI2RlZmluZSBhdG9taWNfc3RvcmVfcmVsZWFzZShwdHIs
IGkpICBkbyB7ICAgICAgICAgICAgICBcCisjZGVmaW5lIHFhdG9taWNfc3RvcmVfcmVsZWFzZShw
dHIsIGkpICBkbyB7ICAgICAgICAgICAgIFwKICAgICBRRU1VX0JVSUxEX0JVR19PTihzaXplb2Yo
KnB0cikgPiBBVE9NSUNfUkVHX1NJWkUpOyAgXAogICAgIF9fYXRvbWljX3N0b3JlX24ocHRyLCBp
LCBfX0FUT01JQ19SRUxFQVNFKTsgICAgICAgICBcCiB9IHdoaWxlKDApCkBAIC0xODMsNTYgKzE4
Myw2MSBAQAogCiAvKiBBbGwgdGhlIHJlbWFpbmluZyBvcGVyYXRpb25zIGFyZSBmdWxseSBzZXF1
ZW50aWFsbHkgY29uc2lzdGVudCAqLwogCi0jZGVmaW5lIGF0b21pY194Y2hnX19ub2NoZWNrKHB0
ciwgaSkgICAgKHsgICAgICAgICAgICAgICAgICBcCisjZGVmaW5lIHFhdG9taWNfeGNoZ19fbm9j
aGVjayhwdHIsIGkpICAgICh7ICAgICAgICAgICAgICAgICBcCiAgICAgX19hdG9taWNfZXhjaGFu
Z2VfbihwdHIsIChpKSwgX19BVE9NSUNfU0VRX0NTVCk7ICAgICAgICBcCiB9KQogCi0jZGVmaW5l
IGF0b21pY194Y2hnKHB0ciwgaSkgICAgKHsgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisj
ZGVmaW5lIHFhdG9taWNfeGNoZyhwdHIsIGkpICAgICh7ICAgICAgICAgICAgICAgICAgICAgICAg
ICBcCiAgICAgUUVNVV9CVUlMRF9CVUdfT04oc2l6ZW9mKCpwdHIpID4gQVRPTUlDX1JFR19TSVpF
KTsgICAgICBcCi0gICAgYXRvbWljX3hjaGdfX25vY2hlY2socHRyLCBpKTsgICAgICAgICAgICAg
ICAgICAgICAgICAgICBcCisgICAgcWF0b21pY194Y2hnX19ub2NoZWNrKHB0ciwgaSk7ICAgICAg
ICAgICAgICAgICAgICAgICAgICBcCiB9KQogCiAvKiBSZXR1cm5zIHRoZSBldmVudHVhbCB2YWx1
ZSwgZmFpbGVkIG9yIG5vdCAqLwotI2RlZmluZSBhdG9taWNfY21weGNoZ19fbm9jaGVjayhwdHIs
IG9sZCwgbmV3KSAgICAoeyAgICAgICAgICAgICAgICAgICAgXAorI2RlZmluZSBxYXRvbWljX2Nt
cHhjaGdfX25vY2hlY2socHRyLCBvbGQsIG5ldykgICAgKHsgICAgICAgICAgICAgICAgICAgXAog
ICAgIHR5cGVvZl9zdHJpcF9xdWFsKCpwdHIpIF9vbGQgPSAob2xkKTsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgXAogICAgICh2b2lkKV9fYXRvbWljX2NvbXBhcmVfZXhjaGFuZ2Vfbihw
dHIsICZfb2xkLCBuZXcsIGZhbHNlLCAgICAgICAgICAgXAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgX19BVE9NSUNfU0VRX0NTVCwgX19BVE9NSUNfU0VRX0NTVCk7ICAgICAgXAogICAg
IF9vbGQ7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgXAogfSkKIAotI2RlZmluZSBhdG9taWNfY21weGNoZyhwdHIsIG9sZCwgbmV3
KSAgICAoeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorI2RlZmluZSBxYXRvbWljX2Nt
cHhjaGcocHRyLCBvbGQsIG5ldykgICAgKHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAog
ICAgIFFFTVVfQlVJTERfQlVHX09OKHNpemVvZigqcHRyKSA+IEFUT01JQ19SRUdfU0laRSk7ICAg
ICAgICAgICAgICAgICAgXAotICAgIGF0b21pY19jbXB4Y2hnX19ub2NoZWNrKHB0ciwgb2xkLCBu
ZXcpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgIHFhdG9taWNfY21weGNoZ19f
bm9jaGVjayhwdHIsIG9sZCwgbmV3KTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogfSkK
IAogLyogUHJvdmlkZSBzaG9ydGVyIG5hbWVzIGZvciBHQ0MgYXRvbWljIGJ1aWx0aW5zLCByZXR1
cm4gb2xkIHZhbHVlICovCi0jZGVmaW5lIGF0b21pY19mZXRjaF9pbmMocHRyKSAgX19hdG9taWNf
ZmV0Y2hfYWRkKHB0ciwgMSwgX19BVE9NSUNfU0VRX0NTVCkKLSNkZWZpbmUgYXRvbWljX2ZldGNo
X2RlYyhwdHIpICBfX2F0b21pY19mZXRjaF9zdWIocHRyLCAxLCBfX0FUT01JQ19TRVFfQ1NUKQor
I2RlZmluZSBxYXRvbWljX2ZldGNoX2luYyhwdHIpICBfX2F0b21pY19mZXRjaF9hZGQocHRyLCAx
LCBfX0FUT01JQ19TRVFfQ1NUKQorI2RlZmluZSBxYXRvbWljX2ZldGNoX2RlYyhwdHIpICBfX2F0
b21pY19mZXRjaF9zdWIocHRyLCAxLCBfX0FUT01JQ19TRVFfQ1NUKQogCi0jaWZuZGVmIGF0b21p
Y19mZXRjaF9hZGQKLSNkZWZpbmUgYXRvbWljX2ZldGNoX2FkZChwdHIsIG4pIF9fYXRvbWljX2Zl
dGNoX2FkZChwdHIsIG4sIF9fQVRPTUlDX1NFUV9DU1QpCi0jZGVmaW5lIGF0b21pY19mZXRjaF9z
dWIocHRyLCBuKSBfX2F0b21pY19mZXRjaF9zdWIocHRyLCBuLCBfX0FUT01JQ19TRVFfQ1NUKQot
I2RlZmluZSBhdG9taWNfZmV0Y2hfYW5kKHB0ciwgbikgX19hdG9taWNfZmV0Y2hfYW5kKHB0ciwg
biwgX19BVE9NSUNfU0VRX0NTVCkKLSNkZWZpbmUgYXRvbWljX2ZldGNoX29yKHB0ciwgbikgIF9f
YXRvbWljX2ZldGNoX29yKHB0ciwgbiwgX19BVE9NSUNfU0VRX0NTVCkKLSNkZWZpbmUgYXRvbWlj
X2ZldGNoX3hvcihwdHIsIG4pIF9fYXRvbWljX2ZldGNoX3hvcihwdHIsIG4sIF9fQVRPTUlDX1NF
UV9DU1QpCi0jZW5kaWYKKyNkZWZpbmUgcWF0b21pY19mZXRjaF9hZGQocHRyLCBuKSBfX2F0b21p
Y19mZXRjaF9hZGQocHRyLCBuLCBfX0FUT01JQ19TRVFfQ1NUKQorI2RlZmluZSBxYXRvbWljX2Zl
dGNoX3N1YihwdHIsIG4pIF9fYXRvbWljX2ZldGNoX3N1YihwdHIsIG4sIF9fQVRPTUlDX1NFUV9D
U1QpCisjZGVmaW5lIHFhdG9taWNfZmV0Y2hfYW5kKHB0ciwgbikgX19hdG9taWNfZmV0Y2hfYW5k
KHB0ciwgbiwgX19BVE9NSUNfU0VRX0NTVCkKKyNkZWZpbmUgcWF0b21pY19mZXRjaF9vcihwdHIs
IG4pICBfX2F0b21pY19mZXRjaF9vcihwdHIsIG4sIF9fQVRPTUlDX1NFUV9DU1QpCisjZGVmaW5l
IHFhdG9taWNfZmV0Y2hfeG9yKHB0ciwgbikgX19hdG9taWNfZmV0Y2hfeG9yKHB0ciwgbiwgX19B
VE9NSUNfU0VRX0NTVCkKIAotI2RlZmluZSBhdG9taWNfaW5jX2ZldGNoKHB0cikgICAgX19hdG9t
aWNfYWRkX2ZldGNoKHB0ciwgMSwgX19BVE9NSUNfU0VRX0NTVCkKLSNkZWZpbmUgYXRvbWljX2Rl
Y19mZXRjaChwdHIpICAgIF9fYXRvbWljX3N1Yl9mZXRjaChwdHIsIDEsIF9fQVRPTUlDX1NFUV9D
U1QpCi0jZGVmaW5lIGF0b21pY19hZGRfZmV0Y2gocHRyLCBuKSBfX2F0b21pY19hZGRfZmV0Y2go
cHRyLCBuLCBfX0FUT01JQ19TRVFfQ1NUKQotI2RlZmluZSBhdG9taWNfc3ViX2ZldGNoKHB0ciwg
bikgX19hdG9taWNfc3ViX2ZldGNoKHB0ciwgbiwgX19BVE9NSUNfU0VRX0NTVCkKLSNkZWZpbmUg
YXRvbWljX2FuZF9mZXRjaChwdHIsIG4pIF9fYXRvbWljX2FuZF9mZXRjaChwdHIsIG4sIF9fQVRP
TUlDX1NFUV9DU1QpCi0jZGVmaW5lIGF0b21pY19vcl9mZXRjaChwdHIsIG4pICBfX2F0b21pY19v
cl9mZXRjaChwdHIsIG4sIF9fQVRPTUlDX1NFUV9DU1QpCi0jZGVmaW5lIGF0b21pY194b3JfZmV0
Y2gocHRyLCBuKSBfX2F0b21pY194b3JfZmV0Y2gocHRyLCBuLCBfX0FUT01JQ19TRVFfQ1NUKQor
I2RlZmluZSBxYXRvbWljX2luY19mZXRjaChwdHIpICAgIF9fYXRvbWljX2FkZF9mZXRjaChwdHIs
IDEsIF9fQVRPTUlDX1NFUV9DU1QpCisjZGVmaW5lIHFhdG9taWNfZGVjX2ZldGNoKHB0cikgICAg
X19hdG9taWNfc3ViX2ZldGNoKHB0ciwgMSwgX19BVE9NSUNfU0VRX0NTVCkKKyNkZWZpbmUgcWF0
b21pY19hZGRfZmV0Y2gocHRyLCBuKSBfX2F0b21pY19hZGRfZmV0Y2gocHRyLCBuLCBfX0FUT01J
Q19TRVFfQ1NUKQorI2RlZmluZSBxYXRvbWljX3N1Yl9mZXRjaChwdHIsIG4pIF9fYXRvbWljX3N1
Yl9mZXRjaChwdHIsIG4sIF9fQVRPTUlDX1NFUV9DU1QpCisjZGVmaW5lIHFhdG9taWNfYW5kX2Zl
dGNoKHB0ciwgbikgX19hdG9taWNfYW5kX2ZldGNoKHB0ciwgbiwgX19BVE9NSUNfU0VRX0NTVCkK
KyNkZWZpbmUgcWF0b21pY19vcl9mZXRjaChwdHIsIG4pICBfX2F0b21pY19vcl9mZXRjaChwdHIs
IG4sIF9fQVRPTUlDX1NFUV9DU1QpCisjZGVmaW5lIHFhdG9taWNfeG9yX2ZldGNoKHB0ciwgbikg
X19hdG9taWNfeG9yX2ZldGNoKHB0ciwgbiwgX19BVE9NSUNfU0VRX0NTVCkKIAogLyogQW5kIGV2
ZW4gc2hvcnRlciBuYW1lcyB0aGF0IHJldHVybiB2b2lkLiAgKi8KLSNkZWZpbmUgYXRvbWljX2lu
YyhwdHIpICAgICgodm9pZCkgX19hdG9taWNfZmV0Y2hfYWRkKHB0ciwgMSwgX19BVE9NSUNfU0VR
X0NTVCkpCi0jZGVmaW5lIGF0b21pY19kZWMocHRyKSAgICAoKHZvaWQpIF9fYXRvbWljX2ZldGNo
X3N1YihwdHIsIDEsIF9fQVRPTUlDX1NFUV9DU1QpKQotI2RlZmluZSBhdG9taWNfYWRkKHB0ciwg
bikgKCh2b2lkKSBfX2F0b21pY19mZXRjaF9hZGQocHRyLCBuLCBfX0FUT01JQ19TRVFfQ1NUKSkK
LSNkZWZpbmUgYXRvbWljX3N1YihwdHIsIG4pICgodm9pZCkgX19hdG9taWNfZmV0Y2hfc3ViKHB0
ciwgbiwgX19BVE9NSUNfU0VRX0NTVCkpCi0jZGVmaW5lIGF0b21pY19hbmQocHRyLCBuKSAoKHZv
aWQpIF9fYXRvbWljX2ZldGNoX2FuZChwdHIsIG4sIF9fQVRPTUlDX1NFUV9DU1QpKQotI2RlZmlu
ZSBhdG9taWNfb3IocHRyLCBuKSAgKCh2b2lkKSBfX2F0b21pY19mZXRjaF9vcihwdHIsIG4sIF9f
QVRPTUlDX1NFUV9DU1QpKQotI2RlZmluZSBhdG9taWNfeG9yKHB0ciwgbikgKCh2b2lkKSBfX2F0
b21pY19mZXRjaF94b3IocHRyLCBuLCBfX0FUT01JQ19TRVFfQ1NUKSkKKyNkZWZpbmUgcWF0b21p
Y19pbmMocHRyKSBcCisgICAgKCh2b2lkKSBfX2F0b21pY19mZXRjaF9hZGQocHRyLCAxLCBfX0FU
T01JQ19TRVFfQ1NUKSkKKyNkZWZpbmUgcWF0b21pY19kZWMocHRyKSBcCisgICAgKCh2b2lkKSBf
X2F0b21pY19mZXRjaF9zdWIocHRyLCAxLCBfX0FUT01JQ19TRVFfQ1NUKSkKKyNkZWZpbmUgcWF0
b21pY19hZGQocHRyLCBuKSBcCisgICAgKCh2b2lkKSBfX2F0b21pY19mZXRjaF9hZGQocHRyLCBu
LCBfX0FUT01JQ19TRVFfQ1NUKSkKKyNkZWZpbmUgcWF0b21pY19zdWIocHRyLCBuKSBcCisgICAg
KCh2b2lkKSBfX2F0b21pY19mZXRjaF9zdWIocHRyLCBuLCBfX0FUT01JQ19TRVFfQ1NUKSkKKyNk
ZWZpbmUgcWF0b21pY19hbmQocHRyLCBuKSBcCisgICAgKCh2b2lkKSBfX2F0b21pY19mZXRjaF9h
bmQocHRyLCBuLCBfX0FUT01JQ19TRVFfQ1NUKSkKKyNkZWZpbmUgcWF0b21pY19vcihwdHIsIG4p
IFwKKyAgICAoKHZvaWQpIF9fYXRvbWljX2ZldGNoX29yKHB0ciwgbiwgX19BVE9NSUNfU0VRX0NT
VCkpCisjZGVmaW5lIHFhdG9taWNfeG9yKHB0ciwgbikgXAorICAgICgodm9pZCkgX19hdG9taWNf
ZmV0Y2hfeG9yKHB0ciwgbiwgX19BVE9NSUNfU0VRX0NTVCkpCiAKICNlbHNlIC8qIF9fQVRPTUlD
X1JFTEFYRUQgKi8KIApAQCAtMjcyLDcgKzI3Nyw3IEBACiAgKiBidXQgaXQgaXMgYSBmdWxsIGJh
cnJpZXIgYXQgdGhlIGhhcmR3YXJlIGxldmVsLiAgQWRkIGEgY29tcGlsZXIgYmFycmllcgogICog
dG8gbWFrZSBpdCBhIGZ1bGwgYmFycmllciBhbHNvIGF0IHRoZSBjb21waWxlciBsZXZlbC4KICAq
LwotI2RlZmluZSBhdG9taWNfeGNoZyhwdHIsIGkpICAgIChiYXJyaWVyKCksIF9fc3luY19sb2Nr
X3Rlc3RfYW5kX3NldChwdHIsIGkpKQorI2RlZmluZSBxYXRvbWljX3hjaGcocHRyLCBpKSAgICAo
YmFycmllcigpLCBfX3N5bmNfbG9ja190ZXN0X2FuZF9zZXQocHRyLCBpKSkKIAogI2VsaWYgZGVm
aW5lZChfQVJDSF9QUEMpCiAKQEAgLTMyNSwxNCArMzMwLDE0IEBACiAvKiBUaGVzZSB3aWxsIG9u
bHkgYmUgYXRvbWljIGlmIHRoZSBwcm9jZXNzb3IgZG9lcyB0aGUgZmV0Y2ggb3Igc3RvcmUKICAq
IGluIGEgc2luZ2xlIGlzc3VlIG1lbW9yeSBvcGVyYXRpb24KICAqLwotI2RlZmluZSBhdG9taWNf
cmVhZF9fbm9jaGVjayhwKSAgICgqKF9fdHlwZW9mX18oKihwKSkgdm9sYXRpbGUqKSAocCkpCi0j
ZGVmaW5lIGF0b21pY19zZXRfX25vY2hlY2socCwgaSkgKCgqKF9fdHlwZW9mX18oKihwKSkgdm9s
YXRpbGUqKSAocCkpID0gKGkpKQorI2RlZmluZSBxYXRvbWljX3JlYWRfX25vY2hlY2socCkgICAo
KihfX3R5cGVvZl9fKCoocCkpIHZvbGF0aWxlKikgKHApKQorI2RlZmluZSBxYXRvbWljX3NldF9f
bm9jaGVjayhwLCBpKSAoKCooX190eXBlb2ZfXygqKHApKSB2b2xhdGlsZSopIChwKSkgPSAoaSkp
CiAKLSNkZWZpbmUgYXRvbWljX3JlYWQocHRyKSAgICAgICBhdG9taWNfcmVhZF9fbm9jaGVjayhw
dHIpCi0jZGVmaW5lIGF0b21pY19zZXQocHRyLCBpKSAgICAgYXRvbWljX3NldF9fbm9jaGVjayhw
dHIsaSkKKyNkZWZpbmUgcWF0b21pY19yZWFkKHB0cikgICAgICAgcWF0b21pY19yZWFkX19ub2No
ZWNrKHB0cikKKyNkZWZpbmUgcWF0b21pY19zZXQocHRyLCBpKSAgICAgcWF0b21pY19zZXRfX25v
Y2hlY2socHRyLGkpCiAKIC8qKgotICogYXRvbWljX3JjdV9yZWFkIC0gcmVhZHMgYSBSQ1UtcHJv
dGVjdGVkIHBvaW50ZXIgdG8gYSBsb2NhbCB2YXJpYWJsZQorICogcWF0b21pY19yY3VfcmVhZCAt
IHJlYWRzIGEgUkNVLXByb3RlY3RlZCBwb2ludGVyIHRvIGEgbG9jYWwgdmFyaWFibGUKICAqIGlu
dG8gYSBSQ1UgcmVhZC1zaWRlIGNyaXRpY2FsIHNlY3Rpb24uIFRoZSBwb2ludGVyIGNhbiBsYXRl
ciBiZSBzYWZlbHkKICAqIGRlcmVmZXJlbmNlZCB3aXRoaW4gdGhlIGNyaXRpY2FsIHNlY3Rpb24u
CiAgKgpAQCAtMzQyLDIxICszNDcsMjEgQEAKICAqIEluc2VydHMgbWVtb3J5IGJhcnJpZXJzIG9u
IGFyY2hpdGVjdHVyZXMgdGhhdCByZXF1aXJlIHRoZW0gKGN1cnJlbnRseSBvbmx5CiAgKiBBbHBo
YSkgYW5kIGRvY3VtZW50cyB3aGljaCBwb2ludGVycyBhcmUgcHJvdGVjdGVkIGJ5IFJDVS4KICAq
Ci0gKiBhdG9taWNfcmN1X3JlYWQgYWxzbyBpbmNsdWRlcyBhIGNvbXBpbGVyIGJhcnJpZXIgdG8g
ZW5zdXJlIHRoYXQKKyAqIHFhdG9taWNfcmN1X3JlYWQgYWxzbyBpbmNsdWRlcyBhIGNvbXBpbGVy
IGJhcnJpZXIgdG8gZW5zdXJlIHRoYXQKICAqIHZhbHVlLXNwZWN1bGF0aXZlIG9wdGltaXphdGlv
bnMgKGUuZy4gVlNTOiBWYWx1ZSBTcGVjdWxhdGlvbgogICogU2NoZWR1bGluZykgZG9lcyBub3Qg
cGVyZm9ybSB0aGUgZGF0YSByZWFkIGJlZm9yZSB0aGUgcG9pbnRlciByZWFkCiAgKiBieSBzcGVj
dWxhdGluZyB0aGUgdmFsdWUgb2YgdGhlIHBvaW50ZXIuCiAgKgotICogU2hvdWxkIG1hdGNoIGF0
b21pY19yY3Vfc2V0KCksIGF0b21pY194Y2hnKCksIGF0b21pY19jbXB4Y2hnKCkuCisgKiBTaG91
bGQgbWF0Y2ggcWF0b21pY19yY3Vfc2V0KCksIHFhdG9taWNfeGNoZygpLCBxYXRvbWljX2NtcHhj
aGcoKS4KICAqLwotI2RlZmluZSBhdG9taWNfcmN1X3JlYWQocHRyKSAgICAoeyAgICAgICAgICAg
ICAgICBcCi0gICAgdHlwZW9mKCpwdHIpIF92YWwgPSBhdG9taWNfcmVhZChwdHIpOyAgICAgICAg
IFwKKyNkZWZpbmUgcWF0b21pY19yY3VfcmVhZChwdHIpICAgICh7ICAgICAgICAgICAgICAgXAor
ICAgIHR5cGVvZigqcHRyKSBfdmFsID0gcWF0b21pY19yZWFkKHB0cik7ICAgICAgICBcCiAgICAg
c21wX3JlYWRfYmFycmllcl9kZXBlbmRzKCk7ICAgICAgICAgICAgICAgICAgIFwKICAgICBfdmFs
OyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogfSkKIAogLyoqCi0g
KiBhdG9taWNfcmN1X3NldCAtIGFzc2lnbnMgKHB1YmxpY2l6ZXMpIGEgcG9pbnRlciB0byBhIG5l
dyBkYXRhIHN0cnVjdHVyZQorICogcWF0b21pY19yY3Vfc2V0IC0gYXNzaWducyAocHVibGljaXpl
cykgYSBwb2ludGVyIHRvIGEgbmV3IGRhdGEgc3RydWN0dXJlCiAgKiBtZWFudCB0byBiZSByZWFk
IGJ5IFJDVSByZWFkLXNpZGUgY3JpdGljYWwgc2VjdGlvbnMuCiAgKgogICogRG9jdW1lbnRzIHdo
aWNoIHBvaW50ZXJzIHdpbGwgYmUgZGVyZWZlcmVuY2VkIGJ5IFJDVSByZWFkLXNpZGUgY3JpdGlj
YWwKQEAgLTM2NCw2NSArMzY5LDY0IEBACiAgKiB0aGVtLiBJdCBhbHNvIG1ha2VzIHN1cmUgdGhl
IGNvbXBpbGVyIGRvZXMgbm90IHJlb3JkZXIgY29kZSBpbml0aWFsaXppbmcgdGhlCiAgKiBkYXRh
IHN0cnVjdHVyZSBiZWZvcmUgaXRzIHB1YmxpY2F0aW9uLgogICoKLSAqIFNob3VsZCBtYXRjaCBh
dG9taWNfcmN1X3JlYWQoKS4KKyAqIFNob3VsZCBtYXRjaCBxYXRvbWljX3JjdV9yZWFkKCkuCiAg
Ki8KLSNkZWZpbmUgYXRvbWljX3JjdV9zZXQocHRyLCBpKSAgZG8geyAgICAgICAgICAgICAgXAor
I2RlZmluZSBxYXRvbWljX3JjdV9zZXQocHRyLCBpKSAgZG8geyAgICAgICAgICAgICBcCiAgICAg
c21wX3dtYigpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICBhdG9t
aWNfc2V0KHB0ciwgaSk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgIHFhdG9taWNf
c2V0KHB0ciwgaSk7ICAgICAgICAgICAgICAgICAgICAgICAgICBcCiB9IHdoaWxlICgwKQogCi0j
ZGVmaW5lIGF0b21pY19sb2FkX2FjcXVpcmUocHRyKSAgICAoeyAgICAgIFwKLSAgICB0eXBlb2Yo
KnB0cikgX3ZhbCA9IGF0b21pY19yZWFkKHB0cik7ICAgXAorI2RlZmluZSBxYXRvbWljX2xvYWRf
YWNxdWlyZShwdHIpICAgICh7ICAgICBcCisgICAgdHlwZW9mKCpwdHIpIF92YWwgPSBxYXRvbWlj
X3JlYWQocHRyKTsgIFwKICAgICBzbXBfbWJfYWNxdWlyZSgpOyAgICAgICAgICAgICAgICAgICAg
ICAgXAogICAgIF92YWw7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiB9KQog
Ci0jZGVmaW5lIGF0b21pY19zdG9yZV9yZWxlYXNlKHB0ciwgaSkgIGRvIHsgIFwKKyNkZWZpbmUg
cWF0b21pY19zdG9yZV9yZWxlYXNlKHB0ciwgaSkgIGRvIHsgXAogICAgIHNtcF9tYl9yZWxlYXNl
KCk7ICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgYXRvbWljX3NldChwdHIsIGkpOyAgICAg
ICAgICAgICAgICAgICAgIFwKKyAgICBxYXRvbWljX3NldChwdHIsIGkpOyAgICAgICAgICAgICAg
ICAgICAgXAogfSB3aGlsZSAoMCkKIAotI2lmbmRlZiBhdG9taWNfeGNoZworI2lmbmRlZiBxYXRv
bWljX3hjaGcKICNpZiBkZWZpbmVkKF9fY2xhbmdfXykKLSNkZWZpbmUgYXRvbWljX3hjaGcocHRy
LCBpKSAgICBfX3N5bmNfc3dhcChwdHIsIGkpCisjZGVmaW5lIHFhdG9taWNfeGNoZyhwdHIsIGkp
ICAgIF9fc3luY19zd2FwKHB0ciwgaSkKICNlbHNlCiAvKiBfX3N5bmNfbG9ja190ZXN0X2FuZF9z
ZXQoKSBpcyBkb2N1bWVudGVkIHRvIGJlIGFuIGFjcXVpcmUgYmFycmllciBvbmx5LiAgKi8KLSNk
ZWZpbmUgYXRvbWljX3hjaGcocHRyLCBpKSAgICAoc21wX21iKCksIF9fc3luY19sb2NrX3Rlc3Rf
YW5kX3NldChwdHIsIGkpKQorI2RlZmluZSBxYXRvbWljX3hjaGcocHRyLCBpKSAgICAoc21wX21i
KCksIF9fc3luY19sb2NrX3Rlc3RfYW5kX3NldChwdHIsIGkpKQogI2VuZGlmCiAjZW5kaWYKLSNk
ZWZpbmUgYXRvbWljX3hjaGdfX25vY2hlY2sgIGF0b21pY194Y2hnCisjZGVmaW5lIHFhdG9taWNf
eGNoZ19fbm9jaGVjayAgcWF0b21pY194Y2hnCiAKIC8qIFByb3ZpZGUgc2hvcnRlciBuYW1lcyBm
b3IgR0NDIGF0b21pYyBidWlsdGlucy4gICovCi0jZGVmaW5lIGF0b21pY19mZXRjaF9pbmMocHRy
KSAgX19zeW5jX2ZldGNoX2FuZF9hZGQocHRyLCAxKQotI2RlZmluZSBhdG9taWNfZmV0Y2hfZGVj
KHB0cikgIF9fc3luY19mZXRjaF9hbmRfYWRkKHB0ciwgLTEpCisjZGVmaW5lIHFhdG9taWNfZmV0
Y2hfaW5jKHB0cikgIF9fc3luY19mZXRjaF9hbmRfYWRkKHB0ciwgMSkKKyNkZWZpbmUgcWF0b21p
Y19mZXRjaF9kZWMocHRyKSAgX19zeW5jX2ZldGNoX2FuZF9hZGQocHRyLCAtMSkKIAotI2lmbmRl
ZiBhdG9taWNfZmV0Y2hfYWRkCi0jZGVmaW5lIGF0b21pY19mZXRjaF9hZGQocHRyLCBuKSBfX3N5
bmNfZmV0Y2hfYW5kX2FkZChwdHIsIG4pCi0jZGVmaW5lIGF0b21pY19mZXRjaF9zdWIocHRyLCBu
KSBfX3N5bmNfZmV0Y2hfYW5kX3N1YihwdHIsIG4pCi0jZGVmaW5lIGF0b21pY19mZXRjaF9hbmQo
cHRyLCBuKSBfX3N5bmNfZmV0Y2hfYW5kX2FuZChwdHIsIG4pCi0jZGVmaW5lIGF0b21pY19mZXRj
aF9vcihwdHIsIG4pIF9fc3luY19mZXRjaF9hbmRfb3IocHRyLCBuKQotI2RlZmluZSBhdG9taWNf
ZmV0Y2hfeG9yKHB0ciwgbikgX19zeW5jX2ZldGNoX2FuZF94b3IocHRyLCBuKQotI2VuZGlmCisj
ZGVmaW5lIHFhdG9taWNfZmV0Y2hfYWRkKHB0ciwgbikgX19zeW5jX2ZldGNoX2FuZF9hZGQocHRy
LCBuKQorI2RlZmluZSBxYXRvbWljX2ZldGNoX3N1YihwdHIsIG4pIF9fc3luY19mZXRjaF9hbmRf
c3ViKHB0ciwgbikKKyNkZWZpbmUgcWF0b21pY19mZXRjaF9hbmQocHRyLCBuKSBfX3N5bmNfZmV0
Y2hfYW5kX2FuZChwdHIsIG4pCisjZGVmaW5lIHFhdG9taWNfZmV0Y2hfb3IocHRyLCBuKSBfX3N5
bmNfZmV0Y2hfYW5kX29yKHB0ciwgbikKKyNkZWZpbmUgcWF0b21pY19mZXRjaF94b3IocHRyLCBu
KSBfX3N5bmNfZmV0Y2hfYW5kX3hvcihwdHIsIG4pCiAKLSNkZWZpbmUgYXRvbWljX2luY19mZXRj
aChwdHIpICBfX3N5bmNfYWRkX2FuZF9mZXRjaChwdHIsIDEpCi0jZGVmaW5lIGF0b21pY19kZWNf
ZmV0Y2gocHRyKSAgX19zeW5jX2FkZF9hbmRfZmV0Y2gocHRyLCAtMSkKLSNkZWZpbmUgYXRvbWlj
X2FkZF9mZXRjaChwdHIsIG4pIF9fc3luY19hZGRfYW5kX2ZldGNoKHB0ciwgbikKLSNkZWZpbmUg
YXRvbWljX3N1Yl9mZXRjaChwdHIsIG4pIF9fc3luY19zdWJfYW5kX2ZldGNoKHB0ciwgbikKLSNk
ZWZpbmUgYXRvbWljX2FuZF9mZXRjaChwdHIsIG4pIF9fc3luY19hbmRfYW5kX2ZldGNoKHB0ciwg
bikKLSNkZWZpbmUgYXRvbWljX29yX2ZldGNoKHB0ciwgbikgX19zeW5jX29yX2FuZF9mZXRjaChw
dHIsIG4pCi0jZGVmaW5lIGF0b21pY194b3JfZmV0Y2gocHRyLCBuKSBfX3N5bmNfeG9yX2FuZF9m
ZXRjaChwdHIsIG4pCisjZGVmaW5lIHFhdG9taWNfaW5jX2ZldGNoKHB0cikgIF9fc3luY19hZGRf
YW5kX2ZldGNoKHB0ciwgMSkKKyNkZWZpbmUgcWF0b21pY19kZWNfZmV0Y2gocHRyKSAgX19zeW5j
X2FkZF9hbmRfZmV0Y2gocHRyLCAtMSkKKyNkZWZpbmUgcWF0b21pY19hZGRfZmV0Y2gocHRyLCBu
KSBfX3N5bmNfYWRkX2FuZF9mZXRjaChwdHIsIG4pCisjZGVmaW5lIHFhdG9taWNfc3ViX2ZldGNo
KHB0ciwgbikgX19zeW5jX3N1Yl9hbmRfZmV0Y2gocHRyLCBuKQorI2RlZmluZSBxYXRvbWljX2Fu
ZF9mZXRjaChwdHIsIG4pIF9fc3luY19hbmRfYW5kX2ZldGNoKHB0ciwgbikKKyNkZWZpbmUgcWF0
b21pY19vcl9mZXRjaChwdHIsIG4pIF9fc3luY19vcl9hbmRfZmV0Y2gocHRyLCBuKQorI2RlZmlu
ZSBxYXRvbWljX3hvcl9mZXRjaChwdHIsIG4pIF9fc3luY194b3JfYW5kX2ZldGNoKHB0ciwgbikK
IAotI2RlZmluZSBhdG9taWNfY21weGNoZyhwdHIsIG9sZCwgbmV3KSBfX3N5bmNfdmFsX2NvbXBh
cmVfYW5kX3N3YXAocHRyLCBvbGQsIG5ldykKLSNkZWZpbmUgYXRvbWljX2NtcHhjaGdfX25vY2hl
Y2socHRyLCBvbGQsIG5ldykgIGF0b21pY19jbXB4Y2hnKHB0ciwgb2xkLCBuZXcpCisjZGVmaW5l
IHFhdG9taWNfY21weGNoZyhwdHIsIG9sZCwgbmV3KSBcCisgICAgX19zeW5jX3ZhbF9jb21wYXJl
X2FuZF9zd2FwKHB0ciwgb2xkLCBuZXcpCisjZGVmaW5lIHFhdG9taWNfY21weGNoZ19fbm9jaGVj
ayhwdHIsIG9sZCwgbmV3KSAgcWF0b21pY19jbXB4Y2hnKHB0ciwgb2xkLCBuZXcpCiAKIC8qIEFu
ZCBldmVuIHNob3J0ZXIgbmFtZXMgdGhhdCByZXR1cm4gdm9pZC4gICovCi0jZGVmaW5lIGF0b21p
Y19pbmMocHRyKSAgICAgICAgKCh2b2lkKSBfX3N5bmNfZmV0Y2hfYW5kX2FkZChwdHIsIDEpKQot
I2RlZmluZSBhdG9taWNfZGVjKHB0cikgICAgICAgICgodm9pZCkgX19zeW5jX2ZldGNoX2FuZF9h
ZGQocHRyLCAtMSkpCi0jZGVmaW5lIGF0b21pY19hZGQocHRyLCBuKSAgICAgKCh2b2lkKSBfX3N5
bmNfZmV0Y2hfYW5kX2FkZChwdHIsIG4pKQotI2RlZmluZSBhdG9taWNfc3ViKHB0ciwgbikgICAg
ICgodm9pZCkgX19zeW5jX2ZldGNoX2FuZF9zdWIocHRyLCBuKSkKLSNkZWZpbmUgYXRvbWljX2Fu
ZChwdHIsIG4pICAgICAoKHZvaWQpIF9fc3luY19mZXRjaF9hbmRfYW5kKHB0ciwgbikpCi0jZGVm
aW5lIGF0b21pY19vcihwdHIsIG4pICAgICAgKCh2b2lkKSBfX3N5bmNfZmV0Y2hfYW5kX29yKHB0
ciwgbikpCi0jZGVmaW5lIGF0b21pY194b3IocHRyLCBuKSAgICAgKCh2b2lkKSBfX3N5bmNfZmV0
Y2hfYW5kX3hvcihwdHIsIG4pKQorI2RlZmluZSBxYXRvbWljX2luYyhwdHIpICAgICAgICAoKHZv
aWQpIF9fc3luY19mZXRjaF9hbmRfYWRkKHB0ciwgMSkpCisjZGVmaW5lIHFhdG9taWNfZGVjKHB0
cikgICAgICAgICgodm9pZCkgX19zeW5jX2ZldGNoX2FuZF9hZGQocHRyLCAtMSkpCisjZGVmaW5l
IHFhdG9taWNfYWRkKHB0ciwgbikgICAgICgodm9pZCkgX19zeW5jX2ZldGNoX2FuZF9hZGQocHRy
LCBuKSkKKyNkZWZpbmUgcWF0b21pY19zdWIocHRyLCBuKSAgICAgKCh2b2lkKSBfX3N5bmNfZmV0
Y2hfYW5kX3N1YihwdHIsIG4pKQorI2RlZmluZSBxYXRvbWljX2FuZChwdHIsIG4pICAgICAoKHZv
aWQpIF9fc3luY19mZXRjaF9hbmRfYW5kKHB0ciwgbikpCisjZGVmaW5lIHFhdG9taWNfb3IocHRy
LCBuKSAgICAgICgodm9pZCkgX19zeW5jX2ZldGNoX2FuZF9vcihwdHIsIG4pKQorI2RlZmluZSBx
YXRvbWljX3hvcihwdHIsIG4pICAgICAoKHZvaWQpIF9fc3luY19mZXRjaF9hbmRfeG9yKHB0ciwg
bikpCiAKICNlbmRpZiAvKiBfX0FUT01JQ19SRUxBWEVEICovCiAKQEAgLTQzNiwxMSArNDQwLDEx
IEBACiAvKiBUaGlzIGlzIG1vcmUgZWZmaWNpZW50IHRoYW4gYSBzdG9yZSBwbHVzIGEgZmVuY2Uu
ICAqLwogI2lmICFkZWZpbmVkKF9fU0FOSVRJWkVfVEhSRUFEX18pCiAjaWYgZGVmaW5lZChfX2kz
ODZfXykgfHwgZGVmaW5lZChfX3g4Nl82NF9fKSB8fCBkZWZpbmVkKF9fczM5MHhfXykKLSNkZWZp
bmUgYXRvbWljX21iX3NldChwdHIsIGkpICAoKHZvaWQpYXRvbWljX3hjaGcocHRyLCBpKSkKKyNk
ZWZpbmUgcWF0b21pY19tYl9zZXQocHRyLCBpKSAgKCh2b2lkKXFhdG9taWNfeGNoZyhwdHIsIGkp
KQogI2VuZGlmCiAjZW5kaWYKIAotLyogYXRvbWljX21iX3JlYWQvc2V0IHNlbWFudGljcyBtYXAg
SmF2YSB2b2xhdGlsZSB2YXJpYWJsZXMuIFRoZXkgYXJlCisvKiBxYXRvbWljX21iX3JlYWQvc2V0
IHNlbWFudGljcyBtYXAgSmF2YSB2b2xhdGlsZSB2YXJpYWJsZXMuIFRoZXkgYXJlCiAgKiBsZXNz
IGV4cGVuc2l2ZSBvbiBzb21lIHBsYXRmb3JtcyAobm90YWJseSBQT1dFUikgdGhhbiBmdWxseQog
ICogc2VxdWVudGlhbGx5IGNvbnNpc3RlbnQgb3BlcmF0aW9ucy4KICAqCkBAIC00NDgsNTggKzQ1
Miw1OCBAQAogICogdXNlLiBTZWUgZG9jcy9kZXZlbC9hdG9taWNzLnR4dCBmb3IgbW9yZSBkaXNj
dXNzaW9uLgogICovCiAKLSNpZm5kZWYgYXRvbWljX21iX3JlYWQKLSNkZWZpbmUgYXRvbWljX21i
X3JlYWQocHRyKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgIGF0b21pY19sb2Fk
X2FjcXVpcmUocHRyKQorI2lmbmRlZiBxYXRvbWljX21iX3JlYWQKKyNkZWZpbmUgcWF0b21pY19t
Yl9yZWFkKHB0cikgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICBxYXRvbWljX2xv
YWRfYWNxdWlyZShwdHIpCiAjZW5kaWYKIAotI2lmbmRlZiBhdG9taWNfbWJfc2V0Ci0jZGVmaW5l
IGF0b21pY19tYl9zZXQocHRyLCBpKSAgZG8geyAgICAgICAgICAgICAgICAgICAgIFwKLSAgICBh
dG9taWNfc3RvcmVfcmVsZWFzZShwdHIsIGkpOyAgICAgICAgICAgICAgICAgICAgICAgXAorI2lm
bmRlZiBxYXRvbWljX21iX3NldAorI2RlZmluZSBxYXRvbWljX21iX3NldChwdHIsIGkpICBkbyB7
ICAgICAgICAgICAgICAgICAgICBcCisgICAgcWF0b21pY19zdG9yZV9yZWxlYXNlKHB0ciwgaSk7
ICAgICAgICAgICAgICAgICAgICAgIFwKICAgICBzbXBfbWIoKTsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgXAogfSB3aGlsZSgwKQogI2VuZGlmCiAKLSNkZWZpbmUg
YXRvbWljX2ZldGNoX2luY19ub256ZXJvKHB0cikgKHsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIFwKLSAgICB0eXBlb2Zfc3RyaXBfcXVhbCgqcHRyKSBfb2xkbiA9IGF0b21pY19yZWFk
KHB0cik7ICAgICAgICAgICAgICAgICAgIFwKLSAgICB3aGlsZSAoX29sZG4gJiYgYXRvbWljX2Nt
cHhjaGcocHRyLCBfb2xkbiwgX29sZG4gKyAxKSAhPSBfb2xkbikgeyAgIFwKLSAgICAgICAgX29s
ZG4gPSBhdG9taWNfcmVhZChwdHIpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIFwKKyNkZWZpbmUgcWF0b21pY19mZXRjaF9pbmNfbm9uemVybyhwdHIpICh7ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICB0eXBlb2Zfc3RyaXBfcXVhbCgqcHRyKSBfb2xk
biA9IHFhdG9taWNfcmVhZChwdHIpOyAgICAgICAgICAgICAgICAgIFwKKyAgICB3aGlsZSAoX29s
ZG4gJiYgcWF0b21pY19jbXB4Y2hnKHB0ciwgX29sZG4sIF9vbGRuICsgMSkgIT0gX29sZG4pIHsg
IFwKKyAgICAgICAgX29sZG4gPSBxYXRvbWljX3JlYWQocHRyKTsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIFwKICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgICBfb2xkbjsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
IH0pCiAKIC8qIEFic3RyYWN0aW9ucyB0byBhY2Nlc3MgYXRvbWljYWxseSAoaS5lLiAib25jZSIp
IGk2NC91NjQgdmFyaWFibGVzICovCiAjaWZkZWYgQ09ORklHX0FUT01JQzY0Ci1zdGF0aWMgaW5s
aW5lIGludDY0X3QgYXRvbWljX3JlYWRfaTY0KGNvbnN0IGludDY0X3QgKnB0cikKK3N0YXRpYyBp
bmxpbmUgaW50NjRfdCBxYXRvbWljX3JlYWRfaTY0KGNvbnN0IGludDY0X3QgKnB0cikKIHsKICAg
ICAvKiB1c2UgX19ub2NoZWNrIGJlY2F1c2Ugc2l6ZW9mKHZvaWQgKikgbWlnaHQgYmUgPCBzaXpl
b2YodTY0KSAqLwotICAgIHJldHVybiBhdG9taWNfcmVhZF9fbm9jaGVjayhwdHIpOworICAgIHJl
dHVybiBxYXRvbWljX3JlYWRfX25vY2hlY2socHRyKTsKIH0KIAotc3RhdGljIGlubGluZSB1aW50
NjRfdCBhdG9taWNfcmVhZF91NjQoY29uc3QgdWludDY0X3QgKnB0cikKK3N0YXRpYyBpbmxpbmUg
dWludDY0X3QgcWF0b21pY19yZWFkX3U2NChjb25zdCB1aW50NjRfdCAqcHRyKQogewotICAgIHJl
dHVybiBhdG9taWNfcmVhZF9fbm9jaGVjayhwdHIpOworICAgIHJldHVybiBxYXRvbWljX3JlYWRf
X25vY2hlY2socHRyKTsKIH0KIAotc3RhdGljIGlubGluZSB2b2lkIGF0b21pY19zZXRfaTY0KGlu
dDY0X3QgKnB0ciwgaW50NjRfdCB2YWwpCitzdGF0aWMgaW5saW5lIHZvaWQgcWF0b21pY19zZXRf
aTY0KGludDY0X3QgKnB0ciwgaW50NjRfdCB2YWwpCiB7Ci0gICAgYXRvbWljX3NldF9fbm9jaGVj
ayhwdHIsIHZhbCk7CisgICAgcWF0b21pY19zZXRfX25vY2hlY2socHRyLCB2YWwpOwogfQogCi1z
dGF0aWMgaW5saW5lIHZvaWQgYXRvbWljX3NldF91NjQodWludDY0X3QgKnB0ciwgdWludDY0X3Qg
dmFsKQorc3RhdGljIGlubGluZSB2b2lkIHFhdG9taWNfc2V0X3U2NCh1aW50NjRfdCAqcHRyLCB1
aW50NjRfdCB2YWwpCiB7Ci0gICAgYXRvbWljX3NldF9fbm9jaGVjayhwdHIsIHZhbCk7CisgICAg
cWF0b21pY19zZXRfX25vY2hlY2socHRyLCB2YWwpOwogfQogCi1zdGF0aWMgaW5saW5lIHZvaWQg
YXRvbWljNjRfaW5pdCh2b2lkKQorc3RhdGljIGlubGluZSB2b2lkIHFhdG9taWM2NF9pbml0KHZv
aWQpCiB7CiB9CiAjZWxzZSAvKiAhQ09ORklHX0FUT01JQzY0ICovCi1pbnQ2NF90ICBhdG9taWNf
cmVhZF9pNjQoY29uc3QgaW50NjRfdCAqcHRyKTsKLXVpbnQ2NF90IGF0b21pY19yZWFkX3U2NChj
b25zdCB1aW50NjRfdCAqcHRyKTsKLXZvaWQgYXRvbWljX3NldF9pNjQoaW50NjRfdCAqcHRyLCBp
bnQ2NF90IHZhbCk7Ci12b2lkIGF0b21pY19zZXRfdTY0KHVpbnQ2NF90ICpwdHIsIHVpbnQ2NF90
IHZhbCk7Ci12b2lkIGF0b21pYzY0X2luaXQodm9pZCk7CitpbnQ2NF90ICBxYXRvbWljX3JlYWRf
aTY0KGNvbnN0IGludDY0X3QgKnB0cik7Cit1aW50NjRfdCBxYXRvbWljX3JlYWRfdTY0KGNvbnN0
IHVpbnQ2NF90ICpwdHIpOwordm9pZCBxYXRvbWljX3NldF9pNjQoaW50NjRfdCAqcHRyLCBpbnQ2
NF90IHZhbCk7Cit2b2lkIHFhdG9taWNfc2V0X3U2NCh1aW50NjRfdCAqcHRyLCB1aW50NjRfdCB2
YWwpOwordm9pZCBxYXRvbWljNjRfaW5pdCh2b2lkKTsKICNlbmRpZiAvKiAhQ09ORklHX0FUT01J
QzY0ICovCiAKICNlbmRpZiAvKiBRRU1VX0FUT01JQ19IICovCmRpZmYgLS1naXQgYS9kb2NzL2Rl
dmVsL2xvY2tjbnQudHh0IGIvZG9jcy9kZXZlbC9sb2NrY250LnR4dAppbmRleCA3YzA5OWJjNmM4
Li4yZDg1NDYyZmUzIDEwMDY0NAotLS0gYS9kb2NzL2RldmVsL2xvY2tjbnQudHh0CisrKyBiL2Rv
Y3MvZGV2ZWwvbG9ja2NudC50eHQKQEAgLTk1LDcgKzk1LDcgQEAgbm90IGp1c3QgZnJlZXMsIHRo
b3VnaCB0aGVyZSBjb3VsZCBiZSBjYXNlcyB3aGVyZSB0aGlzIGlzIG5vdCBuZWNlc3NhcnkuCiAK
IFJlYWRzLCBpbnN0ZWFkLCBjYW4gYmUgZG9uZSB3aXRob3V0IHRha2luZyB0aGUgbXV0ZXgsIGFz
IGxvbmcgYXMgdGhlCiByZWFkZXJzIGFuZCB3cml0ZXJzIHVzZSB0aGUgc2FtZSBtYWNyb3MgdGhh
dCBhcmUgdXNlZCBmb3IgUkNVLCBmb3IKLWV4YW1wbGUgYXRvbWljX3JjdV9yZWFkLCBhdG9taWNf
cmN1X3NldCwgUUxJU1RfRk9SRUFDSF9SQ1UsIGV0Yy4gIFRoaXMgaXMKK2V4YW1wbGUgcWF0b21p
Y19yY3VfcmVhZCwgcWF0b21pY19yY3Vfc2V0LCBRTElTVF9GT1JFQUNIX1JDVSwgZXRjLiAgVGhp
cyBpcwogYmVjYXVzZSB0aGUgcmVhZHMgYXJlIGRvbmUgb3V0c2lkZSBhIGxvY2sgYW5kIGEgc2V0
IG9yIFFMSVNUX0lOU0VSVF9IRUFECiBjYW4gaGFwcGVuIGNvbmN1cnJlbnRseSB3aXRoIHRoZSBy
ZWFkLiAgVGhlIFJDVSBBUEkgZW5zdXJlcyB0aGF0IHRoZQogcHJvY2Vzc29yIGFuZCB0aGUgY29t
cGlsZXIgc2VlIGFsbCByZXF1aXJlZCBtZW1vcnkgYmFycmllcnMuCkBAIC0xODksNyArMTg5LDcg
QEAgcWVtdV9sb2NrY250X2xvY2sgYW5kIHFlbXVfbG9ja2NudF91bmxvY2s6CiAgICAgaWYgKCF4
eXopIHsKICAgICAgICAgbmV3X3h5eiA9IGdfbmV3KFhZWiwgMSk7CiAgICAgICAgIC4uLgotICAg
ICAgICBhdG9taWNfcmN1X3NldCgmeHl6LCBuZXdfeHl6KTsKKyAgICAgICAgcWF0b21pY19yY3Vf
c2V0KCZ4eXosIG5ld194eXopOwogICAgIH0KICAgICBxZW11X2xvY2tjbnRfdW5sb2NrKCZ4eXpf
bG9ja2NudCk7CiAKQEAgLTE5OCw3ICsxOTgsNyBAQCBxZW11X2xvY2tjbnRfZGVjOgogCiAgICAg
cWVtdV9sb2NrY250X2luYygmeHl6X2xvY2tjbnQpOwogICAgIGlmICh4eXopIHsKLSAgICAgICAg
WFlaICpwID0gYXRvbWljX3JjdV9yZWFkKCZ4eXopOworICAgICAgICBYWVogKnAgPSBxYXRvbWlj
X3JjdV9yZWFkKCZ4eXopOwogICAgICAgICAuLi4KICAgICAgICAgLyogQWNjZXNzZXMgY2FuIG5v
dyBiZSBkb25lIHRocm91Z2ggInAiLiAgKi8KICAgICB9CkBAIC0yMjIsNyArMjIyLDcgQEAgdGhl
IGRlY3JlbWVudCwgdGhlIGxvY2tpbmcgYW5kIHRoZSBjaGVjayBvbiBjb3VudCBhcyBmb2xsb3dz
OgogCiAgICAgcWVtdV9sb2NrY250X2luYygmeHl6X2xvY2tjbnQpOwogICAgIGlmICh4eXopIHsK
LSAgICAgICAgWFlaICpwID0gYXRvbWljX3JjdV9yZWFkKCZ4eXopOworICAgICAgICBYWVogKnAg
PSBxYXRvbWljX3JjdV9yZWFkKCZ4eXopOwogICAgICAgICAuLi4KICAgICAgICAgLyogQWNjZXNz
ZXMgY2FuIG5vdyBiZSBkb25lIHRocm91Z2ggInAiLiAgKi8KICAgICB9CmRpZmYgLS1naXQgYS9k
b2NzL2RldmVsL3JjdS50eHQgYi9kb2NzL2RldmVsL3JjdS50eHQKaW5kZXggMGNlMTViYTE5OC4u
Y2RmMDAyZWRkOCAxMDA2NDQKLS0tIGEvZG9jcy9kZXZlbC9yY3UudHh0CisrKyBiL2RvY3MvZGV2
ZWwvcmN1LnR4dApAQCAtMTMwLDEzICsxMzAsMTMgQEAgVGhlIGNvcmUgUkNVIEFQSSBpcyBzbWFs
bDoKIAogICAgICAgICAgICAgZ19mcmVlX3JjdSgmZm9vLCByY3UpOwogCi0gICAgIHR5cGVvZigq
cCkgYXRvbWljX3JjdV9yZWFkKHApOworICAgICB0eXBlb2YoKnApIHFhdG9taWNfcmN1X3JlYWQo
cCk7CiAKLSAgICAgICAgYXRvbWljX3JjdV9yZWFkKCkgaXMgc2ltaWxhciB0byBhdG9taWNfbG9h
ZF9hY3F1aXJlKCksIGJ1dCBpdCBtYWtlcworICAgICAgICBxYXRvbWljX3JjdV9yZWFkKCkgaXMg
c2ltaWxhciB0byBxYXRvbWljX2xvYWRfYWNxdWlyZSgpLCBidXQgaXQgbWFrZXMKICAgICAgICAg
c29tZSBhc3N1bXB0aW9ucyBvbiB0aGUgY29kZSB0aGF0IGNhbGxzIGl0LiAgVGhpcyBhbGxvd3Mg
YSBtb3JlCiAgICAgICAgIG9wdGltaXplZCBpbXBsZW1lbnRhdGlvbi4KIAotICAgICAgICBhdG9t
aWNfcmN1X3JlYWQgYXNzdW1lcyB0aGF0IHdoZW5ldmVyIGEgc2luZ2xlIFJDVSBjcml0aWNhbAor
ICAgICAgICBxYXRvbWljX3JjdV9yZWFkIGFzc3VtZXMgdGhhdCB3aGVuZXZlciBhIHNpbmdsZSBS
Q1UgY3JpdGljYWwKICAgICAgICAgc2VjdGlvbiByZWFkcyBtdWx0aXBsZSBzaGFyZWQgZGF0YSwg
dGhlc2UgcmVhZHMgYXJlIGVpdGhlcgogICAgICAgICBkYXRhLWRlcGVuZGVudCBvciBuZWVkIG5v
IG9yZGVyaW5nLiAgVGhpcyBpcyBhbG1vc3QgYWx3YXlzIHRoZQogICAgICAgICBjYXNlIHdoZW4g
dXNpbmcgUkNVLCBiZWNhdXNlIHJlYWQtc2lkZSBjcml0aWNhbCBzZWN0aW9ucyB0eXBpY2FsbHkK
QEAgLTE0NCw3ICsxNDQsNyBAQCBUaGUgY29yZSBSQ1UgQVBJIGlzIHNtYWxsOgogICAgICAgICBl
dmVyeSB1cGRhdGUpIHVudGlsIHJlYWNoaW5nIGEgZGF0YSBzdHJ1Y3R1cmUgb2YgaW50ZXJlc3Qs
CiAgICAgICAgIGFuZCB0aGVuIHJlYWQgZnJvbSB0aGVyZS4KIAotICAgICAgICBSQ1UgcmVhZC1z
aWRlIGNyaXRpY2FsIHNlY3Rpb25zIG11c3QgdXNlIGF0b21pY19yY3VfcmVhZCgpIHRvCisgICAg
ICAgIFJDVSByZWFkLXNpZGUgY3JpdGljYWwgc2VjdGlvbnMgbXVzdCB1c2UgcWF0b21pY19yY3Vf
cmVhZCgpIHRvCiAgICAgICAgIHJlYWQgZGF0YSwgdW5sZXNzIGNvbmN1cnJlbnQgd3JpdGVzIGFy
ZSBwcmV2ZW50ZWQgYnkgYW5vdGhlcgogICAgICAgICBzeW5jaHJvbml6YXRpb24gbWVjaGFuaXNt
LgogCkBAIC0xNTIsMTggKzE1MiwxOCBAQCBUaGUgY29yZSBSQ1UgQVBJIGlzIHNtYWxsOgogICAg
ICAgICBkYXRhIHN0cnVjdHVyZSBpbiBhIHNpbmdsZSBkaXJlY3Rpb24sIG9wcG9zaXRlIHRvIHRo
ZSBkaXJlY3Rpb24KICAgICAgICAgaW4gd2hpY2ggdGhlIHVwZGF0ZXIgaW5pdGlhbGl6ZXMgaXQu
CiAKLSAgICAgdm9pZCBhdG9taWNfcmN1X3NldChwLCB0eXBlb2YoKnApIHYpOworICAgICB2b2lk
IHFhdG9taWNfcmN1X3NldChwLCB0eXBlb2YoKnApIHYpOwogCi0gICAgICAgIGF0b21pY19yY3Vf
c2V0KCkgaXMgc2ltaWxhciB0byBhdG9taWNfc3RvcmVfcmVsZWFzZSgpLCB0aG91Z2ggaXQgYWxz
bworICAgICAgICBxYXRvbWljX3JjdV9zZXQoKSBpcyBzaW1pbGFyIHRvIHFhdG9taWNfc3RvcmVf
cmVsZWFzZSgpLCB0aG91Z2ggaXQgYWxzbwogICAgICAgICBtYWtlcyBhc3N1bXB0aW9ucyBvbiB0
aGUgY29kZSB0aGF0IGNhbGxzIGl0IGluIG9yZGVyIHRvIGFsbG93IGEgbW9yZQogICAgICAgICBv
cHRpbWl6ZWQgaW1wbGVtZW50YXRpb24uCiAKLSAgICAgICAgSW4gcGFydGljdWxhciwgYXRvbWlj
X3JjdV9zZXQoKSBzdWZmaWNlcyBmb3Igc3luY2hyb25pemF0aW9uCisgICAgICAgIEluIHBhcnRp
Y3VsYXIsIHFhdG9taWNfcmN1X3NldCgpIHN1ZmZpY2VzIGZvciBzeW5jaHJvbml6YXRpb24KICAg
ICAgICAgd2l0aCByZWFkZXJzLCBpZiB0aGUgdXBkYXRlciBuZXZlciBtdXRhdGVzIGEgZmllbGQg
d2l0aGluIGEKICAgICAgICAgZGF0YSBpdGVtIHRoYXQgaXMgYWxyZWFkeSBhY2Nlc3NpYmxlIHRv
IHJlYWRlcnMuICBUaGlzIGlzIHRoZQogICAgICAgICBjYXNlIHdoZW4gaW5pdGlhbGl6aW5nIGEg
bmV3IGNvcHkgb2YgdGhlIFJDVS1wcm90ZWN0ZWQgZGF0YQogICAgICAgICBzdHJ1Y3R1cmU7IGp1
c3QgZW5zdXJlIHRoYXQgaW5pdGlhbGl6YXRpb24gb2YgKnAgaXMgY2FycmllZCBvdXQKLSAgICAg
ICAgYmVmb3JlIGF0b21pY19yY3Vfc2V0KCkgbWFrZXMgdGhlIGRhdGEgaXRlbSB2aXNpYmxlIHRv
IHJlYWRlcnMuCisgICAgICAgIGJlZm9yZSBxYXRvbWljX3JjdV9zZXQoKSBtYWtlcyB0aGUgZGF0
YSBpdGVtIHZpc2libGUgdG8gcmVhZGVycy4KICAgICAgICAgSWYgdGhpcyBydWxlIGlzIG9ic2Vy
dmVkLCB3cml0ZXMgd2lsbCBoYXBwZW4gaW4gdGhlIG9wcG9zaXRlCiAgICAgICAgIG9yZGVyIGFz
IHJlYWRzIGluIHRoZSBSQ1UgcmVhZC1zaWRlIGNyaXRpY2FsIHNlY3Rpb25zIChvciBpZgogICAg
ICAgICB0aGVyZSBpcyBqdXN0IG9uZSB1cGRhdGUpLCBhbmQgdGhlcmUgd2lsbCBiZSBubyBuZWVk
IGZvciBvdGhlcgpAQCAtMjEyLDcgKzIxMiw3IEBAIERJRkZFUkVOQ0VTIFdJVEggTElOVVgKICAg
cHJvZ3JhbW1pbmc7IG5vdCBhbGxvd2luZyB0aGlzIHdvdWxkIHByZXZlbnQgdXBncmFkaW5nIGFu
IFJDVSByZWFkLXNpZGUKICAgY3JpdGljYWwgc2VjdGlvbiB0byBiZWNvbWUgYW4gdXBkYXRlci4K
IAotLSBhdG9taWNfcmN1X3JlYWQgYW5kIGF0b21pY19yY3Vfc2V0IHJlcGxhY2UgcmN1X2RlcmVm
ZXJlbmNlIGFuZAorLSBxYXRvbWljX3JjdV9yZWFkIGFuZCBxYXRvbWljX3JjdV9zZXQgcmVwbGFj
ZSByY3VfZGVyZWZlcmVuY2UgYW5kCiAgIHJjdV9hc3NpZ25fcG9pbnRlci4gIFRoZXkgdGFrZSBh
IF9wb2ludGVyXyB0byB0aGUgdmFyaWFibGUgYmVpbmcgYWNjZXNzZWQuCiAKIC0gY2FsbF9yY3Ug
aXMgYSBtYWNybyB0aGF0IGhhcyBhbiBleHRyYSBhcmd1bWVudCAodGhlIG5hbWUgb2YgdGhlIGZp
cnN0CkBAIC0yNTcsNyArMjU3LDcgQEAgbWF5IGJlIHVzZWQgYXMgYSByZXN0cmljdGVkIHJlZmVy
ZW5jZS1jb3VudGluZyBtZWNoYW5pc20uICBGb3IgZXhhbXBsZSwKIGNvbnNpZGVyIHRoZSBmb2xs
b3dpbmcgY29kZSBmcmFnbWVudDoKIAogICAgIHJjdV9yZWFkX2xvY2soKTsKLSAgICBwID0gYXRv
bWljX3JjdV9yZWFkKCZmb28pOworICAgIHAgPSBxYXRvbWljX3JjdV9yZWFkKCZmb28pOwogICAg
IC8qIGRvIHNvbWV0aGluZyB3aXRoIHAuICovCiAgICAgcmN1X3JlYWRfdW5sb2NrKCk7CiAKQEAg
LTI2OCw3ICsyNjgsNyBAQCBUaGUgd3JpdGUgc2lkZSBsb29rcyBzaW1wbHkgbGlrZSB0aGlzICh3
aXRoIGFwcHJvcHJpYXRlIGxvY2tpbmcpOgogCiAgICAgcWVtdV9tdXRleF9sb2NrKCZmb29fbXV0
ZXgpOwogICAgIG9sZCA9IGZvbzsKLSAgICBhdG9taWNfcmN1X3NldCgmZm9vLCBuZXcpOworICAg
IHFhdG9taWNfcmN1X3NldCgmZm9vLCBuZXcpOwogICAgIHFlbXVfbXV0ZXhfdW5sb2NrKCZmb29f
bXV0ZXgpOwogICAgIHN5bmNocm9uaXplX3JjdSgpOwogICAgIGZyZWUob2xkKTsKQEAgLTI3Nyw3
ICsyNzcsNyBAQCBJZiB0aGUgcHJvY2Vzc2luZyBjYW5ub3QgYmUgZG9uZSBwdXJlbHkgd2l0aGlu
IHRoZSBjcml0aWNhbCBzZWN0aW9uLCBpdAogaXMgcG9zc2libGUgdG8gY29tYmluZSB0aGlzIGlk
aW9tIHdpdGggYSAicmVhbCIgcmVmZXJlbmNlIGNvdW50OgogCiAgICAgcmN1X3JlYWRfbG9jaygp
OwotICAgIHAgPSBhdG9taWNfcmN1X3JlYWQoJmZvbyk7CisgICAgcCA9IHFhdG9taWNfcmN1X3Jl
YWQoJmZvbyk7CiAgICAgZm9vX3JlZihwKTsKICAgICByY3VfcmVhZF91bmxvY2soKTsKICAgICAv
KiBkbyBzb21ldGhpbmcgd2l0aCBwLiAqLwpAQCAtMjg3LDcgKzI4Nyw3IEBAIFRoZSB3cml0ZSBz
aWRlIGNhbiBiZSBsaWtlIHRoaXM6CiAKICAgICBxZW11X211dGV4X2xvY2soJmZvb19tdXRleCk7
CiAgICAgb2xkID0gZm9vOwotICAgIGF0b21pY19yY3Vfc2V0KCZmb28sIG5ldyk7CisgICAgcWF0
b21pY19yY3Vfc2V0KCZmb28sIG5ldyk7CiAgICAgcWVtdV9tdXRleF91bmxvY2soJmZvb19tdXRl
eCk7CiAgICAgc3luY2hyb25pemVfcmN1KCk7CiAgICAgZm9vX3VucmVmKG9sZCk7CkBAIC0yOTYs
NyArMjk2LDcgQEAgb3Igd2l0aCBjYWxsX3JjdToKIAogICAgIHFlbXVfbXV0ZXhfbG9jaygmZm9v
X211dGV4KTsKICAgICBvbGQgPSBmb287Ci0gICAgYXRvbWljX3JjdV9zZXQoJmZvbywgbmV3KTsK
KyAgICBxYXRvbWljX3JjdV9zZXQoJmZvbywgbmV3KTsKICAgICBxZW11X211dGV4X3VubG9jaygm
Zm9vX211dGV4KTsKICAgICBjYWxsX3JjdShmb29fdW5yZWYsIG9sZCwgcmN1KTsKIApAQCAtMzA3
LDcgKzMwNyw3IEBAIGxhc3QgcmVmZXJlbmNlIG1heSBiZSBkcm9wcGVkIG9uIHRoZSByZWFkIHNp
ZGUuICBIZW5jZSB5b3UgY2FuCiB1c2UgY2FsbF9yY3UoKSBpbnN0ZWFkOgogCiAgICAgIGZvb191
bnJlZihzdHJ1Y3QgZm9vICpwKSB7Ci0gICAgICAgIGlmIChhdG9taWNfZmV0Y2hfZGVjKCZwLT5y
ZWZjb3VudCkgPT0gMSkgeworICAgICAgICBpZiAocWF0b21pY19mZXRjaF9kZWMoJnAtPnJlZmNv
dW50KSA9PSAxKSB7CiAgICAgICAgICAgICBjYWxsX3JjdShmb29fZGVzdHJveSwgcCwgcmN1KTsK
ICAgICAgICAgfQogICAgIH0KQEAgLTM3NSw3ICszNzUsNyBAQCBJbnN0ZWFkLCB3ZSBzdG9yZSB0
aGUgc2l6ZSBvZiB0aGUgYXJyYXkgd2l0aCB0aGUgYXJyYXkgaXRzZWxmOgogCiAgICAgcmVhZCBz
aWRlOgogICAgICAgICByY3VfcmVhZF9sb2NrKCk7Ci0gICAgICAgIHN0cnVjdCBhcnIgKmFycmF5
ID0gYXRvbWljX3JjdV9yZWFkKCZnbG9iYWxfYXJyYXkpOworICAgICAgICBzdHJ1Y3QgYXJyICph
cnJheSA9IHFhdG9taWNfcmN1X3JlYWQoJmdsb2JhbF9hcnJheSk7CiAgICAgICAgIHggPSBpIDwg
YXJyYXktPnNpemUgPyBhcnJheS0+ZGF0YVtpXSA6IC0xOwogICAgICAgICByY3VfcmVhZF91bmxv
Y2soKTsKICAgICAgICAgcmV0dXJuIHg7CkBAIC0zOTIsNyArMzkyLDcgQEAgSW5zdGVhZCwgd2Ug
c3RvcmUgdGhlIHNpemUgb2YgdGhlIGFycmF5IHdpdGggdGhlIGFycmF5IGl0c2VsZjoKIAogICAg
ICAgICAgICAgLyogUmVtb3ZhbCBwaGFzZS4gICovCiAgICAgICAgICAgICBvbGRfYXJyYXkgPSBn
bG9iYWxfYXJyYXk7Ci0gICAgICAgICAgICBhdG9taWNfcmN1X3NldCgmbmV3X2FycmF5LT5kYXRh
LCBuZXdfYXJyYXkpOworICAgICAgICAgICAgcWF0b21pY19yY3Vfc2V0KCZuZXdfYXJyYXktPmRh
dGEsIG5ld19hcnJheSk7CiAgICAgICAgICAgICBzeW5jaHJvbml6ZV9yY3UoKTsKIAogICAgICAg
ICAgICAgLyogUmVjbGFtYXRpb24gcGhhc2UuICAqLwpkaWZmIC0tZ2l0IGEvYWNjZWwvdGNnL2F0
b21pY190ZW1wbGF0ZS5oIGIvYWNjZWwvdGNnL2F0b21pY190ZW1wbGF0ZS5oCmluZGV4IDI2OTY5
NDg3ZDYuLjBmZjdmOTEzZTEgMTAwNjQ0Ci0tLSBhL2FjY2VsL3RjZy9hdG9taWNfdGVtcGxhdGUu
aAorKysgYi9hY2NlbC90Y2cvYXRvbWljX3RlbXBsYXRlLmgKQEAgLTgzLDcgKzgzLDcgQEAgQUJJ
X1RZUEUgQVRPTUlDX05BTUUoY21weGNoZykoQ1BVQXJjaFN0YXRlICplbnYsIHRhcmdldF91bG9u
ZyBhZGRyLAogI2lmIERBVEFfU0laRSA9PSAxNgogICAgIHJldCA9IGF0b21pYzE2X2NtcHhjaGco
aGFkZHIsIGNtcHYsIG5ld3YpOwogI2Vsc2UKLSAgICByZXQgPSBhdG9taWNfY21weGNoZ19fbm9j
aGVjayhoYWRkciwgY21wdiwgbmV3dik7CisgICAgcmV0ID0gcWF0b21pY19jbXB4Y2hnX19ub2No
ZWNrKGhhZGRyLCBjbXB2LCBuZXd2KTsKICNlbmRpZgogICAgIEFUT01JQ19NTVVfQ0xFQU5VUDsK
ICAgICBhdG9taWNfdHJhY2Vfcm13X3Bvc3QoZW52LCBhZGRyLCBpbmZvKTsKQEAgLTEzMSw3ICsx
MzEsNyBAQCBBQklfVFlQRSBBVE9NSUNfTkFNRSh4Y2hnKShDUFVBcmNoU3RhdGUgKmVudiwgdGFy
Z2V0X3Vsb25nIGFkZHIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IEFUT01JQ19NTVVfSURYKTsKIAogICAgIGF0b21pY190cmFjZV9ybXdfcHJlKGVudiwgYWRkciwg
aW5mbyk7Ci0gICAgcmV0ID0gYXRvbWljX3hjaGdfX25vY2hlY2soaGFkZHIsIHZhbCk7CisgICAg
cmV0ID0gcWF0b21pY194Y2hnX19ub2NoZWNrKGhhZGRyLCB2YWwpOwogICAgIEFUT01JQ19NTVVf
Q0xFQU5VUDsKICAgICBhdG9taWNfdHJhY2Vfcm13X3Bvc3QoZW52LCBhZGRyLCBpbmZvKTsKICAg
ICByZXR1cm4gcmV0OwpAQCAtMTQ3LDcgKzE0Nyw3IEBAIEFCSV9UWVBFIEFUT01JQ19OQU1FKFgp
KENQVUFyY2hTdGF0ZSAqZW52LCB0YXJnZXRfdWxvbmcgYWRkciwgICAgICAgXAogICAgIHVpbnQx
Nl90IGluZm8gPSB0cmFjZV9tZW1fYnVpbGRfaW5mbyhTSElGVCwgZmFsc2UsIDAsIGZhbHNlLCAg
ICBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFUT01JQ19NTVVf
SURYKTsgICAgICAgICAgIFwKICAgICBhdG9taWNfdHJhY2Vfcm13X3ByZShlbnYsIGFkZHIsIGlu
Zm8pOyAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgIHJldCA9IGF0b21pY18jI1goaGFk
ZHIsIHZhbCk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgcmV0ID0g
cWF0b21pY18jI1goaGFkZHIsIHZhbCk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFwKICAgICBBVE9NSUNfTU1VX0NMRUFOVVA7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgXAogICAgIGF0b21pY190cmFjZV9ybXdfcG9zdChlbnYsIGFkZHIsIGlu
Zm8pOyAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgcmV0dXJuIHJldDsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKQEAgLTE4MiwxMCAr
MTgyLDEwIEBAIEFCSV9UWVBFIEFUT01JQ19OQU1FKFgpKENQVUFyY2hTdGF0ZSAqZW52LCB0YXJn
ZXRfdWxvbmcgYWRkciwgICAgICAgXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBBVE9NSUNfTU1VX0lEWCk7ICAgICAgICAgICBcCiAgICAgYXRvbWljX3RyYWNlX3Jt
d19wcmUoZW52LCBhZGRyLCBpbmZvKTsgICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgICBz
bXBfbWIoKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgXAotICAgIGNtcCA9IGF0b21pY19yZWFkX19ub2NoZWNrKGhhZGRyKTsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBcCisgICAgY21wID0gcWF0b21pY19yZWFkX19ub2NoZWNrKGhh
ZGRyKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgICBkbyB7ICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogICAgICAg
ICBvbGQgPSBjbXA7IG5ldyA9IEZOKG9sZCwgdmFsKTsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBcCi0gICAgICAgIGNtcCA9IGF0b21pY19jbXB4Y2hnX19ub2NoZWNrKGhhZGRyLCBvbGQs
IG5ldyk7ICAgICAgICAgICAgIFwKKyAgICAgICAgY21wID0gcWF0b21pY19jbXB4Y2hnX19ub2No
ZWNrKGhhZGRyLCBvbGQsIG5ldyk7ICAgICAgICAgICAgXAogICAgIH0gd2hpbGUgKGNtcCAhPSBv
bGQpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgQVRP
TUlDX01NVV9DTEVBTlVQOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIFwKICAgICBhdG9taWNfdHJhY2Vfcm13X3Bvc3QoZW52LCBhZGRyLCBpbmZvKTsgICAgICAg
ICAgICAgICAgICAgICAgICAgXApAQCAtMjMwLDcgKzIzMCw3IEBAIEFCSV9UWVBFIEFUT01JQ19O
QU1FKGNtcHhjaGcpKENQVUFyY2hTdGF0ZSAqZW52LCB0YXJnZXRfdWxvbmcgYWRkciwKICNpZiBE
QVRBX1NJWkUgPT0gMTYKICAgICByZXQgPSBhdG9taWMxNl9jbXB4Y2hnKGhhZGRyLCBCU1dBUChj
bXB2KSwgQlNXQVAobmV3dikpOwogI2Vsc2UKLSAgICByZXQgPSBhdG9taWNfY21weGNoZ19fbm9j
aGVjayhoYWRkciwgQlNXQVAoY21wdiksIEJTV0FQKG5ld3YpKTsKKyAgICByZXQgPSBxYXRvbWlj
X2NtcHhjaGdfX25vY2hlY2soaGFkZHIsIEJTV0FQKGNtcHYpLCBCU1dBUChuZXd2KSk7CiAjZW5k
aWYKICAgICBBVE9NSUNfTU1VX0NMRUFOVVA7CiAgICAgYXRvbWljX3RyYWNlX3Jtd19wb3N0KGVu
diwgYWRkciwgaW5mbyk7CkBAIC0yODAsNyArMjgwLDcgQEAgQUJJX1RZUEUgQVRPTUlDX05BTUUo
eGNoZykoQ1BVQXJjaFN0YXRlICplbnYsIHRhcmdldF91bG9uZyBhZGRyLAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBVE9NSUNfTU1VX0lEWCk7CiAKICAgICBhdG9t
aWNfdHJhY2Vfcm13X3ByZShlbnYsIGFkZHIsIGluZm8pOwotICAgIHJldCA9IGF0b21pY194Y2hn
X19ub2NoZWNrKGhhZGRyLCBCU1dBUCh2YWwpKTsKKyAgICByZXQgPSBxYXRvbWljX3hjaGdfX25v
Y2hlY2soaGFkZHIsIEJTV0FQKHZhbCkpOwogICAgIEFUT01JQ19NTVVfQ0xFQU5VUDsKICAgICBh
dG9taWNfdHJhY2Vfcm13X3Bvc3QoZW52LCBhZGRyLCBpbmZvKTsKICAgICByZXR1cm4gQlNXQVAo
cmV0KTsKQEAgLTI5Niw3ICsyOTYsNyBAQCBBQklfVFlQRSBBVE9NSUNfTkFNRShYKShDUFVBcmNo
U3RhdGUgKmVudiwgdGFyZ2V0X3Vsb25nIGFkZHIsICAgICAgIFwKICAgICB1aW50MTZfdCBpbmZv
ID0gdHJhY2VfbWVtX2J1aWxkX2luZm8oU0hJRlQsIGZhbHNlLCBNT19CU1dBUCwgICAgXAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWxzZSwgQVRPTUlDX01NVV9J
RFgpOyAgICBcCiAgICAgYXRvbWljX3RyYWNlX3Jtd19wcmUoZW52LCBhZGRyLCBpbmZvKTsgICAg
ICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICByZXQgPSBhdG9taWNfIyNYKGhhZGRyLCBCU1dB
UCh2YWwpKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgIHJldCA9IHFhdG9taWNf
IyNYKGhhZGRyLCBCU1dBUCh2YWwpKTsgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAg
QVRPTUlDX01NVV9DTEVBTlVQOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIFwKICAgICBhdG9taWNfdHJhY2Vfcm13X3Bvc3QoZW52LCBhZGRyLCBpbmZvKTsgICAg
ICAgICAgICAgICAgICAgICAgICAgXAogICAgIHJldHVybiBCU1dBUChyZXQpOyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCkBAIC0zMjksMTAgKzMyOSwxMCBA
QCBBQklfVFlQRSBBVE9NSUNfTkFNRShYKShDUFVBcmNoU3RhdGUgKmVudiwgdGFyZ2V0X3Vsb25n
IGFkZHIsICAgICAgIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ZmFsc2UsIEFUT01JQ19NTVVfSURYKTsgICAgXAogICAgIGF0b21pY190cmFjZV9ybXdfcHJlKGVu
diwgYWRkciwgaW5mbyk7ICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgc21wX21iKCk7
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
LSAgICBsZG4gPSBhdG9taWNfcmVhZF9fbm9jaGVjayhoYWRkcik7ICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgXAorICAgIGxkbiA9IHFhdG9taWNfcmVhZF9fbm9jaGVjayhoYWRkcik7ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgZG8geyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgICAgICAgbGRvID0g
bGRuOyBvbGQgPSBCU1dBUChsZG8pOyBuZXcgPSBGTihvbGQsIHZhbCk7ICAgICAgICAgICAgXAot
ICAgICAgICBsZG4gPSBhdG9taWNfY21weGNoZ19fbm9jaGVjayhoYWRkciwgbGRvLCBCU1dBUChu
ZXcpKTsgICAgICBcCisgICAgICAgIGxkbiA9IHFhdG9taWNfY21weGNoZ19fbm9jaGVjayhoYWRk
ciwgbGRvLCBCU1dBUChuZXcpKTsgICAgIFwKICAgICB9IHdoaWxlIChsZG8gIT0gbGRuKTsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogICAgIEFUT01JQ19NTVVf
Q0xFQU5VUDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAg
ICAgYXRvbWljX3RyYWNlX3Jtd19wb3N0KGVudiwgYWRkciwgaW5mbyk7ICAgICAgICAgICAgICAg
ICAgICAgICAgIFwKZGlmZiAtLWdpdCBhL2luY2x1ZGUvYmxvY2svYWlvLXdhaXQuaCBiL2luY2x1
ZGUvYmxvY2svYWlvLXdhaXQuaAppbmRleCA3MTZkMjYzOWRmLi5iMzllZWZiMzhkIDEwMDY0NAot
LS0gYS9pbmNsdWRlL2Jsb2NrL2Fpby13YWl0LmgKKysrIGIvaW5jbHVkZS9ibG9jay9haW8td2Fp
dC5oCkBAIC04MCw3ICs4MCw3IEBAIGV4dGVybiBBaW9XYWl0IGdsb2JhbF9haW9fd2FpdDsKICAg
ICBBaW9XYWl0ICp3YWl0XyA9ICZnbG9iYWxfYWlvX3dhaXQ7ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCiAgICAgQWlvQ29udGV4dCAqY3R4XyA9IChjdHgpOyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgXAogICAgIC8qIEluY3JlbWVudCB3YWl0Xy0+bnVtX3dhaXRl
cnMgYmVmb3JlIGV2YWx1YXRpbmcgY29uZC4gKi8gICAgIFwKLSAgICBhdG9taWNfaW5jKCZ3YWl0
Xy0+bnVtX3dhaXRlcnMpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgcWF0
b21pY19pbmMoJndhaXRfLT5udW1fd2FpdGVycyk7ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXAogICAgIGlmIChjdHhfICYmIGluX2Fpb19jb250ZXh0X2hvbWVfdGhyZWFkKGN0eF8pKSB7
ICAgICAgICAgICAgICAgIFwKICAgICAgICAgd2hpbGUgKChjb25kKSkgeyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgICAgICAgICBhaW9fcG9sbChjdHhf
LCB0cnVlKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXApAQCAtMTAwLDcgKzEw
MCw3IEBAIGV4dGVybiBBaW9XYWl0IGdsb2JhbF9haW9fd2FpdDsKICAgICAgICAgICAgIHdhaXRl
ZF8gPSB0cnVlOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAg
ICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgXAogICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIFwKLSAgICBhdG9taWNfZGVjKCZ3YWl0Xy0+bnVtX3dhaXRlcnMp
OyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgcWF0b21pY19kZWMoJndhaXRf
LT5udW1fd2FpdGVycyk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogICAgIHdhaXRl
ZF87IH0pCiAKIC8qKgpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9ibG9jay9haW8uaCBiL2luY2x1ZGUv
YmxvY2svYWlvLmgKaW5kZXggYjJmNzAzZmEzZi4uZWM4YzVhZjY0MiAxMDA2NDQKLS0tIGEvaW5j
bHVkZS9ibG9jay9haW8uaAorKysgYi9pbmNsdWRlL2Jsb2NrL2Fpby5oCkBAIC01OTUsNyArNTk1
LDcgQEAgaW50NjRfdCBhaW9fY29tcHV0ZV90aW1lb3V0KEFpb0NvbnRleHQgKmN0eCk7CiAgKi8K
IHN0YXRpYyBpbmxpbmUgdm9pZCBhaW9fZGlzYWJsZV9leHRlcm5hbChBaW9Db250ZXh0ICpjdHgp
CiB7Ci0gICAgYXRvbWljX2luYygmY3R4LT5leHRlcm5hbF9kaXNhYmxlX2NudCk7CisgICAgcWF0
b21pY19pbmMoJmN0eC0+ZXh0ZXJuYWxfZGlzYWJsZV9jbnQpOwogfQogCiAvKioKQEAgLTYwOCw3
ICs2MDgsNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgYWlvX2VuYWJsZV9leHRlcm5hbChBaW9Db250
ZXh0ICpjdHgpCiB7CiAgICAgaW50IG9sZDsKIAotICAgIG9sZCA9IGF0b21pY19mZXRjaF9kZWMo
JmN0eC0+ZXh0ZXJuYWxfZGlzYWJsZV9jbnQpOworICAgIG9sZCA9IHFhdG9taWNfZmV0Y2hfZGVj
KCZjdHgtPmV4dGVybmFsX2Rpc2FibGVfY250KTsKICAgICBhc3NlcnQob2xkID4gMCk7CiAgICAg
aWYgKG9sZCA9PSAxKSB7CiAgICAgICAgIC8qIEtpY2sgZXZlbnQgbG9vcCBzbyBpdCByZS1hcm1z
IGZpbGUgZGVzY3JpcHRvcnMgKi8KQEAgLTYyNCw3ICs2MjQsNyBAQCBzdGF0aWMgaW5saW5lIHZv
aWQgYWlvX2VuYWJsZV9leHRlcm5hbChBaW9Db250ZXh0ICpjdHgpCiAgKi8KIHN0YXRpYyBpbmxp
bmUgYm9vbCBhaW9fZXh0ZXJuYWxfZGlzYWJsZWQoQWlvQ29udGV4dCAqY3R4KQogewotICAgIHJl
dHVybiBhdG9taWNfcmVhZCgmY3R4LT5leHRlcm5hbF9kaXNhYmxlX2NudCk7CisgICAgcmV0dXJu
IHFhdG9taWNfcmVhZCgmY3R4LT5leHRlcm5hbF9kaXNhYmxlX2NudCk7CiB9CiAKIC8qKgpAQCAt
NjM3LDcgKzYzNyw3IEBAIHN0YXRpYyBpbmxpbmUgYm9vbCBhaW9fZXh0ZXJuYWxfZGlzYWJsZWQo
QWlvQ29udGV4dCAqY3R4KQogICovCiBzdGF0aWMgaW5saW5lIGJvb2wgYWlvX25vZGVfY2hlY2so
QWlvQ29udGV4dCAqY3R4LCBib29sIGlzX2V4dGVybmFsKQogewotICAgIHJldHVybiAhaXNfZXh0
ZXJuYWwgfHwgIWF0b21pY19yZWFkKCZjdHgtPmV4dGVybmFsX2Rpc2FibGVfY250KTsKKyAgICBy
ZXR1cm4gIWlzX2V4dGVybmFsIHx8ICFxYXRvbWljX3JlYWQoJmN0eC0+ZXh0ZXJuYWxfZGlzYWJs
ZV9jbnQpOwogfQogCiAvKioKZGlmZiAtLWdpdCBhL2luY2x1ZGUvZXhlYy9jcHVfbGRzdC5oIGIv
aW5jbHVkZS9leGVjL2NwdV9sZHN0LmgKaW5kZXggYzE0YTQ4ZjY1ZS4uMzA2MDVlZGFiOSAxMDA2
NDQKLS0tIGEvaW5jbHVkZS9leGVjL2NwdV9sZHN0LmgKKysrIGIvaW5jbHVkZS9leGVjL2NwdV9s
ZHN0LmgKQEAgLTI5OSw3ICsyOTksNyBAQCBzdGF0aWMgaW5saW5lIHRhcmdldF91bG9uZyB0bGJf
YWRkcl93cml0ZShjb25zdCBDUFVUTEJFbnRyeSAqZW50cnkpCiAjaWYgVENHX09WRVJTSVpFRF9H
VUVTVAogICAgIHJldHVybiBlbnRyeS0+YWRkcl93cml0ZTsKICNlbHNlCi0gICAgcmV0dXJuIGF0
b21pY19yZWFkKCZlbnRyeS0+YWRkcl93cml0ZSk7CisgICAgcmV0dXJuIHFhdG9taWNfcmVhZCgm
ZW50cnktPmFkZHJfd3JpdGUpOwogI2VuZGlmCiB9CiAKZGlmZiAtLWdpdCBhL2luY2x1ZGUvZXhl
Yy9leGVjLWFsbC5oIGIvaW5jbHVkZS9leGVjL2V4ZWMtYWxsLmgKaW5kZXggM2NmODgyNzJkZi4u
MWZlMjhkNTc0ZiAxMDA2NDQKLS0tIGEvaW5jbHVkZS9leGVjL2V4ZWMtYWxsLmgKKysrIGIvaW5j
bHVkZS9leGVjL2V4ZWMtYWxsLmgKQEAgLTg5LDcgKzg5LDcgQEAgdm9pZCBRRU1VX05PUkVUVVJO
IGNwdV9sb29wX2V4aXRfYXRvbWljKENQVVN0YXRlICpjcHUsIHVpbnRwdHJfdCBwYyk7CiAgKi8K
IHN0YXRpYyBpbmxpbmUgYm9vbCBjcHVfbG9vcF9leGl0X3JlcXVlc3RlZChDUFVTdGF0ZSAqY3B1
KQogewotICAgIHJldHVybiAoaW50MzJfdClhdG9taWNfcmVhZCgmY3B1X25lZyhjcHUpLT5pY291
bnRfZGVjci51MzIpIDwgMDsKKyAgICByZXR1cm4gKGludDMyX3QpcWF0b21pY19yZWFkKCZjcHVf
bmVnKGNwdSktPmljb3VudF9kZWNyLnUzMikgPCAwOwogfQogCiAjaWYgIWRlZmluZWQoQ09ORklH
X1VTRVJfT05MWSkKQEAgLTQ4NywxMCArNDg3LDEwIEBAIHN0cnVjdCBUcmFuc2xhdGlvbkJsb2Nr
IHsKIAogZXh0ZXJuIGJvb2wgcGFyYWxsZWxfY3B1czsKIAotLyogSGlkZSB0aGUgYXRvbWljX3Jl
YWQgdG8gbWFrZSBjb2RlIGEgbGl0dGxlIGVhc2llciBvbiB0aGUgZXllcyAqLworLyogSGlkZSB0
aGUgcWF0b21pY19yZWFkIHRvIG1ha2UgY29kZSBhIGxpdHRsZSBlYXNpZXIgb24gdGhlIGV5ZXMg
Ki8KIHN0YXRpYyBpbmxpbmUgdWludDMyX3QgdGJfY2ZsYWdzKGNvbnN0IFRyYW5zbGF0aW9uQmxv
Y2sgKnRiKQogewotICAgIHJldHVybiBhdG9taWNfcmVhZCgmdGItPmNmbGFncyk7CisgICAgcmV0
dXJuIHFhdG9taWNfcmVhZCgmdGItPmNmbGFncyk7CiB9CiAKIC8qIGN1cnJlbnQgY2ZsYWdzIGZv
ciBoYXNoaW5nL2NvbXBhcmlzb24gKi8KZGlmZiAtLWdpdCBhL2luY2x1ZGUvZXhlYy9sb2cuaCBi
L2luY2x1ZGUvZXhlYy9sb2cuaAppbmRleCAzZWQ3OTdjMWM4Li44Njg3MWY0MDNhIDEwMDY0NAot
LS0gYS9pbmNsdWRlL2V4ZWMvbG9nLmgKKysrIGIvaW5jbHVkZS9leGVjL2xvZy5oCkBAIC0xOSw3
ICsxOSw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBsb2dfY3B1X3N0YXRlKENQVVN0YXRlICpjcHUs
IGludCBmbGFncykKIAogICAgIGlmIChxZW11X2xvZ19lbmFibGVkKCkpIHsKICAgICAgICAgcmN1
X3JlYWRfbG9jaygpOwotICAgICAgICBsb2dmaWxlID0gYXRvbWljX3JjdV9yZWFkKCZxZW11X2xv
Z2ZpbGUpOworICAgICAgICBsb2dmaWxlID0gcWF0b21pY19yY3VfcmVhZCgmcWVtdV9sb2dmaWxl
KTsKICAgICAgICAgaWYgKGxvZ2ZpbGUpIHsKICAgICAgICAgICAgIGNwdV9kdW1wX3N0YXRlKGNw
dSwgbG9nZmlsZS0+ZmQsIGZsYWdzKTsKICAgICAgICAgfQpAQCAtNDksNyArNDksNyBAQCBzdGF0
aWMgaW5saW5lIHZvaWQgbG9nX3RhcmdldF9kaXNhcyhDUFVTdGF0ZSAqY3B1LCB0YXJnZXRfdWxv
bmcgc3RhcnQsCiB7CiAgICAgUWVtdUxvZ0ZpbGUgKmxvZ2ZpbGU7CiAgICAgcmN1X3JlYWRfbG9j
aygpOwotICAgIGxvZ2ZpbGUgPSBhdG9taWNfcmN1X3JlYWQoJnFlbXVfbG9nZmlsZSk7CisgICAg
bG9nZmlsZSA9IHFhdG9taWNfcmN1X3JlYWQoJnFlbXVfbG9nZmlsZSk7CiAgICAgaWYgKGxvZ2Zp
bGUpIHsKICAgICAgICAgdGFyZ2V0X2Rpc2FzKGxvZ2ZpbGUtPmZkLCBjcHUsIHN0YXJ0LCBsZW4p
OwogICAgIH0KQEAgLTYwLDcgKzYwLDcgQEAgc3RhdGljIGlubGluZSB2b2lkIGxvZ19kaXNhcyh2
b2lkICpjb2RlLCB1bnNpZ25lZCBsb25nIHNpemUsIGNvbnN0IGNoYXIgKm5vdGUpCiB7CiAgICAg
UWVtdUxvZ0ZpbGUgKmxvZ2ZpbGU7CiAgICAgcmN1X3JlYWRfbG9jaygpOwotICAgIGxvZ2ZpbGUg
PSBhdG9taWNfcmN1X3JlYWQoJnFlbXVfbG9nZmlsZSk7CisgICAgbG9nZmlsZSA9IHFhdG9taWNf
cmN1X3JlYWQoJnFlbXVfbG9nZmlsZSk7CiAgICAgaWYgKGxvZ2ZpbGUpIHsKICAgICAgICAgZGlz
YXMobG9nZmlsZS0+ZmQsIGNvZGUsIHNpemUsIG5vdGUpOwogICAgIH0KZGlmZiAtLWdpdCBhL2lu
Y2x1ZGUvZXhlYy9tZW1vcnkuaCBiL2luY2x1ZGUvZXhlYy9tZW1vcnkuaAppbmRleCBmMWJiMmE3
ZGY1Li4wNmI4NWUzYTczIDEwMDY0NAotLS0gYS9pbmNsdWRlL2V4ZWMvbWVtb3J5LmgKKysrIGIv
aW5jbHVkZS9leGVjL21lbW9yeS5oCkBAIC02ODUsNyArNjg1LDcgQEAgc3RydWN0IEZsYXRWaWV3
IHsKIAogc3RhdGljIGlubGluZSBGbGF0VmlldyAqYWRkcmVzc19zcGFjZV90b19mbGF0dmlldyhB
ZGRyZXNzU3BhY2UgKmFzKQogewotICAgIHJldHVybiBhdG9taWNfcmN1X3JlYWQoJmFzLT5jdXJy
ZW50X21hcCk7CisgICAgcmV0dXJuIHFhdG9taWNfcmN1X3JlYWQoJmFzLT5jdXJyZW50X21hcCk7
CiB9CiAKIApkaWZmIC0tZ2l0IGEvaW5jbHVkZS9leGVjL3JhbV9hZGRyLmggYi9pbmNsdWRlL2V4
ZWMvcmFtX2FkZHIuaAppbmRleCAzZWY3MjlhMjNjLi5jNmQyZWYxZDA3IDEwMDY0NAotLS0gYS9p
bmNsdWRlL2V4ZWMvcmFtX2FkZHIuaAorKysgYi9pbmNsdWRlL2V4ZWMvcmFtX2FkZHIuaApAQCAt
MTY0LDcgKzE2NCw3IEBAIHN0YXRpYyBpbmxpbmUgYm9vbCBjcHVfcGh5c2ljYWxfbWVtb3J5X2dl
dF9kaXJ0eShyYW1fYWRkcl90IHN0YXJ0LAogICAgIHBhZ2UgPSBzdGFydCA+PiBUQVJHRVRfUEFH
RV9CSVRTOwogCiAgICAgV0lUSF9SQ1VfUkVBRF9MT0NLX0dVQVJEKCkgewotICAgICAgICBibG9j
a3MgPSBhdG9taWNfcmN1X3JlYWQoJnJhbV9saXN0LmRpcnR5X21lbW9yeVtjbGllbnRdKTsKKyAg
ICAgICAgYmxvY2tzID0gcWF0b21pY19yY3VfcmVhZCgmcmFtX2xpc3QuZGlydHlfbWVtb3J5W2Ns
aWVudF0pOwogCiAgICAgICAgIGlkeCA9IHBhZ2UgLyBESVJUWV9NRU1PUllfQkxPQ0tfU0laRTsK
ICAgICAgICAgb2Zmc2V0ID0gcGFnZSAlIERJUlRZX01FTU9SWV9CTE9DS19TSVpFOwpAQCAtMjA1
LDcgKzIwNSw3IEBAIHN0YXRpYyBpbmxpbmUgYm9vbCBjcHVfcGh5c2ljYWxfbWVtb3J5X2FsbF9k
aXJ0eShyYW1fYWRkcl90IHN0YXJ0LAogCiAgICAgUkNVX1JFQURfTE9DS19HVUFSRCgpOwogCi0g
ICAgYmxvY2tzID0gYXRvbWljX3JjdV9yZWFkKCZyYW1fbGlzdC5kaXJ0eV9tZW1vcnlbY2xpZW50
XSk7CisgICAgYmxvY2tzID0gcWF0b21pY19yY3VfcmVhZCgmcmFtX2xpc3QuZGlydHlfbWVtb3J5
W2NsaWVudF0pOwogCiAgICAgaWR4ID0gcGFnZSAvIERJUlRZX01FTU9SWV9CTE9DS19TSVpFOwog
ICAgIG9mZnNldCA9IHBhZ2UgJSBESVJUWV9NRU1PUllfQkxPQ0tfU0laRTsKQEAgLTI3OCw3ICsy
NzgsNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgY3B1X3BoeXNpY2FsX21lbW9yeV9zZXRfZGlydHlf
ZmxhZyhyYW1fYWRkcl90IGFkZHIsCiAKICAgICBSQ1VfUkVBRF9MT0NLX0dVQVJEKCk7CiAKLSAg
ICBibG9ja3MgPSBhdG9taWNfcmN1X3JlYWQoJnJhbV9saXN0LmRpcnR5X21lbW9yeVtjbGllbnRd
KTsKKyAgICBibG9ja3MgPSBxYXRvbWljX3JjdV9yZWFkKCZyYW1fbGlzdC5kaXJ0eV9tZW1vcnlb
Y2xpZW50XSk7CiAKICAgICBzZXRfYml0X2F0b21pYyhvZmZzZXQsIGJsb2Nrcy0+YmxvY2tzW2lk
eF0pOwogfQpAQCAtMzAxLDcgKzMwMSw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBjcHVfcGh5c2lj
YWxfbWVtb3J5X3NldF9kaXJ0eV9yYW5nZShyYW1fYWRkcl90IHN0YXJ0LAogCiAgICAgV0lUSF9S
Q1VfUkVBRF9MT0NLX0dVQVJEKCkgewogICAgICAgICBmb3IgKGkgPSAwOyBpIDwgRElSVFlfTUVN
T1JZX05VTTsgaSsrKSB7Ci0gICAgICAgICAgICBibG9ja3NbaV0gPSBhdG9taWNfcmN1X3JlYWQo
JnJhbV9saXN0LmRpcnR5X21lbW9yeVtpXSk7CisgICAgICAgICAgICBibG9ja3NbaV0gPSBxYXRv
bWljX3JjdV9yZWFkKCZyYW1fbGlzdC5kaXJ0eV9tZW1vcnlbaV0pOwogICAgICAgICB9CiAKICAg
ICAgICAgaWR4ID0gcGFnZSAvIERJUlRZX01FTU9SWV9CTE9DS19TSVpFOwpAQCAtMzYxLDIzICsz
NjEsMjUgQEAgc3RhdGljIGlubGluZSB2b2lkIGNwdV9waHlzaWNhbF9tZW1vcnlfc2V0X2RpcnR5
X2xlYml0bWFwKHVuc2lnbmVkIGxvbmcgKmJpdG1hcCwKIAogICAgICAgICBXSVRIX1JDVV9SRUFE
X0xPQ0tfR1VBUkQoKSB7CiAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgRElSVFlfTUVNT1JZ
X05VTTsgaSsrKSB7Ci0gICAgICAgICAgICAgICAgYmxvY2tzW2ldID0gYXRvbWljX3JjdV9yZWFk
KCZyYW1fbGlzdC5kaXJ0eV9tZW1vcnlbaV0pLT5ibG9ja3M7CisgICAgICAgICAgICAgICAgYmxv
Y2tzW2ldID0KKyAgICAgICAgICAgICAgICAgICAgcWF0b21pY19yY3VfcmVhZCgmcmFtX2xpc3Qu
ZGlydHlfbWVtb3J5W2ldKS0+YmxvY2tzOwogICAgICAgICAgICAgfQogCiAgICAgICAgICAgICBm
b3IgKGsgPSAwOyBrIDwgbnI7IGsrKykgewogICAgICAgICAgICAgICAgIGlmIChiaXRtYXBba10p
IHsKICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyB0ZW1wID0gbGV1bF90b19jcHUo
Yml0bWFwW2tdKTsKIAotICAgICAgICAgICAgICAgICAgICBhdG9taWNfb3IoJmJsb2Nrc1tESVJU
WV9NRU1PUllfVkdBXVtpZHhdW29mZnNldF0sIHRlbXApOworICAgICAgICAgICAgICAgICAgICBx
YXRvbWljX29yKCZibG9ja3NbRElSVFlfTUVNT1JZX1ZHQV1baWR4XVtvZmZzZXRdLCB0ZW1wKTsK
IAogICAgICAgICAgICAgICAgICAgICBpZiAoZ2xvYmFsX2RpcnR5X2xvZykgewotICAgICAgICAg
ICAgICAgICAgICAgICAgYXRvbWljX29yKCZibG9ja3NbRElSVFlfTUVNT1JZX01JR1JBVElPTl1b
aWR4XVtvZmZzZXRdLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXApOwor
ICAgICAgICAgICAgICAgICAgICAgICAgcWF0b21pY19vcigKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgJmJsb2Nrc1tESVJUWV9NRU1PUllfTUlHUkFUSU9OXVtpZHhdW29mZnNldF0s
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXApOwogICAgICAgICAgICAgICAg
ICAgICB9CiAKICAgICAgICAgICAgICAgICAgICAgaWYgKHRjZ19lbmFibGVkKCkpIHsKLSAgICAg
ICAgICAgICAgICAgICAgICAgIGF0b21pY19vcigmYmxvY2tzW0RJUlRZX01FTU9SWV9DT0RFXVtp
ZHhdW29mZnNldF0sCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcCk7Cisg
ICAgICAgICAgICAgICAgICAgICAgICBxYXRvbWljX29yKCZibG9ja3NbRElSVFlfTUVNT1JZX0NP
REVdW2lkeF1bb2Zmc2V0XSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVt
cCk7CiAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICB9CiAKQEAgLTQ2MSwx
MiArNDYzLDEyIEBAIHVpbnQ2NF90IGNwdV9waHlzaWNhbF9tZW1vcnlfc3luY19kaXJ0eV9iaXRt
YXAoUkFNQmxvY2sgKnJiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IERJUlRZX01FTU9SWV9CTE9DS19TSVpFKTsKICAgICAgICAgdW5zaWduZWQgbG9uZyBwYWdlID0g
QklUX1dPUkQoc3RhcnQgPj4gVEFSR0VUX1BBR0VfQklUUyk7CiAKLSAgICAgICAgc3JjID0gYXRv
bWljX3JjdV9yZWFkKAorICAgICAgICBzcmMgPSBxYXRvbWljX3JjdV9yZWFkKAogICAgICAgICAg
ICAgICAgICZyYW1fbGlzdC5kaXJ0eV9tZW1vcnlbRElSVFlfTUVNT1JZX01JR1JBVElPTl0pLT5i
bG9ja3M7CiAKICAgICAgICAgZm9yIChrID0gcGFnZTsgayA8IHBhZ2UgKyBucjsgaysrKSB7CiAg
ICAgICAgICAgICBpZiAoc3JjW2lkeF1bb2Zmc2V0XSkgewotICAgICAgICAgICAgICAgIHVuc2ln
bmVkIGxvbmcgYml0cyA9IGF0b21pY194Y2hnKCZzcmNbaWR4XVtvZmZzZXRdLCAwKTsKKyAgICAg
ICAgICAgICAgICB1bnNpZ25lZCBsb25nIGJpdHMgPSBxYXRvbWljX3hjaGcoJnNyY1tpZHhdW29m
ZnNldF0sIDApOwogICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgbmV3X2RpcnR5OwogICAg
ICAgICAgICAgICAgIG5ld19kaXJ0eSA9IH5kZXN0W2tdOwogICAgICAgICAgICAgICAgIGRlc3Rb
a10gfD0gYml0czsKZGlmZiAtLWdpdCBhL2luY2x1ZGUvZXhlYy9yYW1saXN0LmggYi9pbmNsdWRl
L2V4ZWMvcmFtbGlzdC5oCmluZGV4IGJjNGZhYTFiMDAuLjI2NzA0YWEzYjAgMTAwNjQ0Ci0tLSBh
L2luY2x1ZGUvZXhlYy9yYW1saXN0LmgKKysrIGIvaW5jbHVkZS9leGVjL3JhbWxpc3QuaApAQCAt
MTksNyArMTksNyBAQCB0eXBlZGVmIHN0cnVjdCBSQU1CbG9ja05vdGlmaWVyIFJBTUJsb2NrTm90
aWZpZXI7CiAgKiAgIHJjdV9yZWFkX2xvY2soKTsKICAqCiAgKiAgIERpcnR5TWVtb3J5QmxvY2tz
ICpibG9ja3MgPQotICogICAgICAgYXRvbWljX3JjdV9yZWFkKCZyYW1fbGlzdC5kaXJ0eV9tZW1v
cnlbRElSVFlfTUVNT1JZX01JR1JBVElPTl0pOworICogICAgICAgcWF0b21pY19yY3VfcmVhZCgm
cmFtX2xpc3QuZGlydHlfbWVtb3J5W0RJUlRZX01FTU9SWV9NSUdSQVRJT05dKTsKICAqCiAgKiAg
IHJhbV9hZGRyX3QgaWR4ID0gKGFkZHIgPj4gVEFSR0VUX1BBR0VfQklUUykgLyBESVJUWV9NRU1P
UllfQkxPQ0tfU0laRTsKICAqICAgdW5zaWduZWQgbG9uZyAqYmxvY2sgPSBibG9ja3MuYmxvY2tz
W2lkeF07CmRpZmYgLS1naXQgYS9pbmNsdWRlL2V4ZWMvdGItbG9va3VwLmggYi9pbmNsdWRlL2V4
ZWMvdGItbG9va3VwLmgKaW5kZXggMjY5MjFiNmRhZi4uOWNmNDc1YmIwMyAxMDA2NDQKLS0tIGEv
aW5jbHVkZS9leGVjL3RiLWxvb2t1cC5oCisrKyBiL2luY2x1ZGUvZXhlYy90Yi1sb29rdXAuaApA
QCAtMjcsNyArMjcsNyBAQCB0Yl9sb29rdXBfX2NwdV9zdGF0ZShDUFVTdGF0ZSAqY3B1LCB0YXJn
ZXRfdWxvbmcgKnBjLCB0YXJnZXRfdWxvbmcgKmNzX2Jhc2UsCiAKICAgICBjcHVfZ2V0X3RiX2Nw
dV9zdGF0ZShlbnYsIHBjLCBjc19iYXNlLCBmbGFncyk7CiAgICAgaGFzaCA9IHRiX2ptcF9jYWNo
ZV9oYXNoX2Z1bmMoKnBjKTsKLSAgICB0YiA9IGF0b21pY19yY3VfcmVhZCgmY3B1LT50Yl9qbXBf
Y2FjaGVbaGFzaF0pOworICAgIHRiID0gcWF0b21pY19yY3VfcmVhZCgmY3B1LT50Yl9qbXBfY2Fj
aGVbaGFzaF0pOwogCiAgICAgY2ZfbWFzayAmPSB+Q0ZfQ0xVU1RFUl9NQVNLOwogICAgIGNmX21h
c2sgfD0gY3B1LT5jbHVzdGVyX2luZGV4IDw8IENGX0NMVVNURVJfU0hJRlQ7CkBAIC00NCw3ICs0
NCw3IEBAIHRiX2xvb2t1cF9fY3B1X3N0YXRlKENQVVN0YXRlICpjcHUsIHRhcmdldF91bG9uZyAq
cGMsIHRhcmdldF91bG9uZyAqY3NfYmFzZSwKICAgICBpZiAodGIgPT0gTlVMTCkgewogICAgICAg
ICByZXR1cm4gTlVMTDsKICAgICB9Ci0gICAgYXRvbWljX3NldCgmY3B1LT50Yl9qbXBfY2FjaGVb
aGFzaF0sIHRiKTsKKyAgICBxYXRvbWljX3NldCgmY3B1LT50Yl9qbXBfY2FjaGVbaGFzaF0sIHRi
KTsKICAgICByZXR1cm4gdGI7CiB9CiAKZGlmZiAtLWdpdCBhL2luY2x1ZGUvaHcvY29yZS9jcHUu
aCBiL2luY2x1ZGUvaHcvY29yZS9jcHUuaAppbmRleCA5OWRjMzNmZmViLi42YzM0Nzk4YzhiIDEw
MDY0NAotLS0gYS9pbmNsdWRlL2h3L2NvcmUvY3B1LmgKKysrIGIvaW5jbHVkZS9ody9jb3JlL2Nw
dS5oCkBAIC00ODIsNyArNDgyLDcgQEAgc3RhdGljIGlubGluZSB2b2lkIGNwdV90Yl9qbXBfY2Fj
aGVfY2xlYXIoQ1BVU3RhdGUgKmNwdSkKICAgICB1bnNpZ25lZCBpbnQgaTsKIAogICAgIGZvciAo
aSA9IDA7IGkgPCBUQl9KTVBfQ0FDSEVfU0laRTsgaSsrKSB7Ci0gICAgICAgIGF0b21pY19zZXQo
JmNwdS0+dGJfam1wX2NhY2hlW2ldLCBOVUxMKTsKKyAgICAgICAgcWF0b21pY19zZXQoJmNwdS0+
dGJfam1wX2NhY2hlW2ldLCBOVUxMKTsKICAgICB9CiB9CiAKZGlmZiAtLWdpdCBhL2luY2x1ZGUv
cWVtdS9hdG9taWMxMjguaCBiL2luY2x1ZGUvcWVtdS9hdG9taWMxMjguaAppbmRleCA2YjM0NDg0
ZTE1Li5hZDJiY2Y0NWI0IDEwMDY0NAotLS0gYS9pbmNsdWRlL3FlbXUvYXRvbWljMTI4LmgKKysr
IGIvaW5jbHVkZS9xZW11L2F0b21pYzEyOC5oCkBAIC00NCw3ICs0NCw3IEBACiAjaWYgZGVmaW5l
ZChDT05GSUdfQVRPTUlDMTI4KQogc3RhdGljIGlubGluZSBJbnQxMjggYXRvbWljMTZfY21weGNo
ZyhJbnQxMjggKnB0ciwgSW50MTI4IGNtcCwgSW50MTI4IG5ldykKIHsKLSAgICByZXR1cm4gYXRv
bWljX2NtcHhjaGdfX25vY2hlY2socHRyLCBjbXAsIG5ldyk7CisgICAgcmV0dXJuIHFhdG9taWNf
Y21weGNoZ19fbm9jaGVjayhwdHIsIGNtcCwgbmV3KTsKIH0KICMgZGVmaW5lIEhBVkVfQ01QWENI
RzEyOCAxCiAjZWxpZiBkZWZpbmVkKENPTkZJR19DTVBYQ0hHMTI4KQpAQCAtODksMTIgKzg5LDEy
IEBAIEludDEyOCBRRU1VX0VSUk9SKCJ1bnN1cHBvcnRlZCBhdG9taWMiKQogI2lmIGRlZmluZWQo
Q09ORklHX0FUT01JQzEyOCkKIHN0YXRpYyBpbmxpbmUgSW50MTI4IGF0b21pYzE2X3JlYWQoSW50
MTI4ICpwdHIpCiB7Ci0gICAgcmV0dXJuIGF0b21pY19yZWFkX19ub2NoZWNrKHB0cik7CisgICAg
cmV0dXJuIHFhdG9taWNfcmVhZF9fbm9jaGVjayhwdHIpOwogfQogCiBzdGF0aWMgaW5saW5lIHZv
aWQgYXRvbWljMTZfc2V0KEludDEyOCAqcHRyLCBJbnQxMjggdmFsKQogewotICAgIGF0b21pY19z
ZXRfX25vY2hlY2socHRyLCB2YWwpOworICAgIHFhdG9taWNfc2V0X19ub2NoZWNrKHB0ciwgdmFs
KTsKIH0KIAogIyBkZWZpbmUgSEFWRV9BVE9NSUMxMjggMQpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9x
ZW11L2JpdG9wcy5oIGIvaW5jbHVkZS9xZW11L2JpdG9wcy5oCmluZGV4IGY1NWNlOGIzMjAuLjNh
Y2JmMzM4NGMgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvcWVtdS9iaXRvcHMuaAorKysgYi9pbmNsdWRl
L3FlbXUvYml0b3BzLmgKQEAgLTUxLDcgKzUxLDcgQEAgc3RhdGljIGlubGluZSB2b2lkIHNldF9i
aXRfYXRvbWljKGxvbmcgbnIsIHVuc2lnbmVkIGxvbmcgKmFkZHIpCiAgICAgdW5zaWduZWQgbG9u
ZyBtYXNrID0gQklUX01BU0sobnIpOwogICAgIHVuc2lnbmVkIGxvbmcgKnAgPSBhZGRyICsgQklU
X1dPUkQobnIpOwogCi0gICAgYXRvbWljX29yKHAsIG1hc2spOworICAgIHFhdG9taWNfb3IocCwg
bWFzayk7CiB9CiAKIC8qKgpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9xZW11L2Nvcm91dGluZS5oIGIv
aW5jbHVkZS9xZW11L2Nvcm91dGluZS5oCmluZGV4IGRmZDI2MWM1YjEuLjg0ZWFiNmUzYmYgMTAw
NjQ0Ci0tLSBhL2luY2x1ZGUvcWVtdS9jb3JvdXRpbmUuaAorKysgYi9pbmNsdWRlL3FlbXUvY29y
b3V0aW5lLmgKQEAgLTE3OSw3ICsxNzksNyBAQCBzdGF0aWMgaW5saW5lIGNvcm91dGluZV9mbiB2
b2lkIHFlbXVfY29fbXV0ZXhfYXNzZXJ0X2xvY2tlZChDb011dGV4ICptdXRleCkKICAgICAgKiBi
ZWNhdXNlIHRoZSBjb25kaXRpb24gd2lsbCBiZSBmYWxzZSBubyBtYXR0ZXIgd2hldGhlciB3ZSBy
ZWFkIE5VTEwgb3IKICAgICAgKiB0aGUgcG9pbnRlciBmb3IgYW55IG90aGVyIGNvcm91dGluZS4K
ICAgICAgKi8KLSAgICBhc3NlcnQoYXRvbWljX3JlYWQoJm11dGV4LT5sb2NrZWQpICYmCisgICAg
YXNzZXJ0KHFhdG9taWNfcmVhZCgmbXV0ZXgtPmxvY2tlZCkgJiYKICAgICAgICAgICAgbXV0ZXgt
PmhvbGRlciA9PSBxZW11X2Nvcm91dGluZV9zZWxmKCkpOwogfQogCmRpZmYgLS1naXQgYS9pbmNs
dWRlL3FlbXUvbG9nLmggYi9pbmNsdWRlL3FlbXUvbG9nLmgKaW5kZXggZjQ3MjRmNzMzMC4uOWI4
MDY2MDIwNyAxMDA2NDQKLS0tIGEvaW5jbHVkZS9xZW11L2xvZy5oCisrKyBiL2luY2x1ZGUvcWVt
dS9sb2cuaApAQCAtMzYsNyArMzYsNyBAQCBzdGF0aWMgaW5saW5lIGJvb2wgcWVtdV9sb2dfc2Vw
YXJhdGUodm9pZCkKICAgICBib29sIHJlcyA9IGZhbHNlOwogCiAgICAgcmN1X3JlYWRfbG9jaygp
OwotICAgIGxvZ2ZpbGUgPSBhdG9taWNfcmN1X3JlYWQoJnFlbXVfbG9nZmlsZSk7CisgICAgbG9n
ZmlsZSA9IHFhdG9taWNfcmN1X3JlYWQoJnFlbXVfbG9nZmlsZSk7CiAgICAgaWYgKGxvZ2ZpbGUg
JiYgbG9nZmlsZS0+ZmQgIT0gc3RkZXJyKSB7CiAgICAgICAgIHJlcyA9IHRydWU7CiAgICAgfQpA
QCAtNzUsNyArNzUsNyBAQCBzdGF0aWMgaW5saW5lIEZJTEUgKnFlbXVfbG9nX2xvY2sodm9pZCkK
IHsKICAgICBRZW11TG9nRmlsZSAqbG9nZmlsZTsKICAgICByY3VfcmVhZF9sb2NrKCk7Ci0gICAg
bG9nZmlsZSA9IGF0b21pY19yY3VfcmVhZCgmcWVtdV9sb2dmaWxlKTsKKyAgICBsb2dmaWxlID0g
cWF0b21pY19yY3VfcmVhZCgmcWVtdV9sb2dmaWxlKTsKICAgICBpZiAobG9nZmlsZSkgewogICAg
ICAgICBxZW11X2Zsb2NrZmlsZShsb2dmaWxlLT5mZCk7CiAgICAgICAgIHJldHVybiBsb2dmaWxl
LT5mZDsKQEAgLTEwMiw3ICsxMDIsNyBAQCBxZW11X2xvZ192cHJpbnRmKGNvbnN0IGNoYXIgKmZt
dCwgdmFfbGlzdCB2YSkKICAgICBRZW11TG9nRmlsZSAqbG9nZmlsZTsKIAogICAgIHJjdV9yZWFk
X2xvY2soKTsKLSAgICBsb2dmaWxlID0gYXRvbWljX3JjdV9yZWFkKCZxZW11X2xvZ2ZpbGUpOwor
ICAgIGxvZ2ZpbGUgPSBxYXRvbWljX3JjdV9yZWFkKCZxZW11X2xvZ2ZpbGUpOwogICAgIGlmIChs
b2dmaWxlKSB7CiAgICAgICAgIHZmcHJpbnRmKGxvZ2ZpbGUtPmZkLCBmbXQsIHZhKTsKICAgICB9
CmRpZmYgLS1naXQgYS9pbmNsdWRlL3FlbXUvcXVldWUuaCBiL2luY2x1ZGUvcWVtdS9xdWV1ZS5o
CmluZGV4IDQ1NmE1YjAxZWUuLmUwMjllN2JmNjYgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvcWVtdS9x
dWV1ZS5oCisrKyBiL2luY2x1ZGUvcWVtdS9xdWV1ZS5oCkBAIC0yMTgsMTIgKzIxOCwxMiBAQCBz
dHJ1Y3QgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBcCiAgICAgICAgIHR5cGVvZihlbG0pIHNhdmVfc2xlX25leHQ7ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgICAgICAgZG8geyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXAogICAgICAgICAgICAgc2F2ZV9zbGVfbmV4dCA9IChlbG0pLT5maWVsZC5zbGVfbmV4dCA9
IChoZWFkKS0+c2xoX2ZpcnN0OyAgICAgICBcCi0gICAgICAgIH0gd2hpbGUgKGF0b21pY19jbXB4
Y2hnKCYoaGVhZCktPnNsaF9maXJzdCwgc2F2ZV9zbGVfbmV4dCwgKGVsbSkpICE9IFwKKyAgICAg
ICAgfSB3aGlsZSAocWF0b21pY19jbXB4Y2hnKCYoaGVhZCktPnNsaF9maXJzdCwgc2F2ZV9zbGVf
bmV4dCwgKGVsbSkpICE9XAogICAgICAgICAgICAgICAgICBzYXZlX3NsZV9uZXh0KTsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiB9IHdoaWxlICgvKkNPTlNU
Q09ORCovMCkKIAogI2RlZmluZSBRU0xJU1RfTU9WRV9BVE9NSUMoZGVzdCwgc3JjKSBkbyB7ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICAgICAgKGRlc3QpLT5zbGhfZmlyc3Qg
PSBhdG9taWNfeGNoZygmKHNyYyktPnNsaF9maXJzdCwgTlVMTCk7ICAgICAgICBcCisgICAgICAg
IChkZXN0KS0+c2xoX2ZpcnN0ID0gcWF0b21pY194Y2hnKCYoc3JjKS0+c2xoX2ZpcnN0LCBOVUxM
KTsgICAgICAgXAogfSB3aGlsZSAoLypDT05TVENPTkQqLzApCiAKICNkZWZpbmUgUVNMSVNUX1JF
TU9WRV9IRUFEKGhlYWQsIGZpZWxkKSBkbyB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBc
CkBAIC0zNzYsNyArMzc2LDggQEAgc3RydWN0IHsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogLyoKICAqIFNpbXBsZSBxdWV1
ZSBhY2Nlc3MgbWV0aG9kcy4KICAqLwotI2RlZmluZSBRU0lNUExFUV9FTVBUWV9BVE9NSUMoaGVh
ZCkgKGF0b21pY19yZWFkKCYoKGhlYWQpLT5zcWhfZmlyc3QpKSA9PSBOVUxMKQorI2RlZmluZSBR
U0lNUExFUV9FTVBUWV9BVE9NSUMoaGVhZCkgXAorICAgIChxYXRvbWljX3JlYWQoJigoaGVhZCkt
PnNxaF9maXJzdCkpID09IE5VTEwpCiAjZGVmaW5lIFFTSU1QTEVRX0VNUFRZKGhlYWQpICAgICAg
ICAoKGhlYWQpLT5zcWhfZmlyc3QgPT0gTlVMTCkKICNkZWZpbmUgUVNJTVBMRVFfRklSU1QoaGVh
ZCkgICAgICAgICgoaGVhZCktPnNxaF9maXJzdCkKICNkZWZpbmUgUVNJTVBMRVFfTkVYVChlbG0s
IGZpZWxkKSAgICgoZWxtKS0+ZmllbGQuc3FlX25leHQpCmRpZmYgLS1naXQgYS9pbmNsdWRlL3Fl
bXUvcmN1LmggYi9pbmNsdWRlL3FlbXUvcmN1LmgKaW5kZXggMGUzNzVlYmUxMy4uNTE1ZDMyN2Nm
MSAxMDA2NDQKLS0tIGEvaW5jbHVkZS9xZW11L3JjdS5oCisrKyBiL2luY2x1ZGUvcWVtdS9yY3Uu
aApAQCAtNzksOCArNzksOCBAQCBzdGF0aWMgaW5saW5lIHZvaWQgcmN1X3JlYWRfbG9jayh2b2lk
KQogICAgICAgICByZXR1cm47CiAgICAgfQogCi0gICAgY3RyID0gYXRvbWljX3JlYWQoJnJjdV9n
cF9jdHIpOwotICAgIGF0b21pY19zZXQoJnBfcmN1X3JlYWRlci0+Y3RyLCBjdHIpOworICAgIGN0
ciA9IHFhdG9taWNfcmVhZCgmcmN1X2dwX2N0cik7CisgICAgcWF0b21pY19zZXQoJnBfcmN1X3Jl
YWRlci0+Y3RyLCBjdHIpOwogCiAgICAgLyogV3JpdGUgcF9yY3VfcmVhZGVyLT5jdHIgYmVmb3Jl
IHJlYWRpbmcgUkNVLXByb3RlY3RlZCBwb2ludGVycy4gICovCiAgICAgc21wX21iX3BsYWNlaG9s
ZGVyKCk7CkBAIC0xMDAsMTIgKzEwMCwxMiBAQCBzdGF0aWMgaW5saW5lIHZvaWQgcmN1X3JlYWRf
dW5sb2NrKHZvaWQpCiAgICAgICogc21wX21iX3BsYWNlaG9sZGVyKCksIHRoaXMgZW5zdXJlcyB3
cml0ZXMgdG8gcF9yY3VfcmVhZGVyLT5jdHIKICAgICAgKiBhcmUgc2VxdWVudGlhbGx5IGNvbnNp
c3RlbnQuCiAgICAgICovCi0gICAgYXRvbWljX3N0b3JlX3JlbGVhc2UoJnBfcmN1X3JlYWRlci0+
Y3RyLCAwKTsKKyAgICBxYXRvbWljX3N0b3JlX3JlbGVhc2UoJnBfcmN1X3JlYWRlci0+Y3RyLCAw
KTsKIAogICAgIC8qIFdyaXRlIHBfcmN1X3JlYWRlci0+Y3RyIGJlZm9yZSByZWFkaW5nIHBfcmN1
X3JlYWRlci0+d2FpdGluZy4gICovCiAgICAgc21wX21iX3BsYWNlaG9sZGVyKCk7Ci0gICAgaWYg
KHVubGlrZWx5KGF0b21pY19yZWFkKCZwX3JjdV9yZWFkZXItPndhaXRpbmcpKSkgewotICAgICAg
ICBhdG9taWNfc2V0KCZwX3JjdV9yZWFkZXItPndhaXRpbmcsIGZhbHNlKTsKKyAgICBpZiAodW5s
aWtlbHkocWF0b21pY19yZWFkKCZwX3JjdV9yZWFkZXItPndhaXRpbmcpKSkgeworICAgICAgICBx
YXRvbWljX3NldCgmcF9yY3VfcmVhZGVyLT53YWl0aW5nLCBmYWxzZSk7CiAgICAgICAgIHFlbXVf
ZXZlbnRfc2V0KCZyY3VfZ3BfZXZlbnQpOwogICAgIH0KIH0KZGlmZiAtLWdpdCBhL2luY2x1ZGUv
cWVtdS9yY3VfcXVldWUuaCBiL2luY2x1ZGUvcWVtdS9yY3VfcXVldWUuaAppbmRleCA1NTg5NjFj
YzI3Li4wZTUzZGRkNTMwIDEwMDY0NAotLS0gYS9pbmNsdWRlL3FlbXUvcmN1X3F1ZXVlLmgKKysr
IGIvaW5jbHVkZS9xZW11L3JjdV9xdWV1ZS5oCkBAIC0zNiw5ICszNiw5IEBAIGV4dGVybiAiQyIg
ewogLyoKICAqIExpc3QgYWNjZXNzIG1ldGhvZHMuCiAgKi8KLSNkZWZpbmUgUUxJU1RfRU1QVFlf
UkNVKGhlYWQpIChhdG9taWNfcmVhZCgmKGhlYWQpLT5saF9maXJzdCkgPT0gTlVMTCkKLSNkZWZp
bmUgUUxJU1RfRklSU1RfUkNVKGhlYWQpIChhdG9taWNfcmN1X3JlYWQoJihoZWFkKS0+bGhfZmly
c3QpKQotI2RlZmluZSBRTElTVF9ORVhUX1JDVShlbG0sIGZpZWxkKSAoYXRvbWljX3JjdV9yZWFk
KCYoZWxtKS0+ZmllbGQubGVfbmV4dCkpCisjZGVmaW5lIFFMSVNUX0VNUFRZX1JDVShoZWFkKSAo
cWF0b21pY19yZWFkKCYoaGVhZCktPmxoX2ZpcnN0KSA9PSBOVUxMKQorI2RlZmluZSBRTElTVF9G
SVJTVF9SQ1UoaGVhZCkgKHFhdG9taWNfcmN1X3JlYWQoJihoZWFkKS0+bGhfZmlyc3QpKQorI2Rl
ZmluZSBRTElTVF9ORVhUX1JDVShlbG0sIGZpZWxkKSAocWF0b21pY19yY3VfcmVhZCgmKGVsbSkt
PmZpZWxkLmxlX25leHQpKQogCiAvKgogICogTGlzdCBmdW5jdGlvbnMuCkBAIC00Niw3ICs0Niw3
IEBAIGV4dGVybiAiQyIgewogCiAKIC8qCi0gKiAgVGhlIGRpZmZlcmVuY2UgYmV0d2VlbiBhdG9t
aWNfcmVhZC9zZXQgYW5kIGF0b21pY19yY3VfcmVhZC9zZXQKKyAqICBUaGUgZGlmZmVyZW5jZSBi
ZXR3ZWVuIHFhdG9taWNfcmVhZC9zZXQgYW5kIHFhdG9taWNfcmN1X3JlYWQvc2V0CiAgKiAgaXMg
aW4gdGhlIGluY2x1ZGluZyBvZiBhIHJlYWQvd3JpdGUgbWVtb3J5IGJhcnJpZXIgdG8gdGhlIHZv
bGF0aWxlCiAgKiAgYWNjZXNzLiBhdG9taWNfcmN1XyogbWFjcm9zIGluY2x1ZGUgdGhlIG1lbW9y
eSBiYXJyaWVyLCB0aGUKICAqICBwbGFpbiBhdG9taWMgbWFjcm9zIGRvIG5vdC4gVGhlcmVmb3Jl
LCBpdCBzaG91bGQgYmUgY29ycmVjdCB0bwpAQCAtNjYsNyArNjYsNyBAQCBleHRlcm4gIkMiIHsK
ICNkZWZpbmUgUUxJU1RfSU5TRVJUX0FGVEVSX1JDVShsaXN0ZWxtLCBlbG0sIGZpZWxkKSBkbyB7
ICAgIFwKICAgICAoZWxtKS0+ZmllbGQubGVfbmV4dCA9IChsaXN0ZWxtKS0+ZmllbGQubGVfbmV4
dDsgICAgICAgIFwKICAgICAoZWxtKS0+ZmllbGQubGVfcHJldiA9ICYobGlzdGVsbSktPmZpZWxk
LmxlX25leHQ7ICAgICAgIFwKLSAgICBhdG9taWNfcmN1X3NldCgmKGxpc3RlbG0pLT5maWVsZC5s
ZV9uZXh0LCAoZWxtKSk7ICAgICAgIFwKKyAgICBxYXRvbWljX3JjdV9zZXQoJihsaXN0ZWxtKS0+
ZmllbGQubGVfbmV4dCwgKGVsbSkpOyAgICAgIFwKICAgICBpZiAoKGVsbSktPmZpZWxkLmxlX25l
eHQgIT0gTlVMTCkgeyAgICAgICAgICAgICAgICAgICAgIFwKICAgICAgICAoZWxtKS0+ZmllbGQu
bGVfbmV4dC0+ZmllbGQubGVfcHJldiA9ICAgICAgICAgICAgICAgIFwKICAgICAgICAgJihlbG0p
LT5maWVsZC5sZV9uZXh0OyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKQEAgLTgyLDcg
KzgyLDcgQEAgZXh0ZXJuICJDIiB7CiAjZGVmaW5lIFFMSVNUX0lOU0VSVF9CRUZPUkVfUkNVKGxp
c3RlbG0sIGVsbSwgZmllbGQpIGRvIHsgICBcCiAgICAgKGVsbSktPmZpZWxkLmxlX3ByZXYgPSAo
bGlzdGVsbSktPmZpZWxkLmxlX3ByZXY7ICAgICAgICBcCiAgICAgKGVsbSktPmZpZWxkLmxlX25l
eHQgPSAobGlzdGVsbSk7ICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgYXRvbWljX3JjdV9z
ZXQoKGxpc3RlbG0pLT5maWVsZC5sZV9wcmV2LCAoZWxtKSk7ICAgICAgICBcCisgICAgcWF0b21p
Y19yY3Vfc2V0KChsaXN0ZWxtKS0+ZmllbGQubGVfcHJldiwgKGVsbSkpOyAgICAgICBcCiAgICAg
KGxpc3RlbG0pLT5maWVsZC5sZV9wcmV2ID0gJihlbG0pLT5maWVsZC5sZV9uZXh0OyAgICAgICBc
CiB9IHdoaWxlICgvKkNPTlNUQ09ORCovMCkKIApAQCAtOTUsNyArOTUsNyBAQCBleHRlcm4gIkMi
IHsKICNkZWZpbmUgUUxJU1RfSU5TRVJUX0hFQURfUkNVKGhlYWQsIGVsbSwgZmllbGQpIGRvIHsg
ICAgXAogICAgIChlbG0pLT5maWVsZC5sZV9wcmV2ID0gJihoZWFkKS0+bGhfZmlyc3Q7ICAgICAg
ICAgICBcCiAgICAgKGVsbSktPmZpZWxkLmxlX25leHQgPSAoaGVhZCktPmxoX2ZpcnN0OyAgICAg
ICAgICAgIFwKLSAgICBhdG9taWNfcmN1X3NldCgoJihoZWFkKS0+bGhfZmlyc3QpLCAoZWxtKSk7
ICAgICAgICAgXAorICAgIHFhdG9taWNfcmN1X3NldCgoJihoZWFkKS0+bGhfZmlyc3QpLCAoZWxt
KSk7ICAgICAgICBcCiAgICAgaWYgKChlbG0pLT5maWVsZC5sZV9uZXh0ICE9IE5VTEwpIHsgICAg
ICAgICAgICAgICAgIFwKICAgICAgICAoZWxtKS0+ZmllbGQubGVfbmV4dC0+ZmllbGQubGVfcHJl
diA9ICAgICAgICAgICAgXAogICAgICAgICAmKGVsbSktPmZpZWxkLmxlX25leHQ7ICAgICAgICAg
ICAgICAgICAgICAgICAgICBcCkBAIC0xMTIsMjAgKzExMiwyMCBAQCBleHRlcm4gIkMiIHsKICAg
ICAgICAoZWxtKS0+ZmllbGQubGVfbmV4dC0+ZmllbGQubGVfcHJldiA9ICAgICAgICBcCiAgICAg
ICAgIChlbG0pLT5maWVsZC5sZV9wcmV2OyAgICAgICAgICAgICAgICAgICAgICAgXAogICAgIH0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICBhdG9t
aWNfc2V0KChlbG0pLT5maWVsZC5sZV9wcmV2LCAoZWxtKS0+ZmllbGQubGVfbmV4dCk7IFwKKyAg
ICBxYXRvbWljX3NldCgoZWxtKS0+ZmllbGQubGVfcHJldiwgKGVsbSktPmZpZWxkLmxlX25leHQp
OyBcCiB9IHdoaWxlICgvKkNPTlNUQ09ORCovMCkKIAogLyogTGlzdCB0cmF2ZXJzYWwgbXVzdCBv
Y2N1ciB3aXRoaW4gYW4gUkNVIGNyaXRpY2FsIHNlY3Rpb24uICAqLwogI2RlZmluZSBRTElTVF9G
T1JFQUNIX1JDVSh2YXIsIGhlYWQsIGZpZWxkKSAgICAgICAgICAgICAgICAgXAotICAgICAgICBm
b3IgKCh2YXIpID0gYXRvbWljX3JjdV9yZWFkKCYoaGVhZCktPmxoX2ZpcnN0KTsgICAgXAorICAg
ICAgICBmb3IgKCh2YXIpID0gcWF0b21pY19yY3VfcmVhZCgmKGhlYWQpLT5saF9maXJzdCk7ICAg
XAogICAgICAgICAgICAgICAgICh2YXIpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgXAotICAgICAgICAgICAgICAgICh2YXIpID0gYXRvbWljX3JjdV9yZWFkKCYodmFyKS0+
ZmllbGQubGVfbmV4dCkpCisgICAgICAgICAgICAgICAgKHZhcikgPSBxYXRvbWljX3JjdV9yZWFk
KCYodmFyKS0+ZmllbGQubGVfbmV4dCkpCiAKIC8qIExpc3QgdHJhdmVyc2FsIG11c3Qgb2NjdXIg
d2l0aGluIGFuIFJDVSBjcml0aWNhbCBzZWN0aW9uLiAgKi8KICNkZWZpbmUgUUxJU1RfRk9SRUFD
SF9TQUZFX1JDVSh2YXIsIGhlYWQsIGZpZWxkLCBuZXh0X3ZhcikgICAgICAgICAgIFwKLSAgICBm
b3IgKCh2YXIpID0gKGF0b21pY19yY3VfcmVhZCgmKGhlYWQpLT5saF9maXJzdCkpOyAgICAgICAg
ICAgICAgIFwKKyAgICBmb3IgKCh2YXIpID0gKHFhdG9taWNfcmN1X3JlYWQoJihoZWFkKS0+bGhf
Zmlyc3QpKTsgICAgICAgICAgICAgIFwKICAgICAgICh2YXIpICYmICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICAgICAgICAoKG5leHRf
dmFyKSA9IGF0b21pY19yY3VfcmVhZCgmKHZhciktPmZpZWxkLmxlX25leHQpLCAxKTsgIFwKKyAg
ICAgICAgICAoKG5leHRfdmFyKSA9IHFhdG9taWNfcmN1X3JlYWQoJih2YXIpLT5maWVsZC5sZV9u
ZXh0KSwgMSk7IFwKICAgICAgICAgICAgKHZhcikgPSAobmV4dF92YXIpKQogCiAvKgpAQCAtMTMz
LDkgKzEzMywxMCBAQCBleHRlcm4gIkMiIHsKICAqLwogCiAvKiBTaW1wbGUgcXVldWUgYWNjZXNz
IG1ldGhvZHMgKi8KLSNkZWZpbmUgUVNJTVBMRVFfRU1QVFlfUkNVKGhlYWQpICAgICAgKGF0b21p
Y19yZWFkKCYoaGVhZCktPnNxaF9maXJzdCkgPT0gTlVMTCkKLSNkZWZpbmUgUVNJTVBMRVFfRklS
U1RfUkNVKGhlYWQpICAgICAgIGF0b21pY19yY3VfcmVhZCgmKGhlYWQpLT5zcWhfZmlyc3QpCi0j
ZGVmaW5lIFFTSU1QTEVRX05FWFRfUkNVKGVsbSwgZmllbGQpICBhdG9taWNfcmN1X3JlYWQoJihl
bG0pLT5maWVsZC5zcWVfbmV4dCkKKyNkZWZpbmUgUVNJTVBMRVFfRU1QVFlfUkNVKGhlYWQpIFwK
KyAgICAocWF0b21pY19yZWFkKCYoaGVhZCktPnNxaF9maXJzdCkgPT0gTlVMTCkKKyNkZWZpbmUg
UVNJTVBMRVFfRklSU1RfUkNVKGhlYWQpICAgICAgIHFhdG9taWNfcmN1X3JlYWQoJihoZWFkKS0+
c3FoX2ZpcnN0KQorI2RlZmluZSBRU0lNUExFUV9ORVhUX1JDVShlbG0sIGZpZWxkKSAgcWF0b21p
Y19yY3VfcmVhZCgmKGVsbSktPmZpZWxkLnNxZV9uZXh0KQogCiAvKiBTaW1wbGUgcXVldWUgZnVu
Y3Rpb25zICovCiAjZGVmaW5lIFFTSU1QTEVRX0lOU0VSVF9IRUFEX1JDVShoZWFkLCBlbG0sIGZp
ZWxkKSBkbyB7ICAgICAgICAgXApAQCAtMTQzLDEyICsxNDQsMTIgQEAgZXh0ZXJuICJDIiB7CiAg
ICAgaWYgKChlbG0pLT5maWVsZC5zcWVfbmV4dCA9PSBOVUxMKSB7ICAgICAgICAgICAgICAgICAg
ICAgICAgXAogICAgICAgICAoaGVhZCktPnNxaF9sYXN0ID0gJihlbG0pLT5maWVsZC5zcWVfbmV4
dDsgICAgICAgICAgICAgIFwKICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgYXRvbWljX3JjdV9zZXQoJihoZWFkKS0+
c3FoX2ZpcnN0LCAoZWxtKSk7ICAgICAgICAgICAgICAgICAgXAorICAgIHFhdG9taWNfcmN1X3Nl
dCgmKGhlYWQpLT5zcWhfZmlyc3QsIChlbG0pKTsgICAgICAgICAgICAgICAgIFwKIH0gd2hpbGUg
KC8qQ09OU1RDT05EKi8wKQogCiAjZGVmaW5lIFFTSU1QTEVRX0lOU0VSVF9UQUlMX1JDVShoZWFk
LCBlbG0sIGZpZWxkKSBkbyB7ICAgIFwKICAgICAoZWxtKS0+ZmllbGQuc3FlX25leHQgPSBOVUxM
OyAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgIGF0b21pY19yY3Vfc2V0KChoZWFkKS0+
c3FoX2xhc3QsIChlbG0pKTsgICAgICAgICAgICAgICBcCisgICAgcWF0b21pY19yY3Vfc2V0KCho
ZWFkKS0+c3FoX2xhc3QsIChlbG0pKTsgICAgICAgICAgICAgIFwKICAgICAoaGVhZCktPnNxaF9s
YXN0ID0gJihlbG0pLT5maWVsZC5zcWVfbmV4dDsgICAgICAgICAgICAgXAogfSB3aGlsZSAoLypD
T05TVENPTkQqLzApCiAKQEAgLTE1NywxMSArMTU4LDExIEBAIGV4dGVybiAiQyIgewogICAgIGlm
ICgoZWxtKS0+ZmllbGQuc3FlX25leHQgPT0gTlVMTCkgeyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgXAogICAgICAgICAoaGVhZCktPnNxaF9sYXN0ID0gJihlbG0pLT5maWVsZC5zcWVf
bmV4dDsgICAgICAgICAgICAgICAgICAgICAgXAogICAgIH0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgIGF0b21p
Y19yY3Vfc2V0KCYobGlzdGVsbSktPmZpZWxkLnNxZV9uZXh0LCAoZWxtKSk7ICAgICAgICAgICAg
ICAgICAgXAorICAgIHFhdG9taWNfcmN1X3NldCgmKGxpc3RlbG0pLT5maWVsZC5zcWVfbmV4dCwg
KGVsbSkpOyAgICAgICAgICAgICAgICAgXAogfSB3aGlsZSAoLypDT05TVENPTkQqLzApCiAKICNk
ZWZpbmUgUVNJTVBMRVFfUkVNT1ZFX0hFQURfUkNVKGhlYWQsIGZpZWxkKSBkbyB7ICAgICAgICAg
ICAgICAgICAgICAgXAotICAgIGF0b21pY19zZXQoJihoZWFkKS0+c3FoX2ZpcnN0LCAoaGVhZCkt
PnNxaF9maXJzdC0+ZmllbGQuc3FlX25leHQpOyBcCisgICAgcWF0b21pY19zZXQoJihoZWFkKS0+
c3FoX2ZpcnN0LCAoaGVhZCktPnNxaF9maXJzdC0+ZmllbGQuc3FlX25leHQpO1wKICAgICBpZiAo
KGhlYWQpLT5zcWhfZmlyc3QgPT0gTlVMTCkgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgXAogICAgICAgICAoaGVhZCktPnNxaF9sYXN0ID0gJihoZWFkKS0+c3FoX2ZpcnN0OyAg
ICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKQEAgLTE3NSw3ICsxNzYs
NyBAQCBleHRlcm4gIkMiIHsKICAgICAgICAgd2hpbGUgKGN1cnItPmZpZWxkLnNxZV9uZXh0ICE9
IChlbG0pKSB7ICAgICAgICAgICAgICAgICAgICAgXAogICAgICAgICAgICAgY3VyciA9IGN1cnIt
PmZpZWxkLnNxZV9uZXh0OyAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgICAgIH0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFwKLSAgICAgICAgYXRvbWljX3NldCgmY3Vyci0+ZmllbGQuc3FlX25leHQsICAgICAgICAgICAg
ICAgICAgICAgICAgICAgXAorICAgICAgICBxYXRvbWljX3NldCgmY3Vyci0+ZmllbGQuc3FlX25l
eHQsICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgICAgICAgICAgICAgICAgY3Vyci0+
ZmllbGQuc3FlX25leHQtPmZpZWxkLnNxZV9uZXh0KTsgICAgICAgICAgIFwKICAgICAgICAgaWYg
KGN1cnItPmZpZWxkLnNxZV9uZXh0ID09IE5VTEwpIHsgICAgICAgICAgICAgICAgICAgICAgICAg
XAogICAgICAgICAgICAgKGhlYWQpLT5zcWhfbGFzdCA9ICYoY3VyciktPmZpZWxkLnNxZV9uZXh0
OyAgICAgICAgICAgICBcCkBAIC0xODQsMTMgKzE4NSwxMyBAQCBleHRlcm4gIkMiIHsKIH0gd2hp
bGUgKC8qQ09OU1RDT05EKi8wKQogCiAjZGVmaW5lIFFTSU1QTEVRX0ZPUkVBQ0hfUkNVKHZhciwg
aGVhZCwgZmllbGQpICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgZm9yICgodmFyKSA9
IGF0b21pY19yY3VfcmVhZCgmKGhlYWQpLT5zcWhfZmlyc3QpOyAgICAgICAgICAgICAgICAgICBc
CisgICAgZm9yICgodmFyKSA9IHFhdG9taWNfcmN1X3JlYWQoJihoZWFkKS0+c3FoX2ZpcnN0KTsg
ICAgICAgICAgICAgICAgICBcCiAgICAgICAgICAodmFyKTsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgICAgICAodmFyKSA9IGF0
b21pY19yY3VfcmVhZCgmKHZhciktPmZpZWxkLnNxZV9uZXh0KSkKKyAgICAgICAgICh2YXIpID0g
cWF0b21pY19yY3VfcmVhZCgmKHZhciktPmZpZWxkLnNxZV9uZXh0KSkKIAogI2RlZmluZSBRU0lN
UExFUV9GT1JFQUNIX1NBRkVfUkNVKHZhciwgaGVhZCwgZmllbGQsIG5leHQpICAgICAgICAgICAg
ICAgIFwKLSAgICBmb3IgKCh2YXIpID0gYXRvbWljX3JjdV9yZWFkKCYoaGVhZCktPnNxaF9maXJz
dCk7ICAgICAgICAgICAgICAgICAgICBcCi0gICAgICAgICAodmFyKSAmJiAoKG5leHQpID0gYXRv
bWljX3JjdV9yZWFkKCYodmFyKS0+ZmllbGQuc3FlX25leHQpLCAxKTsgXAorICAgIGZvciAoKHZh
cikgPSBxYXRvbWljX3JjdV9yZWFkKCYoaGVhZCktPnNxaF9maXJzdCk7ICAgICAgICAgICAgICAg
ICAgIFwKKyAgICAgICAgICh2YXIpICYmICgobmV4dCkgPSBxYXRvbWljX3JjdV9yZWFkKCYodmFy
KS0+ZmllbGQuc3FlX25leHQpLCAxKTtcCiAgICAgICAgICAodmFyKSA9IChuZXh0KSkKIAogLyoK
QEAgLTE5OCw5ICsxOTksOSBAQCBleHRlcm4gIkMiIHsKICAqLwogCiAvKiBUYWlsIHF1ZXVlIGFj
Y2VzcyBtZXRob2RzICovCi0jZGVmaW5lIFFUQUlMUV9FTVBUWV9SQ1UoaGVhZCkgICAgICAoYXRv
bWljX3JlYWQoJihoZWFkKS0+dHFoX2ZpcnN0KSA9PSBOVUxMKQotI2RlZmluZSBRVEFJTFFfRklS
U1RfUkNVKGhlYWQpICAgICAgIGF0b21pY19yY3VfcmVhZCgmKGhlYWQpLT50cWhfZmlyc3QpCi0j
ZGVmaW5lIFFUQUlMUV9ORVhUX1JDVShlbG0sIGZpZWxkKSAgYXRvbWljX3JjdV9yZWFkKCYoZWxt
KS0+ZmllbGQudHFlX25leHQpCisjZGVmaW5lIFFUQUlMUV9FTVBUWV9SQ1UoaGVhZCkgICAgICAo
cWF0b21pY19yZWFkKCYoaGVhZCktPnRxaF9maXJzdCkgPT0gTlVMTCkKKyNkZWZpbmUgUVRBSUxR
X0ZJUlNUX1JDVShoZWFkKSAgICAgICBxYXRvbWljX3JjdV9yZWFkKCYoaGVhZCktPnRxaF9maXJz
dCkKKyNkZWZpbmUgUVRBSUxRX05FWFRfUkNVKGVsbSwgZmllbGQpICBxYXRvbWljX3JjdV9yZWFk
KCYoZWxtKS0+ZmllbGQudHFlX25leHQpCiAKIC8qIFRhaWwgcXVldWUgZnVuY3Rpb25zICovCiAj
ZGVmaW5lIFFUQUlMUV9JTlNFUlRfSEVBRF9SQ1UoaGVhZCwgZWxtLCBmaWVsZCkgZG8geyAgICAg
ICAgICAgICAgICAgICBcCkBAIC0yMTEsMTQgKzIxMiwxNCBAQCBleHRlcm4gIkMiIHsKICAgICB9
IGVsc2UgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIFwKICAgICAgICAgKGhlYWQpLT50cWhfY2lyYy50cWxfcHJldiA9ICYoZWxtKS0+
ZmllbGQudHFlX2NpcmM7ICAgICAgICAgICAgIFwKICAgICB9ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICBhdG9t
aWNfcmN1X3NldCgmKGhlYWQpLT50cWhfZmlyc3QsIChlbG0pKTsgICAgICAgICAgICAgICAgICAg
ICAgICAgIFwKKyAgICBxYXRvbWljX3JjdV9zZXQoJihoZWFkKS0+dHFoX2ZpcnN0LCAoZWxtKSk7
ICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgICAoZWxtKS0+ZmllbGQudHFlX2NpcmMudHFs
X3ByZXYgPSAmKGhlYWQpLT50cWhfY2lyYzsgICAgICAgICAgICAgICAgIFwKIH0gd2hpbGUgKC8q
Q09OU1RDT05EKi8wKQogCiAjZGVmaW5lIFFUQUlMUV9JTlNFUlRfVEFJTF9SQ1UoaGVhZCwgZWxt
LCBmaWVsZCkgZG8geyAgICAgICAgICAgICAgICAgICBcCiAgICAgKGVsbSktPmZpZWxkLnRxZV9u
ZXh0ID0gTlVMTDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAg
KGVsbSktPmZpZWxkLnRxZV9jaXJjLnRxbF9wcmV2ID0gKGhlYWQpLT50cWhfY2lyYy50cWxfcHJl
djsgICAgICAgICBcCi0gICAgYXRvbWljX3JjdV9zZXQoJihoZWFkKS0+dHFoX2NpcmMudHFsX3By
ZXYtPnRxbF9uZXh0LCAoZWxtKSk7ICAgICAgICBcCisgICAgcWF0b21pY19yY3Vfc2V0KCYoaGVh
ZCktPnRxaF9jaXJjLnRxbF9wcmV2LT50cWxfbmV4dCwgKGVsbSkpOyAgICAgICBcCiAgICAgKGhl
YWQpLT50cWhfY2lyYy50cWxfcHJldiA9ICYoZWxtKS0+ZmllbGQudHFlX2NpcmM7ICAgICAgICAg
ICAgICAgICBcCiB9IHdoaWxlICgvKkNPTlNUQ09ORCovMCkKIApAQCAtMjMwLDE0ICsyMzEsMTQg
QEAgZXh0ZXJuICJDIiB7CiAgICAgfSBlbHNlIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgICAgIChoZWFkKS0+dHFoX2Np
cmMudHFsX3ByZXYgPSAmKGVsbSktPmZpZWxkLnRxZV9jaXJjOyAgICAgICAgICAgICBcCiAgICAg
fSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBcCi0gICAgYXRvbWljX3JjdV9zZXQoJihsaXN0ZWxtKS0+ZmllbGQudHFlX25l
eHQsIChlbG0pKTsgICAgICAgICAgICAgICAgICBcCisgICAgcWF0b21pY19yY3Vfc2V0KCYobGlz
dGVsbSktPmZpZWxkLnRxZV9uZXh0LCAoZWxtKSk7ICAgICAgICAgICAgICAgICBcCiAgICAgKGVs
bSktPmZpZWxkLnRxZV9jaXJjLnRxbF9wcmV2ID0gJihsaXN0ZWxtKS0+ZmllbGQudHFlX2NpcmM7
ICAgICAgICBcCiB9IHdoaWxlICgvKkNPTlNUQ09ORCovMCkKIAogI2RlZmluZSBRVEFJTFFfSU5T
RVJUX0JFRk9SRV9SQ1UobGlzdGVsbSwgZWxtLCBmaWVsZCkgZG8geyAgICAgICAgICAgICAgICBc
CiAgICAgKGVsbSktPmZpZWxkLnRxZV9jaXJjLnRxbF9wcmV2ID0gKGxpc3RlbG0pLT5maWVsZC50
cWVfY2lyYy50cWxfcHJldjsgIFwKICAgICAoZWxtKS0+ZmllbGQudHFlX25leHQgPSAobGlzdGVs
bSk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgIGF0b21pY19yY3Vf
c2V0KCYobGlzdGVsbSktPmZpZWxkLnRxZV9jaXJjLnRxbF9wcmV2LT50cWxfbmV4dCwgKGVsbSkp
OyBcCisgICAgcWF0b21pY19yY3Vfc2V0KCYobGlzdGVsbSktPmZpZWxkLnRxZV9jaXJjLnRxbF9w
cmV2LT50cWxfbmV4dCwgKGVsbSkpO1wKICAgICAobGlzdGVsbSktPmZpZWxkLnRxZV9jaXJjLnRx
bF9wcmV2ID0gJihlbG0pLT5maWVsZC50cWVfY2lyYzsgICAgICAgICAgXAogfSB3aGlsZSAoLypD
T05TVENPTkQqLzApCiAKQEAgLTI0OCwxOCArMjQ5LDE5IEBAIGV4dGVybiAiQyIgewogICAgIH0g
ZWxzZSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgXAogICAgICAgICAoaGVhZCktPnRxaF9jaXJjLnRxbF9wcmV2ID0gKGVsbSktPmZp
ZWxkLnRxZV9jaXJjLnRxbF9wcmV2OyAgICAgXAogICAgIH0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgIGF0b21p
Y19zZXQoJihlbG0pLT5maWVsZC50cWVfY2lyYy50cWxfcHJldi0+dHFsX25leHQsIChlbG0pLT5m
aWVsZC50cWVfbmV4dCk7IFwKKyAgICBxYXRvbWljX3NldCgmKGVsbSktPmZpZWxkLnRxZV9jaXJj
LnRxbF9wcmV2LT50cWxfbmV4dCwgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAoZWxt
KS0+ZmllbGQudHFlX25leHQpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAg
ICAoZWxtKS0+ZmllbGQudHFlX2NpcmMudHFsX3ByZXYgPSBOVUxMOyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFwKIH0gd2hpbGUgKC8qQ09OU1RDT05EKi8wKQogCiAjZGVmaW5lIFFUQUlM
UV9GT1JFQUNIX1JDVSh2YXIsIGhlYWQsIGZpZWxkKSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBcCi0gICAgZm9yICgodmFyKSA9IGF0b21pY19yY3VfcmVhZCgmKGhlYWQpLT50cWhfZmlyc3Qp
OyAgICAgICAgICAgICAgICAgICBcCisgICAgZm9yICgodmFyKSA9IHFhdG9taWNfcmN1X3JlYWQo
JihoZWFkKS0+dHFoX2ZpcnN0KTsgICAgICAgICAgICAgICAgICBcCiAgICAgICAgICAodmFyKTsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBc
Ci0gICAgICAgICAodmFyKSA9IGF0b21pY19yY3VfcmVhZCgmKHZhciktPmZpZWxkLnRxZV9uZXh0
KSkKKyAgICAgICAgICh2YXIpID0gcWF0b21pY19yY3VfcmVhZCgmKHZhciktPmZpZWxkLnRxZV9u
ZXh0KSkKIAogI2RlZmluZSBRVEFJTFFfRk9SRUFDSF9TQUZFX1JDVSh2YXIsIGhlYWQsIGZpZWxk
LCBuZXh0KSAgICAgICAgICAgICAgICAgIFwKLSAgICBmb3IgKCh2YXIpID0gYXRvbWljX3JjdV9y
ZWFkKCYoaGVhZCktPnRxaF9maXJzdCk7ICAgICAgICAgICAgICAgICAgICBcCi0gICAgICAgICAo
dmFyKSAmJiAoKG5leHQpID0gYXRvbWljX3JjdV9yZWFkKCYodmFyKS0+ZmllbGQudHFlX25leHQp
LCAxKTsgXAorICAgIGZvciAoKHZhcikgPSBxYXRvbWljX3JjdV9yZWFkKCYoaGVhZCktPnRxaF9m
aXJzdCk7ICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICh2YXIpICYmICgobmV4dCkgPSBx
YXRvbWljX3JjdV9yZWFkKCYodmFyKS0+ZmllbGQudHFlX25leHQpLCAxKTtcCiAgICAgICAgICAo
dmFyKSA9IChuZXh0KSkKIAogLyoKQEAgLTI2NywyMyArMjY5LDIzIEBAIGV4dGVybiAiQyIgewog
ICovCiAKIC8qIFNpbmdseS1saW5rZWQgbGlzdCBhY2Nlc3MgbWV0aG9kcyAqLwotI2RlZmluZSBR
U0xJU1RfRU1QVFlfUkNVKGhlYWQpICAgICAgKGF0b21pY19yZWFkKCYoaGVhZCktPnNsaF9maXJz
dCkgPT0gTlVMTCkKLSNkZWZpbmUgUVNMSVNUX0ZJUlNUX1JDVShoZWFkKSAgICAgICBhdG9taWNf
cmN1X3JlYWQoJihoZWFkKS0+c2xoX2ZpcnN0KQotI2RlZmluZSBRU0xJU1RfTkVYVF9SQ1UoZWxt
LCBmaWVsZCkgIGF0b21pY19yY3VfcmVhZCgmKGVsbSktPmZpZWxkLnNsZV9uZXh0KQorI2RlZmlu
ZSBRU0xJU1RfRU1QVFlfUkNVKGhlYWQpICAgICAgKHFhdG9taWNfcmVhZCgmKGhlYWQpLT5zbGhf
Zmlyc3QpID09IE5VTEwpCisjZGVmaW5lIFFTTElTVF9GSVJTVF9SQ1UoaGVhZCkgICAgICAgcWF0
b21pY19yY3VfcmVhZCgmKGhlYWQpLT5zbGhfZmlyc3QpCisjZGVmaW5lIFFTTElTVF9ORVhUX1JD
VShlbG0sIGZpZWxkKSAgcWF0b21pY19yY3VfcmVhZCgmKGVsbSktPmZpZWxkLnNsZV9uZXh0KQog
CiAvKiBTaW5nbHktbGlua2VkIGxpc3QgZnVuY3Rpb25zICovCiAjZGVmaW5lIFFTTElTVF9JTlNF
UlRfSEVBRF9SQ1UoaGVhZCwgZWxtLCBmaWVsZCkgZG8geyAgICAgICAgICAgXAogICAgIChlbG0p
LT5maWVsZC5zbGVfbmV4dCA9IChoZWFkKS0+c2xoX2ZpcnN0OyAgICAgICAgICAgICAgICAgIFwK
LSAgICBhdG9taWNfcmN1X3NldCgmKGhlYWQpLT5zbGhfZmlyc3QsIChlbG0pKTsgICAgICAgICAg
ICAgICAgICBcCisgICAgcWF0b21pY19yY3Vfc2V0KCYoaGVhZCktPnNsaF9maXJzdCwgKGVsbSkp
OyAgICAgICAgICAgICAgICAgXAogfSB3aGlsZSAoLypDT05TVENPTkQqLzApCiAKICNkZWZpbmUg
UVNMSVNUX0lOU0VSVF9BRlRFUl9SQ1UoaGVhZCwgbGlzdGVsbSwgZWxtLCBmaWVsZCkgZG8geyAg
ICAgICAgIFwKICAgICAoZWxtKS0+ZmllbGQuc2xlX25leHQgPSAobGlzdGVsbSktPmZpZWxkLnNs
ZV9uZXh0OyAgICAgICAgICAgICAgICAgIFwKLSAgICBhdG9taWNfcmN1X3NldCgmKGxpc3RlbG0p
LT5maWVsZC5zbGVfbmV4dCwgKGVsbSkpOyAgICAgICAgICAgICAgICAgIFwKKyAgICBxYXRvbWlj
X3JjdV9zZXQoJihsaXN0ZWxtKS0+ZmllbGQuc2xlX25leHQsIChlbG0pKTsgICAgICAgICAgICAg
ICAgIFwKIH0gd2hpbGUgKC8qQ09OU1RDT05EKi8wKQogCiAjZGVmaW5lIFFTTElTVF9SRU1PVkVf
SEVBRF9SQ1UoaGVhZCwgZmllbGQpIGRvIHsgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICBh
dG9taWNfc2V0KCYoaGVhZCktPnNsaF9maXJzdCwgKGhlYWQpLT5zbGhfZmlyc3QtPmZpZWxkLnNs
ZV9uZXh0KTsgXAorICAgIHFhdG9taWNfc2V0KCYoaGVhZCktPnNsaF9maXJzdCwgKGhlYWQpLT5z
bGhfZmlyc3QtPmZpZWxkLnNsZV9uZXh0KTtcCiB9IHdoaWxlICgvKkNPTlNUQ09ORCovMCkKIAog
I2RlZmluZSBRU0xJU1RfUkVNT1ZFX1JDVShoZWFkLCBlbG0sIHR5cGUsIGZpZWxkKSBkbyB7ICAg
ICAgICAgICAgICBcCkBAIC0yOTQsMTkgKzI5NiwxOSBAQCBleHRlcm4gIkMiIHsKICAgICAgICAg
d2hpbGUgKGN1cnItPmZpZWxkLnNsZV9uZXh0ICE9IChlbG0pKSB7ICAgICAgICAgICAgICAgICAg
ICAgXAogICAgICAgICAgICAgY3VyciA9IGN1cnItPmZpZWxkLnNsZV9uZXh0OyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBcCiAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICAgICAgYXRvbWljX3NldCgmY3Vy
ci0+ZmllbGQuc2xlX25leHQsICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICBx
YXRvbWljX3NldCgmY3Vyci0+ZmllbGQuc2xlX25leHQsICAgICAgICAgICAgICAgICAgICAgICAg
ICBcCiAgICAgICAgICAgICAgICAgICAgY3Vyci0+ZmllbGQuc2xlX25leHQtPmZpZWxkLnNsZV9u
ZXh0KTsgICAgICAgICAgIFwKICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogfSB3aGlsZSAoLypDT05TVENPTkQqLzAp
CiAKICNkZWZpbmUgUVNMSVNUX0ZPUkVBQ0hfUkNVKHZhciwgaGVhZCwgZmllbGQpICAgICAgICAg
ICAgICAgICAgICAgICAgICBcCi0gICAgZm9yICgodmFyKSA9IGF0b21pY19yY3VfcmVhZCgmKGhl
YWQpLT5zbGhfZmlyc3QpOyAgICAgICAgICAgICAgICAgICBcCi0gICAgICAgICAodmFyKTsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0g
ICAgICAgICAodmFyKSA9IGF0b21pY19yY3VfcmVhZCgmKHZhciktPmZpZWxkLnNsZV9uZXh0KSkK
KyAgICBmb3IgKCh2YXIpID0gcWF0b21pY19yY3VfcmVhZCgmKGhlYWQpLT5zbGhfZmlyc3QpOyAg
ICAgICAgICAgICAgICBcCisgICAgICAgICAodmFyKTsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgKHZhcikgPSBxYXRvbWlj
X3JjdV9yZWFkKCYodmFyKS0+ZmllbGQuc2xlX25leHQpKQogCi0jZGVmaW5lIFFTTElTVF9GT1JF
QUNIX1NBRkVfUkNVKHZhciwgaGVhZCwgZmllbGQsIG5leHQpICAgICAgICAgICAgICAgIFwKLSAg
ICBmb3IgKCh2YXIpID0gYXRvbWljX3JjdV9yZWFkKCYoaGVhZCktPnNsaF9maXJzdCk7ICAgICAg
ICAgICAgICAgICAgICBcCi0gICAgICAgICAodmFyKSAmJiAoKG5leHQpID0gYXRvbWljX3JjdV9y
ZWFkKCYodmFyKS0+ZmllbGQuc2xlX25leHQpLCAxKTsgXAorI2RlZmluZSBRU0xJU1RfRk9SRUFD
SF9TQUZFX1JDVSh2YXIsIGhlYWQsIGZpZWxkLCBuZXh0KSAgICAgICAgICAgICAgICAgICBcCisg
ICAgZm9yICgodmFyKSA9IHFhdG9taWNfcmN1X3JlYWQoJihoZWFkKS0+c2xoX2ZpcnN0KTsgICAg
ICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICh2YXIpICYmICgobmV4dCkgPSBxYXRvbWljX3Jj
dV9yZWFkKCYodmFyKS0+ZmllbGQuc2xlX25leHQpLCAxKTsgXAogICAgICAgICAgKHZhcikgPSAo
bmV4dCkpCiAKICNpZmRlZiBfX2NwbHVzcGx1cwpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9xZW11L3Nl
cWxvY2suaCBiL2luY2x1ZGUvcWVtdS9zZXFsb2NrLmgKaW5kZXggOGI2YjRlZTRiYi4uZWNiN2Qy
Yzg2NCAxMDA2NDQKLS0tIGEvaW5jbHVkZS9xZW11L3NlcWxvY2suaAorKysgYi9pbmNsdWRlL3Fl
bXUvc2VxbG9jay5oCkBAIC0zMiw3ICszMiw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBzZXFsb2Nr
X2luaXQoUWVtdVNlcUxvY2sgKnNsKQogLyogTG9jayBvdXQgb3RoZXIgd3JpdGVycyBhbmQgdXBk
YXRlIHRoZSBjb3VudC4gICovCiBzdGF0aWMgaW5saW5lIHZvaWQgc2VxbG9ja193cml0ZV9iZWdp
bihRZW11U2VxTG9jayAqc2wpCiB7Ci0gICAgYXRvbWljX3NldCgmc2wtPnNlcXVlbmNlLCBzbC0+
c2VxdWVuY2UgKyAxKTsKKyAgICBxYXRvbWljX3NldCgmc2wtPnNlcXVlbmNlLCBzbC0+c2VxdWVu
Y2UgKyAxKTsKIAogICAgIC8qIFdyaXRlIHNlcXVlbmNlIGJlZm9yZSB1cGRhdGluZyBvdGhlciBm
aWVsZHMuICAqLwogICAgIHNtcF93bWIoKTsKQEAgLTQzLDcgKzQzLDcgQEAgc3RhdGljIGlubGlu
ZSB2b2lkIHNlcWxvY2tfd3JpdGVfZW5kKFFlbXVTZXFMb2NrICpzbCkKICAgICAvKiBXcml0ZSBv
dGhlciBmaWVsZHMgYmVmb3JlIGZpbmFsaXppbmcgc2VxdWVuY2UuICAqLwogICAgIHNtcF93bWIo
KTsKIAotICAgIGF0b21pY19zZXQoJnNsLT5zZXF1ZW5jZSwgc2wtPnNlcXVlbmNlICsgMSk7Cisg
ICAgcWF0b21pY19zZXQoJnNsLT5zZXF1ZW5jZSwgc2wtPnNlcXVlbmNlICsgMSk7CiB9CiAKIC8q
IExvY2sgb3V0IG90aGVyIHdyaXRlcnMgYW5kIHVwZGF0ZSB0aGUgY291bnQuICAqLwpAQCAtNjgs
NyArNjgsNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgc2VxbG9ja193cml0ZV91bmxvY2tfaW1wbChR
ZW11U2VxTG9jayAqc2wsIFFlbXVMb2NrYWJsZSAqbG9jawogc3RhdGljIGlubGluZSB1bnNpZ25l
ZCBzZXFsb2NrX3JlYWRfYmVnaW4oY29uc3QgUWVtdVNlcUxvY2sgKnNsKQogewogICAgIC8qIEFs
d2F5cyBmYWlsIGlmIGEgd3JpdGUgaXMgaW4gcHJvZ3Jlc3MuICAqLwotICAgIHVuc2lnbmVkIHJl
dCA9IGF0b21pY19yZWFkKCZzbC0+c2VxdWVuY2UpOworICAgIHVuc2lnbmVkIHJldCA9IHFhdG9t
aWNfcmVhZCgmc2wtPnNlcXVlbmNlKTsKIAogICAgIC8qIFJlYWQgc2VxdWVuY2UgYmVmb3JlIHJl
YWRpbmcgb3RoZXIgZmllbGRzLiAgKi8KICAgICBzbXBfcm1iKCk7CkBAIC03OSw3ICs3OSw3IEBA
IHN0YXRpYyBpbmxpbmUgaW50IHNlcWxvY2tfcmVhZF9yZXRyeShjb25zdCBRZW11U2VxTG9jayAq
c2wsIHVuc2lnbmVkIHN0YXJ0KQogewogICAgIC8qIFJlYWQgb3RoZXIgZmllbGRzIGJlZm9yZSBy
ZWFkaW5nIGZpbmFsIHNlcXVlbmNlLiAgKi8KICAgICBzbXBfcm1iKCk7Ci0gICAgcmV0dXJuIHVu
bGlrZWx5KGF0b21pY19yZWFkKCZzbC0+c2VxdWVuY2UpICE9IHN0YXJ0KTsKKyAgICByZXR1cm4g
dW5saWtlbHkocWF0b21pY19yZWFkKCZzbC0+c2VxdWVuY2UpICE9IHN0YXJ0KTsKIH0KIAogI2Vu
ZGlmCmRpZmYgLS1naXQgYS9pbmNsdWRlL3FlbXUvc3RhdHM2NC5oIGIvaW5jbHVkZS9xZW11L3N0
YXRzNjQuaAppbmRleCAxOWE1YWM0YzU2Li5mZGQzZDFiOGY5IDEwMDY0NAotLS0gYS9pbmNsdWRl
L3FlbXUvc3RhdHM2NC5oCisrKyBiL2luY2x1ZGUvcWVtdS9zdGF0czY0LmgKQEAgLTM3LDI3ICsz
NywyNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgc3RhdDY0X2luaXQoU3RhdDY0ICpzLCB1aW50NjRf
dCB2YWx1ZSkKIAogc3RhdGljIGlubGluZSB1aW50NjRfdCBzdGF0NjRfZ2V0KGNvbnN0IFN0YXQ2
NCAqcykKIHsKLSAgICByZXR1cm4gYXRvbWljX3JlYWRfX25vY2hlY2soJnMtPnZhbHVlKTsKKyAg
ICByZXR1cm4gcWF0b21pY19yZWFkX19ub2NoZWNrKCZzLT52YWx1ZSk7CiB9CiAKIHN0YXRpYyBp
bmxpbmUgdm9pZCBzdGF0NjRfYWRkKFN0YXQ2NCAqcywgdWludDY0X3QgdmFsdWUpCiB7Ci0gICAg
YXRvbWljX2FkZCgmcy0+dmFsdWUsIHZhbHVlKTsKKyAgICBxYXRvbWljX2FkZCgmcy0+dmFsdWUs
IHZhbHVlKTsKIH0KIAogc3RhdGljIGlubGluZSB2b2lkIHN0YXQ2NF9taW4oU3RhdDY0ICpzLCB1
aW50NjRfdCB2YWx1ZSkKIHsKLSAgICB1aW50NjRfdCBvcmlnID0gYXRvbWljX3JlYWRfX25vY2hl
Y2soJnMtPnZhbHVlKTsKKyAgICB1aW50NjRfdCBvcmlnID0gcWF0b21pY19yZWFkX19ub2NoZWNr
KCZzLT52YWx1ZSk7CiAgICAgd2hpbGUgKG9yaWcgPiB2YWx1ZSkgewotICAgICAgICBvcmlnID0g
YXRvbWljX2NtcHhjaGdfX25vY2hlY2soJnMtPnZhbHVlLCBvcmlnLCB2YWx1ZSk7CisgICAgICAg
IG9yaWcgPSBxYXRvbWljX2NtcHhjaGdfX25vY2hlY2soJnMtPnZhbHVlLCBvcmlnLCB2YWx1ZSk7
CiAgICAgfQogfQogCiBzdGF0aWMgaW5saW5lIHZvaWQgc3RhdDY0X21heChTdGF0NjQgKnMsIHVp
bnQ2NF90IHZhbHVlKQogewotICAgIHVpbnQ2NF90IG9yaWcgPSBhdG9taWNfcmVhZF9fbm9jaGVj
aygmcy0+dmFsdWUpOworICAgIHVpbnQ2NF90IG9yaWcgPSBxYXRvbWljX3JlYWRfX25vY2hlY2so
JnMtPnZhbHVlKTsKICAgICB3aGlsZSAob3JpZyA8IHZhbHVlKSB7Ci0gICAgICAgIG9yaWcgPSBh
dG9taWNfY21weGNoZ19fbm9jaGVjaygmcy0+dmFsdWUsIG9yaWcsIHZhbHVlKTsKKyAgICAgICAg
b3JpZyA9IHFhdG9taWNfY21weGNoZ19fbm9jaGVjaygmcy0+dmFsdWUsIG9yaWcsIHZhbHVlKTsK
ICAgICB9CiB9CiAjZWxzZQpAQCAtNzksNyArNzksNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgc3Rh
dDY0X2FkZChTdGF0NjQgKnMsIHVpbnQ2NF90IHZhbHVlKQogICAgIGxvdyA9ICh1aW50MzJfdCkg
dmFsdWU7CiAgICAgaWYgKCFsb3cpIHsKICAgICAgICAgaWYgKGhpZ2gpIHsKLSAgICAgICAgICAg
IGF0b21pY19hZGQoJnMtPmhpZ2gsIGhpZ2gpOworICAgICAgICAgICAgcWF0b21pY19hZGQoJnMt
PmhpZ2gsIGhpZ2gpOwogICAgICAgICB9CiAgICAgICAgIHJldHVybjsKICAgICB9CkBAIC0xMDEs
NyArMTAxLDcgQEAgc3RhdGljIGlubGluZSB2b2lkIHN0YXQ2NF9hZGQoU3RhdDY0ICpzLCB1aW50
NjRfdCB2YWx1ZSkKICAgICAgICAgICogdGhlIGhpZ2ggMzIgYml0cywgc28gaXQgY2FuIHJhY2Ug
anVzdCBmaW5lIHdpdGggc3RhdDY0X2FkZDMyX2NhcnJ5CiAgICAgICAgICAqIGFuZCBldmVuIHN0
YXQ2NF9nZXQhCiAgICAgICAgICAqLwotICAgICAgICBvbGQgPSBhdG9taWNfY21weGNoZygmcy0+
bG93LCBvcmlnLCByZXN1bHQpOworICAgICAgICBvbGQgPSBxYXRvbWljX2NtcHhjaGcoJnMtPmxv
dywgb3JpZywgcmVzdWx0KTsKICAgICAgICAgaWYgKG9yaWcgPT0gb2xkKSB7CiAgICAgICAgICAg
ICByZXR1cm47CiAgICAgICAgIH0KQEAgLTExNiw3ICsxMTYsNyBAQCBzdGF0aWMgaW5saW5lIHZv
aWQgc3RhdDY0X21pbihTdGF0NjQgKnMsIHVpbnQ2NF90IHZhbHVlKQogICAgIGhpZ2ggPSB2YWx1
ZSA+PiAzMjsKICAgICBsb3cgPSAodWludDMyX3QpIHZhbHVlOwogICAgIGRvIHsKLSAgICAgICAg
b3JpZ19oaWdoID0gYXRvbWljX3JlYWQoJnMtPmhpZ2gpOworICAgICAgICBvcmlnX2hpZ2ggPSBx
YXRvbWljX3JlYWQoJnMtPmhpZ2gpOwogICAgICAgICBpZiAob3JpZ19oaWdoIDwgaGlnaCkgewog
ICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICB9CkBAIC0xMjgsNyArMTI4LDcgQEAgc3RhdGlj
IGlubGluZSB2b2lkIHN0YXQ2NF9taW4oU3RhdDY0ICpzLCB1aW50NjRfdCB2YWx1ZSkKICAgICAg
ICAgICAgICAqIHRoZSB3cml0ZSBiYXJyaWVyIGluIHN0YXQ2NF9taW5fc2xvdy4KICAgICAgICAg
ICAgICAqLwogICAgICAgICAgICAgc21wX3JtYigpOwotICAgICAgICAgICAgb3JpZ19sb3cgPSBh
dG9taWNfcmVhZCgmcy0+bG93KTsKKyAgICAgICAgICAgIG9yaWdfbG93ID0gcWF0b21pY19yZWFk
KCZzLT5sb3cpOwogICAgICAgICAgICAgaWYgKG9yaWdfbG93IDw9IGxvdykgewogICAgICAgICAg
ICAgICAgIHJldHVybjsKICAgICAgICAgICAgIH0KQEAgLTEzOCw3ICsxMzgsNyBAQCBzdGF0aWMg
aW5saW5lIHZvaWQgc3RhdDY0X21pbihTdGF0NjQgKnMsIHVpbnQ2NF90IHZhbHVlKQogICAgICAg
ICAgICAgICogd2UgbWF5IG1pc3MgYmVpbmcgbHVja3kuCiAgICAgICAgICAgICAgKi8KICAgICAg
ICAgICAgIHNtcF9ybWIoKTsKLSAgICAgICAgICAgIG9yaWdfaGlnaCA9IGF0b21pY19yZWFkKCZz
LT5oaWdoKTsKKyAgICAgICAgICAgIG9yaWdfaGlnaCA9IHFhdG9taWNfcmVhZCgmcy0+aGlnaCk7
CiAgICAgICAgICAgICBpZiAob3JpZ19oaWdoIDwgaGlnaCkgewogICAgICAgICAgICAgICAgIHJl
dHVybjsKICAgICAgICAgICAgIH0KQEAgLTE1Niw3ICsxNTYsNyBAQCBzdGF0aWMgaW5saW5lIHZv
aWQgc3RhdDY0X21heChTdGF0NjQgKnMsIHVpbnQ2NF90IHZhbHVlKQogICAgIGhpZ2ggPSB2YWx1
ZSA+PiAzMjsKICAgICBsb3cgPSAodWludDMyX3QpIHZhbHVlOwogICAgIGRvIHsKLSAgICAgICAg
b3JpZ19oaWdoID0gYXRvbWljX3JlYWQoJnMtPmhpZ2gpOworICAgICAgICBvcmlnX2hpZ2ggPSBx
YXRvbWljX3JlYWQoJnMtPmhpZ2gpOwogICAgICAgICBpZiAob3JpZ19oaWdoID4gaGlnaCkgewog
ICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICB9CkBAIC0xNjgsNyArMTY4LDcgQEAgc3RhdGlj
IGlubGluZSB2b2lkIHN0YXQ2NF9tYXgoU3RhdDY0ICpzLCB1aW50NjRfdCB2YWx1ZSkKICAgICAg
ICAgICAgICAqIHRoZSB3cml0ZSBiYXJyaWVyIGluIHN0YXQ2NF9tYXhfc2xvdy4KICAgICAgICAg
ICAgICAqLwogICAgICAgICAgICAgc21wX3JtYigpOwotICAgICAgICAgICAgb3JpZ19sb3cgPSBh
dG9taWNfcmVhZCgmcy0+bG93KTsKKyAgICAgICAgICAgIG9yaWdfbG93ID0gcWF0b21pY19yZWFk
KCZzLT5sb3cpOwogICAgICAgICAgICAgaWYgKG9yaWdfbG93ID49IGxvdykgewogICAgICAgICAg
ICAgICAgIHJldHVybjsKICAgICAgICAgICAgIH0KQEAgLTE3OCw3ICsxNzgsNyBAQCBzdGF0aWMg
aW5saW5lIHZvaWQgc3RhdDY0X21heChTdGF0NjQgKnMsIHVpbnQ2NF90IHZhbHVlKQogICAgICAg
ICAgICAgICogd2UgbWF5IG1pc3MgYmVpbmcgbHVja3kuCiAgICAgICAgICAgICAgKi8KICAgICAg
ICAgICAgIHNtcF9ybWIoKTsKLSAgICAgICAgICAgIG9yaWdfaGlnaCA9IGF0b21pY19yZWFkKCZz
LT5oaWdoKTsKKyAgICAgICAgICAgIG9yaWdfaGlnaCA9IHFhdG9taWNfcmVhZCgmcy0+aGlnaCk7
CiAgICAgICAgICAgICBpZiAob3JpZ19oaWdoID4gaGlnaCkgewogICAgICAgICAgICAgICAgIHJl
dHVybjsKICAgICAgICAgICAgIH0KZGlmZiAtLWdpdCBhL2luY2x1ZGUvcWVtdS90aHJlYWQuaCBi
L2luY2x1ZGUvcWVtdS90aHJlYWQuaAppbmRleCA0YmFmNGQxNzE1Li41NDM1NzYzMTg0IDEwMDY0
NAotLS0gYS9pbmNsdWRlL3FlbXUvdGhyZWFkLmgKKysrIGIvaW5jbHVkZS9xZW11L3RocmVhZC5o
CkBAIC03MCwzMyArNzAsMzMgQEAgZXh0ZXJuIFFlbXVDb25kVGltZWRXYWl0RnVuYyBxZW11X2Nv
bmRfdGltZWR3YWl0X2Z1bmM7CiAgICAgICAgICAgICBxZW11X2NvbmRfdGltZWR3YWl0X2ltcGwo
YywgbSwgbXMsIF9fRklMRV9fLCBfX0xJTkVfXykKICNlbHNlCiAjZGVmaW5lIHFlbXVfbXV0ZXhf
bG9jayhtKSAoeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0g
ICAgICAgICAgICBRZW11TXV0ZXhMb2NrRnVuYyBfZiA9IGF0b21pY19yZWFkKCZxZW11X211dGV4
X2xvY2tfZnVuYyk7ICBcCisgICAgICAgICAgICBRZW11TXV0ZXhMb2NrRnVuYyBfZiA9IHFhdG9t
aWNfcmVhZCgmcWVtdV9tdXRleF9sb2NrX2Z1bmMpOyBcCiAgICAgICAgICAgICBfZihtLCBfX0ZJ
TEVfXywgX19MSU5FX18pOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAg
ICAgIH0pCiAKLSNkZWZpbmUgcWVtdV9tdXRleF90cnlsb2NrKG0pICh7ICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICAgICAgICAgIFFlbXVNdXRleFRyeWxvY2tG
dW5jIF9mID0gYXRvbWljX3JlYWQoJnFlbXVfbXV0ZXhfdHJ5bG9ja19mdW5jKTsgXAotICAgICAg
ICAgICAgX2YobSwgX19GSUxFX18sIF9fTElORV9fKTsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgXAorI2RlZmluZSBxZW11X211dGV4X3RyeWxvY2sobSkgKHsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgUWVtdU11dGV4
VHJ5bG9ja0Z1bmMgX2YgPSBxYXRvbWljX3JlYWQoJnFlbXVfbXV0ZXhfdHJ5bG9ja19mdW5jKTsg
XAorICAgICAgICAgICAgX2YobSwgX19GSUxFX18sIF9fTElORV9fKTsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgXAogICAgICAgICB9KQogCi0jZGVmaW5lIHFlbXVfcmVj
X211dGV4X2xvY2sobSkgKHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBc
Ci0gICAgICAgICAgICBRZW11UmVjTXV0ZXhMb2NrRnVuYyBfZiA9IGF0b21pY19yZWFkKCZxZW11
X3JlY19tdXRleF9sb2NrX2Z1bmMpOyBcCi0gICAgICAgICAgICBfZihtLCBfX0ZJTEVfXywgX19M
SU5FX18pOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisjZGVmaW5lIHFlbXVf
cmVjX211dGV4X2xvY2sobSkgKHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCisgICAgICAgICAgICBRZW11UmVjTXV0ZXhMb2NrRnVuYyBfZiA9IHFhdG9taWNf
cmVhZCgmcWVtdV9yZWNfbXV0ZXhfbG9ja19mdW5jKTtcCisgICAgICAgICAgICBfZihtLCBfX0ZJ
TEVfXywgX19MSU5FX18pOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBc
CiAgICAgICAgIH0pCiAKICNkZWZpbmUgcWVtdV9yZWNfbXV0ZXhfdHJ5bG9jayhtKSAoeyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgICAgICAgICBRZW11UmVjTXV0ZXhUcnlsb2Nr
RnVuYyBfZjsgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgICAgICAgICAgX2YgPSBhdG9t
aWNfcmVhZCgmcWVtdV9yZWNfbXV0ZXhfdHJ5bG9ja19mdW5jKTsgICAgIFwKKyAgICAgICAgICAg
IF9mID0gcWF0b21pY19yZWFkKCZxZW11X3JlY19tdXRleF90cnlsb2NrX2Z1bmMpOyAgICBcCiAg
ICAgICAgICAgICBfZihtLCBfX0ZJTEVfXywgX19MSU5FX18pOyAgICAgICAgICAgICAgICAgICAg
ICAgICAgXAogICAgICAgICB9KQogCiAjZGVmaW5lIHFlbXVfY29uZF93YWl0KGMsIG0pICh7ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgICAgICAgICBRZW11
Q29uZFdhaXRGdW5jIF9mID0gYXRvbWljX3JlYWQoJnFlbXVfY29uZF93YWl0X2Z1bmMpOyAgICBc
CisgICAgICAgICAgICBRZW11Q29uZFdhaXRGdW5jIF9mID0gcWF0b21pY19yZWFkKCZxZW11X2Nv
bmRfd2FpdF9mdW5jKTsgICBcCiAgICAgICAgICAgICBfZihjLCBtLCBfX0ZJTEVfXywgX19MSU5F
X18pOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgICAgIH0pCiAKICNkZWZp
bmUgcWVtdV9jb25kX3RpbWVkd2FpdChjLCBtLCBtcykgKHsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBcCi0gICAgICAgICAgICBRZW11Q29uZFRpbWVkV2FpdEZ1bmMgX2Yg
PSBhdG9taWNfcmVhZCgmcWVtdV9jb25kX3RpbWVkd2FpdF9mdW5jKTsgXAorICAgICAgICAgICAg
UWVtdUNvbmRUaW1lZFdhaXRGdW5jIF9mID0gcWF0b21pY19yZWFkKCZxZW11X2NvbmRfdGltZWR3
YWl0X2Z1bmMpO1wKICAgICAgICAgICAgIF9mKGMsIG0sIG1zLCBfX0ZJTEVfXywgX19MSU5FX18p
OyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgICAgIH0pCiAjZW5kaWYK
QEAgLTIzNiw3ICsyMzYsNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgcWVtdV9zcGluX2xvY2soUWVt
dVNwaW4gKnNwaW4pCiAgICAgX190c2FuX211dGV4X3ByZV9sb2NrKHNwaW4sIDApOwogI2VuZGlm
CiAgICAgd2hpbGUgKHVubGlrZWx5KF9fc3luY19sb2NrX3Rlc3RfYW5kX3NldCgmc3Bpbi0+dmFs
dWUsIHRydWUpKSkgewotICAgICAgICB3aGlsZSAoYXRvbWljX3JlYWQoJnNwaW4tPnZhbHVlKSkg
eworICAgICAgICB3aGlsZSAocWF0b21pY19yZWFkKCZzcGluLT52YWx1ZSkpIHsKICAgICAgICAg
ICAgIGNwdV9yZWxheCgpOwogICAgICAgICB9CiAgICAgfQpAQCAtMjYxLDcgKzI2MSw3IEBAIHN0
YXRpYyBpbmxpbmUgYm9vbCBxZW11X3NwaW5fdHJ5bG9jayhRZW11U3BpbiAqc3BpbikKIAogc3Rh
dGljIGlubGluZSBib29sIHFlbXVfc3Bpbl9sb2NrZWQoUWVtdVNwaW4gKnNwaW4pCiB7Ci0gICAg
cmV0dXJuIGF0b21pY19yZWFkKCZzcGluLT52YWx1ZSk7CisgICAgcmV0dXJuIHFhdG9taWNfcmVh
ZCgmc3Bpbi0+dmFsdWUpOwogfQogCiBzdGF0aWMgaW5saW5lIHZvaWQgcWVtdV9zcGluX3VubG9j
ayhRZW11U3BpbiAqc3BpbikKZGlmZiAtLWdpdCBhL2luY2x1ZGUvc3RhbmRhcmQtaGVhZGVycy9k
cml2ZXJzL2luZmluaWJhbmQvaHcvdm13X3B2cmRtYS9wdnJkbWFfcmluZy5oIGIvaW5jbHVkZS9z
dGFuZGFyZC1oZWFkZXJzL2RyaXZlcnMvaW5maW5pYmFuZC9ody92bXdfcHZyZG1hL3B2cmRtYV9y
aW5nLmgKaW5kZXggYWNkNGM4MzQ2ZC4uN2I0MDYyYTFhMSAxMDA2NDQKLS0tIGEvaW5jbHVkZS9z
dGFuZGFyZC1oZWFkZXJzL2RyaXZlcnMvaW5maW5pYmFuZC9ody92bXdfcHZyZG1hL3B2cmRtYV9y
aW5nLmgKKysrIGIvaW5jbHVkZS9zdGFuZGFyZC1oZWFkZXJzL2RyaXZlcnMvaW5maW5pYmFuZC9o
dy92bXdfcHZyZG1hL3B2cmRtYV9yaW5nLmgKQEAgLTY4LDcgKzY4LDcgQEAgc3RhdGljIGlubGlu
ZSBpbnQgcHZyZG1hX2lkeF92YWxpZCh1aW50MzJfdCBpZHgsIHVpbnQzMl90IG1heF9lbGVtcykK
IAogc3RhdGljIGlubGluZSBpbnQzMl90IHB2cmRtYV9pZHgoaW50ICp2YXIsIHVpbnQzMl90IG1h
eF9lbGVtcykKIHsKLQljb25zdCB1bnNpZ25lZCBpbnQgaWR4ID0gYXRvbWljX3JlYWQodmFyKTsK
Kwljb25zdCB1bnNpZ25lZCBpbnQgaWR4ID0gcWF0b21pY19yZWFkKHZhcik7CiAKIAlpZiAocHZy
ZG1hX2lkeF92YWxpZChpZHgsIG1heF9lbGVtcykpCiAJCXJldHVybiBpZHggJiAobWF4X2VsZW1z
IC0gMSk7CkBAIC03NywxNyArNzcsMTcgQEAgc3RhdGljIGlubGluZSBpbnQzMl90IHB2cmRtYV9p
ZHgoaW50ICp2YXIsIHVpbnQzMl90IG1heF9lbGVtcykKIAogc3RhdGljIGlubGluZSB2b2lkIHB2
cmRtYV9pZHhfcmluZ19pbmMoaW50ICp2YXIsIHVpbnQzMl90IG1heF9lbGVtcykKIHsKLQl1aW50
MzJfdCBpZHggPSBhdG9taWNfcmVhZCh2YXIpICsgMTsJLyogSW5jcmVtZW50LiAqLworCXVpbnQz
Ml90IGlkeCA9IHFhdG9taWNfcmVhZCh2YXIpICsgMTsJLyogSW5jcmVtZW50LiAqLwogCiAJaWR4
ICY9IChtYXhfZWxlbXMgPDwgMSkgLSAxOwkJLyogTW9kdWxvIHNpemUsIGZsaXAgZ2VuLiAqLwot
CWF0b21pY19zZXQodmFyLCBpZHgpOworCXFhdG9taWNfc2V0KHZhciwgaWR4KTsKIH0KIAogc3Rh
dGljIGlubGluZSBpbnQzMl90IHB2cmRtYV9pZHhfcmluZ19oYXNfc3BhY2UoY29uc3Qgc3RydWN0
IHB2cmRtYV9yaW5nICpyLAogCQkJCQkgICAgICB1aW50MzJfdCBtYXhfZWxlbXMsIHVpbnQzMl90
ICpvdXRfdGFpbCkKIHsKLQljb25zdCB1aW50MzJfdCB0YWlsID0gYXRvbWljX3JlYWQoJnItPnBy
b2RfdGFpbCk7Ci0JY29uc3QgdWludDMyX3QgaGVhZCA9IGF0b21pY19yZWFkKCZyLT5jb25zX2hl
YWQpOworCWNvbnN0IHVpbnQzMl90IHRhaWwgPSBxYXRvbWljX3JlYWQoJnItPnByb2RfdGFpbCk7
CisJY29uc3QgdWludDMyX3QgaGVhZCA9IHFhdG9taWNfcmVhZCgmci0+Y29uc19oZWFkKTsKIAog
CWlmIChwdnJkbWFfaWR4X3ZhbGlkKHRhaWwsIG1heF9lbGVtcykgJiYKIAkgICAgcHZyZG1hX2lk
eF92YWxpZChoZWFkLCBtYXhfZWxlbXMpKSB7CkBAIC0xMDAsOCArMTAwLDggQEAgc3RhdGljIGlu
bGluZSBpbnQzMl90IHB2cmRtYV9pZHhfcmluZ19oYXNfc3BhY2UoY29uc3Qgc3RydWN0IHB2cmRt
YV9yaW5nICpyLAogc3RhdGljIGlubGluZSBpbnQzMl90IHB2cmRtYV9pZHhfcmluZ19oYXNfZGF0
YShjb25zdCBzdHJ1Y3QgcHZyZG1hX3JpbmcgKnIsCiAJCQkJCSAgICAgdWludDMyX3QgbWF4X2Vs
ZW1zLCB1aW50MzJfdCAqb3V0X2hlYWQpCiB7Ci0JY29uc3QgdWludDMyX3QgdGFpbCA9IGF0b21p
Y19yZWFkKCZyLT5wcm9kX3RhaWwpOwotCWNvbnN0IHVpbnQzMl90IGhlYWQgPSBhdG9taWNfcmVh
ZCgmci0+Y29uc19oZWFkKTsKKwljb25zdCB1aW50MzJfdCB0YWlsID0gcWF0b21pY19yZWFkKCZy
LT5wcm9kX3RhaWwpOworCWNvbnN0IHVpbnQzMl90IGhlYWQgPSBxYXRvbWljX3JlYWQoJnItPmNv
bnNfaGVhZCk7CiAKIAlpZiAocHZyZG1hX2lkeF92YWxpZCh0YWlsLCBtYXhfZWxlbXMpICYmCiAJ
ICAgIHB2cmRtYV9pZHhfdmFsaWQoaGVhZCwgbWF4X2VsZW1zKSkgewpkaWZmIC0tZ2l0IGEvbGlu
dXgtdXNlci9xZW11LmggYi9saW51eC11c2VyL3FlbXUuaAppbmRleCBhNjlhMGJkMzQ3Li45NDFj
YTk5NzIyIDEwMDY0NAotLS0gYS9saW51eC11c2VyL3FlbXUuaAorKysgYi9saW51eC11c2VyL3Fl
bXUuaApAQCAtMTQ2LDcgKzE0Niw3IEBAIHR5cGVkZWYgc3RydWN0IFRhc2tTdGF0ZSB7CiAgICAg
LyogTm9uemVybyBpZiBwcm9jZXNzX3BlbmRpbmdfc2lnbmFscygpIG5lZWRzIHRvIGRvIHNvbWV0
aGluZyAoZWl0aGVyCiAgICAgICogaGFuZGxlIGEgcGVuZGluZyBzaWduYWwgb3IgdW5ibG9jayBz
aWduYWxzKS4KICAgICAgKiBUaGlzIGZsYWcgaXMgd3JpdHRlbiBmcm9tIGEgc2lnbmFsIGhhbmRs
ZXIgc28gc2hvdWxkIGJlIGFjY2Vzc2VkIHZpYQotICAgICAqIHRoZSBhdG9taWNfcmVhZCgpIGFu
ZCBhdG9taWNfc2V0KCkgZnVuY3Rpb25zLiAoSXQgaXMgbm90IGFjY2Vzc2VkCisgICAgICogdGhl
IHFhdG9taWNfcmVhZCgpIGFuZCBxYXRvbWljX3NldCgpIGZ1bmN0aW9ucy4gKEl0IGlzIG5vdCBh
Y2Nlc3NlZAogICAgICAqIGZyb20gbXVsdGlwbGUgdGhyZWFkcy4pCiAgICAgICovCiAgICAgaW50
IHNpZ25hbF9wZW5kaW5nOwpkaWZmIC0tZ2l0IGEvdGNnL2kzODYvdGNnLXRhcmdldC5oIGIvdGNn
L2kzODYvdGNnLXRhcmdldC5oCmluZGV4IDk5YWMxZTM5NTguLmQyYmFmNzk2YjAgMTAwNjQ0Ci0t
LSBhL3RjZy9pMzg2L3RjZy10YXJnZXQuaAorKysgYi90Y2cvaTM4Ni90Y2ctdGFyZ2V0LmgKQEAg
LTIxNSw3ICsyMTUsNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgdGJfdGFyZ2V0X3NldF9qbXBfdGFy
Z2V0KHVpbnRwdHJfdCB0Y19wdHIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHVpbnRwdHJfdCBqbXBfYWRkciwgdWludHB0cl90IGFkZHIpCiB7CiAgICAgLyog
cGF0Y2ggdGhlIGJyYW5jaCBkZXN0aW5hdGlvbiAqLwotICAgIGF0b21pY19zZXQoKGludDMyX3Qg
KilqbXBfYWRkciwgYWRkciAtIChqbXBfYWRkciArIDQpKTsKKyAgICBxYXRvbWljX3NldCgoaW50
MzJfdCAqKWptcF9hZGRyLCBhZGRyIC0gKGptcF9hZGRyICsgNCkpOwogICAgIC8qIG5vIG5lZWQg
dG8gZmx1c2ggaWNhY2hlIGV4cGxpY2l0bHkgKi8KIH0KIApkaWZmIC0tZ2l0IGEvdGNnL3MzOTAv
dGNnLXRhcmdldC5oIGIvdGNnL3MzOTAvdGNnLXRhcmdldC5oCmluZGV4IDA3YWNjYWJiZDEuLjYz
Yzg3OTdiZDMgMTAwNjQ0Ci0tLSBhL3RjZy9zMzkwL3RjZy10YXJnZXQuaAorKysgYi90Y2cvczM5
MC90Y2ctdGFyZ2V0LmgKQEAgLTE1NCw3ICsxNTQsNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgdGJf
dGFyZ2V0X3NldF9qbXBfdGFyZ2V0KHVpbnRwdHJfdCB0Y19wdHIsCiB7CiAgICAgLyogcGF0Y2gg
dGhlIGJyYW5jaCBkZXN0aW5hdGlvbiAqLwogICAgIGludHB0cl90IGRpc3AgPSBhZGRyIC0gKGpt
cF9hZGRyIC0gMik7Ci0gICAgYXRvbWljX3NldCgoaW50MzJfdCAqKWptcF9hZGRyLCBkaXNwIC8g
Mik7CisgICAgcWF0b21pY19zZXQoKGludDMyX3QgKilqbXBfYWRkciwgZGlzcCAvIDIpOwogICAg
IC8qIG5vIG5lZWQgdG8gZmx1c2ggaWNhY2hlIGV4cGxpY2l0bHkgKi8KIH0KIApkaWZmIC0tZ2l0
IGEvdGNnL3RjaS90Y2ctdGFyZ2V0LmggYi90Y2cvdGNpL3RjZy10YXJnZXQuaAppbmRleCA4Yjkw
YWI3MWNiLi44YzFjMWQyNjVkIDEwMDY0NAotLS0gYS90Y2cvdGNpL3RjZy10YXJnZXQuaAorKysg
Yi90Y2cvdGNpL3RjZy10YXJnZXQuaApAQCAtMjA2LDcgKzIwNiw3IEBAIHN0YXRpYyBpbmxpbmUg
dm9pZCB0Yl90YXJnZXRfc2V0X2ptcF90YXJnZXQodWludHB0cl90IHRjX3B0ciwKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludHB0cl90IGptcF9hZGRyLCB1
aW50cHRyX3QgYWRkcikKIHsKICAgICAvKiBwYXRjaCB0aGUgYnJhbmNoIGRlc3RpbmF0aW9uICov
Ci0gICAgYXRvbWljX3NldCgoaW50MzJfdCAqKWptcF9hZGRyLCBhZGRyIC0gKGptcF9hZGRyICsg
NCkpOworICAgIHFhdG9taWNfc2V0KChpbnQzMl90ICopam1wX2FkZHIsIGFkZHIgLSAoam1wX2Fk
ZHIgKyA0KSk7CiAgICAgLyogbm8gbmVlZCB0byBmbHVzaCBpY2FjaGUgZXhwbGljaXRseSAqLwog
fQogCmRpZmYgLS1naXQgYS9hY2NlbC9rdm0va3ZtLWFsbC5jIGIvYWNjZWwva3ZtL2t2bS1hbGwu
YwppbmRleCBhZDhiMzE1YjM1Li5lNGJiZjc4MzY2IDEwMDY0NAotLS0gYS9hY2NlbC9rdm0va3Zt
LWFsbC5jCisrKyBiL2FjY2VsL2t2bS9rdm0tYWxsLmMKQEAgLTIzNzksNyArMjM3OSw3IEBAIHN0
YXRpYyBfX3RocmVhZCBib29sIGhhdmVfc2lnYnVzX3BlbmRpbmc7CiAKIHN0YXRpYyB2b2lkIGt2
bV9jcHVfa2ljayhDUFVTdGF0ZSAqY3B1KQogewotICAgIGF0b21pY19zZXQoJmNwdS0+a3ZtX3J1
bi0+aW1tZWRpYXRlX2V4aXQsIDEpOworICAgIHFhdG9taWNfc2V0KCZjcHUtPmt2bV9ydW4tPmlt
bWVkaWF0ZV9leGl0LCAxKTsKIH0KIAogc3RhdGljIHZvaWQga3ZtX2NwdV9raWNrX3NlbGYodm9p
ZCkKQEAgLTI0MDAsNyArMjQwMCw3IEBAIHN0YXRpYyB2b2lkIGt2bV9lYXRfc2lnbmFscyhDUFVT
dGF0ZSAqY3B1KQogICAgIGludCByOwogCiAgICAgaWYgKGt2bV9pbW1lZGlhdGVfZXhpdCkgewot
ICAgICAgICBhdG9taWNfc2V0KCZjcHUtPmt2bV9ydW4tPmltbWVkaWF0ZV9leGl0LCAwKTsKKyAg
ICAgICAgcWF0b21pY19zZXQoJmNwdS0+a3ZtX3J1bi0+aW1tZWRpYXRlX2V4aXQsIDApOwogICAg
ICAgICAvKiBXcml0ZSBrdm1fcnVuLT5pbW1lZGlhdGVfZXhpdCBiZWZvcmUgdGhlIGNwdS0+ZXhp
dF9yZXF1ZXN0CiAgICAgICAgICAqIHdyaXRlIGluIGt2bV9jcHVfZXhlYy4KICAgICAgICAgICov
CkBAIC0yNDM0LDcgKzI0MzQsNyBAQCBpbnQga3ZtX2NwdV9leGVjKENQVVN0YXRlICpjcHUpCiAg
ICAgRFBSSU5URigia3ZtX2NwdV9leGVjKClcbiIpOwogCiAgICAgaWYgKGt2bV9hcmNoX3Byb2Nl
c3NfYXN5bmNfZXZlbnRzKGNwdSkpIHsKLSAgICAgICAgYXRvbWljX3NldCgmY3B1LT5leGl0X3Jl
cXVlc3QsIDApOworICAgICAgICBxYXRvbWljX3NldCgmY3B1LT5leGl0X3JlcXVlc3QsIDApOwog
ICAgICAgICByZXR1cm4gRVhDUF9ITFQ7CiAgICAgfQogCkBAIC0yNDUwLDcgKzI0NTAsNyBAQCBp
bnQga3ZtX2NwdV9leGVjKENQVVN0YXRlICpjcHUpCiAgICAgICAgIH0KIAogICAgICAgICBrdm1f
YXJjaF9wcmVfcnVuKGNwdSwgcnVuKTsKLSAgICAgICAgaWYgKGF0b21pY19yZWFkKCZjcHUtPmV4
aXRfcmVxdWVzdCkpIHsKKyAgICAgICAgaWYgKHFhdG9taWNfcmVhZCgmY3B1LT5leGl0X3JlcXVl
c3QpKSB7CiAgICAgICAgICAgICBEUFJJTlRGKCJpbnRlcnJ1cHQgZXhpdCByZXF1ZXN0ZWRcbiIp
OwogICAgICAgICAgICAgLyoKICAgICAgICAgICAgICAqIEtWTSByZXF1aXJlcyB1cyB0byByZWVu
dGVyIHRoZSBrZXJuZWwgYWZ0ZXIgSU8gZXhpdHMgdG8gY29tcGxldGUKQEAgLTI1NzcsNyArMjU3
Nyw3IEBAIGludCBrdm1fY3B1X2V4ZWMoQ1BVU3RhdGUgKmNwdSkKICAgICAgICAgdm1fc3RvcChS
VU5fU1RBVEVfSU5URVJOQUxfRVJST1IpOwogICAgIH0KIAotICAgIGF0b21pY19zZXQoJmNwdS0+
ZXhpdF9yZXF1ZXN0LCAwKTsKKyAgICBxYXRvbWljX3NldCgmY3B1LT5leGl0X3JlcXVlc3QsIDAp
OwogICAgIHJldHVybiByZXQ7CiB9CiAKQEAgLTI5OTQsNyArMjk5NCw3IEBAIGludCBrdm1fb25f
c2lnYnVzX3ZjcHUoQ1BVU3RhdGUgKmNwdSwgaW50IGNvZGUsIHZvaWQgKmFkZHIpCiAgICAgaGF2
ZV9zaWdidXNfcGVuZGluZyA9IHRydWU7CiAgICAgcGVuZGluZ19zaWdidXNfYWRkciA9IGFkZHI7
CiAgICAgcGVuZGluZ19zaWdidXNfY29kZSA9IGNvZGU7Ci0gICAgYXRvbWljX3NldCgmY3B1LT5l
eGl0X3JlcXVlc3QsIDEpOworICAgIHFhdG9taWNfc2V0KCZjcHUtPmV4aXRfcmVxdWVzdCwgMSk7
CiAgICAgcmV0dXJuIDA7CiAjZWxzZQogICAgIHJldHVybiAxOwpkaWZmIC0tZ2l0IGEvYWNjZWwv
dGNnL2NwdS1leGVjLmMgYi9hY2NlbC90Y2cvY3B1LWV4ZWMuYwppbmRleCA2NmQzOGY5ZDg1Li5l
MTBiNDYyODNjIDEwMDY0NAotLS0gYS9hY2NlbC90Y2cvY3B1LWV4ZWMuYworKysgYi9hY2NlbC90
Y2cvY3B1LWV4ZWMuYwpAQCAtMzY3LDcgKzM2Nyw4IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCB0Yl9h
ZGRfanVtcChUcmFuc2xhdGlvbkJsb2NrICp0YiwgaW50IG4sCiAgICAgICAgIGdvdG8gb3V0X3Vu
bG9ja19uZXh0OwogICAgIH0KICAgICAvKiBBdG9taWNhbGx5IGNsYWltIHRoZSBqdW1wIGRlc3Rp
bmF0aW9uIHNsb3Qgb25seSBpZiBpdCB3YXMgTlVMTCAqLwotICAgIG9sZCA9IGF0b21pY19jbXB4
Y2hnKCZ0Yi0+am1wX2Rlc3Rbbl0sICh1aW50cHRyX3QpTlVMTCwgKHVpbnRwdHJfdCl0Yl9uZXh0
KTsKKyAgICBvbGQgPSBxYXRvbWljX2NtcHhjaGcoJnRiLT5qbXBfZGVzdFtuXSwgKHVpbnRwdHJf
dClOVUxMLAorICAgICAgICAgICAgICAgICAgICAgICAgICAodWludHB0cl90KXRiX25leHQpOwog
ICAgIGlmIChvbGQpIHsKICAgICAgICAgZ290byBvdXRfdW5sb2NrX25leHQ7CiAgICAgfQpAQCAt
NDA3LDcgKzQwOCw3IEBAIHN0YXRpYyBpbmxpbmUgVHJhbnNsYXRpb25CbG9jayAqdGJfZmluZChD
UFVTdGF0ZSAqY3B1LAogICAgICAgICB0YiA9IHRiX2dlbl9jb2RlKGNwdSwgcGMsIGNzX2Jhc2Us
IGZsYWdzLCBjZl9tYXNrKTsKICAgICAgICAgbW1hcF91bmxvY2soKTsKICAgICAgICAgLyogV2Ug
YWRkIHRoZSBUQiBpbiB0aGUgdmlydHVhbCBwYyBoYXNoIHRhYmxlIGZvciB0aGUgZmFzdCBsb29r
dXAgKi8KLSAgICAgICAgYXRvbWljX3NldCgmY3B1LT50Yl9qbXBfY2FjaGVbdGJfam1wX2NhY2hl
X2hhc2hfZnVuYyhwYyldLCB0Yik7CisgICAgICAgIHFhdG9taWNfc2V0KCZjcHUtPnRiX2ptcF9j
YWNoZVt0Yl9qbXBfY2FjaGVfaGFzaF9mdW5jKHBjKV0sIHRiKTsKICAgICB9CiAjaWZuZGVmIENP
TkZJR19VU0VSX09OTFkKICAgICAvKiBXZSBkb24ndCB0YWtlIGNhcmUgb2YgZGlyZWN0IGp1bXBz
IHdoZW4gYWRkcmVzcyBtYXBwaW5nIGNoYW5nZXMgaW4KQEAgLTUzNiw5ICs1MzcsOSBAQCBzdGF0
aWMgaW5saW5lIGJvb2wgY3B1X2hhbmRsZV9pbnRlcnJ1cHQoQ1BVU3RhdGUgKmNwdSwKICAgICAg
KiBFbnN1cmUgemVyb2luZyBoYXBwZW5zIGJlZm9yZSByZWFkaW5nIGNwdS0+ZXhpdF9yZXF1ZXN0
IG9yCiAgICAgICogY3B1LT5pbnRlcnJ1cHRfcmVxdWVzdCAoc2VlIGFsc28gc21wX3dtYiBpbiBj
cHVfZXhpdCgpKQogICAgICAqLwotICAgIGF0b21pY19tYl9zZXQoJmNwdV9uZWcoY3B1KS0+aWNv
dW50X2RlY3IudTE2LmhpZ2gsIDApOworICAgIHFhdG9taWNfbWJfc2V0KCZjcHVfbmVnKGNwdSkt
Pmljb3VudF9kZWNyLnUxNi5oaWdoLCAwKTsKIAotICAgIGlmICh1bmxpa2VseShhdG9taWNfcmVh
ZCgmY3B1LT5pbnRlcnJ1cHRfcmVxdWVzdCkpKSB7CisgICAgaWYgKHVubGlrZWx5KHFhdG9taWNf
cmVhZCgmY3B1LT5pbnRlcnJ1cHRfcmVxdWVzdCkpKSB7CiAgICAgICAgIGludCBpbnRlcnJ1cHRf
cmVxdWVzdDsKICAgICAgICAgcWVtdV9tdXRleF9sb2NrX2lvdGhyZWFkKCk7CiAgICAgICAgIGlu
dGVycnVwdF9yZXF1ZXN0ID0gY3B1LT5pbnRlcnJ1cHRfcmVxdWVzdDsKQEAgLTYxMywxMCArNjE0
LDEwIEBAIHN0YXRpYyBpbmxpbmUgYm9vbCBjcHVfaGFuZGxlX2ludGVycnVwdChDUFVTdGF0ZSAq
Y3B1LAogICAgIH0KIAogICAgIC8qIEZpbmFsbHksIGNoZWNrIGlmIHdlIG5lZWQgdG8gZXhpdCB0
byB0aGUgbWFpbiBsb29wLiAgKi8KLSAgICBpZiAodW5saWtlbHkoYXRvbWljX3JlYWQoJmNwdS0+
ZXhpdF9yZXF1ZXN0KSkKKyAgICBpZiAodW5saWtlbHkocWF0b21pY19yZWFkKCZjcHUtPmV4aXRf
cmVxdWVzdCkpCiAgICAgICAgIHx8ICh1c2VfaWNvdW50CiAgICAgICAgICAgICAmJiBjcHVfbmVn
KGNwdSktPmljb3VudF9kZWNyLnUxNi5sb3cgKyBjcHUtPmljb3VudF9leHRyYSA9PSAwKSkgewot
ICAgICAgICBhdG9taWNfc2V0KCZjcHUtPmV4aXRfcmVxdWVzdCwgMCk7CisgICAgICAgIHFhdG9t
aWNfc2V0KCZjcHUtPmV4aXRfcmVxdWVzdCwgMCk7CiAgICAgICAgIGlmIChjcHUtPmV4Y2VwdGlv
bl9pbmRleCA9PSAtMSkgewogICAgICAgICAgICAgY3B1LT5leGNlcHRpb25faW5kZXggPSBFWENQ
X0lOVEVSUlVQVDsKICAgICAgICAgfQpAQCAtNjQyLDcgKzY0Myw3IEBAIHN0YXRpYyBpbmxpbmUg
dm9pZCBjcHVfbG9vcF9leGVjX3RiKENQVVN0YXRlICpjcHUsIFRyYW5zbGF0aW9uQmxvY2sgKnRi
LAogICAgIH0KIAogICAgICpsYXN0X3RiID0gTlVMTDsKLSAgICBpbnNuc19sZWZ0ID0gYXRvbWlj
X3JlYWQoJmNwdV9uZWcoY3B1KS0+aWNvdW50X2RlY3IudTMyKTsKKyAgICBpbnNuc19sZWZ0ID0g
cWF0b21pY19yZWFkKCZjcHVfbmVnKGNwdSktPmljb3VudF9kZWNyLnUzMik7CiAgICAgaWYgKGlu
c25zX2xlZnQgPCAwKSB7CiAgICAgICAgIC8qIFNvbWV0aGluZyBhc2tlZCB1cyB0byBzdG9wIGV4
ZWN1dGluZyBjaGFpbmVkIFRCczsganVzdAogICAgICAgICAgKiBjb250aW51ZSByb3VuZCB0aGUg
bWFpbiBsb29wLiBXaGF0ZXZlciByZXF1ZXN0ZWQgdGhlIGV4aXQKZGlmZiAtLWdpdCBhL2FjY2Vs
L3RjZy9jcHV0bGIuYyBiL2FjY2VsL3RjZy9jcHV0bGIuYwppbmRleCA2NDg5YWJiZjhjLi5hYWY4
ZTQ2YWU1IDEwMDY0NAotLS0gYS9hY2NlbC90Y2cvY3B1dGxiLmMKKysrIGIvYWNjZWwvdGNnL2Nw
dXRsYi5jCkBAIC0zMTIsOSArMzEyLDkgQEAgdm9pZCB0bGJfZmx1c2hfY291bnRzKHNpemVfdCAq
cGZ1bGwsIHNpemVfdCAqcHBhcnQsIHNpemVfdCAqcGVsaWRlKQogICAgIENQVV9GT1JFQUNIKGNw
dSkgewogICAgICAgICBDUFVBcmNoU3RhdGUgKmVudiA9IGNwdS0+ZW52X3B0cjsKIAotICAgICAg
ICBmdWxsICs9IGF0b21pY19yZWFkKCZlbnZfdGxiKGVudiktPmMuZnVsbF9mbHVzaF9jb3VudCk7
Ci0gICAgICAgIHBhcnQgKz0gYXRvbWljX3JlYWQoJmVudl90bGIoZW52KS0+Yy5wYXJ0X2ZsdXNo
X2NvdW50KTsKLSAgICAgICAgZWxpZGUgKz0gYXRvbWljX3JlYWQoJmVudl90bGIoZW52KS0+Yy5l
bGlkZV9mbHVzaF9jb3VudCk7CisgICAgICAgIGZ1bGwgKz0gcWF0b21pY19yZWFkKCZlbnZfdGxi
KGVudiktPmMuZnVsbF9mbHVzaF9jb3VudCk7CisgICAgICAgIHBhcnQgKz0gcWF0b21pY19yZWFk
KCZlbnZfdGxiKGVudiktPmMucGFydF9mbHVzaF9jb3VudCk7CisgICAgICAgIGVsaWRlICs9IHFh
dG9taWNfcmVhZCgmZW52X3RsYihlbnYpLT5jLmVsaWRlX2ZsdXNoX2NvdW50KTsKICAgICB9CiAg
ICAgKnBmdWxsID0gZnVsbDsKICAgICAqcHBhcnQgPSBwYXJ0OwpAQCAtMzQ5LDEzICszNDksMTMg
QEAgc3RhdGljIHZvaWQgdGxiX2ZsdXNoX2J5X21tdWlkeF9hc3luY193b3JrKENQVVN0YXRlICpj
cHUsIHJ1bl9vbl9jcHVfZGF0YSBkYXRhKQogICAgIGNwdV90Yl9qbXBfY2FjaGVfY2xlYXIoY3B1
KTsKIAogICAgIGlmICh0b19jbGVhbiA9PSBBTExfTU1VSURYX0JJVFMpIHsKLSAgICAgICAgYXRv
bWljX3NldCgmZW52X3RsYihlbnYpLT5jLmZ1bGxfZmx1c2hfY291bnQsCisgICAgICAgIHFhdG9t
aWNfc2V0KCZlbnZfdGxiKGVudiktPmMuZnVsbF9mbHVzaF9jb3VudCwKICAgICAgICAgICAgICAg
ICAgICBlbnZfdGxiKGVudiktPmMuZnVsbF9mbHVzaF9jb3VudCArIDEpOwogICAgIH0gZWxzZSB7
Ci0gICAgICAgIGF0b21pY19zZXQoJmVudl90bGIoZW52KS0+Yy5wYXJ0X2ZsdXNoX2NvdW50LAor
ICAgICAgICBxYXRvbWljX3NldCgmZW52X3RsYihlbnYpLT5jLnBhcnRfZmx1c2hfY291bnQsCiAg
ICAgICAgICAgICAgICAgICAgZW52X3RsYihlbnYpLT5jLnBhcnRfZmx1c2hfY291bnQgKyBjdHBv
cDE2KHRvX2NsZWFuKSk7CiAgICAgICAgIGlmICh0b19jbGVhbiAhPSBhc2tlZCkgewotICAgICAg
ICAgICAgYXRvbWljX3NldCgmZW52X3RsYihlbnYpLT5jLmVsaWRlX2ZsdXNoX2NvdW50LAorICAg
ICAgICAgICAgcWF0b21pY19zZXQoJmVudl90bGIoZW52KS0+Yy5lbGlkZV9mbHVzaF9jb3VudCwK
ICAgICAgICAgICAgICAgICAgICAgICAgZW52X3RsYihlbnYpLT5jLmVsaWRlX2ZsdXNoX2NvdW50
ICsKICAgICAgICAgICAgICAgICAgICAgICAgY3Rwb3AxNihhc2tlZCAmIH50b19jbGVhbikpOwog
ICAgICAgICB9CkBAIC02OTMsNyArNjkzLDcgQEAgdm9pZCB0bGJfdW5wcm90ZWN0X2NvZGUocmFt
X2FkZHJfdCByYW1fYWRkcikKICAqIGdlbmVyYXRlZCBjb2RlLgogICoKICAqIE90aGVyIHZDUFVz
IG1pZ2h0IGJlIHJlYWRpbmcgdGhlaXIgVExCcyBkdXJpbmcgZ3Vlc3QgZXhlY3V0aW9uLCBzbyB3
ZSB1cGRhdGUKLSAqIHRlLT5hZGRyX3dyaXRlIHdpdGggYXRvbWljX3NldC4gV2UgZG9uJ3QgbmVl
ZCB0byB3b3JyeSBhYm91dCB0aGlzIGZvcgorICogdGUtPmFkZHJfd3JpdGUgd2l0aCBxYXRvbWlj
X3NldC4gV2UgZG9uJ3QgbmVlZCB0byB3b3JyeSBhYm91dCB0aGlzIGZvcgogICogb3ZlcnNpemVk
IGd1ZXN0cyBhcyBNVFRDRyBpcyBkaXNhYmxlZCBmb3IgdGhlbS4KICAqCiAgKiBDYWxsZWQgd2l0
aCB0bGJfYy5sb2NrIGhlbGQuCkBAIC03MTEsNyArNzExLDcgQEAgc3RhdGljIHZvaWQgdGxiX3Jl
c2V0X2RpcnR5X3JhbmdlX2xvY2tlZChDUFVUTEJFbnRyeSAqdGxiX2VudHJ5LAogI2lmIFRDR19P
VkVSU0laRURfR1VFU1QKICAgICAgICAgICAgIHRsYl9lbnRyeS0+YWRkcl93cml0ZSB8PSBUTEJf
Tk9URElSVFk7CiAjZWxzZQotICAgICAgICAgICAgYXRvbWljX3NldCgmdGxiX2VudHJ5LT5hZGRy
X3dyaXRlLAorICAgICAgICAgICAgcWF0b21pY19zZXQoJnRsYl9lbnRyeS0+YWRkcl93cml0ZSwK
ICAgICAgICAgICAgICAgICAgICAgICAgdGxiX2VudHJ5LT5hZGRyX3dyaXRlIHwgVExCX05PVERJ
UlRZKTsKICNlbmRpZgogICAgICAgICB9CkBAIC0xMTM4LDggKzExMzgsOCBAQCBzdGF0aWMgaW5s
aW5lIHRhcmdldF91bG9uZyB0bGJfcmVhZF9vZnMoQ1BVVExCRW50cnkgKmVudHJ5LCBzaXplX3Qg
b2ZzKQogI2lmIFRDR19PVkVSU0laRURfR1VFU1QKICAgICByZXR1cm4gKih0YXJnZXRfdWxvbmcg
KikoKHVpbnRwdHJfdCllbnRyeSArIG9mcyk7CiAjZWxzZQotICAgIC8qIG9mcyBtaWdodCBjb3Jy
ZXNwb25kIHRvIC5hZGRyX3dyaXRlLCBzbyB1c2UgYXRvbWljX3JlYWQgKi8KLSAgICByZXR1cm4g
YXRvbWljX3JlYWQoKHRhcmdldF91bG9uZyAqKSgodWludHB0cl90KWVudHJ5ICsgb2ZzKSk7Cisg
ICAgLyogb2ZzIG1pZ2h0IGNvcnJlc3BvbmQgdG8gLmFkZHJfd3JpdGUsIHNvIHVzZSBxYXRvbWlj
X3JlYWQgKi8KKyAgICByZXR1cm4gcWF0b21pY19yZWFkKCh0YXJnZXRfdWxvbmcgKikoKHVpbnRw
dHJfdCllbnRyeSArIG9mcykpOwogI2VuZGlmCiB9CiAKQEAgLTExNTUsMTEgKzExNTUsMTEgQEAg
c3RhdGljIGJvb2wgdmljdGltX3RsYl9oaXQoQ1BVQXJjaFN0YXRlICplbnYsIHNpemVfdCBtbXVf
aWR4LCBzaXplX3QgaW5kZXgsCiAgICAgICAgIENQVVRMQkVudHJ5ICp2dGxiID0gJmVudl90bGIo
ZW52KS0+ZFttbXVfaWR4XS52dGFibGVbdmlkeF07CiAgICAgICAgIHRhcmdldF91bG9uZyBjbXA7
CiAKLSAgICAgICAgLyogZWx0X29mcyBtaWdodCBjb3JyZXNwb25kIHRvIC5hZGRyX3dyaXRlLCBz
byB1c2UgYXRvbWljX3JlYWQgKi8KKyAgICAgICAgLyogZWx0X29mcyBtaWdodCBjb3JyZXNwb25k
IHRvIC5hZGRyX3dyaXRlLCBzbyB1c2UgcWF0b21pY19yZWFkICovCiAjaWYgVENHX09WRVJTSVpF
RF9HVUVTVAogICAgICAgICBjbXAgPSAqKHRhcmdldF91bG9uZyAqKSgodWludHB0cl90KXZ0bGIg
KyBlbHRfb2ZzKTsKICNlbHNlCi0gICAgICAgIGNtcCA9IGF0b21pY19yZWFkKCh0YXJnZXRfdWxv
bmcgKikoKHVpbnRwdHJfdCl2dGxiICsgZWx0X29mcykpOworICAgICAgICBjbXAgPSBxYXRvbWlj
X3JlYWQoKHRhcmdldF91bG9uZyAqKSgodWludHB0cl90KXZ0bGIgKyBlbHRfb2ZzKSk7CiAjZW5k
aWYKIAogICAgICAgICBpZiAoY21wID09IHBhZ2UpIHsKZGlmZiAtLWdpdCBhL2FjY2VsL3RjZy90
Y2ctYWxsLmMgYi9hY2NlbC90Y2cvdGNnLWFsbC5jCmluZGV4IDcwOThhZDk2YzMuLjFjNjY0OTI0
ZDcgMTAwNjQ0Ci0tLSBhL2FjY2VsL3RjZy90Y2ctYWxsLmMKKysrIGIvYWNjZWwvdGNnL3RjZy1h
bGwuYwpAQCAtNjUsNyArNjUsNyBAQCBzdGF0aWMgdm9pZCB0Y2dfaGFuZGxlX2ludGVycnVwdChD
UFVTdGF0ZSAqY3B1LCBpbnQgbWFzaykKICAgICBpZiAoIXFlbXVfY3B1X2lzX3NlbGYoY3B1KSkg
ewogICAgICAgICBxZW11X2NwdV9raWNrKGNwdSk7CiAgICAgfSBlbHNlIHsKLSAgICAgICAgYXRv
bWljX3NldCgmY3B1X25lZyhjcHUpLT5pY291bnRfZGVjci51MTYuaGlnaCwgLTEpOworICAgICAg
ICBxYXRvbWljX3NldCgmY3B1X25lZyhjcHUpLT5pY291bnRfZGVjci51MTYuaGlnaCwgLTEpOwog
ICAgICAgICBpZiAodXNlX2ljb3VudCAmJgogICAgICAgICAgICAgIWNwdS0+Y2FuX2RvX2lvCiAg
ICAgICAgICAgICAmJiAobWFzayAmIH5vbGRfbWFzaykgIT0gMCkgewpkaWZmIC0tZ2l0IGEvYWNj
ZWwvdGNnL3RyYW5zbGF0ZS1hbGwuYyBiL2FjY2VsL3RjZy90cmFuc2xhdGUtYWxsLmMKaW5kZXgg
MmQ4MzAxMzYzMy4uZjQ0YmE5ZDQ2ZCAxMDA2NDQKLS0tIGEvYWNjZWwvdGNnL3RyYW5zbGF0ZS1h
bGwuYworKysgYi9hY2NlbC90Y2cvdHJhbnNsYXRlLWFsbC5jCkBAIC0zNzcsOSArMzc3LDkgQEAg
c3RhdGljIGludCBjcHVfcmVzdG9yZV9zdGF0ZV9mcm9tX3RiKENQVVN0YXRlICpjcHUsIFRyYW5z
bGF0aW9uQmxvY2sgKnRiLAogICAgIHJlc3RvcmVfc3RhdGVfdG9fb3BjKGVudiwgdGIsIGRhdGEp
OwogCiAjaWZkZWYgQ09ORklHX1BST0ZJTEVSCi0gICAgYXRvbWljX3NldCgmcHJvZi0+cmVzdG9y
ZV90aW1lLAorICAgIHFhdG9taWNfc2V0KCZwcm9mLT5yZXN0b3JlX3RpbWUsCiAgICAgICAgICAg
ICAgICAgcHJvZi0+cmVzdG9yZV90aW1lICsgcHJvZmlsZV9nZXRjbG9jaygpIC0gdGkpOwotICAg
IGF0b21pY19zZXQoJnByb2YtPnJlc3RvcmVfY291bnQsIHByb2YtPnJlc3RvcmVfY291bnQgKyAx
KTsKKyAgICBxYXRvbWljX3NldCgmcHJvZi0+cmVzdG9yZV9jb3VudCwgcHJvZi0+cmVzdG9yZV9j
b3VudCArIDEpOwogI2VuZGlmCiAgICAgcmV0dXJuIDA7CiB9CkBAIC01MDksNyArNTA5LDcgQEAg
c3RhdGljIFBhZ2VEZXNjICpwYWdlX2ZpbmRfYWxsb2ModGJfcGFnZV9hZGRyX3QgaW5kZXgsIGlu
dCBhbGxvYykKIAogICAgIC8qIExldmVsIDIuLk4tMS4gICovCiAgICAgZm9yIChpID0gdl9sMl9s
ZXZlbHM7IGkgPiAwOyBpLS0pIHsKLSAgICAgICAgdm9pZCAqKnAgPSBhdG9taWNfcmN1X3JlYWQo
bHApOworICAgICAgICB2b2lkICoqcCA9IHFhdG9taWNfcmN1X3JlYWQobHApOwogCiAgICAgICAg
IGlmIChwID09IE5VTEwpIHsKICAgICAgICAgICAgIHZvaWQgKmV4aXN0aW5nOwpAQCAtNTE4LDcg
KzUxOCw3IEBAIHN0YXRpYyBQYWdlRGVzYyAqcGFnZV9maW5kX2FsbG9jKHRiX3BhZ2VfYWRkcl90
IGluZGV4LCBpbnQgYWxsb2MpCiAgICAgICAgICAgICAgICAgcmV0dXJuIE5VTEw7CiAgICAgICAg
ICAgICB9CiAgICAgICAgICAgICBwID0gZ19uZXcwKHZvaWQgKiwgVl9MMl9TSVpFKTsKLSAgICAg
ICAgICAgIGV4aXN0aW5nID0gYXRvbWljX2NtcHhjaGcobHAsIE5VTEwsIHApOworICAgICAgICAg
ICAgZXhpc3RpbmcgPSBxYXRvbWljX2NtcHhjaGcobHAsIE5VTEwsIHApOwogICAgICAgICAgICAg
aWYgKHVubGlrZWx5KGV4aXN0aW5nKSkgewogICAgICAgICAgICAgICAgIGdfZnJlZShwKTsKICAg
ICAgICAgICAgICAgICBwID0gZXhpc3Rpbmc7CkBAIC01MjgsNyArNTI4LDcgQEAgc3RhdGljIFBh
Z2VEZXNjICpwYWdlX2ZpbmRfYWxsb2ModGJfcGFnZV9hZGRyX3QgaW5kZXgsIGludCBhbGxvYykK
ICAgICAgICAgbHAgPSBwICsgKChpbmRleCA+PiAoaSAqIFZfTDJfQklUUykpICYgKFZfTDJfU0la
RSAtIDEpKTsKICAgICB9CiAKLSAgICBwZCA9IGF0b21pY19yY3VfcmVhZChscCk7CisgICAgcGQg
PSBxYXRvbWljX3JjdV9yZWFkKGxwKTsKICAgICBpZiAocGQgPT0gTlVMTCkgewogICAgICAgICB2
b2lkICpleGlzdGluZzsKIApAQCAtNTQ1LDcgKzU0NSw3IEBAIHN0YXRpYyBQYWdlRGVzYyAqcGFn
ZV9maW5kX2FsbG9jKHRiX3BhZ2VfYWRkcl90IGluZGV4LCBpbnQgYWxsb2MpCiAgICAgICAgICAg
ICB9CiAgICAgICAgIH0KICNlbmRpZgotICAgICAgICBleGlzdGluZyA9IGF0b21pY19jbXB4Y2hn
KGxwLCBOVUxMLCBwZCk7CisgICAgICAgIGV4aXN0aW5nID0gcWF0b21pY19jbXB4Y2hnKGxwLCBO
VUxMLCBwZCk7CiAgICAgICAgIGlmICh1bmxpa2VseShleGlzdGluZykpIHsKICNpZm5kZWYgQ09O
RklHX1VTRVJfT05MWQogICAgICAgICAgICAgewpAQCAtMTI1Myw3ICsxMjUzLDcgQEAgc3RhdGlj
IHZvaWQgZG9fdGJfZmx1c2goQ1BVU3RhdGUgKmNwdSwgcnVuX29uX2NwdV9kYXRhIHRiX2ZsdXNo
X2NvdW50KQogICAgIHRjZ19yZWdpb25fcmVzZXRfYWxsKCk7CiAgICAgLyogWFhYOiBmbHVzaCBw
cm9jZXNzb3IgaWNhY2hlIGF0IHRoaXMgcG9pbnQgaWYgY2FjaGUgZmx1c2ggaXMKICAgICAgICBl
eHBlbnNpdmUgKi8KLSAgICBhdG9taWNfbWJfc2V0KCZ0Yl9jdHgudGJfZmx1c2hfY291bnQsIHRi
X2N0eC50Yl9mbHVzaF9jb3VudCArIDEpOworICAgIHFhdG9taWNfbWJfc2V0KCZ0Yl9jdHgudGJf
Zmx1c2hfY291bnQsIHRiX2N0eC50Yl9mbHVzaF9jb3VudCArIDEpOwogCiBkb25lOgogICAgIG1t
YXBfdW5sb2NrKCk7CkBAIC0xMjY1LDcgKzEyNjUsNyBAQCBkb25lOgogdm9pZCB0Yl9mbHVzaChD
UFVTdGF0ZSAqY3B1KQogewogICAgIGlmICh0Y2dfZW5hYmxlZCgpKSB7Ci0gICAgICAgIHVuc2ln
bmVkIHRiX2ZsdXNoX2NvdW50ID0gYXRvbWljX21iX3JlYWQoJnRiX2N0eC50Yl9mbHVzaF9jb3Vu
dCk7CisgICAgICAgIHVuc2lnbmVkIHRiX2ZsdXNoX2NvdW50ID0gcWF0b21pY19tYl9yZWFkKCZ0
Yl9jdHgudGJfZmx1c2hfY291bnQpOwogCiAgICAgICAgIGlmIChjcHVfaW5fZXhjbHVzaXZlX2Nv
bnRleHQoY3B1KSkgewogICAgICAgICAgICAgZG9fdGJfZmx1c2goY3B1LCBSVU5fT05fQ1BVX0hP
U1RfSU5UKHRiX2ZsdXNoX2NvdW50KSk7CkBAIC0xMzU4LDcgKzEzNTgsNyBAQCBzdGF0aWMgaW5s
aW5lIHZvaWQgdGJfcmVtb3ZlX2Zyb21fam1wX2xpc3QoVHJhbnNsYXRpb25CbG9jayAqb3JpZywg
aW50IG5fb3JpZykKICAgICBpbnQgbjsKIAogICAgIC8qIG1hcmsgdGhlIExTQiBvZiBqbXBfZGVz
dFtdIHNvIHRoYXQgbm8gZnVydGhlciBqdW1wcyBjYW4gYmUgaW5zZXJ0ZWQgKi8KLSAgICBwdHIg
PSBhdG9taWNfb3JfZmV0Y2goJm9yaWctPmptcF9kZXN0W25fb3JpZ10sIDEpOworICAgIHB0ciA9
IHFhdG9taWNfb3JfZmV0Y2goJm9yaWctPmptcF9kZXN0W25fb3JpZ10sIDEpOwogICAgIGRlc3Qg
PSAoVHJhbnNsYXRpb25CbG9jayAqKShwdHIgJiB+MSk7CiAgICAgaWYgKGRlc3QgPT0gTlVMTCkg
ewogICAgICAgICByZXR1cm47CkBAIC0xMzY5LDcgKzEzNjksNyBAQCBzdGF0aWMgaW5saW5lIHZv
aWQgdGJfcmVtb3ZlX2Zyb21fam1wX2xpc3QoVHJhbnNsYXRpb25CbG9jayAqb3JpZywgaW50IG5f
b3JpZykKICAgICAgKiBXaGlsZSBhY3F1aXJpbmcgdGhlIGxvY2ssIHRoZSBqdW1wIG1pZ2h0IGhh
dmUgYmVlbiByZW1vdmVkIGlmIHRoZQogICAgICAqIGRlc3RpbmF0aW9uIFRCIHdhcyBpbnZhbGlk
YXRlZDsgY2hlY2sgYWdhaW4uCiAgICAgICovCi0gICAgcHRyX2xvY2tlZCA9IGF0b21pY19yZWFk
KCZvcmlnLT5qbXBfZGVzdFtuX29yaWddKTsKKyAgICBwdHJfbG9ja2VkID0gcWF0b21pY19yZWFk
KCZvcmlnLT5qbXBfZGVzdFtuX29yaWddKTsKICAgICBpZiAocHRyX2xvY2tlZCAhPSBwdHIpIHsK
ICAgICAgICAgcWVtdV9zcGluX3VubG9jaygmZGVzdC0+am1wX2xvY2spOwogICAgICAgICAvKgpA
QCAtMTQxNSw3ICsxNDE1LDcgQEAgc3RhdGljIGlubGluZSB2b2lkIHRiX2ptcF91bmxpbmsoVHJh
bnNsYXRpb25CbG9jayAqZGVzdCkKIAogICAgIFRCX0ZPUl9FQUNIX0pNUChkZXN0LCB0Yiwgbikg
ewogICAgICAgICB0Yl9yZXNldF9qdW1wKHRiLCBuKTsKLSAgICAgICAgYXRvbWljX2FuZCgmdGIt
PmptcF9kZXN0W25dLCAodWludHB0cl90KU5VTEwgfCAxKTsKKyAgICAgICAgcWF0b21pY19hbmQo
JnRiLT5qbXBfZGVzdFtuXSwgKHVpbnRwdHJfdClOVUxMIHwgMSk7CiAgICAgICAgIC8qIE5vIG5l
ZWQgdG8gY2xlYXIgdGhlIGxpc3QgZW50cnk7IHNldHRpbmcgdGhlIGRlc3QgcHRyIGlzIGVub3Vn
aCAqLwogICAgIH0KICAgICBkZXN0LT5qbXBfbGlzdF9oZWFkID0gKHVpbnRwdHJfdClOVUxMOwpA
QCAtMTQzOSw3ICsxNDM5LDcgQEAgc3RhdGljIHZvaWQgZG9fdGJfcGh5c19pbnZhbGlkYXRlKFRy
YW5zbGF0aW9uQmxvY2sgKnRiLCBib29sIHJtX2Zyb21fcGFnZV9saXN0KQogCiAgICAgLyogbWFr
ZSBzdXJlIG5vIGZ1cnRoZXIgaW5jb21pbmcganVtcHMgd2lsbCBiZSBjaGFpbmVkIHRvIHRoaXMg
VEIgKi8KICAgICBxZW11X3NwaW5fbG9jaygmdGItPmptcF9sb2NrKTsKLSAgICBhdG9taWNfc2V0
KCZ0Yi0+Y2ZsYWdzLCB0Yi0+Y2ZsYWdzIHwgQ0ZfSU5WQUxJRCk7CisgICAgcWF0b21pY19zZXQo
JnRiLT5jZmxhZ3MsIHRiLT5jZmxhZ3MgfCBDRl9JTlZBTElEKTsKICAgICBxZW11X3NwaW5fdW5s
b2NrKCZ0Yi0+am1wX2xvY2spOwogCiAgICAgLyogcmVtb3ZlIHRoZSBUQiBmcm9tIHRoZSBoYXNo
IGxpc3QgKi8KQEAgLTE0NjYsOCArMTQ2Niw4IEBAIHN0YXRpYyB2b2lkIGRvX3RiX3BoeXNfaW52
YWxpZGF0ZShUcmFuc2xhdGlvbkJsb2NrICp0YiwgYm9vbCBybV9mcm9tX3BhZ2VfbGlzdCkKICAg
ICAvKiByZW1vdmUgdGhlIFRCIGZyb20gdGhlIGhhc2ggbGlzdCAqLwogICAgIGggPSB0Yl9qbXBf
Y2FjaGVfaGFzaF9mdW5jKHRiLT5wYyk7CiAgICAgQ1BVX0ZPUkVBQ0goY3B1KSB7Ci0gICAgICAg
IGlmIChhdG9taWNfcmVhZCgmY3B1LT50Yl9qbXBfY2FjaGVbaF0pID09IHRiKSB7Ci0gICAgICAg
ICAgICBhdG9taWNfc2V0KCZjcHUtPnRiX2ptcF9jYWNoZVtoXSwgTlVMTCk7CisgICAgICAgIGlm
IChxYXRvbWljX3JlYWQoJmNwdS0+dGJfam1wX2NhY2hlW2hdKSA9PSB0YikgeworICAgICAgICAg
ICAgcWF0b21pY19zZXQoJmNwdS0+dGJfam1wX2NhY2hlW2hdLCBOVUxMKTsKICAgICAgICAgfQog
ICAgIH0KIApAQCAtMTQ3OCw3ICsxNDc4LDcgQEAgc3RhdGljIHZvaWQgZG9fdGJfcGh5c19pbnZh
bGlkYXRlKFRyYW5zbGF0aW9uQmxvY2sgKnRiLCBib29sIHJtX2Zyb21fcGFnZV9saXN0KQogICAg
IC8qIHN1cHByZXNzIGFueSByZW1haW5pbmcganVtcHMgdG8gdGhpcyBUQiAqLwogICAgIHRiX2pt
cF91bmxpbmsodGIpOwogCi0gICAgYXRvbWljX3NldCgmdGNnX2N0eC0+dGJfcGh5c19pbnZhbGlk
YXRlX2NvdW50LAorICAgIHFhdG9taWNfc2V0KCZ0Y2dfY3R4LT50Yl9waHlzX2ludmFsaWRhdGVf
Y291bnQsCiAgICAgICAgICAgICAgICB0Y2dfY3R4LT50Yl9waHlzX2ludmFsaWRhdGVfY291bnQg
KyAxKTsKIH0KIApAQCAtMTczMyw3ICsxNzMzLDcgQEAgVHJhbnNsYXRpb25CbG9jayAqdGJfZ2Vu
X2NvZGUoQ1BVU3RhdGUgKmNwdSwKIAogI2lmZGVmIENPTkZJR19QUk9GSUxFUgogICAgIC8qIGlu
Y2x1ZGVzIGFib3J0ZWQgdHJhbnNsYXRpb25zIGJlY2F1c2Ugb2YgZXhjZXB0aW9ucyAqLwotICAg
IGF0b21pY19zZXQoJnByb2YtPnRiX2NvdW50MSwgcHJvZi0+dGJfY291bnQxICsgMSk7CisgICAg
cWF0b21pY19zZXQoJnByb2YtPnRiX2NvdW50MSwgcHJvZi0+dGJfY291bnQxICsgMSk7CiAgICAg
dGkgPSBwcm9maWxlX2dldGNsb2NrKCk7CiAjZW5kaWYKIApAQCAtMTc1OCw4ICsxNzU4LDkgQEAg
VHJhbnNsYXRpb25CbG9jayAqdGJfZ2VuX2NvZGUoQ1BVU3RhdGUgKmNwdSwKICAgICB9CiAKICNp
ZmRlZiBDT05GSUdfUFJPRklMRVIKLSAgICBhdG9taWNfc2V0KCZwcm9mLT50Yl9jb3VudCwgcHJv
Zi0+dGJfY291bnQgKyAxKTsKLSAgICBhdG9taWNfc2V0KCZwcm9mLT5pbnRlcm1fdGltZSwgcHJv
Zi0+aW50ZXJtX3RpbWUgKyBwcm9maWxlX2dldGNsb2NrKCkgLSB0aSk7CisgICAgcWF0b21pY19z
ZXQoJnByb2YtPnRiX2NvdW50LCBwcm9mLT50Yl9jb3VudCArIDEpOworICAgIHFhdG9taWNfc2V0
KCZwcm9mLT5pbnRlcm1fdGltZSwKKyAgICAgICAgICAgICAgICBwcm9mLT5pbnRlcm1fdGltZSAr
IHByb2ZpbGVfZ2V0Y2xvY2soKSAtIHRpKTsKICAgICB0aSA9IHByb2ZpbGVfZ2V0Y2xvY2soKTsK
ICNlbmRpZgogCkBAIC0xODA0LDEwICsxODA1LDEwIEBAIFRyYW5zbGF0aW9uQmxvY2sgKnRiX2dl
bl9jb2RlKENQVVN0YXRlICpjcHUsCiAgICAgdGItPnRjLnNpemUgPSBnZW5fY29kZV9zaXplOwog
CiAjaWZkZWYgQ09ORklHX1BST0ZJTEVSCi0gICAgYXRvbWljX3NldCgmcHJvZi0+Y29kZV90aW1l
LCBwcm9mLT5jb2RlX3RpbWUgKyBwcm9maWxlX2dldGNsb2NrKCkgLSB0aSk7Ci0gICAgYXRvbWlj
X3NldCgmcHJvZi0+Y29kZV9pbl9sZW4sIHByb2YtPmNvZGVfaW5fbGVuICsgdGItPnNpemUpOwot
ICAgIGF0b21pY19zZXQoJnByb2YtPmNvZGVfb3V0X2xlbiwgcHJvZi0+Y29kZV9vdXRfbGVuICsg
Z2VuX2NvZGVfc2l6ZSk7Ci0gICAgYXRvbWljX3NldCgmcHJvZi0+c2VhcmNoX291dF9sZW4sIHBy
b2YtPnNlYXJjaF9vdXRfbGVuICsgc2VhcmNoX3NpemUpOworICAgIHFhdG9taWNfc2V0KCZwcm9m
LT5jb2RlX3RpbWUsIHByb2YtPmNvZGVfdGltZSArIHByb2ZpbGVfZ2V0Y2xvY2soKSAtIHRpKTsK
KyAgICBxYXRvbWljX3NldCgmcHJvZi0+Y29kZV9pbl9sZW4sIHByb2YtPmNvZGVfaW5fbGVuICsg
dGItPnNpemUpOworICAgIHFhdG9taWNfc2V0KCZwcm9mLT5jb2RlX291dF9sZW4sIHByb2YtPmNv
ZGVfb3V0X2xlbiArIGdlbl9jb2RlX3NpemUpOworICAgIHFhdG9taWNfc2V0KCZwcm9mLT5zZWFy
Y2hfb3V0X2xlbiwgcHJvZi0+c2VhcmNoX291dF9sZW4gKyBzZWFyY2hfc2l6ZSk7CiAjZW5kaWYK
IAogI2lmZGVmIERFQlVHX0RJU0FTCkBAIC0xODY5LDcgKzE4NzAsNyBAQCBUcmFuc2xhdGlvbkJs
b2NrICp0Yl9nZW5fY29kZShDUFVTdGF0ZSAqY3B1LAogICAgIH0KICNlbmRpZgogCi0gICAgYXRv
bWljX3NldCgmdGNnX2N0eC0+Y29kZV9nZW5fcHRyLCAodm9pZCAqKQorICAgIHFhdG9taWNfc2V0
KCZ0Y2dfY3R4LT5jb2RlX2dlbl9wdHIsICh2b2lkICopCiAgICAgICAgIFJPVU5EX1VQKCh1aW50
cHRyX3QpZ2VuX2NvZGVfYnVmICsgZ2VuX2NvZGVfc2l6ZSArIHNlYXJjaF9zaXplLAogICAgICAg
ICAgICAgICAgICBDT0RFX0dFTl9BTElHTikpOwogCkBAIC0xOTA1LDcgKzE5MDYsNyBAQCBUcmFu
c2xhdGlvbkJsb2NrICp0Yl9nZW5fY29kZShDUFVTdGF0ZSAqY3B1LAogICAgICAgICB1aW50cHRy
X3Qgb3JpZ19hbGlnbmVkID0gKHVpbnRwdHJfdClnZW5fY29kZV9idWY7CiAKICAgICAgICAgb3Jp
Z19hbGlnbmVkIC09IFJPVU5EX1VQKHNpemVvZigqdGIpLCBxZW11X2ljYWNoZV9saW5lc2l6ZSk7
Ci0gICAgICAgIGF0b21pY19zZXQoJnRjZ19jdHgtPmNvZGVfZ2VuX3B0ciwgKHZvaWQgKilvcmln
X2FsaWduZWQpOworICAgICAgICBxYXRvbWljX3NldCgmdGNnX2N0eC0+Y29kZV9nZW5fcHRyLCAo
dm9pZCAqKW9yaWdfYWxpZ25lZCk7CiAgICAgICAgIHRiX2Rlc3Ryb3kodGIpOwogICAgICAgICBy
ZXR1cm4gZXhpc3RpbmdfdGI7CiAgICAgfQpAQCAtMjI3Myw3ICsyMjc0LDcgQEAgc3RhdGljIHZv
aWQgdGJfam1wX2NhY2hlX2NsZWFyX3BhZ2UoQ1BVU3RhdGUgKmNwdSwgdGFyZ2V0X3Vsb25nIHBh
Z2VfYWRkcikKICAgICB1bnNpZ25lZCBpbnQgaSwgaTAgPSB0Yl9qbXBfY2FjaGVfaGFzaF9wYWdl
KHBhZ2VfYWRkcik7CiAKICAgICBmb3IgKGkgPSAwOyBpIDwgVEJfSk1QX1BBR0VfU0laRTsgaSsr
KSB7Ci0gICAgICAgIGF0b21pY19zZXQoJmNwdS0+dGJfam1wX2NhY2hlW2kwICsgaV0sIE5VTEwp
OworICAgICAgICBxYXRvbWljX3NldCgmY3B1LT50Yl9qbXBfY2FjaGVbaTAgKyBpXSwgTlVMTCk7
CiAgICAgfQogfQogCkBAIC0yMzkzLDcgKzIzOTQsNyBAQCB2b2lkIGR1bXBfZXhlY19pbmZvKHZv
aWQpCiAKICAgICBxZW11X3ByaW50ZigiXG5TdGF0aXN0aWNzOlxuIik7CiAgICAgcWVtdV9wcmlu
dGYoIlRCIGZsdXNoIGNvdW50ICAgICAgJXVcbiIsCi0gICAgICAgICAgICAgICAgYXRvbWljX3Jl
YWQoJnRiX2N0eC50Yl9mbHVzaF9jb3VudCkpOworICAgICAgICAgICAgICAgIHFhdG9taWNfcmVh
ZCgmdGJfY3R4LnRiX2ZsdXNoX2NvdW50KSk7CiAgICAgcWVtdV9wcmludGYoIlRCIGludmFsaWRh
dGUgY291bnQgJXp1XG4iLAogICAgICAgICAgICAgICAgIHRjZ190Yl9waHlzX2ludmFsaWRhdGVf
Y291bnQoKSk7CiAKQEAgLTI0MTUsNyArMjQxNiw3IEBAIHZvaWQgY3B1X2ludGVycnVwdChDUFVT
dGF0ZSAqY3B1LCBpbnQgbWFzaykKIHsKICAgICBnX2Fzc2VydChxZW11X211dGV4X2lvdGhyZWFk
X2xvY2tlZCgpKTsKICAgICBjcHUtPmludGVycnVwdF9yZXF1ZXN0IHw9IG1hc2s7Ci0gICAgYXRv
bWljX3NldCgmY3B1X25lZyhjcHUpLT5pY291bnRfZGVjci51MTYuaGlnaCwgLTEpOworICAgIHFh
dG9taWNfc2V0KCZjcHVfbmVnKGNwdSktPmljb3VudF9kZWNyLnUxNi5oaWdoLCAtMSk7CiB9CiAK
IC8qCmRpZmYgLS1naXQgYS9hdWRpby9qYWNrYXVkaW8uYyBiL2F1ZGlvL2phY2thdWRpby5jCmlu
ZGV4IDcyZWQ3YzQ5MjkuLjFlNzE0YjMwYmMgMTAwNjQ0Ci0tLSBhL2F1ZGlvL2phY2thdWRpby5j
CisrKyBiL2F1ZGlvL2phY2thdWRpby5jCkBAIC0xMDQsNyArMTA0LDcgQEAgc3RhdGljIHZvaWQg
cWphY2tfYnVmZmVyX2NyZWF0ZShRSmFja0J1ZmZlciAqYnVmZmVyLCBpbnQgY2hhbm5lbHMsIGlu
dCBmcmFtZXMpCiBzdGF0aWMgdm9pZCBxamFja19idWZmZXJfY2xlYXIoUUphY2tCdWZmZXIgKmJ1
ZmZlcikKIHsKICAgICBhc3NlcnQoYnVmZmVyLT5kYXRhKTsKLSAgICBhdG9taWNfc3RvcmVfcmVs
ZWFzZSgmYnVmZmVyLT51c2VkLCAwKTsKKyAgICBxYXRvbWljX3N0b3JlX3JlbGVhc2UoJmJ1ZmZl
ci0+dXNlZCwgMCk7CiAgICAgYnVmZmVyLT5ycHRyID0gMDsKICAgICBidWZmZXItPndwdHIgPSAw
OwogfQpAQCAtMTI5LDcgKzEyOSw3IEBAIHN0YXRpYyBpbnQgcWphY2tfYnVmZmVyX3dyaXRlKFFK
YWNrQnVmZmVyICpidWZmZXIsIGZsb2F0ICpkYXRhLCBpbnQgc2l6ZSkKICAgICBhc3NlcnQoYnVm
ZmVyLT5kYXRhKTsKICAgICBjb25zdCBpbnQgc2FtcGxlcyA9IHNpemUgLyBzaXplb2YoZmxvYXQp
OwogICAgIGludCBmcmFtZXMgICAgICAgID0gc2FtcGxlcyAvIGJ1ZmZlci0+Y2hhbm5lbHM7Ci0g
ICAgY29uc3QgaW50IGF2YWlsICAgPSBidWZmZXItPmZyYW1lcyAtIGF0b21pY19sb2FkX2FjcXVp
cmUoJmJ1ZmZlci0+dXNlZCk7CisgICAgY29uc3QgaW50IGF2YWlsICAgPSBidWZmZXItPmZyYW1l
cyAtIHFhdG9taWNfbG9hZF9hY3F1aXJlKCZidWZmZXItPnVzZWQpOwogCiAgICAgaWYgKGZyYW1l
cyA+IGF2YWlsKSB7CiAgICAgICAgIGZyYW1lcyA9IGF2YWlsOwpAQCAtMTUzLDcgKzE1Myw3IEBA
IHN0YXRpYyBpbnQgcWphY2tfYnVmZmVyX3dyaXRlKFFKYWNrQnVmZmVyICpidWZmZXIsIGZsb2F0
ICpkYXRhLCBpbnQgc2l6ZSkKIAogICAgIGJ1ZmZlci0+d3B0ciA9IHdwdHI7CiAKLSAgICBhdG9t
aWNfYWRkKCZidWZmZXItPnVzZWQsIGZyYW1lcyk7CisgICAgcWF0b21pY19hZGQoJmJ1ZmZlci0+
dXNlZCwgZnJhbWVzKTsKICAgICByZXR1cm4gZnJhbWVzICogYnVmZmVyLT5jaGFubmVscyAqIHNp
emVvZihmbG9hdCk7CiB9OwogCkBAIC0xNjEsNyArMTYxLDcgQEAgc3RhdGljIGludCBxamFja19i
dWZmZXJfd3JpdGUoUUphY2tCdWZmZXIgKmJ1ZmZlciwgZmxvYXQgKmRhdGEsIGludCBzaXplKQog
c3RhdGljIGludCBxamFja19idWZmZXJfd3JpdGVfbChRSmFja0J1ZmZlciAqYnVmZmVyLCBmbG9h
dCAqKmRlc3QsIGludCBmcmFtZXMpCiB7CiAgICAgYXNzZXJ0KGJ1ZmZlci0+ZGF0YSk7Ci0gICAg
Y29uc3QgaW50IGF2YWlsICAgPSBidWZmZXItPmZyYW1lcyAtIGF0b21pY19sb2FkX2FjcXVpcmUo
JmJ1ZmZlci0+dXNlZCk7CisgICAgY29uc3QgaW50IGF2YWlsICAgPSBidWZmZXItPmZyYW1lcyAt
IHFhdG9taWNfbG9hZF9hY3F1aXJlKCZidWZmZXItPnVzZWQpOwogICAgIGludCB3cHRyID0gYnVm
ZmVyLT53cHRyOwogCiAgICAgaWYgKGZyYW1lcyA+IGF2YWlsKSB7CkBAIC0xODUsNyArMTg1LDcg
QEAgc3RhdGljIGludCBxamFja19idWZmZXJfd3JpdGVfbChRSmFja0J1ZmZlciAqYnVmZmVyLCBm
bG9hdCAqKmRlc3QsIGludCBmcmFtZXMpCiAgICAgfQogICAgIGJ1ZmZlci0+d3B0ciA9IHdwdHI7
CiAKLSAgICBhdG9taWNfYWRkKCZidWZmZXItPnVzZWQsIGZyYW1lcyk7CisgICAgcWF0b21pY19h
ZGQoJmJ1ZmZlci0+dXNlZCwgZnJhbWVzKTsKICAgICByZXR1cm4gZnJhbWVzOwogfQogCkBAIC0x
OTUsNyArMTk1LDcgQEAgc3RhdGljIGludCBxamFja19idWZmZXJfcmVhZChRSmFja0J1ZmZlciAq
YnVmZmVyLCBmbG9hdCAqZGVzdCwgaW50IHNpemUpCiAgICAgYXNzZXJ0KGJ1ZmZlci0+ZGF0YSk7
CiAgICAgY29uc3QgaW50IHNhbXBsZXMgPSBzaXplIC8gc2l6ZW9mKGZsb2F0KTsKICAgICBpbnQg
ZnJhbWVzICAgICAgICA9IHNhbXBsZXMgLyBidWZmZXItPmNoYW5uZWxzOwotICAgIGNvbnN0IGlu
dCBhdmFpbCAgID0gYXRvbWljX2xvYWRfYWNxdWlyZSgmYnVmZmVyLT51c2VkKTsKKyAgICBjb25z
dCBpbnQgYXZhaWwgICA9IHFhdG9taWNfbG9hZF9hY3F1aXJlKCZidWZmZXItPnVzZWQpOwogCiAg
ICAgaWYgKGZyYW1lcyA+IGF2YWlsKSB7CiAgICAgICAgIGZyYW1lcyA9IGF2YWlsOwpAQCAtMjE5
LDcgKzIxOSw3IEBAIHN0YXRpYyBpbnQgcWphY2tfYnVmZmVyX3JlYWQoUUphY2tCdWZmZXIgKmJ1
ZmZlciwgZmxvYXQgKmRlc3QsIGludCBzaXplKQogCiAgICAgYnVmZmVyLT5ycHRyID0gcnB0cjsK
IAotICAgIGF0b21pY19zdWIoJmJ1ZmZlci0+dXNlZCwgZnJhbWVzKTsKKyAgICBxYXRvbWljX3N1
YigmYnVmZmVyLT51c2VkLCBmcmFtZXMpOwogICAgIHJldHVybiBmcmFtZXMgKiBidWZmZXItPmNo
YW5uZWxzICogc2l6ZW9mKGZsb2F0KTsKIH0KIApAQCAtMjI4LDcgKzIyOCw3IEBAIHN0YXRpYyBp
bnQgcWphY2tfYnVmZmVyX3JlYWRfbChRSmFja0J1ZmZlciAqYnVmZmVyLCBmbG9hdCAqKmRlc3Qs
IGludCBmcmFtZXMpCiB7CiAgICAgYXNzZXJ0KGJ1ZmZlci0+ZGF0YSk7CiAgICAgaW50IGNvcHkg
ICAgICAgPSBmcmFtZXM7Ci0gICAgY29uc3QgaW50IHVzZWQgPSBhdG9taWNfbG9hZF9hY3F1aXJl
KCZidWZmZXItPnVzZWQpOworICAgIGNvbnN0IGludCB1c2VkID0gcWF0b21pY19sb2FkX2FjcXVp
cmUoJmJ1ZmZlci0+dXNlZCk7CiAgICAgaW50IHJwdHIgICAgICAgPSBidWZmZXItPnJwdHI7CiAK
ICAgICBpZiAoY29weSA+IHVzZWQpIHsKQEAgLTI1Miw3ICsyNTIsNyBAQCBzdGF0aWMgaW50IHFq
YWNrX2J1ZmZlcl9yZWFkX2woUUphY2tCdWZmZXIgKmJ1ZmZlciwgZmxvYXQgKipkZXN0LCBpbnQg
ZnJhbWVzKQogICAgIH0KICAgICBidWZmZXItPnJwdHIgPSBycHRyOwogCi0gICAgYXRvbWljX3N1
YigmYnVmZmVyLT51c2VkLCBjb3B5KTsKKyAgICBxYXRvbWljX3N1YigmYnVmZmVyLT51c2VkLCBj
b3B5KTsKICAgICByZXR1cm4gY29weTsKIH0KIApkaWZmIC0tZ2l0IGEvYmxvY2suYyBiL2Jsb2Nr
LmMKaW5kZXggMTFhYjU1ZjgwYi4uZjcyYTJlMjZlOCAxMDA2NDQKLS0tIGEvYmxvY2suYworKysg
Yi9ibG9jay5jCkBAIC0xNjk0LDcgKzE2OTQsNyBAQCBzdGF0aWMgaW50IGJkcnZfb3Blbl9jb21t
b24oQmxvY2tEcml2ZXJTdGF0ZSAqYnMsIEJsb2NrQmFja2VuZCAqZmlsZSwKICAgICB9CiAKICAg
ICAvKiBiZHJ2X25ldygpIGFuZCBiZHJ2X2Nsb3NlKCkgbWFrZSBpdCBzbyAqLwotICAgIGFzc2Vy
dChhdG9taWNfcmVhZCgmYnMtPmNvcHlfb25fcmVhZCkgPT0gMCk7CisgICAgYXNzZXJ0KHFhdG9t
aWNfcmVhZCgmYnMtPmNvcHlfb25fcmVhZCkgPT0gMCk7CiAKICAgICBpZiAoYnMtPm9wZW5fZmxh
Z3MgJiBCRFJWX09fQ09QWV9PTl9SRUFEKSB7CiAgICAgICAgIGlmICghYnMtPnJlYWRfb25seSkg
ewpAQCAtNDQzNiw3ICs0NDM2LDcgQEAgc3RhdGljIHZvaWQgYmRydl9jbG9zZShCbG9ja0RyaXZl
clN0YXRlICpicykKICAgICBicy0+ZmlsZSA9IE5VTEw7CiAgICAgZ19mcmVlKGJzLT5vcGFxdWUp
OwogICAgIGJzLT5vcGFxdWUgPSBOVUxMOwotICAgIGF0b21pY19zZXQoJmJzLT5jb3B5X29uX3Jl
YWQsIDApOworICAgIHFhdG9taWNfc2V0KCZicy0+Y29weV9vbl9yZWFkLCAwKTsKICAgICBicy0+
YmFja2luZ19maWxlWzBdID0gJ1wwJzsKICAgICBicy0+YmFja2luZ19mb3JtYXRbMF0gPSAnXDAn
OwogICAgIGJzLT50b3RhbF9zZWN0b3JzID0gMDsKZGlmZiAtLWdpdCBhL2Jsb2NrL2Jsb2NrLWJh
Y2tlbmQuYyBiL2Jsb2NrL2Jsb2NrLWJhY2tlbmQuYwppbmRleCAyNGRkMDY3MGQxLi5jZTc4ZDMw
Nzk0IDEwMDY0NAotLS0gYS9ibG9jay9ibG9jay1iYWNrZW5kLmMKKysrIGIvYmxvY2svYmxvY2st
YmFja2VuZC5jCkBAIC0xMzUzLDEyICsxMzUzLDEyIEBAIGludCBibGtfbWFrZV96ZXJvKEJsb2Nr
QmFja2VuZCAqYmxrLCBCZHJ2UmVxdWVzdEZsYWdzIGZsYWdzKQogCiB2b2lkIGJsa19pbmNfaW5f
ZmxpZ2h0KEJsb2NrQmFja2VuZCAqYmxrKQogewotICAgIGF0b21pY19pbmMoJmJsay0+aW5fZmxp
Z2h0KTsKKyAgICBxYXRvbWljX2luYygmYmxrLT5pbl9mbGlnaHQpOwogfQogCiB2b2lkIGJsa19k
ZWNfaW5fZmxpZ2h0KEJsb2NrQmFja2VuZCAqYmxrKQogewotICAgIGF0b21pY19kZWMoJmJsay0+
aW5fZmxpZ2h0KTsKKyAgICBxYXRvbWljX2RlYygmYmxrLT5pbl9mbGlnaHQpOwogICAgIGFpb193
YWl0X2tpY2soKTsKIH0KIApAQCAtMTcyMCw3ICsxNzIwLDcgQEAgdm9pZCBibGtfZHJhaW4oQmxv
Y2tCYWNrZW5kICpibGspCiAKICAgICAvKiBXZSBtYXkgaGF2ZSAtRU5PTUVESVVNIGNvbXBsZXRp
b25zIGluIGZsaWdodCAqLwogICAgIEFJT19XQUlUX1dISUxFKGJsa19nZXRfYWlvX2NvbnRleHQo
YmxrKSwKLSAgICAgICAgICAgICAgICAgICBhdG9taWNfbWJfcmVhZCgmYmxrLT5pbl9mbGlnaHQp
ID4gMCk7CisgICAgICAgICAgICAgICAgICAgcWF0b21pY19tYl9yZWFkKCZibGstPmluX2ZsaWdo
dCkgPiAwKTsKIAogICAgIGlmIChicykgewogICAgICAgICBiZHJ2X2RyYWluZWRfZW5kKGJzKTsK
QEAgLTE3MzksNyArMTczOSw3IEBAIHZvaWQgYmxrX2RyYWluX2FsbCh2b2lkKQogICAgICAgICBh
aW9fY29udGV4dF9hY3F1aXJlKGN0eCk7CiAKICAgICAgICAgLyogV2UgbWF5IGhhdmUgLUVOT01F
RElVTSBjb21wbGV0aW9ucyBpbiBmbGlnaHQgKi8KLSAgICAgICAgQUlPX1dBSVRfV0hJTEUoY3R4
LCBhdG9taWNfbWJfcmVhZCgmYmxrLT5pbl9mbGlnaHQpID4gMCk7CisgICAgICAgIEFJT19XQUlU
X1dISUxFKGN0eCwgcWF0b21pY19tYl9yZWFkKCZibGstPmluX2ZsaWdodCkgPiAwKTsKIAogICAg
ICAgICBhaW9fY29udGV4dF9yZWxlYXNlKGN0eCk7CiAgICAgfQpAQCAtMjM0Niw2ICsyMzQ2LDcg
QEAgdm9pZCBibGtfaW9fbGltaXRzX3VwZGF0ZV9ncm91cChCbG9ja0JhY2tlbmQgKmJsaywgY29u
c3QgY2hhciAqZ3JvdXApCiBzdGF0aWMgdm9pZCBibGtfcm9vdF9kcmFpbmVkX2JlZ2luKEJkcnZD
aGlsZCAqY2hpbGQpCiB7CiAgICAgQmxvY2tCYWNrZW5kICpibGsgPSBjaGlsZC0+b3BhcXVlOwor
ICAgIFRocm90dGxlR3JvdXBNZW1iZXIgKnRnbSA9ICZibGstPnB1YmxpYy50aHJvdHRsZV9ncm91
cF9tZW1iZXI7CiAKICAgICBpZiAoKytibGstPnF1aWVzY2VfY291bnRlciA9PSAxKSB7CiAgICAg
ICAgIGlmIChibGstPmRldl9vcHMgJiYgYmxrLT5kZXZfb3BzLT5kcmFpbmVkX2JlZ2luKSB7CkBA
IC0yMzU2LDggKzIzNTcsOCBAQCBzdGF0aWMgdm9pZCBibGtfcm9vdF9kcmFpbmVkX2JlZ2luKEJk
cnZDaGlsZCAqY2hpbGQpCiAgICAgLyogTm90ZSB0aGF0IGJsay0+cm9vdCBtYXkgbm90IGJlIGFj
Y2Vzc2libGUgaGVyZSB5ZXQgaWYgd2UgYXJlIGp1c3QKICAgICAgKiBhdHRhY2hpbmcgdG8gYSBC
bG9ja0RyaXZlclN0YXRlIHRoYXQgaXMgZHJhaW5lZC4gVXNlIGNoaWxkIGluc3RlYWQuICovCiAK
LSAgICBpZiAoYXRvbWljX2ZldGNoX2luYygmYmxrLT5wdWJsaWMudGhyb3R0bGVfZ3JvdXBfbWVt
YmVyLmlvX2xpbWl0c19kaXNhYmxlZCkgPT0gMCkgewotICAgICAgICB0aHJvdHRsZV9ncm91cF9y
ZXN0YXJ0X3RnbSgmYmxrLT5wdWJsaWMudGhyb3R0bGVfZ3JvdXBfbWVtYmVyKTsKKyAgICBpZiAo
cWF0b21pY19mZXRjaF9pbmMoJnRnbS0+aW9fbGltaXRzX2Rpc2FibGVkKSA9PSAwKSB7CisgICAg
ICAgIHRocm90dGxlX2dyb3VwX3Jlc3RhcnRfdGdtKHRnbSk7CiAgICAgfQogfQogCkBAIC0yMzc0
LDcgKzIzNzUsNyBAQCBzdGF0aWMgdm9pZCBibGtfcm9vdF9kcmFpbmVkX2VuZChCZHJ2Q2hpbGQg
KmNoaWxkLCBpbnQgKmRyYWluZWRfZW5kX2NvdW50ZXIpCiAgICAgYXNzZXJ0KGJsay0+cXVpZXNj
ZV9jb3VudGVyKTsKIAogICAgIGFzc2VydChibGstPnB1YmxpYy50aHJvdHRsZV9ncm91cF9tZW1i
ZXIuaW9fbGltaXRzX2Rpc2FibGVkKTsKLSAgICBhdG9taWNfZGVjKCZibGstPnB1YmxpYy50aHJv
dHRsZV9ncm91cF9tZW1iZXIuaW9fbGltaXRzX2Rpc2FibGVkKTsKKyAgICBxYXRvbWljX2RlYygm
YmxrLT5wdWJsaWMudGhyb3R0bGVfZ3JvdXBfbWVtYmVyLmlvX2xpbWl0c19kaXNhYmxlZCk7CiAK
ICAgICBpZiAoLS1ibGstPnF1aWVzY2VfY291bnRlciA9PSAwKSB7CiAgICAgICAgIGlmIChibGst
PmRldl9vcHMgJiYgYmxrLT5kZXZfb3BzLT5kcmFpbmVkX2VuZCkgewpkaWZmIC0tZ2l0IGEvYmxv
Y2svaW8uYyBiL2Jsb2NrL2lvLmMKaW5kZXggYTIzODliYjM4Yy4uMTFkZjE4ODlmMSAxMDA2NDQK
LS0tIGEvYmxvY2svaW8uYworKysgYi9ibG9jay9pby5jCkBAIC02OSw3ICs2OSw3IEBAIHZvaWQg
YmRydl9wYXJlbnRfZHJhaW5lZF9lbmRfc2luZ2xlKEJkcnZDaGlsZCAqYykKIHsKICAgICBpbnQg
ZHJhaW5lZF9lbmRfY291bnRlciA9IDA7CiAgICAgYmRydl9wYXJlbnRfZHJhaW5lZF9lbmRfc2lu
Z2xlX25vX3BvbGwoYywgJmRyYWluZWRfZW5kX2NvdW50ZXIpOwotICAgIEJEUlZfUE9MTF9XSElM
RShjLT5icywgYXRvbWljX3JlYWQoJmRyYWluZWRfZW5kX2NvdW50ZXIpID4gMCk7CisgICAgQkRS
Vl9QT0xMX1dISUxFKGMtPmJzLCBxYXRvbWljX3JlYWQoJmRyYWluZWRfZW5kX2NvdW50ZXIpID4g
MCk7CiB9CiAKIHN0YXRpYyB2b2lkIGJkcnZfcGFyZW50X2RyYWluZWRfZW5kKEJsb2NrRHJpdmVy
U3RhdGUgKmJzLCBCZHJ2Q2hpbGQgKmlnbm9yZSwKQEAgLTE4NiwxMiArMTg2LDEyIEBAIHZvaWQg
YmRydl9yZWZyZXNoX2xpbWl0cyhCbG9ja0RyaXZlclN0YXRlICpicywgRXJyb3IgKiplcnJwKQog
ICovCiB2b2lkIGJkcnZfZW5hYmxlX2NvcHlfb25fcmVhZChCbG9ja0RyaXZlclN0YXRlICpicykK
IHsKLSAgICBhdG9taWNfaW5jKCZicy0+Y29weV9vbl9yZWFkKTsKKyAgICBxYXRvbWljX2luYygm
YnMtPmNvcHlfb25fcmVhZCk7CiB9CiAKIHZvaWQgYmRydl9kaXNhYmxlX2NvcHlfb25fcmVhZChC
bG9ja0RyaXZlclN0YXRlICpicykKIHsKLSAgICBpbnQgb2xkID0gYXRvbWljX2ZldGNoX2RlYygm
YnMtPmNvcHlfb25fcmVhZCk7CisgICAgaW50IG9sZCA9IHFhdG9taWNfZmV0Y2hfZGVjKCZicy0+
Y29weV9vbl9yZWFkKTsKICAgICBhc3NlcnQob2xkID49IDEpOwogfQogCkBAIC0yMTksOSArMjE5
LDkgQEAgc3RhdGljIHZvaWQgY29yb3V0aW5lX2ZuIGJkcnZfZHJhaW5faW52b2tlX2VudHJ5KHZv
aWQgKm9wYXF1ZSkKICAgICB9CiAKICAgICAvKiBTZXQgZGF0YS0+ZG9uZSBhbmQgZGVjcmVtZW50
IGRyYWluZWRfZW5kX2NvdW50ZXIgYmVmb3JlIGJkcnZfd2FrZXVwKCkgKi8KLSAgICBhdG9taWNf
bWJfc2V0KCZkYXRhLT5kb25lLCB0cnVlKTsKKyAgICBxYXRvbWljX21iX3NldCgmZGF0YS0+ZG9u
ZSwgdHJ1ZSk7CiAgICAgaWYgKCFkYXRhLT5iZWdpbikgewotICAgICAgICBhdG9taWNfZGVjKGRh
dGEtPmRyYWluZWRfZW5kX2NvdW50ZXIpOworICAgICAgICBxYXRvbWljX2RlYyhkYXRhLT5kcmFp
bmVkX2VuZF9jb3VudGVyKTsKICAgICB9CiAgICAgYmRydl9kZWNfaW5fZmxpZ2h0KGJzKTsKIApA
QCAtMjQ4LDcgKzI0OCw3IEBAIHN0YXRpYyB2b2lkIGJkcnZfZHJhaW5faW52b2tlKEJsb2NrRHJp
dmVyU3RhdGUgKmJzLCBib29sIGJlZ2luLAogICAgIH07CiAKICAgICBpZiAoIWJlZ2luKSB7Ci0g
ICAgICAgIGF0b21pY19pbmMoZHJhaW5lZF9lbmRfY291bnRlcik7CisgICAgICAgIHFhdG9taWNf
aW5jKGRyYWluZWRfZW5kX2NvdW50ZXIpOwogICAgIH0KIAogICAgIC8qIE1ha2Ugc3VyZSB0aGUg
ZHJpdmVyIGNhbGxiYWNrIGNvbXBsZXRlcyBkdXJpbmcgdGhlIHBvbGxpbmcgcGhhc2UgZm9yCkBA
IC0yNjgsNyArMjY4LDcgQEAgYm9vbCBiZHJ2X2RyYWluX3BvbGwoQmxvY2tEcml2ZXJTdGF0ZSAq
YnMsIGJvb2wgcmVjdXJzaXZlLAogICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICB9CiAKLSAgICBp
ZiAoYXRvbWljX3JlYWQoJmJzLT5pbl9mbGlnaHQpKSB7CisgICAgaWYgKHFhdG9taWNfcmVhZCgm
YnMtPmluX2ZsaWdodCkpIHsKICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgfQogCkBAIC0zODIs
NyArMzgyLDcgQEAgdm9pZCBiZHJ2X2RvX2RyYWluZWRfYmVnaW5fcXVpZXNjZShCbG9ja0RyaXZl
clN0YXRlICpicywKICAgICBhc3NlcnQoIXFlbXVfaW5fY29yb3V0aW5lKCkpOwogCiAgICAgLyog
U3RvcCB0aGluZ3MgaW4gcGFyZW50LXRvLWNoaWxkIG9yZGVyICovCi0gICAgaWYgKGF0b21pY19m
ZXRjaF9pbmMoJmJzLT5xdWllc2NlX2NvdW50ZXIpID09IDApIHsKKyAgICBpZiAocWF0b21pY19m
ZXRjaF9pbmMoJmJzLT5xdWllc2NlX2NvdW50ZXIpID09IDApIHsKICAgICAgICAgYWlvX2Rpc2Fi
bGVfZXh0ZXJuYWwoYmRydl9nZXRfYWlvX2NvbnRleHQoYnMpKTsKICAgICB9CiAKQEAgLTQ3Myw3
ICs0NzMsNyBAQCBzdGF0aWMgdm9pZCBiZHJ2X2RvX2RyYWluZWRfZW5kKEJsb2NrRHJpdmVyU3Rh
dGUgKmJzLCBib29sIHJlY3Vyc2l2ZSwKICAgICBiZHJ2X3BhcmVudF9kcmFpbmVkX2VuZChicywg
cGFyZW50LCBpZ25vcmVfYmRzX3BhcmVudHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ZHJhaW5lZF9lbmRfY291bnRlcik7CiAKLSAgICBvbGRfcXVpZXNjZV9jb3VudGVyID0gYXRvbWlj
X2ZldGNoX2RlYygmYnMtPnF1aWVzY2VfY291bnRlcik7CisgICAgb2xkX3F1aWVzY2VfY291bnRl
ciA9IHFhdG9taWNfZmV0Y2hfZGVjKCZicy0+cXVpZXNjZV9jb3VudGVyKTsKICAgICBpZiAob2xk
X3F1aWVzY2VfY291bnRlciA9PSAxKSB7CiAgICAgICAgIGFpb19lbmFibGVfZXh0ZXJuYWwoYmRy
dl9nZXRfYWlvX2NvbnRleHQoYnMpKTsKICAgICB9CkBAIC00OTIsNyArNDkyLDcgQEAgdm9pZCBi
ZHJ2X2RyYWluZWRfZW5kKEJsb2NrRHJpdmVyU3RhdGUgKmJzKQogewogICAgIGludCBkcmFpbmVk
X2VuZF9jb3VudGVyID0gMDsKICAgICBiZHJ2X2RvX2RyYWluZWRfZW5kKGJzLCBmYWxzZSwgTlVM
TCwgZmFsc2UsICZkcmFpbmVkX2VuZF9jb3VudGVyKTsKLSAgICBCRFJWX1BPTExfV0hJTEUoYnMs
IGF0b21pY19yZWFkKCZkcmFpbmVkX2VuZF9jb3VudGVyKSA+IDApOworICAgIEJEUlZfUE9MTF9X
SElMRShicywgcWF0b21pY19yZWFkKCZkcmFpbmVkX2VuZF9jb3VudGVyKSA+IDApOwogfQogCiB2
b2lkIGJkcnZfZHJhaW5lZF9lbmRfbm9fcG9sbChCbG9ja0RyaXZlclN0YXRlICpicywgaW50ICpk
cmFpbmVkX2VuZF9jb3VudGVyKQpAQCAtNTA0LDcgKzUwNCw3IEBAIHZvaWQgYmRydl9zdWJ0cmVl
X2RyYWluZWRfZW5kKEJsb2NrRHJpdmVyU3RhdGUgKmJzKQogewogICAgIGludCBkcmFpbmVkX2Vu
ZF9jb3VudGVyID0gMDsKICAgICBiZHJ2X2RvX2RyYWluZWRfZW5kKGJzLCB0cnVlLCBOVUxMLCBm
YWxzZSwgJmRyYWluZWRfZW5kX2NvdW50ZXIpOwotICAgIEJEUlZfUE9MTF9XSElMRShicywgYXRv
bWljX3JlYWQoJmRyYWluZWRfZW5kX2NvdW50ZXIpID4gMCk7CisgICAgQkRSVl9QT0xMX1dISUxF
KGJzLCBxYXRvbWljX3JlYWQoJmRyYWluZWRfZW5kX2NvdW50ZXIpID4gMCk7CiB9CiAKIHZvaWQg
YmRydl9hcHBseV9zdWJ0cmVlX2RyYWluKEJkcnZDaGlsZCAqY2hpbGQsIEJsb2NrRHJpdmVyU3Rh
dGUgKm5ld19wYXJlbnQpCkBAIC01MjYsNyArNTI2LDcgQEAgdm9pZCBiZHJ2X3VuYXBwbHlfc3Vi
dHJlZV9kcmFpbihCZHJ2Q2hpbGQgKmNoaWxkLCBCbG9ja0RyaXZlclN0YXRlICpvbGRfcGFyZW50
KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICZkcmFpbmVkX2VuZF9jb3VudGVyKTsKICAg
ICB9CiAKLSAgICBCRFJWX1BPTExfV0hJTEUoY2hpbGQtPmJzLCBhdG9taWNfcmVhZCgmZHJhaW5l
ZF9lbmRfY291bnRlcikgPiAwKTsKKyAgICBCRFJWX1BPTExfV0hJTEUoY2hpbGQtPmJzLCBxYXRv
bWljX3JlYWQoJmRyYWluZWRfZW5kX2NvdW50ZXIpID4gMCk7CiB9CiAKIC8qCkBAIC01NTMsNyAr
NTUzLDcgQEAgc3RhdGljIHZvaWQgYmRydl9kcmFpbl9hc3NlcnRfaWRsZShCbG9ja0RyaXZlclN0
YXRlICpicykKIHsKICAgICBCZHJ2Q2hpbGQgKmNoaWxkLCAqbmV4dDsKIAotICAgIGFzc2VydChh
dG9taWNfcmVhZCgmYnMtPmluX2ZsaWdodCkgPT0gMCk7CisgICAgYXNzZXJ0KHFhdG9taWNfcmVh
ZCgmYnMtPmluX2ZsaWdodCkgPT0gMCk7CiAgICAgUUxJU1RfRk9SRUFDSF9TQUZFKGNoaWxkLCAm
YnMtPmNoaWxkcmVuLCBuZXh0LCBuZXh0KSB7CiAgICAgICAgIGJkcnZfZHJhaW5fYXNzZXJ0X2lk
bGUoY2hpbGQtPmJzKTsKICAgICB9CkBAIC02NTUsNyArNjU1LDcgQEAgdm9pZCBiZHJ2X2RyYWlu
X2FsbF9lbmQodm9pZCkKICAgICB9CiAKICAgICBhc3NlcnQocWVtdV9nZXRfY3VycmVudF9haW9f
Y29udGV4dCgpID09IHFlbXVfZ2V0X2Fpb19jb250ZXh0KCkpOwotICAgIEFJT19XQUlUX1dISUxF
KE5VTEwsIGF0b21pY19yZWFkKCZkcmFpbmVkX2VuZF9jb3VudGVyKSA+IDApOworICAgIEFJT19X
QUlUX1dISUxFKE5VTEwsIHFhdG9taWNfcmVhZCgmZHJhaW5lZF9lbmRfY291bnRlcikgPiAwKTsK
IAogICAgIGFzc2VydChiZHJ2X2RyYWluX2FsbF9jb3VudCA+IDApOwogICAgIGJkcnZfZHJhaW5f
YWxsX2NvdW50LS07CkBAIC02NzUsNyArNjc1LDcgQEAgdm9pZCBiZHJ2X2RyYWluX2FsbCh2b2lk
KQogc3RhdGljIHZvaWQgdHJhY2tlZF9yZXF1ZXN0X2VuZChCZHJ2VHJhY2tlZFJlcXVlc3QgKnJl
cSkKIHsKICAgICBpZiAocmVxLT5zZXJpYWxpc2luZykgewotICAgICAgICBhdG9taWNfZGVjKCZy
ZXEtPmJzLT5zZXJpYWxpc2luZ19pbl9mbGlnaHQpOworICAgICAgICBxYXRvbWljX2RlYygmcmVx
LT5icy0+c2VyaWFsaXNpbmdfaW5fZmxpZ2h0KTsKICAgICB9CiAKICAgICBxZW11X2NvX211dGV4
X2xvY2soJnJlcS0+YnMtPnJlcXNfbG9jayk7CkBAIC03NzcsNyArNzc3LDcgQEAgYm9vbCBiZHJ2
X21hcmtfcmVxdWVzdF9zZXJpYWxpc2luZyhCZHJ2VHJhY2tlZFJlcXVlc3QgKnJlcSwgdWludDY0
X3QgYWxpZ24pCiAKICAgICBxZW11X2NvX211dGV4X2xvY2soJmJzLT5yZXFzX2xvY2spOwogICAg
IGlmICghcmVxLT5zZXJpYWxpc2luZykgewotICAgICAgICBhdG9taWNfaW5jKCZyZXEtPmJzLT5z
ZXJpYWxpc2luZ19pbl9mbGlnaHQpOworICAgICAgICBxYXRvbWljX2luYygmcmVxLT5icy0+c2Vy
aWFsaXNpbmdfaW5fZmxpZ2h0KTsKICAgICAgICAgcmVxLT5zZXJpYWxpc2luZyA9IHRydWU7CiAg
ICAgfQogCkBAIC04NDEsNyArODQxLDcgQEAgc3RhdGljIGludCBiZHJ2X2dldF9jbHVzdGVyX3Np
emUoQmxvY2tEcml2ZXJTdGF0ZSAqYnMpCiAKIHZvaWQgYmRydl9pbmNfaW5fZmxpZ2h0KEJsb2Nr
RHJpdmVyU3RhdGUgKmJzKQogewotICAgIGF0b21pY19pbmMoJmJzLT5pbl9mbGlnaHQpOworICAg
IHFhdG9taWNfaW5jKCZicy0+aW5fZmxpZ2h0KTsKIH0KIAogdm9pZCBiZHJ2X3dha2V1cChCbG9j
a0RyaXZlclN0YXRlICpicykKQEAgLTg1MSw3ICs4NTEsNyBAQCB2b2lkIGJkcnZfd2FrZXVwKEJs
b2NrRHJpdmVyU3RhdGUgKmJzKQogCiB2b2lkIGJkcnZfZGVjX2luX2ZsaWdodChCbG9ja0RyaXZl
clN0YXRlICpicykKIHsKLSAgICBhdG9taWNfZGVjKCZicy0+aW5fZmxpZ2h0KTsKKyAgICBxYXRv
bWljX2RlYygmYnMtPmluX2ZsaWdodCk7CiAgICAgYmRydl93YWtldXAoYnMpOwogfQogCkBAIC04
NjAsNyArODYwLDcgQEAgc3RhdGljIGJvb2wgY29yb3V0aW5lX2ZuIGJkcnZfd2FpdF9zZXJpYWxp
c2luZ19yZXF1ZXN0cyhCZHJ2VHJhY2tlZFJlcXVlc3QgKnNlbGYKICAgICBCbG9ja0RyaXZlclN0
YXRlICpicyA9IHNlbGYtPmJzOwogICAgIGJvb2wgd2FpdGVkID0gZmFsc2U7CiAKLSAgICBpZiAo
IWF0b21pY19yZWFkKCZicy0+c2VyaWFsaXNpbmdfaW5fZmxpZ2h0KSkgeworICAgIGlmICghcWF0
b21pY19yZWFkKCZicy0+c2VyaWFsaXNpbmdfaW5fZmxpZ2h0KSkgewogICAgICAgICByZXR1cm4g
ZmFsc2U7CiAgICAgfQogCkBAIC0xNzQ3LDcgKzE3NDcsNyBAQCBpbnQgY29yb3V0aW5lX2ZuIGJk
cnZfY29fcHJlYWR2X3BhcnQoQmRydkNoaWxkICpjaGlsZCwKICAgICBiZHJ2X2luY19pbl9mbGln
aHQoYnMpOwogCiAgICAgLyogRG9uJ3QgZG8gY29weS1vbi1yZWFkIGlmIHdlIHJlYWQgZGF0YSBi
ZWZvcmUgd3JpdGUgb3BlcmF0aW9uICovCi0gICAgaWYgKGF0b21pY19yZWFkKCZicy0+Y29weV9v
bl9yZWFkKSkgeworICAgIGlmIChxYXRvbWljX3JlYWQoJmJzLT5jb3B5X29uX3JlYWQpKSB7CiAg
ICAgICAgIGZsYWdzIHw9IEJEUlZfUkVRX0NPUFlfT05fUkVBRDsKICAgICB9CiAKQEAgLTE5MzUs
NyArMTkzNSw3IEBAIGJkcnZfY29fd3JpdGVfcmVxX2ZpbmlzaChCZHJ2Q2hpbGQgKmNoaWxkLCBp
bnQ2NF90IG9mZnNldCwgdWludDY0X3QgYnl0ZXMsCiAgICAgaW50NjRfdCBlbmRfc2VjdG9yID0g
RElWX1JPVU5EX1VQKG9mZnNldCArIGJ5dGVzLCBCRFJWX1NFQ1RPUl9TSVpFKTsKICAgICBCbG9j
a0RyaXZlclN0YXRlICpicyA9IGNoaWxkLT5iczsKIAotICAgIGF0b21pY19pbmMoJmJzLT53cml0
ZV9nZW4pOworICAgIHFhdG9taWNfaW5jKCZicy0+d3JpdGVfZ2VuKTsKIAogICAgIC8qCiAgICAg
ICogRGlzY2FyZCBjYW5ub3QgZXh0ZW5kIHRoZSBpbWFnZSwgYnV0IGluIGVycm9yIGhhbmRsaW5n
IGNhc2VzLCBzdWNoIGFzCkBAIC0yNzY4LDcgKzI3NjgsNyBAQCBpbnQgY29yb3V0aW5lX2ZuIGJk
cnZfY29fZmx1c2goQmxvY2tEcml2ZXJTdGF0ZSAqYnMpCiAgICAgfQogCiAgICAgcWVtdV9jb19t
dXRleF9sb2NrKCZicy0+cmVxc19sb2NrKTsKLSAgICBjdXJyZW50X2dlbiA9IGF0b21pY19yZWFk
KCZicy0+d3JpdGVfZ2VuKTsKKyAgICBjdXJyZW50X2dlbiA9IHFhdG9taWNfcmVhZCgmYnMtPndy
aXRlX2dlbik7CiAKICAgICAvKiBXYWl0IHVudGlsIGFueSBwcmV2aW91cyBmbHVzaGVzIGFyZSBj
b21wbGV0ZWQgKi8KICAgICB3aGlsZSAoYnMtPmFjdGl2ZV9mbHVzaF9yZXEpIHsKQEAgLTMxMTYs
NyArMzExNiw3IEBAIHZvaWQgYmRydl9pb19wbHVnKEJsb2NrRHJpdmVyU3RhdGUgKmJzKQogICAg
ICAgICBiZHJ2X2lvX3BsdWcoY2hpbGQtPmJzKTsKICAgICB9CiAKLSAgICBpZiAoYXRvbWljX2Zl
dGNoX2luYygmYnMtPmlvX3BsdWdnZWQpID09IDApIHsKKyAgICBpZiAocWF0b21pY19mZXRjaF9p
bmMoJmJzLT5pb19wbHVnZ2VkKSA9PSAwKSB7CiAgICAgICAgIEJsb2NrRHJpdmVyICpkcnYgPSBi
cy0+ZHJ2OwogICAgICAgICBpZiAoZHJ2ICYmIGRydi0+YmRydl9pb19wbHVnKSB7CiAgICAgICAg
ICAgICBkcnYtPmJkcnZfaW9fcGx1Zyhicyk7CkBAIC0zMTI5LDcgKzMxMjksNyBAQCB2b2lkIGJk
cnZfaW9fdW5wbHVnKEJsb2NrRHJpdmVyU3RhdGUgKmJzKQogICAgIEJkcnZDaGlsZCAqY2hpbGQ7
CiAKICAgICBhc3NlcnQoYnMtPmlvX3BsdWdnZWQpOwotICAgIGlmIChhdG9taWNfZmV0Y2hfZGVj
KCZicy0+aW9fcGx1Z2dlZCkgPT0gMSkgeworICAgIGlmIChxYXRvbWljX2ZldGNoX2RlYygmYnMt
PmlvX3BsdWdnZWQpID09IDEpIHsKICAgICAgICAgQmxvY2tEcml2ZXIgKmRydiA9IGJzLT5kcnY7
CiAgICAgICAgIGlmIChkcnYgJiYgZHJ2LT5iZHJ2X2lvX3VucGx1ZykgewogICAgICAgICAgICAg
ZHJ2LT5iZHJ2X2lvX3VucGx1Zyhicyk7CmRpZmYgLS1naXQgYS9ibG9jay9uZnMuYyBiL2Jsb2Nr
L25mcy5jCmluZGV4IDYxYTI0OWE5ZmMuLmY4NmU2NjAzNzQgMTAwNjQ0Ci0tLSBhL2Jsb2NrL25m
cy5jCisrKyBiL2Jsb2NrL25mcy5jCkBAIC03MjEsNyArNzIxLDcgQEAgbmZzX2dldF9hbGxvY2F0
ZWRfZmlsZV9zaXplX2NiKGludCByZXQsIHN0cnVjdCBuZnNfY29udGV4dCAqbmZzLCB2b2lkICpk
YXRhLAogICAgIH0KIAogICAgIC8qIFNldCB0YXNrLT5jb21wbGV0ZSBiZWZvcmUgcmVhZGluZyBi
cy0+d2FrZXVwLiAgKi8KLSAgICBhdG9taWNfbWJfc2V0KCZ0YXNrLT5jb21wbGV0ZSwgMSk7Cisg
ICAgcWF0b21pY19tYl9zZXQoJnRhc2stPmNvbXBsZXRlLCAxKTsKICAgICBiZHJ2X3dha2V1cCh0
YXNrLT5icyk7CiB9CiAKZGlmZiAtLWdpdCBhL2Jsb2NrL3NoZWVwZG9nLmMgYi9ibG9jay9zaGVl
cGRvZy5jCmluZGV4IGNiYmViYzFhYWYuLjJmNWMwZWIzNzYgMTAwNjQ0Ci0tLSBhL2Jsb2NrL3No
ZWVwZG9nLmMKKysrIGIvYmxvY2svc2hlZXBkb2cuYwpAQCAtNjY1LDcgKzY2NSw3IEBAIG91dDoK
ICAgICBzcmNvLT5jbyA9IE5VTEw7CiAgICAgc3Jjby0+cmV0ID0gcmV0OwogICAgIC8qIFNldCBz
cmNvLT5maW5pc2hlZCBiZWZvcmUgcmVhZGluZyBicy0+d2FrZXVwLiAgKi8KLSAgICBhdG9taWNf
bWJfc2V0KCZzcmNvLT5maW5pc2hlZCwgdHJ1ZSk7CisgICAgcWF0b21pY19tYl9zZXQoJnNyY28t
PmZpbmlzaGVkLCB0cnVlKTsKICAgICBpZiAoc3Jjby0+YnMpIHsKICAgICAgICAgYmRydl93YWtl
dXAoc3Jjby0+YnMpOwogICAgIH0KZGlmZiAtLWdpdCBhL2Jsb2NrL3Rocm90dGxlLWdyb3Vwcy5j
IGIvYmxvY2svdGhyb3R0bGUtZ3JvdXBzLmMKaW5kZXggNGUyODM2NWQ4ZC4uZTJmMjgxM2MwZiAx
MDA2NDQKLS0tIGEvYmxvY2svdGhyb3R0bGUtZ3JvdXBzLmMKKysrIGIvYmxvY2svdGhyb3R0bGUt
Z3JvdXBzLmMKQEAgLTIyOCw3ICsyMjgsNyBAQCBzdGF0aWMgVGhyb3R0bGVHcm91cE1lbWJlciAq
bmV4dF90aHJvdHRsZV90b2tlbihUaHJvdHRsZUdyb3VwTWVtYmVyICp0Z20sCiAgICAgICogaW1t
ZWRpYXRlbHkgaWYgaXQgaGFzIHBlbmRpbmcgcmVxdWVzdHMuIE90aGVyd2lzZSB3ZSBjb3VsZCBi
ZQogICAgICAqIGZvcmNpbmcgaXQgdG8gd2FpdCBmb3Igb3RoZXIgbWVtYmVyJ3MgdGhyb3R0bGVk
IHJlcXVlc3RzLiAqLwogICAgIGlmICh0Z21faGFzX3BlbmRpbmdfcmVxcyh0Z20sIGlzX3dyaXRl
KSAmJgotICAgICAgICBhdG9taWNfcmVhZCgmdGdtLT5pb19saW1pdHNfZGlzYWJsZWQpKSB7Cisg
ICAgICAgIHFhdG9taWNfcmVhZCgmdGdtLT5pb19saW1pdHNfZGlzYWJsZWQpKSB7CiAgICAgICAg
IHJldHVybiB0Z207CiAgICAgfQogCkBAIC0yNzIsNyArMjcyLDcgQEAgc3RhdGljIGJvb2wgdGhy
b3R0bGVfZ3JvdXBfc2NoZWR1bGVfdGltZXIoVGhyb3R0bGVHcm91cE1lbWJlciAqdGdtLAogICAg
IFRocm90dGxlVGltZXJzICp0dCA9ICZ0Z20tPnRocm90dGxlX3RpbWVyczsKICAgICBib29sIG11
c3Rfd2FpdDsKIAotICAgIGlmIChhdG9taWNfcmVhZCgmdGdtLT5pb19saW1pdHNfZGlzYWJsZWQp
KSB7CisgICAgaWYgKHFhdG9taWNfcmVhZCgmdGdtLT5pb19saW1pdHNfZGlzYWJsZWQpKSB7CiAg
ICAgICAgIHJldHVybiBmYWxzZTsKICAgICB9CiAKQEAgLTQxNyw3ICs0MTcsNyBAQCBzdGF0aWMg
dm9pZCBjb3JvdXRpbmVfZm4gdGhyb3R0bGVfZ3JvdXBfcmVzdGFydF9xdWV1ZV9lbnRyeSh2b2lk
ICpvcGFxdWUpCiAKICAgICBnX2ZyZWUoZGF0YSk7CiAKLSAgICBhdG9taWNfZGVjKCZ0Z20tPnJl
c3RhcnRfcGVuZGluZyk7CisgICAgcWF0b21pY19kZWMoJnRnbS0+cmVzdGFydF9wZW5kaW5nKTsK
ICAgICBhaW9fd2FpdF9raWNrKCk7CiB9CiAKQEAgLTQzNCw3ICs0MzQsNyBAQCBzdGF0aWMgdm9p
ZCB0aHJvdHRsZV9ncm91cF9yZXN0YXJ0X3F1ZXVlKFRocm90dGxlR3JvdXBNZW1iZXIgKnRnbSwg
Ym9vbCBpc193cml0ZQogICAgICAqIGJlIG5vIHRpbWVyIHBlbmRpbmcgb24gdGhpcyB0Z20gYXQg
dGhpcyBwb2ludCAqLwogICAgIGFzc2VydCghdGltZXJfcGVuZGluZyh0Z20tPnRocm90dGxlX3Rp
bWVycy50aW1lcnNbaXNfd3JpdGVdKSk7CiAKLSAgICBhdG9taWNfaW5jKCZ0Z20tPnJlc3RhcnRf
cGVuZGluZyk7CisgICAgcWF0b21pY19pbmMoJnRnbS0+cmVzdGFydF9wZW5kaW5nKTsKIAogICAg
IGNvID0gcWVtdV9jb3JvdXRpbmVfY3JlYXRlKHRocm90dGxlX2dyb3VwX3Jlc3RhcnRfcXVldWVf
ZW50cnksIHJkKTsKICAgICBhaW9fY29fZW50ZXIodGdtLT5haW9fY29udGV4dCwgY28pOwpAQCAt
NTQ0LDcgKzU0NCw3IEBAIHZvaWQgdGhyb3R0bGVfZ3JvdXBfcmVnaXN0ZXJfdGdtKFRocm90dGxl
R3JvdXBNZW1iZXIgKnRnbSwKIAogICAgIHRnbS0+dGhyb3R0bGVfc3RhdGUgPSB0czsKICAgICB0
Z20tPmFpb19jb250ZXh0ID0gY3R4OwotICAgIGF0b21pY19zZXQoJnRnbS0+cmVzdGFydF9wZW5k
aW5nLCAwKTsKKyAgICBxYXRvbWljX3NldCgmdGdtLT5yZXN0YXJ0X3BlbmRpbmcsIDApOwogCiAg
ICAgcWVtdV9tdXRleF9sb2NrKCZ0Zy0+bG9jayk7CiAgICAgLyogSWYgdGhlIFRocm90dGxlR3Jv
dXAgaXMgbmV3IHNldCB0aGlzIFRocm90dGxlR3JvdXBNZW1iZXIgYXMgdGhlIHRva2VuICovCkBA
IC01OTIsNyArNTkyLDcgQEAgdm9pZCB0aHJvdHRsZV9ncm91cF91bnJlZ2lzdGVyX3RnbShUaHJv
dHRsZUdyb3VwTWVtYmVyICp0Z20pCiAgICAgfQogCiAgICAgLyogV2FpdCBmb3IgdGhyb3R0bGVf
Z3JvdXBfcmVzdGFydF9xdWV1ZV9lbnRyeSgpIGNvcm91dGluZXMgdG8gZmluaXNoICovCi0gICAg
QUlPX1dBSVRfV0hJTEUodGdtLT5haW9fY29udGV4dCwgYXRvbWljX3JlYWQoJnRnbS0+cmVzdGFy
dF9wZW5kaW5nKSA+IDApOworICAgIEFJT19XQUlUX1dISUxFKHRnbS0+YWlvX2NvbnRleHQsIHFh
dG9taWNfcmVhZCgmdGdtLT5yZXN0YXJ0X3BlbmRpbmcpID4gMCk7CiAKICAgICBxZW11X211dGV4
X2xvY2soJnRnLT5sb2NrKTsKICAgICBmb3IgKGkgPSAwOyBpIDwgMjsgaSsrKSB7CmRpZmYgLS1n
aXQgYS9ibG9jay90aHJvdHRsZS5jIGIvYmxvY2svdGhyb3R0bGUuYwppbmRleCA5YTBmMzgxNDlh
Li5iNjg1MTY2YWQ0IDEwMDY0NAotLS0gYS9ibG9jay90aHJvdHRsZS5jCisrKyBiL2Jsb2NrL3Ro
cm90dGxlLmMKQEAgLTIxNyw3ICsyMTcsNyBAQCBzdGF0aWMgdm9pZCB0aHJvdHRsZV9yZW9wZW5f
YWJvcnQoQkRSVlJlb3BlblN0YXRlICpyZW9wZW5fc3RhdGUpCiBzdGF0aWMgdm9pZCBjb3JvdXRp
bmVfZm4gdGhyb3R0bGVfY29fZHJhaW5fYmVnaW4oQmxvY2tEcml2ZXJTdGF0ZSAqYnMpCiB7CiAg
ICAgVGhyb3R0bGVHcm91cE1lbWJlciAqdGdtID0gYnMtPm9wYXF1ZTsKLSAgICBpZiAoYXRvbWlj
X2ZldGNoX2luYygmdGdtLT5pb19saW1pdHNfZGlzYWJsZWQpID09IDApIHsKKyAgICBpZiAocWF0
b21pY19mZXRjaF9pbmMoJnRnbS0+aW9fbGltaXRzX2Rpc2FibGVkKSA9PSAwKSB7CiAgICAgICAg
IHRocm90dGxlX2dyb3VwX3Jlc3RhcnRfdGdtKHRnbSk7CiAgICAgfQogfQpAQCAtMjI2LDcgKzIy
Niw3IEBAIHN0YXRpYyB2b2lkIGNvcm91dGluZV9mbiB0aHJvdHRsZV9jb19kcmFpbl9lbmQoQmxv
Y2tEcml2ZXJTdGF0ZSAqYnMpCiB7CiAgICAgVGhyb3R0bGVHcm91cE1lbWJlciAqdGdtID0gYnMt
Pm9wYXF1ZTsKICAgICBhc3NlcnQodGdtLT5pb19saW1pdHNfZGlzYWJsZWQpOwotICAgIGF0b21p
Y19kZWMoJnRnbS0+aW9fbGltaXRzX2Rpc2FibGVkKTsKKyAgICBxYXRvbWljX2RlYygmdGdtLT5p
b19saW1pdHNfZGlzYWJsZWQpOwogfQogCiBzdGF0aWMgY29uc3QgY2hhciAqY29uc3QgdGhyb3R0
bGVfc3Ryb25nX3J1bnRpbWVfb3B0c1tdID0gewpkaWZmIC0tZ2l0IGEvYmxvY2tkZXYuYyBiL2Js
b2NrZGV2LmMKaW5kZXggN2YyNTYxMDgxZS4uYmViZDNiYTFjMyAxMDA2NDQKLS0tIGEvYmxvY2tk
ZXYuYworKysgYi9ibG9ja2Rldi5jCkBAIC0xNjA0LDcgKzE2MDQsNyBAQCBzdGF0aWMgdm9pZCBl
eHRlcm5hbF9zbmFwc2hvdF9jb21taXQoQmxrQWN0aW9uU3RhdGUgKmNvbW1vbikKICAgICAvKiBX
ZSBkb24ndCBuZWVkIChvciB3YW50KSB0byB1c2UgdGhlIHRyYW5zYWN0aW9uYWwKICAgICAgKiBi
ZHJ2X3Jlb3Blbl9tdWx0aXBsZSgpIGFjcm9zcyBhbGwgdGhlIGVudHJpZXMgYXQgb25jZSwgYmVj
YXVzZSB3ZQogICAgICAqIGRvbid0IHdhbnQgdG8gYWJvcnQgYWxsIG9mIHRoZW0gaWYgb25lIG9m
IHRoZW0gZmFpbHMgdGhlIHJlb3BlbiAqLwotICAgIGlmICghYXRvbWljX3JlYWQoJnN0YXRlLT5v
bGRfYnMtPmNvcHlfb25fcmVhZCkpIHsKKyAgICBpZiAoIXFhdG9taWNfcmVhZCgmc3RhdGUtPm9s
ZF9icy0+Y29weV9vbl9yZWFkKSkgewogICAgICAgICBiZHJ2X3Jlb3Blbl9zZXRfcmVhZF9vbmx5
KHN0YXRlLT5vbGRfYnMsIHRydWUsIE5VTEwpOwogICAgIH0KIApkaWZmIC0tZ2l0IGEvYmxvY2tq
b2IuYyBiL2Jsb2Nram9iLmMKaW5kZXggNDcwZmFjZmQ0Ny4uOThhYzhhZjk4MiAxMDA2NDQKLS0t
IGEvYmxvY2tqb2IuYworKysgYi9ibG9ja2pvYi5jCkBAIC0yOTgsNyArMjk4LDcgQEAgQmxvY2tK
b2JJbmZvICpibG9ja19qb2JfcXVlcnkoQmxvY2tKb2IgKmpvYiwgRXJyb3IgKiplcnJwKQogICAg
IGluZm8gPSBnX25ldzAoQmxvY2tKb2JJbmZvLCAxKTsKICAgICBpbmZvLT50eXBlICAgICAgPSBn
X3N0cmR1cChqb2JfdHlwZV9zdHIoJmpvYi0+am9iKSk7CiAgICAgaW5mby0+ZGV2aWNlICAgID0g
Z19zdHJkdXAoam9iLT5qb2IuaWQpOwotICAgIGluZm8tPmJ1c3kgICAgICA9IGF0b21pY19yZWFk
KCZqb2ItPmpvYi5idXN5KTsKKyAgICBpbmZvLT5idXN5ICAgICAgPSBxYXRvbWljX3JlYWQoJmpv
Yi0+am9iLmJ1c3kpOwogICAgIGluZm8tPnBhdXNlZCAgICA9IGpvYi0+am9iLnBhdXNlX2NvdW50
ID4gMDsKICAgICBpbmZvLT5vZmZzZXQgICAgPSBqb2ItPmpvYi5wcm9ncmVzcy5jdXJyZW50Owog
ICAgIGluZm8tPmxlbiAgICAgICA9IGpvYi0+am9iLnByb2dyZXNzLnRvdGFsOwpkaWZmIC0tZ2l0
IGEvY29udHJpYi9saWJ2aG9zdC11c2VyL2xpYnZob3N0LXVzZXIuYyBiL2NvbnRyaWIvbGlidmhv
c3QtdXNlci9saWJ2aG9zdC11c2VyLmMKaW5kZXggZGFhNTc1NTIwYy4uNzAwNTVjOThiNyAxMDA2
NDQKLS0tIGEvY29udHJpYi9saWJ2aG9zdC11c2VyL2xpYnZob3N0LXVzZXIuYworKysgYi9jb250
cmliL2xpYnZob3N0LXVzZXIvbGlidmhvc3QtdXNlci5jCkBAIC00NDksNyArNDQ5LDcgQEAgc3Rh
dGljIHZvaWQKIHZ1X2xvZ19wYWdlKHVpbnQ4X3QgKmxvZ190YWJsZSwgdWludDY0X3QgcGFnZSkK
IHsKICAgICBEUFJJTlQoIkxvZ2dlZCBkaXJ0eSBndWVzdCBwYWdlOiAlIlBSSWQ2NCJcbiIsIHBh
Z2UpOwotICAgIGF0b21pY19vcigmbG9nX3RhYmxlW3BhZ2UgLyA4XSwgMSA8PCAocGFnZSAlIDgp
KTsKKyAgICBxYXRvbWljX29yKCZsb2dfdGFibGVbcGFnZSAvIDhdLCAxIDw8IChwYWdlICUgOCkp
OwogfQogCiBzdGF0aWMgdm9pZApkaWZmIC0tZ2l0IGEvY3B1cy1jb21tb24uYyBiL2NwdXMtY29t
bW9uLmMKaW5kZXggMzQwNDRmNGU0Yy4uODM0NzVlZmZmNyAxMDA2NDQKLS0tIGEvY3B1cy1jb21t
b24uYworKysgYi9jcHVzLWNvbW1vbi5jCkBAIC0xNDgsNyArMTQ4LDcgQEAgdm9pZCBkb19ydW5f
b25fY3B1KENQVVN0YXRlICpjcHUsIHJ1bl9vbl9jcHVfZnVuYyBmdW5jLCBydW5fb25fY3B1X2Rh
dGEgZGF0YSwKICAgICB3aS5leGNsdXNpdmUgPSBmYWxzZTsKIAogICAgIHF1ZXVlX3dvcmtfb25f
Y3B1KGNwdSwgJndpKTsKLSAgICB3aGlsZSAoIWF0b21pY19tYl9yZWFkKCZ3aS5kb25lKSkgewor
ICAgIHdoaWxlICghcWF0b21pY19tYl9yZWFkKCZ3aS5kb25lKSkgewogICAgICAgICBDUFVTdGF0
ZSAqc2VsZl9jcHUgPSBjdXJyZW50X2NwdTsKIAogICAgICAgICBxZW11X2NvbmRfd2FpdCgmcWVt
dV93b3JrX2NvbmQsIG11dGV4KTsKQEAgLTE4OCwyMCArMTg4LDIwIEBAIHZvaWQgc3RhcnRfZXhj
bHVzaXZlKHZvaWQpCiAgICAgZXhjbHVzaXZlX2lkbGUoKTsKIAogICAgIC8qIE1ha2UgYWxsIG90
aGVyIGNwdXMgc3RvcCBleGVjdXRpbmcuICAqLwotICAgIGF0b21pY19zZXQoJnBlbmRpbmdfY3B1
cywgMSk7CisgICAgcWF0b21pY19zZXQoJnBlbmRpbmdfY3B1cywgMSk7CiAKICAgICAvKiBXcml0
ZSBwZW5kaW5nX2NwdXMgYmVmb3JlIHJlYWRpbmcgb3RoZXJfY3B1LT5ydW5uaW5nLiAgKi8KICAg
ICBzbXBfbWIoKTsKICAgICBydW5uaW5nX2NwdXMgPSAwOwogICAgIENQVV9GT1JFQUNIKG90aGVy
X2NwdSkgewotICAgICAgICBpZiAoYXRvbWljX3JlYWQoJm90aGVyX2NwdS0+cnVubmluZykpIHsK
KyAgICAgICAgaWYgKHFhdG9taWNfcmVhZCgmb3RoZXJfY3B1LT5ydW5uaW5nKSkgewogICAgICAg
ICAgICAgb3RoZXJfY3B1LT5oYXNfd2FpdGVyID0gdHJ1ZTsKICAgICAgICAgICAgIHJ1bm5pbmdf
Y3B1cysrOwogICAgICAgICAgICAgcWVtdV9jcHVfa2ljayhvdGhlcl9jcHUpOwogICAgICAgICB9
CiAgICAgfQogCi0gICAgYXRvbWljX3NldCgmcGVuZGluZ19jcHVzLCBydW5uaW5nX2NwdXMgKyAx
KTsKKyAgICBxYXRvbWljX3NldCgmcGVuZGluZ19jcHVzLCBydW5uaW5nX2NwdXMgKyAxKTsKICAg
ICB3aGlsZSAocGVuZGluZ19jcHVzID4gMSkgewogICAgICAgICBxZW11X2NvbmRfd2FpdCgmZXhj
bHVzaXZlX2NvbmQsICZxZW11X2NwdV9saXN0X2xvY2spOwogICAgIH0KQEAgLTIyMCw3ICsyMjAs
NyBAQCB2b2lkIGVuZF9leGNsdXNpdmUodm9pZCkKICAgICBjdXJyZW50X2NwdS0+aW5fZXhjbHVz
aXZlX2NvbnRleHQgPSBmYWxzZTsKIAogICAgIHFlbXVfbXV0ZXhfbG9jaygmcWVtdV9jcHVfbGlz
dF9sb2NrKTsKLSAgICBhdG9taWNfc2V0KCZwZW5kaW5nX2NwdXMsIDApOworICAgIHFhdG9taWNf
c2V0KCZwZW5kaW5nX2NwdXMsIDApOwogICAgIHFlbXVfY29uZF9icm9hZGNhc3QoJmV4Y2x1c2l2
ZV9yZXN1bWUpOwogICAgIHFlbXVfbXV0ZXhfdW5sb2NrKCZxZW11X2NwdV9saXN0X2xvY2spOwog
fQpAQCAtMjI4LDcgKzIyOCw3IEBAIHZvaWQgZW5kX2V4Y2x1c2l2ZSh2b2lkKQogLyogV2FpdCBm
b3IgZXhjbHVzaXZlIG9wcyB0byBmaW5pc2gsIGFuZCBiZWdpbiBjcHUgZXhlY3V0aW9uLiAgKi8K
IHZvaWQgY3B1X2V4ZWNfc3RhcnQoQ1BVU3RhdGUgKmNwdSkKIHsKLSAgICBhdG9taWNfc2V0KCZj
cHUtPnJ1bm5pbmcsIHRydWUpOworICAgIHFhdG9taWNfc2V0KCZjcHUtPnJ1bm5pbmcsIHRydWUp
OwogCiAgICAgLyogV3JpdGUgY3B1LT5ydW5uaW5nIGJlZm9yZSByZWFkaW5nIHBlbmRpbmdfY3B1
cy4gICovCiAgICAgc21wX21iKCk7CkBAIC0yNDYsMTcgKzI0NiwxNyBAQCB2b2lkIGNwdV9leGVj
X3N0YXJ0KENQVVN0YXRlICpjcHUpCiAgICAgICogMy4gcGVuZGluZ19jcHVzID09IDAuICBUaGVu
IHN0YXJ0X2V4Y2x1c2l2ZSBpcyBkZWZpbml0ZWx5IGdvaW5nIHRvCiAgICAgICogc2VlIGNwdS0+
cnVubmluZyA9PSB0cnVlLCBhbmQgaXQgd2lsbCBraWNrIHRoZSBDUFUuCiAgICAgICovCi0gICAg
aWYgKHVubGlrZWx5KGF0b21pY19yZWFkKCZwZW5kaW5nX2NwdXMpKSkgeworICAgIGlmICh1bmxp
a2VseShxYXRvbWljX3JlYWQoJnBlbmRpbmdfY3B1cykpKSB7CiAgICAgICAgIFFFTVVfTE9DS19H
VUFSRCgmcWVtdV9jcHVfbGlzdF9sb2NrKTsKICAgICAgICAgaWYgKCFjcHUtPmhhc193YWl0ZXIp
IHsKICAgICAgICAgICAgIC8qIE5vdCBjb3VudGVkIGluIHBlbmRpbmdfY3B1cywgbGV0IHRoZSBl
eGNsdXNpdmUgaXRlbQogICAgICAgICAgICAgICogcnVuLiAgU2luY2Ugd2UgaGF2ZSB0aGUgbG9j
aywganVzdCBzZXQgY3B1LT5ydW5uaW5nIHRvIHRydWUKICAgICAgICAgICAgICAqIHdoaWxlIGhv
bGRpbmcgaXQ7IG5vIG5lZWQgdG8gY2hlY2sgcGVuZGluZ19jcHVzIGFnYWluLgogICAgICAgICAg
ICAgICovCi0gICAgICAgICAgICBhdG9taWNfc2V0KCZjcHUtPnJ1bm5pbmcsIGZhbHNlKTsKKyAg
ICAgICAgICAgIHFhdG9taWNfc2V0KCZjcHUtPnJ1bm5pbmcsIGZhbHNlKTsKICAgICAgICAgICAg
IGV4Y2x1c2l2ZV9pZGxlKCk7CiAgICAgICAgICAgICAvKiBOb3cgcGVuZGluZ19jcHVzIGlzIHpl
cm8uICAqLwotICAgICAgICAgICAgYXRvbWljX3NldCgmY3B1LT5ydW5uaW5nLCB0cnVlKTsKKyAg
ICAgICAgICAgIHFhdG9taWNfc2V0KCZjcHUtPnJ1bm5pbmcsIHRydWUpOwogICAgICAgICB9IGVs
c2UgewogICAgICAgICAgICAgLyogQ291bnRlZCBpbiBwZW5kaW5nX2NwdXMsIGdvIGFoZWFkIGFu
ZCByZWxlYXNlIHRoZQogICAgICAgICAgICAgICogd2FpdGVyIGF0IGNwdV9leGVjX2VuZC4KQEAg
LTI2OCw3ICsyNjgsNyBAQCB2b2lkIGNwdV9leGVjX3N0YXJ0KENQVVN0YXRlICpjcHUpCiAvKiBN
YXJrIGNwdSBhcyBub3QgZXhlY3V0aW5nLCBhbmQgcmVsZWFzZSBwZW5kaW5nIGV4Y2x1c2l2ZSBv
cHMuICAqLwogdm9pZCBjcHVfZXhlY19lbmQoQ1BVU3RhdGUgKmNwdSkKIHsKLSAgICBhdG9taWNf
c2V0KCZjcHUtPnJ1bm5pbmcsIGZhbHNlKTsKKyAgICBxYXRvbWljX3NldCgmY3B1LT5ydW5uaW5n
LCBmYWxzZSk7CiAKICAgICAvKiBXcml0ZSBjcHUtPnJ1bm5pbmcgYmVmb3JlIHJlYWRpbmcgcGVu
ZGluZ19jcHVzLiAgKi8KICAgICBzbXBfbWIoKTsKQEAgLTI4OCwxMSArMjg4LDExIEBAIHZvaWQg
Y3B1X2V4ZWNfZW5kKENQVVN0YXRlICpjcHUpCiAgICAgICogc2VlIGNwdS0+cnVubmluZyA9PSBm
YWxzZSwgYW5kIGl0IGNhbiBpZ25vcmUgdGhpcyBDUFUgdW50aWwgdGhlCiAgICAgICogbmV4dCBj
cHVfZXhlY19zdGFydC4KICAgICAgKi8KLSAgICBpZiAodW5saWtlbHkoYXRvbWljX3JlYWQoJnBl
bmRpbmdfY3B1cykpKSB7CisgICAgaWYgKHVubGlrZWx5KHFhdG9taWNfcmVhZCgmcGVuZGluZ19j
cHVzKSkpIHsKICAgICAgICAgUUVNVV9MT0NLX0dVQVJEKCZxZW11X2NwdV9saXN0X2xvY2spOwog
ICAgICAgICBpZiAoY3B1LT5oYXNfd2FpdGVyKSB7CiAgICAgICAgICAgICBjcHUtPmhhc193YWl0
ZXIgPSBmYWxzZTsKLSAgICAgICAgICAgIGF0b21pY19zZXQoJnBlbmRpbmdfY3B1cywgcGVuZGlu
Z19jcHVzIC0gMSk7CisgICAgICAgICAgICBxYXRvbWljX3NldCgmcGVuZGluZ19jcHVzLCBwZW5k
aW5nX2NwdXMgLSAxKTsKICAgICAgICAgICAgIGlmIChwZW5kaW5nX2NwdXMgPT0gMSkgewogICAg
ICAgICAgICAgICAgIHFlbXVfY29uZF9zaWduYWwoJmV4Y2x1c2l2ZV9jb25kKTsKICAgICAgICAg
ICAgIH0KQEAgLTM0Niw3ICszNDYsNyBAQCB2b2lkIHByb2Nlc3NfcXVldWVkX2NwdV93b3JrKENQ
VVN0YXRlICpjcHUpCiAgICAgICAgIGlmICh3aS0+ZnJlZSkgewogICAgICAgICAgICAgZ19mcmVl
KHdpKTsKICAgICAgICAgfSBlbHNlIHsKLSAgICAgICAgICAgIGF0b21pY19tYl9zZXQoJndpLT5k
b25lLCB0cnVlKTsKKyAgICAgICAgICAgIHFhdG9taWNfbWJfc2V0KCZ3aS0+ZG9uZSwgdHJ1ZSk7
CiAgICAgICAgIH0KICAgICB9CiAgICAgcWVtdV9tdXRleF91bmxvY2soJmNwdS0+d29ya19tdXRl
eCk7CmRpZmYgLS1naXQgYS9kdW1wL2R1bXAuYyBiL2R1bXAvZHVtcC5jCmluZGV4IDEzZmRhNDQw
YTQuLjQ1ZGE0NmE5NTIgMTAwNjQ0Ci0tLSBhL2R1bXAvZHVtcC5jCisrKyBiL2R1bXAvZHVtcC5j
CkBAIC0xNTcyLDcgKzE1NzIsNyBAQCBzdGF0aWMgdm9pZCBkdW1wX3N0YXRlX3ByZXBhcmUoRHVt
cFN0YXRlICpzKQogYm9vbCBkdW1wX2luX3Byb2dyZXNzKHZvaWQpCiB7CiAgICAgRHVtcFN0YXRl
ICpzdGF0ZSA9ICZkdW1wX3N0YXRlX2dsb2JhbDsKLSAgICByZXR1cm4gKGF0b21pY19yZWFkKCZz
dGF0ZS0+c3RhdHVzKSA9PSBEVU1QX1NUQVRVU19BQ1RJVkUpOworICAgIHJldHVybiAocWF0b21p
Y19yZWFkKCZzdGF0ZS0+c3RhdHVzKSA9PSBEVU1QX1NUQVRVU19BQ1RJVkUpOwogfQogCiAvKiBj
YWxjdWxhdGUgdG90YWwgc2l6ZSBvZiBtZW1vcnkgdG8gYmUgZHVtcGVkICh0YWtpbmcgZmlsdGVy
IGludG8KQEAgLTE4ODIsNyArMTg4Miw3IEBAIHN0YXRpYyB2b2lkIGR1bXBfcHJvY2VzcyhEdW1w
U3RhdGUgKnMsIEVycm9yICoqZXJycCkKIAogICAgIC8qIG1ha2Ugc3VyZSBzdGF0dXMgaXMgd3Jp
dHRlbiBhZnRlciB3cml0dGVuX3NpemUgdXBkYXRlcyAqLwogICAgIHNtcF93bWIoKTsKLSAgICBh
dG9taWNfc2V0KCZzLT5zdGF0dXMsCisgICAgcWF0b21pY19zZXQoJnMtPnN0YXR1cywKICAgICAg
ICAgICAgICAgIChsb2NhbF9lcnIgPyBEVU1QX1NUQVRVU19GQUlMRUQgOiBEVU1QX1NUQVRVU19D
T01QTEVURUQpKTsKIAogICAgIC8qIHNlbmQgRFVNUF9DT01QTEVURUQgbWVzc2FnZSAodW5jb25k
aXRpb25hbGx5KSAqLwpAQCAtMTkwOCw3ICsxOTA4LDcgQEAgRHVtcFF1ZXJ5UmVzdWx0ICpxbXBf
cXVlcnlfZHVtcChFcnJvciAqKmVycnApCiB7CiAgICAgRHVtcFF1ZXJ5UmVzdWx0ICpyZXN1bHQg
PSBnX25ldyhEdW1wUXVlcnlSZXN1bHQsIDEpOwogICAgIER1bXBTdGF0ZSAqc3RhdGUgPSAmZHVt
cF9zdGF0ZV9nbG9iYWw7Ci0gICAgcmVzdWx0LT5zdGF0dXMgPSBhdG9taWNfcmVhZCgmc3RhdGUt
PnN0YXR1cyk7CisgICAgcmVzdWx0LT5zdGF0dXMgPSBxYXRvbWljX3JlYWQoJnN0YXRlLT5zdGF0
dXMpOwogICAgIC8qIG1ha2Ugc3VyZSB3ZSBhcmUgcmVhZGluZyBzdGF0dXMgYW5kIHdyaXR0ZW5f
c2l6ZSBpbiBvcmRlciAqLwogICAgIHNtcF9ybWIoKTsKICAgICByZXN1bHQtPmNvbXBsZXRlZCA9
IHN0YXRlLT53cml0dGVuX3NpemU7CkBAIC0yMDEzLDcgKzIwMTMsNyBAQCB2b2lkIHFtcF9kdW1w
X2d1ZXN0X21lbW9yeShib29sIHBhZ2luZywgY29uc3QgY2hhciAqZmlsZSwKICAgICAgICAgICAg
ICAgYmVnaW4sIGxlbmd0aCwgJmxvY2FsX2Vycik7CiAgICAgaWYgKGxvY2FsX2VycikgewogICAg
ICAgICBlcnJvcl9wcm9wYWdhdGUoZXJycCwgbG9jYWxfZXJyKTsKLSAgICAgICAgYXRvbWljX3Nl
dCgmcy0+c3RhdHVzLCBEVU1QX1NUQVRVU19GQUlMRUQpOworICAgICAgICBxYXRvbWljX3NldCgm
cy0+c3RhdHVzLCBEVU1QX1NUQVRVU19GQUlMRUQpOwogICAgICAgICByZXR1cm47CiAgICAgfQog
CmRpZmYgLS1naXQgYS9leGVjLmMgYi9leGVjLmMKaW5kZXggZTM0YjYwMmJkZi4uM2Y1ZGViMzVm
ZiAxMDA2NDQKLS0tIGEvZXhlYy5jCisrKyBiL2V4ZWMuYwpAQCAtMzUzLDEzICszNTMsMTMgQEAg
c3RhdGljIE1lbW9yeVJlZ2lvblNlY3Rpb24gKmFkZHJlc3Nfc3BhY2VfbG9va3VwX3JlZ2lvbihB
ZGRyZXNzU3BhY2VEaXNwYXRjaCAqZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgaHdhZGRyIGFkZHIsCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgcmVzb2x2ZV9zdWJwYWdl
KQogewotICAgIE1lbW9yeVJlZ2lvblNlY3Rpb24gKnNlY3Rpb24gPSBhdG9taWNfcmVhZCgmZC0+
bXJ1X3NlY3Rpb24pOworICAgIE1lbW9yeVJlZ2lvblNlY3Rpb24gKnNlY3Rpb24gPSBxYXRvbWlj
X3JlYWQoJmQtPm1ydV9zZWN0aW9uKTsKICAgICBzdWJwYWdlX3QgKnN1YnBhZ2U7CiAKICAgICBp
ZiAoIXNlY3Rpb24gfHwgc2VjdGlvbiA9PSAmZC0+bWFwLnNlY3Rpb25zW1BIWVNfU0VDVElPTl9V
TkFTU0lHTkVEXSB8fAogICAgICAgICAhc2VjdGlvbl9jb3ZlcnNfYWRkcihzZWN0aW9uLCBhZGRy
KSkgewogICAgICAgICBzZWN0aW9uID0gcGh5c19wYWdlX2ZpbmQoZCwgYWRkcik7Ci0gICAgICAg
IGF0b21pY19zZXQoJmQtPm1ydV9zZWN0aW9uLCBzZWN0aW9uKTsKKyAgICAgICAgcWF0b21pY19z
ZXQoJmQtPm1ydV9zZWN0aW9uLCBzZWN0aW9uKTsKICAgICB9CiAgICAgaWYgKHJlc29sdmVfc3Vi
cGFnZSAmJiBzZWN0aW9uLT5tci0+c3VicGFnZSkgewogICAgICAgICBzdWJwYWdlID0gY29udGFp
bmVyX29mKHNlY3Rpb24tPm1yLCBzdWJwYWdlX3QsIGlvbWVtKTsKQEAgLTY5NSw3ICs2OTUsOCBA
QCBhZGRyZXNzX3NwYWNlX3RyYW5zbGF0ZV9mb3JfaW90bGIoQ1BVU3RhdGUgKmNwdSwgaW50IGFz
aWR4LCBod2FkZHIgYWRkciwKICAgICBJT01NVU1lbW9yeVJlZ2lvbkNsYXNzICppbXJjOwogICAg
IElPTU1VVExCRW50cnkgaW90bGI7CiAgICAgaW50IGlvbW11X2lkeDsKLSAgICBBZGRyZXNzU3Bh
Y2VEaXNwYXRjaCAqZCA9IGF0b21pY19yY3VfcmVhZCgmY3B1LT5jcHVfYXNlc1thc2lkeF0ubWVt
b3J5X2Rpc3BhdGNoKTsKKyAgICBBZGRyZXNzU3BhY2VEaXNwYXRjaCAqZCA9CisgICAgICAgIHFh
dG9taWNfcmN1X3JlYWQoJmNwdS0+Y3B1X2FzZXNbYXNpZHhdLm1lbW9yeV9kaXNwYXRjaCk7CiAK
ICAgICBmb3IgKDs7KSB7CiAgICAgICAgIHNlY3Rpb24gPSBhZGRyZXNzX3NwYWNlX3RyYW5zbGF0
ZV9pbnRlcm5hbChkLCBhZGRyLCAmYWRkciwgcGxlbiwgZmFsc2UpOwpAQCAtMTI0Nyw3ICsxMjQ4
LDcgQEAgc3RhdGljIFJBTUJsb2NrICpxZW11X2dldF9yYW1fYmxvY2socmFtX2FkZHJfdCBhZGRy
KQogewogICAgIFJBTUJsb2NrICpibG9jazsKIAotICAgIGJsb2NrID0gYXRvbWljX3JjdV9yZWFk
KCZyYW1fbGlzdC5tcnVfYmxvY2spOworICAgIGJsb2NrID0gcWF0b21pY19yY3VfcmVhZCgmcmFt
X2xpc3QubXJ1X2Jsb2NrKTsKICAgICBpZiAoYmxvY2sgJiYgYWRkciAtIGJsb2NrLT5vZmZzZXQg
PCBibG9jay0+bWF4X2xlbmd0aCkgewogICAgICAgICByZXR1cm4gYmxvY2s7CiAgICAgfQpAQCAt
MTI3Myw3ICsxMjc0LDcgQEAgZm91bmQ6CiAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgY2FsbF9yY3UocmVjbGFpbV9yYW1ibG9jaywgeHh4KTsKICAgICAgKiAg
ICAgICAgICAgICAgICAgIHJjdV9yZWFkX3VubG9jaygpCiAgICAgICoKLSAgICAgKiBhdG9taWNf
cmN1X3NldCBpcyBub3QgbmVlZGVkIGhlcmUuICBUaGUgYmxvY2sgd2FzIGFscmVhZHkgcHVibGlz
aGVkCisgICAgICogcWF0b21pY19yY3Vfc2V0IGlzIG5vdCBuZWVkZWQgaGVyZS4gIFRoZSBibG9j
ayB3YXMgYWxyZWFkeSBwdWJsaXNoZWQKICAgICAgKiB3aGVuIGl0IHdhcyBwbGFjZWQgaW50byB0
aGUgbGlzdC4gIEhlcmUgd2UncmUganVzdCBtYWtpbmcgYW4gZXh0cmEKICAgICAgKiBjb3B5IG9m
IHRoZSBwb2ludGVyLgogICAgICAqLwpAQCAtMTMyMSw3ICsxMzIyLDcgQEAgYm9vbCBjcHVfcGh5
c2ljYWxfbWVtb3J5X3Rlc3RfYW5kX2NsZWFyX2RpcnR5KHJhbV9hZGRyX3Qgc3RhcnQsCiAgICAg
cGFnZSA9IHN0YXJ0X3BhZ2U7CiAKICAgICBXSVRIX1JDVV9SRUFEX0xPQ0tfR1VBUkQoKSB7Ci0g
ICAgICAgIGJsb2NrcyA9IGF0b21pY19yY3VfcmVhZCgmcmFtX2xpc3QuZGlydHlfbWVtb3J5W2Ns
aWVudF0pOworICAgICAgICBibG9ja3MgPSBxYXRvbWljX3JjdV9yZWFkKCZyYW1fbGlzdC5kaXJ0
eV9tZW1vcnlbY2xpZW50XSk7CiAgICAgICAgIHJhbWJsb2NrID0gcWVtdV9nZXRfcmFtX2Jsb2Nr
KHN0YXJ0KTsKICAgICAgICAgLyogUmFuZ2Ugc2FuaXR5IGNoZWNrIG9uIHRoZSByYW1ibG9jayAq
LwogICAgICAgICBhc3NlcnQoc3RhcnQgPj0gcmFtYmxvY2stPm9mZnNldCAmJgpAQCAtMTM3MSw3
ICsxMzcyLDcgQEAgRGlydHlCaXRtYXBTbmFwc2hvdCAqY3B1X3BoeXNpY2FsX21lbW9yeV9zbmFw
c2hvdF9hbmRfY2xlYXJfZGlydHkKICAgICBkZXN0ID0gMDsKIAogICAgIFdJVEhfUkNVX1JFQURf
TE9DS19HVUFSRCgpIHsKLSAgICAgICAgYmxvY2tzID0gYXRvbWljX3JjdV9yZWFkKCZyYW1fbGlz
dC5kaXJ0eV9tZW1vcnlbY2xpZW50XSk7CisgICAgICAgIGJsb2NrcyA9IHFhdG9taWNfcmN1X3Jl
YWQoJnJhbV9saXN0LmRpcnR5X21lbW9yeVtjbGllbnRdKTsKIAogICAgICAgICB3aGlsZSAocGFn
ZSA8IGVuZCkgewogICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBpZHggPSBwYWdlIC8gRElSVFlf
TUVNT1JZX0JMT0NLX1NJWkU7CkBAIC0yMjA3LDcgKzIyMDgsNyBAQCBzdGF0aWMgdm9pZCBkaXJ0
eV9tZW1vcnlfZXh0ZW5kKHJhbV9hZGRyX3Qgb2xkX3JhbV9zaXplLAogICAgICAgICBEaXJ0eU1l
bW9yeUJsb2NrcyAqbmV3X2Jsb2NrczsKICAgICAgICAgaW50IGo7CiAKLSAgICAgICAgb2xkX2Js
b2NrcyA9IGF0b21pY19yY3VfcmVhZCgmcmFtX2xpc3QuZGlydHlfbWVtb3J5W2ldKTsKKyAgICAg
ICAgb2xkX2Jsb2NrcyA9IHFhdG9taWNfcmN1X3JlYWQoJnJhbV9saXN0LmRpcnR5X21lbW9yeVtp
XSk7CiAgICAgICAgIG5ld19ibG9ja3MgPSBnX21hbGxvYyhzaXplb2YoKm5ld19ibG9ja3MpICsK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVvZihuZXdfYmxvY2tzLT5ibG9ja3Nb
MF0pICogbmV3X251bV9ibG9ja3MpOwogCkBAIC0yMjIwLDcgKzIyMjEsNyBAQCBzdGF0aWMgdm9p
ZCBkaXJ0eV9tZW1vcnlfZXh0ZW5kKHJhbV9hZGRyX3Qgb2xkX3JhbV9zaXplLAogICAgICAgICAg
ICAgbmV3X2Jsb2Nrcy0+YmxvY2tzW2pdID0gYml0bWFwX25ldyhESVJUWV9NRU1PUllfQkxPQ0tf
U0laRSk7CiAgICAgICAgIH0KIAotICAgICAgICBhdG9taWNfcmN1X3NldCgmcmFtX2xpc3QuZGly
dHlfbWVtb3J5W2ldLCBuZXdfYmxvY2tzKTsKKyAgICAgICAgcWF0b21pY19yY3Vfc2V0KCZyYW1f
bGlzdC5kaXJ0eV9tZW1vcnlbaV0sIG5ld19ibG9ja3MpOwogCiAgICAgICAgIGlmIChvbGRfYmxv
Y2tzKSB7CiAgICAgICAgICAgICBnX2ZyZWVfcmN1KG9sZF9ibG9ja3MsIHJjdSk7CkBAIC0yNjY3
LDcgKzI2NjgsNyBAQCBSQU1CbG9jayAqcWVtdV9yYW1fYmxvY2tfZnJvbV9ob3N0KHZvaWQgKnB0
ciwgYm9vbCByb3VuZF9vZmZzZXQsCiAgICAgfQogCiAgICAgUkNVX1JFQURfTE9DS19HVUFSRCgp
OwotICAgIGJsb2NrID0gYXRvbWljX3JjdV9yZWFkKCZyYW1fbGlzdC5tcnVfYmxvY2spOworICAg
IGJsb2NrID0gcWF0b21pY19yY3VfcmVhZCgmcmFtX2xpc3QubXJ1X2Jsb2NrKTsKICAgICBpZiAo
YmxvY2sgJiYgYmxvY2stPmhvc3QgJiYgaG9zdCAtIGJsb2NrLT5ob3N0IDwgYmxvY2stPm1heF9s
ZW5ndGgpIHsKICAgICAgICAgZ290byBmb3VuZDsKICAgICB9CkBAIC0yOTEyLDcgKzI5MTMsNyBA
QCBNZW1vcnlSZWdpb25TZWN0aW9uICppb3RsYl90b19zZWN0aW9uKENQVVN0YXRlICpjcHUsCiB7
CiAgICAgaW50IGFzaWR4ID0gY3B1X2FzaWR4X2Zyb21fYXR0cnMoY3B1LCBhdHRycyk7CiAgICAg
Q1BVQWRkcmVzc1NwYWNlICpjcHVhcyA9ICZjcHUtPmNwdV9hc2VzW2FzaWR4XTsKLSAgICBBZGRy
ZXNzU3BhY2VEaXNwYXRjaCAqZCA9IGF0b21pY19yY3VfcmVhZCgmY3B1YXMtPm1lbW9yeV9kaXNw
YXRjaCk7CisgICAgQWRkcmVzc1NwYWNlRGlzcGF0Y2ggKmQgPSBxYXRvbWljX3JjdV9yZWFkKCZj
cHVhcy0+bWVtb3J5X2Rpc3BhdGNoKTsKICAgICBNZW1vcnlSZWdpb25TZWN0aW9uICpzZWN0aW9u
cyA9IGQtPm1hcC5zZWN0aW9uczsKIAogICAgIHJldHVybiAmc2VjdGlvbnNbaW5kZXggJiB+VEFS
R0VUX1BBR0VfTUFTS107CkBAIC0yOTk2LDcgKzI5OTcsNyBAQCBzdGF0aWMgdm9pZCB0Y2dfY29t
bWl0KE1lbW9yeUxpc3RlbmVyICpsaXN0ZW5lcikKICAgICAgKiBtYXkgaGF2ZSBzcGxpdCB0aGUg
UkNVIGNyaXRpY2FsIHNlY3Rpb24uCiAgICAgICovCiAgICAgZCA9IGFkZHJlc3Nfc3BhY2VfdG9f
ZGlzcGF0Y2goY3B1YXMtPmFzKTsKLSAgICBhdG9taWNfcmN1X3NldCgmY3B1YXMtPm1lbW9yeV9k
aXNwYXRjaCwgZCk7CisgICAgcWF0b21pY19yY3Vfc2V0KCZjcHVhcy0+bWVtb3J5X2Rpc3BhdGNo
LCBkKTsKICAgICB0bGJfZmx1c2goY3B1YXMtPmNwdSk7CiB9CiAKQEAgLTM0NDMsNyArMzQ0NCw3
IEBAIHZvaWQgY3B1X3JlZ2lzdGVyX21hcF9jbGllbnQoUUVNVUJIICpiaCkKICAgICBxZW11X211
dGV4X2xvY2soJm1hcF9jbGllbnRfbGlzdF9sb2NrKTsKICAgICBjbGllbnQtPmJoID0gYmg7CiAg
ICAgUUxJU1RfSU5TRVJUX0hFQUQoJm1hcF9jbGllbnRfbGlzdCwgY2xpZW50LCBsaW5rKTsKLSAg
ICBpZiAoIWF0b21pY19yZWFkKCZib3VuY2UuaW5fdXNlKSkgeworICAgIGlmICghcWF0b21pY19y
ZWFkKCZib3VuY2UuaW5fdXNlKSkgewogICAgICAgICBjcHVfbm90aWZ5X21hcF9jbGllbnRzX2xv
Y2tlZCgpOwogICAgIH0KICAgICBxZW11X211dGV4X3VubG9jaygmbWFwX2NsaWVudF9saXN0X2xv
Y2spOwpAQCAtMzU3Nyw3ICszNTc4LDcgQEAgdm9pZCAqYWRkcmVzc19zcGFjZV9tYXAoQWRkcmVz
c1NwYWNlICphcywKICAgICBtciA9IGZsYXR2aWV3X3RyYW5zbGF0ZShmdiwgYWRkciwgJnhsYXQs
ICZsLCBpc193cml0ZSwgYXR0cnMpOwogCiAgICAgaWYgKCFtZW1vcnlfYWNjZXNzX2lzX2RpcmVj
dChtciwgaXNfd3JpdGUpKSB7Ci0gICAgICAgIGlmIChhdG9taWNfeGNoZygmYm91bmNlLmluX3Vz
ZSwgdHJ1ZSkpIHsKKyAgICAgICAgaWYgKHFhdG9taWNfeGNoZygmYm91bmNlLmluX3VzZSwgdHJ1
ZSkpIHsKICAgICAgICAgICAgICpwbGVuID0gMDsKICAgICAgICAgICAgIHJldHVybiBOVUxMOwog
ICAgICAgICB9CkBAIC0zNjM2LDcgKzM2MzcsNyBAQCB2b2lkIGFkZHJlc3Nfc3BhY2VfdW5tYXAo
QWRkcmVzc1NwYWNlICphcywgdm9pZCAqYnVmZmVyLCBod2FkZHIgbGVuLAogICAgIHFlbXVfdmZy
ZWUoYm91bmNlLmJ1ZmZlcik7CiAgICAgYm91bmNlLmJ1ZmZlciA9IE5VTEw7CiAgICAgbWVtb3J5
X3JlZ2lvbl91bnJlZihib3VuY2UubXIpOwotICAgIGF0b21pY19tYl9zZXQoJmJvdW5jZS5pbl91
c2UsIGZhbHNlKTsKKyAgICBxYXRvbWljX21iX3NldCgmYm91bmNlLmluX3VzZSwgZmFsc2UpOwog
ICAgIGNwdV9ub3RpZnlfbWFwX2NsaWVudHMoKTsKIH0KIApAQCAtNDEwNSwxNiArNDEwNiwxNyBA
QCBpbnQgcmFtX2Jsb2NrX2Rpc2NhcmRfZGlzYWJsZShib29sIHN0YXRlKQogICAgIGludCBvbGQ7
CiAKICAgICBpZiAoIXN0YXRlKSB7Ci0gICAgICAgIGF0b21pY19kZWMoJnJhbV9ibG9ja19kaXNj
YXJkX2Rpc2FibGVkKTsKKyAgICAgICAgcWF0b21pY19kZWMoJnJhbV9ibG9ja19kaXNjYXJkX2Rp
c2FibGVkKTsKICAgICAgICAgcmV0dXJuIDA7CiAgICAgfQogCiAgICAgZG8gewotICAgICAgICBv
bGQgPSBhdG9taWNfcmVhZCgmcmFtX2Jsb2NrX2Rpc2NhcmRfZGlzYWJsZWQpOworICAgICAgICBv
bGQgPSBxYXRvbWljX3JlYWQoJnJhbV9ibG9ja19kaXNjYXJkX2Rpc2FibGVkKTsKICAgICAgICAg
aWYgKG9sZCA8IDApIHsKICAgICAgICAgICAgIHJldHVybiAtRUJVU1k7CiAgICAgICAgIH0KLSAg
ICB9IHdoaWxlIChhdG9taWNfY21weGNoZygmcmFtX2Jsb2NrX2Rpc2NhcmRfZGlzYWJsZWQsIG9s
ZCwgb2xkICsgMSkgIT0gb2xkKTsKKyAgICB9IHdoaWxlIChxYXRvbWljX2NtcHhjaGcoJnJhbV9i
bG9ja19kaXNjYXJkX2Rpc2FibGVkLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGQs
IG9sZCArIDEpICE9IG9sZCk7CiAgICAgcmV0dXJuIDA7CiB9CiAKQEAgLTQxMjMsMjcgKzQxMjUs
MjggQEAgaW50IHJhbV9ibG9ja19kaXNjYXJkX3JlcXVpcmUoYm9vbCBzdGF0ZSkKICAgICBpbnQg
b2xkOwogCiAgICAgaWYgKCFzdGF0ZSkgewotICAgICAgICBhdG9taWNfaW5jKCZyYW1fYmxvY2tf
ZGlzY2FyZF9kaXNhYmxlZCk7CisgICAgICAgIHFhdG9taWNfaW5jKCZyYW1fYmxvY2tfZGlzY2Fy
ZF9kaXNhYmxlZCk7CiAgICAgICAgIHJldHVybiAwOwogICAgIH0KIAogICAgIGRvIHsKLSAgICAg
ICAgb2xkID0gYXRvbWljX3JlYWQoJnJhbV9ibG9ja19kaXNjYXJkX2Rpc2FibGVkKTsKKyAgICAg
ICAgb2xkID0gcWF0b21pY19yZWFkKCZyYW1fYmxvY2tfZGlzY2FyZF9kaXNhYmxlZCk7CiAgICAg
ICAgIGlmIChvbGQgPiAwKSB7CiAgICAgICAgICAgICByZXR1cm4gLUVCVVNZOwogICAgICAgICB9
Ci0gICAgfSB3aGlsZSAoYXRvbWljX2NtcHhjaGcoJnJhbV9ibG9ja19kaXNjYXJkX2Rpc2FibGVk
LCBvbGQsIG9sZCAtIDEpICE9IG9sZCk7CisgICAgfSB3aGlsZSAocWF0b21pY19jbXB4Y2hnKCZy
YW1fYmxvY2tfZGlzY2FyZF9kaXNhYmxlZCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
b2xkLCBvbGQgLSAxKSAhPSBvbGQpOwogICAgIHJldHVybiAwOwogfQogCiBib29sIHJhbV9ibG9j
a19kaXNjYXJkX2lzX2Rpc2FibGVkKHZvaWQpCiB7Ci0gICAgcmV0dXJuIGF0b21pY19yZWFkKCZy
YW1fYmxvY2tfZGlzY2FyZF9kaXNhYmxlZCkgPiAwOworICAgIHJldHVybiBxYXRvbWljX3JlYWQo
JnJhbV9ibG9ja19kaXNjYXJkX2Rpc2FibGVkKSA+IDA7CiB9CiAKIGJvb2wgcmFtX2Jsb2NrX2Rp
c2NhcmRfaXNfcmVxdWlyZWQodm9pZCkKIHsKLSAgICByZXR1cm4gYXRvbWljX3JlYWQoJnJhbV9i
bG9ja19kaXNjYXJkX2Rpc2FibGVkKSA8IDA7CisgICAgcmV0dXJuIHFhdG9taWNfcmVhZCgmcmFt
X2Jsb2NrX2Rpc2NhcmRfZGlzYWJsZWQpIDwgMDsKIH0KIAogI2VuZGlmCmRpZmYgLS1naXQgYS9o
dy9jb3JlL2NwdS5jIGIvaHcvY29yZS9jcHUuYwppbmRleCA4ZjY1MzgzZmZiLi5jNTVjMDlmNzM0
IDEwMDY0NAotLS0gYS9ody9jb3JlL2NwdS5jCisrKyBiL2h3L2NvcmUvY3B1LmMKQEAgLTExMSwx
MCArMTExLDEwIEBAIHZvaWQgY3B1X3Jlc2V0X2ludGVycnVwdChDUFVTdGF0ZSAqY3B1LCBpbnQg
bWFzaykKIAogdm9pZCBjcHVfZXhpdChDUFVTdGF0ZSAqY3B1KQogewotICAgIGF0b21pY19zZXQo
JmNwdS0+ZXhpdF9yZXF1ZXN0LCAxKTsKKyAgICBxYXRvbWljX3NldCgmY3B1LT5leGl0X3JlcXVl
c3QsIDEpOwogICAgIC8qIEVuc3VyZSBjcHVfZXhlYyB3aWxsIHNlZSB0aGUgZXhpdCByZXF1ZXN0
IGFmdGVyIFRDRyBoYXMgZXhpdGVkLiAgKi8KICAgICBzbXBfd21iKCk7Ci0gICAgYXRvbWljX3Nl
dCgmY3B1LT5pY291bnRfZGVjcl9wdHItPnUxNi5oaWdoLCAtMSk7CisgICAgcWF0b21pY19zZXQo
JmNwdS0+aWNvdW50X2RlY3JfcHRyLT51MTYuaGlnaCwgLTEpOwogfQogCiBpbnQgY3B1X3dyaXRl
X2VsZjMyX3FlbXVub3RlKFdyaXRlQ29yZUR1bXBGdW5jdGlvbiBmLCBDUFVTdGF0ZSAqY3B1LApA
QCAtMjYxLDcgKzI2MSw3IEBAIHN0YXRpYyB2b2lkIGNwdV9jb21tb25fcmVzZXQoRGV2aWNlU3Rh
dGUgKmRldikKICAgICBjcHUtPmhhbHRlZCA9IGNwdS0+c3RhcnRfcG93ZXJlZF9vZmY7CiAgICAg
Y3B1LT5tZW1faW9fcGMgPSAwOwogICAgIGNwdS0+aWNvdW50X2V4dHJhID0gMDsKLSAgICBhdG9t
aWNfc2V0KCZjcHUtPmljb3VudF9kZWNyX3B0ci0+dTMyLCAwKTsKKyAgICBxYXRvbWljX3NldCgm
Y3B1LT5pY291bnRfZGVjcl9wdHItPnUzMiwgMCk7CiAgICAgY3B1LT5jYW5fZG9faW8gPSAxOwog
ICAgIGNwdS0+ZXhjZXB0aW9uX2luZGV4ID0gLTE7CiAgICAgY3B1LT5jcmFzaF9vY2N1cnJlZCA9
IGZhbHNlOwpkaWZmIC0tZ2l0IGEvaHcvZGlzcGxheS9xeGwuYyBiL2h3L2Rpc3BsYXkvcXhsLmMK
aW5kZXggMTE4NzEzNDBlNy4uNDMxYzEwNzA5NiAxMDA2NDQKLS0tIGEvaHcvZGlzcGxheS9xeGwu
YworKysgYi9ody9kaXNwbGF5L3F4bC5jCkBAIC0xOTA4LDcgKzE5MDgsNyBAQCBzdGF0aWMgdm9p
ZCBxeGxfc2VuZF9ldmVudHMoUENJUVhMRGV2aWNlICpkLCB1aW50MzJfdCBldmVudHMpCiAgICAg
LyoKICAgICAgKiBPbGRlciB2ZXJzaW9ucyBvZiBTcGljZSBmb3Jnb3QgdG8gZGVmaW5lIHRoZSBR
WExSYW0gc3RydWN0CiAgICAgICogd2l0aCB0aGUgJ19fYWxpZ25lZF9fKDQpJyBhdHRyaWJ1dGUu
IGNsYW5nIDcgYW5kIG5ld2VyIHdpbGwKLSAgICAgKiB0aHVzIHdhcm4gdGhhdCBhdG9taWNfZmV0
Y2hfb3IoJmQtPnJhbS0+aW50X3BlbmRpbmcsIC4uLikKKyAgICAgKiB0aHVzIHdhcm4gdGhhdCBx
YXRvbWljX2ZldGNoX29yKCZkLT5yYW0tPmludF9wZW5kaW5nLCAuLi4pCiAgICAgICogbWlnaHQg
YmUgYSBtaXNhbGlnbmVkIGF0b21pYyBhY2Nlc3MsIGFuZCB3aWxsIGdlbmVyYXRlIGFuCiAgICAg
ICogb3V0LW9mLWxpbmUgY2FsbCBmb3IgaXQsIHdoaWNoIHJlc3VsdHMgaW4gYSBsaW5rIGVycm9y
IHNpbmNlCiAgICAgICogd2UgZG9uJ3QgY3VycmVudGx5IGxpbmsgYWdhaW5zdCBsaWJhdG9taWMu
CkBAIC0xOTI4LDcgKzE5MjgsNyBAQCBzdGF0aWMgdm9pZCBxeGxfc2VuZF9ldmVudHMoUENJUVhM
RGV2aWNlICpkLCB1aW50MzJfdCBldmVudHMpCiAjZGVmaW5lIEFMSUdORURfVUlOVDMyX1BUUihQ
KSAoKHVpbnQzMl90ICopUCkKICNlbmRpZgogCi0gICAgb2xkX3BlbmRpbmcgPSBhdG9taWNfZmV0
Y2hfb3IoQUxJR05FRF9VSU5UMzJfUFRSKCZkLT5yYW0tPmludF9wZW5kaW5nKSwKKyAgICBvbGRf
cGVuZGluZyA9IHFhdG9taWNfZmV0Y2hfb3IoQUxJR05FRF9VSU5UMzJfUFRSKCZkLT5yYW0tPmlu
dF9wZW5kaW5nKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZV9ldmVudHMp
OwogICAgIGlmICgob2xkX3BlbmRpbmcgJiBsZV9ldmVudHMpID09IGxlX2V2ZW50cykgewogICAg
ICAgICByZXR1cm47CmRpZmYgLS1naXQgYS9ody9oeXBlcnYvaHlwZXJ2LmMgYi9ody9oeXBlcnYv
aHlwZXJ2LmMKaW5kZXggNGIyNmRiMTM2NS4uY2IxMDc0ZjIzNCAxMDA2NDQKLS0tIGEvaHcvaHlw
ZXJ2L2h5cGVydi5jCisrKyBiL2h3L2h5cGVydi9oeXBlcnYuYwpAQCAtMjMxLDcgKzIzMSw3IEBA
IHN0YXRpYyB2b2lkIHNpbnRfbXNnX2JoKHZvaWQgKm9wYXF1ZSkKICAgICBIdlNpbnRSb3V0ZSAq
c2ludF9yb3V0ZSA9IG9wYXF1ZTsKICAgICBIdlNpbnRTdGFnZWRNZXNzYWdlICpzdGFnZWRfbXNn
ID0gc2ludF9yb3V0ZS0+c3RhZ2VkX21zZzsKIAotICAgIGlmIChhdG9taWNfcmVhZCgmc3RhZ2Vk
X21zZy0+c3RhdGUpICE9IEhWX1NUQUdFRF9NU0dfUE9TVEVEKSB7CisgICAgaWYgKHFhdG9taWNf
cmVhZCgmc3RhZ2VkX21zZy0+c3RhdGUpICE9IEhWX1NUQUdFRF9NU0dfUE9TVEVEKSB7CiAgICAg
ICAgIC8qIHN0YXR1cyBub3IgcmVhZHkgeWV0IChzcHVyaW91cyBhY2sgZnJvbSBndWVzdD8pLCBp
Z25vcmUgKi8KICAgICAgICAgcmV0dXJuOwogICAgIH0KQEAgLTI0MCw3ICsyNDAsNyBAQCBzdGF0
aWMgdm9pZCBzaW50X21zZ19iaCh2b2lkICpvcGFxdWUpCiAgICAgc3RhZ2VkX21zZy0+c3RhdHVz
ID0gMDsKIAogICAgIC8qIHN0YWdlZCBtZXNzYWdlIHByb2Nlc3NpbmcgZmluaXNoZWQsIHJlYWR5
IHRvIHN0YXJ0IG92ZXIgKi8KLSAgICBhdG9taWNfc2V0KCZzdGFnZWRfbXNnLT5zdGF0ZSwgSFZf
U1RBR0VEX01TR19GUkVFKTsKKyAgICBxYXRvbWljX3NldCgmc3RhZ2VkX21zZy0+c3RhdGUsIEhW
X1NUQUdFRF9NU0dfRlJFRSk7CiAgICAgLyogZHJvcCB0aGUgcmVmZXJlbmNlIHRha2VuIGluIGh5
cGVydl9wb3N0X21zZyAqLwogICAgIGh5cGVydl9zaW50X3JvdXRlX3VucmVmKHNpbnRfcm91dGUp
OwogfQpAQCAtMjc4LDcgKzI3OCw3IEBAIHN0YXRpYyB2b2lkIGNwdV9wb3N0X21zZyhDUFVTdGF0
ZSAqY3MsIHJ1bl9vbl9jcHVfZGF0YSBkYXRhKQogICAgIG1lbW9yeV9yZWdpb25fc2V0X2RpcnR5
KCZzeW5pYy0+bXNnX3BhZ2VfbXIsIDAsIHNpemVvZigqc3luaWMtPm1zZ19wYWdlKSk7CiAKIHBv
c3RlZDoKLSAgICBhdG9taWNfc2V0KCZzdGFnZWRfbXNnLT5zdGF0ZSwgSFZfU1RBR0VEX01TR19Q
T1NURUQpOworICAgIHFhdG9taWNfc2V0KCZzdGFnZWRfbXNnLT5zdGF0ZSwgSFZfU1RBR0VEX01T
R19QT1NURUQpOwogICAgIC8qCiAgICAgICogTm90aWZ5IHRoZSBtc2cgb3JpZ2luYXRvciBvZiB0
aGUgcHJvZ3Jlc3MgbWFkZTsgaWYgdGhlIHNsb3Qgd2FzIGJ1c3kgd2UKICAgICAgKiBzZXQgbXNn
X3BlbmRpbmcgZmxhZyBpbiBpdCBzbyBpdCB3aWxsIGJlIHRoZSBndWVzdCB3aG8gd2lsbCBkbyBF
T00gYW5kCkBAIC0zMDEsNyArMzAxLDcgQEAgaW50IGh5cGVydl9wb3N0X21zZyhIdlNpbnRSb3V0
ZSAqc2ludF9yb3V0ZSwgc3RydWN0IGh5cGVydl9tZXNzYWdlICpzcmNfbXNnKQogICAgIGFzc2Vy
dChzdGFnZWRfbXNnKTsKIAogICAgIC8qIGdyYWIgdGhlIHN0YWdpbmcgYXJlYSAqLwotICAgIGlm
IChhdG9taWNfY21weGNoZygmc3RhZ2VkX21zZy0+c3RhdGUsIEhWX1NUQUdFRF9NU0dfRlJFRSwK
KyAgICBpZiAocWF0b21pY19jbXB4Y2hnKCZzdGFnZWRfbXNnLT5zdGF0ZSwgSFZfU1RBR0VEX01T
R19GUkVFLAogICAgICAgICAgICAgICAgICAgICAgICBIVl9TVEFHRURfTVNHX0JVU1kpICE9IEhW
X1NUQUdFRF9NU0dfRlJFRSkgewogICAgICAgICByZXR1cm4gLUVBR0FJTjsKICAgICB9CkBAIC0z
NTEsNyArMzUxLDcgQEAgaW50IGh5cGVydl9zZXRfZXZlbnRfZmxhZyhIdlNpbnRSb3V0ZSAqc2lu
dF9yb3V0ZSwgdW5zaWduZWQgZXZlbnRubykKICAgICBzZXRfbWFzayA9IEJJVF9NQVNLKGV2ZW50
bm8pOwogICAgIGZsYWdzID0gc3luaWMtPmV2ZW50X3BhZ2UtPnNsb3Rbc2ludF9yb3V0ZS0+c2lu
dF0uZmxhZ3M7CiAKLSAgICBpZiAoKGF0b21pY19mZXRjaF9vcigmZmxhZ3Nbc2V0X2lkeF0sIHNl
dF9tYXNrKSAmIHNldF9tYXNrKSAhPSBzZXRfbWFzaykgeworICAgIGlmICgocWF0b21pY19mZXRj
aF9vcigmZmxhZ3Nbc2V0X2lkeF0sIHNldF9tYXNrKSAmIHNldF9tYXNrKSAhPSBzZXRfbWFzaykg
ewogICAgICAgICBtZW1vcnlfcmVnaW9uX3NldF9kaXJ0eSgmc3luaWMtPmV2ZW50X3BhZ2VfbXIs
IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVvZigqc3luaWMtPmV2ZW50
X3BhZ2UpKTsKICAgICAgICAgcmV0ID0gaHlwZXJ2X3NpbnRfcm91dGVfc2V0X3NpbnQoc2ludF9y
b3V0ZSk7CmRpZmYgLS1naXQgYS9ody9oeXBlcnYvdm1idXMuYyBiL2h3L2h5cGVydi92bWJ1cy5j
CmluZGV4IDZlZjg5NWJjMzUuLjg5NmU5ODFmODUgMTAwNjQ0Ci0tLSBhL2h3L2h5cGVydi92bWJ1
cy5jCisrKyBiL2h3L2h5cGVydi92bWJ1cy5jCkBAIC03NDcsNyArNzQ3LDcgQEAgc3RhdGljIGlu
dCB2bWJ1c19jaGFubmVsX25vdGlmeV9ndWVzdChWTUJ1c0NoYW5uZWwgKmNoYW4pCiAKICAgICBp
ZHggPSBCSVRfV09SRChjaGFuLT5pZCk7CiAgICAgbWFzayA9IEJJVF9NQVNLKGNoYW4tPmlkKTsK
LSAgICBpZiAoKGF0b21pY19mZXRjaF9vcigmaW50X21hcFtpZHhdLCBtYXNrKSAmIG1hc2spICE9
IG1hc2spIHsKKyAgICBpZiAoKHFhdG9taWNfZmV0Y2hfb3IoJmludF9tYXBbaWR4XSwgbWFzaykg
JiBtYXNrKSAhPSBtYXNrKSB7CiAgICAgICAgIHJlcyA9IGh5cGVydl9zaW50X3JvdXRlX3NldF9z
aW50KGNoYW4tPm5vdGlmeV9yb3V0ZSk7CiAgICAgICAgIGRpcnR5ID0gbGVuOwogICAgIH0KZGlm
ZiAtLWdpdCBhL2h3L2kzODYveGVuL3hlbi1odm0uYyBiL2h3L2kzODYveGVuL3hlbi1odm0uYwpp
bmRleCBjZGU5ODFiYWQ2Li5hMzlhNjQ4Y2E2IDEwMDY0NAotLS0gYS9ody9pMzg2L3hlbi94ZW4t
aHZtLmMKKysrIGIvaHcvaTM4Ni94ZW4veGVuLWh2bS5jCkBAIC0xMTQwLDcgKzExNDAsNyBAQCBz
dGF0aWMgaW50IGhhbmRsZV9idWZmZXJlZF9pb3BhZ2UoWGVuSU9TdGF0ZSAqc3RhdGUpCiAgICAg
ICAgIGFzc2VydChyZXEuZGlyID09IElPUkVRX1dSSVRFKTsKICAgICAgICAgYXNzZXJ0KCFyZXEu
ZGF0YV9pc19wdHIpOwogCi0gICAgICAgIGF0b21pY19hZGQoJmJ1Zl9wYWdlLT5yZWFkX3BvaW50
ZXIsIHF3ICsgMSk7CisgICAgICAgIHFhdG9taWNfYWRkKCZidWZfcGFnZS0+cmVhZF9wb2ludGVy
LCBxdyArIDEpOwogICAgIH0KIAogICAgIHJldHVybiByZXEuY291bnQ7CmRpZmYgLS1naXQgYS9o
dy9pbnRjL3J4X2ljdS5jIGIvaHcvaW50Yy9yeF9pY3UuYwppbmRleCBkZjRiNmE4ZDIyLi45NGUx
N2E5ZGVhIDEwMDY0NAotLS0gYS9ody9pbnRjL3J4X2ljdS5jCisrKyBiL2h3L2ludGMvcnhfaWN1
LmMKQEAgLTgxLDggKzgxLDggQEAgc3RhdGljIHZvaWQgcnhpY3VfcmVxdWVzdChSWElDVVN0YXRl
ICppY3UsIGludCBuX0lSUSkKICAgICBpbnQgZW5hYmxlOwogCiAgICAgZW5hYmxlID0gaWN1LT5p
ZXJbbl9JUlEgLyA4XSAmICgxIDw8IChuX0lSUSAmIDcpKTsKLSAgICBpZiAobl9JUlEgPiAwICYm
IGVuYWJsZSAhPSAwICYmIGF0b21pY19yZWFkKCZpY3UtPnJlcV9pcnEpIDwgMCkgewotICAgICAg
ICBhdG9taWNfc2V0KCZpY3UtPnJlcV9pcnEsIG5fSVJRKTsKKyAgICBpZiAobl9JUlEgPiAwICYm
IGVuYWJsZSAhPSAwICYmIHFhdG9taWNfcmVhZCgmaWN1LT5yZXFfaXJxKSA8IDApIHsKKyAgICAg
ICAgcWF0b21pY19zZXQoJmljdS0+cmVxX2lycSwgbl9JUlEpOwogICAgICAgICBzZXRfaXJxKGlj
dSwgbl9JUlEsIHJ4aWN1X2xldmVsKGljdSwgbl9JUlEpKTsKICAgICB9CiB9CkBAIC0xMjQsMTAg
KzEyNCwxMCBAQCBzdGF0aWMgdm9pZCByeGljdV9zZXRfaXJxKHZvaWQgKm9wYXF1ZSwgaW50IG5f
SVJRLCBpbnQgbGV2ZWwpCiAgICAgfQogICAgIGlmIChpc3N1ZSA9PSAwICYmIHNyYy0+c2Vuc2Ug
PT0gVFJHX0xFVkVMKSB7CiAgICAgICAgIGljdS0+aXJbbl9JUlFdID0gMDsKLSAgICAgICAgaWYg
KGF0b21pY19yZWFkKCZpY3UtPnJlcV9pcnEpID09IG5fSVJRKSB7CisgICAgICAgIGlmIChxYXRv
bWljX3JlYWQoJmljdS0+cmVxX2lycSkgPT0gbl9JUlEpIHsKICAgICAgICAgICAgIC8qIGNsZWFy
IHJlcXVlc3QgKi8KICAgICAgICAgICAgIHNldF9pcnEoaWN1LCBuX0lSUSwgMCk7Ci0gICAgICAg
ICAgICBhdG9taWNfc2V0KCZpY3UtPnJlcV9pcnEsIC0xKTsKKyAgICAgICAgICAgIHFhdG9taWNf
c2V0KCZpY3UtPnJlcV9pcnEsIC0xKTsKICAgICAgICAgfQogICAgICAgICByZXR1cm47CiAgICAg
fQpAQCAtMTQ0LDExICsxNDQsMTEgQEAgc3RhdGljIHZvaWQgcnhpY3VfYWNrX2lycSh2b2lkICpv
cGFxdWUsIGludCBubywgaW50IGxldmVsKQogICAgIGludCBuX0lSUTsKICAgICBpbnQgbWF4X3By
aTsKIAotICAgIG5fSVJRID0gYXRvbWljX3JlYWQoJmljdS0+cmVxX2lycSk7CisgICAgbl9JUlEg
PSBxYXRvbWljX3JlYWQoJmljdS0+cmVxX2lycSk7CiAgICAgaWYgKG5fSVJRIDwgMCkgewogICAg
ICAgICByZXR1cm47CiAgICAgfQotICAgIGF0b21pY19zZXQoJmljdS0+cmVxX2lycSwgLTEpOwor
ICAgIHFhdG9taWNfc2V0KCZpY3UtPnJlcV9pcnEsIC0xKTsKICAgICBpZiAoaWN1LT5zcmNbbl9J
UlFdLnNlbnNlICE9IFRSR19MRVZFTCkgewogICAgICAgICBpY3UtPmlyW25fSVJRXSA9IDA7CiAg
ICAgfQpkaWZmIC0tZ2l0IGEvaHcvaW50Yy9zaWZpdmVfcGxpYy5jIGIvaHcvaW50Yy9zaWZpdmVf
cGxpYy5jCmluZGV4IGFmNjExZjhkYjguLmY0MmZkNjk1ZDggMTAwNjQ0Ci0tLSBhL2h3L2ludGMv
c2lmaXZlX3BsaWMuYworKysgYi9ody9pbnRjL3NpZml2ZV9wbGljLmMKQEAgLTg5LDEyICs4OSwx
MiBAQCBzdGF0aWMgdm9pZCBzaWZpdmVfcGxpY19wcmludF9zdGF0ZShTaUZpdmVQTElDU3RhdGUg
KnBsaWMpCiAKIHN0YXRpYyB1aW50MzJfdCBhdG9taWNfc2V0X21hc2tlZCh1aW50MzJfdCAqYSwg
dWludDMyX3QgbWFzaywgdWludDMyX3QgdmFsdWUpCiB7Ci0gICAgdWludDMyX3Qgb2xkLCBuZXcs
IGNtcCA9IGF0b21pY19yZWFkKGEpOworICAgIHVpbnQzMl90IG9sZCwgbmV3LCBjbXAgPSBxYXRv
bWljX3JlYWQoYSk7CiAKICAgICBkbyB7CiAgICAgICAgIG9sZCA9IGNtcDsKICAgICAgICAgbmV3
ID0gKG9sZCAmIH5tYXNrKSB8ICh2YWx1ZSAmIG1hc2spOwotICAgICAgICBjbXAgPSBhdG9taWNf
Y21weGNoZyhhLCBvbGQsIG5ldyk7CisgICAgICAgIGNtcCA9IHFhdG9taWNfY21weGNoZyhhLCBv
bGQsIG5ldyk7CiAgICAgfSB3aGlsZSAob2xkICE9IGNtcCk7CiAKICAgICByZXR1cm4gb2xkOwpk
aWZmIC0tZ2l0IGEvaHcvbWlzYy9lZHUuYyBiL2h3L21pc2MvZWR1LmMKaW5kZXggMGZmOWQxYWM3
OC4uZTkzNWM0MThkNCAxMDA2NDQKLS0tIGEvaHcvbWlzYy9lZHUuYworKysgYi9ody9taXNjL2Vk
dS5jCkBAIC0yMTIsNyArMjEyLDcgQEAgc3RhdGljIHVpbnQ2NF90IGVkdV9tbWlvX3JlYWQodm9p
ZCAqb3BhcXVlLCBod2FkZHIgYWRkciwgdW5zaWduZWQgc2l6ZSkKICAgICAgICAgcWVtdV9tdXRl
eF91bmxvY2soJmVkdS0+dGhyX211dGV4KTsKICAgICAgICAgYnJlYWs7CiAgICAgY2FzZSAweDIw
OgotICAgICAgICB2YWwgPSBhdG9taWNfcmVhZCgmZWR1LT5zdGF0dXMpOworICAgICAgICB2YWwg
PSBxYXRvbWljX3JlYWQoJmVkdS0+c3RhdHVzKTsKICAgICAgICAgYnJlYWs7CiAgICAgY2FzZSAw
eDI0OgogICAgICAgICB2YWwgPSBlZHUtPmlycV9zdGF0dXM7CkBAIC0yNTIsNyArMjUyLDcgQEAg
c3RhdGljIHZvaWQgZWR1X21taW9fd3JpdGUodm9pZCAqb3BhcXVlLCBod2FkZHIgYWRkciwgdWlu
dDY0X3QgdmFsLAogICAgICAgICBlZHUtPmFkZHI0ID0gfnZhbDsKICAgICAgICAgYnJlYWs7CiAg
ICAgY2FzZSAweDA4OgotICAgICAgICBpZiAoYXRvbWljX3JlYWQoJmVkdS0+c3RhdHVzKSAmIEVE
VV9TVEFUVVNfQ09NUFVUSU5HKSB7CisgICAgICAgIGlmIChxYXRvbWljX3JlYWQoJmVkdS0+c3Rh
dHVzKSAmIEVEVV9TVEFUVVNfQ09NUFVUSU5HKSB7CiAgICAgICAgICAgICBicmVhazsKICAgICAg
ICAgfQogICAgICAgICAvKiBFRFVfU1RBVFVTX0NPTVBVVElORyBjYW5ub3QgZ28gMC0+MSBjb25j
dXJyZW50bHksIGJlY2F1c2UgaXQgaXMgb25seQpAQCAtMjYwLDE1ICsyNjAsMTUgQEAgc3RhdGlj
IHZvaWQgZWR1X21taW9fd3JpdGUodm9pZCAqb3BhcXVlLCBod2FkZHIgYWRkciwgdWludDY0X3Qg
dmFsLAogICAgICAgICAgKi8KICAgICAgICAgcWVtdV9tdXRleF9sb2NrKCZlZHUtPnRocl9tdXRl
eCk7CiAgICAgICAgIGVkdS0+ZmFjdCA9IHZhbDsKLSAgICAgICAgYXRvbWljX29yKCZlZHUtPnN0
YXR1cywgRURVX1NUQVRVU19DT01QVVRJTkcpOworICAgICAgICBxYXRvbWljX29yKCZlZHUtPnN0
YXR1cywgRURVX1NUQVRVU19DT01QVVRJTkcpOwogICAgICAgICBxZW11X2NvbmRfc2lnbmFsKCZl
ZHUtPnRocl9jb25kKTsKICAgICAgICAgcWVtdV9tdXRleF91bmxvY2soJmVkdS0+dGhyX211dGV4
KTsKICAgICAgICAgYnJlYWs7CiAgICAgY2FzZSAweDIwOgogICAgICAgICBpZiAodmFsICYgRURV
X1NUQVRVU19JUlFGQUNUKSB7Ci0gICAgICAgICAgICBhdG9taWNfb3IoJmVkdS0+c3RhdHVzLCBF
RFVfU1RBVFVTX0lSUUZBQ1QpOworICAgICAgICAgICAgcWF0b21pY19vcigmZWR1LT5zdGF0dXMs
IEVEVV9TVEFUVVNfSVJRRkFDVCk7CiAgICAgICAgIH0gZWxzZSB7Ci0gICAgICAgICAgICBhdG9t
aWNfYW5kKCZlZHUtPnN0YXR1cywgfkVEVV9TVEFUVVNfSVJRRkFDVCk7CisgICAgICAgICAgICBx
YXRvbWljX2FuZCgmZWR1LT5zdGF0dXMsIH5FRFVfU1RBVFVTX0lSUUZBQ1QpOwogICAgICAgICB9
CiAgICAgICAgIGJyZWFrOwogICAgIGNhc2UgMHg2MDoKQEAgLTMyMiw3ICszMjIsNyBAQCBzdGF0
aWMgdm9pZCAqZWR1X2ZhY3RfdGhyZWFkKHZvaWQgKm9wYXF1ZSkKICAgICAgICAgdWludDMyX3Qg
dmFsLCByZXQgPSAxOwogCiAgICAgICAgIHFlbXVfbXV0ZXhfbG9jaygmZWR1LT50aHJfbXV0ZXgp
OwotICAgICAgICB3aGlsZSAoKGF0b21pY19yZWFkKCZlZHUtPnN0YXR1cykgJiBFRFVfU1RBVFVT
X0NPTVBVVElORykgPT0gMCAmJgorICAgICAgICB3aGlsZSAoKHFhdG9taWNfcmVhZCgmZWR1LT5z
dGF0dXMpICYgRURVX1NUQVRVU19DT01QVVRJTkcpID09IDAgJiYKICAgICAgICAgICAgICAgICAg
ICAgICAgICFlZHUtPnN0b3BwaW5nKSB7CiAgICAgICAgICAgICBxZW11X2NvbmRfd2FpdCgmZWR1
LT50aHJfY29uZCwgJmVkdS0+dGhyX211dGV4KTsKICAgICAgICAgfQpAQCAtMzQ3LDkgKzM0Nyw5
IEBAIHN0YXRpYyB2b2lkICplZHVfZmFjdF90aHJlYWQodm9pZCAqb3BhcXVlKQogICAgICAgICBx
ZW11X211dGV4X2xvY2soJmVkdS0+dGhyX211dGV4KTsKICAgICAgICAgZWR1LT5mYWN0ID0gcmV0
OwogICAgICAgICBxZW11X211dGV4X3VubG9jaygmZWR1LT50aHJfbXV0ZXgpOwotICAgICAgICBh
dG9taWNfYW5kKCZlZHUtPnN0YXR1cywgfkVEVV9TVEFUVVNfQ09NUFVUSU5HKTsKKyAgICAgICAg
cWF0b21pY19hbmQoJmVkdS0+c3RhdHVzLCB+RURVX1NUQVRVU19DT01QVVRJTkcpOwogCi0gICAg
ICAgIGlmIChhdG9taWNfcmVhZCgmZWR1LT5zdGF0dXMpICYgRURVX1NUQVRVU19JUlFGQUNUKSB7
CisgICAgICAgIGlmIChxYXRvbWljX3JlYWQoJmVkdS0+c3RhdHVzKSAmIEVEVV9TVEFUVVNfSVJR
RkFDVCkgewogICAgICAgICAgICAgcWVtdV9tdXRleF9sb2NrX2lvdGhyZWFkKCk7CiAgICAgICAg
ICAgICBlZHVfcmFpc2VfaXJxKGVkdSwgRkFDVF9JUlEpOwogICAgICAgICAgICAgcWVtdV9tdXRl
eF91bmxvY2tfaW90aHJlYWQoKTsKZGlmZiAtLWdpdCBhL2h3L25ldC92aXJ0aW8tbmV0LmMgYi9o
dy9uZXQvdmlydGlvLW5ldC5jCmluZGV4IGNiMGQyNzA4NGMuLjdiZjI3YjlkYjcgMTAwNjQ0Ci0t
LSBhL2h3L25ldC92aXJ0aW8tbmV0LmMKKysrIGIvaHcvbmV0L3ZpcnRpby1uZXQuYwpAQCAtOTMz
LDcgKzkzMyw3IEBAIHN0YXRpYyB2b2lkIHZpcnRpb19uZXRfc2V0X2ZlYXR1cmVzKFZpcnRJT0Rl
dmljZSAqdmRldiwgdWludDY0X3QgZmVhdHVyZXMpCiAKICAgICBpZiAodmlydGlvX2hhc19mZWF0
dXJlKGZlYXR1cmVzLCBWSVJUSU9fTkVUX0ZfU1RBTkRCWSkpIHsKICAgICAgICAgcWFwaV9ldmVu
dF9zZW5kX2ZhaWxvdmVyX25lZ290aWF0ZWQobi0+bmV0Y2xpZW50X25hbWUpOwotICAgICAgICBh
dG9taWNfc2V0KCZuLT5wcmltYXJ5X3Nob3VsZF9iZV9oaWRkZW4sIGZhbHNlKTsKKyAgICAgICAg
cWF0b21pY19zZXQoJm4tPnByaW1hcnlfc2hvdWxkX2JlX2hpZGRlbiwgZmFsc2UpOwogICAgICAg
ICBmYWlsb3Zlcl9hZGRfcHJpbWFyeShuLCAmZXJyKTsKICAgICAgICAgaWYgKGVycikgewogICAg
ICAgICAgICAgbi0+cHJpbWFyeV9kZXYgPSB2aXJ0aW9fY29ubmVjdF9mYWlsb3Zlcl9kZXZpY2Vz
KG4sIG4tPnFkZXYsICZlcnIpOwpAQCAtMzE2OCw3ICszMTY4LDcgQEAgc3RhdGljIHZvaWQgdmly
dGlvX25ldF9oYW5kbGVfbWlncmF0aW9uX3ByaW1hcnkoVmlydElPTmV0ICpuLAogICAgIGJvb2wg
c2hvdWxkX2JlX2hpZGRlbjsKICAgICBFcnJvciAqZXJyID0gTlVMTDsKIAotICAgIHNob3VsZF9i
ZV9oaWRkZW4gPSBhdG9taWNfcmVhZCgmbi0+cHJpbWFyeV9zaG91bGRfYmVfaGlkZGVuKTsKKyAg
ICBzaG91bGRfYmVfaGlkZGVuID0gcWF0b21pY19yZWFkKCZuLT5wcmltYXJ5X3Nob3VsZF9iZV9o
aWRkZW4pOwogCiAgICAgaWYgKCFuLT5wcmltYXJ5X2RldikgewogICAgICAgICBuLT5wcmltYXJ5
X2RldiA9IHZpcnRpb19jb25uZWN0X2ZhaWxvdmVyX2RldmljZXMobiwgbi0+cWRldiwgJmVycik7
CkBAIC0zMTgzLDcgKzMxODMsNyBAQCBzdGF0aWMgdm9pZCB2aXJ0aW9fbmV0X2hhbmRsZV9taWdy
YXRpb25fcHJpbWFyeShWaXJ0SU9OZXQgKm4sCiAgICAgICAgICAgICAgICAgICAgIHFkZXZfZ2V0
X3Ztc2Qobi0+cHJpbWFyeV9kZXYpLAogICAgICAgICAgICAgICAgICAgICBuLT5wcmltYXJ5X2Rl
dik7CiAgICAgICAgICAgICBxYXBpX2V2ZW50X3NlbmRfdW5wbHVnX3ByaW1hcnkobi0+cHJpbWFy
eV9kZXZpY2VfaWQpOwotICAgICAgICAgICAgYXRvbWljX3NldCgmbi0+cHJpbWFyeV9zaG91bGRf
YmVfaGlkZGVuLCB0cnVlKTsKKyAgICAgICAgICAgIHFhdG9taWNfc2V0KCZuLT5wcmltYXJ5X3No
b3VsZF9iZV9oaWRkZW4sIHRydWUpOwogICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgd2Fy
bl9yZXBvcnQoImNvdWxkbid0IHVucGx1ZyBwcmltYXJ5IGRldmljZSIpOwogICAgICAgICB9CkBA
IC0zMjM0LDcgKzMyMzQsNyBAQCBzdGF0aWMgaW50IHZpcnRpb19uZXRfcHJpbWFyeV9zaG91bGRf
YmVfaGlkZGVuKERldmljZUxpc3RlbmVyICpsaXN0ZW5lciwKICAgICBuLT5wcmltYXJ5X2Rldmlj
ZV9vcHRzID0gZGV2aWNlX29wdHM7CiAKICAgICAvKiBwcmltYXJ5X3Nob3VsZF9iZV9oaWRkZW4g
aXMgc2V0IGR1cmluZyBmZWF0dXJlIG5lZ290aWF0aW9uICovCi0gICAgaGlkZSA9IGF0b21pY19y
ZWFkKCZuLT5wcmltYXJ5X3Nob3VsZF9iZV9oaWRkZW4pOworICAgIGhpZGUgPSBxYXRvbWljX3Jl
YWQoJm4tPnByaW1hcnlfc2hvdWxkX2JlX2hpZGRlbik7CiAKICAgICBpZiAobi0+cHJpbWFyeV9k
ZXZpY2VfZGljdCkgewogICAgICAgICBnX2ZyZWUobi0+cHJpbWFyeV9kZXZpY2VfaWQpOwpAQCAt
MzI5MSw3ICszMjkxLDcgQEAgc3RhdGljIHZvaWQgdmlydGlvX25ldF9kZXZpY2VfcmVhbGl6ZShE
ZXZpY2VTdGF0ZSAqZGV2LCBFcnJvciAqKmVycnApCiAgICAgaWYgKG4tPmZhaWxvdmVyKSB7CiAg
ICAgICAgIG4tPnByaW1hcnlfbGlzdGVuZXIuc2hvdWxkX2JlX2hpZGRlbiA9CiAgICAgICAgICAg
ICB2aXJ0aW9fbmV0X3ByaW1hcnlfc2hvdWxkX2JlX2hpZGRlbjsKLSAgICAgICAgYXRvbWljX3Nl
dCgmbi0+cHJpbWFyeV9zaG91bGRfYmVfaGlkZGVuLCB0cnVlKTsKKyAgICAgICAgcWF0b21pY19z
ZXQoJm4tPnByaW1hcnlfc2hvdWxkX2JlX2hpZGRlbiwgdHJ1ZSk7CiAgICAgICAgIGRldmljZV9s
aXN0ZW5lcl9yZWdpc3Rlcigmbi0+cHJpbWFyeV9saXN0ZW5lcik7CiAgICAgICAgIG4tPm1pZ3Jh
dGlvbl9zdGF0ZS5ub3RpZnkgPSB2aXJ0aW9fbmV0X21pZ3JhdGlvbl9zdGF0ZV9ub3RpZmllcjsK
ICAgICAgICAgYWRkX21pZ3JhdGlvbl9zdGF0ZV9jaGFuZ2Vfbm90aWZpZXIoJm4tPm1pZ3JhdGlv
bl9zdGF0ZSk7CmRpZmYgLS1naXQgYS9ody9yZG1hL3JkbWFfYmFja2VuZC5jIGIvaHcvcmRtYS9y
ZG1hX2JhY2tlbmQuYwppbmRleCBkYjdlNWM4YmU1Li41ZGUwMTBiMWZhIDEwMDY0NAotLS0gYS9o
dy9yZG1hL3JkbWFfYmFja2VuZC5jCisrKyBiL2h3L3JkbWEvcmRtYV9iYWNrZW5kLmMKQEAgLTY4
LDcgKzY4LDcgQEAgc3RhdGljIHZvaWQgZnJlZV9jcWVfY3R4KGdwb2ludGVyIGRhdGEsIGdwb2lu
dGVyIHVzZXJfZGF0YSkKICAgICBiY3R4ID0gcmRtYV9ybV9nZXRfY3FlX2N0eChyZG1hX2Rldl9y
ZXMsIGNxZV9jdHhfaWQpOwogICAgIGlmIChiY3R4KSB7CiAgICAgICAgIHJkbWFfcm1fZGVhbGxv
Y19jcWVfY3R4KHJkbWFfZGV2X3JlcywgY3FlX2N0eF9pZCk7Ci0gICAgICAgIGF0b21pY19kZWMo
JnJkbWFfZGV2X3Jlcy0+c3RhdHMubWlzc2luZ19jcWUpOworICAgICAgICBxYXRvbWljX2RlYygm
cmRtYV9kZXZfcmVzLT5zdGF0cy5taXNzaW5nX2NxZSk7CiAgICAgfQogICAgIGdfZnJlZShiY3R4
KTsKIH0KQEAgLTgxLDcgKzgxLDcgQEAgc3RhdGljIHZvaWQgY2xlYW5fcmVjdl9tYWRzKFJkbWFC
YWNrZW5kRGV2ICpiYWNrZW5kX2RldikKICAgICAgICAgY3FlX2N0eF9pZCA9IHJkbWFfcHJvdGVj
dGVkX3FsaXN0X3BvcF9pbnQ2NCgmYmFja2VuZF9kZXYtPgogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY3ZfbWFkc19saXN0KTsKICAgICAgICAg
aWYgKGNxZV9jdHhfaWQgIT0gLUVOT0VOVCkgewotICAgICAgICAgICAgYXRvbWljX2luYygmYmFj
a2VuZF9kZXYtPnJkbWFfZGV2X3Jlcy0+c3RhdHMubWlzc2luZ19jcWUpOworICAgICAgICAgICAg
cWF0b21pY19pbmMoJmJhY2tlbmRfZGV2LT5yZG1hX2Rldl9yZXMtPnN0YXRzLm1pc3NpbmdfY3Fl
KTsKICAgICAgICAgICAgIGZyZWVfY3FlX2N0eChHSU5UX1RPX1BPSU5URVIoY3FlX2N0eF9pZCks
CiAgICAgICAgICAgICAgICAgICAgICAgICAgYmFja2VuZF9kZXYtPnJkbWFfZGV2X3Jlcyk7CiAg
ICAgICAgIH0KQEAgLTEyMyw3ICsxMjMsNyBAQCBzdGF0aWMgaW50IHJkbWFfcG9sbF9jcShSZG1h
RGV2aWNlUmVzb3VyY2VzICpyZG1hX2Rldl9yZXMsIHN0cnVjdCBpYnZfY3EgKmliY3EpCiAgICAg
ICAgICAgICB9CiAgICAgICAgICAgICB0b3RhbF9uZSArPSBuZTsKICAgICAgICAgfSB3aGlsZSAo
bmUgPiAwKTsKLSAgICAgICAgYXRvbWljX3N1YigmcmRtYV9kZXZfcmVzLT5zdGF0cy5taXNzaW5n
X2NxZSwgdG90YWxfbmUpOworICAgICAgICBxYXRvbWljX3N1YigmcmRtYV9kZXZfcmVzLT5zdGF0
cy5taXNzaW5nX2NxZSwgdG90YWxfbmUpOwogICAgIH0KIAogICAgIGlmIChuZSA8IDApIHsKQEAg
LTE5NSwxNyArMTk1LDE3IEBAIHN0YXRpYyB2b2lkICpjb21wX2hhbmRsZXJfdGhyZWFkKHZvaWQg
KmFyZykKIAogc3RhdGljIGlubGluZSB2b2lkIGRpc2FibGVfcmRtYWNtX211eF9hc3luYyhSZG1h
QmFja2VuZERldiAqYmFja2VuZF9kZXYpCiB7Ci0gICAgYXRvbWljX3NldCgmYmFja2VuZF9kZXYt
PnJkbWFjbV9tdXguY2FuX3JlY2VpdmUsIDApOworICAgIHFhdG9taWNfc2V0KCZiYWNrZW5kX2Rl
di0+cmRtYWNtX211eC5jYW5fcmVjZWl2ZSwgMCk7CiB9CiAKIHN0YXRpYyBpbmxpbmUgdm9pZCBl
bmFibGVfcmRtYWNtX211eF9hc3luYyhSZG1hQmFja2VuZERldiAqYmFja2VuZF9kZXYpCiB7Ci0g
ICAgYXRvbWljX3NldCgmYmFja2VuZF9kZXYtPnJkbWFjbV9tdXguY2FuX3JlY2VpdmUsIHNpemVv
ZihSZG1hQ21NdXhNc2cpKTsKKyAgICBxYXRvbWljX3NldCgmYmFja2VuZF9kZXYtPnJkbWFjbV9t
dXguY2FuX3JlY2VpdmUsIHNpemVvZihSZG1hQ21NdXhNc2cpKTsKIH0KIAogc3RhdGljIGlubGlu
ZSBpbnQgcmRtYWNtX211eF9jYW5fcHJvY2Vzc19hc3luYyhSZG1hQmFja2VuZERldiAqYmFja2Vu
ZF9kZXYpCiB7Ci0gICAgcmV0dXJuIGF0b21pY19yZWFkKCZiYWNrZW5kX2Rldi0+cmRtYWNtX211
eC5jYW5fcmVjZWl2ZSk7CisgICAgcmV0dXJuIHFhdG9taWNfcmVhZCgmYmFja2VuZF9kZXYtPnJk
bWFjbV9tdXguY2FuX3JlY2VpdmUpOwogfQogCiBzdGF0aWMgaW50IHJkbWFjbV9tdXhfY2hlY2tf
b3Bfc3RhdHVzKENoYXJCYWNrZW5kICptYWRfY2hyX2JlKQpAQCAtNTU1LDcgKzU1NSw3IEBAIHZv
aWQgcmRtYV9iYWNrZW5kX3Bvc3Rfc2VuZChSZG1hQmFja2VuZERldiAqYmFja2VuZF9kZXYsCiAg
ICAgICAgIGdvdG8gZXJyX2RlYWxsb2NfY3FlX2N0eDsKICAgICB9CiAKLSAgICBhdG9taWNfaW5j
KCZiYWNrZW5kX2Rldi0+cmRtYV9kZXZfcmVzLT5zdGF0cy5taXNzaW5nX2NxZSk7CisgICAgcWF0
b21pY19pbmMoJmJhY2tlbmRfZGV2LT5yZG1hX2Rldl9yZXMtPnN0YXRzLm1pc3NpbmdfY3FlKTsK
ICAgICBiYWNrZW5kX2Rldi0+cmRtYV9kZXZfcmVzLT5zdGF0cy50eCsrOwogCiAgICAgcmV0dXJu
OwpAQCAtNjU4LDcgKzY1OCw3IEBAIHZvaWQgcmRtYV9iYWNrZW5kX3Bvc3RfcmVjdihSZG1hQmFj
a2VuZERldiAqYmFja2VuZF9kZXYsCiAgICAgICAgIGdvdG8gZXJyX2RlYWxsb2NfY3FlX2N0eDsK
ICAgICB9CiAKLSAgICBhdG9taWNfaW5jKCZiYWNrZW5kX2Rldi0+cmRtYV9kZXZfcmVzLT5zdGF0
cy5taXNzaW5nX2NxZSk7CisgICAgcWF0b21pY19pbmMoJmJhY2tlbmRfZGV2LT5yZG1hX2Rldl9y
ZXMtPnN0YXRzLm1pc3NpbmdfY3FlKTsKICAgICBiYWNrZW5kX2Rldi0+cmRtYV9kZXZfcmVzLT5z
dGF0cy5yeF9idWZzKys7CiAKICAgICByZXR1cm47CkBAIC03MTAsNyArNzEwLDcgQEAgdm9pZCBy
ZG1hX2JhY2tlbmRfcG9zdF9zcnFfcmVjdihSZG1hQmFja2VuZERldiAqYmFja2VuZF9kZXYsCiAg
ICAgICAgIGdvdG8gZXJyX2RlYWxsb2NfY3FlX2N0eDsKICAgICB9CiAKLSAgICBhdG9taWNfaW5j
KCZiYWNrZW5kX2Rldi0+cmRtYV9kZXZfcmVzLT5zdGF0cy5taXNzaW5nX2NxZSk7CisgICAgcWF0
b21pY19pbmMoJmJhY2tlbmRfZGV2LT5yZG1hX2Rldl9yZXMtPnN0YXRzLm1pc3NpbmdfY3FlKTsK
ICAgICBiYWNrZW5kX2Rldi0+cmRtYV9kZXZfcmVzLT5zdGF0cy5yeF9idWZzKys7CiAgICAgYmFj
a2VuZF9kZXYtPnJkbWFfZGV2X3Jlcy0+c3RhdHMucnhfc3JxKys7CiAKZGlmZiAtLWdpdCBhL2h3
L3JkbWEvcmRtYV9ybS5jIGIvaHcvcmRtYS9yZG1hX3JtLmMKaW5kZXggNjA5NTdmODhkYi4uNDkx
NDFkNDA3NCAxMDA2NDQKLS0tIGEvaHcvcmRtYS9yZG1hX3JtLmMKKysrIGIvaHcvcmRtYS9yZG1h
X3JtLmMKQEAgLTc5MCw3ICs3OTAsNyBAQCBpbnQgcmRtYV9ybV9pbml0KFJkbWFEZXZpY2VSZXNv
dXJjZXMgKmRldl9yZXMsIHN0cnVjdCBpYnZfZGV2aWNlX2F0dHIgKmRldl9hdHRyKQogICAgIHFl
bXVfbXV0ZXhfaW5pdCgmZGV2X3Jlcy0+bG9jayk7CiAKICAgICBtZW1zZXQoJmRldl9yZXMtPnN0
YXRzLCAwLCBzaXplb2YoZGV2X3Jlcy0+c3RhdHMpKTsKLSAgICBhdG9taWNfc2V0KCZkZXZfcmVz
LT5zdGF0cy5taXNzaW5nX2NxZSwgMCk7CisgICAgcWF0b21pY19zZXQoJmRldl9yZXMtPnN0YXRz
Lm1pc3NpbmdfY3FlLCAwKTsKIAogICAgIHJldHVybiAwOwogfQpkaWZmIC0tZ2l0IGEvaHcvcmRt
YS92bXcvcHZyZG1hX2Rldl9yaW5nLmMgYi9ody9yZG1hL3Ztdy9wdnJkbWFfZGV2X3JpbmcuYwpp
bmRleCBjMTIyZmU3MDM1Li5mMGJjZGU3NGIwIDEwMDY0NAotLS0gYS9ody9yZG1hL3Ztdy9wdnJk
bWFfZGV2X3JpbmcuYworKysgYi9ody9yZG1hL3Ztdy9wdnJkbWFfZGV2X3JpbmcuYwpAQCAtMzgs
OCArMzgsOCBAQCBpbnQgcHZyZG1hX3JpbmdfaW5pdChQdnJkbWFSaW5nICpyaW5nLCBjb25zdCBj
aGFyICpuYW1lLCBQQ0lEZXZpY2UgKmRldiwKICAgICByaW5nLT5tYXhfZWxlbXMgPSBtYXhfZWxl
bXM7CiAgICAgcmluZy0+ZWxlbV9zeiA9IGVsZW1fc3o7CiAgICAgLyogVE9ETzogR2l2ZSBhIG1v
bWVudCB0byB0aGluayBpZiB3ZSB3YW50IHRvIHJlZG8gZHJpdmVyIHNldHRpbmdzCi0gICAgYXRv
bWljX3NldCgmcmluZy0+cmluZ19zdGF0ZS0+cHJvZF90YWlsLCAwKTsKLSAgICBhdG9taWNfc2V0
KCZyaW5nLT5yaW5nX3N0YXRlLT5jb25zX2hlYWQsIDApOworICAgIHFhdG9taWNfc2V0KCZyaW5n
LT5yaW5nX3N0YXRlLT5wcm9kX3RhaWwsIDApOworICAgIHFhdG9taWNfc2V0KCZyaW5nLT5yaW5n
X3N0YXRlLT5jb25zX2hlYWQsIDApOwogICAgICovCiAgICAgcmluZy0+bnBhZ2VzID0gbnBhZ2Vz
OwogICAgIHJpbmctPnBhZ2VzID0gZ19tYWxsb2MobnBhZ2VzICogc2l6ZW9mKHZvaWQgKikpOwpk
aWZmIC0tZ2l0IGEvaHcvczM5MHgvczM5MC1wY2ktYnVzLmMgYi9ody9zMzkweC9zMzkwLXBjaS1i
dXMuYwppbmRleCA5MjE0NmEyMTE5Li5mYjRjZWU4N2E0IDEwMDY0NAotLS0gYS9ody9zMzkweC9z
MzkwLXBjaS1idXMuYworKysgYi9ody9zMzkweC9zMzkwLXBjaS1idXMuYwpAQCAtNjUwLDcgKzY1
MCw3IEBAIHN0YXRpYyB1aW50OF90IHNldF9pbmRfYXRvbWljKHVpbnQ2NF90IGluZF9sb2MsIHVp
bnQ4X3QgdG9fYmVfc2V0KQogICAgIGFjdHVhbCA9ICppbmRfYWRkcjsKICAgICBkbyB7CiAgICAg
ICAgIGV4cGVjdGVkID0gYWN0dWFsOwotICAgICAgICBhY3R1YWwgPSBhdG9taWNfY21weGNoZyhp
bmRfYWRkciwgZXhwZWN0ZWQsIGV4cGVjdGVkIHwgdG9fYmVfc2V0KTsKKyAgICAgICAgYWN0dWFs
ID0gcWF0b21pY19jbXB4Y2hnKGluZF9hZGRyLCBleHBlY3RlZCwgZXhwZWN0ZWQgfCB0b19iZV9z
ZXQpOwogICAgIH0gd2hpbGUgKGFjdHVhbCAhPSBleHBlY3RlZCk7CiAgICAgY3B1X3BoeXNpY2Fs
X21lbW9yeV91bm1hcCgodm9pZCAqKWluZF9hZGRyLCBsZW4sIDEsIGxlbik7CiAKZGlmZiAtLWdp
dCBhL2h3L3MzOTB4L3ZpcnRpby1jY3cuYyBiL2h3L3MzOTB4L3ZpcnRpby1jY3cuYwppbmRleCA4
ZmViMzQ1MWEwLi44ZDE0MGRjNTBmIDEwMDY0NAotLS0gYS9ody9zMzkweC92aXJ0aW8tY2N3LmMK
KysrIGIvaHcvczM5MHgvdmlydGlvLWNjdy5jCkBAIC04MDAsNyArODAwLDcgQEAgc3RhdGljIHVp
bnQ4X3QgdmlydGlvX3NldF9pbmRfYXRvbWljKFN1YmNoRGV2ICpzY2gsIHVpbnQ2NF90IGluZF9s
b2MsCiAgICAgYWN0dWFsID0gKmluZF9hZGRyOwogICAgIGRvIHsKICAgICAgICAgZXhwZWN0ZWQg
PSBhY3R1YWw7Ci0gICAgICAgIGFjdHVhbCA9IGF0b21pY19jbXB4Y2hnKGluZF9hZGRyLCBleHBl
Y3RlZCwgZXhwZWN0ZWQgfCB0b19iZV9zZXQpOworICAgICAgICBhY3R1YWwgPSBxYXRvbWljX2Nt
cHhjaGcoaW5kX2FkZHIsIGV4cGVjdGVkLCBleHBlY3RlZCB8IHRvX2JlX3NldCk7CiAgICAgfSB3
aGlsZSAoYWN0dWFsICE9IGV4cGVjdGVkKTsKICAgICB0cmFjZV92aXJ0aW9fY2N3X3NldF9pbmQo
aW5kX2xvYywgYWN0dWFsLCBhY3R1YWwgfCB0b19iZV9zZXQpOwogICAgIGNwdV9waHlzaWNhbF9t
ZW1vcnlfdW5tYXAoKHZvaWQgKilpbmRfYWRkciwgbGVuLCAxLCBsZW4pOwpkaWZmIC0tZ2l0IGEv
aHcvdmlydGlvL3Zob3N0LmMgYi9ody92aXJ0aW8vdmhvc3QuYwppbmRleCAxYTEzODRlN2E2Li4w
MTE5NTE2MjU0IDEwMDY0NAotLS0gYS9ody92aXJ0aW8vdmhvc3QuYworKysgYi9ody92aXJ0aW8v
dmhvc3QuYwpAQCAtOTAsNyArOTAsNyBAQCBzdGF0aWMgdm9pZCB2aG9zdF9kZXZfc3luY19yZWdp
b24oc3RydWN0IHZob3N0X2RldiAqZGV2LAogICAgICAgICB9CiAgICAgICAgIC8qIERhdGEgbXVz
dCBiZSByZWFkIGF0b21pY2FsbHkuIFdlIGRvbid0IHJlYWxseSBuZWVkIGJhcnJpZXIgc2VtYW50
aWNzCiAgICAgICAgICAqIGJ1dCBpdCdzIGVhc2llciB0byB1c2UgYXRvbWljXyogdGhhbiByb2xs
IG91ciBvd24uICovCi0gICAgICAgIGxvZyA9IGF0b21pY194Y2hnKGZyb20sIDApOworICAgICAg
ICBsb2cgPSBxYXRvbWljX3hjaGcoZnJvbSwgMCk7CiAgICAgICAgIHdoaWxlIChsb2cpIHsKICAg
ICAgICAgICAgIGludCBiaXQgPSBjdHpsKGxvZyk7CiAgICAgICAgICAgICBod2FkZHIgcGFnZV9h
ZGRyOwpkaWZmIC0tZ2l0IGEvaHcvdmlydGlvL3ZpcnRpby1tbWlvLmMgYi9ody92aXJ0aW8vdmly
dGlvLW1taW8uYwppbmRleCBmMTJkMTU5NWFhLi5lMWI1YzNiODFlIDEwMDY0NAotLS0gYS9ody92
aXJ0aW8vdmlydGlvLW1taW8uYworKysgYi9ody92aXJ0aW8vdmlydGlvLW1taW8uYwpAQCAtMTc5
LDcgKzE3OSw3IEBAIHN0YXRpYyB1aW50NjRfdCB2aXJ0aW9fbW1pb19yZWFkKHZvaWQgKm9wYXF1
ZSwgaHdhZGRyIG9mZnNldCwgdW5zaWduZWQgc2l6ZSkKICAgICAgICAgfQogICAgICAgICByZXR1
cm4gcHJveHktPnZxc1t2ZGV2LT5xdWV1ZV9zZWxdLmVuYWJsZWQ7CiAgICAgY2FzZSBWSVJUSU9f
TU1JT19JTlRFUlJVUFRfU1RBVFVTOgotICAgICAgICByZXR1cm4gYXRvbWljX3JlYWQoJnZkZXYt
Pmlzcik7CisgICAgICAgIHJldHVybiBxYXRvbWljX3JlYWQoJnZkZXYtPmlzcik7CiAgICAgY2Fz
ZSBWSVJUSU9fTU1JT19TVEFUVVM6CiAgICAgICAgIHJldHVybiB2ZGV2LT5zdGF0dXM7CiAgICAg
Y2FzZSBWSVJUSU9fTU1JT19DT05GSUdfR0VORVJBVElPTjoKQEAgLTM3MCw3ICszNzAsNyBAQCBz
dGF0aWMgdm9pZCB2aXJ0aW9fbW1pb193cml0ZSh2b2lkICpvcGFxdWUsIGh3YWRkciBvZmZzZXQs
IHVpbnQ2NF90IHZhbHVlLAogICAgICAgICB9CiAgICAgICAgIGJyZWFrOwogICAgIGNhc2UgVklS
VElPX01NSU9fSU5URVJSVVBUX0FDSzoKLSAgICAgICAgYXRvbWljX2FuZCgmdmRldi0+aXNyLCB+
dmFsdWUpOworICAgICAgICBxYXRvbWljX2FuZCgmdmRldi0+aXNyLCB+dmFsdWUpOwogICAgICAg
ICB2aXJ0aW9fdXBkYXRlX2lycSh2ZGV2KTsKICAgICAgICAgYnJlYWs7CiAgICAgY2FzZSBWSVJU
SU9fTU1JT19TVEFUVVM6CkBAIC00OTYsNyArNDk2LDcgQEAgc3RhdGljIHZvaWQgdmlydGlvX21t
aW9fdXBkYXRlX2lycShEZXZpY2VTdGF0ZSAqb3BhcXVlLCB1aW50MTZfdCB2ZWN0b3IpCiAgICAg
aWYgKCF2ZGV2KSB7CiAgICAgICAgIHJldHVybjsKICAgICB9Ci0gICAgbGV2ZWwgPSAoYXRvbWlj
X3JlYWQoJnZkZXYtPmlzcikgIT0gMCk7CisgICAgbGV2ZWwgPSAocWF0b21pY19yZWFkKCZ2ZGV2
LT5pc3IpICE9IDApOwogICAgIHRyYWNlX3ZpcnRpb19tbWlvX3NldHRpbmdfaXJxKGxldmVsKTsK
ICAgICBxZW11X3NldF9pcnEocHJveHktPmlycSwgbGV2ZWwpOwogfQpkaWZmIC0tZ2l0IGEvaHcv
dmlydGlvL3ZpcnRpby1wY2kuYyBiL2h3L3ZpcnRpby92aXJ0aW8tcGNpLmMKaW5kZXggNWJjNzY5
ZjY4NS4uMDI3OTBlMzIzNyAxMDA2NDQKLS0tIGEvaHcvdmlydGlvL3ZpcnRpby1wY2kuYworKysg
Yi9ody92aXJ0aW8vdmlydGlvLXBjaS5jCkBAIC03Miw3ICs3Miw3IEBAIHN0YXRpYyB2b2lkIHZp
cnRpb19wY2lfbm90aWZ5KERldmljZVN0YXRlICpkLCB1aW50MTZfdCB2ZWN0b3IpCiAgICAgICAg
IG1zaXhfbm90aWZ5KCZwcm94eS0+cGNpX2RldiwgdmVjdG9yKTsKICAgICBlbHNlIHsKICAgICAg
ICAgVmlydElPRGV2aWNlICp2ZGV2ID0gdmlydGlvX2J1c19nZXRfZGV2aWNlKCZwcm94eS0+YnVz
KTsKLSAgICAgICAgcGNpX3NldF9pcnEoJnByb3h5LT5wY2lfZGV2LCBhdG9taWNfcmVhZCgmdmRl
di0+aXNyKSAmIDEpOworICAgICAgICBwY2lfc2V0X2lycSgmcHJveHktPnBjaV9kZXYsIHFhdG9t
aWNfcmVhZCgmdmRldi0+aXNyKSAmIDEpOwogICAgIH0KIH0KIApAQCAtMzk4LDcgKzM5OCw3IEBA
IHN0YXRpYyB1aW50MzJfdCB2aXJ0aW9faW9wb3J0X3JlYWQoVmlydElPUENJUHJveHkgKnByb3h5
LCB1aW50MzJfdCBhZGRyKQogICAgICAgICBicmVhazsKICAgICBjYXNlIFZJUlRJT19QQ0lfSVNS
OgogICAgICAgICAvKiByZWFkaW5nIGZyb20gdGhlIElTUiBhbHNvIGNsZWFycyBpdC4gKi8KLSAg
ICAgICAgcmV0ID0gYXRvbWljX3hjaGcoJnZkZXYtPmlzciwgMCk7CisgICAgICAgIHJldCA9IHFh
dG9taWNfeGNoZygmdmRldi0+aXNyLCAwKTsKICAgICAgICAgcGNpX2lycV9kZWFzc2VydCgmcHJv
eHktPnBjaV9kZXYpOwogICAgICAgICBicmVhazsKICAgICBjYXNlIFZJUlRJT19NU0lfQ09ORklH
X1ZFQ1RPUjoKQEAgLTEzNjIsNyArMTM2Miw3IEBAIHN0YXRpYyB1aW50NjRfdCB2aXJ0aW9fcGNp
X2lzcl9yZWFkKHZvaWQgKm9wYXF1ZSwgaHdhZGRyIGFkZHIsCiB7CiAgICAgVmlydElPUENJUHJv
eHkgKnByb3h5ID0gb3BhcXVlOwogICAgIFZpcnRJT0RldmljZSAqdmRldiA9IHZpcnRpb19idXNf
Z2V0X2RldmljZSgmcHJveHktPmJ1cyk7Ci0gICAgdWludDY0X3QgdmFsID0gYXRvbWljX3hjaGco
JnZkZXYtPmlzciwgMCk7CisgICAgdWludDY0X3QgdmFsID0gcWF0b21pY194Y2hnKCZ2ZGV2LT5p
c3IsIDApOwogICAgIHBjaV9pcnFfZGVhc3NlcnQoJnByb3h5LT5wY2lfZGV2KTsKIAogICAgIHJl
dHVybiB2YWw7CmRpZmYgLS1naXQgYS9ody92aXJ0aW8vdmlydGlvLmMgYi9ody92aXJ0aW8vdmly
dGlvLmMKaW5kZXggZTk4MzAyNTIxNy4uM2EzZDAxMmQ5ZiAxMDA2NDQKLS0tIGEvaHcvdmlydGlv
L3ZpcnRpby5jCisrKyBiL2h3L3ZpcnRpby92aXJ0aW8uYwpAQCAtMTQ5LDggKzE0OSw4IEBAIHN0
YXRpYyB2b2lkIHZpcnRpb192aXJ0cXVldWVfcmVzZXRfcmVnaW9uX2NhY2hlKHN0cnVjdCBWaXJ0
UXVldWUgKnZxKQogewogICAgIFZSaW5nTWVtb3J5UmVnaW9uQ2FjaGVzICpjYWNoZXM7CiAKLSAg
ICBjYWNoZXMgPSBhdG9taWNfcmVhZCgmdnEtPnZyaW5nLmNhY2hlcyk7Ci0gICAgYXRvbWljX3Jj
dV9zZXQoJnZxLT52cmluZy5jYWNoZXMsIE5VTEwpOworICAgIGNhY2hlcyA9IHFhdG9taWNfcmVh
ZCgmdnEtPnZyaW5nLmNhY2hlcyk7CisgICAgcWF0b21pY19yY3Vfc2V0KCZ2cS0+dnJpbmcuY2Fj
aGVzLCBOVUxMKTsKICAgICBpZiAoY2FjaGVzKSB7CiAgICAgICAgIGNhbGxfcmN1KGNhY2hlcywg
dmlydGlvX2ZyZWVfcmVnaW9uX2NhY2hlLCByY3UpOwogICAgIH0KQEAgLTE5Nyw3ICsxOTcsNyBA
QCBzdGF0aWMgdm9pZCB2aXJ0aW9faW5pdF9yZWdpb25fY2FjaGUoVmlydElPRGV2aWNlICp2ZGV2
LCBpbnQgbikKICAgICAgICAgZ290byBlcnJfYXZhaWw7CiAgICAgfQogCi0gICAgYXRvbWljX3Jj
dV9zZXQoJnZxLT52cmluZy5jYWNoZXMsIG5ldyk7CisgICAgcWF0b21pY19yY3Vfc2V0KCZ2cS0+
dnJpbmcuY2FjaGVzLCBuZXcpOwogICAgIGlmIChvbGQpIHsKICAgICAgICAgY2FsbF9yY3Uob2xk
LCB2aXJ0aW9fZnJlZV9yZWdpb25fY2FjaGUsIHJjdSk7CiAgICAgfQpAQCAtMjgzLDcgKzI4Myw3
IEBAIHN0YXRpYyB2b2lkIHZyaW5nX3BhY2tlZF9mbGFnc193cml0ZShWaXJ0SU9EZXZpY2UgKnZk
ZXYsCiAvKiBDYWxsZWQgd2l0aGluIHJjdV9yZWFkX2xvY2soKS4gICovCiBzdGF0aWMgVlJpbmdN
ZW1vcnlSZWdpb25DYWNoZXMgKnZyaW5nX2dldF9yZWdpb25fY2FjaGVzKHN0cnVjdCBWaXJ0UXVl
dWUgKnZxKQogewotICAgIHJldHVybiBhdG9taWNfcmN1X3JlYWQoJnZxLT52cmluZy5jYWNoZXMp
OworICAgIHJldHVybiBxYXRvbWljX3JjdV9yZWFkKCZ2cS0+dnJpbmcuY2FjaGVzKTsKIH0KIAog
LyogQ2FsbGVkIHdpdGhpbiByY3VfcmVhZF9sb2NrKCkuICAqLwpAQCAtMjAwNyw3ICsyMDA3LDcg
QEAgdm9pZCB2aXJ0aW9fcmVzZXQodm9pZCAqb3BhcXVlKQogICAgIHZkZXYtPnF1ZXVlX3NlbCA9
IDA7CiAgICAgdmRldi0+c3RhdHVzID0gMDsKICAgICB2ZGV2LT5kaXNhYmxlZCA9IGZhbHNlOwot
ICAgIGF0b21pY19zZXQoJnZkZXYtPmlzciwgMCk7CisgICAgcWF0b21pY19zZXQoJnZkZXYtPmlz
ciwgMCk7CiAgICAgdmRldi0+Y29uZmlnX3ZlY3RvciA9IFZJUlRJT19OT19WRUNUT1I7CiAgICAg
dmlydGlvX25vdGlmeV92ZWN0b3IodmRldiwgdmRldi0+Y29uZmlnX3ZlY3Rvcik7CiAKQEAgLTI0
MzksMTMgKzI0MzksMTMgQEAgdm9pZCB2aXJ0aW9fZGVsX3F1ZXVlKFZpcnRJT0RldmljZSAqdmRl
diwgaW50IG4pCiAKIHN0YXRpYyB2b2lkIHZpcnRpb19zZXRfaXNyKFZpcnRJT0RldmljZSAqdmRl
diwgaW50IHZhbHVlKQogewotICAgIHVpbnQ4X3Qgb2xkID0gYXRvbWljX3JlYWQoJnZkZXYtPmlz
cik7CisgICAgdWludDhfdCBvbGQgPSBxYXRvbWljX3JlYWQoJnZkZXYtPmlzcik7CiAKICAgICAv
KiBEbyBub3Qgd3JpdGUgSVNSIGlmIGl0IGRvZXMgbm90IGNoYW5nZSwgc28gdGhhdCBpdHMgY2Fj
aGVsaW5lIHJlbWFpbnMKICAgICAgKiBzaGFyZWQgaW4gdGhlIGNvbW1vbiBjYXNlIHdoZXJlIHRo
ZSBndWVzdCBkb2VzIG5vdCByZWFkIGl0LgogICAgICAqLwogICAgIGlmICgob2xkICYgdmFsdWUp
ICE9IHZhbHVlKSB7Ci0gICAgICAgIGF0b21pY19vcigmdmRldi0+aXNyLCB2YWx1ZSk7CisgICAg
ICAgIHFhdG9taWNfb3IoJnZkZXYtPmlzciwgdmFsdWUpOwogICAgIH0KIH0KIApAQCAtMzI1NCw3
ICszMjU0LDcgQEAgdm9pZCB2aXJ0aW9faW5pdChWaXJ0SU9EZXZpY2UgKnZkZXYsIGNvbnN0IGNo
YXIgKm5hbWUsCiAgICAgdmRldi0+c3RhcnRlZCA9IGZhbHNlOwogICAgIHZkZXYtPmRldmljZV9p
ZCA9IGRldmljZV9pZDsKICAgICB2ZGV2LT5zdGF0dXMgPSAwOwotICAgIGF0b21pY19zZXQoJnZk
ZXYtPmlzciwgMCk7CisgICAgcWF0b21pY19zZXQoJnZkZXYtPmlzciwgMCk7CiAgICAgdmRldi0+
cXVldWVfc2VsID0gMDsKICAgICB2ZGV2LT5jb25maWdfdmVjdG9yID0gVklSVElPX05PX1ZFQ1RP
UjsKICAgICB2ZGV2LT52cSA9IGdfbWFsbG9jMChzaXplb2YoVmlydFF1ZXVlKSAqIFZJUlRJT19R
VUVVRV9NQVgpOwpkaWZmIC0tZ2l0IGEvaHcveHRlbnNhL3BpY19jcHUuYyBiL2h3L3h0ZW5zYS9w
aWNfY3B1LmMKaW5kZXggMWQ1OTgyYTllNC4uNmM5NDQ3NTY1ZCAxMDA2NDQKLS0tIGEvaHcveHRl
bnNhL3BpY19jcHUuYworKysgYi9ody94dGVuc2EvcGljX2NwdS5jCkBAIC03Miw5ICs3Miw5IEBA
IHN0YXRpYyB2b2lkIHh0ZW5zYV9zZXRfaXJxKHZvaWQgKm9wYXF1ZSwgaW50IGlycSwgaW50IGFj
dGl2ZSkKICAgICAgICAgdWludDMyX3QgaXJxX2JpdCA9IDEgPDwgaXJxOwogCiAgICAgICAgIGlm
IChhY3RpdmUpIHsKLSAgICAgICAgICAgIGF0b21pY19vcigmZW52LT5zcmVnc1tJTlRTRVRdLCBp
cnFfYml0KTsKKyAgICAgICAgICAgIHFhdG9taWNfb3IoJmVudi0+c3JlZ3NbSU5UU0VUXSwgaXJx
X2JpdCk7CiAgICAgICAgIH0gZWxzZSBpZiAoZW52LT5jb25maWctPmludGVycnVwdFtpcnFdLmlu
dHR5cGUgPT0gSU5UVFlQRV9MRVZFTCkgewotICAgICAgICAgICAgYXRvbWljX2FuZCgmZW52LT5z
cmVnc1tJTlRTRVRdLCB+aXJxX2JpdCk7CisgICAgICAgICAgICBxYXRvbWljX2FuZCgmZW52LT5z
cmVnc1tJTlRTRVRdLCB+aXJxX2JpdCk7CiAgICAgICAgIH0KIAogICAgICAgICBjaGVja19pbnRl
cnJ1cHRzKGVudik7CmRpZmYgLS1naXQgYS9pb3RocmVhZC5jIGIvaW90aHJlYWQuYwppbmRleCAz
YTM4NjBhMDljLi42OWVmZjllZmJjIDEwMDY0NAotLS0gYS9pb3RocmVhZC5jCisrKyBiL2lvdGhy
ZWFkLmMKQEAgLTc2LDcgKzc2LDcgQEAgc3RhdGljIHZvaWQgKmlvdGhyZWFkX3J1bih2b2lkICpv
cGFxdWUpCiAgICAgICAgICAqIFdlIG11c3QgY2hlY2sgdGhlIHJ1bm5pbmcgc3RhdGUgYWdhaW4g
aW4gY2FzZSBpdCB3YXMKICAgICAgICAgICogY2hhbmdlZCBpbiBwcmV2aW91cyBhaW9fcG9sbCgp
CiAgICAgICAgICAqLwotICAgICAgICBpZiAoaW90aHJlYWQtPnJ1bm5pbmcgJiYgYXRvbWljX3Jl
YWQoJmlvdGhyZWFkLT5ydW5fZ2NvbnRleHQpKSB7CisgICAgICAgIGlmIChpb3RocmVhZC0+cnVu
bmluZyAmJiBxYXRvbWljX3JlYWQoJmlvdGhyZWFkLT5ydW5fZ2NvbnRleHQpKSB7CiAgICAgICAg
ICAgICBnX21haW5fbG9vcF9ydW4oaW90aHJlYWQtPm1haW5fbG9vcCk7CiAgICAgICAgIH0KICAg
ICB9CkBAIC0xMTYsNyArMTE2LDcgQEAgc3RhdGljIHZvaWQgaW90aHJlYWRfaW5zdGFuY2VfaW5p
dChPYmplY3QgKm9iaikKICAgICBpb3RocmVhZC0+dGhyZWFkX2lkID0gLTE7CiAgICAgcWVtdV9z
ZW1faW5pdCgmaW90aHJlYWQtPmluaXRfZG9uZV9zZW0sIDApOwogICAgIC8qIEJ5IGRlZmF1bHQs
IHdlIGRvbid0IHJ1biBnY29udGV4dCAqLwotICAgIGF0b21pY19zZXQoJmlvdGhyZWFkLT5ydW5f
Z2NvbnRleHQsIDApOworICAgIHFhdG9taWNfc2V0KCZpb3RocmVhZC0+cnVuX2djb250ZXh0LCAw
KTsKIH0KIAogc3RhdGljIHZvaWQgaW90aHJlYWRfaW5zdGFuY2VfZmluYWxpemUoT2JqZWN0ICpv
YmopCkBAIC0zNDgsNyArMzQ4LDcgQEAgSU9UaHJlYWRJbmZvTGlzdCAqcW1wX3F1ZXJ5X2lvdGhy
ZWFkcyhFcnJvciAqKmVycnApCiAKIEdNYWluQ29udGV4dCAqaW90aHJlYWRfZ2V0X2dfbWFpbl9j
b250ZXh0KElPVGhyZWFkICppb3RocmVhZCkKIHsKLSAgICBhdG9taWNfc2V0KCZpb3RocmVhZC0+
cnVuX2djb250ZXh0LCAxKTsKKyAgICBxYXRvbWljX3NldCgmaW90aHJlYWQtPnJ1bl9nY29udGV4
dCwgMSk7CiAgICAgYWlvX25vdGlmeShpb3RocmVhZC0+Y3R4KTsKICAgICByZXR1cm4gaW90aHJl
YWQtPndvcmtlcl9jb250ZXh0OwogfQpkaWZmIC0tZ2l0IGEvbGludXgtdXNlci9ocHBhL2NwdV9s
b29wLmMgYi9saW51eC11c2VyL2hwcGEvY3B1X2xvb3AuYwppbmRleCA5OTE1NDU2YTFkLi5kN2Ux
ZWM3NzIyIDEwMDY0NAotLS0gYS9saW51eC11c2VyL2hwcGEvY3B1X2xvb3AuYworKysgYi9saW51
eC11c2VyL2hwcGEvY3B1X2xvb3AuYwpAQCAtMzksNyArMzksNyBAQCBzdGF0aWMgYWJpX3Vsb25n
IGhwcGFfbHdzKENQVUhQUEFTdGF0ZSAqZW52KQogICAgICAgICB9CiAgICAgICAgIG9sZCA9IHRz
d2FwMzIob2xkKTsKICAgICAgICAgbmV3ID0gdHN3YXAzMihuZXcpOwotICAgICAgICByZXQgPSBh
dG9taWNfY21weGNoZygodWludDMyX3QgKilnMmgoYWRkciksIG9sZCwgbmV3KTsKKyAgICAgICAg
cmV0ID0gcWF0b21pY19jbXB4Y2hnKCh1aW50MzJfdCAqKWcyaChhZGRyKSwgb2xkLCBuZXcpOwog
ICAgICAgICByZXQgPSB0c3dhcDMyKHJldCk7CiAgICAgICAgIGJyZWFrOwogCkBAIC02MCwxOSAr
NjAsMTkgQEAgc3RhdGljIGFiaV91bG9uZyBocHBhX2x3cyhDUFVIUFBBU3RhdGUgKmVudikKICAg
ICAgICAgY2FzZSAwOgogICAgICAgICAgICAgb2xkID0gKih1aW50OF90ICopZzJoKG9sZCk7CiAg
ICAgICAgICAgICBuZXcgPSAqKHVpbnQ4X3QgKilnMmgobmV3KTsKLSAgICAgICAgICAgIHJldCA9
IGF0b21pY19jbXB4Y2hnKCh1aW50OF90ICopZzJoKGFkZHIpLCBvbGQsIG5ldyk7CisgICAgICAg
ICAgICByZXQgPSBxYXRvbWljX2NtcHhjaGcoKHVpbnQ4X3QgKilnMmgoYWRkciksIG9sZCwgbmV3
KTsKICAgICAgICAgICAgIHJldCA9IHJldCAhPSBvbGQ7CiAgICAgICAgICAgICBicmVhazsKICAg
ICAgICAgY2FzZSAxOgogICAgICAgICAgICAgb2xkID0gKih1aW50MTZfdCAqKWcyaChvbGQpOwog
ICAgICAgICAgICAgbmV3ID0gKih1aW50MTZfdCAqKWcyaChuZXcpOwotICAgICAgICAgICAgcmV0
ID0gYXRvbWljX2NtcHhjaGcoKHVpbnQxNl90ICopZzJoKGFkZHIpLCBvbGQsIG5ldyk7CisgICAg
ICAgICAgICByZXQgPSBxYXRvbWljX2NtcHhjaGcoKHVpbnQxNl90ICopZzJoKGFkZHIpLCBvbGQs
IG5ldyk7CiAgICAgICAgICAgICByZXQgPSByZXQgIT0gb2xkOwogICAgICAgICAgICAgYnJlYWs7
CiAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgIG9sZCA9ICoodWludDMyX3QgKilnMmgob2xk
KTsKICAgICAgICAgICAgIG5ldyA9ICoodWludDMyX3QgKilnMmgobmV3KTsKLSAgICAgICAgICAg
IHJldCA9IGF0b21pY19jbXB4Y2hnKCh1aW50MzJfdCAqKWcyaChhZGRyKSwgb2xkLCBuZXcpOwor
ICAgICAgICAgICAgcmV0ID0gcWF0b21pY19jbXB4Y2hnKCh1aW50MzJfdCAqKWcyaChhZGRyKSwg
b2xkLCBuZXcpOwogICAgICAgICAgICAgcmV0ID0gcmV0ICE9IG9sZDsKICAgICAgICAgICAgIGJy
ZWFrOwogICAgICAgICBjYXNlIDM6CkBAIC04MSw3ICs4MSw4IEBAIHN0YXRpYyBhYmlfdWxvbmcg
aHBwYV9sd3MoQ1BVSFBQQVN0YXRlICplbnYpCiAgICAgICAgICAgICAgICAgbzY0ID0gKih1aW50
NjRfdCAqKWcyaChvbGQpOwogICAgICAgICAgICAgICAgIG42NCA9ICoodWludDY0X3QgKilnMmgo
bmV3KTsKICNpZmRlZiBDT05GSUdfQVRPTUlDNjQKLSAgICAgICAgICAgICAgICByNjQgPSBhdG9t
aWNfY21weGNoZ19fbm9jaGVjaygodWludDY0X3QgKilnMmgoYWRkciksIG82NCwgbjY0KTsKKyAg
ICAgICAgICAgICAgICByNjQgPSBxYXRvbWljX2NtcHhjaGdfX25vY2hlY2soKHVpbnQ2NF90ICop
ZzJoKGFkZHIpLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBvNjQsIG42NCk7CiAgICAgICAgICAgICAgICAgcmV0ID0gcjY0ICE9IG82NDsKICNlbHNlCiAg
ICAgICAgICAgICAgICAgc3RhcnRfZXhjbHVzaXZlKCk7CmRpZmYgLS1naXQgYS9saW51eC11c2Vy
L3NpZ25hbC5jIGIvbGludXgtdXNlci9zaWduYWwuYwppbmRleCA4Y2Y1MWZmZWNkLi43M2RlOTM0
YzY1IDEwMDY0NAotLS0gYS9saW51eC11c2VyL3NpZ25hbC5jCisrKyBiL2xpbnV4LXVzZXIvc2ln
bmFsLmMKQEAgLTE5NSw3ICsxOTUsNyBAQCBpbnQgYmxvY2tfc2lnbmFscyh2b2lkKQogICAgIHNp
Z2ZpbGxzZXQoJnNldCk7CiAgICAgc2lncHJvY21hc2soU0lHX1NFVE1BU0ssICZzZXQsIDApOwog
Ci0gICAgcmV0dXJuIGF0b21pY194Y2hnKCZ0cy0+c2lnbmFsX3BlbmRpbmcsIDEpOworICAgIHJl
dHVybiBxYXRvbWljX3hjaGcoJnRzLT5zaWduYWxfcGVuZGluZywgMSk7CiB9CiAKIC8qIFdyYXBw
ZXIgZm9yIHNpZ3Byb2NtYXNrIGZ1bmN0aW9uCkBAIC02ODgsNyArNjg4LDcgQEAgaW50IHF1ZXVl
X3NpZ25hbChDUFVBcmNoU3RhdGUgKmVudiwgaW50IHNpZywgaW50IHNpX3R5cGUsCiAgICAgdHMt
PnN5bmNfc2lnbmFsLmluZm8gPSAqaW5mbzsKICAgICB0cy0+c3luY19zaWduYWwucGVuZGluZyA9
IHNpZzsKICAgICAvKiBzaWduYWwgdGhhdCBhIG5ldyBzaWduYWwgaXMgcGVuZGluZyAqLwotICAg
IGF0b21pY19zZXQoJnRzLT5zaWduYWxfcGVuZGluZywgMSk7CisgICAgcWF0b21pY19zZXQoJnRz
LT5zaWduYWxfcGVuZGluZywgMSk7CiAgICAgcmV0dXJuIDE7IC8qIGluZGljYXRlcyB0aGF0IHRo
ZSBzaWduYWwgd2FzIHF1ZXVlZCAqLwogfQogCkBAIC0xMDA1LDcgKzEwMDUsNyBAQCB2b2lkIHBy
b2Nlc3NfcGVuZGluZ19zaWduYWxzKENQVUFyY2hTdGF0ZSAqY3B1X2VudikKICAgICBzaWdzZXRf
dCBzZXQ7CiAgICAgc2lnc2V0X3QgKmJsb2NrZWRfc2V0OwogCi0gICAgd2hpbGUgKGF0b21pY19y
ZWFkKCZ0cy0+c2lnbmFsX3BlbmRpbmcpKSB7CisgICAgd2hpbGUgKHFhdG9taWNfcmVhZCgmdHMt
PnNpZ25hbF9wZW5kaW5nKSkgewogICAgICAgICAvKiBGSVhNRTogVGhpcyBpcyBub3QgdGhyZWFk
c2FmZS4gICovCiAgICAgICAgIHNpZ2ZpbGxzZXQoJnNldCk7CiAgICAgICAgIHNpZ3Byb2NtYXNr
KFNJR19TRVRNQVNLLCAmc2V0LCAwKTsKQEAgLTEwNDksNyArMTA0OSw3IEBAIHZvaWQgcHJvY2Vz
c19wZW5kaW5nX3NpZ25hbHMoQ1BVQXJjaFN0YXRlICpjcHVfZW52KQogICAgICAgICAgKiBvZiB1
bmJsb2NraW5nIG1pZ2h0IGNhdXNlIHVzIHRvIHRha2UgYW5vdGhlciBob3N0IHNpZ25hbCB3aGlj
aAogICAgICAgICAgKiB3aWxsIHNldCBzaWduYWxfcGVuZGluZyBhZ2FpbikuCiAgICAgICAgICAq
LwotICAgICAgICBhdG9taWNfc2V0KCZ0cy0+c2lnbmFsX3BlbmRpbmcsIDApOworICAgICAgICBx
YXRvbWljX3NldCgmdHMtPnNpZ25hbF9wZW5kaW5nLCAwKTsKICAgICAgICAgdHMtPmluX3NpZ3N1
c3BlbmQgPSAwOwogICAgICAgICBzZXQgPSB0cy0+c2lnbmFsX21hc2s7CiAgICAgICAgIHNpZ2Rl
bHNldCgmc2V0LCBTSUdTRUdWKTsKZGlmZiAtLWdpdCBhL21pZ3JhdGlvbi9jb2xvLWZhaWxvdmVy
LmMgYi9taWdyYXRpb24vY29sby1mYWlsb3Zlci5jCmluZGV4IGI3MTdlZGM4ZTIuLjQyNDUzNDgx
YzQgMTAwNjQ0Ci0tLSBhL21pZ3JhdGlvbi9jb2xvLWZhaWxvdmVyLmMKKysrIGIvbWlncmF0aW9u
L2NvbG8tZmFpbG92ZXIuYwpAQCAtNjMsNyArNjMsNyBAQCBGYWlsb3ZlclN0YXR1cyBmYWlsb3Zl
cl9zZXRfc3RhdGUoRmFpbG92ZXJTdGF0dXMgb2xkX3N0YXRlLAogewogICAgIEZhaWxvdmVyU3Rh
dHVzIG9sZDsKIAotICAgIG9sZCA9IGF0b21pY19jbXB4Y2hnKCZmYWlsb3Zlcl9zdGF0ZSwgb2xk
X3N0YXRlLCBuZXdfc3RhdGUpOworICAgIG9sZCA9IHFhdG9taWNfY21weGNoZygmZmFpbG92ZXJf
c3RhdGUsIG9sZF9zdGF0ZSwgbmV3X3N0YXRlKTsKICAgICBpZiAob2xkID09IG9sZF9zdGF0ZSkg
ewogICAgICAgICB0cmFjZV9jb2xvX2ZhaWxvdmVyX3NldF9zdGF0ZShGYWlsb3ZlclN0YXR1c19z
dHIobmV3X3N0YXRlKSk7CiAgICAgfQpAQCAtNzIsNyArNzIsNyBAQCBGYWlsb3ZlclN0YXR1cyBm
YWlsb3Zlcl9zZXRfc3RhdGUoRmFpbG92ZXJTdGF0dXMgb2xkX3N0YXRlLAogCiBGYWlsb3ZlclN0
YXR1cyBmYWlsb3Zlcl9nZXRfc3RhdGUodm9pZCkKIHsKLSAgICByZXR1cm4gYXRvbWljX3JlYWQo
JmZhaWxvdmVyX3N0YXRlKTsKKyAgICByZXR1cm4gcWF0b21pY19yZWFkKCZmYWlsb3Zlcl9zdGF0
ZSk7CiB9CiAKIHZvaWQgcW1wX3hfY29sb19sb3N0X2hlYXJ0YmVhdChFcnJvciAqKmVycnApCmRp
ZmYgLS1naXQgYS9taWdyYXRpb24vbWlncmF0aW9uLmMgYi9taWdyYXRpb24vbWlncmF0aW9uLmMK
aW5kZXggNThhNTQ1MjQ3MS4uZDlkMWUwYjE5MCAxMDA2NDQKLS0tIGEvbWlncmF0aW9uL21pZ3Jh
dGlvbi5jCisrKyBiL21pZ3JhdGlvbi9taWdyYXRpb24uYwpAQCAtMTU5NSw3ICsxNTk1LDcgQEAg
dm9pZCBxbXBfbWlncmF0ZV9zdGFydF9wb3N0Y29weShFcnJvciAqKmVycnApCiAgICAgICogd2Ug
ZG9uJ3QgZXJyb3IgaWYgbWlncmF0aW9uIGhhcyBmaW5pc2hlZCBzaW5jZSB0aGF0IHdvdWxkIGJl
IHJhY3kKICAgICAgKiB3aXRoIGlzc3VpbmcgdGhpcyBjb21tYW5kLgogICAgICAqLwotICAgIGF0
b21pY19zZXQoJnMtPnN0YXJ0X3Bvc3Rjb3B5LCB0cnVlKTsKKyAgICBxYXRvbWljX3NldCgmcy0+
c3RhcnRfcG9zdGNvcHksIHRydWUpOwogfQogCiAvKiBzaGFyZWQgbWlncmF0aW9uIGhlbHBlcnMg
Ki8KQEAgLTE2MDMsNyArMTYwMyw3IEBAIHZvaWQgcW1wX21pZ3JhdGVfc3RhcnRfcG9zdGNvcHko
RXJyb3IgKiplcnJwKQogdm9pZCBtaWdyYXRlX3NldF9zdGF0ZShpbnQgKnN0YXRlLCBpbnQgb2xk
X3N0YXRlLCBpbnQgbmV3X3N0YXRlKQogewogICAgIGFzc2VydChuZXdfc3RhdGUgPCBNSUdSQVRJ
T05fU1RBVFVTX19NQVgpOwotICAgIGlmIChhdG9taWNfY21weGNoZyhzdGF0ZSwgb2xkX3N0YXRl
LCBuZXdfc3RhdGUpID09IG9sZF9zdGF0ZSkgeworICAgIGlmIChxYXRvbWljX2NtcHhjaGcoc3Rh
dGUsIG9sZF9zdGF0ZSwgbmV3X3N0YXRlKSA9PSBvbGRfc3RhdGUpIHsKICAgICAgICAgdHJhY2Vf
bWlncmF0ZV9zZXRfc3RhdGUoTWlncmF0aW9uU3RhdHVzX3N0cihuZXdfc3RhdGUpKTsKICAgICAg
ICAgbWlncmF0ZV9nZW5lcmF0ZV9ldmVudChuZXdfc3RhdGUpOwogICAgIH0KQEAgLTE5NTQsNyAr
MTk1NCw3IEBAIHZvaWQgcW1wX21pZ3JhdGVfcmVjb3Zlcihjb25zdCBjaGFyICp1cmksIEVycm9y
ICoqZXJycCkKICAgICAgICAgcmV0dXJuOwogICAgIH0KIAotICAgIGlmIChhdG9taWNfY21weGNo
ZygmbWlzLT5wb3N0Y29weV9yZWNvdmVyX3RyaWdnZXJlZCwKKyAgICBpZiAocWF0b21pY19jbXB4
Y2hnKCZtaXMtPnBvc3Rjb3B5X3JlY292ZXJfdHJpZ2dlcmVkLAogICAgICAgICAgICAgICAgICAg
ICAgICBmYWxzZSwgdHJ1ZSkgPT0gdHJ1ZSkgewogICAgICAgICBlcnJvcl9zZXRnKGVycnAsICJN
aWdyYXRlIHJlY292ZXJ5IGlzIHRyaWdnZXJlZCBhbHJlYWR5Iik7CiAgICAgICAgIHJldHVybjsK
QEAgLTMzMjksNyArMzMyOSw3IEBAIHN0YXRpYyBNaWdJdGVyYXRlU3RhdGUgbWlncmF0aW9uX2l0
ZXJhdGlvbl9ydW4oTWlncmF0aW9uU3RhdGUgKnMpCiAgICAgaWYgKHBlbmRpbmdfc2l6ZSAmJiBw
ZW5kaW5nX3NpemUgPj0gcy0+dGhyZXNob2xkX3NpemUpIHsKICAgICAgICAgLyogU3RpbGwgYSBz
aWduaWZpY2FudCBhbW91bnQgdG8gdHJhbnNmZXIgKi8KICAgICAgICAgaWYgKCFpbl9wb3N0Y29w
eSAmJiBwZW5kX3ByZSA8PSBzLT50aHJlc2hvbGRfc2l6ZSAmJgotICAgICAgICAgICAgYXRvbWlj
X3JlYWQoJnMtPnN0YXJ0X3Bvc3Rjb3B5KSkgeworICAgICAgICAgICAgcWF0b21pY19yZWFkKCZz
LT5zdGFydF9wb3N0Y29weSkpIHsKICAgICAgICAgICAgIGlmIChwb3N0Y29weV9zdGFydChzKSkg
ewogICAgICAgICAgICAgICAgIGVycm9yX3JlcG9ydCgiJXM6IHBvc3Rjb3B5IGZhaWxlZCB0byBz
dGFydCIsIF9fZnVuY19fKTsKICAgICAgICAgICAgIH0KZGlmZiAtLWdpdCBhL21pZ3JhdGlvbi9t
dWx0aWZkLmMgYi9taWdyYXRpb24vbXVsdGlmZC5jCmluZGV4IGFjODRhNjE3OTcuLmZkNTczNzhk
YjggMTAwNjQ0Ci0tLSBhL21pZ3JhdGlvbi9tdWx0aWZkLmMKKysrIGIvbWlncmF0aW9uL211bHRp
ZmQuYwpAQCAtNDEwLDcgKzQxMCw3IEBAIHN0YXRpYyBpbnQgbXVsdGlmZF9zZW5kX3BhZ2VzKFFF
TVVGaWxlICpmKQogICAgIE11bHRpRkRQYWdlc190ICpwYWdlcyA9IG11bHRpZmRfc2VuZF9zdGF0
ZS0+cGFnZXM7CiAgICAgdWludDY0X3QgdHJhbnNmZXJyZWQ7CiAKLSAgICBpZiAoYXRvbWljX3Jl
YWQoJm11bHRpZmRfc2VuZF9zdGF0ZS0+ZXhpdGluZykpIHsKKyAgICBpZiAocWF0b21pY19yZWFk
KCZtdWx0aWZkX3NlbmRfc3RhdGUtPmV4aXRpbmcpKSB7CiAgICAgICAgIHJldHVybiAtMTsKICAg
ICB9CiAKQEAgLTUwOCw3ICs1MDgsNyBAQCBzdGF0aWMgdm9pZCBtdWx0aWZkX3NlbmRfdGVybWlu
YXRlX3RocmVhZHMoRXJyb3IgKmVycikKICAgICAgKiB0aHJlYWRzIGF0IHRoZSBzYW1lIHRpbWUs
IHdlIGNhbiBlbmQgY2FsbGluZyB0aGlzIGZ1bmN0aW9uCiAgICAgICogdHdpY2UuCiAgICAgICov
Ci0gICAgaWYgKGF0b21pY194Y2hnKCZtdWx0aWZkX3NlbmRfc3RhdGUtPmV4aXRpbmcsIDEpKSB7
CisgICAgaWYgKHFhdG9taWNfeGNoZygmbXVsdGlmZF9zZW5kX3N0YXRlLT5leGl0aW5nLCAxKSkg
ewogICAgICAgICByZXR1cm47CiAgICAgfQogCkBAIC02MzIsNyArNjMyLDcgQEAgc3RhdGljIHZv
aWQgKm11bHRpZmRfc2VuZF90aHJlYWQodm9pZCAqb3BhcXVlKQogICAgIHdoaWxlICh0cnVlKSB7
CiAgICAgICAgIHFlbXVfc2VtX3dhaXQoJnAtPnNlbSk7CiAKLSAgICAgICAgaWYgKGF0b21pY19y
ZWFkKCZtdWx0aWZkX3NlbmRfc3RhdGUtPmV4aXRpbmcpKSB7CisgICAgICAgIGlmIChxYXRvbWlj
X3JlYWQoJm11bHRpZmRfc2VuZF9zdGF0ZS0+ZXhpdGluZykpIHsKICAgICAgICAgICAgIGJyZWFr
OwogICAgICAgICB9CiAgICAgICAgIHFlbXVfbXV0ZXhfbG9jaygmcC0+bXV0ZXgpOwpAQCAtNzYw
LDcgKzc2MCw3IEBAIGludCBtdWx0aWZkX3NhdmVfc2V0dXAoRXJyb3IgKiplcnJwKQogICAgIG11
bHRpZmRfc2VuZF9zdGF0ZS0+cGFyYW1zID0gZ19uZXcwKE11bHRpRkRTZW5kUGFyYW1zLCB0aHJl
YWRfY291bnQpOwogICAgIG11bHRpZmRfc2VuZF9zdGF0ZS0+cGFnZXMgPSBtdWx0aWZkX3BhZ2Vz
X2luaXQocGFnZV9jb3VudCk7CiAgICAgcWVtdV9zZW1faW5pdCgmbXVsdGlmZF9zZW5kX3N0YXRl
LT5jaGFubmVsc19yZWFkeSwgMCk7Ci0gICAgYXRvbWljX3NldCgmbXVsdGlmZF9zZW5kX3N0YXRl
LT5leGl0aW5nLCAwKTsKKyAgICBxYXRvbWljX3NldCgmbXVsdGlmZF9zZW5kX3N0YXRlLT5leGl0
aW5nLCAwKTsKICAgICBtdWx0aWZkX3NlbmRfc3RhdGUtPm9wcyA9IG11bHRpZmRfb3BzW21pZ3Jh
dGVfbXVsdGlmZF9jb21wcmVzc2lvbigpXTsKIAogICAgIGZvciAoaSA9IDA7IGkgPCB0aHJlYWRf
Y291bnQ7IGkrKykgewpAQCAtOTk3LDcgKzk5Nyw3IEBAIGludCBtdWx0aWZkX2xvYWRfc2V0dXAo
RXJyb3IgKiplcnJwKQogICAgIHRocmVhZF9jb3VudCA9IG1pZ3JhdGVfbXVsdGlmZF9jaGFubmVs
cygpOwogICAgIG11bHRpZmRfcmVjdl9zdGF0ZSA9IGdfbWFsbG9jMChzaXplb2YoKm11bHRpZmRf
cmVjdl9zdGF0ZSkpOwogICAgIG11bHRpZmRfcmVjdl9zdGF0ZS0+cGFyYW1zID0gZ19uZXcwKE11
bHRpRkRSZWN2UGFyYW1zLCB0aHJlYWRfY291bnQpOwotICAgIGF0b21pY19zZXQoJm11bHRpZmRf
cmVjdl9zdGF0ZS0+Y291bnQsIDApOworICAgIHFhdG9taWNfc2V0KCZtdWx0aWZkX3JlY3Zfc3Rh
dGUtPmNvdW50LCAwKTsKICAgICBxZW11X3NlbV9pbml0KCZtdWx0aWZkX3JlY3Zfc3RhdGUtPnNl
bV9zeW5jLCAwKTsKICAgICBtdWx0aWZkX3JlY3Zfc3RhdGUtPm9wcyA9IG11bHRpZmRfb3BzW21p
Z3JhdGVfbXVsdGlmZF9jb21wcmVzc2lvbigpXTsKIApAQCAtMTAzNyw3ICsxMDM3LDcgQEAgYm9v
bCBtdWx0aWZkX3JlY3ZfYWxsX2NoYW5uZWxzX2NyZWF0ZWQodm9pZCkKICAgICAgICAgcmV0dXJu
IHRydWU7CiAgICAgfQogCi0gICAgcmV0dXJuIHRocmVhZF9jb3VudCA9PSBhdG9taWNfcmVhZCgm
bXVsdGlmZF9yZWN2X3N0YXRlLT5jb3VudCk7CisgICAgcmV0dXJuIHRocmVhZF9jb3VudCA9PSBx
YXRvbWljX3JlYWQoJm11bHRpZmRfcmVjdl9zdGF0ZS0+Y291bnQpOwogfQogCiAvKgpAQCAtMTA1
OCw3ICsxMDU4LDcgQEAgYm9vbCBtdWx0aWZkX3JlY3ZfbmV3X2NoYW5uZWwoUUlPQ2hhbm5lbCAq
aW9jLCBFcnJvciAqKmVycnApCiAgICAgICAgIGVycm9yX3Byb3BhZ2F0ZV9wcmVwZW5kKGVycnAs
IGxvY2FsX2VyciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImZhaWxlZCB0byBy
ZWNlaXZlIHBhY2tldCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiB2aWEgbXVs
dGlmZCBjaGFubmVsICVkOiAiLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdG9t
aWNfcmVhZCgmbXVsdGlmZF9yZWN2X3N0YXRlLT5jb3VudCkpOworICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBxYXRvbWljX3JlYWQoJm11bHRpZmRfcmVjdl9zdGF0ZS0+Y291bnQpKTsK
ICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgIH0KICAgICB0cmFjZV9tdWx0aWZkX3JlY3ZfbmV3
X2NoYW5uZWwoaWQpOwpAQCAtMTA3OSw3ICsxMDc5LDcgQEAgYm9vbCBtdWx0aWZkX3JlY3ZfbmV3
X2NoYW5uZWwoUUlPQ2hhbm5lbCAqaW9jLCBFcnJvciAqKmVycnApCiAgICAgcC0+cnVubmluZyA9
IHRydWU7CiAgICAgcWVtdV90aHJlYWRfY3JlYXRlKCZwLT50aHJlYWQsIHAtPm5hbWUsIG11bHRp
ZmRfcmVjdl90aHJlYWQsIHAsCiAgICAgICAgICAgICAgICAgICAgICAgIFFFTVVfVEhSRUFEX0pP
SU5BQkxFKTsKLSAgICBhdG9taWNfaW5jKCZtdWx0aWZkX3JlY3Zfc3RhdGUtPmNvdW50KTsKLSAg
ICByZXR1cm4gYXRvbWljX3JlYWQoJm11bHRpZmRfcmVjdl9zdGF0ZS0+Y291bnQpID09CisgICAg
cWF0b21pY19pbmMoJm11bHRpZmRfcmVjdl9zdGF0ZS0+Y291bnQpOworICAgIHJldHVybiBxYXRv
bWljX3JlYWQoJm11bHRpZmRfcmVjdl9zdGF0ZS0+Y291bnQpID09CiAgICAgICAgICAgIG1pZ3Jh
dGVfbXVsdGlmZF9jaGFubmVscygpOwogfQpkaWZmIC0tZ2l0IGEvbWlncmF0aW9uL3Bvc3Rjb3B5
LXJhbS5jIGIvbWlncmF0aW9uL3Bvc3Rjb3B5LXJhbS5jCmluZGV4IGJhZjA5NGJhM2EuLjE2NTRm
ZjExYTUgMTAwNjQ0Ci0tLSBhL21pZ3JhdGlvbi9wb3N0Y29weS1yYW0uYworKysgYi9taWdyYXRp
b24vcG9zdGNvcHktcmFtLmMKQEAgLTUzMCw3ICs1MzAsNyBAQCBpbnQgcG9zdGNvcHlfcmFtX2lu
Y29taW5nX2NsZWFudXAoTWlncmF0aW9uSW5jb21pbmdTdGF0ZSAqbWlzKQogICAgICAgICBFcnJv
ciAqbG9jYWxfZXJyID0gTlVMTDsKIAogICAgICAgICAvKiBMZXQgdGhlIGZhdWx0IHRocmVhZCBx
dWl0ICovCi0gICAgICAgIGF0b21pY19zZXQoJm1pcy0+ZmF1bHRfdGhyZWFkX3F1aXQsIDEpOwor
ICAgICAgICBxYXRvbWljX3NldCgmbWlzLT5mYXVsdF90aHJlYWRfcXVpdCwgMSk7CiAgICAgICAg
IHBvc3Rjb3B5X2ZhdWx0X3RocmVhZF9ub3RpZnkobWlzKTsKICAgICAgICAgdHJhY2VfcG9zdGNv
cHlfcmFtX2luY29taW5nX2NsZWFudXBfam9pbigpOwogICAgICAgICBxZW11X3RocmVhZF9qb2lu
KCZtaXMtPmZhdWx0X3RocmVhZCk7CkBAIC03NDIsMTIgKzc0MiwxMiBAQCBzdGF0aWMgdm9pZCBt
YXJrX3Bvc3Rjb3B5X2Jsb2NrdGltZV9iZWdpbih1aW50cHRyX3QgYWRkciwgdWludDMyX3QgcHRp
ZCwKIAogICAgIGxvd190aW1lX29mZnNldCA9IGdldF9sb3dfdGltZV9vZmZzZXQoZGMpOwogICAg
IGlmIChkYy0+dmNwdV9hZGRyW2NwdV0gPT0gMCkgewotICAgICAgICBhdG9taWNfaW5jKCZkYy0+
c21wX2NwdXNfZG93bik7CisgICAgICAgIHFhdG9taWNfaW5jKCZkYy0+c21wX2NwdXNfZG93bik7
CiAgICAgfQogCi0gICAgYXRvbWljX3hjaGcoJmRjLT5sYXN0X2JlZ2luLCBsb3dfdGltZV9vZmZz
ZXQpOwotICAgIGF0b21pY194Y2hnKCZkYy0+cGFnZV9mYXVsdF92Y3B1X3RpbWVbY3B1XSwgbG93
X3RpbWVfb2Zmc2V0KTsKLSAgICBhdG9taWNfeGNoZygmZGMtPnZjcHVfYWRkcltjcHVdLCBhZGRy
KTsKKyAgICBxYXRvbWljX3hjaGcoJmRjLT5sYXN0X2JlZ2luLCBsb3dfdGltZV9vZmZzZXQpOwor
ICAgIHFhdG9taWNfeGNoZygmZGMtPnBhZ2VfZmF1bHRfdmNwdV90aW1lW2NwdV0sIGxvd190aW1l
X29mZnNldCk7CisgICAgcWF0b21pY194Y2hnKCZkYy0+dmNwdV9hZGRyW2NwdV0sIGFkZHIpOwog
CiAgICAgLyoKICAgICAgKiBjaGVjayBpdCBoZXJlLCBub3QgYXQgdGhlIGJlZ2lubmluZyBvZiB0
aGUgZnVuY3Rpb24sCkBAIC03NTYsOSArNzU2LDkgQEAgc3RhdGljIHZvaWQgbWFya19wb3N0Y29w
eV9ibG9ja3RpbWVfYmVnaW4odWludHB0cl90IGFkZHIsIHVpbnQzMl90IHB0aWQsCiAgICAgICov
CiAgICAgYWxyZWFkeV9yZWNlaXZlZCA9IHJhbWJsb2NrX3JlY3ZfYml0bWFwX3Rlc3QocmIsICh2
b2lkICopYWRkcik7CiAgICAgaWYgKGFscmVhZHlfcmVjZWl2ZWQpIHsKLSAgICAgICAgYXRvbWlj
X3hjaGcoJmRjLT52Y3B1X2FkZHJbY3B1XSwgMCk7Ci0gICAgICAgIGF0b21pY194Y2hnKCZkYy0+
cGFnZV9mYXVsdF92Y3B1X3RpbWVbY3B1XSwgMCk7Ci0gICAgICAgIGF0b21pY19kZWMoJmRjLT5z
bXBfY3B1c19kb3duKTsKKyAgICAgICAgcWF0b21pY194Y2hnKCZkYy0+dmNwdV9hZGRyW2NwdV0s
IDApOworICAgICAgICBxYXRvbWljX3hjaGcoJmRjLT5wYWdlX2ZhdWx0X3ZjcHVfdGltZVtjcHVd
LCAwKTsKKyAgICAgICAgcWF0b21pY19kZWMoJmRjLT5zbXBfY3B1c19kb3duKTsKICAgICB9CiAg
ICAgdHJhY2VfbWFya19wb3N0Y29weV9ibG9ja3RpbWVfYmVnaW4oYWRkciwgZGMsIGRjLT5wYWdl
X2ZhdWx0X3ZjcHVfdGltZVtjcHVdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGNwdSwgYWxyZWFkeV9yZWNlaXZlZCk7CkBAIC04MTMsMjggKzgxMywyOCBAQCBzdGF0
aWMgdm9pZCBtYXJrX3Bvc3Rjb3B5X2Jsb2NrdGltZV9lbmQodWludHB0cl90IGFkZHIpCiAgICAg
Zm9yIChpID0gMDsgaSA8IHNtcF9jcHVzOyBpKyspIHsKICAgICAgICAgdWludDMyX3QgdmNwdV9i
bG9ja3RpbWUgPSAwOwogCi0gICAgICAgIHJlYWRfdmNwdV90aW1lID0gYXRvbWljX2ZldGNoX2Fk
ZCgmZGMtPnBhZ2VfZmF1bHRfdmNwdV90aW1lW2ldLCAwKTsKLSAgICAgICAgaWYgKGF0b21pY19m
ZXRjaF9hZGQoJmRjLT52Y3B1X2FkZHJbaV0sIDApICE9IGFkZHIgfHwKKyAgICAgICAgcmVhZF92
Y3B1X3RpbWUgPSBxYXRvbWljX2ZldGNoX2FkZCgmZGMtPnBhZ2VfZmF1bHRfdmNwdV90aW1lW2ld
LCAwKTsKKyAgICAgICAgaWYgKHFhdG9taWNfZmV0Y2hfYWRkKCZkYy0+dmNwdV9hZGRyW2ldLCAw
KSAhPSBhZGRyIHx8CiAgICAgICAgICAgICByZWFkX3ZjcHVfdGltZSA9PSAwKSB7CiAgICAgICAg
ICAgICBjb250aW51ZTsKICAgICAgICAgfQotICAgICAgICBhdG9taWNfeGNoZygmZGMtPnZjcHVf
YWRkcltpXSwgMCk7CisgICAgICAgIHFhdG9taWNfeGNoZygmZGMtPnZjcHVfYWRkcltpXSwgMCk7
CiAgICAgICAgIHZjcHVfYmxvY2t0aW1lID0gbG93X3RpbWVfb2Zmc2V0IC0gcmVhZF92Y3B1X3Rp
bWU7CiAgICAgICAgIGFmZmVjdGVkX2NwdSArPSAxOwogICAgICAgICAvKiB3ZSBuZWVkIHRvIGtu
b3cgaXMgdGhhdCBtYXJrX3Bvc3Rjb3B5X2VuZCB3YXMgZHVlIHRvCiAgICAgICAgICAqIGZhdWx0
ZWQgcGFnZSwgYW5vdGhlciBwb3NzaWJsZSBjYXNlIGl0J3MgcHJlZmV0Y2hlZAogICAgICAgICAg
KiBwYWdlIGFuZCBpbiB0aGF0IGNhc2Ugd2Ugc2hvdWxkbid0IGJlIGhlcmUgKi8KICAgICAgICAg
aWYgKCF2Y3B1X3RvdGFsX2Jsb2NrdGltZSAmJgotICAgICAgICAgICAgYXRvbWljX2ZldGNoX2Fk
ZCgmZGMtPnNtcF9jcHVzX2Rvd24sIDApID09IHNtcF9jcHVzKSB7CisgICAgICAgICAgICBxYXRv
bWljX2ZldGNoX2FkZCgmZGMtPnNtcF9jcHVzX2Rvd24sIDApID09IHNtcF9jcHVzKSB7CiAgICAg
ICAgICAgICB2Y3B1X3RvdGFsX2Jsb2NrdGltZSA9IHRydWU7CiAgICAgICAgIH0KICAgICAgICAg
LyogY29udGludWUgY3ljbGUsIGR1ZSB0byBvbmUgcGFnZSBjb3VsZCBhZmZlY3Qgc2V2ZXJhbCB2
Q1BVcyAqLwogICAgICAgICBkYy0+dmNwdV9ibG9ja3RpbWVbaV0gKz0gdmNwdV9ibG9ja3RpbWU7
CiAgICAgfQogCi0gICAgYXRvbWljX3N1YigmZGMtPnNtcF9jcHVzX2Rvd24sIGFmZmVjdGVkX2Nw
dSk7CisgICAgcWF0b21pY19zdWIoJmRjLT5zbXBfY3B1c19kb3duLCBhZmZlY3RlZF9jcHUpOwog
ICAgIGlmICh2Y3B1X3RvdGFsX2Jsb2NrdGltZSkgewotICAgICAgICBkYy0+dG90YWxfYmxvY2t0
aW1lICs9IGxvd190aW1lX29mZnNldCAtIGF0b21pY19mZXRjaF9hZGQoCisgICAgICAgIGRjLT50
b3RhbF9ibG9ja3RpbWUgKz0gbG93X3RpbWVfb2Zmc2V0IC0gcWF0b21pY19mZXRjaF9hZGQoCiAg
ICAgICAgICAgICAgICAgJmRjLT5sYXN0X2JlZ2luLCAwKTsKICAgICB9CiAgICAgdHJhY2VfbWFy
a19wb3N0Y29weV9ibG9ja3RpbWVfZW5kKGFkZHIsIGRjLCBkYy0+dG90YWxfYmxvY2t0aW1lLApA
QCAtOTI4LDcgKzkyOCw3IEBAIHN0YXRpYyB2b2lkICpwb3N0Y29weV9yYW1fZmF1bHRfdGhyZWFk
KHZvaWQgKm9wYXF1ZSkKICAgICAgICAgICAgICAgICBlcnJvcl9yZXBvcnQoIiVzOiByZWFkKCkg
ZmFpbGVkIiwgX19mdW5jX18pOwogICAgICAgICAgICAgfQogCi0gICAgICAgICAgICBpZiAoYXRv
bWljX3JlYWQoJm1pcy0+ZmF1bHRfdGhyZWFkX3F1aXQpKSB7CisgICAgICAgICAgICBpZiAocWF0
b21pY19yZWFkKCZtaXMtPmZhdWx0X3RocmVhZF9xdWl0KSkgewogICAgICAgICAgICAgICAgIHRy
YWNlX3Bvc3Rjb3B5X3JhbV9mYXVsdF90aHJlYWRfcXVpdCgpOwogICAgICAgICAgICAgICAgIGJy
ZWFrOwogICAgICAgICAgICAgfQpAQCAtMTQxMCwxMyArMTQxMCwxMyBAQCBzdGF0aWMgUG9zdGNv
cHlTdGF0ZSBpbmNvbWluZ19wb3N0Y29weV9zdGF0ZTsKIAogUG9zdGNvcHlTdGF0ZSAgcG9zdGNv
cHlfc3RhdGVfZ2V0KHZvaWQpCiB7Ci0gICAgcmV0dXJuIGF0b21pY19tYl9yZWFkKCZpbmNvbWlu
Z19wb3N0Y29weV9zdGF0ZSk7CisgICAgcmV0dXJuIHFhdG9taWNfbWJfcmVhZCgmaW5jb21pbmdf
cG9zdGNvcHlfc3RhdGUpOwogfQogCiAvKiBTZXQgdGhlIHN0YXRlIGFuZCByZXR1cm4gdGhlIG9s
ZCBzdGF0ZSAqLwogUG9zdGNvcHlTdGF0ZSBwb3N0Y29weV9zdGF0ZV9zZXQoUG9zdGNvcHlTdGF0
ZSBuZXdfc3RhdGUpCiB7Ci0gICAgcmV0dXJuIGF0b21pY194Y2hnKCZpbmNvbWluZ19wb3N0Y29w
eV9zdGF0ZSwgbmV3X3N0YXRlKTsKKyAgICByZXR1cm4gcWF0b21pY194Y2hnKCZpbmNvbWluZ19w
b3N0Y29weV9zdGF0ZSwgbmV3X3N0YXRlKTsKIH0KIAogLyogUmVnaXN0ZXIgYSBoYW5kbGVyIGZv
ciBleHRlcm5hbCBzaGFyZWQgbWVtb3J5IHBvc3Rjb3B5CmRpZmYgLS1naXQgYS9taWdyYXRpb24v
cmRtYS5jIGIvbWlncmF0aW9uL3JkbWEuYwppbmRleCAzYmQzMGQ0NmFkLi4wMzQwODQxZmFkIDEw
MDY0NAotLS0gYS9taWdyYXRpb24vcmRtYS5jCisrKyBiL21pZ3JhdGlvbi9yZG1hLmMKQEAgLTI2
NzgsNyArMjY3OCw3IEBAIHN0YXRpYyBzc2l6ZV90IHFpb19jaGFubmVsX3JkbWFfd3JpdGV2KFFJ
T0NoYW5uZWwgKmlvYywKICAgICBzaXplX3QgbGVuID0gMDsKIAogICAgIFJDVV9SRUFEX0xPQ0tf
R1VBUkQoKTsKLSAgICByZG1hID0gYXRvbWljX3JjdV9yZWFkKCZyaW9jLT5yZG1hb3V0KTsKKyAg
ICByZG1hID0gcWF0b21pY19yY3VfcmVhZCgmcmlvYy0+cmRtYW91dCk7CiAKICAgICBpZiAoIXJk
bWEpIHsKICAgICAgICAgcmV0dXJuIC1FSU87CkBAIC0yNzYwLDcgKzI3NjAsNyBAQCBzdGF0aWMg
c3NpemVfdCBxaW9fY2hhbm5lbF9yZG1hX3JlYWR2KFFJT0NoYW5uZWwgKmlvYywKICAgICBzaXpl
X3QgZG9uZSA9IDA7CiAKICAgICBSQ1VfUkVBRF9MT0NLX0dVQVJEKCk7Ci0gICAgcmRtYSA9IGF0
b21pY19yY3VfcmVhZCgmcmlvYy0+cmRtYWluKTsKKyAgICByZG1hID0gcWF0b21pY19yY3VfcmVh
ZCgmcmlvYy0+cmRtYWluKTsKIAogICAgIGlmICghcmRtYSkgewogICAgICAgICByZXR1cm4gLUVJ
TzsKQEAgLTI4NzUsOSArMjg3NSw5IEBAIHFpb19jaGFubmVsX3JkbWFfc291cmNlX3ByZXBhcmUo
R1NvdXJjZSAqc291cmNlLAogCiAgICAgUkNVX1JFQURfTE9DS19HVUFSRCgpOwogICAgIGlmIChy
c291cmNlLT5jb25kaXRpb24gPT0gR19JT19JTikgewotICAgICAgICByZG1hID0gYXRvbWljX3Jj
dV9yZWFkKCZyc291cmNlLT5yaW9jLT5yZG1haW4pOworICAgICAgICByZG1hID0gcWF0b21pY19y
Y3VfcmVhZCgmcnNvdXJjZS0+cmlvYy0+cmRtYWluKTsKICAgICB9IGVsc2UgewotICAgICAgICBy
ZG1hID0gYXRvbWljX3JjdV9yZWFkKCZyc291cmNlLT5yaW9jLT5yZG1hb3V0KTsKKyAgICAgICAg
cmRtYSA9IHFhdG9taWNfcmN1X3JlYWQoJnJzb3VyY2UtPnJpb2MtPnJkbWFvdXQpOwogICAgIH0K
IAogICAgIGlmICghcmRtYSkgewpAQCAtMjkwMiw5ICsyOTAyLDkgQEAgcWlvX2NoYW5uZWxfcmRt
YV9zb3VyY2VfY2hlY2soR1NvdXJjZSAqc291cmNlKQogCiAgICAgUkNVX1JFQURfTE9DS19HVUFS
RCgpOwogICAgIGlmIChyc291cmNlLT5jb25kaXRpb24gPT0gR19JT19JTikgewotICAgICAgICBy
ZG1hID0gYXRvbWljX3JjdV9yZWFkKCZyc291cmNlLT5yaW9jLT5yZG1haW4pOworICAgICAgICBy
ZG1hID0gcWF0b21pY19yY3VfcmVhZCgmcnNvdXJjZS0+cmlvYy0+cmRtYWluKTsKICAgICB9IGVs
c2UgewotICAgICAgICByZG1hID0gYXRvbWljX3JjdV9yZWFkKCZyc291cmNlLT5yaW9jLT5yZG1h
b3V0KTsKKyAgICAgICAgcmRtYSA9IHFhdG9taWNfcmN1X3JlYWQoJnJzb3VyY2UtPnJpb2MtPnJk
bWFvdXQpOwogICAgIH0KIAogICAgIGlmICghcmRtYSkgewpAQCAtMjkzMiw5ICsyOTMyLDkgQEAg
cWlvX2NoYW5uZWxfcmRtYV9zb3VyY2VfZGlzcGF0Y2goR1NvdXJjZSAqc291cmNlLAogCiAgICAg
UkNVX1JFQURfTE9DS19HVUFSRCgpOwogICAgIGlmIChyc291cmNlLT5jb25kaXRpb24gPT0gR19J
T19JTikgewotICAgICAgICByZG1hID0gYXRvbWljX3JjdV9yZWFkKCZyc291cmNlLT5yaW9jLT5y
ZG1haW4pOworICAgICAgICByZG1hID0gcWF0b21pY19yY3VfcmVhZCgmcnNvdXJjZS0+cmlvYy0+
cmRtYWluKTsKICAgICB9IGVsc2UgewotICAgICAgICByZG1hID0gYXRvbWljX3JjdV9yZWFkKCZy
c291cmNlLT5yaW9jLT5yZG1hb3V0KTsKKyAgICAgICAgcmRtYSA9IHFhdG9taWNfcmN1X3JlYWQo
JnJzb3VyY2UtPnJpb2MtPnJkbWFvdXQpOwogICAgIH0KIAogICAgIGlmICghcmRtYSkgewpAQCAt
MzAzNSwxMiArMzAzNSwxMiBAQCBzdGF0aWMgaW50IHFpb19jaGFubmVsX3JkbWFfY2xvc2UoUUlP
Q2hhbm5lbCAqaW9jLAogCiAgICAgcmRtYWluID0gcmlvYy0+cmRtYWluOwogICAgIGlmIChyZG1h
aW4pIHsKLSAgICAgICAgYXRvbWljX3JjdV9zZXQoJnJpb2MtPnJkbWFpbiwgTlVMTCk7CisgICAg
ICAgIHFhdG9taWNfcmN1X3NldCgmcmlvYy0+cmRtYWluLCBOVUxMKTsKICAgICB9CiAKICAgICBy
ZG1hb3V0ID0gcmlvYy0+cmRtYW91dDsKICAgICBpZiAocmRtYW91dCkgewotICAgICAgICBhdG9t
aWNfcmN1X3NldCgmcmlvYy0+cmRtYW91dCwgTlVMTCk7CisgICAgICAgIHFhdG9taWNfcmN1X3Nl
dCgmcmlvYy0+cmRtYW91dCwgTlVMTCk7CiAgICAgfQogCiAgICAgcmN1LT5yZG1haW4gPSByZG1h
aW47CkBAIC0zMDYwLDggKzMwNjAsOCBAQCBxaW9fY2hhbm5lbF9yZG1hX3NodXRkb3duKFFJT0No
YW5uZWwgKmlvYywKIAogICAgIFJDVV9SRUFEX0xPQ0tfR1VBUkQoKTsKIAotICAgIHJkbWFpbiA9
IGF0b21pY19yY3VfcmVhZCgmcmlvYy0+cmRtYWluKTsKLSAgICByZG1hb3V0ID0gYXRvbWljX3Jj
dV9yZWFkKCZyaW9jLT5yZG1haW4pOworICAgIHJkbWFpbiA9IHFhdG9taWNfcmN1X3JlYWQoJnJp
b2MtPnJkbWFpbik7CisgICAgcmRtYW91dCA9IHFhdG9taWNfcmN1X3JlYWQoJnJpb2MtPnJkbWFp
bik7CiAKICAgICBzd2l0Y2ggKGhvdykgewogICAgIGNhc2UgUUlPX0NIQU5ORUxfU0hVVERPV05f
UkVBRDoKQEAgLTMxMzEsNyArMzEzMSw3IEBAIHN0YXRpYyBzaXplX3QgcWVtdV9yZG1hX3NhdmVf
cGFnZShRRU1VRmlsZSAqZiwgdm9pZCAqb3BhcXVlLAogICAgIGludCByZXQ7CiAKICAgICBSQ1Vf
UkVBRF9MT0NLX0dVQVJEKCk7Ci0gICAgcmRtYSA9IGF0b21pY19yY3VfcmVhZCgmcmlvYy0+cmRt
YW91dCk7CisgICAgcmRtYSA9IHFhdG9taWNfcmN1X3JlYWQoJnJpb2MtPnJkbWFvdXQpOwogCiAg
ICAgaWYgKCFyZG1hKSB7CiAgICAgICAgIHJldHVybiAtRUlPOwpAQCAtMzQ1MSw3ICszNDUxLDcg
QEAgc3RhdGljIGludCBxZW11X3JkbWFfcmVnaXN0cmF0aW9uX2hhbmRsZShRRU1VRmlsZSAqZiwg
dm9pZCAqb3BhcXVlKQogICAgIGludCBpID0gMDsKIAogICAgIFJDVV9SRUFEX0xPQ0tfR1VBUkQo
KTsKLSAgICByZG1hID0gYXRvbWljX3JjdV9yZWFkKCZyaW9jLT5yZG1haW4pOworICAgIHJkbWEg
PSBxYXRvbWljX3JjdV9yZWFkKCZyaW9jLT5yZG1haW4pOwogCiAgICAgaWYgKCFyZG1hKSB7CiAg
ICAgICAgIHJldHVybiAtRUlPOwpAQCAtMzcxNCw3ICszNzE0LDcgQEAgcmRtYV9ibG9ja19ub3Rp
ZmljYXRpb25faGFuZGxlKFFJT0NoYW5uZWxSRE1BICpyaW9jLCBjb25zdCBjaGFyICpuYW1lKQog
ICAgIGludCBmb3VuZCA9IC0xOwogCiAgICAgUkNVX1JFQURfTE9DS19HVUFSRCgpOwotICAgIHJk
bWEgPSBhdG9taWNfcmN1X3JlYWQoJnJpb2MtPnJkbWFpbik7CisgICAgcmRtYSA9IHFhdG9taWNf
cmN1X3JlYWQoJnJpb2MtPnJkbWFpbik7CiAKICAgICBpZiAoIXJkbWEpIHsKICAgICAgICAgcmV0
dXJuIC1FSU87CkBAIC0zNzYyLDcgKzM3NjIsNyBAQCBzdGF0aWMgaW50IHFlbXVfcmRtYV9yZWdp
c3RyYXRpb25fc3RhcnQoUUVNVUZpbGUgKmYsIHZvaWQgKm9wYXF1ZSwKICAgICBSRE1BQ29udGV4
dCAqcmRtYTsKIAogICAgIFJDVV9SRUFEX0xPQ0tfR1VBUkQoKTsKLSAgICByZG1hID0gYXRvbWlj
X3JjdV9yZWFkKCZyaW9jLT5yZG1hb3V0KTsKKyAgICByZG1hID0gcWF0b21pY19yY3VfcmVhZCgm
cmlvYy0+cmRtYW91dCk7CiAgICAgaWYgKCFyZG1hKSB7CiAgICAgICAgIHJldHVybiAtRUlPOwog
ICAgIH0KQEAgLTM3OTMsNyArMzc5Myw3IEBAIHN0YXRpYyBpbnQgcWVtdV9yZG1hX3JlZ2lzdHJh
dGlvbl9zdG9wKFFFTVVGaWxlICpmLCB2b2lkICpvcGFxdWUsCiAgICAgaW50IHJldCA9IDA7CiAK
ICAgICBSQ1VfUkVBRF9MT0NLX0dVQVJEKCk7Ci0gICAgcmRtYSA9IGF0b21pY19yY3VfcmVhZCgm
cmlvYy0+cmRtYW91dCk7CisgICAgcmRtYSA9IHFhdG9taWNfcmN1X3JlYWQoJnJpb2MtPnJkbWFv
dXQpOwogICAgIGlmICghcmRtYSkgewogICAgICAgICByZXR1cm4gLUVJTzsKICAgICB9CmRpZmYg
LS1naXQgYS9tb25pdG9yL2htcC5jIGIvbW9uaXRvci9obXAuYwppbmRleCBkNTk4ZGQwMmJiLi40
ZWNkZWZkNzA1IDEwMDY0NAotLS0gYS9tb25pdG9yL2htcC5jCisrKyBiL21vbml0b3IvaG1wLmMK
QEAgLTEzMzcsMTkgKzEzMzcsMTkgQEAgc3RhdGljIHZvaWQgbW9uaXRvcl9ldmVudCh2b2lkICpv
cGFxdWUsIFFFTVVDaHJFdmVudCBldmVudCkKICAgICAgICAgICAgIG1vbml0b3JfcmVzdW1lKG1v
bik7CiAgICAgICAgICAgICBtb25pdG9yX2ZsdXNoKG1vbik7CiAgICAgICAgIH0gZWxzZSB7Ci0g
ICAgICAgICAgICBhdG9taWNfbWJfc2V0KCZtb24tPnN1c3BlbmRfY250LCAwKTsKKyAgICAgICAg
ICAgIHFhdG9taWNfbWJfc2V0KCZtb24tPnN1c3BlbmRfY250LCAwKTsKICAgICAgICAgfQogICAg
ICAgICBicmVhazsKIAogICAgIGNhc2UgQ0hSX0VWRU5UX01VWF9PVVQ6CiAgICAgICAgIGlmICht
b24tPnJlc2V0X3NlZW4pIHsKLSAgICAgICAgICAgIGlmIChhdG9taWNfbWJfcmVhZCgmbW9uLT5z
dXNwZW5kX2NudCkgPT0gMCkgeworICAgICAgICAgICAgaWYgKHFhdG9taWNfbWJfcmVhZCgmbW9u
LT5zdXNwZW5kX2NudCkgPT0gMCkgewogICAgICAgICAgICAgICAgIG1vbml0b3JfcHJpbnRmKG1v
biwgIlxuIik7CiAgICAgICAgICAgICB9CiAgICAgICAgICAgICBtb25pdG9yX2ZsdXNoKG1vbik7
CiAgICAgICAgICAgICBtb25pdG9yX3N1c3BlbmQobW9uKTsKICAgICAgICAgfSBlbHNlIHsKLSAg
ICAgICAgICAgIGF0b21pY19pbmMoJm1vbi0+c3VzcGVuZF9jbnQpOworICAgICAgICAgICAgcWF0
b21pY19pbmMoJm1vbi0+c3VzcGVuZF9jbnQpOwogICAgICAgICB9CiAgICAgICAgIHFlbXVfbXV0
ZXhfbG9jaygmbW9uLT5tb25fbG9jayk7CiAgICAgICAgIG1vbi0+bXV4X291dCA9IDE7CmRpZmYg
LS1naXQgYS9tb25pdG9yL21pc2MuYyBiL21vbml0b3IvbWlzYy5jCmluZGV4IDBiMWI5YjE5NmMu
LjI2MmYyYmQ5NTEgMTAwNjQ0Ci0tLSBhL21vbml0b3IvbWlzYy5jCisrKyBiL21vbml0b3IvbWlz
Yy5jCkBAIC03NTEsNyArNzUxLDcgQEAgc3RhdGljIHVpbnQ2NF90IHZ0b3Aodm9pZCAqcHRyLCBF
cnJvciAqKmVycnApCiAgICAgfQogCiAgICAgLyogRm9yY2UgY29weS1vbi13cml0ZSBpZiBuZWNl
c3NhcnkuICAqLwotICAgIGF0b21pY19hZGQoKHVpbnQ4X3QgKilwdHIsIDApOworICAgIHFhdG9t
aWNfYWRkKCh1aW50OF90ICopcHRyLCAwKTsKIAogICAgIGlmIChwcmVhZChmZCwgJnBpbmZvLCBz
aXplb2YocGluZm8pLCBvZmZzZXQpICE9IHNpemVvZihwaW5mbykpIHsKICAgICAgICAgZXJyb3Jf
c2V0Z19lcnJubyhlcnJwLCBlcnJubywgIkNhbm5vdCByZWFkIHBhZ2VtYXAiKTsKZGlmZiAtLWdp
dCBhL21vbml0b3IvbW9uaXRvci5jIGIvbW9uaXRvci9tb25pdG9yLmMKaW5kZXggYjM4NWEzZDU2
OS4uMGYzMjg5MmFkNCAxMDA2NDQKLS0tIGEvbW9uaXRvci9tb25pdG9yLmMKKysrIGIvbW9uaXRv
ci9tb25pdG9yLmMKQEAgLTQ0OSw3ICs0NDksNyBAQCBpbnQgbW9uaXRvcl9zdXNwZW5kKE1vbml0
b3IgKm1vbikKICAgICAgICAgcmV0dXJuIC1FTk9UVFk7CiAgICAgfQogCi0gICAgYXRvbWljX2lu
YygmbW9uLT5zdXNwZW5kX2NudCk7CisgICAgcWF0b21pY19pbmMoJm1vbi0+c3VzcGVuZF9jbnQp
OwogCiAgICAgaWYgKG1vbi0+dXNlX2lvX3RocmVhZCkgewogICAgICAgICAvKgpAQCAtNDc2LDcg
KzQ3Niw3IEBAIHZvaWQgbW9uaXRvcl9yZXN1bWUoTW9uaXRvciAqbW9uKQogICAgICAgICByZXR1
cm47CiAgICAgfQogCi0gICAgaWYgKGF0b21pY19kZWNfZmV0Y2goJm1vbi0+c3VzcGVuZF9jbnQp
ID09IDApIHsKKyAgICBpZiAocWF0b21pY19kZWNfZmV0Y2goJm1vbi0+c3VzcGVuZF9jbnQpID09
IDApIHsKICAgICAgICAgQWlvQ29udGV4dCAqY3R4OwogCiAgICAgICAgIGlmIChtb24tPnVzZV9p
b190aHJlYWQpIHsKQEAgLTUwMSw3ICs1MDEsNyBAQCBpbnQgbW9uaXRvcl9jYW5fcmVhZCh2b2lk
ICpvcGFxdWUpCiB7CiAgICAgTW9uaXRvciAqbW9uID0gb3BhcXVlOwogCi0gICAgcmV0dXJuICFh
dG9taWNfbWJfcmVhZCgmbW9uLT5zdXNwZW5kX2NudCk7CisgICAgcmV0dXJuICFxYXRvbWljX21i
X3JlYWQoJm1vbi0+c3VzcGVuZF9jbnQpOwogfQogCiB2b2lkIG1vbml0b3JfbGlzdF9hcHBlbmQo
TW9uaXRvciAqbW9uKQpkaWZmIC0tZ2l0IGEvcWVtdS1uYmQuYyBiL3FlbXUtbmJkLmMKaW5kZXgg
MzM0NzZhMTAwMC4uZTM5ZDNiMjNjMSAxMDA2NDQKLS0tIGEvcWVtdS1uYmQuYworKysgYi9xZW11
LW5iZC5jCkBAIC0xNTgsNyArMTU4LDcgQEAgUUVNVV9DT1BZUklHSFQgIlxuIgogI2lmIEhBVkVf
TkJEX0RFVklDRQogc3RhdGljIHZvaWQgdGVybXNpZ19oYW5kbGVyKGludCBzaWdudW0pCiB7Ci0g
ICAgYXRvbWljX2NtcHhjaGcoJnN0YXRlLCBSVU5OSU5HLCBURVJNSU5BVEUpOworICAgIHFhdG9t
aWNfY21weGNoZygmc3RhdGUsIFJVTk5JTkcsIFRFUk1JTkFURSk7CiAgICAgcWVtdV9ub3RpZnlf
ZXZlbnQoKTsKIH0KICNlbmRpZiAvKiBIQVZFX05CRF9ERVZJQ0UgKi8KZGlmZiAtLWdpdCBhL3Fn
YS9jb21tYW5kcy5jIGIvcWdhL2NvbW1hbmRzLmMKaW5kZXggZDNmZWM4MDdjMS4uM2RjZDVmYmU1
YyAxMDA2NDQKLS0tIGEvcWdhL2NvbW1hbmRzLmMKKysrIGIvcWdhL2NvbW1hbmRzLmMKQEAgLTE2
NiwxMyArMTY2LDEzIEBAIEd1ZXN0RXhlY1N0YXR1cyAqcW1wX2d1ZXN0X2V4ZWNfc3RhdHVzKGlu
dDY0X3QgcGlkLCBFcnJvciAqKmVycnApCiAKICAgICBnZXMgPSBnX25ldzAoR3Vlc3RFeGVjU3Rh
dHVzLCAxKTsKIAotICAgIGJvb2wgZmluaXNoZWQgPSBhdG9taWNfbWJfcmVhZCgmZ2VpLT5maW5p
c2hlZCk7CisgICAgYm9vbCBmaW5pc2hlZCA9IHFhdG9taWNfbWJfcmVhZCgmZ2VpLT5maW5pc2hl
ZCk7CiAKICAgICAvKiBuZWVkIHRvIHdhaXQgdGlsbCBvdXRwdXQgY2hhbm5lbHMgYXJlIGNsb3Nl
ZAogICAgICAqIHRvIGJlIHN1cmUgd2UgY2FwdHVyZWQgYWxsIG91dHB1dCBhdCB0aGlzIHBvaW50
ICovCiAgICAgaWYgKGdlaS0+aGFzX291dHB1dCkgewotICAgICAgICBmaW5pc2hlZCA9IGZpbmlz
aGVkICYmIGF0b21pY19tYl9yZWFkKCZnZWktPm91dC5jbG9zZWQpOwotICAgICAgICBmaW5pc2hl
ZCA9IGZpbmlzaGVkICYmIGF0b21pY19tYl9yZWFkKCZnZWktPmVyci5jbG9zZWQpOworICAgICAg
ICBmaW5pc2hlZCA9IGZpbmlzaGVkICYmIHFhdG9taWNfbWJfcmVhZCgmZ2VpLT5vdXQuY2xvc2Vk
KTsKKyAgICAgICAgZmluaXNoZWQgPSBmaW5pc2hlZCAmJiBxYXRvbWljX21iX3JlYWQoJmdlaS0+
ZXJyLmNsb3NlZCk7CiAgICAgfQogCiAgICAgZ2VzLT5leGl0ZWQgPSBmaW5pc2hlZDsKQEAgLTI3
NCw3ICsyNzQsNyBAQCBzdGF0aWMgdm9pZCBndWVzdF9leGVjX2NoaWxkX3dhdGNoKEdQaWQgcGlk
LCBnaW50IHN0YXR1cywgZ3BvaW50ZXIgZGF0YSkKICAgICAgICAgICAgIChpbnQzMl90KWdwaWRf
dG9faW50NjQocGlkKSwgKHVpbnQzMl90KXN0YXR1cyk7CiAKICAgICBnZWktPnN0YXR1cyA9IHN0
YXR1czsKLSAgICBhdG9taWNfbWJfc2V0KCZnZWktPmZpbmlzaGVkLCB0cnVlKTsKKyAgICBxYXRv
bWljX21iX3NldCgmZ2VpLT5maW5pc2hlZCwgdHJ1ZSk7CiAKICAgICBnX3NwYXduX2Nsb3NlX3Bp
ZChwaWQpOwogfQpAQCAtMzMwLDcgKzMzMCw3IEBAIHN0YXRpYyBnYm9vbGVhbiBndWVzdF9leGVj
X2lucHV0X3dhdGNoKEdJT0NoYW5uZWwgKmNoLAogZG9uZToKICAgICBnX2lvX2NoYW5uZWxfc2h1
dGRvd24oY2gsIHRydWUsIE5VTEwpOwogICAgIGdfaW9fY2hhbm5lbF91bnJlZihjaCk7Ci0gICAg
YXRvbWljX21iX3NldCgmcC0+Y2xvc2VkLCB0cnVlKTsKKyAgICBxYXRvbWljX21iX3NldCgmcC0+
Y2xvc2VkLCB0cnVlKTsKICAgICBnX2ZyZWUocC0+ZGF0YSk7CiAKICAgICByZXR1cm4gZmFsc2U7
CkBAIC0zODQsNyArMzg0LDcgQEAgc3RhdGljIGdib29sZWFuIGd1ZXN0X2V4ZWNfb3V0cHV0X3dh
dGNoKEdJT0NoYW5uZWwgKmNoLAogY2xvc2U6CiAgICAgZ19pb19jaGFubmVsX3NodXRkb3duKGNo
LCB0cnVlLCBOVUxMKTsKICAgICBnX2lvX2NoYW5uZWxfdW5yZWYoY2gpOwotICAgIGF0b21pY19t
Yl9zZXQoJnAtPmNsb3NlZCwgdHJ1ZSk7CisgICAgcWF0b21pY19tYl9zZXQoJnAtPmNsb3NlZCwg
dHJ1ZSk7CiAgICAgcmV0dXJuIGZhbHNlOwogfQogCmRpZmYgLS1naXQgYS9xb20vb2JqZWN0LmMg
Yi9xb20vb2JqZWN0LmMKaW5kZXggYTkxYTZhNTE1YS4uMTE5Njk3MDYzNSAxMDA2NDQKLS0tIGEv
cW9tL29iamVjdC5jCisrKyBiL3FvbS9vYmplY3QuYwpAQCAtODY3LDcgKzg2Nyw3IEBAIE9iamVj
dCAqb2JqZWN0X2R5bmFtaWNfY2FzdF9hc3NlcnQoT2JqZWN0ICpvYmosIGNvbnN0IGNoYXIgKnR5
cGVuYW1lLAogICAgIE9iamVjdCAqaW5zdDsKIAogICAgIGZvciAoaSA9IDA7IG9iaiAmJiBpIDwg
T0JKRUNUX0NMQVNTX0NBU1RfQ0FDSEU7IGkrKykgewotICAgICAgICBpZiAoYXRvbWljX3JlYWQo
Jm9iai0+Y2xhc3MtPm9iamVjdF9jYXN0X2NhY2hlW2ldKSA9PSB0eXBlbmFtZSkgeworICAgICAg
ICBpZiAocWF0b21pY19yZWFkKCZvYmotPmNsYXNzLT5vYmplY3RfY2FzdF9jYWNoZVtpXSkgPT0g
dHlwZW5hbWUpIHsKICAgICAgICAgICAgIGdvdG8gb3V0OwogICAgICAgICB9CiAgICAgfQpAQCAt
ODg0LDEwICs4ODQsMTAgQEAgT2JqZWN0ICpvYmplY3RfZHluYW1pY19jYXN0X2Fzc2VydChPYmpl
Y3QgKm9iaiwgY29uc3QgY2hhciAqdHlwZW5hbWUsCiAKICAgICBpZiAob2JqICYmIG9iaiA9PSBp
bnN0KSB7CiAgICAgICAgIGZvciAoaSA9IDE7IGkgPCBPQkpFQ1RfQ0xBU1NfQ0FTVF9DQUNIRTsg
aSsrKSB7Ci0gICAgICAgICAgICBhdG9taWNfc2V0KCZvYmotPmNsYXNzLT5vYmplY3RfY2FzdF9j
YWNoZVtpIC0gMV0sCi0gICAgICAgICAgICAgICAgICAgICAgIGF0b21pY19yZWFkKCZvYmotPmNs
YXNzLT5vYmplY3RfY2FzdF9jYWNoZVtpXSkpOworICAgICAgICAgICAgcWF0b21pY19zZXQoJm9i
ai0+Y2xhc3MtPm9iamVjdF9jYXN0X2NhY2hlW2kgLSAxXSwKKyAgICAgICAgICAgICAgICAgICAg
ICAgcWF0b21pY19yZWFkKCZvYmotPmNsYXNzLT5vYmplY3RfY2FzdF9jYWNoZVtpXSkpOwogICAg
ICAgICB9Ci0gICAgICAgIGF0b21pY19zZXQoJm9iai0+Y2xhc3MtPm9iamVjdF9jYXN0X2NhY2hl
W2kgLSAxXSwgdHlwZW5hbWUpOworICAgICAgICBxYXRvbWljX3NldCgmb2JqLT5jbGFzcy0+b2Jq
ZWN0X2Nhc3RfY2FjaGVbaSAtIDFdLCB0eXBlbmFtZSk7CiAgICAgfQogCiBvdXQ6CkBAIC05NTcs
NyArOTU3LDcgQEAgT2JqZWN0Q2xhc3MgKm9iamVjdF9jbGFzc19keW5hbWljX2Nhc3RfYXNzZXJ0
KE9iamVjdENsYXNzICpjbGFzcywKICAgICBpbnQgaTsKIAogICAgIGZvciAoaSA9IDA7IGNsYXNz
ICYmIGkgPCBPQkpFQ1RfQ0xBU1NfQ0FTVF9DQUNIRTsgaSsrKSB7Ci0gICAgICAgIGlmIChhdG9t
aWNfcmVhZCgmY2xhc3MtPmNsYXNzX2Nhc3RfY2FjaGVbaV0pID09IHR5cGVuYW1lKSB7CisgICAg
ICAgIGlmIChxYXRvbWljX3JlYWQoJmNsYXNzLT5jbGFzc19jYXN0X2NhY2hlW2ldKSA9PSB0eXBl
bmFtZSkgewogICAgICAgICAgICAgcmV0ID0gY2xhc3M7CiAgICAgICAgICAgICBnb3RvIG91dDsK
ICAgICAgICAgfQpAQCAtOTc4LDEwICs5NzgsMTAgQEAgT2JqZWN0Q2xhc3MgKm9iamVjdF9jbGFz
c19keW5hbWljX2Nhc3RfYXNzZXJ0KE9iamVjdENsYXNzICpjbGFzcywKICNpZmRlZiBDT05GSUdf
UU9NX0NBU1RfREVCVUcKICAgICBpZiAoY2xhc3MgJiYgcmV0ID09IGNsYXNzKSB7CiAgICAgICAg
IGZvciAoaSA9IDE7IGkgPCBPQkpFQ1RfQ0xBU1NfQ0FTVF9DQUNIRTsgaSsrKSB7Ci0gICAgICAg
ICAgICBhdG9taWNfc2V0KCZjbGFzcy0+Y2xhc3NfY2FzdF9jYWNoZVtpIC0gMV0sCi0gICAgICAg
ICAgICAgICAgICAgICAgIGF0b21pY19yZWFkKCZjbGFzcy0+Y2xhc3NfY2FzdF9jYWNoZVtpXSkp
OworICAgICAgICAgICAgcWF0b21pY19zZXQoJmNsYXNzLT5jbGFzc19jYXN0X2NhY2hlW2kgLSAx
XSwKKyAgICAgICAgICAgICAgICAgICAgICAgcWF0b21pY19yZWFkKCZjbGFzcy0+Y2xhc3NfY2Fz
dF9jYWNoZVtpXSkpOwogICAgICAgICB9Ci0gICAgICAgIGF0b21pY19zZXQoJmNsYXNzLT5jbGFz
c19jYXN0X2NhY2hlW2kgLSAxXSwgdHlwZW5hbWUpOworICAgICAgICBxYXRvbWljX3NldCgmY2xh
c3MtPmNsYXNzX2Nhc3RfY2FjaGVbaSAtIDFdLCB0eXBlbmFtZSk7CiAgICAgfQogb3V0OgogI2Vu
ZGlmCkBAIC0xMTY2LDcgKzExNjYsNyBAQCBPYmplY3QgKm9iamVjdF9yZWYodm9pZCAqb2JqcHRy
KQogICAgIGlmICghb2JqKSB7CiAgICAgICAgIHJldHVybiBOVUxMOwogICAgIH0KLSAgICBhdG9t
aWNfaW5jKCZvYmotPnJlZik7CisgICAgcWF0b21pY19pbmMoJm9iai0+cmVmKTsKICAgICByZXR1
cm4gb2JqOwogfQogCkBAIC0xMTc5LDcgKzExNzksNyBAQCB2b2lkIG9iamVjdF91bnJlZih2b2lk
ICpvYmpwdHIpCiAgICAgZ19hc3NlcnQob2JqLT5yZWYgPiAwKTsKIAogICAgIC8qIHBhcmVudCBh
bHdheXMgaG9sZHMgYSByZWZlcmVuY2UgdG8gaXRzIGNoaWxkcmVuICovCi0gICAgaWYgKGF0b21p
Y19mZXRjaF9kZWMoJm9iai0+cmVmKSA9PSAxKSB7CisgICAgaWYgKHFhdG9taWNfZmV0Y2hfZGVj
KCZvYmotPnJlZikgPT0gMSkgewogICAgICAgICBvYmplY3RfZmluYWxpemUob2JqKTsKICAgICB9
CiB9CmRpZmYgLS1naXQgYS9zY3NpL3FlbXUtcHItaGVscGVyLmMgYi9zY3NpL3FlbXUtcHItaGVs
cGVyLmMKaW5kZXggNTdhZDgzMGQ1NC4uZDI2ZmFhZjkxZSAxMDA2NDQKLS0tIGEvc2NzaS9xZW11
LXByLWhlbHBlci5jCisrKyBiL3Njc2kvcWVtdS1wci1oZWxwZXIuYwpAQCAtNzQ3LDcgKzc0Nyw3
IEBAIHN0YXRpYyB2b2lkIGNvcm91dGluZV9mbiBwcmhfY29fZW50cnkodm9pZCAqb3BhcXVlKQog
ICAgICAgICBnb3RvIG91dDsKICAgICB9CiAKLSAgICB3aGlsZSAoYXRvbWljX3JlYWQoJnN0YXRl
KSA9PSBSVU5OSU5HKSB7CisgICAgd2hpbGUgKHFhdG9taWNfcmVhZCgmc3RhdGUpID09IFJVTk5J
TkcpIHsKICAgICAgICAgUFJIZWxwZXJSZXF1ZXN0IHJlcTsKICAgICAgICAgUFJIZWxwZXJSZXNw
b25zZSByZXNwOwogICAgICAgICBpbnQgc3o7CkBAIC04MTYsNyArODE2LDcgQEAgc3RhdGljIGdi
b29sZWFuIGFjY2VwdF9jbGllbnQoUUlPQ2hhbm5lbCAqaW9jLCBHSU9Db25kaXRpb24gY29uZCwg
Z3BvaW50ZXIgb3BhcXUKIAogc3RhdGljIHZvaWQgdGVybXNpZ19oYW5kbGVyKGludCBzaWdudW0p
CiB7Ci0gICAgYXRvbWljX2NtcHhjaGcoJnN0YXRlLCBSVU5OSU5HLCBURVJNSU5BVEUpOworICAg
IHFhdG9taWNfY21weGNoZygmc3RhdGUsIFJVTk5JTkcsIFRFUk1JTkFURSk7CiAgICAgcWVtdV9u
b3RpZnlfZXZlbnQoKTsKIH0KIApkaWZmIC0tZ2l0IGEvc29mdG1tdS9jcHUtdGhyb3R0bGUuYyBi
L3NvZnRtbXUvY3B1LXRocm90dGxlLmMKaW5kZXggNGU2YjI4MThjYS4uMmVjNGI4ZTBiYyAxMDA2
NDQKLS0tIGEvc29mdG1tdS9jcHUtdGhyb3R0bGUuYworKysgYi9zb2Z0bW11L2NwdS10aHJvdHRs
ZS5jCkBAIC02NCw3ICs2NCw3IEBAIHN0YXRpYyB2b2lkIGNwdV90aHJvdHRsZV90aHJlYWQoQ1BV
U3RhdGUgKmNwdSwgcnVuX29uX2NwdV9kYXRhIG9wYXF1ZSkKICAgICAgICAgfQogICAgICAgICBz
bGVlcHRpbWVfbnMgPSBlbmR0aW1lX25zIC0gcWVtdV9jbG9ja19nZXRfbnMoUUVNVV9DTE9DS19S
RUFMVElNRSk7CiAgICAgfQotICAgIGF0b21pY19zZXQoJmNwdS0+dGhyb3R0bGVfdGhyZWFkX3Nj
aGVkdWxlZCwgMCk7CisgICAgcWF0b21pY19zZXQoJmNwdS0+dGhyb3R0bGVfdGhyZWFkX3NjaGVk
dWxlZCwgMCk7CiB9CiAKIHN0YXRpYyB2b2lkIGNwdV90aHJvdHRsZV90aW1lcl90aWNrKHZvaWQg
Km9wYXF1ZSkKQEAgLTc3LDcgKzc3LDcgQEAgc3RhdGljIHZvaWQgY3B1X3Rocm90dGxlX3RpbWVy
X3RpY2sodm9pZCAqb3BhcXVlKQogICAgICAgICByZXR1cm47CiAgICAgfQogICAgIENQVV9GT1JF
QUNIKGNwdSkgewotICAgICAgICBpZiAoIWF0b21pY194Y2hnKCZjcHUtPnRocm90dGxlX3RocmVh
ZF9zY2hlZHVsZWQsIDEpKSB7CisgICAgICAgIGlmICghcWF0b21pY194Y2hnKCZjcHUtPnRocm90
dGxlX3RocmVhZF9zY2hlZHVsZWQsIDEpKSB7CiAgICAgICAgICAgICBhc3luY19ydW5fb25fY3B1
KGNwdSwgY3B1X3Rocm90dGxlX3RocmVhZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
UlVOX09OX0NQVV9OVUxMKTsKICAgICAgICAgfQpAQCAtOTQsNyArOTQsNyBAQCB2b2lkIGNwdV90
aHJvdHRsZV9zZXQoaW50IG5ld190aHJvdHRsZV9wY3QpCiAgICAgbmV3X3Rocm90dGxlX3BjdCA9
IE1JTihuZXdfdGhyb3R0bGVfcGN0LCBDUFVfVEhST1RUTEVfUENUX01BWCk7CiAgICAgbmV3X3Ro
cm90dGxlX3BjdCA9IE1BWChuZXdfdGhyb3R0bGVfcGN0LCBDUFVfVEhST1RUTEVfUENUX01JTik7
CiAKLSAgICBhdG9taWNfc2V0KCZ0aHJvdHRsZV9wZXJjZW50YWdlLCBuZXdfdGhyb3R0bGVfcGN0
KTsKKyAgICBxYXRvbWljX3NldCgmdGhyb3R0bGVfcGVyY2VudGFnZSwgbmV3X3Rocm90dGxlX3Bj
dCk7CiAKICAgICB0aW1lcl9tb2QodGhyb3R0bGVfdGltZXIsIHFlbXVfY2xvY2tfZ2V0X25zKFFF
TVVfQ0xPQ0tfVklSVFVBTF9SVCkgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgQ1BVX1RIUk9UVExFX1RJTUVTTElDRV9OUyk7CkBAIC0xMDIsNyArMTAyLDcgQEAgdm9p
ZCBjcHVfdGhyb3R0bGVfc2V0KGludCBuZXdfdGhyb3R0bGVfcGN0KQogCiB2b2lkIGNwdV90aHJv
dHRsZV9zdG9wKHZvaWQpCiB7Ci0gICAgYXRvbWljX3NldCgmdGhyb3R0bGVfcGVyY2VudGFnZSwg
MCk7CisgICAgcWF0b21pY19zZXQoJnRocm90dGxlX3BlcmNlbnRhZ2UsIDApOwogfQogCiBib29s
IGNwdV90aHJvdHRsZV9hY3RpdmUodm9pZCkKQEAgLTExMiw3ICsxMTIsNyBAQCBib29sIGNwdV90
aHJvdHRsZV9hY3RpdmUodm9pZCkKIAogaW50IGNwdV90aHJvdHRsZV9nZXRfcGVyY2VudGFnZSh2
b2lkKQogewotICAgIHJldHVybiBhdG9taWNfcmVhZCgmdGhyb3R0bGVfcGVyY2VudGFnZSk7Cisg
ICAgcmV0dXJuIHFhdG9taWNfcmVhZCgmdGhyb3R0bGVfcGVyY2VudGFnZSk7CiB9CiAKIHZvaWQg
Y3B1X3Rocm90dGxlX2luaXQodm9pZCkKZGlmZiAtLWdpdCBhL3NvZnRtbXUvY3B1cy5jIGIvc29m
dG1tdS9jcHVzLmMKaW5kZXggZTNiOTgwNjVjOS4uYWM4OTQwZDUyZSAxMDA2NDQKLS0tIGEvc29m
dG1tdS9jcHVzLmMKKysrIGIvc29mdG1tdS9jcHVzLmMKQEAgLTE5Miw3ICsxOTIsNyBAQCBzdGF0
aWMgdm9pZCBjcHVfdXBkYXRlX2ljb3VudF9sb2NrZWQoQ1BVU3RhdGUgKmNwdSkKICAgICBpbnQ2
NF90IGV4ZWN1dGVkID0gY3B1X2dldF9pY291bnRfZXhlY3V0ZWQoY3B1KTsKICAgICBjcHUtPmlj
b3VudF9idWRnZXQgLT0gZXhlY3V0ZWQ7CiAKLSAgICBhdG9taWNfc2V0X2k2NCgmdGltZXJzX3N0
YXRlLnFlbXVfaWNvdW50LAorICAgIHFhdG9taWNfc2V0X2k2NCgmdGltZXJzX3N0YXRlLnFlbXVf
aWNvdW50LAogICAgICAgICAgICAgICAgICAgIHRpbWVyc19zdGF0ZS5xZW11X2ljb3VudCArIGV4
ZWN1dGVkKTsKIH0KIApAQCAtMjIzLDEzICsyMjMsMTMgQEAgc3RhdGljIGludDY0X3QgY3B1X2dl
dF9pY291bnRfcmF3X2xvY2tlZCh2b2lkKQogICAgICAgICBjcHVfdXBkYXRlX2ljb3VudF9sb2Nr
ZWQoY3B1KTsKICAgICB9CiAgICAgLyogVGhlIHJlYWQgaXMgcHJvdGVjdGVkIGJ5IHRoZSBzZXFs
b2NrLCBidXQgbmVlZHMgYXRvbWljNjQgdG8gYXZvaWQgVUIgKi8KLSAgICByZXR1cm4gYXRvbWlj
X3JlYWRfaTY0KCZ0aW1lcnNfc3RhdGUucWVtdV9pY291bnQpOworICAgIHJldHVybiBxYXRvbWlj
X3JlYWRfaTY0KCZ0aW1lcnNfc3RhdGUucWVtdV9pY291bnQpOwogfQogCiBzdGF0aWMgaW50NjRf
dCBjcHVfZ2V0X2ljb3VudF9sb2NrZWQodm9pZCkKIHsKICAgICBpbnQ2NF90IGljb3VudCA9IGNw
dV9nZXRfaWNvdW50X3Jhd19sb2NrZWQoKTsKLSAgICByZXR1cm4gYXRvbWljX3JlYWRfaTY0KCZ0
aW1lcnNfc3RhdGUucWVtdV9pY291bnRfYmlhcykgKworICAgIHJldHVybiBxYXRvbWljX3JlYWRf
aTY0KCZ0aW1lcnNfc3RhdGUucWVtdV9pY291bnRfYmlhcykgKwogICAgICAgICBjcHVfaWNvdW50
X3RvX25zKGljb3VudCk7CiB9CiAKQEAgLTI2Miw3ICsyNjIsNyBAQCBpbnQ2NF90IGNwdV9nZXRf
aWNvdW50KHZvaWQpCiAKIGludDY0X3QgY3B1X2ljb3VudF90b19ucyhpbnQ2NF90IGljb3VudCkK
IHsKLSAgICByZXR1cm4gaWNvdW50IDw8IGF0b21pY19yZWFkKCZ0aW1lcnNfc3RhdGUuaWNvdW50
X3RpbWVfc2hpZnQpOworICAgIHJldHVybiBpY291bnQgPDwgcWF0b21pY19yZWFkKCZ0aW1lcnNf
c3RhdGUuaWNvdW50X3RpbWVfc2hpZnQpOwogfQogCiBzdGF0aWMgaW50NjRfdCBjcHVfZ2V0X3Rp
Y2tzX2xvY2tlZCh2b2lkKQpAQCAtMzkzLDE4ICszOTMsMTggQEAgc3RhdGljIHZvaWQgaWNvdW50
X2FkanVzdCh2b2lkKQogICAgICAgICAmJiBsYXN0X2RlbHRhICsgSUNPVU5UX1dPQkJMRSA8IGRl
bHRhICogMgogICAgICAgICAmJiB0aW1lcnNfc3RhdGUuaWNvdW50X3RpbWVfc2hpZnQgPiAwKSB7
CiAgICAgICAgIC8qIFRoZSBndWVzdCBpcyBnZXR0aW5nIHRvbyBmYXIgYWhlYWQuICBTbG93IHRp
bWUgZG93bi4gICovCi0gICAgICAgIGF0b21pY19zZXQoJnRpbWVyc19zdGF0ZS5pY291bnRfdGlt
ZV9zaGlmdCwKKyAgICAgICAgcWF0b21pY19zZXQoJnRpbWVyc19zdGF0ZS5pY291bnRfdGltZV9z
aGlmdCwKICAgICAgICAgICAgICAgICAgICB0aW1lcnNfc3RhdGUuaWNvdW50X3RpbWVfc2hpZnQg
LSAxKTsKICAgICB9CiAgICAgaWYgKGRlbHRhIDwgMAogICAgICAgICAmJiBsYXN0X2RlbHRhIC0g
SUNPVU5UX1dPQkJMRSA+IGRlbHRhICogMgogICAgICAgICAmJiB0aW1lcnNfc3RhdGUuaWNvdW50
X3RpbWVfc2hpZnQgPCBNQVhfSUNPVU5UX1NISUZUKSB7CiAgICAgICAgIC8qIFRoZSBndWVzdCBp
cyBnZXR0aW5nIHRvbyBmYXIgYmVoaW5kLiAgU3BlZWQgdGltZSB1cC4gICovCi0gICAgICAgIGF0
b21pY19zZXQoJnRpbWVyc19zdGF0ZS5pY291bnRfdGltZV9zaGlmdCwKKyAgICAgICAgcWF0b21p
Y19zZXQoJnRpbWVyc19zdGF0ZS5pY291bnRfdGltZV9zaGlmdCwKICAgICAgICAgICAgICAgICAg
ICB0aW1lcnNfc3RhdGUuaWNvdW50X3RpbWVfc2hpZnQgKyAxKTsKICAgICB9CiAgICAgbGFzdF9k
ZWx0YSA9IGRlbHRhOwotICAgIGF0b21pY19zZXRfaTY0KCZ0aW1lcnNfc3RhdGUucWVtdV9pY291
bnRfYmlhcywKKyAgICBxYXRvbWljX3NldF9pNjQoJnRpbWVyc19zdGF0ZS5xZW11X2ljb3VudF9i
aWFzLAogICAgICAgICAgICAgICAgICAgIGN1cl9pY291bnQgLSAodGltZXJzX3N0YXRlLnFlbXVf
aWNvdW50CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8PCB0aW1lcnNfc3RhdGUu
aWNvdW50X3RpbWVfc2hpZnQpKTsKICAgICBzZXFsb2NrX3dyaXRlX3VubG9jaygmdGltZXJzX3N0
YXRlLnZtX2Nsb2NrX3NlcWxvY2ssCkBAIC00MjgsNyArNDI4LDcgQEAgc3RhdGljIHZvaWQgaWNv
dW50X2FkanVzdF92bSh2b2lkICpvcGFxdWUpCiAKIHN0YXRpYyBpbnQ2NF90IHFlbXVfaWNvdW50
X3JvdW5kKGludDY0X3QgY291bnQpCiB7Ci0gICAgaW50IHNoaWZ0ID0gYXRvbWljX3JlYWQoJnRp
bWVyc19zdGF0ZS5pY291bnRfdGltZV9zaGlmdCk7CisgICAgaW50IHNoaWZ0ID0gcWF0b21pY19y
ZWFkKCZ0aW1lcnNfc3RhdGUuaWNvdW50X3RpbWVfc2hpZnQpOwogICAgIHJldHVybiAoY291bnQg
KyAoMSA8PCBzaGlmdCkgLSAxKSA+PiBzaGlmdDsKIH0KIApAQCAtNDY2LDcgKzQ2Niw3IEBAIHN0
YXRpYyB2b2lkIGljb3VudF93YXJwX3J0KHZvaWQpCiAgICAgICAgICAgICBpbnQ2NF90IGRlbHRh
ID0gY2xvY2sgLSBjdXJfaWNvdW50OwogICAgICAgICAgICAgd2FycF9kZWx0YSA9IE1JTih3YXJw
X2RlbHRhLCBkZWx0YSk7CiAgICAgICAgIH0KLSAgICAgICAgYXRvbWljX3NldF9pNjQoJnRpbWVy
c19zdGF0ZS5xZW11X2ljb3VudF9iaWFzLAorICAgICAgICBxYXRvbWljX3NldF9pNjQoJnRpbWVy
c19zdGF0ZS5xZW11X2ljb3VudF9iaWFzLAogICAgICAgICAgICAgICAgICAgICAgICB0aW1lcnNf
c3RhdGUucWVtdV9pY291bnRfYmlhcyArIHdhcnBfZGVsdGEpOwogICAgIH0KICAgICB0aW1lcnNf
c3RhdGUudm1fY2xvY2tfd2FycF9zdGFydCA9IC0xOwpAQCAtNDk5LDcgKzQ5OSw3IEBAIHZvaWQg
cXRlc3RfY2xvY2tfd2FycChpbnQ2NF90IGRlc3QpCiAKICAgICAgICAgc2VxbG9ja193cml0ZV9s
b2NrKCZ0aW1lcnNfc3RhdGUudm1fY2xvY2tfc2VxbG9jaywKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICZ0aW1lcnNfc3RhdGUudm1fY2xvY2tfbG9jayk7Ci0gICAgICAgIGF0b21pY19zZXRf
aTY0KCZ0aW1lcnNfc3RhdGUucWVtdV9pY291bnRfYmlhcywKKyAgICAgICAgcWF0b21pY19zZXRf
aTY0KCZ0aW1lcnNfc3RhdGUucWVtdV9pY291bnRfYmlhcywKICAgICAgICAgICAgICAgICAgICAg
ICAgdGltZXJzX3N0YXRlLnFlbXVfaWNvdW50X2JpYXMgKyB3YXJwKTsKICAgICAgICAgc2VxbG9j
a193cml0ZV91bmxvY2soJnRpbWVyc19zdGF0ZS52bV9jbG9ja19zZXFsb2NrLAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAmdGltZXJzX3N0YXRlLnZtX2Nsb2NrX2xvY2spOwpAQCAtNTgz
LDcgKzU4Myw3IEBAIHZvaWQgcWVtdV9zdGFydF93YXJwX3RpbWVyKHZvaWQpCiAgICAgICAgICAg
ICAgKi8KICAgICAgICAgICAgIHNlcWxvY2tfd3JpdGVfbG9jaygmdGltZXJzX3N0YXRlLnZtX2Ns
b2NrX3NlcWxvY2ssCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJnRpbWVyc19zdGF0
ZS52bV9jbG9ja19sb2NrKTsKLSAgICAgICAgICAgIGF0b21pY19zZXRfaTY0KCZ0aW1lcnNfc3Rh
dGUucWVtdV9pY291bnRfYmlhcywKKyAgICAgICAgICAgIHFhdG9taWNfc2V0X2k2NCgmdGltZXJz
X3N0YXRlLnFlbXVfaWNvdW50X2JpYXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1l
cnNfc3RhdGUucWVtdV9pY291bnRfYmlhcyArIGRlYWRsaW5lKTsKICAgICAgICAgICAgIHNlcWxv
Y2tfd3JpdGVfdW5sb2NrKCZ0aW1lcnNfc3RhdGUudm1fY2xvY2tfc2VxbG9jaywKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICZ0aW1lcnNfc3RhdGUudm1fY2xvY2tfbG9jayk7CkBA
IC04MzcsMTEgKzgzNywxMSBAQCBzdGF0aWMgdm9pZCBxZW11X2NwdV9raWNrX3JyX25leHRfY3B1
KHZvaWQpCiB7CiAgICAgQ1BVU3RhdGUgKmNwdTsKICAgICBkbyB7Ci0gICAgICAgIGNwdSA9IGF0
b21pY19tYl9yZWFkKCZ0Y2dfY3VycmVudF9ycl9jcHUpOworICAgICAgICBjcHUgPSBxYXRvbWlj
X21iX3JlYWQoJnRjZ19jdXJyZW50X3JyX2NwdSk7CiAgICAgICAgIGlmIChjcHUpIHsKICAgICAg
ICAgICAgIGNwdV9leGl0KGNwdSk7CiAgICAgICAgIH0KLSAgICB9IHdoaWxlIChjcHUgIT0gYXRv
bWljX21iX3JlYWQoJnRjZ19jdXJyZW50X3JyX2NwdSkpOworICAgIH0gd2hpbGUgKGNwdSAhPSBx
YXRvbWljX21iX3JlYWQoJnRjZ19jdXJyZW50X3JyX2NwdSkpOwogfQogCiAvKiBLaWNrIGFsbCBS
UiB2Q1BVcyAqLwpAQCAtMTExMCw3ICsxMTEwLDcgQEAgc3RhdGljIHZvaWQgcWVtdV9jcHVfc3Rv
cChDUFVTdGF0ZSAqY3B1LCBib29sIGV4aXQpCiAKIHN0YXRpYyB2b2lkIHFlbXVfd2FpdF9pb19l
dmVudF9jb21tb24oQ1BVU3RhdGUgKmNwdSkKIHsKLSAgICBhdG9taWNfbWJfc2V0KCZjcHUtPnRo
cmVhZF9raWNrZWQsIGZhbHNlKTsKKyAgICBxYXRvbWljX21iX3NldCgmY3B1LT50aHJlYWRfa2lj
a2VkLCBmYWxzZSk7CiAgICAgaWYgKGNwdS0+c3RvcCkgewogICAgICAgICBxZW11X2NwdV9zdG9w
KGNwdSwgZmFsc2UpOwogICAgIH0KQEAgLTEzNTYsNyArMTM1Niw3IEBAIHN0YXRpYyBpbnQgdGNn
X2NwdV9leGVjKENQVVN0YXRlICpjcHUpCiAgICAgcmV0ID0gY3B1X2V4ZWMoY3B1KTsKICAgICBj
cHVfZXhlY19lbmQoY3B1KTsKICNpZmRlZiBDT05GSUdfUFJPRklMRVIKLSAgICBhdG9taWNfc2V0
KCZ0Y2dfY3R4LT5wcm9mLmNwdV9leGVjX3RpbWUsCisgICAgcWF0b21pY19zZXQoJnRjZ19jdHgt
PnByb2YuY3B1X2V4ZWNfdGltZSwKICAgICAgICAgICAgICAgIHRjZ19jdHgtPnByb2YuY3B1X2V4
ZWNfdGltZSArIHByb2ZpbGVfZ2V0Y2xvY2soKSAtIHRpKTsKICNlbmRpZgogICAgIHJldHVybiBy
ZXQ7CkBAIC0xNDQzLDcgKzE0NDMsNyBAQCBzdGF0aWMgdm9pZCAqcWVtdV90Y2dfcnJfY3B1X3Ro
cmVhZF9mbih2b2lkICphcmcpCiAKICAgICAgICAgd2hpbGUgKGNwdSAmJiBjcHVfd29ya19saXN0
X2VtcHR5KGNwdSkgJiYgIWNwdS0+ZXhpdF9yZXF1ZXN0KSB7CiAKLSAgICAgICAgICAgIGF0b21p
Y19tYl9zZXQoJnRjZ19jdXJyZW50X3JyX2NwdSwgY3B1KTsKKyAgICAgICAgICAgIHFhdG9taWNf
bWJfc2V0KCZ0Y2dfY3VycmVudF9ycl9jcHUsIGNwdSk7CiAgICAgICAgICAgICBjdXJyZW50X2Nw
dSA9IGNwdTsKIAogICAgICAgICAgICAgcWVtdV9jbG9ja19lbmFibGUoUUVNVV9DTE9DS19WSVJU
VUFMLApAQCAtMTQ3OSwxMSArMTQ3OSwxMSBAQCBzdGF0aWMgdm9pZCAqcWVtdV90Y2dfcnJfY3B1
X3RocmVhZF9mbih2b2lkICphcmcpCiAgICAgICAgICAgICBjcHUgPSBDUFVfTkVYVChjcHUpOwog
ICAgICAgICB9IC8qIHdoaWxlIChjcHUgJiYgIWNwdS0+ZXhpdF9yZXF1ZXN0KS4uICovCiAKLSAg
ICAgICAgLyogRG9lcyBub3QgbmVlZCBhdG9taWNfbWJfc2V0IGJlY2F1c2UgYSBzcHVyaW91cyB3
YWtldXAgaXMgb2theS4gICovCi0gICAgICAgIGF0b21pY19zZXQoJnRjZ19jdXJyZW50X3JyX2Nw
dSwgTlVMTCk7CisgICAgICAgIC8qIERvZXMgbm90IG5lZWQgcWF0b21pY19tYl9zZXQgYmVjYXVz
ZSBhIHNwdXJpb3VzIHdha2V1cCBpcyBva2F5LiAgKi8KKyAgICAgICAgcWF0b21pY19zZXQoJnRj
Z19jdXJyZW50X3JyX2NwdSwgTlVMTCk7CiAKICAgICAgICAgaWYgKGNwdSAmJiBjcHUtPmV4aXRf
cmVxdWVzdCkgewotICAgICAgICAgICAgYXRvbWljX21iX3NldCgmY3B1LT5leGl0X3JlcXVlc3Qs
IDApOworICAgICAgICAgICAgcWF0b21pY19tYl9zZXQoJmNwdS0+ZXhpdF9yZXF1ZXN0LCAwKTsK
ICAgICAgICAgfQogCiAgICAgICAgIGlmICh1c2VfaWNvdW50ICYmIGFsbF9jcHVfdGhyZWFkc19p
ZGxlKCkpIHsKQEAgLTE2ODcsNyArMTY4Nyw3IEBAIHN0YXRpYyB2b2lkICpxZW11X3RjZ19jcHVf
dGhyZWFkX2ZuKHZvaWQgKmFyZykKICAgICAgICAgICAgIH0KICAgICAgICAgfQogCi0gICAgICAg
IGF0b21pY19tYl9zZXQoJmNwdS0+ZXhpdF9yZXF1ZXN0LCAwKTsKKyAgICAgICAgcWF0b21pY19t
Yl9zZXQoJmNwdS0+ZXhpdF9yZXF1ZXN0LCAwKTsKICAgICAgICAgcWVtdV93YWl0X2lvX2V2ZW50
KGNwdSk7CiAgICAgfSB3aGlsZSAoIWNwdS0+dW5wbHVnIHx8IGNwdV9jYW5fcnVuKGNwdSkpOwog
CkBAIC0xNzc2LDcgKzE3NzYsNyBAQCBib29sIHFlbXVfbXV0ZXhfaW90aHJlYWRfbG9ja2VkKHZv
aWQpCiAgKi8KIHZvaWQgcWVtdV9tdXRleF9sb2NrX2lvdGhyZWFkX2ltcGwoY29uc3QgY2hhciAq
ZmlsZSwgaW50IGxpbmUpCiB7Ci0gICAgUWVtdU11dGV4TG9ja0Z1bmMgYnFsX2xvY2sgPSBhdG9t
aWNfcmVhZCgmcWVtdV9icWxfbXV0ZXhfbG9ja19mdW5jKTsKKyAgICBRZW11TXV0ZXhMb2NrRnVu
YyBicWxfbG9jayA9IHFhdG9taWNfcmVhZCgmcWVtdV9icWxfbXV0ZXhfbG9ja19mdW5jKTsKIAog
ICAgIGdfYXNzZXJ0KCFxZW11X211dGV4X2lvdGhyZWFkX2xvY2tlZCgpKTsKICAgICBicWxfbG9j
aygmcWVtdV9nbG9iYWxfbXV0ZXgsIGZpbGUsIGxpbmUpOwpkaWZmIC0tZ2l0IGEvc29mdG1tdS9t
ZW1vcnkuYyBiL3NvZnRtbXUvbWVtb3J5LmMKaW5kZXggZDAzMGViNmY3Yy4uZGE1ZjkwZjE0MSAx
MDA2NDQKLS0tIGEvc29mdG1tdS9tZW1vcnkuYworKysgYi9zb2Z0bW11L21lbW9yeS5jCkBAIC0y
OTQsMTIgKzI5NCwxMiBAQCBzdGF0aWMgdm9pZCBmbGF0dmlld19kZXN0cm95KEZsYXRWaWV3ICp2
aWV3KQogCiBzdGF0aWMgYm9vbCBmbGF0dmlld19yZWYoRmxhdFZpZXcgKnZpZXcpCiB7Ci0gICAg
cmV0dXJuIGF0b21pY19mZXRjaF9pbmNfbm9uemVybygmdmlldy0+cmVmKSA+IDA7CisgICAgcmV0
dXJuIHFhdG9taWNfZmV0Y2hfaW5jX25vbnplcm8oJnZpZXctPnJlZikgPiAwOwogfQogCiB2b2lk
IGZsYXR2aWV3X3VucmVmKEZsYXRWaWV3ICp2aWV3KQogewotICAgIGlmIChhdG9taWNfZmV0Y2hf
ZGVjKCZ2aWV3LT5yZWYpID09IDEpIHsKKyAgICBpZiAocWF0b21pY19mZXRjaF9kZWMoJnZpZXct
PnJlZikgPT0gMSkgewogICAgICAgICB0cmFjZV9mbGF0dmlld19kZXN0cm95X3JjdSh2aWV3LCB2
aWV3LT5yb290KTsKICAgICAgICAgYXNzZXJ0KHZpZXctPnJvb3QpOwogICAgICAgICBjYWxsX3Jj
dSh2aWV3LCBmbGF0dmlld19kZXN0cm95LCByY3UpOwpAQCAtMTAyNyw3ICsxMDI3LDcgQEAgc3Rh
dGljIHZvaWQgYWRkcmVzc19zcGFjZV9zZXRfZmxhdHZpZXcoQWRkcmVzc1NwYWNlICphcykKICAg
ICB9CiAKICAgICAvKiBXcml0ZXMgYXJlIHByb3RlY3RlZCBieSB0aGUgQlFMLiAgKi8KLSAgICBh
dG9taWNfcmN1X3NldCgmYXMtPmN1cnJlbnRfbWFwLCBuZXdfdmlldyk7CisgICAgcWF0b21pY19y
Y3Vfc2V0KCZhcy0+Y3VycmVudF9tYXAsIG5ld192aWV3KTsKICAgICBpZiAob2xkX3ZpZXcpIHsK
ICAgICAgICAgZmxhdHZpZXdfdW5yZWYob2xkX3ZpZXcpOwogICAgIH0KZGlmZiAtLWdpdCBhL3Nv
ZnRtbXUvdmwuYyBiL3NvZnRtbXUvdmwuYwppbmRleCBmN2IxMDM0NjdjLi41MGQ4YzJlNDJlIDEw
MDY0NAotLS0gYS9zb2Z0bW11L3ZsLmMKKysrIGIvc29mdG1tdS92bC5jCkBAIC0xMzIwLDcgKzEz
MjAsNyBAQCBTaHV0ZG93bkNhdXNlIHFlbXVfcmVzZXRfcmVxdWVzdGVkX2dldCh2b2lkKQogCiBz
dGF0aWMgaW50IHFlbXVfc2h1dGRvd25fcmVxdWVzdGVkKHZvaWQpCiB7Ci0gICAgcmV0dXJuIGF0
b21pY194Y2hnKCZzaHV0ZG93bl9yZXF1ZXN0ZWQsIFNIVVRET1dOX0NBVVNFX05PTkUpOworICAg
IHJldHVybiBxYXRvbWljX3hjaGcoJnNodXRkb3duX3JlcXVlc3RlZCwgU0hVVERPV05fQ0FVU0Vf
Tk9ORSk7CiB9CiAKIHN0YXRpYyB2b2lkIHFlbXVfa2lsbF9yZXBvcnQodm9pZCkKZGlmZiAtLWdp
dCBhL3RhcmdldC9hcm0vbXRlX2hlbHBlci5jIGIvdGFyZ2V0L2FybS9tdGVfaGVscGVyLmMKaW5k
ZXggODkxMzA2ZjViMC4uNTYxNWM2NzA2YyAxMDA2NDQKLS0tIGEvdGFyZ2V0L2FybS9tdGVfaGVs
cGVyLmMKKysrIGIvdGFyZ2V0L2FybS9tdGVfaGVscGVyLmMKQEAgLTMxMywxMSArMzEzLDExIEBA
IHN0YXRpYyB2b2lkIHN0b3JlX3RhZzEodWludDY0X3QgcHRyLCB1aW50OF90ICptZW0sIGludCB0
YWcpCiBzdGF0aWMgdm9pZCBzdG9yZV90YWcxX3BhcmFsbGVsKHVpbnQ2NF90IHB0ciwgdWludDhf
dCAqbWVtLCBpbnQgdGFnKQogewogICAgIGludCBvZnMgPSBleHRyYWN0MzIocHRyLCBMT0cyX1RB
R19HUkFOVUxFLCAxKSAqIDQ7Ci0gICAgdWludDhfdCBvbGQgPSBhdG9taWNfcmVhZChtZW0pOwor
ICAgIHVpbnQ4X3Qgb2xkID0gcWF0b21pY19yZWFkKG1lbSk7CiAKICAgICB3aGlsZSAoMSkgewog
ICAgICAgICB1aW50OF90IG5ldyA9IGRlcG9zaXQzMihvbGQsIG9mcywgNCwgdGFnKTsKLSAgICAg
ICAgdWludDhfdCBjbXAgPSBhdG9taWNfY21weGNoZyhtZW0sIG9sZCwgbmV3KTsKKyAgICAgICAg
dWludDhfdCBjbXAgPSBxYXRvbWljX2NtcHhjaGcobWVtLCBvbGQsIG5ldyk7CiAgICAgICAgIGlm
IChsaWtlbHkoY21wID09IG9sZCkpIHsKICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgfQpA
QCAtMzk4LDcgKzM5OCw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBkb19zdDJnKENQVUFSTVN0YXRl
ICplbnYsIHVpbnQ2NF90IHB0ciwgdWludDY0X3QgeHQsCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgMiAqIFRBR19HUkFOVUxFLCBNTVVfREFUQV9TVE9SRSwgMSwgcmEpOwogICAg
ICAgICBpZiAobWVtMSkgewogICAgICAgICAgICAgdGFnIHw9IHRhZyA8PCA0OwotICAgICAgICAg
ICAgYXRvbWljX3NldChtZW0xLCB0YWcpOworICAgICAgICAgICAgcWF0b21pY19zZXQobWVtMSwg
dGFnKTsKICAgICAgICAgfQogICAgIH0KIH0KZGlmZiAtLWdpdCBhL3RhcmdldC9ocHBhL29wX2hl
bHBlci5jIGIvdGFyZ2V0L2hwcGEvb3BfaGVscGVyLmMKaW5kZXggNTY4NWUzMDNhYi4uMzkzNjFk
Mzc1OSAxMDA2NDQKLS0tIGEvdGFyZ2V0L2hwcGEvb3BfaGVscGVyLmMKKysrIGIvdGFyZ2V0L2hw
cGEvb3BfaGVscGVyLmMKQEAgLTY3LDcgKzY3LDcgQEAgc3RhdGljIHZvaWQgYXRvbWljX3N0b3Jl
XzMoQ1BVSFBQQVN0YXRlICplbnYsIHRhcmdldF91bG9uZyBhZGRyLCB1aW50MzJfdCB2YWwsCiAg
ICAgb2xkID0gKmhhZGRyOwogICAgIHdoaWxlICgxKSB7CiAgICAgICAgIG5ldyA9IChvbGQgJiB+
bWFzaykgfCAodmFsICYgbWFzayk7Ci0gICAgICAgIGNtcCA9IGF0b21pY19jbXB4Y2hnKGhhZGRy
LCBvbGQsIG5ldyk7CisgICAgICAgIGNtcCA9IHFhdG9taWNfY21weGNoZyhoYWRkciwgb2xkLCBu
ZXcpOwogICAgICAgICBpZiAoY21wID09IG9sZCkgewogICAgICAgICAgICAgcmV0dXJuOwogICAg
ICAgICB9CmRpZmYgLS1naXQgYS90YXJnZXQvaTM4Ni9tZW1faGVscGVyLmMgYi90YXJnZXQvaTM4
Ni9tZW1faGVscGVyLmMKaW5kZXggYWNmNDFmODg4NS4uM2E2ZDNhZTJlZiAxMDA2NDQKLS0tIGEv
dGFyZ2V0L2kzODYvbWVtX2hlbHBlci5jCisrKyBiL3RhcmdldC9pMzg2L21lbV9oZWxwZXIuYwpA
QCAtNjgsNyArNjgsNyBAQCB2b2lkIGhlbHBlcl9jbXB4Y2hnOGIoQ1BVWDg2U3RhdGUgKmVudiwg
dGFyZ2V0X3Vsb25nIGEwKQogICAgICAgICB1aW50NjRfdCAqaGFkZHIgPSBnMmgoYTApOwogICAg
ICAgICBjbXB2ID0gY3B1X3RvX2xlNjQoY21wdik7CiAgICAgICAgIG5ld3YgPSBjcHVfdG9fbGU2
NChuZXd2KTsKLSAgICAgICAgb2xkdiA9IGF0b21pY19jbXB4Y2hnX19ub2NoZWNrKGhhZGRyLCBj
bXB2LCBuZXd2KTsKKyAgICAgICAgb2xkdiA9IHFhdG9taWNfY21weGNoZ19fbm9jaGVjayhoYWRk
ciwgY21wdiwgbmV3dik7CiAgICAgICAgIG9sZHYgPSBsZTY0X3RvX2NwdShvbGR2KTsKICAgICB9
CiAjZWxzZQpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2kzODYvd2hweC1hbGwuYyBiL3RhcmdldC9pMzg2
L3docHgtYWxsLmMKaW5kZXggYzc4YmFhYzZkZi4uNWEwZjMzN2E0YyAxMDA2NDQKLS0tIGEvdGFy
Z2V0L2kzODYvd2hweC1hbGwuYworKysgYi90YXJnZXQvaTM4Ni93aHB4LWFsbC5jCkBAIC05NDYs
NyArOTQ2LDcgQEAgc3RhdGljIGludCB3aHB4X3ZjcHVfcnVuKENQVVN0YXRlICpjcHUpCiAgICAg
d2hweF92Y3B1X3Byb2Nlc3NfYXN5bmNfZXZlbnRzKGNwdSk7CiAgICAgaWYgKGNwdS0+aGFsdGVk
KSB7CiAgICAgICAgIGNwdS0+ZXhjZXB0aW9uX2luZGV4ID0gRVhDUF9ITFQ7Ci0gICAgICAgIGF0
b21pY19zZXQoJmNwdS0+ZXhpdF9yZXF1ZXN0LCBmYWxzZSk7CisgICAgICAgIHFhdG9taWNfc2V0
KCZjcHUtPmV4aXRfcmVxdWVzdCwgZmFsc2UpOwogICAgICAgICByZXR1cm4gMDsKICAgICB9CiAK
QEAgLTk2MSw3ICs5NjEsNyBAQCBzdGF0aWMgaW50IHdocHhfdmNwdV9ydW4oQ1BVU3RhdGUgKmNw
dSkKIAogICAgICAgICB3aHB4X3ZjcHVfcHJlX3J1bihjcHUpOwogCi0gICAgICAgIGlmIChhdG9t
aWNfcmVhZCgmY3B1LT5leGl0X3JlcXVlc3QpKSB7CisgICAgICAgIGlmIChxYXRvbWljX3JlYWQo
JmNwdS0+ZXhpdF9yZXF1ZXN0KSkgewogICAgICAgICAgICAgd2hweF92Y3B1X2tpY2soY3B1KTsK
ICAgICAgICAgfQogCkBAIC0xMTEzLDcgKzExMTMsNyBAQCBzdGF0aWMgaW50IHdocHhfdmNwdV9y
dW4oQ1BVU3RhdGUgKmNwdSkKICAgICBxZW11X211dGV4X2xvY2tfaW90aHJlYWQoKTsKICAgICBj
dXJyZW50X2NwdSA9IGNwdTsKIAotICAgIGF0b21pY19zZXQoJmNwdS0+ZXhpdF9yZXF1ZXN0LCBm
YWxzZSk7CisgICAgcWF0b21pY19zZXQoJmNwdS0+ZXhpdF9yZXF1ZXN0LCBmYWxzZSk7CiAKICAg
ICByZXR1cm4gcmV0IDwgMDsKIH0KZGlmZiAtLWdpdCBhL3RhcmdldC9yaXNjdi9jcHVfaGVscGVy
LmMgYi90YXJnZXQvcmlzY3YvY3B1X2hlbHBlci5jCmluZGV4IGY0YzQxMTE1MzYuLjkwNDg5OTA1
NGQgMTAwNjQ0Ci0tLSBhL3RhcmdldC9yaXNjdi9jcHVfaGVscGVyLmMKKysrIGIvdGFyZ2V0L3Jp
c2N2L2NwdV9oZWxwZXIuYwpAQCAtNTM3LDcgKzUzNyw3IEBAIHJlc3RhcnQ6CiAgICAgICAgICAg
ICAgICAgICAgICpwdGVfcGEgPSBwdGUgPSB1cGRhdGVkX3B0ZTsKICNlbHNlCiAgICAgICAgICAg
ICAgICAgICAgIHRhcmdldF91bG9uZyBvbGRfcHRlID0KLSAgICAgICAgICAgICAgICAgICAgICAg
IGF0b21pY19jbXB4Y2hnKHB0ZV9wYSwgcHRlLCB1cGRhdGVkX3B0ZSk7CisgICAgICAgICAgICAg
ICAgICAgICAgICBxYXRvbWljX2NtcHhjaGcocHRlX3BhLCBwdGUsIHVwZGF0ZWRfcHRlKTsKICAg
ICAgICAgICAgICAgICAgICAgaWYgKG9sZF9wdGUgIT0gcHRlKSB7CiAgICAgICAgICAgICAgICAg
ICAgICAgICBnb3RvIHJlc3RhcnQ7CiAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CmRpZmYg
LS1naXQgYS90YXJnZXQvczM5MHgvbWVtX2hlbHBlci5jIGIvdGFyZ2V0L3MzOTB4L21lbV9oZWxw
ZXIuYwppbmRleCBhMjM3ZGVjNzU3Li5iZDI1ZWVkM2U4IDEwMDY0NAotLS0gYS90YXJnZXQvczM5
MHgvbWVtX2hlbHBlci5jCisrKyBiL3RhcmdldC9zMzkweC9tZW1faGVscGVyLmMKQEAgLTE3ODAs
NyArMTc4MCw3IEBAIHN0YXRpYyB1aW50MzJfdCBkb19jc3N0KENQVVMzOTBYU3RhdGUgKmVudiwg
dWludDMyX3QgcjMsIHVpbnQ2NF90IGExLAogICAgICAgICAgICAgaWYgKHBhcmFsbGVsKSB7CiAj
aWZkZWYgQ09ORklHX1VTRVJfT05MWQogICAgICAgICAgICAgICAgIHVpbnQzMl90ICpoYWRkciA9
IGcyaChhMSk7Ci0gICAgICAgICAgICAgICAgb3YgPSBhdG9taWNfY21weGNoZ19fbm9jaGVjayho
YWRkciwgY3YsIG52KTsKKyAgICAgICAgICAgICAgICBvdiA9IHFhdG9taWNfY21weGNoZ19fbm9j
aGVjayhoYWRkciwgY3YsIG52KTsKICNlbHNlCiAgICAgICAgICAgICAgICAgVENHTWVtT3BJZHgg
b2kgPSBtYWtlX21lbW9wX2lkeChNT19URVVMIHwgTU9fQUxJR04sIG1lbV9pZHgpOwogICAgICAg
ICAgICAgICAgIG92ID0gaGVscGVyX2F0b21pY19jbXB4Y2hnbF9iZV9tbXUoZW52LCBhMSwgY3Ys
IG52LCBvaSwgcmEpOwpAQCAtMTgwNCw3ICsxODA0LDcgQEAgc3RhdGljIHVpbnQzMl90IGRvX2Nz
c3QoQ1BVUzM5MFhTdGF0ZSAqZW52LCB1aW50MzJfdCByMywgdWludDY0X3QgYTEsCiAjaWZkZWYg
Q09ORklHX0FUT01JQzY0CiAjIGlmZGVmIENPTkZJR19VU0VSX09OTFkKICAgICAgICAgICAgICAg
ICB1aW50NjRfdCAqaGFkZHIgPSBnMmgoYTEpOwotICAgICAgICAgICAgICAgIG92ID0gYXRvbWlj
X2NtcHhjaGdfX25vY2hlY2soaGFkZHIsIGN2LCBudik7CisgICAgICAgICAgICAgICAgb3YgPSBx
YXRvbWljX2NtcHhjaGdfX25vY2hlY2soaGFkZHIsIGN2LCBudik7CiAjIGVsc2UKICAgICAgICAg
ICAgICAgICBUQ0dNZW1PcElkeCBvaSA9IG1ha2VfbWVtb3BfaWR4KE1PX1RFUSB8IE1PX0FMSUdO
LCBtZW1faWR4KTsKICAgICAgICAgICAgICAgICBvdiA9IGhlbHBlcl9hdG9taWNfY21weGNoZ3Ff
YmVfbW11KGVudiwgYTEsIGN2LCBudiwgb2ksIHJhKTsKZGlmZiAtLWdpdCBhL3RhcmdldC94dGVu
c2EvZXhjX2hlbHBlci5jIGIvdGFyZ2V0L3h0ZW5zYS9leGNfaGVscGVyLmMKaW5kZXggNThhNjRl
NmQ2Mi4uMmYwMzJiYzA1MyAxMDA2NDQKLS0tIGEvdGFyZ2V0L3h0ZW5zYS9leGNfaGVscGVyLmMK
KysrIGIvdGFyZ2V0L3h0ZW5zYS9leGNfaGVscGVyLmMKQEAgLTEyOCwxMyArMTI4LDEzIEBAIHZv
aWQgSEVMUEVSKGNoZWNrX2ludGVycnVwdHMpKENQVVh0ZW5zYVN0YXRlICplbnYpCiAKIHZvaWQg
SEVMUEVSKGludHNldCkoQ1BVWHRlbnNhU3RhdGUgKmVudiwgdWludDMyX3QgdikKIHsKLSAgICBh
dG9taWNfb3IoJmVudi0+c3JlZ3NbSU5UU0VUXSwKKyAgICBxYXRvbWljX29yKCZlbnYtPnNyZWdz
W0lOVFNFVF0sCiAgICAgICAgICAgICAgIHYgJiBlbnYtPmNvbmZpZy0+aW50dHlwZV9tYXNrW0lO
VFRZUEVfU09GVFdBUkVdKTsKIH0KIAogc3RhdGljIHZvaWQgaW50Y2xlYXIoQ1BVWHRlbnNhU3Rh
dGUgKmVudiwgdWludDMyX3QgdikKIHsKLSAgICBhdG9taWNfYW5kKCZlbnYtPnNyZWdzW0lOVFNF
VF0sIH52KTsKKyAgICBxYXRvbWljX2FuZCgmZW52LT5zcmVnc1tJTlRTRVRdLCB+dik7CiB9CiAK
IHZvaWQgSEVMUEVSKGludGNsZWFyKShDUFVYdGVuc2FTdGF0ZSAqZW52LCB1aW50MzJfdCB2KQpk
aWZmIC0tZ2l0IGEvdGFyZ2V0L3h0ZW5zYS9vcF9oZWxwZXIuYyBiL3RhcmdldC94dGVuc2Evb3Bf
aGVscGVyLmMKaW5kZXggMDlmNDk2MmQwMC4uMTQzNDc2ODQ5ZiAxMDA2NDQKLS0tIGEvdGFyZ2V0
L3h0ZW5zYS9vcF9oZWxwZXIuYworKysgYi90YXJnZXQveHRlbnNhL29wX2hlbHBlci5jCkBAIC02
Miw3ICs2Miw3IEBAIHZvaWQgSEVMUEVSKHVwZGF0ZV9jY29tcGFyZSkoQ1BVWHRlbnNhU3RhdGUg
KmVudiwgdWludDMyX3QgaSkKIHsKICAgICB1aW50NjRfdCBkY2M7CiAKLSAgICBhdG9taWNfYW5k
KCZlbnYtPnNyZWdzW0lOVFNFVF0sCisgICAgcWF0b21pY19hbmQoJmVudi0+c3JlZ3NbSU5UU0VU
XSwKICAgICAgICAgICAgICAgIH4oMXUgPDwgZW52LT5jb25maWctPnRpbWVyaW50W2ldKSk7CiAg
ICAgSEVMUEVSKHVwZGF0ZV9jY291bnQpKGVudik7CiAgICAgZGNjID0gKHVpbnQ2NF90KShlbnYt
PnNyZWdzW0NDT01QQVJFICsgaV0gLSBlbnYtPnNyZWdzW0NDT1VOVF0gLSAxKSArIDE7CmRpZmYg
LS1naXQgYS90Y2cvdGNnLmMgYi90Y2cvdGNnLmMKaW5kZXggNjJmMjk5ZTM2ZS4uMjg0YjFjMmEx
NSAxMDA2NDQKLS0tIGEvdGNnL3RjZy5jCisrKyBiL3RjZy90Y2cuYwpAQCAtNTk3LDcgKzU5Nyw3
IEBAIHN0YXRpYyBpbmxpbmUgYm9vbCB0Y2dfcmVnaW9uX2luaXRpYWxfYWxsb2NfX2xvY2tlZChU
Q0dDb250ZXh0ICpzKQogLyogQ2FsbCBmcm9tIGEgc2FmZS13b3JrIGNvbnRleHQgKi8KIHZvaWQg
dGNnX3JlZ2lvbl9yZXNldF9hbGwodm9pZCkKIHsKLSAgICB1bnNpZ25lZCBpbnQgbl9jdHhzID0g
YXRvbWljX3JlYWQoJm5fdGNnX2N0eHMpOworICAgIHVuc2lnbmVkIGludCBuX2N0eHMgPSBxYXRv
bWljX3JlYWQoJm5fdGNnX2N0eHMpOwogICAgIHVuc2lnbmVkIGludCBpOwogCiAgICAgcWVtdV9t
dXRleF9sb2NrKCZyZWdpb24ubG9jayk7CkBAIC02MDUsNyArNjA1LDcgQEAgdm9pZCB0Y2dfcmVn
aW9uX3Jlc2V0X2FsbCh2b2lkKQogICAgIHJlZ2lvbi5hZ2dfc2l6ZV9mdWxsID0gMDsKIAogICAg
IGZvciAoaSA9IDA7IGkgPCBuX2N0eHM7IGkrKykgewotICAgICAgICBUQ0dDb250ZXh0ICpzID0g
YXRvbWljX3JlYWQoJnRjZ19jdHhzW2ldKTsKKyAgICAgICAgVENHQ29udGV4dCAqcyA9IHFhdG9t
aWNfcmVhZCgmdGNnX2N0eHNbaV0pOwogICAgICAgICBib29sIGVyciA9IHRjZ19yZWdpb25faW5p
dGlhbF9hbGxvY19fbG9ja2VkKHMpOwogCiAgICAgICAgIGdfYXNzZXJ0KCFlcnIpOwpAQCAtNzk0
LDkgKzc5NCw5IEBAIHZvaWQgdGNnX3JlZ2lzdGVyX3RocmVhZCh2b2lkKQogICAgIH0KIAogICAg
IC8qIENsYWltIGFuIGVudHJ5IGluIHRjZ19jdHhzICovCi0gICAgbiA9IGF0b21pY19mZXRjaF9p
bmMoJm5fdGNnX2N0eHMpOworICAgIG4gPSBxYXRvbWljX2ZldGNoX2luYygmbl90Y2dfY3R4cyk7
CiAgICAgZ19hc3NlcnQobiA8IG1zLT5zbXAubWF4X2NwdXMpOwotICAgIGF0b21pY19zZXQoJnRj
Z19jdHhzW25dLCBzKTsKKyAgICBxYXRvbWljX3NldCgmdGNnX2N0eHNbbl0sIHMpOwogCiAgICAg
aWYgKG4gPiAwKSB7CiAgICAgICAgIGFsbG9jX3RjZ19wbHVnaW5fY29udGV4dChzKTsKQEAgLTgx
OSwxNyArODE5LDE3IEBAIHZvaWQgdGNnX3JlZ2lzdGVyX3RocmVhZCh2b2lkKQogICovCiBzaXpl
X3QgdGNnX2NvZGVfc2l6ZSh2b2lkKQogewotICAgIHVuc2lnbmVkIGludCBuX2N0eHMgPSBhdG9t
aWNfcmVhZCgmbl90Y2dfY3R4cyk7CisgICAgdW5zaWduZWQgaW50IG5fY3R4cyA9IHFhdG9taWNf
cmVhZCgmbl90Y2dfY3R4cyk7CiAgICAgdW5zaWduZWQgaW50IGk7CiAgICAgc2l6ZV90IHRvdGFs
OwogCiAgICAgcWVtdV9tdXRleF9sb2NrKCZyZWdpb24ubG9jayk7CiAgICAgdG90YWwgPSByZWdp
b24uYWdnX3NpemVfZnVsbDsKICAgICBmb3IgKGkgPSAwOyBpIDwgbl9jdHhzOyBpKyspIHsKLSAg
ICAgICAgY29uc3QgVENHQ29udGV4dCAqcyA9IGF0b21pY19yZWFkKCZ0Y2dfY3R4c1tpXSk7Cisg
ICAgICAgIGNvbnN0IFRDR0NvbnRleHQgKnMgPSBxYXRvbWljX3JlYWQoJnRjZ19jdHhzW2ldKTsK
ICAgICAgICAgc2l6ZV90IHNpemU7CiAKLSAgICAgICAgc2l6ZSA9IGF0b21pY19yZWFkKCZzLT5j
b2RlX2dlbl9wdHIpIC0gcy0+Y29kZV9nZW5fYnVmZmVyOworICAgICAgICBzaXplID0gcWF0b21p
Y19yZWFkKCZzLT5jb2RlX2dlbl9wdHIpIC0gcy0+Y29kZV9nZW5fYnVmZmVyOwogICAgICAgICBn
X2Fzc2VydChzaXplIDw9IHMtPmNvZGVfZ2VuX2J1ZmZlcl9zaXplKTsKICAgICAgICAgdG90YWwg
Kz0gc2l6ZTsKICAgICB9CkBAIC04NTUsMTQgKzg1NSwxNCBAQCBzaXplX3QgdGNnX2NvZGVfY2Fw
YWNpdHkodm9pZCkKIAogc2l6ZV90IHRjZ190Yl9waHlzX2ludmFsaWRhdGVfY291bnQodm9pZCkK
IHsKLSAgICB1bnNpZ25lZCBpbnQgbl9jdHhzID0gYXRvbWljX3JlYWQoJm5fdGNnX2N0eHMpOwor
ICAgIHVuc2lnbmVkIGludCBuX2N0eHMgPSBxYXRvbWljX3JlYWQoJm5fdGNnX2N0eHMpOwogICAg
IHVuc2lnbmVkIGludCBpOwogICAgIHNpemVfdCB0b3RhbCA9IDA7CiAKICAgICBmb3IgKGkgPSAw
OyBpIDwgbl9jdHhzOyBpKyspIHsKLSAgICAgICAgY29uc3QgVENHQ29udGV4dCAqcyA9IGF0b21p
Y19yZWFkKCZ0Y2dfY3R4c1tpXSk7CisgICAgICAgIGNvbnN0IFRDR0NvbnRleHQgKnMgPSBxYXRv
bWljX3JlYWQoJnRjZ19jdHhzW2ldKTsKIAotICAgICAgICB0b3RhbCArPSBhdG9taWNfcmVhZCgm
cy0+dGJfcGh5c19pbnZhbGlkYXRlX2NvdW50KTsKKyAgICAgICAgdG90YWwgKz0gcWF0b21pY19y
ZWFkKCZzLT50Yl9waHlzX2ludmFsaWRhdGVfY291bnQpOwogICAgIH0KICAgICByZXR1cm4gdG90
YWw7CiB9CkBAIC0xMDQxLDcgKzEwNDEsNyBAQCBUcmFuc2xhdGlvbkJsb2NrICp0Y2dfdGJfYWxs
b2MoVENHQ29udGV4dCAqcykKICAgICAgICAgfQogICAgICAgICBnb3RvIHJldHJ5OwogICAgIH0K
LSAgICBhdG9taWNfc2V0KCZzLT5jb2RlX2dlbl9wdHIsIG5leHQpOworICAgIHFhdG9taWNfc2V0
KCZzLT5jb2RlX2dlbl9wdHIsIG5leHQpOwogICAgIHMtPmRhdGFfZ2VuX3B0ciA9IE5VTEw7CiAg
ICAgcmV0dXJuIHRiOwogfQpAQCAtMjEzNCw3ICsyMTM0LDcgQEAgc3RhdGljIHZvaWQgdGNnX2R1
bXBfb3BzKFRDR0NvbnRleHQgKnMsIGJvb2wgaGF2ZV9wcmVmcykKICAgICAgICAgICAgIFFlbXVM
b2dGaWxlICpsb2dmaWxlOwogCiAgICAgICAgICAgICByY3VfcmVhZF9sb2NrKCk7Ci0gICAgICAg
ICAgICBsb2dmaWxlID0gYXRvbWljX3JjdV9yZWFkKCZxZW11X2xvZ2ZpbGUpOworICAgICAgICAg
ICAgbG9nZmlsZSA9IHFhdG9taWNfcmN1X3JlYWQoJnFlbXVfbG9nZmlsZSk7CiAgICAgICAgICAg
ICBpZiAobG9nZmlsZSkgewogICAgICAgICAgICAgICAgIGZvciAoOyBjb2wgPCA0MDsgKytjb2wp
IHsKICAgICAgICAgICAgICAgICAgICAgcHV0YygnICcsIGxvZ2ZpbGUtPmZkKTsKQEAgLTIzNDEs
NyArMjM0MSw3IEBAIHZvaWQgdGNnX29wX3JlbW92ZShUQ0dDb250ZXh0ICpzLCBUQ0dPcCAqb3Ap
CiAgICAgcy0+bmJfb3BzLS07CiAKICNpZmRlZiBDT05GSUdfUFJPRklMRVIKLSAgICBhdG9taWNf
c2V0KCZzLT5wcm9mLmRlbF9vcF9jb3VudCwgcy0+cHJvZi5kZWxfb3BfY291bnQgKyAxKTsKKyAg
ICBxYXRvbWljX3NldCgmcy0+cHJvZi5kZWxfb3BfY291bnQsIHMtPnByb2YuZGVsX29wX2NvdW50
ICsgMSk7CiAjZW5kaWYKIH0KIApAQCAtMzk2NCwxMiArMzk2NCwxMiBAQCBzdGF0aWMgdm9pZCB0
Y2dfcmVnX2FsbG9jX2NhbGwoVENHQ29udGV4dCAqcywgVENHT3AgKm9wKQogLyogYXZvaWQgY29w
eS9wYXN0ZSBlcnJvcnMgKi8KICNkZWZpbmUgUFJPRl9BREQodG8sIGZyb20sIGZpZWxkKSAgICAg
ICAgICAgICAgICAgICAgICAgXAogICAgIGRvIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBcCi0gICAgICAgICh0byktPmZpZWxkICs9IGF0b21pY19yZWFk
KCYoKGZyb20pLT5maWVsZCkpOyAgIFwKKyAgICAgICAgKHRvKS0+ZmllbGQgKz0gcWF0b21pY19y
ZWFkKCYoKGZyb20pLT5maWVsZCkpOyAgXAogICAgIH0gd2hpbGUgKDApCiAKICNkZWZpbmUgUFJP
Rl9NQVgodG8sIGZyb20sIGZpZWxkKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIFwKICAgICBkbyB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICAgICAgdHlwZW9mKChmcm9tKS0+ZmllbGQpIHZh
bF9fID0gYXRvbWljX3JlYWQoJigoZnJvbSktPmZpZWxkKSk7ICAgIFwKKyAgICAgICAgdHlwZW9m
KChmcm9tKS0+ZmllbGQpIHZhbF9fID0gcWF0b21pY19yZWFkKCYoKGZyb20pLT5maWVsZCkpOyAg
IFwKICAgICAgICAgaWYgKHZhbF9fID4gKHRvKS0+ZmllbGQpIHsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIFwKICAgICAgICAgICAgICh0byktPmZpZWxkID0gdmFsX187ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgICAgICAgfSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
QEAgLTM5NzksMTEgKzM5NzksMTEgQEAgc3RhdGljIHZvaWQgdGNnX3JlZ19hbGxvY19jYWxsKFRD
R0NvbnRleHQgKnMsIFRDR09wICpvcCkKIHN0YXRpYyBpbmxpbmUKIHZvaWQgdGNnX3Byb2ZpbGVf
c25hcHNob3QoVENHUHJvZmlsZSAqcHJvZiwgYm9vbCBjb3VudGVycywgYm9vbCB0YWJsZSkKIHsK
LSAgICB1bnNpZ25lZCBpbnQgbl9jdHhzID0gYXRvbWljX3JlYWQoJm5fdGNnX2N0eHMpOworICAg
IHVuc2lnbmVkIGludCBuX2N0eHMgPSBxYXRvbWljX3JlYWQoJm5fdGNnX2N0eHMpOwogICAgIHVu
c2lnbmVkIGludCBpOwogCiAgICAgZm9yIChpID0gMDsgaSA8IG5fY3R4czsgaSsrKSB7Ci0gICAg
ICAgIFRDR0NvbnRleHQgKnMgPSBhdG9taWNfcmVhZCgmdGNnX2N0eHNbaV0pOworICAgICAgICBU
Q0dDb250ZXh0ICpzID0gcWF0b21pY19yZWFkKCZ0Y2dfY3R4c1tpXSk7CiAgICAgICAgIGNvbnN0
IFRDR1Byb2ZpbGUgKm9yaWcgPSAmcy0+cHJvZjsKIAogICAgICAgICBpZiAoY291bnRlcnMpIHsK
QEAgLTQwNDIsMTUgKzQwNDIsMTUgQEAgdm9pZCB0Y2dfZHVtcF9vcF9jb3VudCh2b2lkKQogCiBp
bnQ2NF90IHRjZ19jcHVfZXhlY190aW1lKHZvaWQpCiB7Ci0gICAgdW5zaWduZWQgaW50IG5fY3R4
cyA9IGF0b21pY19yZWFkKCZuX3RjZ19jdHhzKTsKKyAgICB1bnNpZ25lZCBpbnQgbl9jdHhzID0g
cWF0b21pY19yZWFkKCZuX3RjZ19jdHhzKTsKICAgICB1bnNpZ25lZCBpbnQgaTsKICAgICBpbnQ2
NF90IHJldCA9IDA7CiAKICAgICBmb3IgKGkgPSAwOyBpIDwgbl9jdHhzOyBpKyspIHsKLSAgICAg
ICAgY29uc3QgVENHQ29udGV4dCAqcyA9IGF0b21pY19yZWFkKCZ0Y2dfY3R4c1tpXSk7CisgICAg
ICAgIGNvbnN0IFRDR0NvbnRleHQgKnMgPSBxYXRvbWljX3JlYWQoJnRjZ19jdHhzW2ldKTsKICAg
ICAgICAgY29uc3QgVENHUHJvZmlsZSAqcHJvZiA9ICZzLT5wcm9mOwogCi0gICAgICAgIHJldCAr
PSBhdG9taWNfcmVhZCgmcHJvZi0+Y3B1X2V4ZWNfdGltZSk7CisgICAgICAgIHJldCArPSBxYXRv
bWljX3JlYWQoJnByb2YtPmNwdV9leGVjX3RpbWUpOwogICAgIH0KICAgICByZXR1cm4gcmV0Owog
fQpAQCAtNDA4MywxNSArNDA4MywxNSBAQCBpbnQgdGNnX2dlbl9jb2RlKFRDR0NvbnRleHQgKnMs
IFRyYW5zbGF0aW9uQmxvY2sgKnRiKQogICAgICAgICBRVEFJTFFfRk9SRUFDSChvcCwgJnMtPm9w
cywgbGluaykgewogICAgICAgICAgICAgbisrOwogICAgICAgICB9Ci0gICAgICAgIGF0b21pY19z
ZXQoJnByb2YtPm9wX2NvdW50LCBwcm9mLT5vcF9jb3VudCArIG4pOworICAgICAgICBxYXRvbWlj
X3NldCgmcHJvZi0+b3BfY291bnQsIHByb2YtPm9wX2NvdW50ICsgbik7CiAgICAgICAgIGlmIChu
ID4gcHJvZi0+b3BfY291bnRfbWF4KSB7Ci0gICAgICAgICAgICBhdG9taWNfc2V0KCZwcm9mLT5v
cF9jb3VudF9tYXgsIG4pOworICAgICAgICAgICAgcWF0b21pY19zZXQoJnByb2YtPm9wX2NvdW50
X21heCwgbik7CiAgICAgICAgIH0KIAogICAgICAgICBuID0gcy0+bmJfdGVtcHM7Ci0gICAgICAg
IGF0b21pY19zZXQoJnByb2YtPnRlbXBfY291bnQsIHByb2YtPnRlbXBfY291bnQgKyBuKTsKKyAg
ICAgICAgcWF0b21pY19zZXQoJnByb2YtPnRlbXBfY291bnQsIHByb2YtPnRlbXBfY291bnQgKyBu
KTsKICAgICAgICAgaWYgKG4gPiBwcm9mLT50ZW1wX2NvdW50X21heCkgewotICAgICAgICAgICAg
YXRvbWljX3NldCgmcHJvZi0+dGVtcF9jb3VudF9tYXgsIG4pOworICAgICAgICAgICAgcWF0b21p
Y19zZXQoJnByb2YtPnRlbXBfY291bnRfbWF4LCBuKTsKICAgICAgICAgfQogICAgIH0KICNlbmRp
ZgpAQCAtNDEyNSw3ICs0MTI1LDcgQEAgaW50IHRjZ19nZW5fY29kZShUQ0dDb250ZXh0ICpzLCBU
cmFuc2xhdGlvbkJsb2NrICp0YikKICNlbmRpZgogCiAjaWZkZWYgQ09ORklHX1BST0ZJTEVSCi0g
ICAgYXRvbWljX3NldCgmcHJvZi0+b3B0X3RpbWUsIHByb2YtPm9wdF90aW1lIC0gcHJvZmlsZV9n
ZXRjbG9jaygpKTsKKyAgICBxYXRvbWljX3NldCgmcHJvZi0+b3B0X3RpbWUsIHByb2YtPm9wdF90
aW1lIC0gcHJvZmlsZV9nZXRjbG9jaygpKTsKICNlbmRpZgogCiAjaWZkZWYgVVNFX1RDR19PUFRJ
TUlaQVRJT05TCkBAIC00MTMzLDggKzQxMzMsOCBAQCBpbnQgdGNnX2dlbl9jb2RlKFRDR0NvbnRl
eHQgKnMsIFRyYW5zbGF0aW9uQmxvY2sgKnRiKQogI2VuZGlmCiAKICNpZmRlZiBDT05GSUdfUFJP
RklMRVIKLSAgICBhdG9taWNfc2V0KCZwcm9mLT5vcHRfdGltZSwgcHJvZi0+b3B0X3RpbWUgKyBw
cm9maWxlX2dldGNsb2NrKCkpOwotICAgIGF0b21pY19zZXQoJnByb2YtPmxhX3RpbWUsIHByb2Yt
PmxhX3RpbWUgLSBwcm9maWxlX2dldGNsb2NrKCkpOworICAgIHFhdG9taWNfc2V0KCZwcm9mLT5v
cHRfdGltZSwgcHJvZi0+b3B0X3RpbWUgKyBwcm9maWxlX2dldGNsb2NrKCkpOworICAgIHFhdG9t
aWNfc2V0KCZwcm9mLT5sYV90aW1lLCBwcm9mLT5sYV90aW1lIC0gcHJvZmlsZV9nZXRjbG9jaygp
KTsKICNlbmRpZgogCiAgICAgcmVhY2hhYmxlX2NvZGVfcGFzcyhzKTsKQEAgLTQxNTksNyArNDE1
OSw3IEBAIGludCB0Y2dfZ2VuX2NvZGUoVENHQ29udGV4dCAqcywgVHJhbnNsYXRpb25CbG9jayAq
dGIpCiAgICAgfQogCiAjaWZkZWYgQ09ORklHX1BST0ZJTEVSCi0gICAgYXRvbWljX3NldCgmcHJv
Zi0+bGFfdGltZSwgcHJvZi0+bGFfdGltZSArIHByb2ZpbGVfZ2V0Y2xvY2soKSk7CisgICAgcWF0
b21pY19zZXQoJnByb2YtPmxhX3RpbWUsIHByb2YtPmxhX3RpbWUgKyBwcm9maWxlX2dldGNsb2Nr
KCkpOwogI2VuZGlmCiAKICNpZmRlZiBERUJVR19ESVNBUwpAQCAtNDE5MCw3ICs0MTkwLDcgQEAg
aW50IHRjZ19nZW5fY29kZShUQ0dDb250ZXh0ICpzLCBUcmFuc2xhdGlvbkJsb2NrICp0YikKICAg
ICAgICAgVENHT3Bjb2RlIG9wYyA9IG9wLT5vcGM7CiAKICNpZmRlZiBDT05GSUdfUFJPRklMRVIK
LSAgICAgICAgYXRvbWljX3NldCgmcHJvZi0+dGFibGVfb3BfY291bnRbb3BjXSwgcHJvZi0+dGFi
bGVfb3BfY291bnRbb3BjXSArIDEpOworICAgICAgICBxYXRvbWljX3NldCgmcHJvZi0+dGFibGVf
b3BfY291bnRbb3BjXSwgcHJvZi0+dGFibGVfb3BfY291bnRbb3BjXSArIDEpOwogI2VuZGlmCiAK
ICAgICAgICAgc3dpdGNoIChvcGMpIHsKZGlmZiAtLWdpdCBhL3RjZy90Y2kuYyBiL3RjZy90Y2ku
YwppbmRleCA0NmZlOWNlNjNmLi44MjAzOWZkMTYzIDEwMDY0NAotLS0gYS90Y2cvdGNpLmMKKysr
IGIvdGNnL3RjaS5jCkBAIC0xMTE1LDcgKzExMTUsNyBAQCB1aW50cHRyX3QgdGNnX3FlbXVfdGJf
ZXhlYyhDUFVBcmNoU3RhdGUgKmVudiwgdWludDhfdCAqdGJfcHRyKQogICAgICAgICBjYXNlIElO
REVYX29wX2dvdG9fdGI6CiAgICAgICAgICAgICAvKiBKdW1wIGFkZHJlc3MgaXMgYWxpZ25lZCAq
LwogICAgICAgICAgICAgdGJfcHRyID0gUUVNVV9BTElHTl9QVFJfVVAodGJfcHRyLCA0KTsKLSAg
ICAgICAgICAgIHQwID0gYXRvbWljX3JlYWQoKGludDMyX3QgKil0Yl9wdHIpOworICAgICAgICAg
ICAgdDAgPSBxYXRvbWljX3JlYWQoKGludDMyX3QgKil0Yl9wdHIpOwogICAgICAgICAgICAgdGJf
cHRyICs9IHNpemVvZihpbnQzMl90KTsKICAgICAgICAgICAgIHRjaV9hc3NlcnQodGJfcHRyID09
IG9sZF9jb2RlX3B0ciArIG9wX3NpemUpOwogICAgICAgICAgICAgdGJfcHRyICs9IChpbnQzMl90
KXQwOwpkaWZmIC0tZ2l0IGEvdGVzdHMvYXRvbWljNjQtYmVuY2guYyBiL3Rlc3RzL2F0b21pYzY0
LWJlbmNoLmMKaW5kZXggMTIxYThjMTRmNC4uZTQ3NDc1M2QzNCAxMDA2NDQKLS0tIGEvdGVzdHMv
YXRvbWljNjQtYmVuY2guYworKysgYi90ZXN0cy9hdG9taWM2NC1iZW5jaC5jCkBAIC01NiwxNyAr
NTYsMTcgQEAgc3RhdGljIHZvaWQgKnRocmVhZF9mdW5jKHZvaWQgKmFyZykKIHsKICAgICBzdHJ1
Y3QgdGhyZWFkX2luZm8gKmluZm8gPSBhcmc7CiAKLSAgICBhdG9taWNfaW5jKCZuX3JlYWR5X3Ro
cmVhZHMpOwotICAgIHdoaWxlICghYXRvbWljX3JlYWQoJnRlc3Rfc3RhcnQpKSB7CisgICAgcWF0
b21pY19pbmMoJm5fcmVhZHlfdGhyZWFkcyk7CisgICAgd2hpbGUgKCFxYXRvbWljX3JlYWQoJnRl
c3Rfc3RhcnQpKSB7CiAgICAgICAgIGNwdV9yZWxheCgpOwogICAgIH0KIAotICAgIHdoaWxlICgh
YXRvbWljX3JlYWQoJnRlc3Rfc3RvcCkpIHsKKyAgICB3aGlsZSAoIXFhdG9taWNfcmVhZCgmdGVz
dF9zdG9wKSkgewogICAgICAgICB1bnNpZ25lZCBpbnQgaW5kZXg7CiAKICAgICAgICAgaW5mby0+
ciA9IHhvcnNoaWZ0NjRzdGFyKGluZm8tPnIpOwogICAgICAgICBpbmRleCA9IGluZm8tPnIgJiAo
cmFuZ2UgLSAxKTsKLSAgICAgICAgYXRvbWljX3JlYWRfaTY0KCZjb3VudHNbaW5kZXhdLmk2NCk7
CisgICAgICAgIHFhdG9taWNfcmVhZF9pNjQoJmNvdW50c1tpbmRleF0uaTY0KTsKICAgICAgICAg
aW5mby0+YWNjZXNzZXMrKzsKICAgICB9CiAgICAgcmV0dXJuIE5VTEw7CkBAIC03NiwxMyArNzYs
MTMgQEAgc3RhdGljIHZvaWQgcnVuX3Rlc3Qodm9pZCkKIHsKICAgICB1bnNpZ25lZCBpbnQgaTsK
IAotICAgIHdoaWxlIChhdG9taWNfcmVhZCgmbl9yZWFkeV90aHJlYWRzKSAhPSBuX3RocmVhZHMp
IHsKKyAgICB3aGlsZSAocWF0b21pY19yZWFkKCZuX3JlYWR5X3RocmVhZHMpICE9IG5fdGhyZWFk
cykgewogICAgICAgICBjcHVfcmVsYXgoKTsKICAgICB9CiAKLSAgICBhdG9taWNfc2V0KCZ0ZXN0
X3N0YXJ0LCB0cnVlKTsKKyAgICBxYXRvbWljX3NldCgmdGVzdF9zdGFydCwgdHJ1ZSk7CiAgICAg
Z191c2xlZXAoZHVyYXRpb24gKiBHX1VTRUNfUEVSX1NFQyk7Ci0gICAgYXRvbWljX3NldCgmdGVz
dF9zdG9wLCB0cnVlKTsKKyAgICBxYXRvbWljX3NldCgmdGVzdF9zdG9wLCB0cnVlKTsKIAogICAg
IGZvciAoaSA9IDA7IGkgPCBuX3RocmVhZHM7IGkrKykgewogICAgICAgICBxZW11X3RocmVhZF9q
b2luKCZ0aHJlYWRzW2ldKTsKZGlmZiAtLWdpdCBhL3Rlc3RzL2F0b21pY19hZGQtYmVuY2guYyBi
L3Rlc3RzL2F0b21pY19hZGQtYmVuY2guYwppbmRleCA1NjY2ZjZiYmZmLi5mMDU0NzFhYjQ1IDEw
MDY0NAotLS0gYS90ZXN0cy9hdG9taWNfYWRkLWJlbmNoLmMKKysrIGIvdGVzdHMvYXRvbWljX2Fk
ZC1iZW5jaC5jCkBAIC01MywxMiArNTMsMTIgQEAgc3RhdGljIHZvaWQgKnRocmVhZF9mdW5jKHZv
aWQgKmFyZykKIHsKICAgICBzdHJ1Y3QgdGhyZWFkX2luZm8gKmluZm8gPSBhcmc7CiAKLSAgICBh
dG9taWNfaW5jKCZuX3JlYWR5X3RocmVhZHMpOwotICAgIHdoaWxlICghYXRvbWljX3JlYWQoJnRl
c3Rfc3RhcnQpKSB7CisgICAgcWF0b21pY19pbmMoJm5fcmVhZHlfdGhyZWFkcyk7CisgICAgd2hp
bGUgKCFxYXRvbWljX3JlYWQoJnRlc3Rfc3RhcnQpKSB7CiAgICAgICAgIGNwdV9yZWxheCgpOwog
ICAgIH0KIAotICAgIHdoaWxlICghYXRvbWljX3JlYWQoJnRlc3Rfc3RvcCkpIHsKKyAgICB3aGls
ZSAoIXFhdG9taWNfcmVhZCgmdGVzdF9zdG9wKSkgewogICAgICAgICB1bnNpZ25lZCBpbnQgaW5k
ZXg7CiAKICAgICAgICAgaW5mby0+ciA9IHhvcnNoaWZ0NjRzdGFyKGluZm8tPnIpOwpAQCAtNjgs
NyArNjgsNyBAQCBzdGF0aWMgdm9pZCAqdGhyZWFkX2Z1bmModm9pZCAqYXJnKQogICAgICAgICAg
ICAgY291bnRzW2luZGV4XS52YWwgKz0gMTsKICAgICAgICAgICAgIHFlbXVfbXV0ZXhfdW5sb2Nr
KCZjb3VudHNbaW5kZXhdLmxvY2spOwogICAgICAgICB9IGVsc2UgewotICAgICAgICAgICAgYXRv
bWljX2luYygmY291bnRzW2luZGV4XS52YWwpOworICAgICAgICAgICAgcWF0b21pY19pbmMoJmNv
dW50c1tpbmRleF0udmFsKTsKICAgICAgICAgfQogICAgIH0KICAgICByZXR1cm4gTlVMTDsKQEAg
LTc4LDEzICs3OCwxMyBAQCBzdGF0aWMgdm9pZCBydW5fdGVzdCh2b2lkKQogewogICAgIHVuc2ln
bmVkIGludCBpOwogCi0gICAgd2hpbGUgKGF0b21pY19yZWFkKCZuX3JlYWR5X3RocmVhZHMpICE9
IG5fdGhyZWFkcykgeworICAgIHdoaWxlIChxYXRvbWljX3JlYWQoJm5fcmVhZHlfdGhyZWFkcykg
IT0gbl90aHJlYWRzKSB7CiAgICAgICAgIGNwdV9yZWxheCgpOwogICAgIH0KIAotICAgIGF0b21p
Y19zZXQoJnRlc3Rfc3RhcnQsIHRydWUpOworICAgIHFhdG9taWNfc2V0KCZ0ZXN0X3N0YXJ0LCB0
cnVlKTsKICAgICBnX3VzbGVlcChkdXJhdGlvbiAqIEdfVVNFQ19QRVJfU0VDKTsKLSAgICBhdG9t
aWNfc2V0KCZ0ZXN0X3N0b3AsIHRydWUpOworICAgIHFhdG9taWNfc2V0KCZ0ZXN0X3N0b3AsIHRy
dWUpOwogCiAgICAgZm9yIChpID0gMDsgaSA8IG5fdGhyZWFkczsgaSsrKSB7CiAgICAgICAgIHFl
bXVfdGhyZWFkX2pvaW4oJnRocmVhZHNbaV0pOwpkaWZmIC0tZ2l0IGEvdGVzdHMvaW90aHJlYWQu
YyBiL3Rlc3RzL2lvdGhyZWFkLmMKaW5kZXggZDNhMmVlOWEwMS4uYWZkZTEyYjRlZiAxMDA2NDQK
LS0tIGEvdGVzdHMvaW90aHJlYWQuYworKysgYi90ZXN0cy9pb3RocmVhZC5jCkBAIC03NCw3ICs3
NCw3IEBAIHN0YXRpYyB2b2lkICppb3RocmVhZF9ydW4odm9pZCAqb3BhcXVlKQogICAgIHFlbXVf
Y29uZF9zaWduYWwoJmlvdGhyZWFkLT5pbml0X2RvbmVfY29uZCk7CiAgICAgcWVtdV9tdXRleF91
bmxvY2soJmlvdGhyZWFkLT5pbml0X2RvbmVfbG9jayk7CiAKLSAgICB3aGlsZSAoIWF0b21pY19y
ZWFkKCZpb3RocmVhZC0+c3RvcHBpbmcpKSB7CisgICAgd2hpbGUgKCFxYXRvbWljX3JlYWQoJmlv
dGhyZWFkLT5zdG9wcGluZykpIHsKICAgICAgICAgYWlvX3BvbGwoaW90aHJlYWQtPmN0eCwgdHJ1
ZSk7CiAgICAgfQogCmRpZmYgLS1naXQgYS90ZXN0cy9xaHQtYmVuY2guYyBiL3Rlc3RzL3FodC1i
ZW5jaC5jCmluZGV4IDM2MmYwM2NiMDMuLjJlNWI3MGNjZDAgMTAwNjQ0Ci0tLSBhL3Rlc3RzL3Fo
dC1iZW5jaC5jCisrKyBiL3Rlc3RzL3FodC1iZW5jaC5jCkBAIC0yMDksMTMgKzIwOSwxMyBAQCBz
dGF0aWMgdm9pZCAqdGhyZWFkX2Z1bmModm9pZCAqcCkKIAogICAgIHJjdV9yZWdpc3Rlcl90aHJl
YWQoKTsKIAotICAgIGF0b21pY19pbmMoJm5fcmVhZHlfdGhyZWFkcyk7Ci0gICAgd2hpbGUgKCFh
dG9taWNfcmVhZCgmdGVzdF9zdGFydCkpIHsKKyAgICBxYXRvbWljX2luYygmbl9yZWFkeV90aHJl
YWRzKTsKKyAgICB3aGlsZSAoIXFhdG9taWNfcmVhZCgmdGVzdF9zdGFydCkpIHsKICAgICAgICAg
Y3B1X3JlbGF4KCk7CiAgICAgfQogCiAgICAgcmN1X3JlYWRfbG9jaygpOwotICAgIHdoaWxlICgh
YXRvbWljX3JlYWQoJnRlc3Rfc3RvcCkpIHsKKyAgICB3aGlsZSAoIXFhdG9taWNfcmVhZCgmdGVz
dF9zdG9wKSkgewogICAgICAgICBpbmZvLT5zZWVkID0geG9yc2hpZnQ2NHN0YXIoaW5mby0+c2Vl
ZCk7CiAgICAgICAgIGluZm8tPmZ1bmMoaW5mbyk7CiAgICAgfQpAQCAtNDIzLDEzICs0MjMsMTMg
QEAgc3RhdGljIHZvaWQgcnVuX3Rlc3Qodm9pZCkKIHsKICAgICBpbnQgaTsKIAotICAgIHdoaWxl
IChhdG9taWNfcmVhZCgmbl9yZWFkeV90aHJlYWRzKSAhPSBuX3J3X3RocmVhZHMgKyBuX3J6X3Ro
cmVhZHMpIHsKKyAgICB3aGlsZSAocWF0b21pY19yZWFkKCZuX3JlYWR5X3RocmVhZHMpICE9IG5f
cndfdGhyZWFkcyArIG5fcnpfdGhyZWFkcykgewogICAgICAgICBjcHVfcmVsYXgoKTsKICAgICB9
CiAKLSAgICBhdG9taWNfc2V0KCZ0ZXN0X3N0YXJ0LCB0cnVlKTsKKyAgICBxYXRvbWljX3NldCgm
dGVzdF9zdGFydCwgdHJ1ZSk7CiAgICAgZ191c2xlZXAoZHVyYXRpb24gKiBHX1VTRUNfUEVSX1NF
Qyk7Ci0gICAgYXRvbWljX3NldCgmdGVzdF9zdG9wLCB0cnVlKTsKKyAgICBxYXRvbWljX3NldCgm
dGVzdF9zdG9wLCB0cnVlKTsKIAogICAgIGZvciAoaSA9IDA7IGkgPCBuX3J3X3RocmVhZHM7IGkr
KykgewogICAgICAgICBxZW11X3RocmVhZF9qb2luKCZyd190aHJlYWRzW2ldKTsKZGlmZiAtLWdp
dCBhL3Rlc3RzL3JjdXRvcnR1cmUuYyBiL3Rlc3RzL3JjdXRvcnR1cmUuYwppbmRleCA3MzJmMDNh
YmRhLi5kZTZmNjQ5MDU4IDEwMDY0NAotLS0gYS90ZXN0cy9yY3V0b3J0dXJlLmMKKysrIGIvdGVz
dHMvcmN1dG9ydHVyZS5jCkBAIC0xMjMsNyArMTIzLDcgQEAgc3RhdGljIHZvaWQgKnJjdV9yZWFk
X3BlcmZfdGVzdCh2b2lkICphcmcpCiAgICAgcmN1X3JlZ2lzdGVyX3RocmVhZCgpOwogCiAgICAg
KihzdHJ1Y3QgcmN1X3JlYWRlcl9kYXRhICoqKWFyZyA9ICZyY3VfcmVhZGVyOwotICAgIGF0b21p
Y19pbmMoJm50aHJlYWRzcnVubmluZyk7CisgICAgcWF0b21pY19pbmMoJm50aHJlYWRzcnVubmlu
Zyk7CiAgICAgd2hpbGUgKGdvZmxhZyA9PSBHT0ZMQUdfSU5JVCkgewogICAgICAgICBnX3VzbGVl
cCgxMDAwKTsKICAgICB9CkBAIC0xNDksNyArMTQ5LDcgQEAgc3RhdGljIHZvaWQgKnJjdV91cGRh
dGVfcGVyZl90ZXN0KHZvaWQgKmFyZykKICAgICByY3VfcmVnaXN0ZXJfdGhyZWFkKCk7CiAKICAg
ICAqKHN0cnVjdCByY3VfcmVhZGVyX2RhdGEgKiopYXJnID0gJnJjdV9yZWFkZXI7Ci0gICAgYXRv
bWljX2luYygmbnRocmVhZHNydW5uaW5nKTsKKyAgICBxYXRvbWljX2luYygmbnRocmVhZHNydW5u
aW5nKTsKICAgICB3aGlsZSAoZ29mbGFnID09IEdPRkxBR19JTklUKSB7CiAgICAgICAgIGdfdXNs
ZWVwKDEwMDApOwogICAgIH0KQEAgLTE3Miw3ICsxNzIsNyBAQCBzdGF0aWMgdm9pZCBwZXJmdGVz
dGluaXQodm9pZCkKIAogc3RhdGljIHZvaWQgcGVyZnRlc3RydW4oaW50IG50aHJlYWRzLCBpbnQg
ZHVyYXRpb24sIGludCBucmVhZGVycywgaW50IG51cGRhdGVycykKIHsKLSAgICB3aGlsZSAoYXRv
bWljX3JlYWQoJm50aHJlYWRzcnVubmluZykgPCBudGhyZWFkcykgeworICAgIHdoaWxlIChxYXRv
bWljX3JlYWQoJm50aHJlYWRzcnVubmluZykgPCBudGhyZWFkcykgewogICAgICAgICBnX3VzbGVl
cCgxMDAwKTsKICAgICB9CiAgICAgZ29mbGFnID0gR09GTEFHX1JVTjsKQEAgLTI1OSw4ICsyNTks
OCBAQCBzdGF0aWMgdm9pZCAqcmN1X3JlYWRfc3RyZXNzX3Rlc3Qodm9pZCAqYXJnKQogICAgIH0K
ICAgICB3aGlsZSAoZ29mbGFnID09IEdPRkxBR19SVU4pIHsKICAgICAgICAgcmN1X3JlYWRfbG9j
aygpOwotICAgICAgICBwID0gYXRvbWljX3JjdV9yZWFkKCZyY3Vfc3RyZXNzX2N1cnJlbnQpOwot
ICAgICAgICBpZiAoYXRvbWljX3JlYWQoJnAtPm1idGVzdCkgPT0gMCkgeworICAgICAgICBwID0g
cWF0b21pY19yY3VfcmVhZCgmcmN1X3N0cmVzc19jdXJyZW50KTsKKyAgICAgICAgaWYgKHFhdG9t
aWNfcmVhZCgmcC0+bWJ0ZXN0KSA9PSAwKSB7CiAgICAgICAgICAgICBuX21iZXJyb3IrKzsKICAg
ICAgICAgfQogICAgICAgICByY3VfcmVhZF9sb2NrKCk7CkBAIC0yNjgsNyArMjY4LDcgQEAgc3Rh
dGljIHZvaWQgKnJjdV9yZWFkX3N0cmVzc190ZXN0KHZvaWQgKmFyZykKICAgICAgICAgICAgIGdh
cmJhZ2UrKzsKICAgICAgICAgfQogICAgICAgICByY3VfcmVhZF91bmxvY2soKTsKLSAgICAgICAg
cGMgPSBhdG9taWNfcmVhZCgmcC0+YWdlKTsKKyAgICAgICAgcGMgPSBxYXRvbWljX3JlYWQoJnAt
PmFnZSk7CiAgICAgICAgIHJjdV9yZWFkX3VubG9jaygpOwogICAgICAgICBpZiAoKHBjID4gUkNV
X1NUUkVTU19QSVBFX0xFTikgfHwgKHBjIDwgMCkpIHsKICAgICAgICAgICAgIHBjID0gUkNVX1NU
UkVTU19QSVBFX0xFTjsKQEAgLTMwMSw3ICszMDEsNyBAQCBzdGF0aWMgdm9pZCAqcmN1X3JlYWRf
c3RyZXNzX3Rlc3Qodm9pZCAqYXJnKQogc3RhdGljIHZvaWQgKnJjdV91cGRhdGVfc3RyZXNzX3Rl
c3Qodm9pZCAqYXJnKQogewogICAgIGludCBpLCByY3Vfc3RyZXNzX2lkeCA9IDA7Ci0gICAgc3Ry
dWN0IHJjdV9zdHJlc3MgKmNwID0gYXRvbWljX3JlYWQoJnJjdV9zdHJlc3NfY3VycmVudCk7Cisg
ICAgc3RydWN0IHJjdV9zdHJlc3MgKmNwID0gcWF0b21pY19yZWFkKCZyY3Vfc3RyZXNzX2N1cnJl
bnQpOwogCiAgICAgcmN1X3JlZ2lzdGVyX3RocmVhZCgpOwogICAgICooc3RydWN0IHJjdV9yZWFk
ZXJfZGF0YSAqKilhcmcgPSAmcmN1X3JlYWRlcjsKQEAgLTMxOSwxMSArMzE5LDExIEBAIHN0YXRp
YyB2b2lkICpyY3VfdXBkYXRlX3N0cmVzc190ZXN0KHZvaWQgKmFyZykKICAgICAgICAgcCA9ICZy
Y3Vfc3RyZXNzX2FycmF5W3JjdV9zdHJlc3NfaWR4XTsKICAgICAgICAgLyogY2F0Y2hpbmcgdXAg
d2l0aCBvdXJzZWx2ZXMgd291bGQgYmUgYSBidWcgKi8KICAgICAgICAgYXNzZXJ0KHAgIT0gY3Ap
OwotICAgICAgICBhdG9taWNfc2V0KCZwLT5tYnRlc3QsIDApOworICAgICAgICBxYXRvbWljX3Nl
dCgmcC0+bWJ0ZXN0LCAwKTsKICAgICAgICAgc21wX21iKCk7Ci0gICAgICAgIGF0b21pY19zZXQo
JnAtPmFnZSwgMCk7Ci0gICAgICAgIGF0b21pY19zZXQoJnAtPm1idGVzdCwgMSk7Ci0gICAgICAg
IGF0b21pY19yY3Vfc2V0KCZyY3Vfc3RyZXNzX2N1cnJlbnQsIHApOworICAgICAgICBxYXRvbWlj
X3NldCgmcC0+YWdlLCAwKTsKKyAgICAgICAgcWF0b21pY19zZXQoJnAtPm1idGVzdCwgMSk7Cisg
ICAgICAgIHFhdG9taWNfcmN1X3NldCgmcmN1X3N0cmVzc19jdXJyZW50LCBwKTsKICAgICAgICAg
Y3AgPSBwOwogICAgICAgICAvKgogICAgICAgICAgKiBOZXcgUkNVIHN0cnVjdHVyZSBpcyBub3cg
bGl2ZSwgdXBkYXRlIHBpcGUgY291bnRzIG9uIG9sZApAQCAtMzMxLDcgKzMzMSw3IEBAIHN0YXRp
YyB2b2lkICpyY3VfdXBkYXRlX3N0cmVzc190ZXN0KHZvaWQgKmFyZykKICAgICAgICAgICovCiAg
ICAgICAgIGZvciAoaSA9IDA7IGkgPCBSQ1VfU1RSRVNTX1BJUEVfTEVOOyBpKyspIHsKICAgICAg
ICAgICAgIGlmIChpICE9IHJjdV9zdHJlc3NfaWR4KSB7Ci0gICAgICAgICAgICAgICAgYXRvbWlj
X3NldCgmcmN1X3N0cmVzc19hcnJheVtpXS5hZ2UsCisgICAgICAgICAgICAgICAgcWF0b21pY19z
ZXQoJnJjdV9zdHJlc3NfYXJyYXlbaV0uYWdlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
cmN1X3N0cmVzc19hcnJheVtpXS5hZ2UgKyAxKTsKICAgICAgICAgICAgIH0KICAgICAgICAgfQpk
aWZmIC0tZ2l0IGEvdGVzdHMvdGVzdC1haW8tbXVsdGl0aHJlYWQuYyBiL3Rlc3RzL3Rlc3QtYWlv
LW11bHRpdGhyZWFkLmMKaW5kZXggZDMxNDRiZTdlMC4uYTU1NWNjODgzNSAxMDA2NDQKLS0tIGEv
dGVzdHMvdGVzdC1haW8tbXVsdGl0aHJlYWQuYworKysgYi90ZXN0cy90ZXN0LWFpby1tdWx0aXRo
cmVhZC5jCkBAIC0xMTgsMTYgKzExOCwxNiBAQCBzdGF0aWMgYm9vbCBzY2hlZHVsZV9uZXh0KGlu
dCBuKQogewogICAgIENvcm91dGluZSAqY287CiAKLSAgICBjbyA9IGF0b21pY194Y2hnKCZ0b19z
Y2hlZHVsZVtuXSwgTlVMTCk7CisgICAgY28gPSBxYXRvbWljX3hjaGcoJnRvX3NjaGVkdWxlW25d
LCBOVUxMKTsKICAgICBpZiAoIWNvKSB7Ci0gICAgICAgIGF0b21pY19pbmMoJmNvdW50X3JldHJ5
KTsKKyAgICAgICAgcWF0b21pY19pbmMoJmNvdW50X3JldHJ5KTsKICAgICAgICAgcmV0dXJuIGZh
bHNlOwogICAgIH0KIAogICAgIGlmIChuID09IGlkKSB7Ci0gICAgICAgIGF0b21pY19pbmMoJmNv
dW50X2hlcmUpOworICAgICAgICBxYXRvbWljX2luYygmY291bnRfaGVyZSk7CiAgICAgfSBlbHNl
IHsKLSAgICAgICAgYXRvbWljX2luYygmY291bnRfb3RoZXIpOworICAgICAgICBxYXRvbWljX2lu
YygmY291bnRfb3RoZXIpOwogICAgIH0KIAogICAgIGFpb19jb19zY2hlZHVsZShjdHhbbl0sIGNv
KTsKQEAgLTE0MywxMyArMTQzLDEzIEBAIHN0YXRpYyBjb3JvdXRpbmVfZm4gdm9pZCB0ZXN0X211
bHRpX2NvX3NjaGVkdWxlX2VudHJ5KHZvaWQgKm9wYXF1ZSkKIHsKICAgICBnX2Fzc2VydCh0b19z
Y2hlZHVsZVtpZF0gPT0gTlVMTCk7CiAKLSAgICB3aGlsZSAoIWF0b21pY19tYl9yZWFkKCZub3df
c3RvcHBpbmcpKSB7CisgICAgd2hpbGUgKCFxYXRvbWljX21iX3JlYWQoJm5vd19zdG9wcGluZykp
IHsKICAgICAgICAgaW50IG47CiAKICAgICAgICAgbiA9IGdfdGVzdF9yYW5kX2ludF9yYW5nZSgw
LCBOVU1fQ09OVEVYVFMpOwogICAgICAgICBzY2hlZHVsZV9uZXh0KG4pOwogCi0gICAgICAgIGF0
b21pY19tYl9zZXQoJnRvX3NjaGVkdWxlW2lkXSwgcWVtdV9jb3JvdXRpbmVfc2VsZigpKTsKKyAg
ICAgICAgcWF0b21pY19tYl9zZXQoJnRvX3NjaGVkdWxlW2lkXSwgcWVtdV9jb3JvdXRpbmVfc2Vs
ZigpKTsKICAgICAgICAgcWVtdV9jb3JvdXRpbmVfeWllbGQoKTsKICAgICAgICAgZ19hc3NlcnQo
dG9fc2NoZWR1bGVbaWRdID09IE5VTEwpOwogICAgIH0KQEAgLTE3MSw3ICsxNzEsNyBAQCBzdGF0
aWMgdm9pZCB0ZXN0X211bHRpX2NvX3NjaGVkdWxlKGludCBzZWNvbmRzKQogCiAgICAgZ191c2xl
ZXAoc2Vjb25kcyAqIDEwMDAwMDApOwogCi0gICAgYXRvbWljX21iX3NldCgmbm93X3N0b3BwaW5n
LCB0cnVlKTsKKyAgICBxYXRvbWljX21iX3NldCgmbm93X3N0b3BwaW5nLCB0cnVlKTsKICAgICBm
b3IgKGkgPSAwOyBpIDwgTlVNX0NPTlRFWFRTOyBpKyspIHsKICAgICAgICAgY3R4X3J1bihpLCBm
aW5pc2hfY2IsIE5VTEwpOwogICAgICAgICB0b19zY2hlZHVsZVtpXSA9IE5VTEw7CkBAIC0yMDIs
NyArMjAyLDcgQEAgc3RhdGljIENvTXV0ZXggY29tdXRleDsKIAogc3RhdGljIHZvaWQgY29yb3V0
aW5lX2ZuIHRlc3RfbXVsdGlfY29fbXV0ZXhfZW50cnkodm9pZCAqb3BhcXVlKQogewotICAgIHdo
aWxlICghYXRvbWljX21iX3JlYWQoJm5vd19zdG9wcGluZykpIHsKKyAgICB3aGlsZSAoIXFhdG9t
aWNfbWJfcmVhZCgmbm93X3N0b3BwaW5nKSkgewogICAgICAgICBxZW11X2NvX211dGV4X2xvY2so
JmNvbXV0ZXgpOwogICAgICAgICBjb3VudGVyKys7CiAgICAgICAgIHFlbXVfY29fbXV0ZXhfdW5s
b2NrKCZjb211dGV4KTsKQEAgLTIxMiw5ICsyMTIsOSBAQCBzdGF0aWMgdm9pZCBjb3JvdXRpbmVf
Zm4gdGVzdF9tdWx0aV9jb19tdXRleF9lbnRyeSh2b2lkICpvcGFxdWUpCiAgICAgICAgICAqIGV4
aXRzIGJlZm9yZSB0aGUgY29yb3V0aW5lIGlzIHdva2VuIHVwLCBjYXVzaW5nIGEgc3B1cmlvdXMK
ICAgICAgICAgICogYXNzZXJ0aW9uIGZhaWx1cmUuCiAgICAgICAgICAqLwotICAgICAgICBhdG9t
aWNfaW5jKCZhdG9taWNfY291bnRlcik7CisgICAgICAgIHFhdG9taWNfaW5jKCZhdG9taWNfY291
bnRlcik7CiAgICAgfQotICAgIGF0b21pY19kZWMoJnJ1bm5pbmcpOworICAgIHFhdG9taWNfZGVj
KCZydW5uaW5nKTsKIH0KIAogc3RhdGljIHZvaWQgdGVzdF9tdWx0aV9jb19tdXRleChpbnQgdGhy
ZWFkcywgaW50IHNlY29uZHMpCkBAIC0yMzYsNyArMjM2LDcgQEAgc3RhdGljIHZvaWQgdGVzdF9t
dWx0aV9jb19tdXRleChpbnQgdGhyZWFkcywgaW50IHNlY29uZHMpCiAKICAgICBnX3VzbGVlcChz
ZWNvbmRzICogMTAwMDAwMCk7CiAKLSAgICBhdG9taWNfbWJfc2V0KCZub3dfc3RvcHBpbmcsIHRy
dWUpOworICAgIHFhdG9taWNfbWJfc2V0KCZub3dfc3RvcHBpbmcsIHRydWUpOwogICAgIHdoaWxl
IChydW5uaW5nID4gMCkgewogICAgICAgICBnX3VzbGVlcCgxMDAwMDApOwogICAgIH0KQEAgLTI5
Niw5ICsyOTYsOSBAQCBzdGF0aWMgdm9pZCBtY3NfbXV0ZXhfbG9jayh2b2lkKQogCiAgICAgbm9k
ZXNbaWRdLm5leHQgPSAtMTsKICAgICBub2Rlc1tpZF0ubG9ja2VkID0gMTsKLSAgICBwcmV2ID0g
YXRvbWljX3hjaGcoJm11dGV4X2hlYWQsIGlkKTsKKyAgICBwcmV2ID0gcWF0b21pY194Y2hnKCZt
dXRleF9oZWFkLCBpZCk7CiAgICAgaWYgKHByZXYgIT0gLTEpIHsKLSAgICAgICAgYXRvbWljX3Nl
dCgmbm9kZXNbcHJldl0ubmV4dCwgaWQpOworICAgICAgICBxYXRvbWljX3NldCgmbm9kZXNbcHJl
dl0ubmV4dCwgaWQpOwogICAgICAgICBxZW11X2Z1dGV4X3dhaXQoJm5vZGVzW2lkXS5sb2NrZWQs
IDEpOwogICAgIH0KIH0KQEAgLTMwNiwxMyArMzA2LDEzIEBAIHN0YXRpYyB2b2lkIG1jc19tdXRl
eF9sb2NrKHZvaWQpCiBzdGF0aWMgdm9pZCBtY3NfbXV0ZXhfdW5sb2NrKHZvaWQpCiB7CiAgICAg
aW50IG5leHQ7Ci0gICAgaWYgKGF0b21pY19yZWFkKCZub2Rlc1tpZF0ubmV4dCkgPT0gLTEpIHsK
LSAgICAgICAgaWYgKGF0b21pY19yZWFkKCZtdXRleF9oZWFkKSA9PSBpZCAmJgotICAgICAgICAg
ICAgYXRvbWljX2NtcHhjaGcoJm11dGV4X2hlYWQsIGlkLCAtMSkgPT0gaWQpIHsKKyAgICBpZiAo
cWF0b21pY19yZWFkKCZub2Rlc1tpZF0ubmV4dCkgPT0gLTEpIHsKKyAgICAgICAgaWYgKHFhdG9t
aWNfcmVhZCgmbXV0ZXhfaGVhZCkgPT0gaWQgJiYKKyAgICAgICAgICAgIHFhdG9taWNfY21weGNo
ZygmbXV0ZXhfaGVhZCwgaWQsIC0xKSA9PSBpZCkgewogICAgICAgICAgICAgLyogTGFzdCBpdGVt
IGluIHRoZSBsaXN0LCBleGl0LiAgKi8KICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgfQot
ICAgICAgICB3aGlsZSAoYXRvbWljX3JlYWQoJm5vZGVzW2lkXS5uZXh0KSA9PSAtMSkgeworICAg
ICAgICB3aGlsZSAocWF0b21pY19yZWFkKCZub2Rlc1tpZF0ubmV4dCkgPT0gLTEpIHsKICAgICAg
ICAgICAgIC8qIG1jc19tdXRleF9sb2NrIGRpZCB0aGUgeGNoZywgYnV0IGhhcyBub3QgdXBkYXRl
ZAogICAgICAgICAgICAgICogbm9kZXNbcHJldl0ubmV4dCB5ZXQuCiAgICAgICAgICAgICAgKi8K
QEAgLTMyMCwyMCArMzIwLDIwIEBAIHN0YXRpYyB2b2lkIG1jc19tdXRleF91bmxvY2sodm9pZCkK
ICAgICB9CiAKICAgICAvKiBXYWtlIHVwIHRoZSBuZXh0IGluIGxpbmUuICAqLwotICAgIG5leHQg
PSBhdG9taWNfcmVhZCgmbm9kZXNbaWRdLm5leHQpOworICAgIG5leHQgPSBxYXRvbWljX3JlYWQo
Jm5vZGVzW2lkXS5uZXh0KTsKICAgICBub2Rlc1tuZXh0XS5sb2NrZWQgPSAwOwogICAgIHFlbXVf
ZnV0ZXhfd2FrZSgmbm9kZXNbbmV4dF0ubG9ja2VkLCAxKTsKIH0KIAogc3RhdGljIHZvaWQgdGVz
dF9tdWx0aV9mYWlyX211dGV4X2VudHJ5KHZvaWQgKm9wYXF1ZSkKIHsKLSAgICB3aGlsZSAoIWF0
b21pY19tYl9yZWFkKCZub3dfc3RvcHBpbmcpKSB7CisgICAgd2hpbGUgKCFxYXRvbWljX21iX3Jl
YWQoJm5vd19zdG9wcGluZykpIHsKICAgICAgICAgbWNzX211dGV4X2xvY2soKTsKICAgICAgICAg
Y291bnRlcisrOwogICAgICAgICBtY3NfbXV0ZXhfdW5sb2NrKCk7Ci0gICAgICAgIGF0b21pY19p
bmMoJmF0b21pY19jb3VudGVyKTsKKyAgICAgICAgcWF0b21pY19pbmMoJmF0b21pY19jb3VudGVy
KTsKICAgICB9Ci0gICAgYXRvbWljX2RlYygmcnVubmluZyk7CisgICAgcWF0b21pY19kZWMoJnJ1
bm5pbmcpOwogfQogCiBzdGF0aWMgdm9pZCB0ZXN0X211bHRpX2ZhaXJfbXV0ZXgoaW50IHRocmVh
ZHMsIGludCBzZWNvbmRzKQpAQCAtMzU1LDcgKzM1NSw3IEBAIHN0YXRpYyB2b2lkIHRlc3RfbXVs
dGlfZmFpcl9tdXRleChpbnQgdGhyZWFkcywgaW50IHNlY29uZHMpCiAKICAgICBnX3VzbGVlcChz
ZWNvbmRzICogMTAwMDAwMCk7CiAKLSAgICBhdG9taWNfbWJfc2V0KCZub3dfc3RvcHBpbmcsIHRy
dWUpOworICAgIHFhdG9taWNfbWJfc2V0KCZub3dfc3RvcHBpbmcsIHRydWUpOwogICAgIHdoaWxl
IChydW5uaW5nID4gMCkgewogICAgICAgICBnX3VzbGVlcCgxMDAwMDApOwogICAgIH0KQEAgLTM4
MywxMyArMzgzLDEzIEBAIHN0YXRpYyBRZW11TXV0ZXggbXV0ZXg7CiAKIHN0YXRpYyB2b2lkIHRl
c3RfbXVsdGlfbXV0ZXhfZW50cnkodm9pZCAqb3BhcXVlKQogewotICAgIHdoaWxlICghYXRvbWlj
X21iX3JlYWQoJm5vd19zdG9wcGluZykpIHsKKyAgICB3aGlsZSAoIXFhdG9taWNfbWJfcmVhZCgm
bm93X3N0b3BwaW5nKSkgewogICAgICAgICBxZW11X211dGV4X2xvY2soJm11dGV4KTsKICAgICAg
ICAgY291bnRlcisrOwogICAgICAgICBxZW11X211dGV4X3VubG9jaygmbXV0ZXgpOwotICAgICAg
ICBhdG9taWNfaW5jKCZhdG9taWNfY291bnRlcik7CisgICAgICAgIHFhdG9taWNfaW5jKCZhdG9t
aWNfY291bnRlcik7CiAgICAgfQotICAgIGF0b21pY19kZWMoJnJ1bm5pbmcpOworICAgIHFhdG9t
aWNfZGVjKCZydW5uaW5nKTsKIH0KIAogc3RhdGljIHZvaWQgdGVzdF9tdWx0aV9tdXRleChpbnQg
dGhyZWFkcywgaW50IHNlY29uZHMpCkBAIC00MTEsNyArNDExLDcgQEAgc3RhdGljIHZvaWQgdGVz
dF9tdWx0aV9tdXRleChpbnQgdGhyZWFkcywgaW50IHNlY29uZHMpCiAKICAgICBnX3VzbGVlcChz
ZWNvbmRzICogMTAwMDAwMCk7CiAKLSAgICBhdG9taWNfbWJfc2V0KCZub3dfc3RvcHBpbmcsIHRy
dWUpOworICAgIHFhdG9taWNfbWJfc2V0KCZub3dfc3RvcHBpbmcsIHRydWUpOwogICAgIHdoaWxl
IChydW5uaW5nID4gMCkgewogICAgICAgICBnX3VzbGVlcCgxMDAwMDApOwogICAgIH0KZGlmZiAt
LWdpdCBhL3Rlc3RzL3Rlc3QtbG9nZ2luZy5jIGIvdGVzdHMvdGVzdC1sb2dnaW5nLmMKaW5kZXgg
OGIxNTIyY2ZlZC4uY2NiODE5ZjE5MyAxMDA2NDQKLS0tIGEvdGVzdHMvdGVzdC1sb2dnaW5nLmMK
KysrIGIvdGVzdHMvdGVzdC1sb2dnaW5nLmMKQEAgLTEzMyw3ICsxMzMsNyBAQCBzdGF0aWMgdm9p
ZCB0ZXN0X2xvZ2ZpbGVfd3JpdGUoZ2NvbnN0cG9pbnRlciBkYXRhKQogICAgICAqLwogICAgIHFl
bXVfc2V0X2xvZ19maWxlbmFtZShmaWxlX3BhdGgsICZlcnJvcl9hYm9ydCk7CiAgICAgcmN1X3Jl
YWRfbG9jaygpOwotICAgIGxvZ2ZpbGUgPSBhdG9taWNfcmN1X3JlYWQoJnFlbXVfbG9nZmlsZSk7
CisgICAgbG9nZmlsZSA9IHFhdG9taWNfcmN1X3JlYWQoJnFlbXVfbG9nZmlsZSk7CiAgICAgb3Jp
Z19mZCA9IGxvZ2ZpbGUtPmZkOwogICAgIGdfYXNzZXJ0KGxvZ2ZpbGUgJiYgbG9nZmlsZS0+ZmQp
OwogICAgIGZwcmludGYobG9nZmlsZS0+ZmQsICIlcyAxc3Qgd3JpdGUgdG8gZmlsZVxuIiwgX19m
dW5jX18pOwpAQCAtMTQxLDcgKzE0MSw3IEBAIHN0YXRpYyB2b2lkIHRlc3RfbG9nZmlsZV93cml0
ZShnY29uc3Rwb2ludGVyIGRhdGEpCiAKICAgICAvKiBDaGFuZ2UgdGhlIGxvZ2ZpbGUgYW5kIGVu
c3VyZSB0aGF0IHRoZSBoYW5kbGUgaXMgc3RpbGwgdmFsaWQuICovCiAgICAgcWVtdV9zZXRfbG9n
X2ZpbGVuYW1lKGZpbGVfcGF0aDEsICZlcnJvcl9hYm9ydCk7Ci0gICAgbG9nZmlsZTIgPSBhdG9t
aWNfcmN1X3JlYWQoJnFlbXVfbG9nZmlsZSk7CisgICAgbG9nZmlsZTIgPSBxYXRvbWljX3JjdV9y
ZWFkKCZxZW11X2xvZ2ZpbGUpOwogICAgIGdfYXNzZXJ0KGxvZ2ZpbGUtPmZkID09IG9yaWdfZmQp
OwogICAgIGdfYXNzZXJ0KGxvZ2ZpbGUyLT5mZCAhPSBsb2dmaWxlLT5mZCk7CiAgICAgZnByaW50
Zihsb2dmaWxlLT5mZCwgIiVzIDJuZCB3cml0ZSB0byBmaWxlXG4iLCBfX2Z1bmNfXyk7CmRpZmYg
LS1naXQgYS90ZXN0cy90ZXN0LXJjdS1saXN0LmMgYi90ZXN0cy90ZXN0LXJjdS1saXN0LmMKaW5k
ZXggOTJiZTUxZWM1MC4uNDk2NDFlMTkzNiAxMDA2NDQKLS0tIGEvdGVzdHMvdGVzdC1yY3UtbGlz
dC5jCisrKyBiL3Rlc3RzL3Rlc3QtcmN1LWxpc3QuYwpAQCAtMTA2LDcgKzEwNiw3IEBAIHN0YXRp
YyB2b2lkIHJlY2xhaW1fbGlzdF9lbChzdHJ1Y3QgcmN1X2hlYWQgKnByY3UpCiAgICAgc3RydWN0
IGxpc3RfZWxlbWVudCAqZWwgPSBjb250YWluZXJfb2YocHJjdSwgc3RydWN0IGxpc3RfZWxlbWVu
dCwgcmN1KTsKICAgICBnX2ZyZWUoZWwpOwogICAgIC8qIEFjY2Vzc2VkIG9ubHkgZnJvbSBjYWxs
X3JjdSB0aHJlYWQuICAqLwotICAgIGF0b21pY19zZXRfaTY0KCZuX3JlY2xhaW1zLCBuX3JlY2xh
aW1zICsgMSk7CisgICAgcWF0b21pY19zZXRfaTY0KCZuX3JlY2xhaW1zLCBuX3JlY2xhaW1zICsg
MSk7CiB9CiAKICNpZiBURVNUX0xJU1RfVFlQRSA9PSAxCkBAIC0xNzIsMTYgKzE3MiwxNiBAQCBz
dGF0aWMgdm9pZCAqcmN1X3FfcmVhZGVyKHZvaWQgKmFyZykKICAgICByY3VfcmVnaXN0ZXJfdGhy
ZWFkKCk7CiAKICAgICAqKHN0cnVjdCByY3VfcmVhZGVyX2RhdGEgKiopYXJnID0gJnJjdV9yZWFk
ZXI7Ci0gICAgYXRvbWljX2luYygmbnRocmVhZHNydW5uaW5nKTsKLSAgICB3aGlsZSAoYXRvbWlj
X3JlYWQoJmdvZmxhZykgPT0gR09GTEFHX0lOSVQpIHsKKyAgICBxYXRvbWljX2luYygmbnRocmVh
ZHNydW5uaW5nKTsKKyAgICB3aGlsZSAocWF0b21pY19yZWFkKCZnb2ZsYWcpID09IEdPRkxBR19J
TklUKSB7CiAgICAgICAgIGdfdXNsZWVwKDEwMDApOwogICAgIH0KIAotICAgIHdoaWxlIChhdG9t
aWNfcmVhZCgmZ29mbGFnKSA9PSBHT0ZMQUdfUlVOKSB7CisgICAgd2hpbGUgKHFhdG9taWNfcmVh
ZCgmZ29mbGFnKSA9PSBHT0ZMQUdfUlVOKSB7CiAgICAgICAgIHJjdV9yZWFkX2xvY2soKTsKICAg
ICAgICAgVEVTVF9MSVNUX0ZPUkVBQ0hfUkNVKGVsLCAmUV9saXN0X2hlYWQsIGVudHJ5KSB7CiAg
ICAgICAgICAgICBuX3JlYWRzX2xvY2FsKys7Ci0gICAgICAgICAgICBpZiAoYXRvbWljX3JlYWQo
JmdvZmxhZykgPT0gR09GTEFHX1NUT1ApIHsKKyAgICAgICAgICAgIGlmIChxYXRvbWljX3JlYWQo
JmdvZmxhZykgPT0gR09GTEFHX1NUT1ApIHsKICAgICAgICAgICAgICAgICBicmVhazsKICAgICAg
ICAgICAgIH0KICAgICAgICAgfQpAQCAtMjA3LDEyICsyMDcsMTIgQEAgc3RhdGljIHZvaWQgKnJj
dV9xX3VwZGF0ZXIodm9pZCAqYXJnKQogICAgIHN0cnVjdCBsaXN0X2VsZW1lbnQgKmVsLCAqcHJl
dl9lbDsKIAogICAgICooc3RydWN0IHJjdV9yZWFkZXJfZGF0YSAqKilhcmcgPSAmcmN1X3JlYWRl
cjsKLSAgICBhdG9taWNfaW5jKCZudGhyZWFkc3J1bm5pbmcpOwotICAgIHdoaWxlIChhdG9taWNf
cmVhZCgmZ29mbGFnKSA9PSBHT0ZMQUdfSU5JVCkgeworICAgIHFhdG9taWNfaW5jKCZudGhyZWFk
c3J1bm5pbmcpOworICAgIHdoaWxlIChxYXRvbWljX3JlYWQoJmdvZmxhZykgPT0gR09GTEFHX0lO
SVQpIHsKICAgICAgICAgZ191c2xlZXAoMTAwMCk7CiAgICAgfQogCi0gICAgd2hpbGUgKGF0b21p
Y19yZWFkKCZnb2ZsYWcpID09IEdPRkxBR19SVU4pIHsKKyAgICB3aGlsZSAocWF0b21pY19yZWFk
KCZnb2ZsYWcpID09IEdPRkxBR19SVU4pIHsKICAgICAgICAgdGFyZ2V0X2VsID0gc2VsZWN0X3Jh
bmRvbV9lbChSQ1VfUV9MRU4pOwogICAgICAgICBqID0gMDsKICAgICAgICAgLyogRk9SRUFDSF9S
Q1UgY291bGQgd29yayBoZXJlIGJ1dCBsZXQncyB1c2UgYm90aCBtYWNyb3MgKi8KQEAgLTIyNiw3
ICsyMjYsNyBAQCBzdGF0aWMgdm9pZCAqcmN1X3FfdXBkYXRlcih2b2lkICphcmcpCiAgICAgICAg
ICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICB9CiAgICAgICAgIH0KLSAgICAgICAgaWYgKGF0
b21pY19yZWFkKCZnb2ZsYWcpID09IEdPRkxBR19TVE9QKSB7CisgICAgICAgIGlmIChxYXRvbWlj
X3JlYWQoJmdvZmxhZykgPT0gR09GTEFHX1NUT1ApIHsKICAgICAgICAgICAgIGJyZWFrOwogICAg
ICAgICB9CiAgICAgICAgIHRhcmdldF9lbCA9IHNlbGVjdF9yYW5kb21fZWwoUkNVX1FfTEVOKTsK
QEAgLTI0OCw3ICsyNDgsNyBAQCBzdGF0aWMgdm9pZCAqcmN1X3FfdXBkYXRlcih2b2lkICphcmcp
CiAgICAgcWVtdV9tdXRleF9sb2NrKCZjb3VudHNfbXV0ZXgpOwogICAgIG5fbm9kZXMgKz0gbl9u
b2Rlc19sb2NhbDsKICAgICBuX3VwZGF0ZXMgKz0gbl91cGRhdGVzX2xvY2FsOwotICAgIGF0b21p
Y19zZXRfaTY0KCZuX25vZGVzX3JlbW92ZWQsIG5fbm9kZXNfcmVtb3ZlZCArIG5fcmVtb3ZlZF9s
b2NhbCk7CisgICAgcWF0b21pY19zZXRfaTY0KCZuX25vZGVzX3JlbW92ZWQsIG5fbm9kZXNfcmVt
b3ZlZCArIG5fcmVtb3ZlZF9sb2NhbCk7CiAgICAgcWVtdV9tdXRleF91bmxvY2soJmNvdW50c19t
dXRleCk7CiAgICAgcmV0dXJuIE5VTEw7CiB9CkBAIC0yNzEsMTMgKzI3MSwxMyBAQCBzdGF0aWMg
dm9pZCByY3VfcXRlc3RfaW5pdCh2b2lkKQogc3RhdGljIHZvaWQgcmN1X3F0ZXN0X3J1bihpbnQg
ZHVyYXRpb24sIGludCBucmVhZGVycykKIHsKICAgICBpbnQgbnRocmVhZHMgPSBucmVhZGVycyAr
IDE7Ci0gICAgd2hpbGUgKGF0b21pY19yZWFkKCZudGhyZWFkc3J1bm5pbmcpIDwgbnRocmVhZHMp
IHsKKyAgICB3aGlsZSAocWF0b21pY19yZWFkKCZudGhyZWFkc3J1bm5pbmcpIDwgbnRocmVhZHMp
IHsKICAgICAgICAgZ191c2xlZXAoMTAwMCk7CiAgICAgfQogCi0gICAgYXRvbWljX3NldCgmZ29m
bGFnLCBHT0ZMQUdfUlVOKTsKKyAgICBxYXRvbWljX3NldCgmZ29mbGFnLCBHT0ZMQUdfUlVOKTsK
ICAgICBzbGVlcChkdXJhdGlvbik7Ci0gICAgYXRvbWljX3NldCgmZ29mbGFnLCBHT0ZMQUdfU1RP
UCk7CisgICAgcWF0b21pY19zZXQoJmdvZmxhZywgR09GTEFHX1NUT1ApOwogICAgIHdhaXRfYWxs
X3RocmVhZHMoKTsKIH0KIApAQCAtMzAyLDIxICszMDIsMjMgQEAgc3RhdGljIHZvaWQgcmN1X3F0
ZXN0KGNvbnN0IGNoYXIgKnRlc3QsIGludCBkdXJhdGlvbiwgaW50IG5yZWFkZXJzKQogICAgICAg
ICBuX3JlbW92ZWRfbG9jYWwrKzsKICAgICB9CiAgICAgcWVtdV9tdXRleF9sb2NrKCZjb3VudHNf
bXV0ZXgpOwotICAgIGF0b21pY19zZXRfaTY0KCZuX25vZGVzX3JlbW92ZWQsIG5fbm9kZXNfcmVt
b3ZlZCArIG5fcmVtb3ZlZF9sb2NhbCk7CisgICAgcWF0b21pY19zZXRfaTY0KCZuX25vZGVzX3Jl
bW92ZWQsIG5fbm9kZXNfcmVtb3ZlZCArIG5fcmVtb3ZlZF9sb2NhbCk7CiAgICAgcWVtdV9tdXRl
eF91bmxvY2soJmNvdW50c19tdXRleCk7CiAgICAgc3luY2hyb25pemVfcmN1KCk7Ci0gICAgd2hp
bGUgKGF0b21pY19yZWFkX2k2NCgmbl9ub2Rlc19yZW1vdmVkKSA+IGF0b21pY19yZWFkX2k2NCgm
bl9yZWNsYWltcykpIHsKKyAgICB3aGlsZSAocWF0b21pY19yZWFkX2k2NCgmbl9ub2Rlc19yZW1v
dmVkKSA+CisgICAgICAgICAgIHFhdG9taWNfcmVhZF9pNjQoJm5fcmVjbGFpbXMpKSB7CiAgICAg
ICAgIGdfdXNsZWVwKDEwMCk7CiAgICAgICAgIHN5bmNocm9uaXplX3JjdSgpOwogICAgIH0KICAg
ICBpZiAoZ190ZXN0X2luX2NoYXJnZSkgewotICAgICAgICBnX2Fzc2VydF9jbXBpbnQoYXRvbWlj
X3JlYWRfaTY0KCZuX25vZGVzX3JlbW92ZWQpLCA9PSwKLSAgICAgICAgICAgICAgICAgICAgICAg
IGF0b21pY19yZWFkX2k2NCgmbl9yZWNsYWltcykpOworICAgICAgICBnX2Fzc2VydF9jbXBpbnQo
cWF0b21pY19yZWFkX2k2NCgmbl9ub2Rlc19yZW1vdmVkKSwgPT0sCisgICAgICAgICAgICAgICAg
ICAgICAgICBxYXRvbWljX3JlYWRfaTY0KCZuX3JlY2xhaW1zKSk7CiAgICAgfSBlbHNlIHsKICAg
ICAgICAgcHJpbnRmKCIlczogJWQgcmVhZGVyczsgMSB1cGRhdGVyOyBub2RlcyByZWFkOiAiICBc
CiAgICAgICAgICAgICAgICAiJWxsZCwgbm9kZXMgcmVtb3ZlZDogJSJQUklpNjQiOyBub2RlcyBy
ZWNsYWltZWQ6ICUiUFJJaTY0IlxuIiwKICAgICAgICAgICAgICAgIHRlc3QsIG50aHJlYWRzcnVu
bmluZyAtIDEsIG5fcmVhZHMsCi0gICAgICAgICAgICAgICBhdG9taWNfcmVhZF9pNjQoJm5fbm9k
ZXNfcmVtb3ZlZCksIGF0b21pY19yZWFkX2k2NCgmbl9yZWNsYWltcykpOworICAgICAgICAgICAg
ICAgcWF0b21pY19yZWFkX2k2NCgmbl9ub2Rlc19yZW1vdmVkKSwKKyAgICAgICAgICAgICAgIHFh
dG9taWNfcmVhZF9pNjQoJm5fcmVjbGFpbXMpKTsKICAgICAgICAgZXhpdCgwKTsKICAgICB9CiB9
CmRpZmYgLS1naXQgYS90ZXN0cy90ZXN0LXRocmVhZC1wb29sLmMgYi90ZXN0cy90ZXN0LXRocmVh
ZC1wb29sLmMKaW5kZXggMGI2NzU5MjNmNi4uNzBkYzYzMTRhMSAxMDA2NDQKLS0tIGEvdGVzdHMv
dGVzdC10aHJlYWQtcG9vbC5jCisrKyBiL3Rlc3RzL3Rlc3QtdGhyZWFkLXBvb2wuYwpAQCAtMjEs
MTUgKzIxLDE1IEBAIHR5cGVkZWYgc3RydWN0IHsKIHN0YXRpYyBpbnQgd29ya2VyX2NiKHZvaWQg
Km9wYXF1ZSkKIHsKICAgICBXb3JrZXJUZXN0RGF0YSAqZGF0YSA9IG9wYXF1ZTsKLSAgICByZXR1
cm4gYXRvbWljX2ZldGNoX2luYygmZGF0YS0+bik7CisgICAgcmV0dXJuIHFhdG9taWNfZmV0Y2hf
aW5jKCZkYXRhLT5uKTsKIH0KIAogc3RhdGljIGludCBsb25nX2NiKHZvaWQgKm9wYXF1ZSkKIHsK
ICAgICBXb3JrZXJUZXN0RGF0YSAqZGF0YSA9IG9wYXF1ZTsKLSAgICBpZiAoYXRvbWljX2NtcHhj
aGcoJmRhdGEtPm4sIDAsIDEpID09IDApIHsKKyAgICBpZiAocWF0b21pY19jbXB4Y2hnKCZkYXRh
LT5uLCAwLCAxKSA9PSAwKSB7CiAgICAgICAgIGdfdXNsZWVwKDIwMDAwMDApOwotICAgICAgICBh
dG9taWNfb3IoJmRhdGEtPm4sIDIpOworICAgICAgICBxYXRvbWljX29yKCZkYXRhLT5uLCAyKTsK
ICAgICB9CiAgICAgcmV0dXJuIDA7CiB9CkBAIC0xNzIsNyArMTcyLDcgQEAgc3RhdGljIHZvaWQg
ZG9fdGVzdF9jYW5jZWwoYm9vbCBzeW5jKQogICAgIC8qIENhbmNlbCB0aGUgam9icyB0aGF0IGhh
dmVuJ3QgYmVlbiBzdGFydGVkIHlldC4gICovCiAgICAgbnVtX2NhbmNlbGVkID0gMDsKICAgICBm
b3IgKGkgPSAwOyBpIDwgMTAwOyBpKyspIHsKLSAgICAgICAgaWYgKGF0b21pY19jbXB4Y2hnKCZk
YXRhW2ldLm4sIDAsIDQpID09IDApIHsKKyAgICAgICAgaWYgKHFhdG9taWNfY21weGNoZygmZGF0
YVtpXS5uLCAwLCA0KSA9PSAwKSB7CiAgICAgICAgICAgICBkYXRhW2ldLnJldCA9IC1FQ0FOQ0VM
RUQ7CiAgICAgICAgICAgICBpZiAoc3luYykgewogICAgICAgICAgICAgICAgIGJkcnZfYWlvX2Nh
bmNlbChkYXRhW2ldLmFpb2NiKTsKQEAgLTE4Niw3ICsxODYsNyBAQCBzdGF0aWMgdm9pZCBkb190
ZXN0X2NhbmNlbChib29sIHN5bmMpCiAgICAgZ19hc3NlcnRfY21waW50KG51bV9jYW5jZWxlZCwg
PCwgMTAwKTsKIAogICAgIGZvciAoaSA9IDA7IGkgPCAxMDA7IGkrKykgewotICAgICAgICBpZiAo
ZGF0YVtpXS5haW9jYiAmJiBhdG9taWNfcmVhZCgmZGF0YVtpXS5uKSA8IDQpIHsKKyAgICAgICAg
aWYgKGRhdGFbaV0uYWlvY2IgJiYgcWF0b21pY19yZWFkKCZkYXRhW2ldLm4pIDwgNCkgewogICAg
ICAgICAgICAgaWYgKHN5bmMpIHsKICAgICAgICAgICAgICAgICAvKiBDYW5jZWxpbmcgdGhlIG90
aGVycyB3aWxsIGJlIGEgYmxvY2tpbmcgb3BlcmF0aW9uLiAgKi8KICAgICAgICAgICAgICAgICBi
ZHJ2X2Fpb19jYW5jZWwoZGF0YVtpXS5haW9jYik7CmRpZmYgLS1naXQgYS91dGlsL2Fpby1wb3Np
eC5jIGIvdXRpbC9haW8tcG9zaXguYwppbmRleCBmN2YxM2ViZmMyLi4yODBmMjdiYjk5IDEwMDY0
NAotLS0gYS91dGlsL2Fpby1wb3NpeC5jCisrKyBiL3V0aWwvYWlvLXBvc2l4LmMKQEAgLTI3LDcg
KzI3LDcgQEAKIAogYm9vbCBhaW9fcG9sbF9kaXNhYmxlZChBaW9Db250ZXh0ICpjdHgpCiB7Ci0g
ICAgcmV0dXJuIGF0b21pY19yZWFkKCZjdHgtPnBvbGxfZGlzYWJsZV9jbnQpOworICAgIHJldHVy
biBxYXRvbWljX3JlYWQoJmN0eC0+cG9sbF9kaXNhYmxlX2NudCk7CiB9CiAKIHZvaWQgYWlvX2Fk
ZF9yZWFkeV9oYW5kbGVyKEFpb0hhbmRsZXJMaXN0ICpyZWFkeV9saXN0LApAQCAtMTQ4LDggKzE0
OCw4IEBAIHZvaWQgYWlvX3NldF9mZF9oYW5kbGVyKEFpb0NvbnRleHQgKmN0eCwKICAgICAgKiBD
aGFuZ2luZyBoYW5kbGVycyBpcyBhIHJhcmUgZXZlbnQsIGFuZCBhIGxpdHRsZSB3YXN0ZWQgcG9s
bGluZyB1bnRpbAogICAgICAqIHRoZSBhaW9fbm90aWZ5IGJlbG93IGlzIG5vdCBhbiBpc3N1ZS4K
ICAgICAgKi8KLSAgICBhdG9taWNfc2V0KCZjdHgtPnBvbGxfZGlzYWJsZV9jbnQsCi0gICAgICAg
ICAgICAgICBhdG9taWNfcmVhZCgmY3R4LT5wb2xsX2Rpc2FibGVfY250KSArIHBvbGxfZGlzYWJs
ZV9jaGFuZ2UpOworICAgIHFhdG9taWNfc2V0KCZjdHgtPnBvbGxfZGlzYWJsZV9jbnQsCisgICAg
ICAgICAgICAgICBxYXRvbWljX3JlYWQoJmN0eC0+cG9sbF9kaXNhYmxlX2NudCkgKyBwb2xsX2Rp
c2FibGVfY2hhbmdlKTsKIAogICAgIGN0eC0+ZmRtb25fb3BzLT51cGRhdGUoY3R4LCBub2RlLCBu
ZXdfbm9kZSk7CiAgICAgaWYgKG5vZGUpIHsKQEAgLTU4MSw3ICs1ODEsNyBAQCBib29sIGFpb19w
b2xsKEFpb0NvbnRleHQgKmN0eCwgYm9vbCBibG9ja2luZykKICAgICAgKi8KICAgICB1c2Vfbm90
aWZ5X21lID0gdGltZW91dCAhPSAwOwogICAgIGlmICh1c2Vfbm90aWZ5X21lKSB7Ci0gICAgICAg
IGF0b21pY19zZXQoJmN0eC0+bm90aWZ5X21lLCBhdG9taWNfcmVhZCgmY3R4LT5ub3RpZnlfbWUp
ICsgMik7CisgICAgICAgIHFhdG9taWNfc2V0KCZjdHgtPm5vdGlmeV9tZSwgcWF0b21pY19yZWFk
KCZjdHgtPm5vdGlmeV9tZSkgKyAyKTsKICAgICAgICAgLyoKICAgICAgICAgICogV3JpdGUgY3R4
LT5ub3RpZnlfbWUgYmVmb3JlIHJlYWRpbmcgY3R4LT5ub3RpZmllZC4gIFBhaXJzIHdpdGgKICAg
ICAgICAgICogc21wX21iIGluIGFpb19ub3RpZnkoKS4KQEAgLTU4OSw3ICs1ODksNyBAQCBib29s
IGFpb19wb2xsKEFpb0NvbnRleHQgKmN0eCwgYm9vbCBibG9ja2luZykKICAgICAgICAgc21wX21i
KCk7CiAKICAgICAgICAgLyogRG9uJ3QgYmxvY2sgaWYgYWlvX25vdGlmeSgpIHdhcyBjYWxsZWQg
Ki8KLSAgICAgICAgaWYgKGF0b21pY19yZWFkKCZjdHgtPm5vdGlmaWVkKSkgeworICAgICAgICBp
ZiAocWF0b21pY19yZWFkKCZjdHgtPm5vdGlmaWVkKSkgewogICAgICAgICAgICAgdGltZW91dCA9
IDA7CiAgICAgICAgIH0KICAgICB9CkBAIC02MDMsOCArNjAzLDggQEAgYm9vbCBhaW9fcG9sbChB
aW9Db250ZXh0ICpjdHgsIGJvb2wgYmxvY2tpbmcpCiAKICAgICBpZiAodXNlX25vdGlmeV9tZSkg
ewogICAgICAgICAvKiBGaW5pc2ggdGhlIHBvbGwgYmVmb3JlIGNsZWFyaW5nIHRoZSBmbGFnLiAg
Ki8KLSAgICAgICAgYXRvbWljX3N0b3JlX3JlbGVhc2UoJmN0eC0+bm90aWZ5X21lLAotICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBhdG9taWNfcmVhZCgmY3R4LT5ub3RpZnlfbWUpIC0gMik7
CisgICAgICAgIHFhdG9taWNfc3RvcmVfcmVsZWFzZSgmY3R4LT5ub3RpZnlfbWUsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHFhdG9taWNfcmVhZCgmY3R4LT5ub3RpZnlfbWUpIC0gMik7
CiAgICAgfQogCiAgICAgYWlvX25vdGlmeV9hY2NlcHQoY3R4KTsKZGlmZiAtLWdpdCBhL3V0aWwv
YWlvLXdhaXQuYyBiL3V0aWwvYWlvLXdhaXQuYwppbmRleCBiNDg3NzQ5M2Y4Li5iZGIzZDNhZjIy
IDEwMDY0NAotLS0gYS91dGlsL2Fpby13YWl0LmMKKysrIGIvdXRpbC9haW8td2FpdC5jCkBAIC0z
Niw3ICszNiw3IEBAIHN0YXRpYyB2b2lkIGR1bW15X2JoX2NiKHZvaWQgKm9wYXF1ZSkKIHZvaWQg
YWlvX3dhaXRfa2ljayh2b2lkKQogewogICAgIC8qIFRoZSBiYXJyaWVyIChvciBhbiBhdG9taWMg
b3ApIGlzIGluIHRoZSBjYWxsZXIuICAqLwotICAgIGlmIChhdG9taWNfcmVhZCgmZ2xvYmFsX2Fp
b193YWl0Lm51bV93YWl0ZXJzKSkgeworICAgIGlmIChxYXRvbWljX3JlYWQoJmdsb2JhbF9haW9f
d2FpdC5udW1fd2FpdGVycykpIHsKICAgICAgICAgYWlvX2JoX3NjaGVkdWxlX29uZXNob3QocWVt
dV9nZXRfYWlvX2NvbnRleHQoKSwgZHVtbXlfYmhfY2IsIE5VTEwpOwogICAgIH0KIH0KZGlmZiAt
LWdpdCBhL3V0aWwvYWlvLXdpbjMyLmMgYi91dGlsL2Fpby13aW4zMi5jCmluZGV4IDQ5YmQ5MGU2
MmUuLmU3YjFkNjQ5ZTkgMTAwNjQ0Ci0tLSBhL3V0aWwvYWlvLXdpbjMyLmMKKysrIGIvdXRpbC9h
aW8td2luMzIuYwpAQCAtMzQ1LDcgKzM0NSw3IEBAIGJvb2wgYWlvX3BvbGwoQWlvQ29udGV4dCAq
Y3R4LCBib29sIGJsb2NraW5nKQogICAgICAqIHNvIGRpc2FibGUgdGhlIG9wdGltaXphdGlvbiBu
b3cuCiAgICAgICovCiAgICAgaWYgKGJsb2NraW5nKSB7Ci0gICAgICAgIGF0b21pY19zZXQoJmN0
eC0+bm90aWZ5X21lLCBhdG9taWNfcmVhZCgmY3R4LT5ub3RpZnlfbWUpICsgMik7CisgICAgICAg
IHFhdG9taWNfc2V0KCZjdHgtPm5vdGlmeV9tZSwgcWF0b21pY19yZWFkKCZjdHgtPm5vdGlmeV9t
ZSkgKyAyKTsKICAgICAgICAgLyoKICAgICAgICAgICogV3JpdGUgY3R4LT5ub3RpZnlfbWUgYmVm
b3JlIGNvbXB1dGluZyB0aGUgdGltZW91dAogICAgICAgICAgKiAocmVhZGluZyBib3R0b20gaGFs
ZiBmbGFncywgZXRjLikuICBQYWlycyB3aXRoCkBAIC0zODQsNyArMzg0LDggQEAgYm9vbCBhaW9f
cG9sbChBaW9Db250ZXh0ICpjdHgsIGJvb2wgYmxvY2tpbmcpCiAgICAgICAgIHJldCA9IFdhaXRG
b3JNdWx0aXBsZU9iamVjdHMoY291bnQsIGV2ZW50cywgRkFMU0UsIHRpbWVvdXQpOwogICAgICAg
ICBpZiAoYmxvY2tpbmcpIHsKICAgICAgICAgICAgIGFzc2VydChmaXJzdCk7Ci0gICAgICAgICAg
ICBhdG9taWNfc3RvcmVfcmVsZWFzZSgmY3R4LT5ub3RpZnlfbWUsIGF0b21pY19yZWFkKCZjdHgt
Pm5vdGlmeV9tZSkgLSAyKTsKKyAgICAgICAgICAgIHFhdG9taWNfc3RvcmVfcmVsZWFzZSgmY3R4
LT5ub3RpZnlfbWUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcWF0b21pY19y
ZWFkKCZjdHgtPm5vdGlmeV9tZSkgLSAyKTsKICAgICAgICAgICAgIGFpb19ub3RpZnlfYWNjZXB0
KGN0eCk7CiAgICAgICAgIH0KIApkaWZmIC0tZ2l0IGEvdXRpbC9hc3luYy5jIGIvdXRpbC9hc3lu
Yy5jCmluZGV4IDQyNjY3NDVkZWUuLmY3NTgzNTRjNmEgMTAwNjQ0Ci0tLSBhL3V0aWwvYXN5bmMu
YworKysgYi91dGlsL2FzeW5jLmMKQEAgLTcwLDEzICs3MCwxMyBAQCBzdGF0aWMgdm9pZCBhaW9f
YmhfZW5xdWV1ZShRRU1VQkggKmJoLCB1bnNpZ25lZCBuZXdfZmxhZ3MpCiAgICAgdW5zaWduZWQg
b2xkX2ZsYWdzOwogCiAgICAgLyoKLSAgICAgKiBUaGUgbWVtb3J5IGJhcnJpZXIgaW1wbGljaXQg
aW4gYXRvbWljX2ZldGNoX29yIG1ha2VzIHN1cmUgdGhhdDoKKyAgICAgKiBUaGUgbWVtb3J5IGJh
cnJpZXIgaW1wbGljaXQgaW4gcWF0b21pY19mZXRjaF9vciBtYWtlcyBzdXJlIHRoYXQ6CiAgICAg
ICogMS4gaWRsZSAmIGFueSB3cml0ZXMgbmVlZGVkIGJ5IHRoZSBjYWxsYmFjayBhcmUgZG9uZSBi
ZWZvcmUgdGhlCiAgICAgICogICAgbG9jYXRpb25zIGFyZSByZWFkIGluIHRoZSBhaW9fYmhfcG9s
bC4KICAgICAgKiAyLiBjdHggaXMgbG9hZGVkIGJlZm9yZSB0aGUgY2FsbGJhY2sgaGFzIGEgY2hh
bmNlIHRvIGV4ZWN1dGUgYW5kIGJoCiAgICAgICogICAgY291bGQgYmUgZnJlZWQuCiAgICAgICov
Ci0gICAgb2xkX2ZsYWdzID0gYXRvbWljX2ZldGNoX29yKCZiaC0+ZmxhZ3MsIEJIX1BFTkRJTkcg
fCBuZXdfZmxhZ3MpOworICAgIG9sZF9mbGFncyA9IHFhdG9taWNfZmV0Y2hfb3IoJmJoLT5mbGFn
cywgQkhfUEVORElORyB8IG5ld19mbGFncyk7CiAgICAgaWYgKCEob2xkX2ZsYWdzICYgQkhfUEVO
RElORykpIHsKICAgICAgICAgUVNMSVNUX0lOU0VSVF9IRUFEX0FUT01JQygmY3R4LT5iaF9saXN0
LCBiaCwgbmV4dCk7CiAgICAgfQpAQCAtOTYsMTMgKzk2LDEzIEBAIHN0YXRpYyBRRU1VQkggKmFp
b19iaF9kZXF1ZXVlKEJITGlzdCAqaGVhZCwgdW5zaWduZWQgKmZsYWdzKQogICAgIFFTTElTVF9S
RU1PVkVfSEVBRChoZWFkLCBuZXh0KTsKIAogICAgIC8qCi0gICAgICogVGhlIGF0b21pY19hbmQg
aXMgcGFpcmVkIHdpdGggYWlvX2JoX2VucXVldWUoKS4gIFRoZSBpbXBsaWNpdCBtZW1vcnkKKyAg
ICAgKiBUaGUgcWF0b21pY19hbmQgaXMgcGFpcmVkIHdpdGggYWlvX2JoX2VucXVldWUoKS4gIFRo
ZSBpbXBsaWNpdCBtZW1vcnkKICAgICAgKiBiYXJyaWVyIGVuc3VyZXMgdGhhdCB0aGUgY2FsbGJh
Y2sgc2VlcyBhbGwgd3JpdGVzIGRvbmUgYnkgdGhlIHNjaGVkdWxpbmcKICAgICAgKiB0aHJlYWQu
ICBJdCBhbHNvIGVuc3VyZXMgdGhhdCB0aGUgc2NoZWR1bGluZyB0aHJlYWQgc2VlcyB0aGUgY2xl
YXJlZAogICAgICAqIGZsYWcgYmVmb3JlIGJoLT5jYiBoYXMgcnVuLCBhbmQgdGh1cyB3aWxsIGNh
bGwgYWlvX25vdGlmeSBhZ2FpbiBpZgogICAgICAqIG5lY2Vzc2FyeS4KICAgICAgKi8KLSAgICAq
ZmxhZ3MgPSBhdG9taWNfZmV0Y2hfYW5kKCZiaC0+ZmxhZ3MsCisgICAgKmZsYWdzID0gcWF0b21p
Y19mZXRjaF9hbmQoJmJoLT5mbGFncywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH4o
QkhfUEVORElORyB8IEJIX1NDSEVEVUxFRCB8IEJIX0lETEUpKTsKICAgICByZXR1cm4gYmg7CiB9
CkBAIC0xODUsNyArMTg1LDcgQEAgdm9pZCBxZW11X2JoX3NjaGVkdWxlKFFFTVVCSCAqYmgpCiAg
Ki8KIHZvaWQgcWVtdV9iaF9jYW5jZWwoUUVNVUJIICpiaCkKIHsKLSAgICBhdG9taWNfYW5kKCZi
aC0+ZmxhZ3MsIH5CSF9TQ0hFRFVMRUQpOworICAgIHFhdG9taWNfYW5kKCZiaC0+ZmxhZ3MsIH5C
SF9TQ0hFRFVMRUQpOwogfQogCiAvKiBUaGlzIGZ1bmMgaXMgYXN5bmMuVGhlIGJvdHRvbSBoYWxm
IHdpbGwgZG8gdGhlIGRlbGV0ZSBhY3Rpb24gYXQgdGhlIGZpbmlhbApAQCAtMjQ5LDcgKzI0OSw3
IEBAIGFpb19jdHhfcHJlcGFyZShHU291cmNlICpzb3VyY2UsIGdpbnQgICAgKnRpbWVvdXQpCiB7
CiAgICAgQWlvQ29udGV4dCAqY3R4ID0gKEFpb0NvbnRleHQgKikgc291cmNlOwogCi0gICAgYXRv
bWljX3NldCgmY3R4LT5ub3RpZnlfbWUsIGF0b21pY19yZWFkKCZjdHgtPm5vdGlmeV9tZSkgfCAx
KTsKKyAgICBxYXRvbWljX3NldCgmY3R4LT5ub3RpZnlfbWUsIHFhdG9taWNfcmVhZCgmY3R4LT5u
b3RpZnlfbWUpIHwgMSk7CiAKICAgICAvKgogICAgICAqIFdyaXRlIGN0eC0+bm90aWZ5X21lIGJl
Zm9yZSBjb21wdXRpbmcgdGhlIHRpbWVvdXQKQEAgLTI3Niw3ICsyNzYsNyBAQCBhaW9fY3R4X2No
ZWNrKEdTb3VyY2UgKnNvdXJjZSkKICAgICBCSExpc3RTbGljZSAqczsKIAogICAgIC8qIEZpbmlz
aCBjb21wdXRpbmcgdGhlIHRpbWVvdXQgYmVmb3JlIGNsZWFyaW5nIHRoZSBmbGFnLiAgKi8KLSAg
ICBhdG9taWNfc3RvcmVfcmVsZWFzZSgmY3R4LT5ub3RpZnlfbWUsIGF0b21pY19yZWFkKCZjdHgt
Pm5vdGlmeV9tZSkgJiB+MSk7CisgICAgcWF0b21pY19zdG9yZV9yZWxlYXNlKCZjdHgtPm5vdGlm
eV9tZSwgcWF0b21pY19yZWFkKCZjdHgtPm5vdGlmeV9tZSkgJiB+MSk7CiAgICAgYWlvX25vdGlm
eV9hY2NlcHQoY3R4KTsKIAogICAgIFFTTElTVF9GT1JFQUNIX1JDVShiaCwgJmN0eC0+YmhfbGlz
dCwgbmV4dCkgewpAQCAtNDI0LDIxICs0MjQsMjEgQEAgdm9pZCBhaW9fbm90aWZ5KEFpb0NvbnRl
eHQgKmN0eCkKICAgICAgKiBhaW9fbm90aWZ5X2FjY2VwdC4KICAgICAgKi8KICAgICBzbXBfd21i
KCk7Ci0gICAgYXRvbWljX3NldCgmY3R4LT5ub3RpZmllZCwgdHJ1ZSk7CisgICAgcWF0b21pY19z
ZXQoJmN0eC0+bm90aWZpZWQsIHRydWUpOwogCiAgICAgLyoKICAgICAgKiBXcml0ZSBjdHgtPm5v
dGlmaWVkIGJlZm9yZSByZWFkaW5nIGN0eC0+bm90aWZ5X21lLiAgUGFpcnMKICAgICAgKiB3aXRo
IHNtcF9tYiBpbiBhaW9fY3R4X3ByZXBhcmUgb3IgYWlvX3BvbGwuCiAgICAgICovCiAgICAgc21w
X21iKCk7Ci0gICAgaWYgKGF0b21pY19yZWFkKCZjdHgtPm5vdGlmeV9tZSkpIHsKKyAgICBpZiAo
cWF0b21pY19yZWFkKCZjdHgtPm5vdGlmeV9tZSkpIHsKICAgICAgICAgZXZlbnRfbm90aWZpZXJf
c2V0KCZjdHgtPm5vdGlmaWVyKTsKICAgICB9CiB9CiAKIHZvaWQgYWlvX25vdGlmeV9hY2NlcHQo
QWlvQ29udGV4dCAqY3R4KQogewotICAgIGF0b21pY19zZXQoJmN0eC0+bm90aWZpZWQsIGZhbHNl
KTsKKyAgICBxYXRvbWljX3NldCgmY3R4LT5ub3RpZmllZCwgZmFsc2UpOwogCiAgICAgLyoKICAg
ICAgKiBXcml0ZSBjdHgtPm5vdGlmaWVkIGJlZm9yZSByZWFkaW5nIGUuZy4gYmgtPmZsYWdzLiAg
UGFpcnMgd2l0aCBzbXBfd21iCkBAIC00NjUsNyArNDY1LDcgQEAgc3RhdGljIGJvb2wgYWlvX2Nv
bnRleHRfbm90aWZpZXJfcG9sbCh2b2lkICpvcGFxdWUpCiAgICAgRXZlbnROb3RpZmllciAqZSA9
IG9wYXF1ZTsKICAgICBBaW9Db250ZXh0ICpjdHggPSBjb250YWluZXJfb2YoZSwgQWlvQ29udGV4
dCwgbm90aWZpZXIpOwogCi0gICAgcmV0dXJuIGF0b21pY19yZWFkKCZjdHgtPm5vdGlmaWVkKTsK
KyAgICByZXR1cm4gcWF0b21pY19yZWFkKCZjdHgtPm5vdGlmaWVkKTsKIH0KIAogc3RhdGljIHZv
aWQgY29fc2NoZWR1bGVfYmhfY2Iodm9pZCAqb3BhcXVlKQpAQCAtNDg5LDcgKzQ4OSw3IEBAIHN0
YXRpYyB2b2lkIGNvX3NjaGVkdWxlX2JoX2NiKHZvaWQgKm9wYXF1ZSkKICAgICAgICAgYWlvX2Nv
bnRleHRfYWNxdWlyZShjdHgpOwogCiAgICAgICAgIC8qIFByb3RlY3RlZCBieSB3cml0ZSBiYXJy
aWVyIGluIHFlbXVfYWlvX2Nvcm91dGluZV9lbnRlciAqLwotICAgICAgICBhdG9taWNfc2V0KCZj
by0+c2NoZWR1bGVkLCBOVUxMKTsKKyAgICAgICAgcWF0b21pY19zZXQoJmNvLT5zY2hlZHVsZWQs
IE5VTEwpOwogICAgICAgICBxZW11X2Fpb19jb3JvdXRpbmVfZW50ZXIoY3R4LCBjbyk7CiAgICAg
ICAgIGFpb19jb250ZXh0X3JlbGVhc2UoY3R4KTsKICAgICB9CkBAIC01NDYsNyArNTQ2LDcgQEAg
ZmFpbDoKIHZvaWQgYWlvX2NvX3NjaGVkdWxlKEFpb0NvbnRleHQgKmN0eCwgQ29yb3V0aW5lICpj
bykKIHsKICAgICB0cmFjZV9haW9fY29fc2NoZWR1bGUoY3R4LCBjbyk7Ci0gICAgY29uc3QgY2hh
ciAqc2NoZWR1bGVkID0gYXRvbWljX2NtcHhjaGcoJmNvLT5zY2hlZHVsZWQsIE5VTEwsCisgICAg
Y29uc3QgY2hhciAqc2NoZWR1bGVkID0gcWF0b21pY19jbXB4Y2hnKCZjby0+c2NoZWR1bGVkLCBO
VUxMLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fZnVuY19f
KTsKIAogICAgIGlmIChzY2hlZHVsZWQpIHsKQEAgLTU3Nyw3ICs1NzcsNyBAQCB2b2lkIGFpb19j
b193YWtlKHN0cnVjdCBDb3JvdXRpbmUgKmNvKQogICAgICAqIHFlbXVfY29yb3V0aW5lX2VudGVy
LgogICAgICAqLwogICAgIHNtcF9yZWFkX2JhcnJpZXJfZGVwZW5kcygpOwotICAgIGN0eCA9IGF0
b21pY19yZWFkKCZjby0+Y3R4KTsKKyAgICBjdHggPSBxYXRvbWljX3JlYWQoJmNvLT5jdHgpOwog
CiAgICAgYWlvX2NvX2VudGVyKGN0eCwgY28pOwogfQpkaWZmIC0tZ2l0IGEvdXRpbC9hdG9taWM2
NC5jIGIvdXRpbC9hdG9taWM2NC5jCmluZGV4IGIxOThhNmM5YzguLjkzMDM3ZDViMTEgMTAwNjQ0
Ci0tLSBhL3V0aWwvYXRvbWljNjQuYworKysgYi91dGlsL2F0b21pYzY0LmMKQEAgLTUxLDggKzUx
LDggQEAgc3RhdGljIFFlbXVTcGluICphZGRyX3RvX2xvY2soY29uc3Qgdm9pZCAqYWRkcikKICAg
ICAgICAgcmV0dXJuIHJldDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgICB9CiAK
LUdFTl9SRUFEKGF0b21pY19yZWFkX2k2NCwgaW50NjRfdCkKLUdFTl9SRUFEKGF0b21pY19yZWFk
X3U2NCwgdWludDY0X3QpCitHRU5fUkVBRChxYXRvbWljX3JlYWRfaTY0LCBpbnQ2NF90KQorR0VO
X1JFQUQocWF0b21pY19yZWFkX3U2NCwgdWludDY0X3QpCiAjdW5kZWYgR0VOX1JFQUQKIAogI2Rl
ZmluZSBHRU5fU0VUKG5hbWUsIHR5cGUpICAgICAgICAgICAgICAgICAgICAgXApAQCAtNjUsMTEg
KzY1LDExIEBAIEdFTl9SRUFEKGF0b21pY19yZWFkX3U2NCwgdWludDY0X3QpCiAgICAgICAgIHFl
bXVfc3Bpbl91bmxvY2sobG9jayk7ICAgICAgICAgICAgICAgICBcCiAgICAgfQogCi1HRU5fU0VU
KGF0b21pY19zZXRfaTY0LCBpbnQ2NF90KQotR0VOX1NFVChhdG9taWNfc2V0X3U2NCwgdWludDY0
X3QpCitHRU5fU0VUKHFhdG9taWNfc2V0X2k2NCwgaW50NjRfdCkKK0dFTl9TRVQocWF0b21pY19z
ZXRfdTY0LCB1aW50NjRfdCkKICN1bmRlZiBHRU5fU0VUCiAKLXZvaWQgYXRvbWljNjRfaW5pdCh2
b2lkKQordm9pZCBxYXRvbWljNjRfaW5pdCh2b2lkKQogewogICAgIGludCBpOwogCmRpZmYgLS1n
aXQgYS91dGlsL2JpdG1hcC5jIGIvdXRpbC9iaXRtYXAuYwppbmRleCAxNzUzZmY3ZjViLi4xZjIw
MTM5M2FlIDEwMDY0NAotLS0gYS91dGlsL2JpdG1hcC5jCisrKyBiL3V0aWwvYml0bWFwLmMKQEAg
LTE5MCw3ICsxOTAsNyBAQCB2b2lkIGJpdG1hcF9zZXRfYXRvbWljKHVuc2lnbmVkIGxvbmcgKm1h
cCwgbG9uZyBzdGFydCwgbG9uZyBucikKIAogICAgIC8qIEZpcnN0IHdvcmQgKi8KICAgICBpZiAo
bnIgLSBiaXRzX3RvX3NldCA+IDApIHsKLSAgICAgICAgYXRvbWljX29yKHAsIG1hc2tfdG9fc2V0
KTsKKyAgICAgICAgcWF0b21pY19vcihwLCBtYXNrX3RvX3NldCk7CiAgICAgICAgIG5yIC09IGJp
dHNfdG9fc2V0OwogICAgICAgICBiaXRzX3RvX3NldCA9IEJJVFNfUEVSX0xPTkc7CiAgICAgICAg
IG1hc2tfdG9fc2V0ID0gfjBVTDsKQEAgLTIwOSw5ICsyMDksOSBAQCB2b2lkIGJpdG1hcF9zZXRf
YXRvbWljKHVuc2lnbmVkIGxvbmcgKm1hcCwgbG9uZyBzdGFydCwgbG9uZyBucikKICAgICAvKiBM
YXN0IHdvcmQgKi8KICAgICBpZiAobnIpIHsKICAgICAgICAgbWFza190b19zZXQgJj0gQklUTUFQ
X0xBU1RfV09SRF9NQVNLKHNpemUpOwotICAgICAgICBhdG9taWNfb3IocCwgbWFza190b19zZXQp
OworICAgICAgICBxYXRvbWljX29yKHAsIG1hc2tfdG9fc2V0KTsKICAgICB9IGVsc2UgewotICAg
ICAgICAvKiBJZiB3ZSBhdm9pZGVkIHRoZSBmdWxsIGJhcnJpZXIgaW4gYXRvbWljX29yKCksIGlz
c3VlIGEKKyAgICAgICAgLyogSWYgd2UgYXZvaWRlZCB0aGUgZnVsbCBiYXJyaWVyIGluIHFhdG9t
aWNfb3IoKSwgaXNzdWUgYQogICAgICAgICAgKiBiYXJyaWVyIHRvIGFjY291bnQgZm9yIHRoZSBh
c3NpZ25tZW50cyBpbiB0aGUgd2hpbGUgbG9vcC4KICAgICAgICAgICovCiAgICAgICAgIHNtcF9t
YigpOwpAQCAtMjUzLDcgKzI1Myw3IEBAIGJvb2wgYml0bWFwX3Rlc3RfYW5kX2NsZWFyX2F0b21p
Yyh1bnNpZ25lZCBsb25nICptYXAsIGxvbmcgc3RhcnQsIGxvbmcgbnIpCiAKICAgICAvKiBGaXJz
dCB3b3JkICovCiAgICAgaWYgKG5yIC0gYml0c190b19jbGVhciA+IDApIHsKLSAgICAgICAgb2xk
X2JpdHMgPSBhdG9taWNfZmV0Y2hfYW5kKHAsIH5tYXNrX3RvX2NsZWFyKTsKKyAgICAgICAgb2xk
X2JpdHMgPSBxYXRvbWljX2ZldGNoX2FuZChwLCB+bWFza190b19jbGVhcik7CiAgICAgICAgIGRp
cnR5IHw9IG9sZF9iaXRzICYgbWFza190b19jbGVhcjsKICAgICAgICAgbnIgLT0gYml0c190b19j
bGVhcjsKICAgICAgICAgYml0c190b19jbGVhciA9IEJJVFNfUEVSX0xPTkc7CkBAIC0yNjUsNyAr
MjY1LDcgQEAgYm9vbCBiaXRtYXBfdGVzdF9hbmRfY2xlYXJfYXRvbWljKHVuc2lnbmVkIGxvbmcg
Km1hcCwgbG9uZyBzdGFydCwgbG9uZyBucikKICAgICBpZiAoYml0c190b19jbGVhciA9PSBCSVRT
X1BFUl9MT05HKSB7CiAgICAgICAgIHdoaWxlIChuciA+PSBCSVRTX1BFUl9MT05HKSB7CiAgICAg
ICAgICAgICBpZiAoKnApIHsKLSAgICAgICAgICAgICAgICBvbGRfYml0cyA9IGF0b21pY194Y2hn
KHAsIDApOworICAgICAgICAgICAgICAgIG9sZF9iaXRzID0gcWF0b21pY194Y2hnKHAsIDApOwog
ICAgICAgICAgICAgICAgIGRpcnR5IHw9IG9sZF9iaXRzOwogICAgICAgICAgICAgfQogICAgICAg
ICAgICAgbnIgLT0gQklUU19QRVJfTE9ORzsKQEAgLTI3Niw3ICsyNzYsNyBAQCBib29sIGJpdG1h
cF90ZXN0X2FuZF9jbGVhcl9hdG9taWModW5zaWduZWQgbG9uZyAqbWFwLCBsb25nIHN0YXJ0LCBs
b25nIG5yKQogICAgIC8qIExhc3Qgd29yZCAqLwogICAgIGlmIChucikgewogICAgICAgICBtYXNr
X3RvX2NsZWFyICY9IEJJVE1BUF9MQVNUX1dPUkRfTUFTSyhzaXplKTsKLSAgICAgICAgb2xkX2Jp
dHMgPSBhdG9taWNfZmV0Y2hfYW5kKHAsIH5tYXNrX3RvX2NsZWFyKTsKKyAgICAgICAgb2xkX2Jp
dHMgPSBxYXRvbWljX2ZldGNoX2FuZChwLCB+bWFza190b19jbGVhcik7CiAgICAgICAgIGRpcnR5
IHw9IG9sZF9iaXRzICYgbWFza190b19jbGVhcjsKICAgICB9IGVsc2UgewogICAgICAgICBpZiAo
IWRpcnR5KSB7CkBAIC0yOTEsNyArMjkxLDcgQEAgdm9pZCBiaXRtYXBfY29weV9hbmRfY2xlYXJf
YXRvbWljKHVuc2lnbmVkIGxvbmcgKmRzdCwgdW5zaWduZWQgbG9uZyAqc3JjLAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGxvbmcgbnIpCiB7CiAgICAgd2hpbGUgKG5yID4gMCkg
ewotICAgICAgICAqZHN0ID0gYXRvbWljX3hjaGcoc3JjLCAwKTsKKyAgICAgICAgKmRzdCA9IHFh
dG9taWNfeGNoZyhzcmMsIDApOwogICAgICAgICBkc3QrKzsKICAgICAgICAgc3JjKys7CiAgICAg
ICAgIG5yIC09IEJJVFNfUEVSX0xPTkc7CmRpZmYgLS1naXQgYS91dGlsL2NhY2hlaW5mby5jIGIv
dXRpbC9jYWNoZWluZm8uYwppbmRleCBkOTRkYzZhZGM4Li43ODA0YzE4NmI2IDEwMDY0NAotLS0g
YS91dGlsL2NhY2hlaW5mby5jCisrKyBiL3V0aWwvY2FjaGVpbmZvLmMKQEAgLTE5Myw1ICsxOTMs
NSBAQCBzdGF0aWMgdm9pZCBfX2F0dHJpYnV0ZV9fKChjb25zdHJ1Y3RvcikpIGluaXRfY2FjaGVf
aW5mbyh2b2lkKQogICAgIHFlbXVfZGNhY2hlX2xpbmVzaXplID0gZHNpemU7CiAgICAgcWVtdV9k
Y2FjaGVfbGluZXNpemVfbG9nID0gY3R6MzIoZHNpemUpOwogCi0gICAgYXRvbWljNjRfaW5pdCgp
OworICAgIHFhdG9taWM2NF9pbml0KCk7CiB9CmRpZmYgLS1naXQgYS91dGlsL2ZkbW9uLWVwb2xs
LmMgYi91dGlsL2ZkbW9uLWVwb2xsLmMKaW5kZXggZmNkOTg5ZDQ3ZC4uZTExYThhMDIyZSAxMDA2
NDQKLS0tIGEvdXRpbC9mZG1vbi1lcG9sbC5jCisrKyBiL3V0aWwvZmRtb24tZXBvbGwuYwpAQCAt
NjUsNyArNjUsNyBAQCBzdGF0aWMgaW50IGZkbW9uX2Vwb2xsX3dhaXQoQWlvQ29udGV4dCAqY3R4
LCBBaW9IYW5kbGVyTGlzdCAqcmVhZHlfbGlzdCwKICAgICBzdHJ1Y3QgZXBvbGxfZXZlbnQgZXZl
bnRzWzEyOF07CiAKICAgICAvKiBGYWxsIGJhY2sgd2hpbGUgZXh0ZXJuYWwgY2xpZW50cyBhcmUg
ZGlzYWJsZWQgKi8KLSAgICBpZiAoYXRvbWljX3JlYWQoJmN0eC0+ZXh0ZXJuYWxfZGlzYWJsZV9j
bnQpKSB7CisgICAgaWYgKHFhdG9taWNfcmVhZCgmY3R4LT5leHRlcm5hbF9kaXNhYmxlX2NudCkp
IHsKICAgICAgICAgcmV0dXJuIGZkbW9uX3BvbGxfb3BzLndhaXQoY3R4LCByZWFkeV9saXN0LCB0
aW1lb3V0KTsKICAgICB9CiAKQEAgLTEzMiw3ICsxMzIsNyBAQCBib29sIGZkbW9uX2Vwb2xsX3Ry
eV91cGdyYWRlKEFpb0NvbnRleHQgKmN0eCwgdW5zaWduZWQgbnBmZCkKICAgICB9CiAKICAgICAv
KiBEbyBub3QgdXBncmFkZSB3aGlsZSBleHRlcm5hbCBjbGllbnRzIGFyZSBkaXNhYmxlZCAqLwot
ICAgIGlmIChhdG9taWNfcmVhZCgmY3R4LT5leHRlcm5hbF9kaXNhYmxlX2NudCkpIHsKKyAgICBp
ZiAocWF0b21pY19yZWFkKCZjdHgtPmV4dGVybmFsX2Rpc2FibGVfY250KSkgewogICAgICAgICBy
ZXR1cm4gZmFsc2U7CiAgICAgfQogCmRpZmYgLS1naXQgYS91dGlsL2ZkbW9uLWlvX3VyaW5nLmMg
Yi91dGlsL2ZkbW9uLWlvX3VyaW5nLmMKaW5kZXggMWQxNDE3N2RmMC4uMTQ2MWRmYTQwNyAxMDA2
NDQKLS0tIGEvdXRpbC9mZG1vbi1pb191cmluZy5jCisrKyBiL3V0aWwvZmRtb24taW9fdXJpbmcu
YwpAQCAtMTAzLDcgKzEwMyw3IEBAIHN0YXRpYyB2b2lkIGVucXVldWUoQWlvSGFuZGxlclNMaXN0
ICpoZWFkLCBBaW9IYW5kbGVyICpub2RlLCB1bnNpZ25lZCBmbGFncykKIHsKICAgICB1bnNpZ25l
ZCBvbGRfZmxhZ3M7CiAKLSAgICBvbGRfZmxhZ3MgPSBhdG9taWNfZmV0Y2hfb3IoJm5vZGUtPmZs
YWdzLCBGRE1PTl9JT19VUklOR19QRU5ESU5HIHwgZmxhZ3MpOworICAgIG9sZF9mbGFncyA9IHFh
dG9taWNfZmV0Y2hfb3IoJm5vZGUtPmZsYWdzLCBGRE1PTl9JT19VUklOR19QRU5ESU5HIHwgZmxh
Z3MpOwogICAgIGlmICghKG9sZF9mbGFncyAmIEZETU9OX0lPX1VSSU5HX1BFTkRJTkcpKSB7CiAg
ICAgICAgIFFTTElTVF9JTlNFUlRfSEVBRF9BVE9NSUMoaGVhZCwgbm9kZSwgbm9kZV9zdWJtaXR0
ZWQpOwogICAgIH0KQEAgLTEyNyw3ICsxMjcsNyBAQCBzdGF0aWMgQWlvSGFuZGxlciAqZGVxdWV1
ZShBaW9IYW5kbGVyU0xpc3QgKmhlYWQsIHVuc2lnbmVkICpmbGFncykKICAgICAgKiB0ZWxsaW5n
IHByb2Nlc3NfY3FlKCkgdG8gZGVsZXRlIHRoZSBBaW9IYW5kbGVyIHdoZW4gaXRzCiAgICAgICog
SU9SSU5HX09QX1BPTExfQUREIGNvbXBsZXRlcy4KICAgICAgKi8KLSAgICAqZmxhZ3MgPSBhdG9t
aWNfZmV0Y2hfYW5kKCZub2RlLT5mbGFncywgfihGRE1PTl9JT19VUklOR19QRU5ESU5HIHwKKyAg
ICAqZmxhZ3MgPSBxYXRvbWljX2ZldGNoX2FuZCgmbm9kZS0+ZmxhZ3MsIH4oRkRNT05fSU9fVVJJ
TkdfUEVORElORyB8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgRkRNT05fSU9fVVJJTkdfQUREKSk7CiAgICAgcmV0dXJuIG5vZGU7CiB9CkBAIC0yMzMsNyAr
MjMzLDcgQEAgc3RhdGljIGJvb2wgcHJvY2Vzc19jcWUoQWlvQ29udGV4dCAqY3R4LAogICAgICAq
IHdpdGggZW5xdWV1ZSgpIGhlcmUgdGhlbiB3ZSBjYW4gc2FmZWx5IGNsZWFyIHRoZSBGRE1PTl9J
T19VUklOR19SRU1PVkUKICAgICAgKiBiaXQgYmVmb3JlIElPUklOR19PUF9QT0xMX1JFTU9WRSBp
cyBzdWJtaXR0ZWQuCiAgICAgICovCi0gICAgZmxhZ3MgPSBhdG9taWNfZmV0Y2hfYW5kKCZub2Rl
LT5mbGFncywgfkZETU9OX0lPX1VSSU5HX1JFTU9WRSk7CisgICAgZmxhZ3MgPSBxYXRvbWljX2Zl
dGNoX2FuZCgmbm9kZS0+ZmxhZ3MsIH5GRE1PTl9JT19VUklOR19SRU1PVkUpOwogICAgIGlmIChm
bGFncyAmIEZETU9OX0lPX1VSSU5HX1JFTU9WRSkgewogICAgICAgICBRTElTVF9JTlNFUlRfSEVB
RF9SQ1UoJmN0eC0+ZGVsZXRlZF9haW9faGFuZGxlcnMsIG5vZGUsIG5vZGVfZGVsZXRlZCk7CiAg
ICAgICAgIHJldHVybiBmYWxzZTsKQEAgLTI3Myw3ICsyNzMsNyBAQCBzdGF0aWMgaW50IGZkbW9u
X2lvX3VyaW5nX3dhaXQoQWlvQ29udGV4dCAqY3R4LCBBaW9IYW5kbGVyTGlzdCAqcmVhZHlfbGlz
dCwKICAgICBpbnQgcmV0OwogCiAgICAgLyogRmFsbCBiYWNrIHdoaWxlIGV4dGVybmFsIGNsaWVu
dHMgYXJlIGRpc2FibGVkICovCi0gICAgaWYgKGF0b21pY19yZWFkKCZjdHgtPmV4dGVybmFsX2Rp
c2FibGVfY250KSkgeworICAgIGlmIChxYXRvbWljX3JlYWQoJmN0eC0+ZXh0ZXJuYWxfZGlzYWJs
ZV9jbnQpKSB7CiAgICAgICAgIHJldHVybiBmZG1vbl9wb2xsX29wcy53YWl0KGN0eCwgcmVhZHlf
bGlzdCwgdGltZW91dCk7CiAgICAgfQogCkBAIC0zMTIsNyArMzEyLDcgQEAgc3RhdGljIGJvb2wg
ZmRtb25faW9fdXJpbmdfbmVlZF93YWl0KEFpb0NvbnRleHQgKmN0eCkKICAgICB9CiAKICAgICAv
KiBBcmUgd2UgZmFsbGluZyBiYWNrIHRvIGZkbW9uLXBvbGw/ICovCi0gICAgcmV0dXJuIGF0b21p
Y19yZWFkKCZjdHgtPmV4dGVybmFsX2Rpc2FibGVfY250KTsKKyAgICByZXR1cm4gcWF0b21pY19y
ZWFkKCZjdHgtPmV4dGVybmFsX2Rpc2FibGVfY250KTsKIH0KIAogc3RhdGljIGNvbnN0IEZETW9u
T3BzIGZkbW9uX2lvX3VyaW5nX29wcyA9IHsKQEAgLTM0NCw3ICszNDQsNyBAQCB2b2lkIGZkbW9u
X2lvX3VyaW5nX2Rlc3Ryb3koQWlvQ29udGV4dCAqY3R4KQogCiAgICAgICAgIC8qIE1vdmUgaGFu
ZGxlcnMgZHVlIHRvIGJlIHJlbW92ZWQgb250byB0aGUgZGVsZXRlZCBsaXN0ICovCiAgICAgICAg
IHdoaWxlICgobm9kZSA9IFFTTElTVF9GSVJTVF9SQ1UoJmN0eC0+c3VibWl0X2xpc3QpKSkgewot
ICAgICAgICAgICAgdW5zaWduZWQgZmxhZ3MgPSBhdG9taWNfZmV0Y2hfYW5kKCZub2RlLT5mbGFn
cywKKyAgICAgICAgICAgIHVuc2lnbmVkIGZsYWdzID0gcWF0b21pY19mZXRjaF9hbmQoJm5vZGUt
PmZsYWdzLAogICAgICAgICAgICAgICAgICAgICB+KEZETU9OX0lPX1VSSU5HX1BFTkRJTkcgfAog
ICAgICAgICAgICAgICAgICAgICAgIEZETU9OX0lPX1VSSU5HX0FERCB8CiAgICAgICAgICAgICAg
ICAgICAgICAgRkRNT05fSU9fVVJJTkdfUkVNT1ZFKSk7CmRpZmYgLS1naXQgYS91dGlsL2xvY2tj
bnQuYyBiL3V0aWwvbG9ja2NudC5jCmluZGV4IDRmODhkY2Y4YjguLjVkYTM2OTQ2YjEgMTAwNjQ0
Ci0tLSBhL3V0aWwvbG9ja2NudC5jCisrKyBiL3V0aWwvbG9ja2NudC5jCkBAIC02MSw3ICs2MSw3
IEBAIHN0YXRpYyBib29sIHFlbXVfbG9ja2NudF9jbXB4Y2hnX29yX3dhaXQoUWVtdUxvY2tDbnQg
KmxvY2tjbnQsIGludCAqdmFsLAogICAgICAgICBpbnQgZXhwZWN0ZWQgPSAqdmFsOwogCiAgICAg
ICAgIHRyYWNlX2xvY2tjbnRfZmFzdF9wYXRoX2F0dGVtcHQobG9ja2NudCwgZXhwZWN0ZWQsIG5l
d19pZl9mcmVlKTsKLSAgICAgICAgKnZhbCA9IGF0b21pY19jbXB4Y2hnKCZsb2NrY250LT5jb3Vu
dCwgZXhwZWN0ZWQsIG5ld19pZl9mcmVlKTsKKyAgICAgICAgKnZhbCA9IHFhdG9taWNfY21weGNo
ZygmbG9ja2NudC0+Y291bnQsIGV4cGVjdGVkLCBuZXdfaWZfZnJlZSk7CiAgICAgICAgIGlmICgq
dmFsID09IGV4cGVjdGVkKSB7CiAgICAgICAgICAgICB0cmFjZV9sb2NrY250X2Zhc3RfcGF0aF9z
dWNjZXNzKGxvY2tjbnQsIGV4cGVjdGVkLCBuZXdfaWZfZnJlZSk7CiAgICAgICAgICAgICAqdmFs
ID0gbmV3X2lmX2ZyZWU7CkBAIC04MSw3ICs4MSw3IEBAIHN0YXRpYyBib29sIHFlbXVfbG9ja2Nu
dF9jbXB4Y2hnX29yX3dhaXQoUWVtdUxvY2tDbnQgKmxvY2tjbnQsIGludCAqdmFsLAogICAgICAg
ICAgICAgaW50IG5ldyA9IGV4cGVjdGVkIC0gUUVNVV9MT0NLQ05UX1NUQVRFX0xPQ0tFRCArIFFF
TVVfTE9DS0NOVF9TVEFURV9XQUlUSU5HOwogCiAgICAgICAgICAgICB0cmFjZV9sb2NrY250X2Z1
dGV4X3dhaXRfcHJlcGFyZShsb2NrY250LCBleHBlY3RlZCwgbmV3KTsKLSAgICAgICAgICAgICp2
YWwgPSBhdG9taWNfY21weGNoZygmbG9ja2NudC0+Y291bnQsIGV4cGVjdGVkLCBuZXcpOworICAg
ICAgICAgICAgKnZhbCA9IHFhdG9taWNfY21weGNoZygmbG9ja2NudC0+Y291bnQsIGV4cGVjdGVk
LCBuZXcpOwogICAgICAgICAgICAgaWYgKCp2YWwgPT0gZXhwZWN0ZWQpIHsKICAgICAgICAgICAg
ICAgICAqdmFsID0gbmV3OwogICAgICAgICAgICAgfQpAQCAtOTIsNyArOTIsNyBAQCBzdGF0aWMg
Ym9vbCBxZW11X2xvY2tjbnRfY21weGNoZ19vcl93YWl0KFFlbXVMb2NrQ250ICpsb2NrY250LCBp
bnQgKnZhbCwKICAgICAgICAgICAgICp3YWl0ZWQgPSB0cnVlOwogICAgICAgICAgICAgdHJhY2Vf
bG9ja2NudF9mdXRleF93YWl0KGxvY2tjbnQsICp2YWwpOwogICAgICAgICAgICAgcWVtdV9mdXRl
eF93YWl0KCZsb2NrY250LT5jb3VudCwgKnZhbCk7Ci0gICAgICAgICAgICAqdmFsID0gYXRvbWlj
X3JlYWQoJmxvY2tjbnQtPmNvdW50KTsKKyAgICAgICAgICAgICp2YWwgPSBxYXRvbWljX3JlYWQo
JmxvY2tjbnQtPmNvdW50KTsKICAgICAgICAgICAgIHRyYWNlX2xvY2tjbnRfZnV0ZXhfd2FpdF9y
ZXN1bWUobG9ja2NudCwgKnZhbCk7CiAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgfQpA
QCAtMTEwLDEzICsxMTAsMTQgQEAgc3RhdGljIHZvaWQgbG9ja2NudF93YWtlKFFlbXVMb2NrQ250
ICpsb2NrY250KQogCiB2b2lkIHFlbXVfbG9ja2NudF9pbmMoUWVtdUxvY2tDbnQgKmxvY2tjbnQp
CiB7Ci0gICAgaW50IHZhbCA9IGF0b21pY19yZWFkKCZsb2NrY250LT5jb3VudCk7CisgICAgaW50
IHZhbCA9IHFhdG9taWNfcmVhZCgmbG9ja2NudC0+Y291bnQpOwogICAgIGJvb2wgd2FpdGVkID0g
ZmFsc2U7CiAKICAgICBmb3IgKDs7KSB7CiAgICAgICAgIGlmICh2YWwgPj0gUUVNVV9MT0NLQ05U
X0NPVU5UX1NURVApIHsKICAgICAgICAgICAgIGludCBleHBlY3RlZCA9IHZhbDsKLSAgICAgICAg
ICAgIHZhbCA9IGF0b21pY19jbXB4Y2hnKCZsb2NrY250LT5jb3VudCwgdmFsLCB2YWwgKyBRRU1V
X0xPQ0tDTlRfQ09VTlRfU1RFUCk7CisgICAgICAgICAgICB2YWwgPSBxYXRvbWljX2NtcHhjaGco
JmxvY2tjbnQtPmNvdW50LCB2YWwsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
dmFsICsgUUVNVV9MT0NLQ05UX0NPVU5UX1NURVApOwogICAgICAgICAgICAgaWYgKHZhbCA9PSBl
eHBlY3RlZCkgewogICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgfQpAQCAtMTQy
LDcgKzE0Myw3IEBAIHZvaWQgcWVtdV9sb2NrY250X2luYyhRZW11TG9ja0NudCAqbG9ja2NudCkK
IAogdm9pZCBxZW11X2xvY2tjbnRfZGVjKFFlbXVMb2NrQ250ICpsb2NrY250KQogewotICAgIGF0
b21pY19zdWIoJmxvY2tjbnQtPmNvdW50LCBRRU1VX0xPQ0tDTlRfQ09VTlRfU1RFUCk7CisgICAg
cWF0b21pY19zdWIoJmxvY2tjbnQtPmNvdW50LCBRRU1VX0xPQ0tDTlRfQ09VTlRfU1RFUCk7CiB9
CiAKIC8qIERlY3JlbWVudCBhIGNvdW50ZXIsIGFuZCByZXR1cm4gbG9ja2VkIGlmIGl0IGlzIGRl
Y3JlbWVudGVkIHRvIHplcm8uCkBAIC0xNTEsMTQgKzE1MiwxNSBAQCB2b2lkIHFlbXVfbG9ja2Nu
dF9kZWMoUWVtdUxvY2tDbnQgKmxvY2tjbnQpCiAgKi8KIGJvb2wgcWVtdV9sb2NrY250X2RlY19h
bmRfbG9jayhRZW11TG9ja0NudCAqbG9ja2NudCkKIHsKLSAgICBpbnQgdmFsID0gYXRvbWljX3Jl
YWQoJmxvY2tjbnQtPmNvdW50KTsKKyAgICBpbnQgdmFsID0gcWF0b21pY19yZWFkKCZsb2NrY250
LT5jb3VudCk7CiAgICAgaW50IGxvY2tlZF9zdGF0ZSA9IFFFTVVfTE9DS0NOVF9TVEFURV9MT0NL
RUQ7CiAgICAgYm9vbCB3YWl0ZWQgPSBmYWxzZTsKIAogICAgIGZvciAoOzspIHsKICAgICAgICAg
aWYgKHZhbCA+PSAyICogUUVNVV9MT0NLQ05UX0NPVU5UX1NURVApIHsKICAgICAgICAgICAgIGlu
dCBleHBlY3RlZCA9IHZhbDsKLSAgICAgICAgICAgIHZhbCA9IGF0b21pY19jbXB4Y2hnKCZsb2Nr
Y250LT5jb3VudCwgdmFsLCB2YWwgLSBRRU1VX0xPQ0tDTlRfQ09VTlRfU1RFUCk7CisgICAgICAg
ICAgICB2YWwgPSBxYXRvbWljX2NtcHhjaGcoJmxvY2tjbnQtPmNvdW50LCB2YWwsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsIC0gUUVNVV9MT0NLQ05UX0NPVU5UX1NURVAp
OwogICAgICAgICAgICAgaWYgKHZhbCA9PSBleHBlY3RlZCkgewogICAgICAgICAgICAgICAgIGJy
ZWFrOwogICAgICAgICAgICAgfQpAQCAtMTk5LDcgKzIwMSw3IEBAIGJvb2wgcWVtdV9sb2NrY250
X2RlY19hbmRfbG9jayhRZW11TG9ja0NudCAqbG9ja2NudCkKICAqLwogYm9vbCBxZW11X2xvY2tj
bnRfZGVjX2lmX2xvY2soUWVtdUxvY2tDbnQgKmxvY2tjbnQpCiB7Ci0gICAgaW50IHZhbCA9IGF0
b21pY19yZWFkKCZsb2NrY250LT5jb3VudCk7CisgICAgaW50IHZhbCA9IHFhdG9taWNfcmVhZCgm
bG9ja2NudC0+Y291bnQpOwogICAgIGludCBsb2NrZWRfc3RhdGUgPSBRRU1VX0xPQ0tDTlRfU1RB
VEVfTE9DS0VEOwogICAgIGJvb2wgd2FpdGVkID0gZmFsc2U7CiAKQEAgLTIzMyw3ICsyMzUsNyBA
QCBib29sIHFlbXVfbG9ja2NudF9kZWNfaWZfbG9jayhRZW11TG9ja0NudCAqbG9ja2NudCkKIAog
dm9pZCBxZW11X2xvY2tjbnRfbG9jayhRZW11TG9ja0NudCAqbG9ja2NudCkKIHsKLSAgICBpbnQg
dmFsID0gYXRvbWljX3JlYWQoJmxvY2tjbnQtPmNvdW50KTsKKyAgICBpbnQgdmFsID0gcWF0b21p
Y19yZWFkKCZsb2NrY250LT5jb3VudCk7CiAgICAgaW50IHN0ZXAgPSBRRU1VX0xPQ0tDTlRfU1RB
VEVfTE9DS0VEOwogICAgIGJvb2wgd2FpdGVkID0gZmFsc2U7CiAKQEAgLTI1NSwxMiArMjU3LDEy
IEBAIHZvaWQgcWVtdV9sb2NrY250X2luY19hbmRfdW5sb2NrKFFlbXVMb2NrQ250ICpsb2NrY250
KQogewogICAgIGludCBleHBlY3RlZCwgbmV3LCB2YWw7CiAKLSAgICB2YWwgPSBhdG9taWNfcmVh
ZCgmbG9ja2NudC0+Y291bnQpOworICAgIHZhbCA9IHFhdG9taWNfcmVhZCgmbG9ja2NudC0+Y291
bnQpOwogICAgIGRvIHsKICAgICAgICAgZXhwZWN0ZWQgPSB2YWw7CiAgICAgICAgIG5ldyA9ICh2
YWwgKyBRRU1VX0xPQ0tDTlRfQ09VTlRfU1RFUCkgJiB+UUVNVV9MT0NLQ05UX1NUQVRFX01BU0s7
CiAgICAgICAgIHRyYWNlX2xvY2tjbnRfdW5sb2NrX2F0dGVtcHQobG9ja2NudCwgdmFsLCBuZXcp
OwotICAgICAgICB2YWwgPSBhdG9taWNfY21weGNoZygmbG9ja2NudC0+Y291bnQsIHZhbCwgbmV3
KTsKKyAgICAgICAgdmFsID0gcWF0b21pY19jbXB4Y2hnKCZsb2NrY250LT5jb3VudCwgdmFsLCBu
ZXcpOwogICAgIH0gd2hpbGUgKHZhbCAhPSBleHBlY3RlZCk7CiAKICAgICB0cmFjZV9sb2NrY250
X3VubG9ja19zdWNjZXNzKGxvY2tjbnQsIHZhbCwgbmV3KTsKQEAgLTI3MywxMiArMjc1LDEyIEBA
IHZvaWQgcWVtdV9sb2NrY250X3VubG9jayhRZW11TG9ja0NudCAqbG9ja2NudCkKIHsKICAgICBp
bnQgZXhwZWN0ZWQsIG5ldywgdmFsOwogCi0gICAgdmFsID0gYXRvbWljX3JlYWQoJmxvY2tjbnQt
PmNvdW50KTsKKyAgICB2YWwgPSBxYXRvbWljX3JlYWQoJmxvY2tjbnQtPmNvdW50KTsKICAgICBk
byB7CiAgICAgICAgIGV4cGVjdGVkID0gdmFsOwogICAgICAgICBuZXcgPSB2YWwgJiB+UUVNVV9M
T0NLQ05UX1NUQVRFX01BU0s7CiAgICAgICAgIHRyYWNlX2xvY2tjbnRfdW5sb2NrX2F0dGVtcHQo
bG9ja2NudCwgdmFsLCBuZXcpOwotICAgICAgICB2YWwgPSBhdG9taWNfY21weGNoZygmbG9ja2Nu
dC0+Y291bnQsIHZhbCwgbmV3KTsKKyAgICAgICAgdmFsID0gcWF0b21pY19jbXB4Y2hnKCZsb2Nr
Y250LT5jb3VudCwgdmFsLCBuZXcpOwogICAgIH0gd2hpbGUgKHZhbCAhPSBleHBlY3RlZCk7CiAK
ICAgICB0cmFjZV9sb2NrY250X3VubG9ja19zdWNjZXNzKGxvY2tjbnQsIHZhbCwgbmV3KTsKQEAg
LTI4OSw3ICsyOTEsNyBAQCB2b2lkIHFlbXVfbG9ja2NudF91bmxvY2soUWVtdUxvY2tDbnQgKmxv
Y2tjbnQpCiAKIHVuc2lnbmVkIHFlbXVfbG9ja2NudF9jb3VudChRZW11TG9ja0NudCAqbG9ja2Nu
dCkKIHsKLSAgICByZXR1cm4gYXRvbWljX3JlYWQoJmxvY2tjbnQtPmNvdW50KSA+PiBRRU1VX0xP
Q0tDTlRfQ09VTlRfU0hJRlQ7CisgICAgcmV0dXJuIHFhdG9taWNfcmVhZCgmbG9ja2NudC0+Y291
bnQpID4+IFFFTVVfTE9DS0NOVF9DT1VOVF9TSElGVDsKIH0KICNlbHNlCiB2b2lkIHFlbXVfbG9j
a2NudF9pbml0KFFlbXVMb2NrQ250ICpsb2NrY250KQpAQCAtMzA3LDEzICszMDksMTMgQEAgdm9p
ZCBxZW11X2xvY2tjbnRfaW5jKFFlbXVMb2NrQ250ICpsb2NrY250KQogewogICAgIGludCBvbGQ7
CiAgICAgZm9yICg7OykgewotICAgICAgICBvbGQgPSBhdG9taWNfcmVhZCgmbG9ja2NudC0+Y291
bnQpOworICAgICAgICBvbGQgPSBxYXRvbWljX3JlYWQoJmxvY2tjbnQtPmNvdW50KTsKICAgICAg
ICAgaWYgKG9sZCA9PSAwKSB7CiAgICAgICAgICAgICBxZW11X2xvY2tjbnRfbG9jayhsb2NrY250
KTsKICAgICAgICAgICAgIHFlbXVfbG9ja2NudF9pbmNfYW5kX3VubG9jayhsb2NrY250KTsKICAg
ICAgICAgICAgIHJldHVybjsKICAgICAgICAgfSBlbHNlIHsKLSAgICAgICAgICAgIGlmIChhdG9t
aWNfY21weGNoZygmbG9ja2NudC0+Y291bnQsIG9sZCwgb2xkICsgMSkgPT0gb2xkKSB7CisgICAg
ICAgICAgICBpZiAocWF0b21pY19jbXB4Y2hnKCZsb2NrY250LT5jb3VudCwgb2xkLCBvbGQgKyAx
KSA9PSBvbGQpIHsKICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICB9CiAgICAg
ICAgIH0KQEAgLTMyMiw3ICszMjQsNyBAQCB2b2lkIHFlbXVfbG9ja2NudF9pbmMoUWVtdUxvY2tD
bnQgKmxvY2tjbnQpCiAKIHZvaWQgcWVtdV9sb2NrY250X2RlYyhRZW11TG9ja0NudCAqbG9ja2Nu
dCkKIHsKLSAgICBhdG9taWNfZGVjKCZsb2NrY250LT5jb3VudCk7CisgICAgcWF0b21pY19kZWMo
JmxvY2tjbnQtPmNvdW50KTsKIH0KIAogLyogRGVjcmVtZW50IGEgY291bnRlciwgYW5kIHJldHVy
biBsb2NrZWQgaWYgaXQgaXMgZGVjcmVtZW50ZWQgdG8gemVyby4KQEAgLTMzMSw5ICszMzMsOSBA
QCB2b2lkIHFlbXVfbG9ja2NudF9kZWMoUWVtdUxvY2tDbnQgKmxvY2tjbnQpCiAgKi8KIGJvb2wg
cWVtdV9sb2NrY250X2RlY19hbmRfbG9jayhRZW11TG9ja0NudCAqbG9ja2NudCkKIHsKLSAgICBp
bnQgdmFsID0gYXRvbWljX3JlYWQoJmxvY2tjbnQtPmNvdW50KTsKKyAgICBpbnQgdmFsID0gcWF0
b21pY19yZWFkKCZsb2NrY250LT5jb3VudCk7CiAgICAgd2hpbGUgKHZhbCA+IDEpIHsKLSAgICAg
ICAgaW50IG9sZCA9IGF0b21pY19jbXB4Y2hnKCZsb2NrY250LT5jb3VudCwgdmFsLCB2YWwgLSAx
KTsKKyAgICAgICAgaW50IG9sZCA9IHFhdG9taWNfY21weGNoZygmbG9ja2NudC0+Y291bnQsIHZh
bCwgdmFsIC0gMSk7CiAgICAgICAgIGlmIChvbGQgIT0gdmFsKSB7CiAgICAgICAgICAgICB2YWwg
PSBvbGQ7CiAgICAgICAgICAgICBjb250aW51ZTsKQEAgLTM0Myw3ICszNDUsNyBAQCBib29sIHFl
bXVfbG9ja2NudF9kZWNfYW5kX2xvY2soUWVtdUxvY2tDbnQgKmxvY2tjbnQpCiAgICAgfQogCiAg
ICAgcWVtdV9sb2NrY250X2xvY2sobG9ja2NudCk7Ci0gICAgaWYgKGF0b21pY19mZXRjaF9kZWMo
JmxvY2tjbnQtPmNvdW50KSA9PSAxKSB7CisgICAgaWYgKHFhdG9taWNfZmV0Y2hfZGVjKCZsb2Nr
Y250LT5jb3VudCkgPT0gMSkgewogICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICB9CiAKQEAgLTM2
MCwxMyArMzYyLDEzIEBAIGJvb2wgcWVtdV9sb2NrY250X2RlY19hbmRfbG9jayhRZW11TG9ja0Nu
dCAqbG9ja2NudCkKIGJvb2wgcWVtdV9sb2NrY250X2RlY19pZl9sb2NrKFFlbXVMb2NrQ250ICps
b2NrY250KQogewogICAgIC8qIE5vIG5lZWQgZm9yIGFjcXVpcmUgc2VtYW50aWNzIGlmIHdlIHJl
dHVybiBmYWxzZS4gICovCi0gICAgaW50IHZhbCA9IGF0b21pY19yZWFkKCZsb2NrY250LT5jb3Vu
dCk7CisgICAgaW50IHZhbCA9IHFhdG9taWNfcmVhZCgmbG9ja2NudC0+Y291bnQpOwogICAgIGlm
ICh2YWwgPiAxKSB7CiAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICB9CiAKICAgICBxZW11X2xv
Y2tjbnRfbG9jayhsb2NrY250KTsKLSAgICBpZiAoYXRvbWljX2ZldGNoX2RlYygmbG9ja2NudC0+
Y291bnQpID09IDEpIHsKKyAgICBpZiAocWF0b21pY19mZXRjaF9kZWMoJmxvY2tjbnQtPmNvdW50
KSA9PSAxKSB7CiAgICAgICAgIHJldHVybiB0cnVlOwogICAgIH0KIApAQCAtMzgxLDcgKzM4Myw3
IEBAIHZvaWQgcWVtdV9sb2NrY250X2xvY2soUWVtdUxvY2tDbnQgKmxvY2tjbnQpCiAKIHZvaWQg
cWVtdV9sb2NrY250X2luY19hbmRfdW5sb2NrKFFlbXVMb2NrQ250ICpsb2NrY250KQogewotICAg
IGF0b21pY19pbmMoJmxvY2tjbnQtPmNvdW50KTsKKyAgICBxYXRvbWljX2luYygmbG9ja2NudC0+
Y291bnQpOwogICAgIHFlbXVfbXV0ZXhfdW5sb2NrKCZsb2NrY250LT5tdXRleCk7CiB9CiAKQEAg
LTM5Miw2ICszOTQsNiBAQCB2b2lkIHFlbXVfbG9ja2NudF91bmxvY2soUWVtdUxvY2tDbnQgKmxv
Y2tjbnQpCiAKIHVuc2lnbmVkIHFlbXVfbG9ja2NudF9jb3VudChRZW11TG9ja0NudCAqbG9ja2Nu
dCkKIHsKLSAgICByZXR1cm4gYXRvbWljX3JlYWQoJmxvY2tjbnQtPmNvdW50KTsKKyAgICByZXR1
cm4gcWF0b21pY19yZWFkKCZsb2NrY250LT5jb3VudCk7CiB9CiAjZW5kaWYKZGlmZiAtLWdpdCBh
L3V0aWwvbG9nLmMgYi91dGlsL2xvZy5jCmluZGV4IGJkYjNkNzEyZTguLjRiNDIzMDYyYWEgMTAw
NjQ0Ci0tLSBhL3V0aWwvbG9nLmMKKysrIGIvdXRpbC9sb2cuYwpAQCAtNDEsNyArNDEsNyBAQCBp
bnQgcWVtdV9sb2coY29uc3QgY2hhciAqZm10LCAuLi4pCiAgICAgUWVtdUxvZ0ZpbGUgKmxvZ2Zp
bGU7CiAKICAgICByY3VfcmVhZF9sb2NrKCk7Ci0gICAgbG9nZmlsZSA9IGF0b21pY19yY3VfcmVh
ZCgmcWVtdV9sb2dmaWxlKTsKKyAgICBsb2dmaWxlID0gcWF0b21pY19yY3VfcmVhZCgmcWVtdV9s
b2dmaWxlKTsKICAgICBpZiAobG9nZmlsZSkgewogICAgICAgICB2YV9saXN0IGFwOwogICAgICAg
ICB2YV9zdGFydChhcCwgZm10KTsKQEAgLTk4LDcgKzk4LDcgQEAgdm9pZCBxZW11X3NldF9sb2co
aW50IGxvZ19mbGFncykKICAgICBRRU1VX0xPQ0tfR1VBUkQoJnFlbXVfbG9nZmlsZV9tdXRleCk7
CiAgICAgaWYgKHFlbXVfbG9nZmlsZSAmJiAhbmVlZF90b19vcGVuX2ZpbGUpIHsKICAgICAgICAg
bG9nZmlsZSA9IHFlbXVfbG9nZmlsZTsKLSAgICAgICAgYXRvbWljX3JjdV9zZXQoJnFlbXVfbG9n
ZmlsZSwgTlVMTCk7CisgICAgICAgIHFhdG9taWNfcmN1X3NldCgmcWVtdV9sb2dmaWxlLCBOVUxM
KTsKICAgICAgICAgY2FsbF9yY3UobG9nZmlsZSwgcWVtdV9sb2dmaWxlX2ZyZWUsIHJjdSk7CiAg
ICAgfSBlbHNlIGlmICghcWVtdV9sb2dmaWxlICYmIG5lZWRfdG9fb3Blbl9maWxlKSB7CiAgICAg
ICAgIGxvZ2ZpbGUgPSBnX25ldzAoUWVtdUxvZ0ZpbGUsIDEpOwpAQCAtMTM1LDcgKzEzNSw3IEBA
IHZvaWQgcWVtdV9zZXRfbG9nKGludCBsb2dfZmxhZ3MpCiAjZW5kaWYKICAgICAgICAgICAgIGxv
Z19hcHBlbmQgPSAxOwogICAgICAgICB9Ci0gICAgICAgIGF0b21pY19yY3Vfc2V0KCZxZW11X2xv
Z2ZpbGUsIGxvZ2ZpbGUpOworICAgICAgICBxYXRvbWljX3JjdV9zZXQoJnFlbXVfbG9nZmlsZSwg
bG9nZmlsZSk7CiAgICAgfQogfQogCkBAIC0yNzIsNyArMjcyLDcgQEAgdm9pZCBxZW11X2xvZ19m
bHVzaCh2b2lkKQogICAgIFFlbXVMb2dGaWxlICpsb2dmaWxlOwogCiAgICAgcmN1X3JlYWRfbG9j
aygpOwotICAgIGxvZ2ZpbGUgPSBhdG9taWNfcmN1X3JlYWQoJnFlbXVfbG9nZmlsZSk7CisgICAg
bG9nZmlsZSA9IHFhdG9taWNfcmN1X3JlYWQoJnFlbXVfbG9nZmlsZSk7CiAgICAgaWYgKGxvZ2Zp
bGUpIHsKICAgICAgICAgZmZsdXNoKGxvZ2ZpbGUtPmZkKTsKICAgICB9CkBAIC0yODgsNyArMjg4
LDcgQEAgdm9pZCBxZW11X2xvZ19jbG9zZSh2b2lkKQogICAgIGxvZ2ZpbGUgPSBxZW11X2xvZ2Zp
bGU7CiAKICAgICBpZiAobG9nZmlsZSkgewotICAgICAgICBhdG9taWNfcmN1X3NldCgmcWVtdV9s
b2dmaWxlLCBOVUxMKTsKKyAgICAgICAgcWF0b21pY19yY3Vfc2V0KCZxZW11X2xvZ2ZpbGUsIE5V
TEwpOwogICAgICAgICBjYWxsX3JjdShsb2dmaWxlLCBxZW11X2xvZ2ZpbGVfZnJlZSwgcmN1KTsK
ICAgICB9CiAgICAgcWVtdV9tdXRleF91bmxvY2soJnFlbXVfbG9nZmlsZV9tdXRleCk7CmRpZmYg
LS1naXQgYS91dGlsL3FlbXUtY29yb3V0aW5lLWxvY2suYyBiL3V0aWwvcWVtdS1jb3JvdXRpbmUt
bG9jay5jCmluZGV4IDVkYTUyMzQxNTUuLjM2OTI3YjVmODggMTAwNjQ0Ci0tLSBhL3V0aWwvcWVt
dS1jb3JvdXRpbmUtbG9jay5jCisrKyBiL3V0aWwvcWVtdS1jb3JvdXRpbmUtbG9jay5jCkBAIC0y
MTIsMTAgKzIxMiwxMCBAQCBzdGF0aWMgdm9pZCBjb3JvdXRpbmVfZm4gcWVtdV9jb19tdXRleF9s
b2NrX3Nsb3dwYXRoKEFpb0NvbnRleHQgKmN0eCwKICAgICAvKiBUaGlzIGlzIHRoZSAiUmVzcG9u
c2liaWxpdHkgSGFuZC1PZmYiIHByb3RvY29sOyBhIGxvY2soKSBwaWNrcyBmcm9tCiAgICAgICog
YSBjb25jdXJyZW50IHVubG9jaygpIHRoZSByZXNwb25zaWJpbGl0eSBvZiB3YWtpbmcgc29tZWJv
ZHkgdXAuCiAgICAgICovCi0gICAgb2xkX2hhbmRvZmYgPSBhdG9taWNfbWJfcmVhZCgmbXV0ZXgt
PmhhbmRvZmYpOworICAgIG9sZF9oYW5kb2ZmID0gcWF0b21pY19tYl9yZWFkKCZtdXRleC0+aGFu
ZG9mZik7CiAgICAgaWYgKG9sZF9oYW5kb2ZmICYmCiAgICAgICAgIGhhc193YWl0ZXJzKG11dGV4
KSAmJgotICAgICAgICBhdG9taWNfY21weGNoZygmbXV0ZXgtPmhhbmRvZmYsIG9sZF9oYW5kb2Zm
LCAwKSA9PSBvbGRfaGFuZG9mZikgeworICAgICAgICBxYXRvbWljX2NtcHhjaGcoJm11dGV4LT5o
YW5kb2ZmLCBvbGRfaGFuZG9mZiwgMCkgPT0gb2xkX2hhbmRvZmYpIHsKICAgICAgICAgLyogVGhl
cmUgY2FuIGJlIG5vIGNvbmN1cnJlbnQgcG9wcywgYmVjYXVzZSB0aGVyZSBjYW4gYmUgb25seQog
ICAgICAgICAgKiBvbmUgYWN0aXZlIGhhbmRvZmYgYXQgYSB0aW1lLgogICAgICAgICAgKi8KQEAg
LTI1MCwxOCArMjUwLDE4IEBAIHZvaWQgY29yb3V0aW5lX2ZuIHFlbXVfY29fbXV0ZXhfbG9jayhD
b011dGV4ICptdXRleCkKICAgICAgKi8KICAgICBpID0gMDsKIHJldHJ5X2Zhc3RfcGF0aDoKLSAg
ICB3YWl0ZXJzID0gYXRvbWljX2NtcHhjaGcoJm11dGV4LT5sb2NrZWQsIDAsIDEpOworICAgIHdh
aXRlcnMgPSBxYXRvbWljX2NtcHhjaGcoJm11dGV4LT5sb2NrZWQsIDAsIDEpOwogICAgIGlmICh3
YWl0ZXJzICE9IDApIHsKICAgICAgICAgd2hpbGUgKHdhaXRlcnMgPT0gMSAmJiArK2kgPCAxMDAw
KSB7Ci0gICAgICAgICAgICBpZiAoYXRvbWljX3JlYWQoJm11dGV4LT5jdHgpID09IGN0eCkgewor
ICAgICAgICAgICAgaWYgKHFhdG9taWNfcmVhZCgmbXV0ZXgtPmN0eCkgPT0gY3R4KSB7CiAgICAg
ICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICB9Ci0gICAgICAgICAgICBpZiAoYXRvbWlj
X3JlYWQoJm11dGV4LT5sb2NrZWQpID09IDApIHsKKyAgICAgICAgICAgIGlmIChxYXRvbWljX3Jl
YWQoJm11dGV4LT5sb2NrZWQpID09IDApIHsKICAgICAgICAgICAgICAgICBnb3RvIHJldHJ5X2Zh
c3RfcGF0aDsKICAgICAgICAgICAgIH0KICAgICAgICAgICAgIGNwdV9yZWxheCgpOwogICAgICAg
ICB9Ci0gICAgICAgIHdhaXRlcnMgPSBhdG9taWNfZmV0Y2hfaW5jKCZtdXRleC0+bG9ja2VkKTsK
KyAgICAgICAgd2FpdGVycyA9IHFhdG9taWNfZmV0Y2hfaW5jKCZtdXRleC0+bG9ja2VkKTsKICAg
ICB9CiAKICAgICBpZiAod2FpdGVycyA9PSAwKSB7CkBAIC0yODgsNyArMjg4LDcgQEAgdm9pZCBj
b3JvdXRpbmVfZm4gcWVtdV9jb19tdXRleF91bmxvY2soQ29NdXRleCAqbXV0ZXgpCiAgICAgbXV0
ZXgtPmN0eCA9IE5VTEw7CiAgICAgbXV0ZXgtPmhvbGRlciA9IE5VTEw7CiAgICAgc2VsZi0+bG9j
a3NfaGVsZC0tOwotICAgIGlmIChhdG9taWNfZmV0Y2hfZGVjKCZtdXRleC0+bG9ja2VkKSA9PSAx
KSB7CisgICAgaWYgKHFhdG9taWNfZmV0Y2hfZGVjKCZtdXRleC0+bG9ja2VkKSA9PSAxKSB7CiAg
ICAgICAgIC8qIE5vIHdhaXRpbmcgcWVtdV9jb19tdXRleF9sb2NrKCkuICBQZmV3LCB0aGF0IHdh
cyBlYXN5ISAgKi8KICAgICAgICAgcmV0dXJuOwogICAgIH0KQEAgLTMxMSw3ICszMTEsNyBAQCB2
b2lkIGNvcm91dGluZV9mbiBxZW11X2NvX211dGV4X3VubG9jayhDb011dGV4ICptdXRleCkKICAg
ICAgICAgfQogCiAgICAgICAgIG91cl9oYW5kb2ZmID0gbXV0ZXgtPnNlcXVlbmNlOwotICAgICAg
ICBhdG9taWNfbWJfc2V0KCZtdXRleC0+aGFuZG9mZiwgb3VyX2hhbmRvZmYpOworICAgICAgICBx
YXRvbWljX21iX3NldCgmbXV0ZXgtPmhhbmRvZmYsIG91cl9oYW5kb2ZmKTsKICAgICAgICAgaWYg
KCFoYXNfd2FpdGVycyhtdXRleCkpIHsKICAgICAgICAgICAgIC8qIFRoZSBjb25jdXJyZW50IGxv
Y2sgaGFzIG5vdCBhZGRlZCBpdHNlbGYgeWV0LCBzbyBpdAogICAgICAgICAgICAgICogd2lsbCBi
ZSBhYmxlIHRvIHBpY2sgb3VyIGhhbmRvZmYuCkBAIC0zMjIsNyArMzIyLDcgQEAgdm9pZCBjb3Jv
dXRpbmVfZm4gcWVtdV9jb19tdXRleF91bmxvY2soQ29NdXRleCAqbXV0ZXgpCiAgICAgICAgIC8q
IFRyeSB0byBkbyB0aGUgaGFuZG9mZiBwcm90b2NvbCBvdXJzZWx2ZXM7IGlmIHNvbWVib2R5IGVs
c2UgaGFzCiAgICAgICAgICAqIGFscmVhZHkgdGFrZW4gaXQsIGhvd2V2ZXIsIHdlJ3JlIGRvbmUg
YW5kIHRoZXkncmUgcmVzcG9uc2libGUuCiAgICAgICAgICAqLwotICAgICAgICBpZiAoYXRvbWlj
X2NtcHhjaGcoJm11dGV4LT5oYW5kb2ZmLCBvdXJfaGFuZG9mZiwgMCkgIT0gb3VyX2hhbmRvZmYp
IHsKKyAgICAgICAgaWYgKHFhdG9taWNfY21weGNoZygmbXV0ZXgtPmhhbmRvZmYsIG91cl9oYW5k
b2ZmLCAwKSAhPSBvdXJfaGFuZG9mZikgewogICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgIH0K
ICAgICB9CmRpZmYgLS1naXQgYS91dGlsL3FlbXUtY29yb3V0aW5lLXNsZWVwLmMgYi91dGlsL3Fl
bXUtY29yb3V0aW5lLXNsZWVwLmMKaW5kZXggNzY5YTc2ZTU3ZC4uOGM0ZGFjNGZkNyAxMDA2NDQK
LS0tIGEvdXRpbC9xZW11LWNvcm91dGluZS1zbGVlcC5jCisrKyBiL3V0aWwvcWVtdS1jb3JvdXRp
bmUtc2xlZXAuYwpAQCAtMjgsNyArMjgsNyBAQCBzdHJ1Y3QgUWVtdUNvU2xlZXBTdGF0ZSB7CiB2
b2lkIHFlbXVfY29fc2xlZXBfd2FrZShRZW11Q29TbGVlcFN0YXRlICpzbGVlcF9zdGF0ZSkKIHsK
ICAgICAvKiBXcml0ZSBvZiBzY2hlZHVsZSBwcm90ZWN0ZWQgYnkgYmFycmllciB3cml0ZSBpbiBh
aW9fY29fc2NoZWR1bGUgKi8KLSAgICBjb25zdCBjaGFyICpzY2hlZHVsZWQgPSBhdG9taWNfY21w
eGNoZygmc2xlZXBfc3RhdGUtPmNvLT5zY2hlZHVsZWQsCisgICAgY29uc3QgY2hhciAqc2NoZWR1
bGVkID0gcWF0b21pY19jbXB4Y2hnKCZzbGVlcF9zdGF0ZS0+Y28tPnNjaGVkdWxlZCwKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxZW11X2NvX3NsZWVwX25zX19z
Y2hlZHVsZWQsIE5VTEwpOwogCiAgICAgYXNzZXJ0KHNjaGVkdWxlZCA9PSBxZW11X2NvX3NsZWVw
X25zX19zY2hlZHVsZWQpOwpAQCAtNTQsNyArNTQsNyBAQCB2b2lkIGNvcm91dGluZV9mbiBxZW11
X2NvX3NsZWVwX25zX3dha2VhYmxlKFFFTVVDbG9ja1R5cGUgdHlwZSwgaW50NjRfdCBucywKICAg
ICAgICAgLnVzZXJfc3RhdGVfcG9pbnRlciA9IHNsZWVwX3N0YXRlLAogICAgIH07CiAKLSAgICBj
b25zdCBjaGFyICpzY2hlZHVsZWQgPSBhdG9taWNfY21weGNoZygmc3RhdGUuY28tPnNjaGVkdWxl
ZCwgTlVMTCwKKyAgICBjb25zdCBjaGFyICpzY2hlZHVsZWQgPSBxYXRvbWljX2NtcHhjaGcoJnN0
YXRlLmNvLT5zY2hlZHVsZWQsIE5VTEwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgcWVtdV9jb19zbGVlcF9uc19fc2NoZWR1bGVkKTsKICAgICBpZiAoc2NoZWR1
bGVkKSB7CiAgICAgICAgIGZwcmludGYoc3RkZXJyLApkaWZmIC0tZ2l0IGEvdXRpbC9xZW11LWNv
cm91dGluZS5jIGIvdXRpbC9xZW11LWNvcm91dGluZS5jCmluZGV4IGMzY2FhNmM3NzAuLjM4ZmI2
ZDMwODQgMTAwNjQ0Ci0tLSBhL3V0aWwvcWVtdS1jb3JvdXRpbmUuYworKysgYi91dGlsL3FlbXUt
Y29yb3V0aW5lLmMKQEAgLTYwLDcgKzYwLDcgQEAgQ29yb3V0aW5lICpxZW11X2Nvcm91dGluZV9j
cmVhdGUoQ29yb3V0aW5lRW50cnkgKmVudHJ5LCB2b2lkICpvcGFxdWUpCiAgICAgICAgICAgICAg
ICAgICogcmVsZWFzZV9wb29sX3NpemUgYW5kIHRoZSBhY3R1YWwgc2l6ZSBvZiByZWxlYXNlX3Bv
b2wuICBCdXQKICAgICAgICAgICAgICAgICAgKiBpdCBpcyBqdXN0IGEgaGV1cmlzdGljLCBpdCBk
b2VzIG5vdCBuZWVkIHRvIGJlIHBlcmZlY3QuCiAgICAgICAgICAgICAgICAgICovCi0gICAgICAg
ICAgICAgICAgYWxsb2NfcG9vbF9zaXplID0gYXRvbWljX3hjaGcoJnJlbGVhc2VfcG9vbF9zaXpl
LCAwKTsKKyAgICAgICAgICAgICAgICBhbGxvY19wb29sX3NpemUgPSBxYXRvbWljX3hjaGcoJnJl
bGVhc2VfcG9vbF9zaXplLCAwKTsKICAgICAgICAgICAgICAgICBRU0xJU1RfTU9WRV9BVE9NSUMo
JmFsbG9jX3Bvb2wsICZyZWxlYXNlX3Bvb2wpOwogICAgICAgICAgICAgICAgIGNvID0gUVNMSVNU
X0ZJUlNUKCZhbGxvY19wb29sKTsKICAgICAgICAgICAgIH0KQEAgLTg4LDcgKzg4LDcgQEAgc3Rh
dGljIHZvaWQgY29yb3V0aW5lX2RlbGV0ZShDb3JvdXRpbmUgKmNvKQogICAgIGlmIChDT05GSUdf
Q09ST1VUSU5FX1BPT0wpIHsKICAgICAgICAgaWYgKHJlbGVhc2VfcG9vbF9zaXplIDwgUE9PTF9C
QVRDSF9TSVpFICogMikgewogICAgICAgICAgICAgUVNMSVNUX0lOU0VSVF9IRUFEX0FUT01JQygm
cmVsZWFzZV9wb29sLCBjbywgcG9vbF9uZXh0KTsKLSAgICAgICAgICAgIGF0b21pY19pbmMoJnJl
bGVhc2VfcG9vbF9zaXplKTsKKyAgICAgICAgICAgIHFhdG9taWNfaW5jKCZyZWxlYXNlX3Bvb2xf
c2l6ZSk7CiAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgIH0KICAgICAgICAgaWYgKGFsbG9j
X3Bvb2xfc2l6ZSA8IFBPT0xfQkFUQ0hfU0laRSkgewpAQCAtMTE1LDcgKzExNSw3IEBAIHZvaWQg
cWVtdV9haW9fY29yb3V0aW5lX2VudGVyKEFpb0NvbnRleHQgKmN0eCwgQ29yb3V0aW5lICpjbykK
IAogICAgICAgICAvKiBDYW5ub3QgcmVseSBvbiB0aGUgcmVhZCBiYXJyaWVyIGZvciB0byBpbiBh
aW9fY29fd2FrZSgpLCBhcyB0aGVyZSBhcmUKICAgICAgICAgICogY2FsbGVycyBvdXRzaWRlIG9m
IGFpb19jb193YWtlKCkgKi8KLSAgICAgICAgY29uc3QgY2hhciAqc2NoZWR1bGVkID0gYXRvbWlj
X21iX3JlYWQoJnRvLT5zY2hlZHVsZWQpOworICAgICAgICBjb25zdCBjaGFyICpzY2hlZHVsZWQg
PSBxYXRvbWljX21iX3JlYWQoJnRvLT5zY2hlZHVsZWQpOwogCiAgICAgICAgIFFTSU1QTEVRX1JF
TU9WRV9IRUFEKCZwZW5kaW5nLCBjb19xdWV1ZV9uZXh0KTsKIApkaWZmIC0tZ2l0IGEvdXRpbC9x
ZW11LXNvY2tldHMuYyBiL3V0aWwvcWVtdS1zb2NrZXRzLmMKaW5kZXggOTljZTJmZDVlNi4uZGU0
YmY3NjE2ZSAxMDA2NDQKLS0tIGEvdXRpbC9xZW11LXNvY2tldHMuYworKysgYi91dGlsL3FlbXUt
c29ja2V0cy5jCkBAIC0zOTUsNyArMzk1LDcgQEAgc3RhdGljIHN0cnVjdCBhZGRyaW5mbyAqaW5l
dF9wYXJzZV9jb25uZWN0X3NhZGRyKEluZXRTb2NrZXRBZGRyZXNzICpzYWRkciwKICAgICBtZW1z
ZXQoJmFpLCAwLCBzaXplb2YoYWkpKTsKIAogICAgIGFpLmFpX2ZsYWdzID0gQUlfQ0FOT05OQU1F
IHwgQUlfQUREUkNPTkZJRzsKLSAgICBpZiAoYXRvbWljX3JlYWQoJnVzZVY0TWFwcGVkKSkgewor
ICAgIGlmIChxYXRvbWljX3JlYWQoJnVzZVY0TWFwcGVkKSkgewogICAgICAgICBhaS5haV9mbGFn
cyB8PSBBSV9WNE1BUFBFRDsKICAgICB9CiAgICAgYWkuYWlfZmFtaWx5ID0gaW5ldF9haV9mYW1p
bHlfZnJvbV9hZGRyZXNzKHNhZGRyLCAmZXJyKTsKQEAgLTQyMSw3ICs0MjEsNyBAQCBzdGF0aWMg
c3RydWN0IGFkZHJpbmZvICppbmV0X3BhcnNlX2Nvbm5lY3Rfc2FkZHIoSW5ldFNvY2tldEFkZHJl
c3MgKnNhZGRyLAogICAgICAqLwogICAgIGlmIChyYyA9PSBFQUlfQkFERkxBR1MgJiYKICAgICAg
ICAgKGFpLmFpX2ZsYWdzICYgQUlfVjRNQVBQRUQpKSB7Ci0gICAgICAgIGF0b21pY19zZXQoJnVz
ZVY0TWFwcGVkLCAwKTsKKyAgICAgICAgcWF0b21pY19zZXQoJnVzZVY0TWFwcGVkLCAwKTsKICAg
ICAgICAgYWkuYWlfZmxhZ3MgJj0gfkFJX1Y0TUFQUEVEOwogICAgICAgICByYyA9IGdldGFkZHJp
bmZvKHNhZGRyLT5ob3N0LCBzYWRkci0+cG9ydCwgJmFpLCAmcmVzKTsKICAgICB9CmRpZmYgLS1n
aXQgYS91dGlsL3FlbXUtdGhyZWFkLXBvc2l4LmMgYi91dGlsL3FlbXUtdGhyZWFkLXBvc2l4LmMK
aW5kZXggYjRjMjM1OTI3Mi4uZGNmZjVlN2M1ZCAxMDA2NDQKLS0tIGEvdXRpbC9xZW11LXRocmVh
ZC1wb3NpeC5jCisrKyBiL3V0aWwvcWVtdS10aHJlYWQtcG9zaXguYwpAQCAtNDE0LDggKzQxNCw4
IEBAIHZvaWQgcWVtdV9ldmVudF9zZXQoUWVtdUV2ZW50ICpldikKICAgICAgKi8KICAgICBhc3Nl
cnQoZXYtPmluaXRpYWxpemVkKTsKICAgICBzbXBfbWIoKTsKLSAgICBpZiAoYXRvbWljX3JlYWQo
JmV2LT52YWx1ZSkgIT0gRVZfU0VUKSB7Ci0gICAgICAgIGlmIChhdG9taWNfeGNoZygmZXYtPnZh
bHVlLCBFVl9TRVQpID09IEVWX0JVU1kpIHsKKyAgICBpZiAocWF0b21pY19yZWFkKCZldi0+dmFs
dWUpICE9IEVWX1NFVCkgeworICAgICAgICBpZiAocWF0b21pY194Y2hnKCZldi0+dmFsdWUsIEVW
X1NFVCkgPT0gRVZfQlVTWSkgewogICAgICAgICAgICAgLyogVGhlcmUgd2VyZSB3YWl0ZXJzLCB3
YWtlIHRoZW0gdXAuICAqLwogICAgICAgICAgICAgcWVtdV9mdXRleF93YWtlKGV2LCBJTlRfTUFY
KTsKICAgICAgICAgfQpAQCAtNDI3LDE0ICs0MjcsMTQgQEAgdm9pZCBxZW11X2V2ZW50X3Jlc2V0
KFFlbXVFdmVudCAqZXYpCiAgICAgdW5zaWduZWQgdmFsdWU7CiAKICAgICBhc3NlcnQoZXYtPmlu
aXRpYWxpemVkKTsKLSAgICB2YWx1ZSA9IGF0b21pY19yZWFkKCZldi0+dmFsdWUpOworICAgIHZh
bHVlID0gcWF0b21pY19yZWFkKCZldi0+dmFsdWUpOwogICAgIHNtcF9tYl9hY3F1aXJlKCk7CiAg
ICAgaWYgKHZhbHVlID09IEVWX1NFVCkgewogICAgICAgICAvKgogICAgICAgICAgKiBJZiB0aGVy
ZSB3YXMgYSBjb25jdXJyZW50IHJlc2V0IChvciBldmVuIHJlc2V0K3dhaXQpLAogICAgICAgICAg
KiBkbyBub3RoaW5nLiAgT3RoZXJ3aXNlIGNoYW5nZSBFVl9TRVQtPkVWX0ZSRUUuCiAgICAgICAg
ICAqLwotICAgICAgICBhdG9taWNfb3IoJmV2LT52YWx1ZSwgRVZfRlJFRSk7CisgICAgICAgIHFh
dG9taWNfb3IoJmV2LT52YWx1ZSwgRVZfRlJFRSk7CiAgICAgfQogfQogCkBAIC00NDMsNyArNDQz
LDcgQEAgdm9pZCBxZW11X2V2ZW50X3dhaXQoUWVtdUV2ZW50ICpldikKICAgICB1bnNpZ25lZCB2
YWx1ZTsKIAogICAgIGFzc2VydChldi0+aW5pdGlhbGl6ZWQpOwotICAgIHZhbHVlID0gYXRvbWlj
X3JlYWQoJmV2LT52YWx1ZSk7CisgICAgdmFsdWUgPSBxYXRvbWljX3JlYWQoJmV2LT52YWx1ZSk7
CiAgICAgc21wX21iX2FjcXVpcmUoKTsKICAgICBpZiAodmFsdWUgIT0gRVZfU0VUKSB7CiAgICAg
ICAgIGlmICh2YWx1ZSA9PSBFVl9GUkVFKSB7CkBAIC00NTMsNyArNDUzLDcgQEAgdm9pZCBxZW11
X2V2ZW50X3dhaXQoUWVtdUV2ZW50ICpldikKICAgICAgICAgICAgICAqIGEgY29uY3VycmVudCBi
dXN5LT5mcmVlIHRyYW5zaXRpb24uICBBZnRlciB0aGUgQ0FTLCB0aGUKICAgICAgICAgICAgICAq
IGV2ZW50IHdpbGwgYmUgZWl0aGVyIHNldCBvciBidXN5LgogICAgICAgICAgICAgICovCi0gICAg
ICAgICAgICBpZiAoYXRvbWljX2NtcHhjaGcoJmV2LT52YWx1ZSwgRVZfRlJFRSwgRVZfQlVTWSkg
PT0gRVZfU0VUKSB7CisgICAgICAgICAgICBpZiAocWF0b21pY19jbXB4Y2hnKCZldi0+dmFsdWUs
IEVWX0ZSRUUsIEVWX0JVU1kpID09IEVWX1NFVCkgewogICAgICAgICAgICAgICAgIHJldHVybjsK
ICAgICAgICAgICAgIH0KICAgICAgICAgfQpkaWZmIC0tZ2l0IGEvdXRpbC9xZW11LXRocmVhZC13
aW4zMi5jIGIvdXRpbC9xZW11LXRocmVhZC13aW4zMi5jCmluZGV4IGQyMDdiMGNiNTguLmNiNWFh
MjAxOGMgMTAwNjQ0Ci0tLSBhL3V0aWwvcWVtdS10aHJlYWQtd2luMzIuYworKysgYi91dGlsL3Fl
bXUtdGhyZWFkLXdpbjMyLmMKQEAgLTI1MCw4ICsyNTAsOCBAQCB2b2lkIHFlbXVfZXZlbnRfc2V0
KFFlbXVFdmVudCAqZXYpCiAgICAgICogZXYtPnZhbHVlIHdlIG5lZWQgYSBmdWxsIG1lbW9yeSBi
YXJyaWVyIGhlcmUuCiAgICAgICovCiAgICAgc21wX21iKCk7Ci0gICAgaWYgKGF0b21pY19yZWFk
KCZldi0+dmFsdWUpICE9IEVWX1NFVCkgewotICAgICAgICBpZiAoYXRvbWljX3hjaGcoJmV2LT52
YWx1ZSwgRVZfU0VUKSA9PSBFVl9CVVNZKSB7CisgICAgaWYgKHFhdG9taWNfcmVhZCgmZXYtPnZh
bHVlKSAhPSBFVl9TRVQpIHsKKyAgICAgICAgaWYgKHFhdG9taWNfeGNoZygmZXYtPnZhbHVlLCBF
Vl9TRVQpID09IEVWX0JVU1kpIHsKICAgICAgICAgICAgIC8qIFRoZXJlIHdlcmUgd2FpdGVycywg
d2FrZSB0aGVtIHVwLiAgKi8KICAgICAgICAgICAgIFNldEV2ZW50KGV2LT5ldmVudCk7CiAgICAg
ICAgIH0KQEAgLTI2MywxMyArMjYzLDEzIEBAIHZvaWQgcWVtdV9ldmVudF9yZXNldChRZW11RXZl
bnQgKmV2KQogICAgIHVuc2lnbmVkIHZhbHVlOwogCiAgICAgYXNzZXJ0KGV2LT5pbml0aWFsaXpl
ZCk7Ci0gICAgdmFsdWUgPSBhdG9taWNfcmVhZCgmZXYtPnZhbHVlKTsKKyAgICB2YWx1ZSA9IHFh
dG9taWNfcmVhZCgmZXYtPnZhbHVlKTsKICAgICBzbXBfbWJfYWNxdWlyZSgpOwogICAgIGlmICh2
YWx1ZSA9PSBFVl9TRVQpIHsKICAgICAgICAgLyogSWYgdGhlcmUgd2FzIGEgY29uY3VycmVudCBy
ZXNldCAob3IgZXZlbiByZXNldCt3YWl0KSwKICAgICAgICAgICogZG8gbm90aGluZy4gIE90aGVy
d2lzZSBjaGFuZ2UgRVZfU0VULT5FVl9GUkVFLgogICAgICAgICAgKi8KLSAgICAgICAgYXRvbWlj
X29yKCZldi0+dmFsdWUsIEVWX0ZSRUUpOworICAgICAgICBxYXRvbWljX29yKCZldi0+dmFsdWUs
IEVWX0ZSRUUpOwogICAgIH0KIH0KIApAQCAtMjc4LDcgKzI3OCw3IEBAIHZvaWQgcWVtdV9ldmVu
dF93YWl0KFFlbXVFdmVudCAqZXYpCiAgICAgdW5zaWduZWQgdmFsdWU7CiAKICAgICBhc3NlcnQo
ZXYtPmluaXRpYWxpemVkKTsKLSAgICB2YWx1ZSA9IGF0b21pY19yZWFkKCZldi0+dmFsdWUpOwor
ICAgIHZhbHVlID0gcWF0b21pY19yZWFkKCZldi0+dmFsdWUpOwogICAgIHNtcF9tYl9hY3F1aXJl
KCk7CiAgICAgaWYgKHZhbHVlICE9IEVWX1NFVCkgewogICAgICAgICBpZiAodmFsdWUgPT0gRVZf
RlJFRSkgewpAQCAtMjkyLDcgKzI5Miw3IEBAIHZvaWQgcWVtdV9ldmVudF93YWl0KFFlbXVFdmVu
dCAqZXYpCiAgICAgICAgICAgICAgKiBiZWNhdXNlIHRoZXJlIGNhbm5vdCBiZSBhIGNvbmN1cnJl
bnQgYnVzeS0+ZnJlZSB0cmFuc2l0aW9uLgogICAgICAgICAgICAgICogQWZ0ZXIgdGhlIENBUywg
dGhlIGV2ZW50IHdpbGwgYmUgZWl0aGVyIHNldCBvciBidXN5LgogICAgICAgICAgICAgICovCi0g
ICAgICAgICAgICBpZiAoYXRvbWljX2NtcHhjaGcoJmV2LT52YWx1ZSwgRVZfRlJFRSwgRVZfQlVT
WSkgPT0gRVZfU0VUKSB7CisgICAgICAgICAgICBpZiAocWF0b21pY19jbXB4Y2hnKCZldi0+dmFs
dWUsIEVWX0ZSRUUsIEVWX0JVU1kpID09IEVWX1NFVCkgewogICAgICAgICAgICAgICAgIHZhbHVl
ID0gRVZfU0VUOwogICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICB2YWx1ZSA9
IEVWX0JVU1k7CmRpZmYgLS1naXQgYS91dGlsL3FlbXUtdGltZXIuYyBiL3V0aWwvcWVtdS10aW1l
ci5jCmluZGV4IDg3OGQ4MGZkNWUuLmNhNjc3ODM2Y2IgMTAwNjQ0Ci0tLSBhL3V0aWwvcWVtdS10
aW1lci5jCisrKyBiL3V0aWwvcWVtdS10aW1lci5jCkBAIC0xNzAsNyArMTcwLDcgQEAgdm9pZCBx
ZW11X2Nsb2NrX2VuYWJsZShRRU1VQ2xvY2tUeXBlIHR5cGUsIGJvb2wgZW5hYmxlZCkKIAogYm9v
bCB0aW1lcmxpc3RfaGFzX3RpbWVycyhRRU1VVGltZXJMaXN0ICp0aW1lcl9saXN0KQogewotICAg
IHJldHVybiAhIWF0b21pY19yZWFkKCZ0aW1lcl9saXN0LT5hY3RpdmVfdGltZXJzKTsKKyAgICBy
ZXR1cm4gISFxYXRvbWljX3JlYWQoJnRpbWVyX2xpc3QtPmFjdGl2ZV90aW1lcnMpOwogfQogCiBi
b29sIHFlbXVfY2xvY2tfaGFzX3RpbWVycyhRRU1VQ2xvY2tUeXBlIHR5cGUpCkBAIC0xODMsNyAr
MTgzLDcgQEAgYm9vbCB0aW1lcmxpc3RfZXhwaXJlZChRRU1VVGltZXJMaXN0ICp0aW1lcl9saXN0
KQogewogICAgIGludDY0X3QgZXhwaXJlX3RpbWU7CiAKLSAgICBpZiAoIWF0b21pY19yZWFkKCZ0
aW1lcl9saXN0LT5hY3RpdmVfdGltZXJzKSkgeworICAgIGlmICghcWF0b21pY19yZWFkKCZ0aW1l
cl9saXN0LT5hY3RpdmVfdGltZXJzKSkgewogICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgfQog
CkBAIC0yMTMsNyArMjEzLDcgQEAgaW50NjRfdCB0aW1lcmxpc3RfZGVhZGxpbmVfbnMoUUVNVVRp
bWVyTGlzdCAqdGltZXJfbGlzdCkKICAgICBpbnQ2NF90IGRlbHRhOwogICAgIGludDY0X3QgZXhw
aXJlX3RpbWU7CiAKLSAgICBpZiAoIWF0b21pY19yZWFkKCZ0aW1lcl9saXN0LT5hY3RpdmVfdGlt
ZXJzKSkgeworICAgIGlmICghcWF0b21pY19yZWFkKCZ0aW1lcl9saXN0LT5hY3RpdmVfdGltZXJz
KSkgewogICAgICAgICByZXR1cm4gLTE7CiAgICAgfQogCkBAIC0zODUsNyArMzg1LDcgQEAgc3Rh
dGljIHZvaWQgdGltZXJfZGVsX2xvY2tlZChRRU1VVGltZXJMaXN0ICp0aW1lcl9saXN0LCBRRU1V
VGltZXIgKnRzKQogICAgICAgICBpZiAoIXQpCiAgICAgICAgICAgICBicmVhazsKICAgICAgICAg
aWYgKHQgPT0gdHMpIHsKLSAgICAgICAgICAgIGF0b21pY19zZXQocHQsIHQtPm5leHQpOworICAg
ICAgICAgICAgcWF0b21pY19zZXQocHQsIHQtPm5leHQpOwogICAgICAgICAgICAgYnJlYWs7CiAg
ICAgICAgIH0KICAgICAgICAgcHQgPSAmdC0+bmV4dDsKQEAgLTQwOCw3ICs0MDgsNyBAQCBzdGF0
aWMgYm9vbCB0aW1lcl9tb2RfbnNfbG9ja2VkKFFFTVVUaW1lckxpc3QgKnRpbWVyX2xpc3QsCiAg
ICAgfQogICAgIHRzLT5leHBpcmVfdGltZSA9IE1BWChleHBpcmVfdGltZSwgMCk7CiAgICAgdHMt
Pm5leHQgPSAqcHQ7Ci0gICAgYXRvbWljX3NldChwdCwgdHMpOworICAgIHFhdG9taWNfc2V0KHB0
LCB0cyk7CiAKICAgICByZXR1cm4gcHQgPT0gJnRpbWVyX2xpc3QtPmFjdGl2ZV90aW1lcnM7CiB9
CkBAIC01MDIsNyArNTAyLDcgQEAgYm9vbCB0aW1lcmxpc3RfcnVuX3RpbWVycyhRRU1VVGltZXJM
aXN0ICp0aW1lcl9saXN0KQogICAgIFFFTVVUaW1lckNCICpjYjsKICAgICB2b2lkICpvcGFxdWU7
CiAKLSAgICBpZiAoIWF0b21pY19yZWFkKCZ0aW1lcl9saXN0LT5hY3RpdmVfdGltZXJzKSkgewor
ICAgIGlmICghcWF0b21pY19yZWFkKCZ0aW1lcl9saXN0LT5hY3RpdmVfdGltZXJzKSkgewogICAg
ICAgICByZXR1cm4gZmFsc2U7CiAgICAgfQogCmRpZmYgLS1naXQgYS91dGlsL3FodC5jIGIvdXRp
bC9xaHQuYwppbmRleCBiMmUwMjBjMzk4Li4wNzk2MDUxMjFiIDEwMDY0NAotLS0gYS91dGlsL3Fo
dC5jCisrKyBiL3V0aWwvcWh0LmMKQEAgLTEzMSwxMSArMTMxLDExIEBAIHN0YXRpYyBpbmxpbmUg
dm9pZCBxaHRfdW5sb2NrKHN0cnVjdCBxaHQgKmh0KQogCiAvKgogICogTm90ZTogcmVhZGluZyBw
YXJ0aWFsbHktdXBkYXRlZCBwb2ludGVycyBpbiBAcG9pbnRlcnMgY291bGQgbGVhZCB0bwotICog
c2VnZmF1bHRzLiBXZSB0aHVzIGFjY2VzcyB0aGVtIHdpdGggYXRvbWljX3JlYWQvc2V0OyB0aGlz
IGd1YXJhbnRlZXMKKyAqIHNlZ2ZhdWx0cy4gV2UgdGh1cyBhY2Nlc3MgdGhlbSB3aXRoIHFhdG9t
aWNfcmVhZC9zZXQ7IHRoaXMgZ3VhcmFudGVlcwogICogdGhhdCB0aGUgY29tcGlsZXIgbWFrZXMg
YWxsIHRob3NlIGFjY2Vzc2VzIGF0b21pYy4gV2UgYWxzbyBuZWVkIHRoZQotICogdm9sYXRpbGUt
bGlrZSBiZWhhdmlvciBpbiBhdG9taWNfcmVhZCwgc2luY2Ugb3RoZXJ3aXNlIHRoZSBjb21waWxl
cgorICogdm9sYXRpbGUtbGlrZSBiZWhhdmlvciBpbiBxYXRvbWljX3JlYWQsIHNpbmNlIG90aGVy
d2lzZSB0aGUgY29tcGlsZXIKICAqIG1pZ2h0IHJlZmV0Y2ggdGhlIHBvaW50ZXIuCi0gKiBhdG9t
aWNfcmVhZCdzIGFyZSBvZiBjb3Vyc2Ugbm90IG5lY2Vzc2FyeSB3aGVuIHRoZSBidWNrZXQgbG9j
ayBpcyBoZWxkLgorICogcWF0b21pY19yZWFkJ3MgYXJlIG9mIGNvdXJzZSBub3QgbmVjZXNzYXJ5
IHdoZW4gdGhlIGJ1Y2tldCBsb2NrIGlzIGhlbGQuCiAgKgogICogSWYgYm90aCBodC0+bG9jayBh
bmQgYi0+bG9jayBhcmUgZ3JhYmJlZCwgaHQtPmxvY2sgc2hvdWxkIGFsd2F5cwogICogYmUgZ3Jh
YmJlZCBmaXJzdC4KQEAgLTI4Niw3ICsyODYsNyBAQCB2b2lkIHFodF9tYXBfbG9ja19idWNrZXRz
X19ub19zdGFsZShzdHJ1Y3QgcWh0ICpodCwgc3RydWN0IHFodF9tYXAgKipwbWFwKQogewogICAg
IHN0cnVjdCBxaHRfbWFwICptYXA7CiAKLSAgICBtYXAgPSBhdG9taWNfcmN1X3JlYWQoJmh0LT5t
YXApOworICAgIG1hcCA9IHFhdG9taWNfcmN1X3JlYWQoJmh0LT5tYXApOwogICAgIHFodF9tYXBf
bG9ja19idWNrZXRzKG1hcCk7CiAgICAgaWYgKGxpa2VseSghcWh0X21hcF9pc19zdGFsZV9fbG9j
a2VkKGh0LCBtYXApKSkgewogICAgICAgICAqcG1hcCA9IG1hcDsKQEAgLTMxOCw3ICszMTgsNyBA
QCBzdHJ1Y3QgcWh0X2J1Y2tldCAqcWh0X2J1Y2tldF9sb2NrX19ub19zdGFsZShzdHJ1Y3QgcWh0
ICpodCwgdWludDMyX3QgaGFzaCwKICAgICBzdHJ1Y3QgcWh0X2J1Y2tldCAqYjsKICAgICBzdHJ1
Y3QgcWh0X21hcCAqbWFwOwogCi0gICAgbWFwID0gYXRvbWljX3JjdV9yZWFkKCZodC0+bWFwKTsK
KyAgICBtYXAgPSBxYXRvbWljX3JjdV9yZWFkKCZodC0+bWFwKTsKICAgICBiID0gcWh0X21hcF90
b19idWNrZXQobWFwLCBoYXNoKTsKIAogICAgIHFlbXVfc3Bpbl9sb2NrKCZiLT5sb2NrKTsKQEAg
LTM0MCw3ICszNDAsOCBAQCBzdHJ1Y3QgcWh0X2J1Y2tldCAqcWh0X2J1Y2tldF9sb2NrX19ub19z
dGFsZShzdHJ1Y3QgcWh0ICpodCwgdWludDMyX3QgaGFzaCwKIAogc3RhdGljIGlubGluZSBib29s
IHFodF9tYXBfbmVlZHNfcmVzaXplKGNvbnN0IHN0cnVjdCBxaHRfbWFwICptYXApCiB7Ci0gICAg
cmV0dXJuIGF0b21pY19yZWFkKCZtYXAtPm5fYWRkZWRfYnVja2V0cykgPiBtYXAtPm5fYWRkZWRf
YnVja2V0c190aHJlc2hvbGQ7CisgICAgcmV0dXJuIHFhdG9taWNfcmVhZCgmbWFwLT5uX2FkZGVk
X2J1Y2tldHMpID4KKyAgICAgICAgICAgbWFwLT5uX2FkZGVkX2J1Y2tldHNfdGhyZXNob2xkOwog
fQogCiBzdGF0aWMgaW5saW5lIHZvaWQgcWh0X2NoYWluX2Rlc3Ryb3koY29uc3Qgc3RydWN0IHFo
dF9idWNrZXQgKmhlYWQpCkBAIC00MDQsNyArNDA1LDcgQEAgdm9pZCBxaHRfaW5pdChzdHJ1Y3Qg
cWh0ICpodCwgcWh0X2NtcF9mdW5jX3QgY21wLCBzaXplX3Qgbl9lbGVtcywKICAgICBodC0+bW9k
ZSA9IG1vZGU7CiAgICAgcWVtdV9tdXRleF9pbml0KCZodC0+bG9jayk7CiAgICAgbWFwID0gcWh0
X21hcF9jcmVhdGUobl9idWNrZXRzKTsKLSAgICBhdG9taWNfcmN1X3NldCgmaHQtPm1hcCwgbWFw
KTsKKyAgICBxYXRvbWljX3JjdV9zZXQoJmh0LT5tYXAsIG1hcCk7CiB9CiAKIC8qIGNhbGwgb25s
eSB3aGVuIHRoZXJlIGFyZSBubyByZWFkZXJzL3dyaXRlcnMgbGVmdCAqLwpAQCAtNDI1LDggKzQy
Niw4IEBAIHN0YXRpYyB2b2lkIHFodF9idWNrZXRfcmVzZXRfX2xvY2tlZChzdHJ1Y3QgcWh0X2J1
Y2tldCAqaGVhZCkKICAgICAgICAgICAgIGlmIChiLT5wb2ludGVyc1tpXSA9PSBOVUxMKSB7CiAg
ICAgICAgICAgICAgICAgZ290byBkb25lOwogICAgICAgICAgICAgfQotICAgICAgICAgICAgYXRv
bWljX3NldCgmYi0+aGFzaGVzW2ldLCAwKTsKLSAgICAgICAgICAgIGF0b21pY19zZXQoJmItPnBv
aW50ZXJzW2ldLCBOVUxMKTsKKyAgICAgICAgICAgIHFhdG9taWNfc2V0KCZiLT5oYXNoZXNbaV0s
IDApOworICAgICAgICAgICAgcWF0b21pY19zZXQoJmItPnBvaW50ZXJzW2ldLCBOVUxMKTsKICAg
ICAgICAgfQogICAgICAgICBiID0gYi0+bmV4dDsKICAgICB9IHdoaWxlIChiKTsKQEAgLTQ5Miwx
OSArNDkzLDE5IEBAIHZvaWQgKnFodF9kb19sb29rdXAoY29uc3Qgc3RydWN0IHFodF9idWNrZXQg
KmhlYWQsIHFodF9sb29rdXBfZnVuY190IGZ1bmMsCiAKICAgICBkbyB7CiAgICAgICAgIGZvciAo
aSA9IDA7IGkgPCBRSFRfQlVDS0VUX0VOVFJJRVM7IGkrKykgewotICAgICAgICAgICAgaWYgKGF0
b21pY19yZWFkKCZiLT5oYXNoZXNbaV0pID09IGhhc2gpIHsKKyAgICAgICAgICAgIGlmIChxYXRv
bWljX3JlYWQoJmItPmhhc2hlc1tpXSkgPT0gaGFzaCkgewogICAgICAgICAgICAgICAgIC8qIFRo
ZSBwb2ludGVyIGlzIGRlcmVmZXJlbmNlZCBiZWZvcmUgc2VxbG9ja19yZWFkX3JldHJ5LAogICAg
ICAgICAgICAgICAgICAqIHNvICh1bmxpa2UgcWh0X2luc2VydF9fbG9ja2VkKSB3ZSBuZWVkIHRv
IHVzZQotICAgICAgICAgICAgICAgICAqIGF0b21pY19yY3VfcmVhZCBoZXJlLgorICAgICAgICAg
ICAgICAgICAqIHFhdG9taWNfcmN1X3JlYWQgaGVyZS4KICAgICAgICAgICAgICAgICAgKi8KLSAg
ICAgICAgICAgICAgICB2b2lkICpwID0gYXRvbWljX3JjdV9yZWFkKCZiLT5wb2ludGVyc1tpXSk7
CisgICAgICAgICAgICAgICAgdm9pZCAqcCA9IHFhdG9taWNfcmN1X3JlYWQoJmItPnBvaW50ZXJz
W2ldKTsKIAogICAgICAgICAgICAgICAgIGlmIChsaWtlbHkocCkgJiYgbGlrZWx5KGZ1bmMocCwg
dXNlcnApKSkgewogICAgICAgICAgICAgICAgICAgICByZXR1cm4gcDsKICAgICAgICAgICAgICAg
ICB9CiAgICAgICAgICAgICB9CiAgICAgICAgIH0KLSAgICAgICAgYiA9IGF0b21pY19yY3VfcmVh
ZCgmYi0+bmV4dCk7CisgICAgICAgIGIgPSBxYXRvbWljX3JjdV9yZWFkKCZiLT5uZXh0KTsKICAg
ICB9IHdoaWxlIChiKTsKIAogICAgIHJldHVybiBOVUxMOwpAQCAtNTMyLDcgKzUzMyw3IEBAIHZv
aWQgKnFodF9sb29rdXBfY3VzdG9tKGNvbnN0IHN0cnVjdCBxaHQgKmh0LCBjb25zdCB2b2lkICp1
c2VycCwgdWludDMyX3QgaGFzaCwKICAgICB1bnNpZ25lZCBpbnQgdmVyc2lvbjsKICAgICB2b2lk
ICpyZXQ7CiAKLSAgICBtYXAgPSBhdG9taWNfcmN1X3JlYWQoJmh0LT5tYXApOworICAgIG1hcCA9
IHFhdG9taWNfcmN1X3JlYWQoJmh0LT5tYXApOwogICAgIGIgPSBxaHRfbWFwX3RvX2J1Y2tldCht
YXAsIGhhc2gpOwogCiAgICAgdmVyc2lvbiA9IHNlcWxvY2tfcmVhZF9iZWdpbigmYi0+c2VxdWVu
Y2UpOwpAQCAtNTg0LDcgKzU4NSw3IEBAIHN0YXRpYyB2b2lkICpxaHRfaW5zZXJ0X19sb2NrZWQo
Y29uc3Qgc3RydWN0IHFodCAqaHQsIHN0cnVjdCBxaHRfbWFwICptYXAsCiAgICAgbWVtc2V0KGIs
IDAsIHNpemVvZigqYikpOwogICAgIG5ldyA9IGI7CiAgICAgaSA9IDA7Ci0gICAgYXRvbWljX2lu
YygmbWFwLT5uX2FkZGVkX2J1Y2tldHMpOworICAgIHFhdG9taWNfaW5jKCZtYXAtPm5fYWRkZWRf
YnVja2V0cyk7CiAgICAgaWYgKHVubGlrZWx5KHFodF9tYXBfbmVlZHNfcmVzaXplKG1hcCkpICYm
IG5lZWRzX3Jlc2l6ZSkgewogICAgICAgICAqbmVlZHNfcmVzaXplID0gdHJ1ZTsKICAgICB9CkBA
IC01OTMsMTEgKzU5NCwxMSBAQCBzdGF0aWMgdm9pZCAqcWh0X2luc2VydF9fbG9ja2VkKGNvbnN0
IHN0cnVjdCBxaHQgKmh0LCBzdHJ1Y3QgcWh0X21hcCAqbWFwLAogICAgIC8qIGZvdW5kIGFuIGVt
cHR5IGtleTogYWNxdWlyZSB0aGUgc2VxbG9jayBhbmQgd3JpdGUgKi8KICAgICBzZXFsb2NrX3dy
aXRlX2JlZ2luKCZoZWFkLT5zZXF1ZW5jZSk7CiAgICAgaWYgKG5ldykgewotICAgICAgICBhdG9t
aWNfcmN1X3NldCgmcHJldi0+bmV4dCwgYik7CisgICAgICAgIHFhdG9taWNfcmN1X3NldCgmcHJl
di0+bmV4dCwgYik7CiAgICAgfQogICAgIC8qIHNtcF93bWIoKSBpbXBsaWNpdCBpbiBzZXFsb2Nr
X3dyaXRlX2JlZ2luLiAgKi8KLSAgICBhdG9taWNfc2V0KCZiLT5oYXNoZXNbaV0sIGhhc2gpOwot
ICAgIGF0b21pY19zZXQoJmItPnBvaW50ZXJzW2ldLCBwKTsKKyAgICBxYXRvbWljX3NldCgmYi0+
aGFzaGVzW2ldLCBoYXNoKTsKKyAgICBxYXRvbWljX3NldCgmYi0+cG9pbnRlcnNbaV0sIHApOwog
ICAgIHNlcWxvY2tfd3JpdGVfZW5kKCZoZWFkLT5zZXF1ZW5jZSk7CiAgICAgcmV0dXJuIE5VTEw7
CiB9CkBAIC02NjgsMTEgKzY2OSwxMSBAQCBxaHRfZW50cnlfbW92ZShzdHJ1Y3QgcWh0X2J1Y2tl
dCAqdG8sIGludCBpLCBzdHJ1Y3QgcWh0X2J1Y2tldCAqZnJvbSwgaW50IGopCiAgICAgcWh0X2Rl
YnVnX2Fzc2VydCh0by0+cG9pbnRlcnNbaV0pOwogICAgIHFodF9kZWJ1Z19hc3NlcnQoZnJvbS0+
cG9pbnRlcnNbal0pOwogCi0gICAgYXRvbWljX3NldCgmdG8tPmhhc2hlc1tpXSwgZnJvbS0+aGFz
aGVzW2pdKTsKLSAgICBhdG9taWNfc2V0KCZ0by0+cG9pbnRlcnNbaV0sIGZyb20tPnBvaW50ZXJz
W2pdKTsKKyAgICBxYXRvbWljX3NldCgmdG8tPmhhc2hlc1tpXSwgZnJvbS0+aGFzaGVzW2pdKTsK
KyAgICBxYXRvbWljX3NldCgmdG8tPnBvaW50ZXJzW2ldLCBmcm9tLT5wb2ludGVyc1tqXSk7CiAK
LSAgICBhdG9taWNfc2V0KCZmcm9tLT5oYXNoZXNbal0sIDApOwotICAgIGF0b21pY19zZXQoJmZy
b20tPnBvaW50ZXJzW2pdLCBOVUxMKTsKKyAgICBxYXRvbWljX3NldCgmZnJvbS0+aGFzaGVzW2pd
LCAwKTsKKyAgICBxYXRvbWljX3NldCgmZnJvbS0+cG9pbnRlcnNbal0sIE5VTEwpOwogfQogCiAv
KgpAQCAtNjg3LDcgKzY4OCw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBxaHRfYnVja2V0X3JlbW92
ZV9lbnRyeShzdHJ1Y3QgcWh0X2J1Y2tldCAqb3JpZywgaW50IHBvcykKIAogICAgIGlmIChxaHRf
ZW50cnlfaXNfbGFzdChvcmlnLCBwb3MpKSB7CiAgICAgICAgIG9yaWctPmhhc2hlc1twb3NdID0g
MDsKLSAgICAgICAgYXRvbWljX3NldCgmb3JpZy0+cG9pbnRlcnNbcG9zXSwgTlVMTCk7CisgICAg
ICAgIHFhdG9taWNfc2V0KCZvcmlnLT5wb2ludGVyc1twb3NdLCBOVUxMKTsKICAgICAgICAgcmV0
dXJuOwogICAgIH0KICAgICBkbyB7CkBAIC04MDMsNyArODA0LDcgQEAgZG9fcWh0X2l0ZXIoc3Ry
dWN0IHFodCAqaHQsIGNvbnN0IHN0cnVjdCBxaHRfaXRlciAqaXRlciwgdm9pZCAqdXNlcnApCiB7
CiAgICAgc3RydWN0IHFodF9tYXAgKm1hcDsKIAotICAgIG1hcCA9IGF0b21pY19yY3VfcmVhZCgm
aHQtPm1hcCk7CisgICAgbWFwID0gcWF0b21pY19yY3VfcmVhZCgmaHQtPm1hcCk7CiAgICAgcWh0
X21hcF9sb2NrX2J1Y2tldHMobWFwKTsKICAgICBxaHRfbWFwX2l0ZXJfX2FsbF9sb2NrZWQobWFw
LCBpdGVyLCB1c2VycCk7CiAgICAgcWh0X21hcF91bmxvY2tfYnVja2V0cyhtYXApOwpAQCAtODc2
LDcgKzg3Nyw3IEBAIHN0YXRpYyB2b2lkIHFodF9kb19yZXNpemVfcmVzZXQoc3RydWN0IHFodCAq
aHQsIHN0cnVjdCBxaHRfbWFwICpuZXcsIGJvb2wgcmVzZXQpCiAgICAgcWh0X21hcF9pdGVyX19h
bGxfbG9ja2VkKG9sZCwgJml0ZXIsICZkYXRhKTsKICAgICBxaHRfbWFwX2RlYnVnX19hbGxfbG9j
a2VkKG5ldyk7CiAKLSAgICBhdG9taWNfcmN1X3NldCgmaHQtPm1hcCwgbmV3KTsKKyAgICBxYXRv
bWljX3JjdV9zZXQoJmh0LT5tYXAsIG5ldyk7CiAgICAgcWh0X21hcF91bmxvY2tfYnVja2V0cyhv
bGQpOwogICAgIGNhbGxfcmN1KG9sZCwgcWh0X21hcF9kZXN0cm95LCByY3UpOwogfQpAQCAtOTA1
LDcgKzkwNiw3IEBAIHZvaWQgcWh0X3N0YXRpc3RpY3NfaW5pdChjb25zdCBzdHJ1Y3QgcWh0ICpo
dCwgc3RydWN0IHFodF9zdGF0cyAqc3RhdHMpCiAgICAgY29uc3Qgc3RydWN0IHFodF9tYXAgKm1h
cDsKICAgICBpbnQgaTsKIAotICAgIG1hcCA9IGF0b21pY19yY3VfcmVhZCgmaHQtPm1hcCk7Cisg
ICAgbWFwID0gcWF0b21pY19yY3VfcmVhZCgmaHQtPm1hcCk7CiAKICAgICBzdGF0cy0+dXNlZF9o
ZWFkX2J1Y2tldHMgPSAwOwogICAgIHN0YXRzLT5lbnRyaWVzID0gMDsKQEAgLTkzMywxMyArOTM0
LDEzIEBAIHZvaWQgcWh0X3N0YXRpc3RpY3NfaW5pdChjb25zdCBzdHJ1Y3QgcWh0ICpodCwgc3Ry
dWN0IHFodF9zdGF0cyAqc3RhdHMpCiAgICAgICAgICAgICBiID0gaGVhZDsKICAgICAgICAgICAg
IGRvIHsKICAgICAgICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgUUhUX0JVQ0tFVF9FTlRSSUVT
OyBqKyspIHsKLSAgICAgICAgICAgICAgICAgICAgaWYgKGF0b21pY19yZWFkKCZiLT5wb2ludGVy
c1tqXSkgPT0gTlVMTCkgeworICAgICAgICAgICAgICAgICAgICBpZiAocWF0b21pY19yZWFkKCZi
LT5wb2ludGVyc1tqXSkgPT0gTlVMTCkgewogICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7
CiAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgZW50cmllcysrOwog
ICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICBidWNrZXRzKys7Ci0gICAgICAgICAg
ICAgICAgYiA9IGF0b21pY19yY3VfcmVhZCgmYi0+bmV4dCk7CisgICAgICAgICAgICAgICAgYiA9
IHFhdG9taWNfcmN1X3JlYWQoJmItPm5leHQpOwogICAgICAgICAgICAgfSB3aGlsZSAoYik7CiAg
ICAgICAgIH0gd2hpbGUgKHNlcWxvY2tfcmVhZF9yZXRyeSgmaGVhZC0+c2VxdWVuY2UsIHZlcnNp
b24pKTsKIApkaWZmIC0tZ2l0IGEvdXRpbC9xc3AuYyBiL3V0aWwvcXNwLmMKaW5kZXggN2Q1MTQ3
ZjFiMi4uYmFjYzVmYTJmNiAxMDA2NDQKLS0tIGEvdXRpbC9xc3AuYworKysgYi91dGlsL3FzcC5j
CkBAIC0yNDUsMTEgKzI0NSwxMSBAQCBzdGF0aWMgdm9pZCBxc3BfZG9faW5pdCh2b2lkKQogCiBz
dGF0aWMgX19hdHRyaWJ1dGVfXygobm9pbmxpbmUpKSB2b2lkIHFzcF9pbml0X19zbG93cGF0aCh2
b2lkKQogewotICAgIGlmIChhdG9taWNfY21weGNoZygmcXNwX2luaXRpYWxpemluZywgZmFsc2Us
IHRydWUpID09IGZhbHNlKSB7CisgICAgaWYgKHFhdG9taWNfY21weGNoZygmcXNwX2luaXRpYWxp
emluZywgZmFsc2UsIHRydWUpID09IGZhbHNlKSB7CiAgICAgICAgIHFzcF9kb19pbml0KCk7Ci0g
ICAgICAgIGF0b21pY19zZXQoJnFzcF9pbml0aWFsaXplZCwgdHJ1ZSk7CisgICAgICAgIHFhdG9t
aWNfc2V0KCZxc3BfaW5pdGlhbGl6ZWQsIHRydWUpOwogICAgIH0gZWxzZSB7Ci0gICAgICAgIHdo
aWxlICghYXRvbWljX3JlYWQoJnFzcF9pbml0aWFsaXplZCkpIHsKKyAgICAgICAgd2hpbGUgKCFx
YXRvbWljX3JlYWQoJnFzcF9pbml0aWFsaXplZCkpIHsKICAgICAgICAgICAgIGNwdV9yZWxheCgp
OwogICAgICAgICB9CiAgICAgfQpAQCAtMjU4LDcgKzI1OCw3IEBAIHN0YXRpYyBfX2F0dHJpYnV0
ZV9fKChub2lubGluZSkpIHZvaWQgcXNwX2luaXRfX3Nsb3dwYXRoKHZvaWQpCiAvKiBxc3BfaW5p
dCgpIG11c3QgYmUgY2FsbGVkIGZyb20gX2FsbF8gZXhwb3J0ZWQgZnVuY3Rpb25zICovCiBzdGF0
aWMgaW5saW5lIHZvaWQgcXNwX2luaXQodm9pZCkKIHsKLSAgICBpZiAobGlrZWx5KGF0b21pY19y
ZWFkKCZxc3BfaW5pdGlhbGl6ZWQpKSkgeworICAgIGlmIChsaWtlbHkocWF0b21pY19yZWFkKCZx
c3BfaW5pdGlhbGl6ZWQpKSkgewogICAgICAgICByZXR1cm47CiAgICAgfQogICAgIHFzcF9pbml0
X19zbG93cGF0aCgpOwpAQCAtMzQ2LDkgKzM0Niw5IEBAIHN0YXRpYyBRU1BFbnRyeSAqcXNwX2Vu
dHJ5X2dldChjb25zdCB2b2lkICpvYmosIGNvbnN0IGNoYXIgKmZpbGUsIGludCBsaW5lLAogICov
CiBzdGF0aWMgaW5saW5lIHZvaWQgZG9fcXNwX2VudHJ5X3JlY29yZChRU1BFbnRyeSAqZSwgaW50
NjRfdCBkZWx0YSwgYm9vbCBhY3EpCiB7Ci0gICAgYXRvbWljX3NldF91NjQoJmUtPm5zLCBlLT5u
cyArIGRlbHRhKTsKKyAgICBxYXRvbWljX3NldF91NjQoJmUtPm5zLCBlLT5ucyArIGRlbHRhKTsK
ICAgICBpZiAoYWNxKSB7Ci0gICAgICAgIGF0b21pY19zZXRfdTY0KCZlLT5uX2FjcXMsIGUtPm5f
YWNxcyArIDEpOworICAgICAgICBxYXRvbWljX3NldF91NjQoJmUtPm5fYWNxcywgZS0+bl9hY3Fz
ICsgMSk7CiAgICAgfQogfQogCkBAIC00MzIsMjkgKzQzMiwyOSBAQCBxc3BfY29uZF90aW1lZHdh
aXQoUWVtdUNvbmQgKmNvbmQsIFFlbXVNdXRleCAqbXV0ZXgsIGludCBtcywKIAogYm9vbCBxc3Bf
aXNfZW5hYmxlZCh2b2lkKQogewotICAgIHJldHVybiBhdG9taWNfcmVhZCgmcWVtdV9tdXRleF9s
b2NrX2Z1bmMpID09IHFzcF9tdXRleF9sb2NrOworICAgIHJldHVybiBxYXRvbWljX3JlYWQoJnFl
bXVfbXV0ZXhfbG9ja19mdW5jKSA9PSBxc3BfbXV0ZXhfbG9jazsKIH0KIAogdm9pZCBxc3BfZW5h
YmxlKHZvaWQpCiB7Ci0gICAgYXRvbWljX3NldCgmcWVtdV9tdXRleF9sb2NrX2Z1bmMsIHFzcF9t
dXRleF9sb2NrKTsKLSAgICBhdG9taWNfc2V0KCZxZW11X211dGV4X3RyeWxvY2tfZnVuYywgcXNw
X211dGV4X3RyeWxvY2spOwotICAgIGF0b21pY19zZXQoJnFlbXVfYnFsX211dGV4X2xvY2tfZnVu
YywgcXNwX2JxbF9tdXRleF9sb2NrKTsKLSAgICBhdG9taWNfc2V0KCZxZW11X3JlY19tdXRleF9s
b2NrX2Z1bmMsIHFzcF9yZWNfbXV0ZXhfbG9jayk7Ci0gICAgYXRvbWljX3NldCgmcWVtdV9yZWNf
bXV0ZXhfdHJ5bG9ja19mdW5jLCBxc3BfcmVjX211dGV4X3RyeWxvY2spOwotICAgIGF0b21pY19z
ZXQoJnFlbXVfY29uZF93YWl0X2Z1bmMsIHFzcF9jb25kX3dhaXQpOwotICAgIGF0b21pY19zZXQo
JnFlbXVfY29uZF90aW1lZHdhaXRfZnVuYywgcXNwX2NvbmRfdGltZWR3YWl0KTsKKyAgICBxYXRv
bWljX3NldCgmcWVtdV9tdXRleF9sb2NrX2Z1bmMsIHFzcF9tdXRleF9sb2NrKTsKKyAgICBxYXRv
bWljX3NldCgmcWVtdV9tdXRleF90cnlsb2NrX2Z1bmMsIHFzcF9tdXRleF90cnlsb2NrKTsKKyAg
ICBxYXRvbWljX3NldCgmcWVtdV9icWxfbXV0ZXhfbG9ja19mdW5jLCBxc3BfYnFsX211dGV4X2xv
Y2spOworICAgIHFhdG9taWNfc2V0KCZxZW11X3JlY19tdXRleF9sb2NrX2Z1bmMsIHFzcF9yZWNf
bXV0ZXhfbG9jayk7CisgICAgcWF0b21pY19zZXQoJnFlbXVfcmVjX211dGV4X3RyeWxvY2tfZnVu
YywgcXNwX3JlY19tdXRleF90cnlsb2NrKTsKKyAgICBxYXRvbWljX3NldCgmcWVtdV9jb25kX3dh
aXRfZnVuYywgcXNwX2NvbmRfd2FpdCk7CisgICAgcWF0b21pY19zZXQoJnFlbXVfY29uZF90aW1l
ZHdhaXRfZnVuYywgcXNwX2NvbmRfdGltZWR3YWl0KTsKIH0KIAogdm9pZCBxc3BfZGlzYWJsZSh2
b2lkKQogewotICAgIGF0b21pY19zZXQoJnFlbXVfbXV0ZXhfbG9ja19mdW5jLCBxZW11X211dGV4
X2xvY2tfaW1wbCk7Ci0gICAgYXRvbWljX3NldCgmcWVtdV9tdXRleF90cnlsb2NrX2Z1bmMsIHFl
bXVfbXV0ZXhfdHJ5bG9ja19pbXBsKTsKLSAgICBhdG9taWNfc2V0KCZxZW11X2JxbF9tdXRleF9s
b2NrX2Z1bmMsIHFlbXVfbXV0ZXhfbG9ja19pbXBsKTsKLSAgICBhdG9taWNfc2V0KCZxZW11X3Jl
Y19tdXRleF9sb2NrX2Z1bmMsIHFlbXVfcmVjX211dGV4X2xvY2tfaW1wbCk7Ci0gICAgYXRvbWlj
X3NldCgmcWVtdV9yZWNfbXV0ZXhfdHJ5bG9ja19mdW5jLCBxZW11X3JlY19tdXRleF90cnlsb2Nr
X2ltcGwpOwotICAgIGF0b21pY19zZXQoJnFlbXVfY29uZF93YWl0X2Z1bmMsIHFlbXVfY29uZF93
YWl0X2ltcGwpOwotICAgIGF0b21pY19zZXQoJnFlbXVfY29uZF90aW1lZHdhaXRfZnVuYywgcWVt
dV9jb25kX3RpbWVkd2FpdF9pbXBsKTsKKyAgICBxYXRvbWljX3NldCgmcWVtdV9tdXRleF9sb2Nr
X2Z1bmMsIHFlbXVfbXV0ZXhfbG9ja19pbXBsKTsKKyAgICBxYXRvbWljX3NldCgmcWVtdV9tdXRl
eF90cnlsb2NrX2Z1bmMsIHFlbXVfbXV0ZXhfdHJ5bG9ja19pbXBsKTsKKyAgICBxYXRvbWljX3Nl
dCgmcWVtdV9icWxfbXV0ZXhfbG9ja19mdW5jLCBxZW11X211dGV4X2xvY2tfaW1wbCk7CisgICAg
cWF0b21pY19zZXQoJnFlbXVfcmVjX211dGV4X2xvY2tfZnVuYywgcWVtdV9yZWNfbXV0ZXhfbG9j
a19pbXBsKTsKKyAgICBxYXRvbWljX3NldCgmcWVtdV9yZWNfbXV0ZXhfdHJ5bG9ja19mdW5jLCBx
ZW11X3JlY19tdXRleF90cnlsb2NrX2ltcGwpOworICAgIHFhdG9taWNfc2V0KCZxZW11X2NvbmRf
d2FpdF9mdW5jLCBxZW11X2NvbmRfd2FpdF9pbXBsKTsKKyAgICBxYXRvbWljX3NldCgmcWVtdV9j
b25kX3RpbWVkd2FpdF9mdW5jLCBxZW11X2NvbmRfdGltZWR3YWl0X2ltcGwpOwogfQogCiBzdGF0
aWMgZ2ludCBxc3BfdHJlZV9jbXAoZ2NvbnN0cG9pbnRlciBhcCwgZ2NvbnN0cG9pbnRlciBicCwg
Z3BvaW50ZXIgdXApCkBAIC01MzgsOCArNTM4LDggQEAgc3RhdGljIHZvaWQgcXNwX2FnZ3JlZ2F0
ZSh2b2lkICpwLCB1aW50MzJfdCBoLCB2b2lkICp1cCkKICAgICAgKiBUaGUgZW50cnkgaXMgaW4g
dGhlIGdsb2JhbCBoYXNoIHRhYmxlOyByZWFkIGZyb20gaXQgYXRvbWljYWxseSAoYXMgaW4KICAg
ICAgKiAicmVhZCBvbmNlIikuCiAgICAgICovCi0gICAgYWdnLT5ucyArPSBhdG9taWNfcmVhZF91
NjQoJmUtPm5zKTsKLSAgICBhZ2ctPm5fYWNxcyArPSBhdG9taWNfcmVhZF91NjQoJmUtPm5fYWNx
cyk7CisgICAgYWdnLT5ucyArPSBxYXRvbWljX3JlYWRfdTY0KCZlLT5ucyk7CisgICAgYWdnLT5u
X2FjcXMgKz0gcWF0b21pY19yZWFkX3U2NCgmZS0+bl9hY3FzKTsKIH0KIAogc3RhdGljIHZvaWQg
cXNwX2l0ZXJfZGlmZih2b2lkICpwLCB1aW50MzJfdCBoYXNoLCB2b2lkICpodHApCkBAIC02MTAs
NyArNjEwLDcgQEAgc3RhdGljIHZvaWQgcXNwX21rdHJlZShHVHJlZSAqdHJlZSwgYm9vbCBjYWxs
c2l0ZV9jb2FsZXNjZSkKICAgICAgKiB3aXRoIHRoZSBzbmFwc2hvdC4KICAgICAgKi8KICAgICBX
SVRIX1JDVV9SRUFEX0xPQ0tfR1VBUkQoKSB7Ci0gICAgICAgIFFTUFNuYXBzaG90ICpzbmFwID0g
YXRvbWljX3JjdV9yZWFkKCZxc3Bfc25hcHNob3QpOworICAgICAgICBRU1BTbmFwc2hvdCAqc25h
cCA9IHFhdG9taWNfcmN1X3JlYWQoJnFzcF9zbmFwc2hvdCk7CiAKICAgICAgICAgLyogQWdncmVn
YXRlIGFsbCByZXN1bHRzIGZyb20gdGhlIGdsb2JhbCBoYXNoIHRhYmxlIGludG8gYSBsb2NhbCBv
bmUgKi8KICAgICAgICAgcWh0X2luaXQoJmh0LCBxc3BfZW50cnlfbm9fdGhyZWFkX2NtcCwgUVNQ
X0lOSVRJQUxfU0laRSwKQEAgLTgwNiw3ICs4MDYsNyBAQCB2b2lkIHFzcF9yZXNldCh2b2lkKQog
ICAgIHFodF9pdGVyKCZxc3BfaHQsIHFzcF9hZ2dyZWdhdGUsICZuZXctPmh0KTsKIAogICAgIC8q
IHJlcGxhY2UgdGhlIHByZXZpb3VzIHNuYXBzaG90LCBpZiBhbnkgKi8KLSAgICBvbGQgPSBhdG9t
aWNfeGNoZygmcXNwX3NuYXBzaG90LCBuZXcpOworICAgIG9sZCA9IHFhdG9taWNfeGNoZygmcXNw
X3NuYXBzaG90LCBuZXcpOwogICAgIGlmIChvbGQpIHsKICAgICAgICAgY2FsbF9yY3Uob2xkLCBx
c3Bfc25hcHNob3RfZGVzdHJveSwgcmN1KTsKICAgICB9CmRpZmYgLS1naXQgYS91dGlsL3JjdS5j
IGIvdXRpbC9yY3UuYwppbmRleCBjNGZlZmE5MzMzLi4xM2FjMGY3NWNiIDEwMDY0NAotLS0gYS91
dGlsL3JjdS5jCisrKyBiL3V0aWwvcmN1LmMKQEAgLTU3LDcgKzU3LDcgQEAgc3RhdGljIGlubGlu
ZSBpbnQgcmN1X2dwX29uZ29pbmcodW5zaWduZWQgbG9uZyAqY3RyKQogewogICAgIHVuc2lnbmVk
IGxvbmcgdjsKIAotICAgIHYgPSBhdG9taWNfcmVhZChjdHIpOworICAgIHYgPSBxYXRvbWljX3Jl
YWQoY3RyKTsKICAgICByZXR1cm4gdiAmJiAodiAhPSByY3VfZ3BfY3RyKTsKIH0KIApAQCAtODIs
MTQgKzgyLDE0IEBAIHN0YXRpYyB2b2lkIHdhaXRfZm9yX3JlYWRlcnModm9pZCkKICAgICAgICAg
ICovCiAgICAgICAgIHFlbXVfZXZlbnRfcmVzZXQoJnJjdV9ncF9ldmVudCk7CiAKLSAgICAgICAg
LyogSW5zdGVhZCBvZiB1c2luZyBhdG9taWNfbWJfc2V0IGZvciBpbmRleC0+d2FpdGluZywgYW5k
Ci0gICAgICAgICAqIGF0b21pY19tYl9yZWFkIGZvciBpbmRleC0+Y3RyLCBtZW1vcnkgYmFycmll
cnMgYXJlIHBsYWNlZAorICAgICAgICAvKiBJbnN0ZWFkIG9mIHVzaW5nIHFhdG9taWNfbWJfc2V0
IGZvciBpbmRleC0+d2FpdGluZywgYW5kCisgICAgICAgICAqIHFhdG9taWNfbWJfcmVhZCBmb3Ig
aW5kZXgtPmN0ciwgbWVtb3J5IGJhcnJpZXJzIGFyZSBwbGFjZWQKICAgICAgICAgICogbWFudWFs
bHkgc2luY2Ugd3JpdGVzIHRvIGRpZmZlcmVudCB0aHJlYWRzIGFyZSBpbmRlcGVuZGVudC4KICAg
ICAgICAgICogcWVtdV9ldmVudF9yZXNldCBoYXMgYWNxdWlyZSBzZW1hbnRpY3MsIHNvIG5vIG1l
bW9yeSBiYXJyaWVyCiAgICAgICAgICAqIGlzIG5lZWRlZCBoZXJlLgogICAgICAgICAgKi8KICAg
ICAgICAgUUxJU1RfRk9SRUFDSChpbmRleCwgJnJlZ2lzdHJ5LCBub2RlKSB7Ci0gICAgICAgICAg
ICBhdG9taWNfc2V0KCZpbmRleC0+d2FpdGluZywgdHJ1ZSk7CisgICAgICAgICAgICBxYXRvbWlj
X3NldCgmaW5kZXgtPndhaXRpbmcsIHRydWUpOwogICAgICAgICB9CiAKICAgICAgICAgLyogSGVy
ZSwgb3JkZXIgdGhlIHN0b3JlcyB0byBpbmRleC0+d2FpdGluZyBiZWZvcmUgdGhlIGxvYWRzIG9m
CkBAIC0xMDYsNyArMTA2LDcgQEAgc3RhdGljIHZvaWQgd2FpdF9mb3JfcmVhZGVycyh2b2lkKQog
ICAgICAgICAgICAgICAgIC8qIE5vIG5lZWQgZm9yIG1iX3NldCBoZXJlLCB3b3JzdCBvZiBhbGwg
d2UKICAgICAgICAgICAgICAgICAgKiBnZXQgc29tZSBleHRyYSBmdXRleCB3YWtldXBzLgogICAg
ICAgICAgICAgICAgICAqLwotICAgICAgICAgICAgICAgIGF0b21pY19zZXQoJmluZGV4LT53YWl0
aW5nLCBmYWxzZSk7CisgICAgICAgICAgICAgICAgcWF0b21pY19zZXQoJmluZGV4LT53YWl0aW5n
LCBmYWxzZSk7CiAgICAgICAgICAgICB9CiAgICAgICAgIH0KIApAQCAtMTUxLDcgKzE1MSw3IEBA
IHZvaWQgc3luY2hyb25pemVfcmN1KHZvaWQpCiAKICAgICBRRU1VX0xPQ0tfR1VBUkQoJnJjdV9y
ZWdpc3RyeV9sb2NrKTsKICAgICBpZiAoIVFMSVNUX0VNUFRZKCZyZWdpc3RyeSkpIHsKLSAgICAg
ICAgLyogSW4gZWl0aGVyIGNhc2UsIHRoZSBhdG9taWNfbWJfc2V0IGJlbG93IGJsb2NrcyBzdG9y
ZXMgdGhhdCBmcmVlCisgICAgICAgIC8qIEluIGVpdGhlciBjYXNlLCB0aGUgcWF0b21pY19tYl9z
ZXQgYmVsb3cgYmxvY2tzIHN0b3JlcyB0aGF0IGZyZWUKICAgICAgICAgICogb2xkIFJDVS1wcm90
ZWN0ZWQgcG9pbnRlcnMuCiAgICAgICAgICAqLwogICAgICAgICBpZiAoc2l6ZW9mKHJjdV9ncF9j
dHIpIDwgOCkgewpAQCAtMTYwLDEyICsxNjAsMTIgQEAgdm9pZCBzeW5jaHJvbml6ZV9yY3Uodm9p
ZCkKICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgKiBTd2l0Y2ggcGFyaXR5OiAwIC0+IDEs
IDEgLT4gMC4KICAgICAgICAgICAgICAqLwotICAgICAgICAgICAgYXRvbWljX21iX3NldCgmcmN1
X2dwX2N0ciwgcmN1X2dwX2N0ciBeIFJDVV9HUF9DVFIpOworICAgICAgICAgICAgcWF0b21pY19t
Yl9zZXQoJnJjdV9ncF9jdHIsIHJjdV9ncF9jdHIgXiBSQ1VfR1BfQ1RSKTsKICAgICAgICAgICAg
IHdhaXRfZm9yX3JlYWRlcnMoKTsKLSAgICAgICAgICAgIGF0b21pY19tYl9zZXQoJnJjdV9ncF9j
dHIsIHJjdV9ncF9jdHIgXiBSQ1VfR1BfQ1RSKTsKKyAgICAgICAgICAgIHFhdG9taWNfbWJfc2V0
KCZyY3VfZ3BfY3RyLCByY3VfZ3BfY3RyIF4gUkNVX0dQX0NUUik7CiAgICAgICAgIH0gZWxzZSB7
CiAgICAgICAgICAgICAvKiBJbmNyZW1lbnQgY3VycmVudCBncmFjZSBwZXJpb2QuICAqLwotICAg
ICAgICAgICAgYXRvbWljX21iX3NldCgmcmN1X2dwX2N0ciwgcmN1X2dwX2N0ciArIFJDVV9HUF9D
VFIpOworICAgICAgICAgICAgcWF0b21pY19tYl9zZXQoJnJjdV9ncF9jdHIsIHJjdV9ncF9jdHIg
KyBSQ1VfR1BfQ1RSKTsKICAgICAgICAgfQogCiAgICAgICAgIHdhaXRfZm9yX3JlYWRlcnMoKTsK
QEAgLTE4OCw4ICsxODgsOCBAQCBzdGF0aWMgdm9pZCBlbnF1ZXVlKHN0cnVjdCByY3VfaGVhZCAq
bm9kZSkKICAgICBzdHJ1Y3QgcmN1X2hlYWQgKipvbGRfdGFpbDsKIAogICAgIG5vZGUtPm5leHQg
PSBOVUxMOwotICAgIG9sZF90YWlsID0gYXRvbWljX3hjaGcoJnRhaWwsICZub2RlLT5uZXh0KTsK
LSAgICBhdG9taWNfbWJfc2V0KG9sZF90YWlsLCBub2RlKTsKKyAgICBvbGRfdGFpbCA9IHFhdG9t
aWNfeGNoZygmdGFpbCwgJm5vZGUtPm5leHQpOworICAgIHFhdG9taWNfbWJfc2V0KG9sZF90YWls
LCBub2RlKTsKIH0KIAogc3RhdGljIHN0cnVjdCByY3VfaGVhZCAqdHJ5X2RlcXVldWUodm9pZCkK
QEAgLTIwMyw3ICsyMDMsNyBAQCByZXRyeToKICAgICAgKiBUaGUgdGFpbCwgYmVjYXVzZSBpdCBp
cyB0aGUgZmlyc3Qgc3RlcCBpbiB0aGUgZW5xdWV1aW5nLgogICAgICAqIEl0IGlzIG9ubHkgdGhl
IG5leHQgcG9pbnRlcnMgdGhhdCBtaWdodCBiZSBpbmNvbnNpc3RlbnQuCiAgICAgICovCi0gICAg
aWYgKGhlYWQgPT0gJmR1bW15ICYmIGF0b21pY19tYl9yZWFkKCZ0YWlsKSA9PSAmZHVtbXkubmV4
dCkgeworICAgIGlmIChoZWFkID09ICZkdW1teSAmJiBxYXRvbWljX21iX3JlYWQoJnRhaWwpID09
ICZkdW1teS5uZXh0KSB7CiAgICAgICAgIGFib3J0KCk7CiAgICAgfQogCkBAIC0yMTEsNyArMjEx
LDcgQEAgcmV0cnk6CiAgICAgICogd3JvbmcgYW5kIHdlIG5lZWQgdG8gd2FpdCB1bnRpbCBpdHMg
ZW5xdWV1ZXIgZmluaXNoZXMgdGhlIHVwZGF0ZS4KICAgICAgKi8KICAgICBub2RlID0gaGVhZDsK
LSAgICBuZXh0ID0gYXRvbWljX21iX3JlYWQoJmhlYWQtPm5leHQpOworICAgIG5leHQgPSBxYXRv
bWljX21iX3JlYWQoJmhlYWQtPm5leHQpOwogICAgIGlmICghbmV4dCkgewogICAgICAgICByZXR1
cm4gTlVMTDsKICAgICB9CkBAIC0yNDAsNyArMjQwLDcgQEAgc3RhdGljIHZvaWQgKmNhbGxfcmN1
X3RocmVhZCh2b2lkICpvcGFxdWUpCiAKICAgICBmb3IgKDs7KSB7CiAgICAgICAgIGludCB0cmll
cyA9IDA7Ci0gICAgICAgIGludCBuID0gYXRvbWljX3JlYWQoJnJjdV9jYWxsX2NvdW50KTsKKyAg
ICAgICAgaW50IG4gPSBxYXRvbWljX3JlYWQoJnJjdV9jYWxsX2NvdW50KTsKIAogICAgICAgICAv
KiBIZXVyaXN0aWNhbGx5IHdhaXQgZm9yIGEgZGVjZW50IG51bWJlciBvZiBjYWxsYmFja3MgdG8g
cGlsZSB1cC4KICAgICAgICAgICogRmV0Y2ggcmN1X2NhbGxfY291bnQgbm93LCB3ZSBvbmx5IG11
c3QgcHJvY2VzcyBlbGVtZW50cyB0aGF0IHdlcmUKQEAgLTI1MCw3ICsyNTAsNyBAQCBzdGF0aWMg
dm9pZCAqY2FsbF9yY3VfdGhyZWFkKHZvaWQgKm9wYXF1ZSkKICAgICAgICAgICAgIGdfdXNsZWVw
KDEwMDAwKTsKICAgICAgICAgICAgIGlmIChuID09IDApIHsKICAgICAgICAgICAgICAgICBxZW11
X2V2ZW50X3Jlc2V0KCZyY3VfY2FsbF9yZWFkeV9ldmVudCk7Ci0gICAgICAgICAgICAgICAgbiA9
IGF0b21pY19yZWFkKCZyY3VfY2FsbF9jb3VudCk7CisgICAgICAgICAgICAgICAgbiA9IHFhdG9t
aWNfcmVhZCgmcmN1X2NhbGxfY291bnQpOwogICAgICAgICAgICAgICAgIGlmIChuID09IDApIHsK
ICNpZiBkZWZpbmVkKENPTkZJR19NQUxMT0NfVFJJTSkKICAgICAgICAgICAgICAgICAgICAgbWFs
bG9jX3RyaW0oNCAqIDEwMjQgKiAxMDI0KTsKQEAgLTI1OCwxMCArMjU4LDEwIEBAIHN0YXRpYyB2
b2lkICpjYWxsX3JjdV90aHJlYWQodm9pZCAqb3BhcXVlKQogICAgICAgICAgICAgICAgICAgICBx
ZW11X2V2ZW50X3dhaXQoJnJjdV9jYWxsX3JlYWR5X2V2ZW50KTsKICAgICAgICAgICAgICAgICB9
CiAgICAgICAgICAgICB9Ci0gICAgICAgICAgICBuID0gYXRvbWljX3JlYWQoJnJjdV9jYWxsX2Nv
dW50KTsKKyAgICAgICAgICAgIG4gPSBxYXRvbWljX3JlYWQoJnJjdV9jYWxsX2NvdW50KTsKICAg
ICAgICAgfQogCi0gICAgICAgIGF0b21pY19zdWIoJnJjdV9jYWxsX2NvdW50LCBuKTsKKyAgICAg
ICAgcWF0b21pY19zdWIoJnJjdV9jYWxsX2NvdW50LCBuKTsKICAgICAgICAgc3luY2hyb25pemVf
cmN1KCk7CiAgICAgICAgIHFlbXVfbXV0ZXhfbG9ja19pb3RocmVhZCgpOwogICAgICAgICB3aGls
ZSAobiA+IDApIHsKQEAgLTI4OSw3ICsyODksNyBAQCB2b2lkIGNhbGxfcmN1MShzdHJ1Y3QgcmN1
X2hlYWQgKm5vZGUsIHZvaWQgKCpmdW5jKShzdHJ1Y3QgcmN1X2hlYWQgKm5vZGUpKQogewogICAg
IG5vZGUtPmZ1bmMgPSBmdW5jOwogICAgIGVucXVldWUobm9kZSk7Ci0gICAgYXRvbWljX2luYygm
cmN1X2NhbGxfY291bnQpOworICAgIHFhdG9taWNfaW5jKCZyY3VfY2FsbF9jb3VudCk7CiAgICAg
cWVtdV9ldmVudF9zZXQoJnJjdV9jYWxsX3JlYWR5X2V2ZW50KTsKIH0KIApkaWZmIC0tZ2l0IGEv
dXRpbC9zdGF0czY0LmMgYi91dGlsL3N0YXRzNjQuYwppbmRleCAzODljMzY1YTllLi44OTc2MTNj
OTQ5IDEwMDY0NAotLS0gYS91dGlsL3N0YXRzNjQuYworKysgYi91dGlsL3N0YXRzNjQuYwpAQCAt
MTgsMjcgKzE4LDI3IEBACiBzdGF0aWMgaW5saW5lIHZvaWQgc3RhdDY0X3JkbG9jayhTdGF0NjQg
KnMpCiB7CiAgICAgLyogS2VlcCBvdXQgaW5jb21pbmcgd3JpdGVycyB0byBhdm9pZCB0aGVtIHN0
YXJ2aW5nIHVzLiAqLwotICAgIGF0b21pY19hZGQoJnMtPmxvY2ssIDIpOworICAgIHFhdG9taWNf
YWRkKCZzLT5sb2NrLCAyKTsKIAogICAgIC8qIElmIHRoZXJlIGlzIGEgY29uY3VycmVudCB3cml0
ZXIsIHdhaXQgZm9yIGl0LiAgKi8KLSAgICB3aGlsZSAoYXRvbWljX3JlYWQoJnMtPmxvY2spICYg
MSkgeworICAgIHdoaWxlIChxYXRvbWljX3JlYWQoJnMtPmxvY2spICYgMSkgewogICAgICAgICBj
cHVfcmVsYXgoKTsKICAgICB9CiB9CiAKIHN0YXRpYyBpbmxpbmUgdm9pZCBzdGF0NjRfcmR1bmxv
Y2soU3RhdDY0ICpzKQogewotICAgIGF0b21pY19zdWIoJnMtPmxvY2ssIDIpOworICAgIHFhdG9t
aWNfc3ViKCZzLT5sb2NrLCAyKTsKIH0KIAogc3RhdGljIGlubGluZSBib29sIHN0YXQ2NF93cnRy
eWxvY2soU3RhdDY0ICpzKQogewotICAgIHJldHVybiBhdG9taWNfY21weGNoZygmcy0+bG9jaywg
MCwgMSkgPT0gMDsKKyAgICByZXR1cm4gcWF0b21pY19jbXB4Y2hnKCZzLT5sb2NrLCAwLCAxKSA9
PSAwOwogfQogCiBzdGF0aWMgaW5saW5lIHZvaWQgc3RhdDY0X3dydW5sb2NrKFN0YXQ2NCAqcykK
IHsKLSAgICBhdG9taWNfZGVjKCZzLT5sb2NrKTsKKyAgICBxYXRvbWljX2RlYygmcy0+bG9jayk7
CiB9CiAKIHVpbnQ2NF90IHN0YXQ2NF9nZXQoY29uc3QgU3RhdDY0ICpzKQpAQCAtNTAsOCArNTAs
OCBAQCB1aW50NjRfdCBzdGF0NjRfZ2V0KGNvbnN0IFN0YXQ2NCAqcykKICAgICAvKiA2NC1iaXQg
d3JpdGVzIGFsd2F5cyB0YWtlIHRoZSBsb2NrLCBzbyB3ZSBjYW4gcmVhZCBpbgogICAgICAqIGFu
eSBvcmRlci4KICAgICAgKi8KLSAgICBoaWdoID0gYXRvbWljX3JlYWQoJnMtPmhpZ2gpOwotICAg
IGxvdyA9IGF0b21pY19yZWFkKCZzLT5sb3cpOworICAgIGhpZ2ggPSBxYXRvbWljX3JlYWQoJnMt
PmhpZ2gpOworICAgIGxvdyA9IHFhdG9taWNfcmVhZCgmcy0+bG93KTsKICAgICBzdGF0NjRfcmR1
bmxvY2soKFN0YXQ2NCAqKXMpOwogCiAgICAgcmV0dXJuICgodWludDY0X3QpaGlnaCA8PCAzMikg
fCBsb3c7CkBAIC03MCw5ICs3MCw5IEBAIGJvb2wgc3RhdDY0X2FkZDMyX2NhcnJ5KFN0YXQ2NCAq
cywgdWludDMyX3QgbG93LCB1aW50MzJfdCBoaWdoKQogICAgICAqIG9yZGVyIG9mIG91ciB1cGRh
dGUuICBCeSB1cGRhdGluZyBzLT5sb3cgZmlyc3QsIHdlIGNhbiBjaGVjawogICAgICAqIHdoZXRo
ZXIgd2UgaGF2ZSB0byBjYXJyeSBpbnRvIHMtPmhpZ2guCiAgICAgICovCi0gICAgb2xkID0gYXRv
bWljX2ZldGNoX2FkZCgmcy0+bG93LCBsb3cpOworICAgIG9sZCA9IHFhdG9taWNfZmV0Y2hfYWRk
KCZzLT5sb3csIGxvdyk7CiAgICAgaGlnaCArPSAob2xkICsgbG93KSA8IG9sZDsKLSAgICBhdG9t
aWNfYWRkKCZzLT5oaWdoLCBoaWdoKTsKKyAgICBxYXRvbWljX2FkZCgmcy0+aGlnaCwgaGlnaCk7
CiAgICAgc3RhdDY0X3dydW5sb2NrKHMpOwogICAgIHJldHVybiB0cnVlOwogfQpAQCAtODcsOCAr
ODcsOCBAQCBib29sIHN0YXQ2NF9taW5fc2xvdyhTdGF0NjQgKnMsIHVpbnQ2NF90IHZhbHVlKQog
ICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgfQogCi0gICAgaGlnaCA9IGF0b21pY19yZWFkKCZz
LT5oaWdoKTsKLSAgICBsb3cgPSBhdG9taWNfcmVhZCgmcy0+bG93KTsKKyAgICBoaWdoID0gcWF0
b21pY19yZWFkKCZzLT5oaWdoKTsKKyAgICBsb3cgPSBxYXRvbWljX3JlYWQoJnMtPmxvdyk7CiAK
ICAgICBvcmlnID0gKCh1aW50NjRfdCloaWdoIDw8IDMyKSB8IGxvdzsKICAgICBpZiAodmFsdWUg
PCBvcmlnKSB7CkBAIC05OCw5ICs5OCw5IEBAIGJvb2wgc3RhdDY0X21pbl9zbG93KFN0YXQ2NCAq
cywgdWludDY0X3QgdmFsdWUpCiAgICAgICAgICAqIGVmZmVjdCBvbiBzdGF0NjRfbWluIGlzIHRo
YXQgdGhlIHNsb3cgcGF0aCBtYXkgYmUgdHJpZ2dlcmVkCiAgICAgICAgICAqIHVubmVjZXNzYXJp
bHkuCiAgICAgICAgICAqLwotICAgICAgICBhdG9taWNfc2V0KCZzLT5sb3csICh1aW50MzJfdCl2
YWx1ZSk7CisgICAgICAgIHFhdG9taWNfc2V0KCZzLT5sb3csICh1aW50MzJfdCl2YWx1ZSk7CiAg
ICAgICAgIHNtcF93bWIoKTsKLSAgICAgICAgYXRvbWljX3NldCgmcy0+aGlnaCwgdmFsdWUgPj4g
MzIpOworICAgICAgICBxYXRvbWljX3NldCgmcy0+aGlnaCwgdmFsdWUgPj4gMzIpOwogICAgIH0K
ICAgICBzdGF0NjRfd3J1bmxvY2socyk7CiAgICAgcmV0dXJuIHRydWU7CkBAIC0xMTYsOCArMTE2
LDggQEAgYm9vbCBzdGF0NjRfbWF4X3Nsb3coU3RhdDY0ICpzLCB1aW50NjRfdCB2YWx1ZSkKICAg
ICAgICAgcmV0dXJuIGZhbHNlOwogICAgIH0KIAotICAgIGhpZ2ggPSBhdG9taWNfcmVhZCgmcy0+
aGlnaCk7Ci0gICAgbG93ID0gYXRvbWljX3JlYWQoJnMtPmxvdyk7CisgICAgaGlnaCA9IHFhdG9t
aWNfcmVhZCgmcy0+aGlnaCk7CisgICAgbG93ID0gcWF0b21pY19yZWFkKCZzLT5sb3cpOwogCiAg
ICAgb3JpZyA9ICgodWludDY0X3QpaGlnaCA8PCAzMikgfCBsb3c7CiAgICAgaWYgKHZhbHVlID4g
b3JpZykgewpAQCAtMTI3LDkgKzEyNyw5IEBAIGJvb2wgc3RhdDY0X21heF9zbG93KFN0YXQ2NCAq
cywgdWludDY0X3QgdmFsdWUpCiAgICAgICAgICAqIGVmZmVjdCBvbiBzdGF0NjRfbWF4IGlzIHRo
YXQgdGhlIHNsb3cgcGF0aCBtYXkgYmUgdHJpZ2dlcmVkCiAgICAgICAgICAqIHVubmVjZXNzYXJp
bHkuCiAgICAgICAgICAqLwotICAgICAgICBhdG9taWNfc2V0KCZzLT5sb3csICh1aW50MzJfdCl2
YWx1ZSk7CisgICAgICAgIHFhdG9taWNfc2V0KCZzLT5sb3csICh1aW50MzJfdCl2YWx1ZSk7CiAg
ICAgICAgIHNtcF93bWIoKTsKLSAgICAgICAgYXRvbWljX3NldCgmcy0+aGlnaCwgdmFsdWUgPj4g
MzIpOworICAgICAgICBxYXRvbWljX3NldCgmcy0+aGlnaCwgdmFsdWUgPj4gMzIpOwogICAgIH0K
ICAgICBzdGF0NjRfd3J1bmxvY2socyk7CiAgICAgcmV0dXJuIHRydWU7CmRpZmYgLS1naXQgYS9k
b2NzL2RldmVsL2F0b21pY3MucnN0IGIvZG9jcy9kZXZlbC9hdG9taWNzLnJzdAppbmRleCA0NDVj
M2IzNTAzLi41MmJhYTA3MzZkIDEwMDY0NAotLS0gYS9kb2NzL2RldmVsL2F0b21pY3MucnN0Cisr
KyBiL2RvY3MvZGV2ZWwvYXRvbWljcy5yc3QKQEAgLTIzLDkgKzIzLDkgQEAgcHJvdmlkZXMgbWFj
cm9zIHRoYXQgZmFsbCBpbiB0aHJlZSBjYW1wczoKIAogLSBjb21waWxlciBiYXJyaWVyczogYGBi
YXJyaWVyKClgYDsKIAotLSB3ZWFrIGF0b21pYyBhY2Nlc3MgYW5kIG1hbnVhbCBtZW1vcnkgYmFy
cmllcnM6IGBgYXRvbWljX3JlYWQoKWBgLAotICBgYGF0b21pY19zZXQoKWBgLCBgYHNtcF9ybWIo
KWBgLCBgYHNtcF93bWIoKWBgLCBgYHNtcF9tYigpYGAsIGBgc21wX21iX2FjcXVpcmUoKWBgLAot
ICBgYHNtcF9tYl9yZWxlYXNlKClgYCwgYGBzbXBfcmVhZF9iYXJyaWVyX2RlcGVuZHMoKWBgOwor
LSB3ZWFrIGF0b21pYyBhY2Nlc3MgYW5kIG1hbnVhbCBtZW1vcnkgYmFycmllcnM6IGBgcWF0b21p
Y19yZWFkKClgYCwKKyAgYGBxYXRvbWljX3NldCgpYGAsIGBgc21wX3JtYigpYGAsIGBgc21wX3dt
YigpYGAsIGBgc21wX21iKClgYCwKKyAgYGBzbXBfbWJfYWNxdWlyZSgpYGAsIGBgc21wX21iX3Jl
bGVhc2UoKWBgLCBgYHNtcF9yZWFkX2JhcnJpZXJfZGVwZW5kcygpYGA7CiAKIC0gc2VxdWVudGlh
bGx5IGNvbnNpc3RlbnQgYXRvbWljIGFjY2VzczogZXZlcnl0aGluZyBlbHNlLgogCkBAIC02Nywy
MyArNjcsMjMgQEAgaW4gdGhlIG9yZGVyIHNwZWNpZmllZCBieSBpdHMgcHJvZ3JhbSIuCiBgYHFl
bXUvYXRvbWljLmhgYCBwcm92aWRlcyB0aGUgZm9sbG93aW5nIHNldCBvZiBhdG9taWMgcmVhZC1t
b2RpZnktd3JpdGUKIG9wZXJhdGlvbnM6OgogCi0gICAgdm9pZCBhdG9taWNfaW5jKHB0cikKLSAg
ICB2b2lkIGF0b21pY19kZWMocHRyKQotICAgIHZvaWQgYXRvbWljX2FkZChwdHIsIHZhbCkKLSAg
ICB2b2lkIGF0b21pY19zdWIocHRyLCB2YWwpCi0gICAgdm9pZCBhdG9taWNfYW5kKHB0ciwgdmFs
KQotICAgIHZvaWQgYXRvbWljX29yKHB0ciwgdmFsKQorICAgIHZvaWQgcWF0b21pY19pbmMocHRy
KQorICAgIHZvaWQgcWF0b21pY19kZWMocHRyKQorICAgIHZvaWQgcWF0b21pY19hZGQocHRyLCB2
YWwpCisgICAgdm9pZCBxYXRvbWljX3N1YihwdHIsIHZhbCkKKyAgICB2b2lkIHFhdG9taWNfYW5k
KHB0ciwgdmFsKQorICAgIHZvaWQgcWF0b21pY19vcihwdHIsIHZhbCkKIAotICAgIHR5cGVvZigq
cHRyKSBhdG9taWNfZmV0Y2hfaW5jKHB0cikKLSAgICB0eXBlb2YoKnB0cikgYXRvbWljX2ZldGNo
X2RlYyhwdHIpCi0gICAgdHlwZW9mKCpwdHIpIGF0b21pY19mZXRjaF9hZGQocHRyLCB2YWwpCi0g
ICAgdHlwZW9mKCpwdHIpIGF0b21pY19mZXRjaF9zdWIocHRyLCB2YWwpCi0gICAgdHlwZW9mKCpw
dHIpIGF0b21pY19mZXRjaF9hbmQocHRyLCB2YWwpCi0gICAgdHlwZW9mKCpwdHIpIGF0b21pY19m
ZXRjaF9vcihwdHIsIHZhbCkKLSAgICB0eXBlb2YoKnB0cikgYXRvbWljX2ZldGNoX3hvcihwdHIs
IHZhbCkKLSAgICB0eXBlb2YoKnB0cikgYXRvbWljX2ZldGNoX2luY19ub256ZXJvKHB0cikKLSAg
ICB0eXBlb2YoKnB0cikgYXRvbWljX3hjaGcocHRyLCB2YWwpCi0gICAgdHlwZW9mKCpwdHIpIGF0
b21pY19jbXB4Y2hnKHB0ciwgb2xkLCBuZXcpCisgICAgdHlwZW9mKCpwdHIpIHFhdG9taWNfZmV0
Y2hfaW5jKHB0cikKKyAgICB0eXBlb2YoKnB0cikgcWF0b21pY19mZXRjaF9kZWMocHRyKQorICAg
IHR5cGVvZigqcHRyKSBxYXRvbWljX2ZldGNoX2FkZChwdHIsIHZhbCkKKyAgICB0eXBlb2YoKnB0
cikgcWF0b21pY19mZXRjaF9zdWIocHRyLCB2YWwpCisgICAgdHlwZW9mKCpwdHIpIHFhdG9taWNf
ZmV0Y2hfYW5kKHB0ciwgdmFsKQorICAgIHR5cGVvZigqcHRyKSBxYXRvbWljX2ZldGNoX29yKHB0
ciwgdmFsKQorICAgIHR5cGVvZigqcHRyKSBxYXRvbWljX2ZldGNoX3hvcihwdHIsIHZhbCkKKyAg
ICB0eXBlb2YoKnB0cikgcWF0b21pY19mZXRjaF9pbmNfbm9uemVybyhwdHIpCisgICAgdHlwZW9m
KCpwdHIpIHFhdG9taWNfeGNoZyhwdHIsIHZhbCkKKyAgICB0eXBlb2YoKnB0cikgcWF0b21pY19j
bXB4Y2hnKHB0ciwgb2xkLCBuZXcpCiAKIGFsbCBvZiB3aGljaCByZXR1cm4gdGhlIG9sZCB2YWx1
ZSBvZiBgYCpwdHJgYC4gIFRoZXNlIG9wZXJhdGlvbnMgYXJlCiBwb2x5bW9ycGhpYzsgdGhleSBv
cGVyYXRlIG9uIGFueSB0eXBlIHRoYXQgaXMgYXMgd2lkZSBhcyBhIHBvaW50ZXIgb3IKQEAgLTkx
LDE5ICs5MSwxOSBAQCBzbWFsbGVyLgogCiBTaW1pbGFyIG9wZXJhdGlvbnMgcmV0dXJuIHRoZSBu
ZXcgdmFsdWUgb2YgYGAqcHRyYGA6OgogCi0gICAgdHlwZW9mKCpwdHIpIGF0b21pY19pbmNfZmV0
Y2gocHRyKQotICAgIHR5cGVvZigqcHRyKSBhdG9taWNfZGVjX2ZldGNoKHB0cikKLSAgICB0eXBl
b2YoKnB0cikgYXRvbWljX2FkZF9mZXRjaChwdHIsIHZhbCkKLSAgICB0eXBlb2YoKnB0cikgYXRv
bWljX3N1Yl9mZXRjaChwdHIsIHZhbCkKLSAgICB0eXBlb2YoKnB0cikgYXRvbWljX2FuZF9mZXRj
aChwdHIsIHZhbCkKLSAgICB0eXBlb2YoKnB0cikgYXRvbWljX29yX2ZldGNoKHB0ciwgdmFsKQot
ICAgIHR5cGVvZigqcHRyKSBhdG9taWNfeG9yX2ZldGNoKHB0ciwgdmFsKQorICAgIHR5cGVvZigq
cHRyKSBxYXRvbWljX2luY19mZXRjaChwdHIpCisgICAgdHlwZW9mKCpwdHIpIHFhdG9taWNfZGVj
X2ZldGNoKHB0cikKKyAgICB0eXBlb2YoKnB0cikgcWF0b21pY19hZGRfZmV0Y2gocHRyLCB2YWwp
CisgICAgdHlwZW9mKCpwdHIpIHFhdG9taWNfc3ViX2ZldGNoKHB0ciwgdmFsKQorICAgIHR5cGVv
ZigqcHRyKSBxYXRvbWljX2FuZF9mZXRjaChwdHIsIHZhbCkKKyAgICB0eXBlb2YoKnB0cikgcWF0
b21pY19vcl9mZXRjaChwdHIsIHZhbCkKKyAgICB0eXBlb2YoKnB0cikgcWF0b21pY194b3JfZmV0
Y2gocHRyLCB2YWwpCiAKIGBgcWVtdS9hdG9taWMuaGBgIGFsc28gcHJvdmlkZXMgbG9hZHMgYW5k
IHN0b3JlcyB0aGF0IGNhbm5vdCBiZSByZW9yZGVyZWQKIHdpdGggZWFjaCBvdGhlcjo6CiAKLSAg
ICB0eXBlb2YoKnB0cikgYXRvbWljX21iX3JlYWQocHRyKQotICAgIHZvaWQgICAgICAgICBhdG9t
aWNfbWJfc2V0KHB0ciwgdmFsKQorICAgIHR5cGVvZigqcHRyKSBxYXRvbWljX21iX3JlYWQocHRy
KQorICAgIHZvaWQgICAgICAgICBxYXRvbWljX21iX3NldChwdHIsIHZhbCkKIAogSG93ZXZlciB0
aGVzZSBkbyBub3QgcHJvdmlkZSBzZXF1ZW50aWFsIGNvbnNpc3RlbmN5IGFuZCwgaW4gcGFydGlj
dWxhciwKIHRoZXkgZG8gbm90IHBhcnRpY2lwYXRlIGluIHRoZSB0b3RhbCBvcmRlcmluZyBlbmZv
cmNlZCBieQpAQCAtMTE1LDExICsxMTUsMTEgQEAgZWFzaWVzdCB0byBoYXJkZXN0KToKIAogLSBs
aWdodHdlaWdodCBzeW5jaHJvbml6YXRpb24gcHJpbWl0aXZlcyBzdWNoIGFzIGBgUWVtdUV2ZW50
YGAKIAotLSBSQ1Ugb3BlcmF0aW9ucyAoYGBhdG9taWNfcmN1X3JlYWRgYCwgYGBhdG9taWNfcmN1
X3NldGBgKSB3aGVuIHB1Ymxpc2hpbmcKKy0gUkNVIG9wZXJhdGlvbnMgKGBgcWF0b21pY19yY3Vf
cmVhZGBgLCBgYHFhdG9taWNfcmN1X3NldGBgKSB3aGVuIHB1Ymxpc2hpbmcKICAgb3IgYWNjZXNz
aW5nIGEgbmV3IHZlcnNpb24gb2YgYSBkYXRhIHN0cnVjdHVyZQogCi0tIG90aGVyIGF0b21pYyBh
Y2Nlc3NlczogYGBhdG9taWNfcmVhZGBgIGFuZCBgYGF0b21pY19sb2FkX2FjcXVpcmVgYCBmb3IK
LSAgbG9hZHMsIGBgYXRvbWljX3NldGBgIGFuZCBgYGF0b21pY19zdG9yZV9yZWxlYXNlYGAgZm9y
IHN0b3JlcywgYGBzbXBfbWJgYAorLSBvdGhlciBhdG9taWMgYWNjZXNzZXM6IGBgcWF0b21pY19y
ZWFkYGAgYW5kIGBgcWF0b21pY19sb2FkX2FjcXVpcmVgYCBmb3IKKyAgbG9hZHMsIGBgcWF0b21p
Y19zZXRgYCBhbmQgYGBxYXRvbWljX3N0b3JlX3JlbGVhc2VgYCBmb3Igc3RvcmVzLCBgYHNtcF9t
YmBgCiAgIHRvIGZvcmJpZCByZW9yZGVyaW5nIHN1YnNlcXVlbnQgbG9hZHMgYmVmb3JlIGEgc3Rv
cmUuCiAKIApAQCAtMTQ5LDIyICsxNDksMjIgQEAgVGhlIG9ubHkgZ3VhcmFudGVlcyB0aGF0IHlv
dSBjYW4gcmVseSB1cG9uIGluIHRoaXMgY2FzZSBhcmU6CiAKIFdoZW4gdXNpbmcgdGhpcyBtb2Rl
bCwgdmFyaWFibGVzIGFyZSBhY2Nlc3NlZCB3aXRoOgogCi0tIGBgYXRvbWljX3JlYWQoKWBgIGFu
ZCBgYGF0b21pY19zZXQoKWBgOyB0aGVzZSBwcmV2ZW50IHRoZSBjb21waWxlciBmcm9tCistIGBg
cWF0b21pY19yZWFkKClgYCBhbmQgYGBxYXRvbWljX3NldCgpYGA7IHRoZXNlIHByZXZlbnQgdGhl
IGNvbXBpbGVyIGZyb20KICAgb3B0aW1pemluZyBhY2Nlc3NlcyBvdXQgb2YgZXhpc3RlbmNlIGFu
ZCBjcmVhdGluZyB1bnNvbGljaXRlZAogICBhY2Nlc3NlcywgYnV0IGRvIG5vdCBvdGhlcndpc2Ug
aW1wb3NlIGFueSBvcmRlcmluZyBvbiBsb2FkcyBhbmQKICAgc3RvcmVzOiBib3RoIHRoZSBjb21w
aWxlciBhbmQgdGhlIHByb2Nlc3NvciBhcmUgZnJlZSB0byByZW9yZGVyCiAgIHRoZW0uCiAKLS0g
YGBhdG9taWNfbG9hZF9hY3F1aXJlKClgYCwgd2hpY2ggZ3VhcmFudGVlcyB0aGUgTE9BRCB0byBh
cHBlYXIgdG8KKy0gYGBxYXRvbWljX2xvYWRfYWNxdWlyZSgpYGAsIHdoaWNoIGd1YXJhbnRlZXMg
dGhlIExPQUQgdG8gYXBwZWFyIHRvCiAgIGhhcHBlbiwgd2l0aCByZXNwZWN0IHRvIHRoZSBvdGhl
ciBjb21wb25lbnRzIG9mIHRoZSBzeXN0ZW0sCiAgIGJlZm9yZSBhbGwgdGhlIExPQUQgb3IgU1RP
UkUgb3BlcmF0aW9ucyBzcGVjaWZpZWQgYWZ0ZXJ3YXJkcy4KLSAgT3BlcmF0aW9ucyBjb21pbmcg
YmVmb3JlIGBgYXRvbWljX2xvYWRfYWNxdWlyZSgpYGAgY2FuIHN0aWxsIGJlCisgIE9wZXJhdGlv
bnMgY29taW5nIGJlZm9yZSBgYHFhdG9taWNfbG9hZF9hY3F1aXJlKClgYCBjYW4gc3RpbGwgYmUK
ICAgcmVvcmRlcmVkIGFmdGVyIGl0LgogCi0tIGBgYXRvbWljX3N0b3JlX3JlbGVhc2UoKWBgLCB3
aGljaCBndWFyYW50ZWVzIHRoZSBTVE9SRSB0byBhcHBlYXIgdG8KKy0gYGBxYXRvbWljX3N0b3Jl
X3JlbGVhc2UoKWBgLCB3aGljaCBndWFyYW50ZWVzIHRoZSBTVE9SRSB0byBhcHBlYXIgdG8KICAg
aGFwcGVuLCB3aXRoIHJlc3BlY3QgdG8gdGhlIG90aGVyIGNvbXBvbmVudHMgb2YgdGhlIHN5c3Rl
bSwKICAgYWZ0ZXIgYWxsIHRoZSBMT0FEIG9yIFNUT1JFIG9wZXJhdGlvbnMgc3BlY2lmaWVkIGJl
Zm9yZS4KLSAgT3BlcmF0aW9ucyBjb21pbmcgYWZ0ZXIgYGBhdG9taWNfc3RvcmVfcmVsZWFzZSgp
YGAgY2FuIHN0aWxsIGJlCisgIE9wZXJhdGlvbnMgY29taW5nIGFmdGVyIGBgcWF0b21pY19zdG9y
ZV9yZWxlYXNlKClgYCBjYW4gc3RpbGwgYmUKICAgcmVvcmRlcmVkIGJlZm9yZSBpdC4KIAogUmVz
dHJpY3Rpb25zIHRvIHRoZSBvcmRlcmluZyBvZiBhY2Nlc3NlcyBjYW4gYWxzbyBiZSBzcGVjaWZp
ZWQKQEAgLTIyOSw3ICsyMjksNyBAQCBUaGV5IGNvbWUgaW4gc2l4IGtpbmRzOgogICBkZXBlbmRl
bmN5IGFuZCBhIGZ1bGwgcmVhZCBiYXJyaWVyIG9yIGJldHRlciBpcyByZXF1aXJlZC4KIAogCi1N
ZW1vcnkgYmFycmllcnMgYW5kIGBgYXRvbWljX2xvYWRfYWNxdWlyZWBgL2BgYXRvbWljX3N0b3Jl
X3JlbGVhc2VgYCBhcmUKK01lbW9yeSBiYXJyaWVycyBhbmQgYGBxYXRvbWljX2xvYWRfYWNxdWly
ZWBgL2BgcWF0b21pY19zdG9yZV9yZWxlYXNlYGAgYXJlCiBtb3N0bHkgdXNlZCB3aGVuIGEgZGF0
YSBzdHJ1Y3R1cmUgaGFzIG9uZSB0aHJlYWQgdGhhdCBpcyBhbHdheXMgYSB3cml0ZXIKIGFuZCBv
bmUgdGhyZWFkIHRoYXQgaXMgYWx3YXlzIGEgcmVhZGVyOgogCkBAIC0yMzgsOCArMjM4LDggQEAg
YW5kIG9uZSB0aHJlYWQgdGhhdCBpcyBhbHdheXMgYSByZWFkZXI6CiAgICAgKz09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT0rPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PSsKICAgICB8IDo6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgOjogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgfAogICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8Ci0gICAgfCAgIGF0b21p
Y19zdG9yZV9yZWxlYXNlKCZhLCB4KTsgICB8ICAgeSA9IGF0b21pY19sb2FkX2FjcXVpcmUoJmIp
OyAgIHwKLSAgICB8ICAgYXRvbWljX3N0b3JlX3JlbGVhc2UoJmIsIHkpOyAgIHwgICB4ID0gYXRv
bWljX2xvYWRfYWNxdWlyZSgmYSk7ICAgfAorICAgIHwgICBxYXRvbWljX3N0b3JlX3JlbGVhc2Uo
JmEsIHgpOyAgfCAgIHkgPSBxYXRvbWljX2xvYWRfYWNxdWlyZSgmYik7ICB8CisgICAgfCAgIHFh
dG9taWNfc3RvcmVfcmVsZWFzZSgmYiwgeSk7ICB8ICAgeCA9IHFhdG9taWNfbG9hZF9hY3F1aXJl
KCZhKTsgIHwKICAgICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKwogCiBJbiB0aGlzIGNhc2UsIGNvcnJlY3RuZXNz
IGlzIGVhc3kgdG8gY2hlY2sgZm9yIHVzaW5nIHRoZSAicGFpcmluZyIKQEAgLTI1OCwxNCArMjU4
LDE0IEBAIG91dHNpZGUgYSBsb29wLiAgRm9yIGV4YW1wbGU6CiAgICAgfCAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgfAogICAgIHwgICBuID0gMDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8
ICAgbiA9IDA7ICAgICAgICAgICAgICAgICAgICAgICAgIHwKICAgICB8ICAgZm9yIChpID0gMDsg
aSA8IDEwOyBpKyspICAgICAgICAgICAgICAgfCAgIGZvciAoaSA9IDA7IGkgPCAxMDsgaSsrKSAg
ICAgICB8Ci0gICAgfCAgICAgbiArPSBhdG9taWNfbG9hZF9hY3F1aXJlKCZhW2ldKTsgICAgIHwg
ICAgIG4gKz0gYXRvbWljX3JlYWQoJmFbaV0pOyAgICAgfAorICAgIHwgICAgIG4gKz0gcWF0b21p
Y19sb2FkX2FjcXVpcmUoJmFbaV0pOyAgICB8ICAgICBuICs9IHFhdG9taWNfcmVhZCgmYVtpXSk7
ICAgIHwKICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAg
IHNtcF9tYl9hY3F1aXJlKCk7ICAgICAgICAgICAgICB8CiAgICAgKy0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tKwogICAgIHwgOjogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IDo6
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwKICAgICB8ICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB8CiAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICBz
bXBfbWJfcmVsZWFzZSgpOyAgICAgICAgICAgICAgfAogICAgIHwgICBmb3IgKGkgPSAwOyBpIDwg
MTA7IGkrKykgICAgICAgICAgICAgICB8ICAgZm9yIChpID0gMDsgaSA8IDEwOyBpKyspICAgICAg
IHwKLSAgICB8ICAgICBhdG9taWNfc3RvcmVfcmVsZWFzZSgmYVtpXSwgZmFsc2UpOyAgfCAgICAg
YXRvbWljX3NldCgmYVtpXSwgZmFsc2UpOyAgICB8CisgICAgfCAgICAgcWF0b21pY19zdG9yZV9y
ZWxlYXNlKCZhW2ldLCBmYWxzZSk7IHwgICAgIHFhdG9taWNfc2V0KCZhW2ldLCBmYWxzZSk7ICAg
fAogICAgICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsKIAogU3BsaXR0aW5nIGEgbG9vcCBjYW4gYWxz
byBiZSB1c2VmdWwgdG8gcmVkdWNlIHRoZSBudW1iZXIgb2YgYmFycmllcnM6CkBAIC0yNzcsMTEg
KzI3NywxMSBAQCBTcGxpdHRpbmcgYSBsb29wIGNhbiBhbHNvIGJlIHVzZWZ1bCB0byByZWR1Y2Ug
dGhlIG51bWJlciBvZiBiYXJyaWVyczoKICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8CiAgICAg
fCAgIG4gPSAwOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgIHNtcF9tYl9y
ZWxlYXNlKCk7ICAgICAgICAgICAgfAogICAgIHwgICBmb3IgKGkgPSAwOyBpIDwgMTA7IGkrKykg
eyAgICAgICAgICAgICB8ICAgICBmb3IgKGkgPSAwOyBpIDwgMTA7IGkrKykgICAgIHwKLSAgICB8
ICAgICBhdG9taWNfc3RvcmVfcmVsZWFzZSgmYVtpXSwgZmFsc2UpOyAgfCAgICAgICBhdG9taWNf
c2V0KCZhW2ldLCBmYWxzZSk7ICB8CisgICAgfCAgICAgcWF0b21pY19zdG9yZV9yZWxlYXNlKCZh
W2ldLCBmYWxzZSk7IHwgICAgICAgcWF0b21pY19zZXQoJmFbaV0sIGZhbHNlKTsgfAogICAgIHwg
ICAgIHNtcF9tYigpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgICBzbWJfbWIoKTsg
ICAgICAgICAgICAgICAgICAgIHwKLSAgICB8ICAgICBuICs9IGF0b21pY19yZWFkKCZiW2ldKTsg
ICAgICAgICAgICAgfCAgICAgbiA9IDA7ICAgICAgICAgICAgICAgICAgICAgICB8CisgICAgfCAg
ICAgbiArPSBxYXRvbWljX3JlYWQoJmJbaV0pOyAgICAgICAgICAgIHwgICAgIG4gPSAwOyAgICAg
ICAgICAgICAgICAgICAgICAgfAogICAgIHwgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB8ICAgICBmb3IgKGkgPSAwOyBpIDwgMTA7IGkrKykgICAgIHwKLSAgICB8ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICBuICs9IGF0b21p
Y19yZWFkKCZiW2ldKTsgICB8CisgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHwgICAgICAgbiArPSBxYXRvbWljX3JlYWQoJmJbaV0pOyAgfAogICAgICstLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLSsKIAogSW4gdGhpcyBjYXNlLCBhIGBgc21wX21iX3JlbGVhc2UoKWBg
IGlzIGFsc28gcmVwbGFjZWQgd2l0aCBhIChwb3NzaWJseSBjaGVhcGVyLCBhbmQgY2xlYXJlcgpA
QCAtMjk0LDEwICsyOTQsMTAgQEAgYXMgd2VsbCkgYGBzbXBfd21iKClgYDoKICAgICB8ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB8CiAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHwgICAgIHNtcF9tYl9yZWxlYXNlKCk7ICAgICAgICAgICAgfAogICAgIHwgICBmb3Ig
KGkgPSAwOyBpIDwgMTA7IGkrKykgeyAgICAgICAgICAgICB8ICAgICBmb3IgKGkgPSAwOyBpIDwg
MTA7IGkrKykgICAgIHwKLSAgICB8ICAgICBhdG9taWNfc3RvcmVfcmVsZWFzZSgmYVtpXSwgZmFs
c2UpOyAgfCAgICAgICBhdG9taWNfc2V0KCZhW2ldLCBmYWxzZSk7ICB8Ci0gICAgfCAgICAgYXRv
bWljX3N0b3JlX3JlbGVhc2UoJmJbaV0sIGZhbHNlKTsgIHwgICAgIHNtYl93bWIoKTsgICAgICAg
ICAgICAgICAgICAgfAorICAgIHwgICAgIHFhdG9taWNfc3RvcmVfcmVsZWFzZSgmYVtpXSwgZmFs
c2UpOyB8ICAgICAgIHFhdG9taWNfc2V0KCZhW2ldLCBmYWxzZSk7IHwKKyAgICB8ICAgICBxYXRv
bWljX3N0b3JlX3JlbGVhc2UoJmJbaV0sIGZhbHNlKTsgfCAgICAgc21iX3dtYigpOyAgICAgICAg
ICAgICAgICAgICB8CiAgICAgfCAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHwgICAgIGZvciAoaSA9IDA7IGkgPCAxMDsgaSsrKSAgICAgfAotICAgIHwgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgICAgIGF0b21pY19zZXQoJmJbaV0s
IGZhbHNlKTsgIHwKKyAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgfCAgICAgICBxYXRvbWljX3NldCgmYltpXSwgZmFsc2UpOyB8CiAgICAgKy0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tKwogCiAKQEAgLTMwNiw3ICszMDYsNyBAQCBhcyB3ZWxsKSBgYHNtcF93bWIoKWBg
OgogQWNxdWlyZS9yZWxlYXNlIHBhaXJpbmcgYW5kIHRoZSAqc3luY2hyb25pemVzLXdpdGgqIHJl
bGF0aW9uCiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0KIAotQXRvbWljIG9wZXJhdGlvbnMgb3RoZXIgdGhhbiBgYGF0b21pY19zZXQo
KWBgIGFuZCBgYGF0b21pY19yZWFkKClgYCBoYXZlCitBdG9taWMgb3BlcmF0aW9ucyBvdGhlciB0
aGFuIGBgcWF0b21pY19zZXQoKWBgIGFuZCBgYHFhdG9taWNfcmVhZCgpYGAgaGF2ZQogZWl0aGVy
ICphY3F1aXJlKiBvciAqcmVsZWFzZSogc2VtYW50aWNzIFsjcm13XV8uICBUaGlzIGhhcyB0d28g
ZWZmZWN0czoKIAogLi4gWyNybXddIFJlYWQtbW9kaWZ5LXdyaXRlIG9wZXJhdGlvbnMgY2FuIGhh
dmUgYm90aC0tLWFjcXVpcmUgYXBwbGllcyB0byB0aGUKQEAgLTM1NywxNiArMzU3LDE2IEBAIHRo
cmVhZCAyIGlzIHJlbHlpbmcgb24gdGhlICpzeW5jaHJvbml6ZXMtd2l0aCogcmVsYXRpb24gYmV0
d2VlbiBgYHB0aHJlYWRfZXhpdGBgCiAKIFN5bmNocm9uaXphdGlvbiBiZXR3ZWVuIHRocmVhZHMg
YmFzaWNhbGx5IGRlc2NlbmRzIGZyb20gdGhpcyBwYWlyaW5nIG9mCiBhIHJlbGVhc2Ugb3BlcmF0
aW9uIGFuZCBhbiBhY3F1aXJlIG9wZXJhdGlvbi4gIFRoZXJlZm9yZSwgYXRvbWljIG9wZXJhdGlv
bnMKLW90aGVyIHRoYW4gYGBhdG9taWNfc2V0KClgYCBhbmQgYGBhdG9taWNfcmVhZCgpYGAgd2ls
bCBhbG1vc3QgYWx3YXlzIGJlCitvdGhlciB0aGFuIGBgcWF0b21pY19zZXQoKWBgIGFuZCBgYHFh
dG9taWNfcmVhZCgpYGAgd2lsbCBhbG1vc3QgYWx3YXlzIGJlCiBwYWlyZWQgd2l0aCBhbm90aGVy
IG9wZXJhdGlvbiBvZiB0aGUgb3Bwb3NpdGUga2luZDogYW4gYWNxdWlyZSBvcGVyYXRpb24KIHdp
bGwgcGFpciB3aXRoIGEgcmVsZWFzZSBvcGVyYXRpb24gYW5kIHZpY2UgdmVyc2EuICBUaGlzIHJ1
bGUgb2YgdGh1bWIgaXMKIGV4dHJlbWVseSB1c2VmdWw7IGluIHRoZSBjYXNlIG9mIFFFTVUsIGhv
d2V2ZXIsIG5vdGUgdGhhdCB0aGUgb3RoZXIKIG9wZXJhdGlvbiBtYXkgYWN0dWFsbHkgYmUgaW4g
YSBkcml2ZXIgdGhhdCBydW5zIGluIHRoZSBndWVzdCEKIAogYGBzbXBfcmVhZF9iYXJyaWVyX2Rl
cGVuZHMoKWBgLCBgYHNtcF9ybWIoKWBgLCBgYHNtcF9tYl9hY3F1aXJlKClgYCwKLWBgYXRvbWlj
X2xvYWRfYWNxdWlyZSgpYGAgYW5kIGBgYXRvbWljX3JjdV9yZWFkKClgYCBhbGwgY291bnQKK2Bg
cWF0b21pY19sb2FkX2FjcXVpcmUoKWBgIGFuZCBgYHFhdG9taWNfcmN1X3JlYWQoKWBgIGFsbCBj
b3VudAogYXMgYWNxdWlyZSBvcGVyYXRpb25zLiAgYGBzbXBfd21iKClgYCwgYGBzbXBfbWJfcmVs
ZWFzZSgpYGAsCi1gYGF0b21pY19zdG9yZV9yZWxlYXNlKClgYCBhbmQgYGBhdG9taWNfcmN1X3Nl
dCgpYGAgYWxsIGNvdW50IGFzIHJlbGVhc2UKK2BgcWF0b21pY19zdG9yZV9yZWxlYXNlKClgYCBh
bmQgYGBxYXRvbWljX3JjdV9zZXQoKWBgIGFsbCBjb3VudCBhcyByZWxlYXNlCiBvcGVyYXRpb25z
LiAgYGBzbXBfbWIoKWBgIGNvdW50cyBhcyBib3RoIGFjcXVpcmUgYW5kIHJlbGVhc2UsIHRoZXJl
Zm9yZQogaXQgY2FuIHBhaXIgd2l0aCBhbnkgb3RoZXIgYXRvbWljIG9wZXJhdGlvbi4gIEhlcmUg
aXMgYW4gZXhhbXBsZToKIApAQCAtMzc1LDExICszNzUsMTEgQEAgaXQgY2FuIHBhaXIgd2l0aCBh
bnkgb3RoZXIgYXRvbWljIG9wZXJhdGlvbi4gIEhlcmUgaXMgYW4gZXhhbXBsZToKICAgICAgICs9
PT09PT09PT09PT09PT09PT09PT09Kz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSsKICAg
ICAgIHwgOjogICAgICAgICAgICAgICAgICAgfCA6OiAgICAgICAgICAgICAgICAgICAgICAgICAg
IHwKICAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHwKLSAgICAgIHwgICBhdG9taWNfc2V0KCZhLCAxKTsgfCAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHwKKyAgICAgIHwgICBxYXRvbWljX3NldCgmYSwgMSk7fCAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHwKICAgICAgIHwgICBzbXBfd21iKCk7ICAgICAgICAgfCAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHwKLSAgICAgIHwgICBhdG9taWNfc2V0KCZiLCAyKTsg
fCAgIHggPSBhdG9taWNfcmVhZCgmYik7ICAgICAgIHwKKyAgICAgIHwgICBxYXRvbWljX3NldCgm
YiwgMik7fCAgIHggPSBxYXRvbWljX3JlYWQoJmIpOyAgICAgIHwKICAgICAgIHwgICAgICAgICAg
ICAgICAgICAgICAgfCAgIHNtcF9ybWIoKTsgICAgICAgICAgICAgICAgIHwKLSAgICAgIHwgICAg
ICAgICAgICAgICAgICAgICAgfCAgIHkgPSBhdG9taWNfcmVhZCgmYSk7ICAgICAgIHwKKyAgICAg
IHwgICAgICAgICAgICAgICAgICAgICAgfCAgIHkgPSBxYXRvbWljX3JlYWQoJmEpOyAgICAgIHwK
ICAgICAgICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLSsKIAogTm90ZSB0aGF0IGEgbG9hZC1zdG9yZSBwYWlyIG9ubHkgY291bnRzIGlmIHRoZSB0
d28gb3BlcmF0aW9ucyBhY2Nlc3MgdGhlCkBAIC0zOTMsOSArMzkzLDkgQEAgY29ycmVjdCBzeW5j
aHJvbml6YXRpb246CiAgICAgICArPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0rPT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0rCiAgICAgICB8IDo6ICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB8IDo6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8CiAgICAgICB8
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB8Ci0gICAgICB8ICAgYXRvbWljX3NldCgmYSwgMSk7ICAgICAgICAgICB8ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB8Ci0gICAgICB8ICAgYXRvbWljX3N0b3JlX3JlbGVh
c2UoJmIsIDIpOyB8ICAgeCA9IGF0b21pY19sb2FkX2FjcXVpcmUoJmIpOyB8Ci0gICAgICB8ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgeSA9IGF0b21pY19yZWFkKCZhKTsgICAg
ICAgICB8CisgICAgICB8ICAgcWF0b21pY19zZXQoJmEsIDEpOyAgICAgICAgICB8ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB8CisgICAgICB8ICAgcWF0b21pY19zdG9yZV9yZWxlYXNl
KCZiLCAyKTt8ICAgeCA9IHFhdG9taWNfbG9hZF9hY3F1aXJlKCZiKTt8CisgICAgICB8ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgeSA9IHFhdG9taWNfcmVhZCgmYSk7ICAgICAg
ICB8CiAgICAgICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0rCiAKIEFjcXVpcmUgYW5kIHJlbGVhc2Ugc2VtYW50aWNzIG9m
IGhpZ2hlci1sZXZlbCBwcmltaXRpdmVzIGNhbiBhbHNvIGJlCkBAIC00MjEsNyArNDIxLDcgQEAg
Y2Fubm90IGJlIGEgZGF0YSByYWNlOgogICAgICAgfCAgIHNtcF93bWIoKTsgICAgICAgICB8ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgfAogICAgICAgfCAgIHgtPmkgPSAyOyAgICAgICAg
ICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfAogICAgICAgfCAgIHNtcF93bWIoKTsg
ICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfAotICAgICAgfCAgIGF0b21p
Y19zZXQoJmEsIHgpOyB8ICB4ID0gYXRvbWljX3JlYWQoJmEpOyAgICAgICAgfAorICAgICAgfCAg
IHFhdG9taWNfc2V0KCZhLCB4KTt8ICB4ID0gcWF0b21pY19yZWFkKCZhKTsgICAgICAgfAogICAg
ICAgfCAgICAgICAgICAgICAgICAgICAgICB8ICBzbXBfcmVhZF9iYXJyaWVyX2RlcGVuZHMoKTsg
fAogICAgICAgfCAgICAgICAgICAgICAgICAgICAgICB8ICB5ID0geC0+aTsgICAgICAgICAgICAg
ICAgICAgfAogICAgICAgfCAgICAgICAgICAgICAgICAgICAgICB8ICBzbXBfcmVhZF9iYXJyaWVy
X2RlcGVuZHMoKTsgfApAQCAtNDQyLDcgKzQ0Miw3IEBAIGFuZCBtZW1vcnkgYmFycmllcnMsIGFu
ZCB0aGUgZXF1aXZhbGVudHMgaW4gUUVNVToKICAgYXQgYWxsLiBMaW51eCA0LjEgdXBkYXRlZCB0
aGVtIHRvIGltcGxlbWVudCB2b2xhdGlsZQogICBzZW1hbnRpY3MgdmlhIGBgQUNDRVNTX09OQ0Vg
YCAob3IgdGhlIG1vcmUgcmVjZW50IGBgUkVBRGBgL2BgV1JJVEVfT05DRWBgKS4KIAotICBRRU1V
J3MgYGBhdG9taWNfcmVhZGBgIGFuZCBgYGF0b21pY19zZXRgYCBpbXBsZW1lbnQgQzExIGF0b21p
YyByZWxheGVkCisgIFFFTVUncyBgYHFhdG9taWNfcmVhZGBgIGFuZCBgYHFhdG9taWNfc2V0YGAg
aW1wbGVtZW50IEMxMSBhdG9taWMgcmVsYXhlZAogICBzZW1hbnRpY3MgaWYgdGhlIGNvbXBpbGVy
IHN1cHBvcnRzIGl0LCBhbmQgdm9sYXRpbGUgc2VtYW50aWNzIG90aGVyd2lzZS4KICAgQm90aCBz
ZW1hbnRpY3MgcHJldmVudCB0aGUgY29tcGlsZXIgZnJvbSBkb2luZyBjZXJ0YWluIHRyYW5zZm9y
bWF0aW9uczsKICAgdGhlIGRpZmZlcmVuY2UgaXMgdGhhdCBhdG9taWMgYWNjZXNzZXMgYXJlIGd1
YXJhbnRlZWQgdG8gYmUgYXRvbWljLApAQCAtNDUxLDggKzQ1MSw4IEBAIGFuZCBtZW1vcnkgYmFy
cmllcnMsIGFuZCB0aGUgZXF1aXZhbGVudHMgaW4gUUVNVToKICAgc2luY2Ugd2UgYXNzdW1lIHRo
ZSB2YXJpYWJsZXMgcGFzc2VkIGFyZSBtYWNoaW5lLXdvcmQgc2l6ZWQgYW5kCiAgIHByb3Blcmx5
IGFsaWduZWQuCiAKLSAgTm8gYmFycmllcnMgYXJlIGltcGxpZWQgYnkgYGBhdG9taWNfcmVhZGBg
IGFuZCBgYGF0b21pY19zZXRgYCBpbiBlaXRoZXIgTGludXgKLSAgb3IgUUVNVS4KKyAgTm8gYmFy
cmllcnMgYXJlIGltcGxpZWQgYnkgYGBxYXRvbWljX3JlYWRgYCBhbmQgYGBxYXRvbWljX3NldGBg
IGluIGVpdGhlcgorICBMaW51eCBvciBRRU1VLgogCiAtIGF0b21pYyByZWFkLW1vZGlmeS13cml0
ZSBvcGVyYXRpb25zIGluIExpbnV4IGFyZSBvZiB0aHJlZSBraW5kczoKIApAQCAtNDY5LDcgKzQ2
OSw3IEBAIGFuZCBtZW1vcnkgYmFycmllcnMsIGFuZCB0aGUgZXF1aXZhbGVudHMgaW4gUUVNVToK
ICAgYSBkaWZmZXJlbnQgc2V0IG9mIG1lbW9yeSBiYXJyaWVyczsgaW4gUUVNVSwgYWxsIG9mIHRo
ZW0gZW5mb3JjZQogICBzZXF1ZW50aWFsIGNvbnNpc3RlbmN5LgogCi0tIGluIFFFTVUsIGBgYXRv
bWljX3JlYWQoKWBgIGFuZCBgYGF0b21pY19zZXQoKWBgIGRvIG5vdCBwYXJ0aWNpcGF0ZSBpbgor
LSBpbiBRRU1VLCBgYHFhdG9taWNfcmVhZCgpYGAgYW5kIGBgcWF0b21pY19zZXQoKWBgIGRvIG5v
dCBwYXJ0aWNpcGF0ZSBpbgogICB0aGUgdG90YWwgb3JkZXJpbmcgZW5mb3JjZWQgYnkgc2VxdWVu
dGlhbGx5LWNvbnNpc3RlbnQgb3BlcmF0aW9ucy4KICAgVGhpcyBpcyBiZWNhdXNlIFFFTVUgdXNl
cyB0aGUgQzExIG1lbW9yeSBtb2RlbC4gIFRoZSBmb2xsb3dpbmcgZXhhbXBsZQogICBpcyBjb3Jy
ZWN0IGluIExpbnV4IGJ1dCBub3QgaW4gUUVNVToKQEAgLTQ3OSw4ICs0NzksOCBAQCBhbmQgbWVt
b3J5IGJhcnJpZXJzLCBhbmQgdGhlIGVxdWl2YWxlbnRzIGluIFFFTVU6CiAgICAgICArPT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PSs9PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PSsKICAgICAgIHwgOjogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCA6OiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgfAogICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8Ci0gICAgICB8ICAg
YSA9IGF0b21pY19mZXRjaF9hZGQoJngsIDIpOyAgIHwgICBhID0gYXRvbWljX2ZldGNoX2FkZCgm
eCwgMik7IHwKLSAgICAgIHwgICBiID0gUkVBRF9PTkNFKCZ5KTsgICAgICAgICAgICAgfCAgIGIg
PSBhdG9taWNfcmVhZCgmeSk7ICAgICAgICAgfAorICAgICAgfCAgIGEgPSBhdG9taWNfZmV0Y2hf
YWRkKCZ4LCAyKTsgICB8ICAgYSA9IHFhdG9taWNfZmV0Y2hfYWRkKCZ4LCAyKTt8CisgICAgICB8
ICAgYiA9IFJFQURfT05DRSgmeSk7ICAgICAgICAgICAgIHwgICBiID0gcWF0b21pY19yZWFkKCZ5
KTsgICAgICAgIHwKICAgICAgICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKwogCiAgIGJlY2F1c2UgdGhlIHJlYWQgb2Yg
YGB5YGAgY2FuIGJlIG1vdmVkIChieSBlaXRoZXIgdGhlIHByb2Nlc3NvciBvciB0aGUKQEAgLTQ5
NSwxMCArNDk1LDEwIEBAIGFuZCBtZW1vcnkgYmFycmllcnMsIGFuZCB0aGUgZXF1aXZhbGVudHMg
aW4gUUVNVToKICAgICAgICs9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSsKICAgICAg
IHwgOjogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwKICAgICAgIHwgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHwKLSAgICAgIHwgICBhID0gYXRvbWljX3JlYWQoJngpOyAgICAg
ICAgIHwKLSAgICAgIHwgICBhdG9taWNfc2V0KCZ4LCBhICsgMik7ICAgICAgIHwKKyAgICAgIHwg
ICBhID0gcWF0b21pY19yZWFkKCZ4KTsgICAgICAgIHwKKyAgICAgIHwgICBxYXRvbWljX3NldCgm
eCwgYSArIDIpOyAgICAgIHwKICAgICAgIHwgICBzbXBfbWIoKTsgICAgICAgICAgICAgICAgICAg
IHwKLSAgICAgIHwgICBiID0gYXRvbWljX3JlYWQoJnkpOyAgICAgICAgIHwKKyAgICAgIHwgICBi
ID0gcWF0b21pY19yZWFkKCZ5KTsgICAgICAgIHwKICAgICAgICstLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLSsKIAogU291cmNlcwpkaWZmIC0tZ2l0IGEvc2NyaXB0cy9rZXJuZWwtZG9j
IGIvc2NyaXB0cy9rZXJuZWwtZG9jCmluZGV4IDAzMGI1Yzg2OTEuLjQwYWQ3ODJlMzQgMTAwNzU1
Ci0tLSBhL3NjcmlwdHMva2VybmVsLWRvYworKysgYi9zY3JpcHRzL2tlcm5lbC1kb2MKQEAgLTE2
MjUsNyArMTYyNSw3IEBAIHN1YiBkdW1wX2Z1bmN0aW9uKCQkKSB7CiAgICAgIyBJZiB5b3UgbWVz
cyB3aXRoIHRoZXNlIHJlZ2V4cHMsIGl0J3MgYSBnb29kIGlkZWEgdG8gY2hlY2sgdGhhdAogICAg
ICMgdGhlIGZvbGxvd2luZyBmdW5jdGlvbnMnIGRvY3VtZW50YXRpb24gc3RpbGwgY29tZXMgb3V0
IHJpZ2h0OgogICAgICMgLSBwYXJwb3J0X3JlZ2lzdGVyX2RldmljZSAoZnVuY3Rpb24gcG9pbnRl
ciBwYXJhbWV0ZXJzKQotICAgICMgLSBhdG9taWNfc2V0IChtYWNybykKKyAgICAjIC0gcWF0b21p
Y19zZXQgKG1hY3JvKQogICAgICMgLSBwY2lfbWF0Y2hfZGV2aWNlLCBfX2NvcHlfdG9fdXNlciAo
bG9uZyByZXR1cm4gdHlwZSkKIAogICAgIGlmICgkZGVmaW5lICYmICRwcm90b3R5cGUgPX4gbS9e
KCkoW2EtekEtWjAtOV9+Ol0rKVxzKy8pIHsKZGlmZiAtLWdpdCBhL3RjZy9hYXJjaDY0L3RjZy10
YXJnZXQuYy5pbmMgYi90Y2cvYWFyY2g2NC90Y2ctdGFyZ2V0LmMuaW5jCmluZGV4IDk0OGMzNWQ4
MjUuLjI2MDdmZTRhYjkgMTAwNjQ0Ci0tLSBhL3RjZy9hYXJjaDY0L3RjZy10YXJnZXQuYy5pbmMK
KysrIGIvdGNnL2FhcmNoNjQvdGNnLXRhcmdldC5jLmluYwpAQCAtMTM2NSw3ICsxMzY1LDcgQEAg
dm9pZCB0Yl90YXJnZXRfc2V0X2ptcF90YXJnZXQodWludHB0cl90IHRjX3B0ciwgdWludHB0cl90
IGptcF9hZGRyLAogICAgICAgICBpMiA9IEkzNDAxX0FEREkgfCBydCA8PCAzMSB8IChhZGRyICYg
MHhmZmYpIDw8IDEwIHwgcmQgPDwgNSB8IHJkOwogICAgIH0KICAgICBwYWlyID0gKHVpbnQ2NF90
KWkyIDw8IDMyIHwgaTE7Ci0gICAgYXRvbWljX3NldCgodWludDY0X3QgKilqbXBfYWRkciwgcGFp
cik7CisgICAgcWF0b21pY19zZXQoKHVpbnQ2NF90ICopam1wX2FkZHIsIHBhaXIpOwogICAgIGZs
dXNoX2ljYWNoZV9yYW5nZShqbXBfYWRkciwgam1wX2FkZHIgKyA4KTsKIH0KIApkaWZmIC0tZ2l0
IGEvdGNnL21pcHMvdGNnLXRhcmdldC5jLmluYyBiL3RjZy9taXBzL3RjZy10YXJnZXQuYy5pbmMK
aW5kZXggYmQ1YjhlMDlhMC4uN2FhMjA3MzUyMCAxMDA2NDQKLS0tIGEvdGNnL21pcHMvdGNnLXRh
cmdldC5jLmluYworKysgYi90Y2cvbWlwcy90Y2ctdGFyZ2V0LmMuaW5jCkBAIC0yNjYyLDcgKzI2
NjIsNyBAQCBzdGF0aWMgdm9pZCB0Y2dfdGFyZ2V0X2luaXQoVENHQ29udGV4dCAqcykKIHZvaWQg
dGJfdGFyZ2V0X3NldF9qbXBfdGFyZ2V0KHVpbnRwdHJfdCB0Y19wdHIsIHVpbnRwdHJfdCBqbXBf
YWRkciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnRwdHJfdCBhZGRyKQogewot
ICAgIGF0b21pY19zZXQoKHVpbnQzMl90ICopam1wX2FkZHIsIGRlcG9zaXQzMihPUENfSiwgMCwg
MjYsIGFkZHIgPj4gMikpOworICAgIHFhdG9taWNfc2V0KCh1aW50MzJfdCAqKWptcF9hZGRyLCBk
ZXBvc2l0MzIoT1BDX0osIDAsIDI2LCBhZGRyID4+IDIpKTsKICAgICBmbHVzaF9pY2FjaGVfcmFu
Z2Uoam1wX2FkZHIsIGptcF9hZGRyICsgNCk7CiB9CiAKZGlmZiAtLWdpdCBhL3RjZy9wcGMvdGNn
LXRhcmdldC5jLmluYyBiL3RjZy9wcGMvdGNnLXRhcmdldC5jLmluYwppbmRleCAzOTNjNGIzMGUw
Li43Y2I0MGIwNDY2IDEwMDY0NAotLS0gYS90Y2cvcHBjL3RjZy10YXJnZXQuYy5pbmMKKysrIGIv
dGNnL3BwYy90Y2ctdGFyZ2V0LmMuaW5jCkBAIC0xNzU2LDEzICsxNzU2LDEzIEBAIHZvaWQgdGJf
dGFyZ2V0X3NldF9qbXBfdGFyZ2V0KHVpbnRwdHJfdCB0Y19wdHIsIHVpbnRwdHJfdCBqbXBfYWRk
ciwKICNlbmRpZgogCiAgICAgICAgIC8qIEFzIHBlciB0aGUgZW5jbG9zaW5nIGlmLCB0aGlzIGlz
IHBwYzY0LiAgQXZvaWQgdGhlIF9TdGF0aWNfYXNzZXJ0Ci0gICAgICAgICAgIHdpdGhpbiBhdG9t
aWNfc2V0IHRoYXQgd291bGQgZmFpbCB0byBidWlsZCBhIHBwYzMyIGhvc3QuICAqLwotICAgICAg
ICBhdG9taWNfc2V0X19ub2NoZWNrKCh1aW50NjRfdCAqKWptcF9hZGRyLCBwYWlyKTsKKyAgICAg
ICAgICAgd2l0aGluIHFhdG9taWNfc2V0IHRoYXQgd291bGQgZmFpbCB0byBidWlsZCBhIHBwYzMy
IGhvc3QuICAqLworICAgICAgICBxYXRvbWljX3NldF9fbm9jaGVjaygodWludDY0X3QgKilqbXBf
YWRkciwgcGFpcik7CiAgICAgICAgIGZsdXNoX2ljYWNoZV9yYW5nZShqbXBfYWRkciwgam1wX2Fk
ZHIgKyA4KTsKICAgICB9IGVsc2UgewogICAgICAgICBpbnRwdHJfdCBkaWZmID0gYWRkciAtIGpt
cF9hZGRyOwogICAgICAgICB0Y2dfZGVidWdfYXNzZXJ0KGluX3JhbmdlX2IoZGlmZikpOwotICAg
ICAgICBhdG9taWNfc2V0KCh1aW50MzJfdCAqKWptcF9hZGRyLCBCIHwgKGRpZmYgJiAweDNmZmZm
ZmMpKTsKKyAgICAgICAgcWF0b21pY19zZXQoKHVpbnQzMl90ICopam1wX2FkZHIsIEIgfCAoZGlm
ZiAmIDB4M2ZmZmZmYykpOwogICAgICAgICBmbHVzaF9pY2FjaGVfcmFuZ2Uoam1wX2FkZHIsIGpt
cF9hZGRyICsgNCk7CiAgICAgfQogfQpkaWZmIC0tZ2l0IGEvdGNnL3NwYXJjL3RjZy10YXJnZXQu
Yy5pbmMgYi90Y2cvc3BhcmMvdGNnLXRhcmdldC5jLmluYwppbmRleCAwZjFkOTFmYzIxLi40MGJj
MTIyOTBjIDEwMDY0NAotLS0gYS90Y2cvc3BhcmMvdGNnLXRhcmdldC5jLmluYworKysgYi90Y2cv
c3BhcmMvdGNnLXRhcmdldC5jLmluYwpAQCAtMTgzOSw3ICsxODM5LDggQEAgdm9pZCB0Yl90YXJn
ZXRfc2V0X2ptcF90YXJnZXQodWludHB0cl90IHRjX3B0ciwgdWludHB0cl90IGptcF9hZGRyLAog
ICAgIHRjZ19kZWJ1Z19hc3NlcnQoYnJfZGlzcCA9PSAoaW50MzJfdClicl9kaXNwKTsKIAogICAg
IGlmICghVVNFX1JFR19UQikgewotICAgICAgICBhdG9taWNfc2V0KCh1aW50MzJfdCAqKWptcF9h
ZGRyLCBkZXBvc2l0MzIoQ0FMTCwgMCwgMzAsIGJyX2Rpc3AgPj4gMikpOworICAgICAgICBxYXRv
bWljX3NldCgodWludDMyX3QgKilqbXBfYWRkciwKKwkJICAgIGRlcG9zaXQzMihDQUxMLCAwLCAz
MCwgYnJfZGlzcCA+PiAyKSk7CiAgICAgICAgIGZsdXNoX2ljYWNoZV9yYW5nZShqbXBfYWRkciwg
am1wX2FkZHIgKyA0KTsKICAgICAgICAgcmV0dXJuOwogICAgIH0KQEAgLTE4NjMsNiArMTg2NCw2
IEBAIHZvaWQgdGJfdGFyZ2V0X3NldF9qbXBfdGFyZ2V0KHVpbnRwdHJfdCB0Y19wdHIsIHVpbnRw
dHJfdCBqbXBfYWRkciwKICAgICAgICAgICAgICAgfCBJTlNOX0lNTTEzKCh0Yl9kaXNwICYgMHgz
ZmYpIHwgLTB4NDAwKSk7CiAgICAgfQogCi0gICAgYXRvbWljX3NldCgodWludDY0X3QgKilqbXBf
YWRkciwgZGVwb3NpdDY0KGkyLCAzMiwgMzIsIGkxKSk7CisgICAgcWF0b21pY19zZXQoKHVpbnQ2
NF90ICopam1wX2FkZHIsIGRlcG9zaXQ2NChpMiwgMzIsIDMyLCBpMSkpOwogICAgIGZsdXNoX2lj
YWNoZV9yYW5nZShqbXBfYWRkciwgam1wX2FkZHIgKyA4KTsKIH0KLS0gCjIuMjYuMgoK


