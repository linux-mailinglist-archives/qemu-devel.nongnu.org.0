Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id F41D229F97D
	for <lists+qemu-devel@lfdr.de>; Fri, 30 Oct 2020 01:10:26 +0100 (CET)
Received: from localhost ([::1]:59680 helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>)
	id 1kYHzq-0003U8-29
	for lists+qemu-devel@lfdr.de; Thu, 29 Oct 2020 20:10:22 -0400
Received: from eggs.gnu.org ([2001:470:142:3::10]:37168)
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1kYHov-0008Ej-SW
 for qemu-devel@nongnu.org; Thu, 29 Oct 2020 19:59:05 -0400
Received: from alexa-out-sd-01.qualcomm.com ([199.106.114.38]:45885)
 by eggs.gnu.org with esmtps (TLS1.2:RSA_AES_256_CBC_SHA1:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1kYHoq-0004LV-SR
 for qemu-devel@nongnu.org; Thu, 29 Oct 2020 19:59:05 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
 d=quicinc.com; i=@quicinc.com; q=dns/txt; s=qcdkim;
 t=1604015940; x=1635551940;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version:content-transfer-encoding;
 bh=jN00xw2aTHXDNyYryrjiQBYjV375/c6oxqLUNEftmHc=;
 b=pSigN9rJpnViA68b5l6ij3WTl/ejUWncJmfwxmZRnf+98AdSm1nuMDbz
 qGaYZH01AQbQwRzrzf46sZoy0ILDrgalKNm9cHwnNvzaRPPOfLCc30Dbm
 5gAtqdZSO5HL4fOixWBiGlqFuvj2Rj5sKKrGi65+A+l6BcrbEER2IN1gd E=;
Received: from unknown (HELO ironmsg01-sd.qualcomm.com) ([10.53.140.141])
 by alexa-out-sd-01.qualcomm.com with ESMTP; 29 Oct 2020 16:58:55 -0700
X-QCInternal: smtphost
Received: from vu-tsimpson-aus.qualcomm.com (HELO
 vu-tsimpson1-aus.qualcomm.com) ([10.222.150.1])
 by ironmsg01-sd.qualcomm.com with ESMTP; 29 Oct 2020 16:58:55 -0700
Received: by vu-tsimpson1-aus.qualcomm.com (Postfix, from userid 47164)
 id F12174119; Thu, 29 Oct 2020 18:58:54 -0500 (CDT)
From: Taylor Simpson <tsimpson@quicinc.com>
To: tsimpson@quicinc.com
Subject: [RFC PATCH v5 20/33] Hexagon (target/hexagon) generator phase 2 -
 generate header files
Date: Thu, 29 Oct 2020 18:58:37 -0500
Message-Id: <1604015931-23005-21-git-send-email-tsimpson@quicinc.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1604015931-23005-1-git-send-email-tsimpson@quicinc.com>
References: <1604015931-23005-1-git-send-email-tsimpson@quicinc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Received-SPF: pass client-ip=199.106.114.38;
 envelope-from=tsimpson@qualcomm.com; helo=alexa-out-sd-01.qualcomm.com
X-detected-operating-system: by eggs.gnu.org: First seen = 2020/10/29 19:58:53
X-ACL-Warn: Detected OS   = FreeBSD 9.x or newer [fuzzy]
X-Spam_score_int: -40
X-Spam_score: -4.1
X-Spam_bar: ----
X-Spam_report: (-4.1 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, HEADER_FROM_DIFFERENT_DOMAINS=0.249,
 RCVD_IN_DNSWL_MED=-2.3, SPF_HELO_NONE=0.001,
 SPF_PASS=-0.001 autolearn=ham autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Cc: "open list:All patches CC here" <qemu-devel@nongnu.org>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: "Qemu-devel" <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>

UHl0aG9uIHNjcmlwdHMgZ2VuZXJhdGUgdGhlIGZvbGxvd2luZyBmaWxlcwogICAgaGVscGVyX3By
b3Rvc19nZW5lcmF0ZWQuaAogICAgICAgIEZvciBlYWNoIGluc3RydWN0aW9uIHdlIGNyZWF0ZSBE
RUZfSEVMUEVSIGZ1bmN0aW9uIHByb3RvdHlwZQogICAgaGVscGVyX2Z1bmNzX2dlbmVyYXRlZC5o
CiAgICAgICAgRm9yIGVhY2ggaW5zdHJ1Y3Rpb24gd2UgY3JlYXRlIHRoZSBoZWxwZXIgZnVuY3Rp
b24gZGVmaW5pdGlvbgogICAgdGNnX2Z1bmNzX2dlbmVyYXRlZC5oCiAgICAgICAgRm9yIGVhY2gg
aW5zdHJ1Y3Rpb24gd2UgY3JlYXRlIFRDRyBjb2RlIHRvIGdlbmVyYXRlIGNhbGwgdG8gaGVscGVy
CiAgICB0Y2dfZnVuY190YWJsZV9nZW5lcmF0ZWQuaAogICAgICAgIFRhYmxlIG9mIGZ1bmN0aW9u
IHBvaW50ZXJzIGluZGV4ZWQgYnkgb3Bjb2RlCiAgICBzaG9ydGNvZGVfZ2VuZXJhdGVkLmgKICAg
ICAgICBHZW5lcmF0ZSBhIHRhYmxlIG9mIGluc3RydWN0aW9uICJzaG9ydGNvZGUiIHNlbWFudGlj
cwogICAgb3Bjb2Rlc19kZWZfZ2VuZXJhdGVkLmgKICAgICAgICBHaXZlcyBhIGxpc3Qgb2YgYWxs
IHRoZSBvcGNvZGVzCiAgICBvcF9hdHRyaWJzX2dlbmVyYXRlZC5oCiAgICAgICAgTGlzdHMgYWxs
IHRoZSBhdHRyaWJ1dGVzIGFzc29jaWF0ZWQgd2l0aCBlYWNoIGluc3RydWN0aW9uCiAgICBvcF9y
ZWdzX2dlbmVyYXRlZC5oCiAgICAgICAgTGlzdHMgdGhlIHJlZ2lzdGVyIGFuZCBpbW1lZGlhdGUg
b3BlcmFuZHMgZm9yIGVhY2ggaW5zdHJ1Y3Rpb24KICAgIHByaW50aW5zbl9nZW5lcmF0ZWQuaAog
ICAgICAgIERhdGEgZm9yIHByaW50aW5nIChkaXNhc3NlbWJsaW5nKSBlYWNoIGluc3RydWN0aW9u
IChmb3JtYXQKICAgICAgICBzdHJpbmcgKyBvcGVyYW5kcykKClNpZ25lZC1vZmYtYnk6IFRheWxv
ciBTaW1wc29uIDx0c2ltcHNvbkBxdWljaW5jLmNvbT4KLS0tCiB0YXJnZXQvaGV4YWdvbi9nZW5f
aGVscGVyX2Z1bmNzLnB5ICAgfCAyMjkgKysrKysrKysrKysrKysrCiB0YXJnZXQvaGV4YWdvbi9n
ZW5faGVscGVyX3Byb3Rvcy5weSAgfCAxNTggKysrKysrKysrKwogdGFyZ2V0L2hleGFnb24vZ2Vu
X29wX2F0dHJpYnMucHkgICAgIHwgIDQ2ICsrKwogdGFyZ2V0L2hleGFnb24vZ2VuX29wX3JlZ3Mu
cHkgICAgICAgIHwgMTE5ICsrKysrKysrCiB0YXJnZXQvaGV4YWdvbi9nZW5fb3Bjb2Rlc19kZWYu
cHkgICAgfCAgNDMgKysrCiB0YXJnZXQvaGV4YWdvbi9nZW5fcHJpbnRpbnNuLnB5ICAgICAgfCAx
ODUgKysrKysrKysrKysrCiB0YXJnZXQvaGV4YWdvbi9nZW5fc2hvcnRjb2RlLnB5ICAgICAgfCAg
NzEgKysrKysKIHRhcmdldC9oZXhhZ29uL2dlbl90Y2dfZnVuY190YWJsZS5weSB8ICA2NiArKysr
KwogdGFyZ2V0L2hleGFnb24vZ2VuX3RjZ19mdW5jcy5weSAgICAgIHwgNTM4ICsrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrCiB0YXJnZXQvaGV4YWdvbi9oZXhfY29tbW9uLnB5ICAg
ICAgICAgfCAyMTYgKysrKysrKysrKysrKysKIDEwIGZpbGVzIGNoYW5nZWQsIDE2NzEgaW5zZXJ0
aW9ucygrKQogY3JlYXRlIG1vZGUgMTAwNzU1IHRhcmdldC9oZXhhZ29uL2dlbl9oZWxwZXJfZnVu
Y3MucHkKIGNyZWF0ZSBtb2RlIDEwMDc1NSB0YXJnZXQvaGV4YWdvbi9nZW5faGVscGVyX3Byb3Rv
cy5weQogY3JlYXRlIG1vZGUgMTAwNzU1IHRhcmdldC9oZXhhZ29uL2dlbl9vcF9hdHRyaWJzLnB5
CiBjcmVhdGUgbW9kZSAxMDA3NTUgdGFyZ2V0L2hleGFnb24vZ2VuX29wX3JlZ3MucHkKIGNyZWF0
ZSBtb2RlIDEwMDc1NSB0YXJnZXQvaGV4YWdvbi9nZW5fb3Bjb2Rlc19kZWYucHkKIGNyZWF0ZSBt
b2RlIDEwMDc1NSB0YXJnZXQvaGV4YWdvbi9nZW5fcHJpbnRpbnNuLnB5CiBjcmVhdGUgbW9kZSAx
MDA3NTUgdGFyZ2V0L2hleGFnb24vZ2VuX3Nob3J0Y29kZS5weQogY3JlYXRlIG1vZGUgMTAwNzU1
IHRhcmdldC9oZXhhZ29uL2dlbl90Y2dfZnVuY190YWJsZS5weQogY3JlYXRlIG1vZGUgMTAwNzU1
IHRhcmdldC9oZXhhZ29uL2dlbl90Y2dfZnVuY3MucHkKIGNyZWF0ZSBtb2RlIDEwMDc1NSB0YXJn
ZXQvaGV4YWdvbi9oZXhfY29tbW9uLnB5CgpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vZ2Vu
X2hlbHBlcl9mdW5jcy5weSBiL3RhcmdldC9oZXhhZ29uL2dlbl9oZWxwZXJfZnVuY3MucHkKbmV3
IGZpbGUgbW9kZSAxMDA3NTUKaW5kZXggMDAwMDAwMC4uZjA2ZDlhNAotLS0gL2Rldi9udWxsCisr
KyBiL3RhcmdldC9oZXhhZ29uL2dlbl9oZWxwZXJfZnVuY3MucHkKQEAgLTAsMCArMSwyMjkgQEAK
KyMhL3Vzci9iaW4vZW52IHB5dGhvbjMKKworIyMKKyMjICBDb3B5cmlnaHQoYykgMjAxOS0yMDIw
IFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCisj
IworIyMgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0
ZSBpdCBhbmQvb3IgbW9kaWZ5CisjIyAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2Vu
ZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKKyMjICB0aGUgRnJlZSBTb2Z0d2Fy
ZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvcgorIyMgIChh
dCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisjIworIyMgIFRoaXMgcHJvZ3JhbSBp
cyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorIyMgIGJ1
dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5
IG9mCisjIyAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQ
T1NFLiAgU2VlIHRoZQorIyMgIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRl
dGFpbHMuCisjIworIyMgIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdO
VSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCisjIyAgYWxvbmcgd2l0aCB0aGlzIHByb2dyYW07IGlm
IG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KKyMjCisKK2ltcG9ydCBz
eXMKK2ltcG9ydCByZQoraW1wb3J0IHN0cmluZworZnJvbSBpbyBpbXBvcnQgU3RyaW5nSU8KKwor
ZnJvbSBoZXhfY29tbW9uIGltcG9ydCAqCisKKyMjCisjIyBIZWxwZXJzIGZvciBnZW5faGVscGVy
X2Z1bmN0aW9uCisjIworZGVmIGdlbl9kZWNsX2VhKGYpOgorICAgIGYud3JpdGUoIiAgICB1aW50
MzJfdCBFQTtcbiIpCisKK2RlZiBnZW5faGVscGVyX3JldHVybl90eXBlKGYscmVndHlwZSxyZWdp
ZCxyZWdubyk6CisgICAgaWYgcmVnbm8gPiAxIDogZi53cml0ZSgiLCAiKQorICAgIGYud3JpdGUo
ImludDMyX3QiKQorCitkZWYgZ2VuX2hlbHBlcl9yZXR1cm5fdHlwZV9wYWlyKGYscmVndHlwZSxy
ZWdpZCxyZWdubyk6CisgICAgaWYgcmVnbm8gPiAxIDogZi53cml0ZSgiLCAiKQorICAgIGYud3Jp
dGUoImludDY0X3QiKQorCitkZWYgZ2VuX2hlbHBlcl9hcmcoZixyZWd0eXBlLHJlZ2lkLHJlZ25v
KToKKyAgICBpZiByZWdubyA+IDAgOiBmLndyaXRlKCIsICIgKQorICAgIGYud3JpdGUoImludDMy
X3QgJXMlc1YiICUgKHJlZ3R5cGUscmVnaWQpKQorCitkZWYgZ2VuX2hlbHBlcl9hcmdfbmV3KGYs
cmVndHlwZSxyZWdpZCxyZWdubyk6CisgICAgaWYgcmVnbm8gPj0gMCA6IGYud3JpdGUoIiwgIiAp
CisgICAgZi53cml0ZSgiaW50MzJfdCAlcyVzTiIgJSAocmVndHlwZSxyZWdpZCkpCisKK2RlZiBn
ZW5faGVscGVyX2FyZ19wYWlyKGYscmVndHlwZSxyZWdpZCxyZWdubyk6CisgICAgaWYgcmVnbm8g
Pj0gMCA6IGYud3JpdGUoIiwgIikKKyAgICBmLndyaXRlKCJpbnQ2NF90ICVzJXNWIiAlIChyZWd0
eXBlLHJlZ2lkKSkKKworZGVmIGdlbl9oZWxwZXJfYXJnX29wbihmLHJlZ3R5cGUscmVnaWQsaSx0
YWcpOgorICAgIGlmIChpc19wYWlyKHJlZ2lkKSk6CisgICAgICAgIGdlbl9oZWxwZXJfYXJnX3Bh
aXIoZixyZWd0eXBlLHJlZ2lkLGkpCisgICAgZWxpZiAoaXNfc2luZ2xlKHJlZ2lkKSk6CisgICAg
ICAgIGlmIGlzX29sZF92YWwocmVndHlwZSwgcmVnaWQsIHRhZyk6CisgICAgICAgICAgICBnZW5f
aGVscGVyX2FyZyhmLHJlZ3R5cGUscmVnaWQsaSkKKyAgICAgICAgZWxpZiBpc19uZXdfdmFsKHJl
Z3R5cGUsIHJlZ2lkLCB0YWcpOgorICAgICAgICAgICAgZ2VuX2hlbHBlcl9hcmdfbmV3KGYscmVn
dHlwZSxyZWdpZCxpKQorICAgICAgICBlbHNlOgorICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdp
c3RlciBwYXJzZTogIixyZWd0eXBlLHJlZ2lkLHRvc3MsbnVtcmVncykKKyAgICBlbHNlOgorICAg
ICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLHJlZ3R5cGUscmVnaWQsdG9zcyxudW1y
ZWdzKQorCitkZWYgZ2VuX2hlbHBlcl9hcmdfaW1tKGYsaW1tbGV0dCk6CisgICAgZi53cml0ZSgi
LCBpbnQzMl90ICVzIiAlIChpbW1fbmFtZShpbW1sZXR0KSkpCisKK2RlZiBnZW5faGVscGVyX2Rl
c3RfZGVjbChmLHJlZ3R5cGUscmVnaWQscmVnbm8sc3ViZmllbGQ9IiIpOgorICAgIGYud3JpdGUo
IiAgICBpbnQzMl90ICVzJXNWJXMgPSAwO1xuIiAlIFwKKyAgICAgICAgKHJlZ3R5cGUscmVnaWQs
c3ViZmllbGQpKQorCitkZWYgZ2VuX2hlbHBlcl9kZXN0X2RlY2xfcGFpcihmLHJlZ3R5cGUscmVn
aWQscmVnbm8sc3ViZmllbGQ9IiIpOgorICAgIGYud3JpdGUoIiAgICBpbnQ2NF90ICVzJXNWJXMg
PSAwO1xuIiAlIFwKKyAgICAgICAgKHJlZ3R5cGUscmVnaWQsc3ViZmllbGQpKQorCitkZWYgZ2Vu
X2hlbHBlcl9kZXN0X2RlY2xfb3BuKGYscmVndHlwZSxyZWdpZCxpKToKKyAgICBpZiAoaXNfcGFp
cihyZWdpZCkpOgorICAgICAgICBnZW5faGVscGVyX2Rlc3RfZGVjbF9wYWlyKGYscmVndHlwZSxy
ZWdpZCxpKQorICAgIGVsaWYgKGlzX3NpbmdsZShyZWdpZCkpOgorICAgICAgICBnZW5faGVscGVy
X2Rlc3RfZGVjbChmLHJlZ3R5cGUscmVnaWQsaSkKKyAgICBlbHNlOgorICAgICAgICBwcmludCgi
QmFkIHJlZ2lzdGVyIHBhcnNlOiAiLHJlZ3R5cGUscmVnaWQsdG9zcyxudW1yZWdzKQorCitkZWYg
Z2VuX2hlbHBlcl9yZXR1cm4oZixyZWd0eXBlLHJlZ2lkLHJlZ25vKToKKyAgICBmLndyaXRlKCIg
ICAgcmV0dXJuICVzJXNWO1xuIiAlIChyZWd0eXBlLHJlZ2lkKSkKKworZGVmIGdlbl9oZWxwZXJf
cmV0dXJuX3BhaXIoZixyZWd0eXBlLHJlZ2lkLHJlZ25vKToKKyAgICBmLndyaXRlKCIgICAgcmV0
dXJuICVzJXNWO1xuIiAlIChyZWd0eXBlLHJlZ2lkKSkKKworZGVmIGdlbl9oZWxwZXJfcmV0dXJu
X29wbihmLCByZWd0eXBlLCByZWdpZCwgaSk6CisgICAgaWYgKGlzX3BhaXIocmVnaWQpKToKKyAg
ICAgICAgZ2VuX2hlbHBlcl9yZXR1cm5fcGFpcihmLHJlZ3R5cGUscmVnaWQsaSkKKyAgICBlbGlm
IChpc19zaW5nbGUocmVnaWQpKToKKyAgICAgICAgZ2VuX2hlbHBlcl9yZXR1cm4oZixyZWd0eXBl
LHJlZ2lkLGkpCisgICAgZWxzZToKKyAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTog
IixyZWd0eXBlLHJlZ2lkLHRvc3MsbnVtcmVncykKKworIyMKKyMjIEdlbmVyYXRlIHRoZSBUQ0cg
Y29kZSB0byBjYWxsIHRoZSBoZWxwZXIKKyMjICAgICBGb3IgQTJfYWRkOiBSZDMyPWFkZChSczMy
LFJ0MzIpLCB7IFJkVj1Sc1YrUnRWO30KKyMjICAgICBXZSBwcm9kdWNlOgorIyMgICAgICAgaW50
MzJfdCBIRUxQRVIoQTJfYWRkKShDUFVIZXhhZ29uU3RhdGUgKmVudiwgaW50MzJfdCBSc1YsIGlu
dDMyX3QgUnRWKQorIyMgICAgICAgeworIyMgICAgICAgICAgIHVpbnQzMl90IHNsb3QgX19hdHRy
aWJ1dGVfXyh1bnVzZWQpKSA9IDQ7CisjIyAgICAgICAgICAgaW50MzJfdCBSZFYgPSAwOworIyMg
ICAgICAgICAgIHsgUmRWPVJzVitSdFY7fQorIyMgICAgICAgICAgIENPVU5UX0hFTFBFUihBMl9h
ZGQpOworIyMgICAgICAgICAgIHJldHVybiBSZFY7CisjIyAgICAgICB9CisjIworZGVmIGdlbl9o
ZWxwZXJfZnVuY3Rpb24oZiwgdGFnLCB0YWdyZWdzLCB0YWdpbW1zKToKKyAgICByZWdzID0gdGFn
cmVnc1t0YWddCisgICAgaW1tcyA9IHRhZ2ltbXNbdGFnXQorCisgICAgbnVtcmVzdWx0cyA9IDAK
KyAgICBudW1zY2FsYXJyZXN1bHRzID0gMAorICAgIG51bXNjYWxhcnJlYWR3cml0ZSA9IDAKKyAg
ICBmb3IgcmVndHlwZSxyZWdpZCx0b3NzLG51bXJlZ3MgaW4gcmVnczoKKyAgICAgICAgaWYgKGlz
X3dyaXR0ZW4ocmVnaWQpKToKKyAgICAgICAgICAgIG51bXJlc3VsdHMgKz0gMQorICAgICAgICAg
ICAgaWYgKGlzX3NjYWxhcl9yZWcocmVndHlwZSkpOgorICAgICAgICAgICAgICAgIG51bXNjYWxh
cnJlc3VsdHMgKz0gMQorICAgICAgICBpZiAoaXNfcmVhZHdyaXRlKHJlZ2lkKSk6CisgICAgICAg
ICAgICBpZiAoaXNfc2NhbGFyX3JlZyhyZWd0eXBlKSk6CisgICAgICAgICAgICAgICAgbnVtc2Nh
bGFycmVhZHdyaXRlICs9IDEKKworICAgIGlmIChudW1zY2FsYXJyZXN1bHRzID4gMSk6CisgICAg
ICAgICMjIFRoZSBoZWxwZXIgaXMgYm9ndXMgd2hlbiB0aGVyZSBpcyBtb3JlIHRoYW4gb25lIHJl
c3VsdAorICAgICAgICBmLndyaXRlKCJ2b2lkIEhFTFBFUiglcykoQ1BVSGV4YWdvblN0YXRlICpl
bnYpIHsgQk9HVVNfSEVMUEVSKCVzKTsgfVxuIgorICAgICAgICAgICAgICAgICUgKHRhZywgdGFn
KSkKKyAgICBlbHNlOgorICAgICAgICAjIyBUaGUgcmV0dXJuIHR5cGUgb2YgdGhlIGZ1bmN0aW9u
IGlzIHRoZSB0eXBlIG9mIHRoZSBkZXN0aW5hdGlvbgorICAgICAgICAjIyByZWdpc3RlcgorICAg
ICAgICBpPTAKKyAgICAgICAgZm9yIHJlZ3R5cGUscmVnaWQsdG9zcyxudW1yZWdzIGluIHJlZ3M6
CisgICAgICAgICAgICBpZiAoaXNfd3JpdHRlbihyZWdpZCkpOgorICAgICAgICAgICAgICAgIGlm
IChpc19wYWlyKHJlZ2lkKSk6CisgICAgICAgICAgICAgICAgICAgIGdlbl9oZWxwZXJfcmV0dXJu
X3R5cGVfcGFpcihmLHJlZ3R5cGUscmVnaWQsaSkKKyAgICAgICAgICAgICAgICBlbGlmIChpc19z
aW5nbGUocmVnaWQpKToKKyAgICAgICAgICAgICAgICAgICAgZ2VuX2hlbHBlcl9yZXR1cm5fdHlw
ZShmLHJlZ3R5cGUscmVnaWQsaSkKKyAgICAgICAgICAgICAgICBlbHNlOgorICAgICAgICAgICAg
ICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLHJlZ3R5cGUscmVnaWQsdG9zcyxu
dW1yZWdzKQorICAgICAgICAgICAgaSArPSAxCisKKyAgICAgICAgaWYgKG51bXNjYWxhcnJlc3Vs
dHMgPT0gMCk6CisgICAgICAgICAgICBmLndyaXRlKCJ2b2lkIikKKyAgICAgICAgZi53cml0ZSgi
IEhFTFBFUiglcykoQ1BVSGV4YWdvblN0YXRlICplbnYiICUgdGFnKQorCisgICAgICAgIGkgPSAx
CisKKyAgICAgICAgIyMgQXJndW1lbnRzIHRvIHRoZSBoZWxwZXIgZnVuY3Rpb24gYXJlIHRoZSBz
b3VyY2UgcmVncyBhbmQgaW1tZWRpYXRlcworICAgICAgICBmb3IgcmVndHlwZSxyZWdpZCx0b3Nz
LG51bXJlZ3MgaW4gcmVnczoKKyAgICAgICAgICAgIGlmIChpc19yZWFkKHJlZ2lkKSk6CisgICAg
ICAgICAgICAgICAgZ2VuX2hlbHBlcl9hcmdfb3BuKGYscmVndHlwZSxyZWdpZCxpLHRhZykKKyAg
ICAgICAgICAgICAgICBpICs9IDEKKyAgICAgICAgZm9yIGltbWxldHQsYml0cyxpbW1zaGlmdCBp
biBpbW1zOgorICAgICAgICAgICAgZ2VuX2hlbHBlcl9hcmdfaW1tKGYsaW1tbGV0dCkKKyAgICAg
ICAgICAgIGkgKz0gMQorICAgICAgICBpZiBuZWVkX3Nsb3QodGFnKToKKyAgICAgICAgICAgIGlm
IGkgPiAwOiBmLndyaXRlKCIsICIpCisgICAgICAgICAgICBmLndyaXRlKCJ1aW50MzJfdCBzbG90
IikKKyAgICAgICAgICAgIGkgKz0gMQorICAgICAgICBpZiBuZWVkX3BhcnQxKHRhZyk6CisgICAg
ICAgICAgICBpZiBpID4gMDogZi53cml0ZSgiLCAiKQorICAgICAgICAgICAgZi53cml0ZSgidWlu
dDMyX3QgcGFydDEiKQorICAgICAgICBmLndyaXRlKCIpXG57XG4iKQorICAgICAgICBpZiAobm90
IG5lZWRfc2xvdCh0YWcpKToKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICB1aW50MzJfdCBzbG90
IF9fYXR0cmlidXRlX18oKHVudXNlZCkpID0gNDtcbiIgKQorICAgICAgICBpZiBuZWVkX2VhKHRh
Zyk6IGdlbl9kZWNsX2VhKGYpCisgICAgICAgICMjIERlY2xhcmUgdGhlIHJldHVybiB2YXJpYWJs
ZQorICAgICAgICBpPTAKKyAgICAgICAgZm9yIHJlZ3R5cGUscmVnaWQsdG9zcyxudW1yZWdzIGlu
IHJlZ3M6CisgICAgICAgICAgICBpZiAoaXNfd3JpdGVvbmx5KHJlZ2lkKSk6CisgICAgICAgICAg
ICAgICAgZ2VuX2hlbHBlcl9kZXN0X2RlY2xfb3BuKGYscmVndHlwZSxyZWdpZCxpKQorICAgICAg
ICAgICAgaSArPSAxCisKKyAgICAgICAgaWYgJ0FfRlBPUCcgaW4gYXR0cmliZGljdFt0YWddOgor
ICAgICAgICAgICAgZi53cml0ZSgnICAgIGFyY2hfZnBvcF9zdGFydChlbnYpO1xuJyk7CisKKyAg
ICAgICAgZi53cml0ZSgiICAgICVzXG4iICUgc2VtZGljdFt0YWddKQorCisgICAgICAgIGlmICdB
X0ZQT1AnIGluIGF0dHJpYmRpY3RbdGFnXToKKyAgICAgICAgICAgIGYud3JpdGUoJyAgICBhcmNo
X2Zwb3BfZW5kKGVudik7XG4nKTsKKworICAgICAgICAjIyBTYXZlL3JldHVybiB0aGUgcmV0dXJu
IHZhcmlhYmxlCisgICAgICAgIGZvciByZWd0eXBlLHJlZ2lkLHRvc3MsbnVtcmVncyBpbiByZWdz
OgorICAgICAgICAgICAgaWYgKGlzX3dyaXR0ZW4ocmVnaWQpKToKKyAgICAgICAgICAgICAgICBn
ZW5faGVscGVyX3JldHVybl9vcG4oZiwgcmVndHlwZSwgcmVnaWQsIGkpCisgICAgICAgIGYud3Jp
dGUoIn1cblxuIikKKyAgICAgICAgIyMgRW5kIG9mIHRoZSBoZWxwZXIgZGVmaW5pdGlvbgorCitk
ZWYgbWFpbigpOgorICAgIHJlYWRfc2VtYW50aWNzX2ZpbGUoc3lzLmFyZ3ZbMV0pCisgICAgcmVh
ZF9hdHRyaWJzX2ZpbGUoc3lzLmFyZ3ZbMl0pCisgICAgcmVhZF9vdmVycmlkZXNfZmlsZShzeXMu
YXJndlszXSkKKyAgICBjYWxjdWxhdGVfYXR0cmlicygpCisgICAgdGFncmVncyA9IGdldF90YWdy
ZWdzKCkKKyAgICB0YWdpbW1zID0gZ2V0X3RhZ2ltbXMoKQorCisgICAgZiA9IFN0cmluZ0lPKCkK
KworICAgIGZvciB0YWcgaW4gdGFnczoKKyAgICAgICAgIyMgU2tpcCB0aGUgcHJpdiBpbnN0cnVj
dGlvbnMKKyAgICAgICAgaWYgKCAiQV9QUklWIiBpbiBhdHRyaWJkaWN0W3RhZ10gKSA6CisgICAg
ICAgICAgICBjb250aW51ZQorICAgICAgICAjIyBTa2lwIHRoZSBndWVzdCBpbnN0cnVjdGlvbnMK
KyAgICAgICAgaWYgKCAiQV9HVUVTVCIgaW4gYXR0cmliZGljdFt0YWddICkgOgorICAgICAgICAg
ICAgY29udGludWUKKyAgICAgICAgIyMgU2tpcCB0aGUgZGlhZyBpbnN0cnVjdGlvbnMKKyAgICAg
ICAgaWYgKCB0YWcgPT0gIlk2X2RpYWciICkgOgorICAgICAgICAgICAgY29udGludWUKKyAgICAg
ICAgaWYgKCB0YWcgPT0gIlk2X2RpYWcwIiApIDoKKyAgICAgICAgICAgIGNvbnRpbnVlCisgICAg
ICAgIGlmICggdGFnID09ICJZNl9kaWFnMSIgKSA6CisgICAgICAgICAgICBjb250aW51ZQorICAg
ICAgICBpZiAoIHNraXBfcWVtdV9oZWxwZXIodGFnKSApOgorICAgICAgICAgICAgY29udGludWUK
KworICAgICAgICBnZW5faGVscGVyX2Z1bmN0aW9uKGYsIHRhZywgdGFncmVncywgdGFnaW1tcykK
KworCisgICAgcmVhbGYgPSBvcGVuKHN5cy5hcmd2WzRdLCAndycpCisgICAgcmVhbGYud3JpdGUo
Zi5nZXR2YWx1ZSgpKQorICAgIHJlYWxmLmNsb3NlKCkKKyAgICBmLmNsb3NlKCkKKworaWYgX19u
YW1lX18gPT0gIl9fbWFpbl9fIjoKKyAgICBtYWluKCkKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhh
Z29uL2dlbl9oZWxwZXJfcHJvdG9zLnB5IGIvdGFyZ2V0L2hleGFnb24vZ2VuX2hlbHBlcl9wcm90
b3MucHkKbmV3IGZpbGUgbW9kZSAxMDA3NTUKaW5kZXggMDAwMDAwMC4uNDBlMDBlNwotLS0gL2Rl
di9udWxsCisrKyBiL3RhcmdldC9oZXhhZ29uL2dlbl9oZWxwZXJfcHJvdG9zLnB5CkBAIC0wLDAg
KzEsMTU4IEBACisjIS91c3IvYmluL2VudiBweXRob24zCisKKyMjCisjIyAgQ29weXJpZ2h0KGMp
IDIwMTktMjAyMCBRdWFsY29tbSBJbm5vdmF0aW9uIENlbnRlciwgSW5jLiBBbGwgUmlnaHRzIFJl
c2VydmVkLgorIyMKKyMjICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiBy
ZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQorIyMgIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0
aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5CisjIyAgdGhlIEZy
ZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwg
b3IKKyMjICAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorIyMKKyMjICBUaGlz
IHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1
bCwKKyMjICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGll
ZCB3YXJyYW50eSBvZgorIyMgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJ
Q1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKKyMjICBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBm
b3IgbW9yZSBkZXRhaWxzLgorIyMKKyMjICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5
IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQorIyMgIGFsb25nIHdpdGggdGhpcyBw
cm9ncmFtOyBpZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCisjIwor
CitpbXBvcnQgc3lzCitpbXBvcnQgcmUKK2ltcG9ydCBzdHJpbmcKK2Zyb20gaW8gaW1wb3J0IFN0
cmluZ0lPCisKK2Zyb20gaGV4X2NvbW1vbiBpbXBvcnQgKgorCisjIworIyMgSGVscGVycyBmb3Ig
Z2VuX2hlbHBlcl9wcm90b3R5cGUKKyMjCitkZWZfaGVscGVyX3R5cGVzID0geworICAgICdOJyA6
ICdzMzInLAorICAgICdPJyA6ICdzMzInLAorICAgICdQJyA6ICdzMzInLAorICAgICdNJyA6ICdz
MzInLAorICAgICdDJyA6ICdzMzInLAorICAgICdSJyA6ICdzMzInLAorICAgICdWJyA6ICdwdHIn
LAorICAgICdRJyA6ICdwdHInCit9CisKK2RlZl9oZWxwZXJfdHlwZXNfcGFpciA9IHsKKyAgICAn
UicgOiAnczY0JywKKyAgICAnQycgOiAnczY0JywKKyAgICAnUycgOiAnczY0JywKKyAgICAnRycg
OiAnczY0JywKKyAgICAnVicgOiAncHRyJywKKyAgICAnUScgOiAncHRyJworfQorCitkZWYgZ2Vu
X2RlZl9oZWxwZXJfb3BuKGYsIHRhZywgcmVndHlwZSwgcmVnaWQsIHRvc3MsIG51bXJlZ3MsIGkp
OgorICAgIGlmIChpc19wYWlyKHJlZ2lkKSk6CisgICAgICAgIGYud3JpdGUoIiwgJXMiICUgKGRl
Zl9oZWxwZXJfdHlwZXNfcGFpcltyZWd0eXBlXSkpCisgICAgZWxpZiAoaXNfc2luZ2xlKHJlZ2lk
KSk6CisgICAgICAgIGYud3JpdGUoIiwgJXMiICUgKGRlZl9oZWxwZXJfdHlwZXNbcmVndHlwZV0p
KQorICAgIGVsc2U6CisgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIscmVndHlw
ZSxyZWdpZCx0b3NzLG51bXJlZ3MpCisKKyMjCisjIyBHZW5lcmF0ZSB0aGUgREVGX0hFTFBFUiBw
cm90b3R5cGUgZm9yIGFuIGluc3RydWN0aW9uCisjIyAgICAgRm9yIEEyX2FkZDogUmQzMj1hZGQo
UnMzMixSdDMyKQorIyMgICAgIFdlIHByb2R1Y2U6CisjIyAgICAgICAgIERFRl9IRUxQRVJfMyhB
Ml9hZGQsIHMzMiwgZW52LCBzMzIsIHMzMikKKyMjCitkZWYgZ2VuX2hlbHBlcl9wcm90b3R5cGUo
ZiwgdGFnLCB0YWdyZWdzLCB0YWdpbW1zKToKKyAgICByZWdzID0gdGFncmVnc1t0YWddCisgICAg
aW1tcyA9IHRhZ2ltbXNbdGFnXQorCisgICAgbnVtcmVzdWx0cyA9IDAKKyAgICBudW1zY2FsYXJy
ZXN1bHRzID0gMAorICAgIG51bXNjYWxhcnJlYWR3cml0ZSA9IDAKKyAgICBmb3IgcmVndHlwZSxy
ZWdpZCx0b3NzLG51bXJlZ3MgaW4gcmVnczoKKyAgICAgICAgaWYgKGlzX3dyaXR0ZW4ocmVnaWQp
KToKKyAgICAgICAgICAgIG51bXJlc3VsdHMgKz0gMQorICAgICAgICAgICAgaWYgKGlzX3NjYWxh
cl9yZWcocmVndHlwZSkpOgorICAgICAgICAgICAgICAgIG51bXNjYWxhcnJlc3VsdHMgKz0gMQor
ICAgICAgICBpZiAoaXNfcmVhZHdyaXRlKHJlZ2lkKSk6CisgICAgICAgICAgICBpZiAoaXNfc2Nh
bGFyX3JlZyhyZWd0eXBlKSk6CisgICAgICAgICAgICAgICAgbnVtc2NhbGFycmVhZHdyaXRlICs9
IDEKKworICAgIGlmIChudW1zY2FsYXJyZXN1bHRzID4gMSk6CisgICAgICAgICMjIFRoZSBoZWxw
ZXIgaXMgYm9ndXMgd2hlbiB0aGVyZSBpcyBtb3JlIHRoYW4gb25lIHJlc3VsdAorICAgICAgICBm
LndyaXRlKCdERUZfSEVMUEVSXzEoJXMsIHZvaWQsIGVudilcbicgJSB0YWcpCisgICAgZWxzZToK
KyAgICAgICAgIyMgRmlndXJlIG91dCBob3cgbWFueSBhcmd1bWVudHMgdGhlIGhlbHBlciB3aWxs
IHRha2UKKyAgICAgICAgaWYgKG51bXNjYWxhcnJlc3VsdHMgPT0gMCk6CisgICAgICAgICAgICBk
ZWZfaGVscGVyX3NpemUgPSBsZW4ocmVncykrbGVuKGltbXMpK251bXNjYWxhcnJlYWR3cml0ZSsx
CisgICAgICAgICAgICBpZiBuZWVkX3BhcnQxKHRhZyk6IGRlZl9oZWxwZXJfc2l6ZSArPSAxCisg
ICAgICAgICAgICBpZiBuZWVkX3Nsb3QodGFnKTogZGVmX2hlbHBlcl9zaXplICs9IDEKKyAgICAg
ICAgICAgIGYud3JpdGUoJ0RFRl9IRUxQRVJfJXMoJXMnICUgKGRlZl9oZWxwZXJfc2l6ZSwgdGFn
KSkKKyAgICAgICAgICAgICMjIFRoZSByZXR1cm4gdHlwZSBpcyB2b2lkCisgICAgICAgICAgICBm
LndyaXRlKCcsIHZvaWQnICkKKyAgICAgICAgZWxzZToKKyAgICAgICAgICAgIGRlZl9oZWxwZXJf
c2l6ZSA9IGxlbihyZWdzKStsZW4oaW1tcykrbnVtc2NhbGFycmVhZHdyaXRlCisgICAgICAgICAg
ICBpZiBuZWVkX3BhcnQxKHRhZyk6IGRlZl9oZWxwZXJfc2l6ZSArPSAxCisgICAgICAgICAgICBp
ZiBuZWVkX3Nsb3QodGFnKTogZGVmX2hlbHBlcl9zaXplICs9IDEKKyAgICAgICAgICAgIGYud3Jp
dGUoJ0RFRl9IRUxQRVJfJXMoJXMnICUgKGRlZl9oZWxwZXJfc2l6ZSwgdGFnKSkKKworICAgICAg
ICAjIyBHZW5lcmF0ZSB0aGUgcWVtdSBERUZfSEVMUEVSIHR5cGUgZm9yIGVhY2ggcmVzdWx0Cisg
ICAgICAgIGk9MAorICAgICAgICBmb3IgcmVndHlwZSxyZWdpZCx0b3NzLG51bXJlZ3MgaW4gcmVn
czoKKyAgICAgICAgICAgIGlmIChpc193cml0dGVuKHJlZ2lkKSk6CisgICAgICAgICAgICAgICAg
Z2VuX2RlZl9oZWxwZXJfb3BuKGYsIHRhZywgcmVndHlwZSwgcmVnaWQsIHRvc3MsIG51bXJlZ3Ms
IGkpCisgICAgICAgICAgICAgICAgaSArPSAxCisKKyAgICAgICAgIyMgUHV0IHRoZSBlbnYgYmV0
d2VlbiB0aGUgb3V0cHV0cyBhbmQgaW5wdXRzCisgICAgICAgIGYud3JpdGUoJywgZW52JyApCisg
ICAgICAgIGkgKz0gMQorCisgICAgICAgICMjIEdlbmVyYXRlIHRoZSBxZW11IHR5cGUgZm9yIGVh
Y2ggaW5wdXQgb3BlcmFuZCAocmVncyBhbmQgaW1tZWRpYXRlcykKKyAgICAgICAgZm9yIHJlZ3R5
cGUscmVnaWQsdG9zcyxudW1yZWdzIGluIHJlZ3M6CisgICAgICAgICAgICBpZiAoaXNfcmVhZChy
ZWdpZCkpOgorICAgICAgICAgICAgICAgIGdlbl9kZWZfaGVscGVyX29wbihmLCB0YWcsIHJlZ3R5
cGUsIHJlZ2lkLCB0b3NzLCBudW1yZWdzLCBpKQorICAgICAgICAgICAgICAgIGkgKz0gMQorICAg
ICAgICBmb3IgaW1tbGV0dCxiaXRzLGltbXNoaWZ0IGluIGltbXM6CisgICAgICAgICAgICBmLndy
aXRlKCIsIHMzMiIpCisKKyAgICAgICAgIyMgQWRkIHRoZSBhcmd1bWVudHMgZm9yIHRoZSBpbnN0
cnVjdGlvbiBzbG90IGFuZCBwYXJ0MSAoaWYgbmVlZGVkKQorICAgICAgICBpZiBuZWVkX3Nsb3Qo
dGFnKTogZi53cml0ZSgnLCBpMzInICkKKyAgICAgICAgaWYgbmVlZF9wYXJ0MSh0YWcpOiBmLndy
aXRlKCcgLCBpMzInICkKKyAgICAgICAgZi53cml0ZSgnKVxuJykKKworZGVmIG1haW4oKToKKyAg
ICByZWFkX3NlbWFudGljc19maWxlKHN5cy5hcmd2WzFdKQorICAgIHJlYWRfYXR0cmlic19maWxl
KHN5cy5hcmd2WzJdKQorICAgIHJlYWRfb3ZlcnJpZGVzX2ZpbGUoc3lzLmFyZ3ZbM10pCisgICAg
Y2FsY3VsYXRlX2F0dHJpYnMoKQorICAgIHRhZ3JlZ3MgPSBnZXRfdGFncmVncygpCisgICAgdGFn
aW1tcyA9IGdldF90YWdpbW1zKCkKKworICAgIGYgPSBTdHJpbmdJTygpCisKKyAgICBmb3IgdGFn
IGluIHRhZ3M6CisgICAgICAgICMjIFNraXAgdGhlIHByaXYgaW5zdHJ1Y3Rpb25zCisgICAgICAg
IGlmICggIkFfUFJJViIgaW4gYXR0cmliZGljdFt0YWddICkgOgorICAgICAgICAgICAgY29udGlu
dWUKKyAgICAgICAgIyMgU2tpcCB0aGUgZ3Vlc3QgaW5zdHJ1Y3Rpb25zCisgICAgICAgIGlmICgg
IkFfR1VFU1QiIGluIGF0dHJpYmRpY3RbdGFnXSApIDoKKyAgICAgICAgICAgIGNvbnRpbnVlCisg
ICAgICAgICMjIFNraXAgdGhlIGRpYWcgaW5zdHJ1Y3Rpb25zCisgICAgICAgIGlmICggdGFnID09
ICJZNl9kaWFnIiApIDoKKyAgICAgICAgICAgIGNvbnRpbnVlCisgICAgICAgIGlmICggdGFnID09
ICJZNl9kaWFnMCIgKSA6CisgICAgICAgICAgICBjb250aW51ZQorICAgICAgICBpZiAoIHRhZyA9
PSAiWTZfZGlhZzEiICkgOgorICAgICAgICAgICAgY29udGludWUKKworICAgICAgICBpZiAoIHNr
aXBfcWVtdV9oZWxwZXIodGFnKSApOgorICAgICAgICAgICAgY29udGludWUKKworICAgICAgICBn
ZW5faGVscGVyX3Byb3RvdHlwZShmLCB0YWcsIHRhZ3JlZ3MsIHRhZ2ltbXMpCisKKyAgICByZWFs
ZiA9IG9wZW4oc3lzLmFyZ3ZbNF0sICd3JykKKyAgICByZWFsZi53cml0ZShmLmdldHZhbHVlKCkp
CisgICAgcmVhbGYuY2xvc2UoKQorICAgIGYuY2xvc2UoKQorCitpZiBfX25hbWVfXyA9PSAiX19t
YWluX18iOgorICAgIG1haW4oKQpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vZ2VuX29wX2F0
dHJpYnMucHkgYi90YXJnZXQvaGV4YWdvbi9nZW5fb3BfYXR0cmlicy5weQpuZXcgZmlsZSBtb2Rl
IDEwMDc1NQppbmRleCAwMDAwMDAwLi5hZWYzZjE5Ci0tLSAvZGV2L251bGwKKysrIGIvdGFyZ2V0
L2hleGFnb24vZ2VuX29wX2F0dHJpYnMucHkKQEAgLTAsMCArMSw0NiBAQAorIyEvdXNyL2Jpbi9l
bnYgcHl0aG9uMworCisjIworIyMgIENvcHlyaWdodChjKSAyMDE5LTIwMjAgUXVhbGNvbW0gSW5u
b3ZhdGlvbiBDZW50ZXIsIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KKyMjCisjIyAgVGhpcyBw
cm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBt
b2RpZnkKKyMjICBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBM
aWNlbnNlIGFzIHB1Ymxpc2hlZCBieQorIyMgIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247
IGVpdGhlciB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yCisjIyAgKGF0IHlvdXIgb3B0aW9u
KSBhbnkgbGF0ZXIgdmVyc2lvbi4KKyMjCisjIyAgVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVk
IGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisjIyAgYnV0IFdJVEhPVVQgQU5Z
IFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyMjICBNRVJD
SEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhl
CisjIyAgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKyMjCisj
IyAgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVi
bGljIExpY2Vuc2UKKyMjICBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbTsgaWYgbm90LCBzZWUgPGh0
dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgorIyMKKworaW1wb3J0IHN5cworaW1wb3J0IHJl
CitpbXBvcnQgc3RyaW5nCitmcm9tIGlvIGltcG9ydCBTdHJpbmdJTworCitmcm9tIGhleF9jb21t
b24gaW1wb3J0ICoKKworZGVmIG1haW4oKToKKyAgICByZWFkX3NlbWFudGljc19maWxlKHN5cy5h
cmd2WzFdKQorICAgIHJlYWRfYXR0cmlic19maWxlKHN5cy5hcmd2WzJdKQorICAgIGNhbGN1bGF0
ZV9hdHRyaWJzKCkKKworICAgICMjCisgICAgIyMgR2VuZXJhdGUgdGhlIG9wX2F0dHJpYnNfZ2Vu
ZXJhdGVkLmggZmlsZQorICAgICMjICAgICBMaXN0cyBhbGwgdGhlIGF0dHJpYnV0ZXMgYXNzb2Np
YXRlZCB3aXRoIGVhY2ggaW5zdHJ1Y3Rpb24KKyAgICAjIworICAgIGYgPSBTdHJpbmdJTygpCisg
ICAgZm9yIHRhZyBpbiB0YWdzOgorICAgICAgICBmLndyaXRlKCdPUF9BVFRSSUIoJXMsQVRUUklC
UyglcykpXG4nICUgXAorICAgICAgICAgICAgKHRhZywgJywnLmpvaW4oc29ydGVkKGF0dHJpYmRp
Y3RbdGFnXSkpKSkKKyAgICByZWFsZiA9IG9wZW4oc3lzLmFyZ3ZbM10sICd3dCcpCisgICAgcmVh
bGYud3JpdGUoZi5nZXR2YWx1ZSgpKQorICAgIHJlYWxmLmNsb3NlKCkKKyAgICBmLmNsb3NlKCkK
KworaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKKyAgICBtYWluKCkKZGlmZiAtLWdpdCBhL3Rh
cmdldC9oZXhhZ29uL2dlbl9vcF9yZWdzLnB5IGIvdGFyZ2V0L2hleGFnb24vZ2VuX29wX3JlZ3Mu
cHkKbmV3IGZpbGUgbW9kZSAxMDA3NTUKaW5kZXggMDAwMDAwMC4uMGNlM2RkZgotLS0gL2Rldi9u
dWxsCisrKyBiL3RhcmdldC9oZXhhZ29uL2dlbl9vcF9yZWdzLnB5CkBAIC0wLDAgKzEsMTE5IEBA
CisjIS91c3IvYmluL2VudiBweXRob24zCisKKyMjCisjIyAgQ29weXJpZ2h0KGMpIDIwMTktMjAy
MCBRdWFsY29tbSBJbm5vdmF0aW9uIENlbnRlciwgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLgor
IyMKKyMjICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1
dGUgaXQgYW5kL29yIG1vZGlmeQorIyMgIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdl
bmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5CisjIyAgdGhlIEZyZWUgU29mdHdh
cmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IKKyMjICAo
YXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorIyMKKyMjICBUaGlzIHByb2dyYW0g
aXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyMjICBi
dXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50
eSBvZgorIyMgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVS
UE9TRS4gIFNlZSB0aGUKKyMjICBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBk
ZXRhaWxzLgorIyMKKyMjICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBH
TlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQorIyMgIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtOyBp
ZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCisjIworCitpbXBvcnQg
c3lzCitpbXBvcnQgcmUKK2ltcG9ydCBzdHJpbmcKK2Zyb20gaW8gaW1wb3J0IFN0cmluZ0lPCisK
K2Zyb20gaGV4X2NvbW1vbiBpbXBvcnQgKgorCisjIworIyMgR2VuZXJhdGUgdGhlIG9wX3JlZ3Nf
Z2VuZXJhdGVkLmggZmlsZQorIyMgICAgIExpc3RzIHRoZSByZWdpc3RlciBhbmQgaW1tZWRpYXRl
IG9wZXJhbmRzIGZvciBlYWNoIGluc3RydWN0aW9uCisjIworZGVmIGNhbGN1bGF0ZV9yZWdpZF9y
ZWcodGFnKToKKyAgICBkZWYgbGV0dGVyX2luYyh4KTogcmV0dXJuIGNocihvcmQoeCkrMSkKKyAg
ICBvcmRlcmVkX2ltcGxyZWdzID0gWyAnU1AnLCdGUCcsJ0xSJyBdCisgICAgc3JjZHN0X2xldHQg
PSAnWCcKKyAgICBzcmNfbGV0dCA9ICdTJworICAgIGRzdF9sZXR0ID0gJ0QnCisgICAgcmV0c3Ry
ID0gIiIKKyAgICBtYXBkaWN0ID0ge30KKyAgICBmb3IgcmVnIGluIG9yZGVyZWRfaW1wbHJlZ3M6
CisgICAgICAgIHJlZ19yZCA9IDAKKyAgICAgICAgcmVnX3dyID0gMAorICAgICAgICBpZiAoJ0Ff
SU1QTElDSVRfV1JJVEVTXycrcmVnKSBpbiBhdHRyaWJkaWN0W3RhZ106IHJlZ193ciA9IDEKKyAg
ICAgICAgaWYgcmVnX3JkIGFuZCByZWdfd3I6CisgICAgICAgICAgICByZXRzdHIgKz0gc3JjZHN0
X2xldHQKKyAgICAgICAgICAgIG1hcGRpY3Rbc3JjZHN0X2xldHRdID0gcmVnCisgICAgICAgICAg
ICBzcmNkc3RfbGV0dCA9IGxldHRlcl9pbmMoc3JjZHN0X2xldHQpCisgICAgICAgIGVsaWYgcmVn
X3JkOgorICAgICAgICAgICAgcmV0c3RyICs9IHNyY19sZXR0CisgICAgICAgICAgICBtYXBkaWN0
W3NyY19sZXR0XSA9IHJlZworICAgICAgICAgICAgc3JjX2xldHQgPSBsZXR0ZXJfaW5jKHNyY19s
ZXR0KQorICAgICAgICBlbGlmIHJlZ193cjoKKyAgICAgICAgICAgIHJldHN0ciArPSBkc3RfbGV0
dAorICAgICAgICAgICAgbWFwZGljdFtkc3RfbGV0dF0gPSByZWcKKyAgICAgICAgICAgIGRzdF9s
ZXR0ID0gbGV0dGVyX2luYyhkc3RfbGV0dCkKKyAgICByZXR1cm4gcmV0c3RyLG1hcGRpY3QKKwor
ZGVmIGNhbGN1bGF0ZV9yZWdpZF9sZXR0ZXJzKHRhZyk6CisgICAgcmV0c3RyLG1hcGRpY3QgPSBj
YWxjdWxhdGVfcmVnaWRfcmVnKHRhZykKKyAgICByZXR1cm4gcmV0c3RyCisKK2RlZiBzdHJpcF9y
ZWdfcHJlZml4KHgpOgorICAgIHk9eC5yZXBsYWNlKCdVUkVHLicsJycpCisgICAgeT15LnJlcGxh
Y2UoJ01SRUcuJywnJykKKyAgICByZXR1cm4geS5yZXBsYWNlKCdHUkVHLicsJycpCisKK2RlZiBt
YWluKCk6CisgICAgcmVhZF9zZW1hbnRpY3NfZmlsZShzeXMuYXJndlsxXSkKKyAgICByZWFkX2F0
dHJpYnNfZmlsZShzeXMuYXJndlsyXSkKKyAgICB0YWdyZWdzID0gZ2V0X3RhZ3JlZ3MoKQorICAg
IHRhZ2ltbXMgPSBnZXRfdGFnaW1tcygpCisKKyAgICBmID0gU3RyaW5nSU8oKQorCisgICAgZm9y
IHRhZyBpbiB0YWdzOgorICAgICAgICByZWdzID0gdGFncmVnc1t0YWddCisgICAgICAgIHJyZWdz
ID0gW10KKyAgICAgICAgd3JlZ3MgPSBbXQorICAgICAgICByZWdpZHMgPSAiIgorICAgICAgICBm
b3IgcmVndHlwZSxyZWdpZCx0b3NzLG51bXJlZ3MgaW4gcmVnczoKKyAgICAgICAgICAgIGlmIGlz
X3JlYWQocmVnaWQpOgorICAgICAgICAgICAgICAgIGlmIHJlZ2lkWzBdIG5vdCBpbiByZWdpZHM6
IHJlZ2lkcyArPSByZWdpZFswXQorICAgICAgICAgICAgICAgIHJyZWdzLmFwcGVuZChyZWd0eXBl
K3JlZ2lkK251bXJlZ3MpCisgICAgICAgICAgICBpZiBpc193cml0dGVuKHJlZ2lkKToKKyAgICAg
ICAgICAgICAgICB3cmVncy5hcHBlbmQocmVndHlwZStyZWdpZCtudW1yZWdzKQorICAgICAgICAg
ICAgICAgIGlmIHJlZ2lkWzBdIG5vdCBpbiByZWdpZHM6IHJlZ2lkcyArPSByZWdpZFswXQorICAg
ICAgICBmb3IgYXR0cmliIGluIGF0dHJpYmRpY3RbdGFnXToKKyAgICAgICAgICAgIGlmIGF0dHJp
YmluZm9bYXR0cmliXVsncnJlZyddOgorICAgICAgICAgICAgICAgIHJyZWdzLmFwcGVuZChzdHJp
cF9yZWdfcHJlZml4KGF0dHJpYmluZm9bYXR0cmliXVsncnJlZyddKSkKKyAgICAgICAgICAgIGlm
IGF0dHJpYmluZm9bYXR0cmliXVsnd3JlZyddOgorICAgICAgICAgICAgICAgIHdyZWdzLmFwcGVu
ZChzdHJpcF9yZWdfcHJlZml4KGF0dHJpYmluZm9bYXR0cmliXVsnd3JlZyddKSkKKyAgICAgICAg
cmVnaWRzICs9IGNhbGN1bGF0ZV9yZWdpZF9sZXR0ZXJzKHRhZykKKyAgICAgICAgZi53cml0ZSgn
UkVHSU5GTyglcywiJXMiLFx0LypSRDoqL1x0IiVzIixcdC8qV1I6Ki9cdCIlcyIpXG4nICUgXAor
ICAgICAgICAgICAgKHRhZyxyZWdpZHMsIiwiLmpvaW4ocnJlZ3MpLCIsIi5qb2luKHdyZWdzKSkp
CisKKyAgICBmb3IgdGFnIGluIHRhZ3M6CisgICAgICAgIGltbXMgPSB0YWdpbW1zW3RhZ10KKyAg
ICAgICAgZi53cml0ZSggJ0lNTUlORk8oJXMnICUgdGFnKQorICAgICAgICBpZiBub3QgaW1tczoK
KyAgICAgICAgICAgIGYud3JpdGUoJycnLCd1JywwLDAsJ1UnLDAsMCcnJykKKyAgICAgICAgZm9y
IHNpZ24sc2l6ZSxzaGFtdCBpbiBpbW1zOgorICAgICAgICAgICAgaWYgc2lnbiA9PSAncic6IHNp
Z24gPSAncycKKyAgICAgICAgICAgIGlmIG5vdCBzaGFtdDoKKyAgICAgICAgICAgICAgICBzaGFt
dCA9ICIwIgorICAgICAgICAgICAgZi53cml0ZSgnJycsJyVzJywlcywlcycnJyAlIChzaWduLHNp
emUsc2hhbXQpKQorICAgICAgICBpZiBsZW4oaW1tcykgPT0gMToKKyAgICAgICAgICAgIGlmIHNp
Z24uaXN1cHBlcigpOgorICAgICAgICAgICAgICAgIG15dSA9ICd1JworICAgICAgICAgICAgZWxz
ZToKKyAgICAgICAgICAgICAgICBteXUgPSAnVScKKyAgICAgICAgICAgIGYud3JpdGUoJycnLCcl
cycsMCwwJycnICUgbXl1KQorICAgICAgICBmLndyaXRlKCcpXG4nKQorCisgICAgcmVhbGYgPSBv
cGVuKHN5cy5hcmd2WzNdLCAndycpCisgICAgcmVhbGYud3JpdGUoZi5nZXR2YWx1ZSgpKQorICAg
IHJlYWxmLmNsb3NlKCkKKyAgICBmLmNsb3NlKCkKKworaWYgX19uYW1lX18gPT0gIl9fbWFpbl9f
IjoKKyAgICBtYWluKCkKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29uL2dlbl9vcGNvZGVzX2Rl
Zi5weSBiL3RhcmdldC9oZXhhZ29uL2dlbl9vcGNvZGVzX2RlZi5weQpuZXcgZmlsZSBtb2RlIDEw
MDc1NQppbmRleCAwMDAwMDAwLi4zYzQ3Mjg1Ci0tLSAvZGV2L251bGwKKysrIGIvdGFyZ2V0L2hl
eGFnb24vZ2VuX29wY29kZXNfZGVmLnB5CkBAIC0wLDAgKzEsNDMgQEAKKyMhL3Vzci9iaW4vZW52
IHB5dGhvbjMKKworIyMKKyMjICBDb3B5cmlnaHQoYykgMjAxOS0yMDIwIFF1YWxjb21tIElubm92
YXRpb24gQ2VudGVyLCBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCisjIworIyMgIFRoaXMgcHJv
Z3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9k
aWZ5CisjIyAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGlj
ZW5zZSBhcyBwdWJsaXNoZWQgYnkKKyMjICB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBl
aXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvcgorIyMgIChhdCB5b3VyIG9wdGlvbikg
YW55IGxhdGVyIHZlcnNpb24uCisjIworIyMgIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBp
biB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorIyMgIGJ1dCBXSVRIT1VUIEFOWSBX
QVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisjIyAgTUVSQ0hB
TlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQor
IyMgIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisjIworIyMg
IFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1Ymxp
YyBMaWNlbnNlCisjIyAgYWxvbmcgd2l0aCB0aGlzIHByb2dyYW07IGlmIG5vdCwgc2VlIDxodHRw
Oi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KKyMjCisKK2ltcG9ydCBzeXMKK2ltcG9ydCByZQor
aW1wb3J0IHN0cmluZworZnJvbSBpbyBpbXBvcnQgU3RyaW5nSU8KKworZnJvbSBoZXhfY29tbW9u
IGltcG9ydCAqCisKK2RlZiBtYWluKCk6CisgICAgcmVhZF9zZW1hbnRpY3NfZmlsZShzeXMuYXJn
dlsxXSkKKworICAgICMjCisgICAgIyMgR2VuZXJhdGUgdGhlIG9wY29kZXNfZGVmX2dlbmVyYXRl
ZC5oIGZpbGUKKyAgICAjIyAgICAgR2l2ZXMgYSBsaXN0IG9mIGFsbCB0aGUgb3Bjb2RlcworICAg
ICMjCisgICAgZiA9IFN0cmluZ0lPKCkKKyAgICBmb3IgdGFnIGluIHRhZ3M6CisgICAgICAgIGYu
d3JpdGUgKCAiT1BDT0RFKCVzKSxcbiIgJSAodGFnKSApCisgICAgcmVhbGYgPSBvcGVuKHN5cy5h
cmd2WzNdLCAnd3QnKQorICAgIHJlYWxmLndyaXRlKGYuZ2V0dmFsdWUoKSkKKyAgICByZWFsZi5j
bG9zZSgpCisgICAgZi5jbG9zZSgpCisKK2lmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CisgICAg
bWFpbigpCmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi9nZW5fcHJpbnRpbnNuLnB5IGIvdGFy
Z2V0L2hleGFnb24vZ2VuX3ByaW50aW5zbi5weQpuZXcgZmlsZSBtb2RlIDEwMDc1NQppbmRleCAw
MDAwMDAwLi4xNDlmZmI0Ci0tLSAvZGV2L251bGwKKysrIGIvdGFyZ2V0L2hleGFnb24vZ2VuX3By
aW50aW5zbi5weQpAQCAtMCwwICsxLDE4NSBAQAorIyEvdXNyL2Jpbi9lbnYgcHl0aG9uMworCisj
IworIyMgIENvcHlyaWdodChjKSAyMDE5LTIwMjAgUXVhbGNvbW0gSW5ub3ZhdGlvbiBDZW50ZXIs
IEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KKyMjCisjIyAgVGhpcyBwcm9ncmFtIGlzIGZyZWUg
c29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKKyMjICBpdCB1
bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxp
c2hlZCBieQorIyMgIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9u
IDIgb2YgdGhlIExpY2Vuc2UsIG9yCisjIyAgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVy
c2lvbi4KKyMjCisjIyAgVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRo
YXQgaXQgd2lsbCBiZSB1c2VmdWwsCisjIyAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRo
b3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyMjICBNRVJDSEFOVEFCSUxJVFkgb3Ig
RklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCisjIyAgR05VIEdlbmVy
YWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKyMjCisjIyAgWW91IHNob3VsZCBo
YXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKKyMj
ICBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9y
Zy9saWNlbnNlcy8+LgorIyMKKworaW1wb3J0IHN5cworaW1wb3J0IHJlCitpbXBvcnQgc3RyaW5n
Citmcm9tIGlvIGltcG9ydCBTdHJpbmdJTworCitmcm9tIGhleF9jb21tb24gaW1wb3J0ICoKKwor
IyMKKyMjIEdlbmVyYXRlIHRoZSBwcmludGluc25fZ2VuZXJhdGVkLmggZmlsZQorIyMgICAgIERh
dGEgZm9yIHByaW50aW5nIGVhY2ggaW5zdHJ1Y3Rpb24gKGZvcm1hdCBzdHJpbmcgKyBvcGVyYW5k
cykKKyMjCitkZWYgcmVncHJpbnRlcihtKToKKyAgICBzdHIgPSBtLmdyb3VwKDEpCisgICAgc3Ry
ICs9ICI6Ii5qb2luKFsiJWQiXSpsZW4obS5ncm91cCgyKSkpCisgICAgc3RyICs9IG0uZ3JvdXAo
MykKKyAgICBpZiAoJ1MnIGluIG0uZ3JvdXAoMSkpIGFuZCAobGVuKG0uZ3JvdXAoMikpID09IDEp
OgorICAgICAgICBzdHIgKz0gIi8lcyIKKyAgICBlbGlmICgnQycgaW4gbS5ncm91cCgxKSkgYW5k
IChsZW4obS5ncm91cCgyKSkgPT0gMSk6CisgICAgICAgIHN0ciArPSAiLyVzIgorICAgIHJldHVy
biBzdHIKKworZGVmIHNwYWNpZnkocyk6CisgICAgIyBSZWd1bGFyIGV4cHJlc3Npb24gdGhhdCBt
YXRjaGVzIGFueSBvcGVyYXRvciB0aGF0IGNvbnRhaW5zICc9JyBjaGFyYWN0ZXI6CisgICAgb3Bz
d2l0aGVxdWFsX3JlID0gJ1stK14mfCE8Pj1dPz0nCisgICAgIyBSZWd1bGFyIGV4cHJlc3Npb24g
dGhhdCBtYXRjaGVzIGFueSBhc3NpZ25tZW50IG9wZXJhdG9yLgorICAgIGFzc2lnbm1lbnRfcmUg
PSAnWy0rXiZ8XT89JworCisgICAgIyBPdXQgb2YgdGhlIG9wZXJhdG9ycyB0aGF0IGNvbnRhaW4g
dGhlID0gc2lnbiwgaWYgdGhlIG9wZXJhdG9yIGlzIGFsc28gYW4KKyAgICAjIGFzc2lnbm1lbnQs
IHNwYWNlcyB3aWxsIGJlIGFkZGVkIGFyb3VuZCBpdCwgdW5sZXNzIGl0J3MgZW5jbG9zZWQgd2l0
aGluCisgICAgIyBwYXJlbnRoZXNlcywgb3Igc3BhY2VzIGFyZSBhbHJlYWR5IHByZXNlbnQuCisK
KyAgICBlcXVhbHMgPSByZS5jb21waWxlKG9wc3dpdGhlcXVhbF9yZSkKKyAgICBhc3NpZ24gPSBy
ZS5jb21waWxlKGFzc2lnbm1lbnRfcmUpCisKKyAgICBzbGVuID0gbGVuKHMpCisgICAgcGFyZW5f
Y291bnQgPSB7fQorICAgIGkgPSAwCisgICAgcGMgPSAwCisgICAgd2hpbGUgaSA8IHNsZW46Cisg
ICAgICAgIGMgPSBzW2ldCisgICAgICAgIGlmIGMgPT0gJygnOgorICAgICAgICAgICAgcGMgKz0g
MQorICAgICAgICBlbGlmIGMgPT0gJyknOgorICAgICAgICAgICAgcGMgLT0gMQorICAgICAgICBw
YXJlbl9jb3VudFtpXSA9IHBjCisgICAgICAgIGkgKz0gMQorCisgICAgIyBJdGVyYXRlIG92ZXIg
YWxsIG9wZXJhdG9ycyB0aGF0IGNvbnRhaW4gdGhlIGVxdWFsIHNpZ24uIElmIGFueQorICAgICMg
bWF0Y2ggaXMgYWxzbyBhbiBhc3NpZ25tZW50IG9wZXJhdG9yLCBhZGQgc3BhY2VzIGFyb3VuZCBp
dCBpZgorICAgICMgdGhlIHBhcmVudGhlc2lzIGNvdW50IGlzIDAuCisgICAgcG9zID0gMAorICAg
IG91dCA9IFtdCisgICAgZm9yIG0gaW4gZXF1YWxzLmZpbmRpdGVyKHMpOgorICAgICAgICBtcyA9
IG0uc3RhcnQoKQorICAgICAgICBtZSA9IG0uZW5kKCkKKyAgICAgICAgIyB0IGlzIHRoZSBzdHJp
bmcgdGhhdCBtYXRjaGVkIG9wc3dpdGhlcXVhbF9yZS4KKyAgICAgICAgdCA9IG0uc3RyaW5nW21z
Om1lXQorICAgICAgICBvdXQgKz0gc1twb3M6bXNdCisgICAgICAgIHBvcyA9IG1lCisgICAgICAg
IGlmIHBhcmVuX2NvdW50W21zXSA9PSAwOgorICAgICAgICAgICAgIyBDaGVjayBpZiB0aGUgZW50
aXJlIHN0cmluZyB0IGlzIGFuIGFzc2lnbm1lbnQuCisgICAgICAgICAgICBhbSA9IGFzc2lnbi5t
YXRjaCh0KQorICAgICAgICAgICAgaWYgYW0gYW5kIGxlbihhbS5ncm91cCgwKSkgPT0gbWUtbXM6
CisgICAgICAgICAgICAgICAgIyBEb24ndCBhZGQgc3BhY2VzIGlmIHRoZXkgYXJlIGFscmVhZHkg
dGhlcmUuCisgICAgICAgICAgICAgICAgaWYgbXMgPiAwIGFuZCBzW21zLTFdICE9ICcgJzoKKyAg
ICAgICAgICAgICAgICAgICAgb3V0LmFwcGVuZCgnICcpCisgICAgICAgICAgICAgICAgb3V0ICs9
IHQKKyAgICAgICAgICAgICAgICBpZiBtZSA8IHNsZW4gYW5kIHNbbWVdICE9ICcgJzoKKyAgICAg
ICAgICAgICAgICAgICAgb3V0LmFwcGVuZCgnICcpCisgICAgICAgICAgICAgICAgY29udGludWUK
KyAgICAgICAgIyBJZiB0aGlzIGlzIG5vdCBhbiBhc3NpZ25tZW50LCBqdXN0IGFwcGVuZCBpdCB0
byB0aGUgb3V0cHV0CisgICAgICAgICMgc3RyaW5nLgorICAgICAgICBvdXQgKz0gdAorCisgICAg
IyBBcHBlbmQgdGhlIHJlbWFpbmluZyBwYXJ0IG9mIHRoZSBzdHJpbmcuCisgICAgb3V0ICs9IHNb
cG9zOmxlbihzKV0KKyAgICByZXR1cm4gJycuam9pbihvdXQpCisKK2RlZiBtYWluKCk6CisgICAg
cmVhZF9zZW1hbnRpY3NfZmlsZShzeXMuYXJndlsxXSkKKyAgICByZWFkX2F0dHJpYnNfZmlsZShz
eXMuYXJndlsyXSkKKworICAgIGltbWV4dF9jYXNlcmUgPSByZS5jb21waWxlKHInSU1NRVhUXCgo
W0EtWmEtel0pJykKKworICAgIGYgPSBTdHJpbmdJTygpCisKKyAgICBmb3IgdGFnIGluIHRhZ3M6
CisgICAgICAgIGlmIG5vdCBiZWhkaWN0W3RhZ106IGNvbnRpbnVlCisgICAgICAgIGV4dGVuZGFi
bGVfdXBwZXJfaW1tID0gRmFsc2UKKyAgICAgICAgZXh0ZW5kYWJsZV9sb3dlcl9pbW0gPSBGYWxz
ZQorICAgICAgICBtID0gaW1tZXh0X2Nhc2VyZS5zZWFyY2goc2VtZGljdFt0YWddKQorICAgICAg
ICBpZiBtOgorICAgICAgICAgICAgaWYgbS5ncm91cCgxKS5pc3VwcGVyKCk6CisgICAgICAgICAg
ICAgICAgZXh0ZW5kYWJsZV91cHBlcl9pbW0gPSBUcnVlCisgICAgICAgICAgICBlbHNlOgorICAg
ICAgICAgICAgICAgIGV4dGVuZGFibGVfbG93ZXJfaW1tID0gVHJ1ZQorICAgICAgICBiZWggPSBi
ZWhkaWN0W3RhZ10KKyAgICAgICAgYmVoID0gcmVncmUuc3ViKHJlZ3ByaW50ZXIsYmVoKQorICAg
ICAgICBiZWggPSBhYnNpbW1yZS5zdWIociIjJXMweCV4IixiZWgpCisgICAgICAgIGJlaCA9IHJl
bGltbXJlLnN1YihyIlBDKyVzJWQiLGJlaCkKKyAgICAgICAgYmVoID0gc3BhY2lmeShiZWgpCisg
ICAgICAgICMgUHJpbnQgb3V0IGEgbGl0ZXJhbCAiJXMiIGF0IHRoZSBlbmQsIHVzZWQgdG8gbWF0
Y2ggZW1wdHkgc3RyaW5nCisgICAgICAgICMgc28gQyB3b24ndCBjb21wbGFpbiBhdCB1cworICAg
ICAgICBpZiAoIkFfVkVDWCIgaW4gYXR0cmliZGljdFt0YWddKTogbWFjbmFtZSA9ICJERUZfVkVD
WF9QUklOVElORk8iCisgICAgICAgIGVsc2U6IG1hY25hbWUgPSAiREVGX1BSSU5USU5GTyIKKyAg
ICAgICAgZi53cml0ZSgnJXMoJXMsIiVzJSVzIicgJSAobWFjbmFtZSx0YWcsYmVoKSkKKyAgICAg
ICAgcmVnc19vcl9pbW1zID0gcmVnX29yX2ltbXJlLmZpbmRhbGwoYmVoZGljdFt0YWddKQorICAg
ICAgICByaSA9IDAKKyAgICAgICAgc2VlbnJlZ3MgPSB7fQorICAgICAgICBmb3IgYWxscmVncyxh
LGIsYyxkLGFsbGltbSxpbW1sZXR0LGJpdHMsaW1tc2hpZnQgaW4gcmVnc19vcl9pbW1zOgorICAg
ICAgICAgICAgaWYgYToKKyAgICAgICAgICAgICAgICAjcmVnaXN0ZXIKKyAgICAgICAgICAgICAg
ICBpZiBiIGluIHNlZW5yZWdzOgorICAgICAgICAgICAgICAgICAgICByZWdubyA9IHNlZW5yZWdz
W2JdCisgICAgICAgICAgICAgICAgZWxzZToKKyAgICAgICAgICAgICAgICAgICAgcmVnbm8gPSBy
aQorICAgICAgICAgICAgICAgIGlmIGxlbihiKSA9PSAxOgorICAgICAgICAgICAgICAgICAgICBm
LndyaXRlKCcsIGluc24tPnJlZ25vWyVkXScgJSByZWdubykKKyAgICAgICAgICAgICAgICAgICAg
aWYgJ1MnIGluIGE6CisgICAgICAgICAgICAgICAgICAgICAgICBmLndyaXRlKCcsIHNyZWcyc3Ry
KGluc24tPnJlZ25vWyVkXSknICUgcmVnbm8pCisgICAgICAgICAgICAgICAgICAgIGVsaWYgJ0Mn
IGluIGE6CisgICAgICAgICAgICAgICAgICAgICAgICBmLndyaXRlKCcsIGNyZWcyc3RyKGluc24t
PnJlZ25vWyVkXSknICUgcmVnbm8pCisgICAgICAgICAgICAgICAgZWxpZiBsZW4oYikgPT0gMjoK
KyAgICAgICAgICAgICAgICAgICAgZi53cml0ZSgnLCBpbnNuLT5yZWdub1slZF0gKyAxLCBpbnNu
LT5yZWdub1slZF0nICUgXAorICAgICAgICAgICAgICAgICAgICAgICAgKHJlZ25vLHJlZ25vKSkK
KyAgICAgICAgICAgICAgICBlbGlmIGxlbihiKSA9PSA0OgorICAgICAgICAgICAgICAgICAgICBm
LndyaXRlKCcsIGluc24tPnJlZ25vWyVkXSBeIDMsIGluc24tPnJlZ25vWyVkXSBeIDIsICcgJSBc
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlZ25vLCByZWdubykpCisgICAgICAgICAg
ICAgICAgICAgIGYud3JpdGUoJ2luc24tPnJlZ25vWyVkXSBeIDEsIGluc24tPnJlZ25vWyVkXScg
JSBcCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlZ25vLCByZWdubykpCisgICAgICAg
ICAgICAgICAgZWxzZToKKyAgICAgICAgICAgICAgICAgICAgcHJpbnQoIlB1dCBzb21lIHN0dWZm
IHRvIGhhbmRsZSBxdWFkcyBoZXJlIikKKyAgICAgICAgICAgICAgICBpZiBiIG5vdCBpbiBzZWVu
cmVnczoKKyAgICAgICAgICAgICAgICAgICAgc2VlbnJlZ3NbYl0gPSByaQorICAgICAgICAgICAg
ICAgICAgICByaSArPSAxCisgICAgICAgICAgICBlbHNlOgorICAgICAgICAgICAgICAgICNpbW1l
ZGlhdGUKKyAgICAgICAgICAgICAgICBpZiAoaW1tbGV0dC5pc3VwcGVyKCkpOgorICAgICAgICAg
ICAgICAgICAgICBpZiBleHRlbmRhYmxlX3VwcGVyX2ltbToKKyAgICAgICAgICAgICAgICAgICAg
ICAgIGlmIGltbWxldHQgaW4gJ3JSJzoKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBmLndy
aXRlKCcsaW5zbi0+ZXh0ZW5zaW9uX3ZhbGlkPyIjIyI6IiInKQorICAgICAgICAgICAgICAgICAg
ICAgICAgZWxzZToKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBmLndyaXRlKCcsaW5zbi0+
ZXh0ZW5zaW9uX3ZhbGlkPyIjIjoiIicpCisgICAgICAgICAgICAgICAgICAgIGVsc2U6CisgICAg
ICAgICAgICAgICAgICAgICAgICBmLndyaXRlKCcsIiInKQorICAgICAgICAgICAgICAgICAgICBp
aSA9IDEKKyAgICAgICAgICAgICAgICBlbHNlOgorICAgICAgICAgICAgICAgICAgICBpZiBleHRl
bmRhYmxlX2xvd2VyX2ltbToKKyAgICAgICAgICAgICAgICAgICAgICAgIGlmIGltbWxldHQgaW4g
J3JSJzoKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBmLndyaXRlKCcsaW5zbi0+ZXh0ZW5z
aW9uX3ZhbGlkPyIjIyI6IiInKQorICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBmLndyaXRlKCcsaW5zbi0+ZXh0ZW5zaW9uX3ZhbGlkPyIj
IjoiIicpCisgICAgICAgICAgICAgICAgICAgIGVsc2U6CisgICAgICAgICAgICAgICAgICAgICAg
ICBmLndyaXRlKCcsIiInKQorICAgICAgICAgICAgICAgICAgICBpaSA9IDAKKyAgICAgICAgICAg
ICAgICBmLndyaXRlKCcsIGluc24tPmltbWVkWyVkXScgJSBpaSkKKyAgICAgICAgIyBhcHBlbmQg
ZW1wdHkgc3RyaW5nIHNvIHRoZXJlIGlzIGF0IGxlYXN0IG9uZSBtb3JlIGFyZworICAgICAgICBm
LndyaXRlKCcsIiIpXG4nKQorCisgICAgcmVhbGYgPSBvcGVuKHN5cy5hcmd2WzNdLCAndycpCisg
ICAgcmVhbGYud3JpdGUoZi5nZXR2YWx1ZSgpKQorICAgIHJlYWxmLmNsb3NlKCkKKyAgICBmLmNs
b3NlKCkKKworaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKKyAgICBtYWluKCkKZGlmZiAtLWdp
dCBhL3RhcmdldC9oZXhhZ29uL2dlbl9zaG9ydGNvZGUucHkgYi90YXJnZXQvaGV4YWdvbi9nZW5f
c2hvcnRjb2RlLnB5Cm5ldyBmaWxlIG1vZGUgMTAwNzU1CmluZGV4IDAwMDAwMDAuLjFjN2I2MTEK
LS0tIC9kZXYvbnVsbAorKysgYi90YXJnZXQvaGV4YWdvbi9nZW5fc2hvcnRjb2RlLnB5CkBAIC0w
LDAgKzEsNzEgQEAKKyMhL3Vzci9iaW4vZW52IHB5dGhvbjMKKworIyMKKyMjICBDb3B5cmlnaHQo
YykgMjAxOS0yMDIwIFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFsbCBSaWdodHMg
UmVzZXJ2ZWQuCisjIworIyMgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2Fu
IHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CisjIyAgaXQgdW5kZXIgdGhlIHRlcm1zIG9m
IHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKKyMjICB0aGUg
RnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNl
LCBvcgorIyMgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisjIworIyMgIFRo
aXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNl
ZnVsLAorIyMgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBs
aWVkIHdhcnJhbnR5IG9mCisjIyAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFS
VElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQorIyMgIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IGZvciBtb3JlIGRldGFpbHMuCisjIworIyMgIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNv
cHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCisjIyAgYWxvbmcgd2l0aCB0aGlz
IHByb2dyYW07IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KKyMj
CisKK2ltcG9ydCBzeXMKK2ltcG9ydCByZQoraW1wb3J0IHN0cmluZworZnJvbSBpbyBpbXBvcnQg
U3RyaW5nSU8KKworZnJvbSBoZXhfY29tbW9uIGltcG9ydCAqCisKK2RlZiBnZW5fc2hvcnRjb2Rl
KGYsIHRhZyk6CisgICAgZi53cml0ZSgnREVGX1NIT1JUQ09ERSglcywgJXMpXG4nICUgKHRhZyxz
ZW1kaWN0W3RhZ10pKQorCitkZWYgbWFpbigpOgorICAgIHJlYWRfc2VtYW50aWNzX2ZpbGUoc3lz
LmFyZ3ZbMV0pCisgICAgcmVhZF9hdHRyaWJzX2ZpbGUoc3lzLmFyZ3ZbMl0pCisgICAgY2FsY3Vs
YXRlX2F0dHJpYnMoKQorICAgIHRhZ3JlZ3MgPSBnZXRfdGFncmVncygpCisgICAgdGFnaW1tcyA9
IGdldF90YWdpbW1zKCkKKworICAgICMjCisgICAgIyMgR2VuZXJhdGUgdGhlIHNob3J0Y29kZV9n
ZW5lcmF0ZWQuaCBmaWxlCisgICAgIyMKKyAgICBmID0gU3RyaW5nSU8oKQorCisgICAgZi53cml0
ZSgiI2lmbmRlZiBERUZfU0hPUlRDT0RFXG4iKQorICAgIGYud3JpdGUoIiNkZWZpbmUgREVGX1NI
T1JUQ09ERShUQUcsU0hPUlRDT0RFKSAgICAvKiBOb3RoaW5nICovXG4iKQorICAgIGYud3JpdGUo
IiNlbmRpZlxuIikKKworICAgIGZvciB0YWcgaW4gdGFnczoKKyAgICAgICAgIyMgU2tpcCB0aGUg
cHJpdiBpbnN0cnVjdGlvbnMKKyAgICAgICAgaWYgKCAiQV9QUklWIiBpbiBhdHRyaWJkaWN0W3Rh
Z10gKSA6CisgICAgICAgICAgICBjb250aW51ZQorICAgICAgICAjIyBTa2lwIHRoZSBndWVzdCBp
bnN0cnVjdGlvbnMKKyAgICAgICAgaWYgKCAiQV9HVUVTVCIgaW4gYXR0cmliZGljdFt0YWddICkg
OgorICAgICAgICAgICAgY29udGludWUKKyAgICAgICAgIyMgU2tpcCB0aGUgZGlhZyBpbnN0cnVj
dGlvbnMKKyAgICAgICAgaWYgKCB0YWcgPT0gIlk2X2RpYWciICkgOgorICAgICAgICAgICAgY29u
dGludWUKKyAgICAgICAgaWYgKCB0YWcgPT0gIlk2X2RpYWcwIiApIDoKKyAgICAgICAgICAgIGNv
bnRpbnVlCisgICAgICAgIGlmICggdGFnID09ICJZNl9kaWFnMSIgKSA6CisgICAgICAgICAgICBj
b250aW51ZQorCisgICAgICAgIGdlbl9zaG9ydGNvZGUoZiwgdGFnKQorCisgICAgZi53cml0ZSgi
I3VuZGVmIERFRl9TSE9SVENPREVcbiIpCisKKyAgICByZWFsZiA9IG9wZW4oc3lzLmFyZ3ZbM10s
ICd3JykKKyAgICByZWFsZi53cml0ZShmLmdldHZhbHVlKCkpCisgICAgcmVhbGYuY2xvc2UoKQor
ICAgIGYuY2xvc2UoKQorCitpZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgorICAgIG1haW4oKQpk
aWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vZ2VuX3RjZ19mdW5jX3RhYmxlLnB5IGIvdGFyZ2V0
L2hleGFnb24vZ2VuX3RjZ19mdW5jX3RhYmxlLnB5Cm5ldyBmaWxlIG1vZGUgMTAwNzU1CmluZGV4
IDAwMDAwMDAuLjgwZjMwZjQKLS0tIC9kZXYvbnVsbAorKysgYi90YXJnZXQvaGV4YWdvbi9nZW5f
dGNnX2Z1bmNfdGFibGUucHkKQEAgLTAsMCArMSw2NiBAQAorIyEvdXNyL2Jpbi9lbnYgcHl0aG9u
MworCisjIworIyMgIENvcHlyaWdodChjKSAyMDE5LTIwMjAgUXVhbGNvbW0gSW5ub3ZhdGlvbiBD
ZW50ZXIsIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KKyMjCisjIyAgVGhpcyBwcm9ncmFtIGlz
IGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKKyMj
ICBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFz
IHB1Ymxpc2hlZCBieQorIyMgIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2
ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yCisjIyAgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0
ZXIgdmVyc2lvbi4KKyMjCisjIyAgVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBo
b3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisjIyAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZ
OyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyMjICBNRVJDSEFOVEFCSUxJ
VFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCisjIyAgR05V
IEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKyMjCisjIyAgWW91IHNo
b3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vu
c2UKKyMjICBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93d3cu
Z251Lm9yZy9saWNlbnNlcy8+LgorIyMKKworaW1wb3J0IHN5cworaW1wb3J0IHJlCitpbXBvcnQg
c3RyaW5nCitmcm9tIGlvIGltcG9ydCBTdHJpbmdJTworCitmcm9tIGhleF9jb21tb24gaW1wb3J0
ICoKKworZGVmIG1haW4oKToKKyAgICByZWFkX3NlbWFudGljc19maWxlKHN5cy5hcmd2WzFdKQor
ICAgIHJlYWRfYXR0cmlic19maWxlKHN5cy5hcmd2WzJdKQorICAgIGNhbGN1bGF0ZV9hdHRyaWJz
KCkKKyAgICB0YWdyZWdzID0gZ2V0X3RhZ3JlZ3MoKQorICAgIHRhZ2ltbXMgPSBnZXRfdGFnaW1t
cygpCisKKyAgICBmID0gU3RyaW5nSU8oKQorCisgICAgZi53cml0ZSgiI2lmbmRlZiBIRVhBR09O
X0ZVTkNfVEFCTEVfSFxuIikKKyAgICBmLndyaXRlKCIjZGVmaW5lIEhFWEFHT05fRlVOQ19UQUJM
RV9IXG5cbiIpCisKKyAgICBmLndyaXRlKCJjb25zdCBTZW1hbnRpY0luc24gb3Bjb2RlX2dlbnB0
cltYWF9MQVNUX09QQ09ERV0gPSB7XG4iKQorICAgIGZvciB0YWcgaW4gdGFnczoKKyAgICAgICAg
IyMgU2tpcCB0aGUgcHJpdiBpbnN0cnVjdGlvbnMKKyAgICAgICAgaWYgKCAiQV9QUklWIiBpbiBh
dHRyaWJkaWN0W3RhZ10gKSA6CisgICAgICAgICAgICBjb250aW51ZQorICAgICAgICAjIyBTa2lw
IHRoZSBndWVzdCBpbnN0cnVjdGlvbnMKKyAgICAgICAgaWYgKCAiQV9HVUVTVCIgaW4gYXR0cmli
ZGljdFt0YWddICkgOgorICAgICAgICAgICAgY29udGludWUKKyAgICAgICAgIyMgU2tpcCB0aGUg
ZGlhZyBpbnN0cnVjdGlvbnMKKyAgICAgICAgaWYgKCB0YWcgPT0gIlk2X2RpYWciICkgOgorICAg
ICAgICAgICAgY29udGludWUKKyAgICAgICAgaWYgKCB0YWcgPT0gIlk2X2RpYWcwIiApIDoKKyAg
ICAgICAgICAgIGNvbnRpbnVlCisgICAgICAgIGlmICggdGFnID09ICJZNl9kaWFnMSIgKSA6Cisg
ICAgICAgICAgICBjb250aW51ZQorCisgICAgICAgIGYud3JpdGUoIiAgICBbJXNdID0gZ2VuZXJh
dGVfJXMsXG4iICUgKHRhZywgdGFnKSkKKyAgICBmLndyaXRlKCJ9O1xuXG4iKQorCisgICAgZi53
cml0ZSgiI2VuZGlmICAgIC8qIEhFWEFHT05fRlVOQ19UQUJMRV9IICovXG4iKQorCisgICAgcmVh
bGYgPSBvcGVuKHN5cy5hcmd2WzNdLCAndycpCisgICAgcmVhbGYud3JpdGUoZi5nZXR2YWx1ZSgp
KQorICAgIHJlYWxmLmNsb3NlKCkKKyAgICBmLmNsb3NlKCkKKworaWYgX19uYW1lX18gPT0gIl9f
bWFpbl9fIjoKKyAgICBtYWluKCkKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29uL2dlbl90Y2df
ZnVuY3MucHkgYi90YXJnZXQvaGV4YWdvbi9nZW5fdGNnX2Z1bmNzLnB5Cm5ldyBmaWxlIG1vZGUg
MTAwNzU1CmluZGV4IDAwMDAwMDAuLjNlOTY0YjkKLS0tIC9kZXYvbnVsbAorKysgYi90YXJnZXQv
aGV4YWdvbi9nZW5fdGNnX2Z1bmNzLnB5CkBAIC0wLDAgKzEsNTM4IEBACisjIS91c3IvYmluL2Vu
diBweXRob24zCisKKyMjCisjIyAgQ29weXJpZ2h0KGMpIDIwMTktMjAyMCBRdWFsY29tbSBJbm5v
dmF0aW9uIENlbnRlciwgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLgorIyMKKyMjICBUaGlzIHBy
b2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1v
ZGlmeQorIyMgIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExp
Y2Vuc2UgYXMgcHVibGlzaGVkIGJ5CisjIyAgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsg
ZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IKKyMjICAoYXQgeW91ciBvcHRpb24p
IGFueSBsYXRlciB2ZXJzaW9uLgorIyMKKyMjICBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQg
aW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyMjICBidXQgV0lUSE9VVCBBTlkg
V0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgorIyMgIE1FUkNI
QU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUK
KyMjICBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorIyMKKyMj
ICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJs
aWMgTGljZW5zZQorIyMgIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtOyBpZiBub3QsIHNlZSA8aHR0
cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCisjIworCitpbXBvcnQgc3lzCitpbXBvcnQgcmUK
K2ltcG9ydCBzdHJpbmcKK2Zyb20gaW8gaW1wb3J0IFN0cmluZ0lPCisKK2Zyb20gaGV4X2NvbW1v
biBpbXBvcnQgKgorCisjIworIyMgSGVscGVycyBmb3IgZ2VuX3RjZ19mdW5jCisjIworZGVmIGdl
bl9kZWNsX2VhX3RjZyhmLCB0YWcpOgorICAgIGlmICgnQV9DT05ERVhFQycgaW4gYXR0cmliZGlj
dFt0YWddIG9yCisgICAgICAgICdBX0xPQUQnIGluIGF0dHJpYmRpY3RbdGFnXSk6CisgICAgICAg
IGYud3JpdGUoIiAgICBUQ0d2IEVBID0gdGNnX3RlbXBfbG9jYWxfbmV3KCk7XG4iKQorICAgIGVs
c2U6CisgICAgICAgIGYud3JpdGUoIiAgICBUQ0d2IEVBID0gdGNnX3RlbXBfbmV3KCk7XG4iKQor
CitkZWYgZ2VuX2ZyZWVfZWFfdGNnKGYpOgorICAgIGYud3JpdGUoIiAgICB0Y2dfdGVtcF9mcmVl
KEVBKTtcbiIpCisKK2RlZiBnZW5wdHJfZGVjbF9wYWlyX3dyaXRlYmxlKGYsIHRhZywgcmVndHlw
ZSwgcmVnaWQsIHJlZ25vKToKKyAgICByZWdOPSIlcyVzTiIgJSAocmVndHlwZSxyZWdpZCkKKyAg
ICBmLndyaXRlKCIgICAgVENHdl9pNjQgJXMlc1YgPSB0Y2dfdGVtcF9sb2NhbF9uZXdfaTY0KCk7
XG4iICUgXAorICAgICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgIGYud3JpdGUoIiAgICBjb25z
dCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4iICUgKHJlZ04sIHJlZ25vKSkKKyAgICBpZiAo
J0FfQ09OREVYRUMnIGluIGF0dHJpYmRpY3RbdGFnXSk6CisgICAgICAgIGYud3JpdGUoIiAgICBp
ZiAoIWlzX3ByZWxvYWRlZChjdHgsICVzKSkge1xuIiAlIHJlZ04pCisgICAgICAgIGYud3JpdGUo
IiAgICAgICAgdGNnX2dlbl9tb3ZfdGwoaGV4X25ld192YWx1ZVslc10sIGhleF9ncHJbJXNdKTtc
biIgJSBcCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChyZWdOLCByZWdOKSkKKyAgICAg
ICAgZi53cml0ZSgiICAgIH1cbiIpCisgICAgICAgIGYud3JpdGUoIiAgICBpZiAoIWlzX3ByZWxv
YWRlZChjdHgsICVzICsgMSkpIHtcbiIgJSByZWdOKQorICAgICAgICBmLndyaXRlKCIgICAgICAg
IHRjZ19nZW5fbW92X3RsKGhleF9uZXdfdmFsdWVbJXMgKyAxXSwgaGV4X2dwclslcyArIDFdKTtc
biIgJSBcCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChyZWdOLCByZWdOKSkKKyAgICAg
ICAgZi53cml0ZSgiICAgIH1cbiIpCisKK2RlZiBnZW5wdHJfZGVjbF93cml0ZWJsZShmLCB0YWcs
IHJlZ3R5cGUsIHJlZ2lkLCByZWdubyk6CisgICAgcmVnTj0iJXMlc04iICUgKHJlZ3R5cGUscmVn
aWQpCisgICAgZi53cml0ZSgiICAgIFRDR3YgJXMlc1YgPSB0Y2dfdGVtcF9sb2NhbF9uZXcoKTtc
biIgJSBcCisgICAgICAgIChyZWd0eXBlLCByZWdpZCkpCisgICAgZi53cml0ZSgiICAgIGNvbnN0
IGludCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSAocmVnTiwgcmVnbm8pKQorICAgIGlmICgn
QV9DT05ERVhFQycgaW4gYXR0cmliZGljdFt0YWddKToKKyAgICAgICAgZi53cml0ZSgiICAgIGlm
ICghaXNfcHJlbG9hZGVkKGN0eCwgJXMpKSB7XG4iICUgcmVnTikKKyAgICAgICAgZi53cml0ZSgi
ICAgICAgICB0Y2dfZ2VuX21vdl90bChoZXhfbmV3X3ZhbHVlWyVzXSwgaGV4X2dwclslc10pO1xu
IiAlIFwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ04pKQorICAgICAg
ICBmLndyaXRlKCIgICAgfVxuIikKKworZGVmIGdlbnB0cl9kZWNsKGYsIHRhZywgcmVndHlwZSwg
cmVnaWQsIHJlZ25vKToKKyAgICByZWdOPSIlcyVzTiIgJSAocmVndHlwZSxyZWdpZCkKKyAgICBp
ZiAocmVndHlwZSA9PSAiUiIpOgorICAgICAgICBpZiAocmVnaWQgaW4geyJzcyIsICJ0dCJ9KToK
KyAgICAgICAgICAgIGYud3JpdGUoIiAgICBUQ0d2X2k2NCAlcyVzViA9IHRjZ190ZW1wX2xvY2Fs
X25ld19pNjQoKTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkKKyAg
ICAgICAgICAgIGYud3JpdGUoIiAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4i
ICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVsaWYgKHJlZ2lk
IGluIHsiZGQiLCAiZWUiLCAieHgiLCAieXkifSk6CisgICAgICAgICAgICBnZW5wdHJfZGVjbF9w
YWlyX3dyaXRlYmxlKGYsIHRhZywgcmVndHlwZSwgcmVnaWQsIHJlZ25vKQorICAgICAgICBlbGlm
IChyZWdpZCBpbiB7InMiLCAidCIsICJ1IiwgInYifSk6CisgICAgICAgICAgICBmLndyaXRlKCIg
ICAgVENHdiAlcyVzViA9IGhleF9ncHJbaW5zbi0+cmVnbm9bJWRdXTtcbiIgJSBcCisgICAgICAg
ICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWdubykpCisgICAgICAgIGVsaWYgKHJlZ2lkIGlu
IHsiZCIsICJlIiwgIngiLCAieSJ9KToKKyAgICAgICAgICAgIGdlbnB0cl9kZWNsX3dyaXRlYmxl
KGYsIHRhZywgcmVndHlwZSwgcmVnaWQsIHJlZ25vKQorICAgICAgICBlbHNlOgorICAgICAgICAg
ICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCisgICAgZWxp
ZiAocmVndHlwZSA9PSAiUCIpOgorICAgICAgICBpZiAocmVnaWQgaW4geyJzIiwgInQiLCAidSIs
ICJ2In0pOgorICAgICAgICAgICAgZi53cml0ZSgiICAgIFRDR3YgJXMlc1YgPSBoZXhfcHJlZFtp
bnNuLT5yZWdub1slZF1dO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQs
IHJlZ25vKSkKKyAgICAgICAgZWxpZiAocmVnaWQgaW4geyJkIiwgImUiLCAieCJ9KToKKyAgICAg
ICAgICAgIGdlbnB0cl9kZWNsX3dyaXRlYmxlKGYsIHRhZywgcmVndHlwZSwgcmVnaWQsIHJlZ25v
KQorICAgICAgICBlbHNlOgorICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTog
IiwgcmVndHlwZSwgcmVnaWQpCisgICAgZWxpZiAocmVndHlwZSA9PSAiQyIpOgorICAgICAgICBp
ZiAocmVnaWQgPT0gInNzIik6CisgICAgICAgICAgICBmLndyaXRlKCIgICAgVENHdl9pNjQgJXMl
c1YgPSB0Y2dfdGVtcF9sb2NhbF9uZXdfaTY0KCk7XG4iICUgXAorICAgICAgICAgICAgICAgIChy
ZWd0eXBlLCByZWdpZCkpCisgICAgICAgICAgICBmLndyaXRlKCIgICAgY29uc3QgaW50ICVzID0g
aW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQor
ICAgICAgICBlbGlmIChyZWdpZCA9PSAiZGQiKToKKyAgICAgICAgICAgIGdlbnB0cl9kZWNsX3Bh
aXJfd3JpdGVibGUoZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgcmVnbm8pCisgICAgICAgIGVsaWYg
KHJlZ2lkID09ICJzIik6CisgICAgICAgICAgICBmLndyaXRlKCIgICAgVENHdiAlcyVzViA9IHRj
Z190ZW1wX2xvY2FsX25ldygpO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVn
aWQpKQorICAgICAgICAgICAgZi53cml0ZSgiICAgIGNvbnN0IGludCAlcyVzTiA9IGluc24tPnJl
Z25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWdubykp
CisgICAgICAgIGVsaWYgKHJlZ2lkID09ICJkIik6CisgICAgICAgICAgICBnZW5wdHJfZGVjbF93
cml0ZWJsZShmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCByZWdubykKKyAgICAgICAgZWxzZToKKyAg
ICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQor
ICAgIGVsaWYgKHJlZ3R5cGUgPT0gIk0iKToKKyAgICAgICAgaWYgKHJlZ2lkID09ICJ1Iik6Cisg
ICAgICAgICAgICBmLndyaXRlKCIgICAgY29uc3QgaW50ICVzJXNOID0gaW5zbi0+cmVnbm9bJWRd
O1xuIiUgXAorICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCwgcmVnbm8pKQorICAgICAg
ICAgICAgZi53cml0ZSgiICAgIFRDR3YgJXMlc1YgPSBoZXhfZ3ByWyVzJXNOICsgSEVYX1JFR19N
MF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCwgcmVndHlwZSwgcmVn
aWQpKQorICAgICAgICBlbHNlOgorICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJz
ZTogIiwgcmVndHlwZSwgcmVnaWQpCisgICAgZWxzZToKKyAgICAgICAgcHJpbnQoIkJhZCByZWdp
c3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCisKK2RlZiBnZW5wdHJfZGVjbF9uZXcoZixy
ZWd0eXBlLHJlZ2lkLHJlZ25vKToKKyAgICBpZiAocmVndHlwZSA9PSAiTiIpOgorICAgICAgICBp
ZiAocmVnaWQgaW4geyJzIiwgInQifSk6CisgICAgICAgICAgICBmLndyaXRlKCIgICAgY29uc3Qg
aW50ICVzJXNYID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVn
dHlwZSwgcmVnaWQsIHJlZ25vKSkKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICBUQ0d2ICVzJXNO
ID0gdGNnX2NvbnN0X3RsKCVzJXNYKTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ3R5cGUs
IHJlZ2lkLCByZWd0eXBlLCByZWdpZCkpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBwcmlu
dCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKyAgICBlbGlmIChyZWd0
eXBlID09ICJQIik6CisgICAgICAgIGlmIChyZWdpZCBpbiB7InQiLCAidSIsICJ2In0pOgorICAg
ICAgICAgICAgZi53cml0ZSgiICAgIFRDR3YgJXMlc04gPSBoZXhfbmV3X3ByZWRfdmFsdWVbaW5z
bi0+cmVnbm9bJWRdXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCBy
ZWdubykpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBh
cnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKyAgICBlbHNlOgorICAgICAgICBwcmludCgiQmFkIHJl
Z2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKworZGVmIGdlbnB0cl9kZWNsX29wbihm
LCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCB0b3NzLCBudW1yZWdzLCBpKToKKyAgICBpZiAoaXNfcGFp
cihyZWdpZCkpOgorICAgICAgICBnZW5wdHJfZGVjbChmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCBp
KQorICAgIGVsaWYgKGlzX3NpbmdsZShyZWdpZCkpOgorICAgICAgICBpZiBpc19vbGRfdmFsKHJl
Z3R5cGUsIHJlZ2lkLCB0YWcpOgorICAgICAgICAgICAgZ2VucHRyX2RlY2woZix0YWcsIHJlZ3R5
cGUsIHJlZ2lkLCBpKQorICAgICAgICBlbGlmIGlzX25ld192YWwocmVndHlwZSwgcmVnaWQsIHRh
Zyk6CisgICAgICAgICAgICBnZW5wdHJfZGVjbF9uZXcoZixyZWd0eXBlLHJlZ2lkLGkpCisgICAg
ICAgIGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLHJlZ3R5
cGUscmVnaWQsdG9zcyxudW1yZWdzKQorICAgIGVsc2U6CisgICAgICAgIHByaW50KCJCYWQgcmVn
aXN0ZXIgcGFyc2U6ICIscmVndHlwZSxyZWdpZCx0b3NzLG51bXJlZ3MpCisKK2RlZiBnZW5wdHJf
ZGVjbF9pbW0oZixpbW1sZXR0KToKKyAgICBpZiAoaW1tbGV0dC5pc3VwcGVyKCkpOgorICAgICAg
ICBpID0gMQorICAgIGVsc2U6CisgICAgICAgIGkgPSAwCisgICAgZi53cml0ZSgiICAgIGludCAl
cyA9IGluc24tPmltbWVkWyVkXTtcbiIgJSBcCisgICAgICAgIChpbW1fbmFtZShpbW1sZXR0KSwg
aSkpCisKK2RlZiBnZW5wdHJfZnJlZShmLHJlZ3R5cGUscmVnaWQscmVnbm8pOgorICAgIGlmIChy
ZWd0eXBlID09ICJSIik6CisgICAgICAgIGlmIChyZWdpZCBpbiB7ImRkIiwgInNzIiwgInR0Iiwg
Inh4IiwgInl5In0pOgorICAgICAgICAgICAgZi53cml0ZSgiICAgIHRjZ190ZW1wX2ZyZWVfaTY0
KCVzJXNWKTtcbiIgJSAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7
ImQiLCAiZSIsICJ4IiwgInkifSk6CisgICAgICAgICAgICBmLndyaXRlKCIgICAgdGNnX3RlbXBf
ZnJlZSglcyVzVik7XG4iICUgKHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgZWxpZiAocmVnaWQg
bm90IGluIHsicyIsICJ0IiwgInUiLCAidiJ9KToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVn
aXN0ZXIgcGFyc2U6ICIscmVndHlwZSxyZWdpZCkKKyAgICBlbGlmIChyZWd0eXBlID09ICJQIik6
CisgICAgICAgIGlmIChyZWdpZCBpbiB7ImQiLCAiZSIsICJ4In0pOgorICAgICAgICAgICAgZi53
cml0ZSgiICAgIHRjZ190ZW1wX2ZyZWUoJXMlc1YpO1xuIiAlIChyZWd0eXBlLCByZWdpZCkpCisg
ICAgICAgIGVsaWYgKHJlZ2lkIG5vdCBpbiB7InMiLCAidCIsICJ1IiwgInYifSk6CisgICAgICAg
ICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLHJlZ3R5cGUscmVnaWQpCisgICAgZWxp
ZiAocmVndHlwZSA9PSAiQyIpOgorICAgICAgICBpZiAocmVnaWQgaW4geyJkZCIsICJzcyJ9KToK
KyAgICAgICAgICAgIGYud3JpdGUoIiAgICB0Y2dfdGVtcF9mcmVlX2k2NCglcyVzVik7XG4iICUg
KHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgZWxpZiAocmVnaWQgaW4geyJkIiwgInMifSk6Cisg
ICAgICAgICAgICBmLndyaXRlKCIgICAgdGNnX3RlbXBfZnJlZSglcyVzVik7XG4iICUgKHJlZ3R5
cGUsIHJlZ2lkKSkKKyAgICAgICAgZWxzZToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0
ZXIgcGFyc2U6ICIscmVndHlwZSxyZWdpZCkKKyAgICBlbGlmIChyZWd0eXBlID09ICJNIik6Cisg
ICAgICAgIGlmIChyZWdpZCAhPSAidSIpOgorICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3Rl
ciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCisgICAgZWxzZToKKyAgICAgICAgcHJpbnQoIkJh
ZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCisKK2RlZiBnZW5wdHJfZnJlZV9u
ZXcoZixyZWd0eXBlLHJlZ2lkLHJlZ25vKToKKyAgICBpZiAocmVndHlwZSA9PSAiTiIpOgorICAg
ICAgICBpZiAocmVnaWQgaW4geyJzIiwgInQifSk6CisgICAgICAgICAgICBmLndyaXRlKCIgICAg
dGNnX3RlbXBfZnJlZSglcyVzTik7XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWd0eXBlLCBy
ZWdpZCkpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBh
cnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKyAgICBlbGlmIChyZWd0eXBlID09ICJQIik6CisgICAg
ICAgIGlmIChyZWdpZCBub3QgaW4geyJ0IiwgInUiLCAidiJ9KToKKyAgICAgICAgICAgIHByaW50
KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQorICAgIGVsc2U6CisgICAg
ICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQorCitkZWYg
Z2VucHRyX2ZyZWVfb3BuKGYscmVndHlwZSxyZWdpZCxpLHRhZyk6CisgICAgaWYgKGlzX3BhaXIo
cmVnaWQpKToKKyAgICAgICAgZ2VucHRyX2ZyZWUoZixyZWd0eXBlLHJlZ2lkLGkpCisgICAgZWxp
ZiAoaXNfc2luZ2xlKHJlZ2lkKSk6CisgICAgICAgIGlmIGlzX29sZF92YWwocmVndHlwZSwgcmVn
aWQsIHRhZyk6CisgICAgICAgICAgICBnZW5wdHJfZnJlZShmLHJlZ3R5cGUscmVnaWQsaSkKKyAg
ICAgICAgZWxpZiBpc19uZXdfdmFsKHJlZ3R5cGUsIHJlZ2lkLCB0YWcpOgorICAgICAgICAgICAg
Z2VucHRyX2ZyZWVfbmV3KGYscmVndHlwZSxyZWdpZCxpKQorICAgICAgICBlbHNlOgorICAgICAg
ICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIixyZWd0eXBlLHJlZ2lkLHRvc3MsbnVt
cmVncykKKyAgICBlbHNlOgorICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLHJl
Z3R5cGUscmVnaWQsdG9zcyxudW1yZWdzKQorCitkZWYgZ2VucHRyX3NyY19yZWFkKGYscmVndHlw
ZSxyZWdpZCk6CisgICAgaWYgKHJlZ3R5cGUgPT0gIlIiKToKKyAgICAgICAgaWYgKHJlZ2lkIGlu
IHsic3MiLCAidHQiLCAieHgiLCAieXkifSk6CisgICAgICAgICAgICBmLndyaXRlKCIgICAgdGNn
X2dlbl9jb25jYXRfaTMyX2k2NCglcyVzViwgaGV4X2dwclslcyVzTl0sXG4iICUgXAorICAgICAg
ICAgICAgICAgIChyZWd0eXBlLCByZWdpZCwgcmVndHlwZSwgcmVnaWQpKQorICAgICAgICAgICAg
Zi53cml0ZSgiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGV4X2dwclslcyVzTiAr
IDFdKTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAg
ZWxpZiAocmVnaWQgaW4geyJ4IiwgInkifSk6CisgICAgICAgICAgICBmLndyaXRlKCIgICAgdGNn
X2dlbl9tb3ZfdGwoJXMlc1YsIGhleF9ncHJbJXMlc05dKTtcbiIgJSBcCisgICAgICAgICAgICAg
ICAgKHJlZ3R5cGUscmVnaWQscmVndHlwZSxyZWdpZCkpCisgICAgICAgIGVsaWYgKHJlZ2lkIG5v
dCBpbiB7InMiLCAidCIsICJ1IiwgInYifSk6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lz
dGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKyAgICBlbGlmIChyZWd0eXBlID09ICJQIik6
CisgICAgICAgIGlmIChyZWdpZCA9PSAieCIpOgorICAgICAgICAgICAgZi53cml0ZSgiICAgIHRj
Z19nZW5fbW92X3RsKCVzJXNWLCBoZXhfcHJlZFslcyVzTl0pO1xuIiAlIFwKKyAgICAgICAgICAg
ICAgICAocmVndHlwZSwgcmVnaWQsIHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgZWxpZiAocmVn
aWQgbm90IGluIHsicyIsICJ0IiwgInUiLCAidiJ9KToKKyAgICAgICAgICAgIHByaW50KCJCYWQg
cmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0g
IkMiKToKKyAgICAgICAgaWYgKHJlZ2lkID09ICJzcyIpOgorICAgICAgICAgICAgZi53cml0ZSgi
ICAgIGlmICglcyVzTiArIEhFWF9SRUdfU0EwID09IEhFWF9SRUdfUDNfMCkge1xuIiAlIFwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkpCisgICAgICAg
ICAgICBmLndyaXRlKCIgICAgICAgIFRDR3YgcDNfMCA9IHRjZ190ZW1wX25ldygpO1xuIikKKyAg
ICAgICAgICAgIGYud3JpdGUoIiAgICAgICAgZ2VuX3JlYWRfcDNfMChwM18wKTtcbiIpCisgICAg
ICAgICAgICBmLndyaXRlKCIgICAgICAgIHRjZ19nZW5fY29uY2F0X2kzMl9pNjQoJXMlc1YsIHAz
XzAsXG4iICUgXAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJl
Z2lkKSkKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBoZXhfZ3ByWyVzJXNOICsgMV0pO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkpCisgICAgICAgICAgICBmLndyaXRlKCIgICAg
ICAgIHRjZ190ZW1wX2ZyZWUocDNfMCk7XG4iKQorICAgICAgICAgICAgZi53cml0ZSgiICAgIH0g
ZWxzZSB7XG4iKQorICAgICAgICAgICAgZi53cml0ZSgiICAgICAgICB0Y2dfZ2VuX2NvbmNhdF9p
MzJfaTY0KCVzJXNWLCBoZXhfZ3ByWyVzJXNOXSxcbiIgJSBcCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQsIHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAg
ICAgIGYud3JpdGUoIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZXhfZ3By
WyVzJXNOICsgMV0pO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChy
ZWd0eXBlLCByZWdpZCkpCisgICAgICAgICAgICBmLndyaXRlKCIgICAgfVxuIikKKyAgICAgICAg
ZWxpZiAocmVnaWQgPT0gInMiKToKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICBpZiAoJXMlc04g
KyBIRVhfUkVHX1NBMCA9PSBIRVhfUkVHX1AzXzApIHtcbiIgJSBcCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICAgICAgZi53cml0ZSgi
ICAgICAgICBnZW5fcmVhZF9wM18wKCVzJXNWKTtcbiIgJSBcCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICAgICAgZi53cml0ZSgiICAg
IH0gZWxzZSB7XG4iKQorICAgICAgICAgICAgZi53cml0ZSgiICAgICAgICB0Y2dfZ2VuX21vdl90
bCglcyVzViwgaGV4X2dwclslcyVzTiArIEhFWF9SRUdfU0EwXSk7XG4iICUgXAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWd0eXBlLCByZWdpZCkp
CisgICAgICAgICAgICBmLndyaXRlKCIgICAgfVxuIikKKyAgICAgICAgZWxzZToKKyAgICAgICAg
ICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQorICAgIGVs
aWYgKHJlZ3R5cGUgPT0gIk0iKToKKyAgICAgICAgaWYgKHJlZ2lkICE9ICJ1Iik6CisgICAgICAg
ICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKyAgICBl
bHNlOgorICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdp
ZCkKKworZGVmIGdlbnB0cl9zcmNfcmVhZF9uZXcoZixyZWd0eXBlLHJlZ2lkKToKKyAgICBpZiAo
cmVndHlwZSA9PSAiTiIpOgorICAgICAgICBpZiAocmVnaWQgbm90IGluIHsicyIsICJ0In0pOgor
ICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQp
CisgICAgZWxpZiAocmVndHlwZSA9PSAiUCIpOgorICAgICAgICBpZiAocmVnaWQgbm90IGluIHsi
dCIsICJ1IiwgInYifSk6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAi
LCByZWd0eXBlLCByZWdpZCkKKyAgICBlbHNlOgorICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVy
IHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKworZGVmIGdlbnB0cl9zcmNfcmVhZF9vcG4oZixy
ZWd0eXBlLHJlZ2lkLHRhZyk6CisgICAgaWYgKGlzX3BhaXIocmVnaWQpKToKKyAgICAgICAgZ2Vu
cHRyX3NyY19yZWFkKGYscmVndHlwZSxyZWdpZCkKKyAgICBlbGlmIChpc19zaW5nbGUocmVnaWQp
KToKKyAgICAgICAgaWYgaXNfb2xkX3ZhbChyZWd0eXBlLCByZWdpZCwgdGFnKToKKyAgICAgICAg
ICAgIGdlbnB0cl9zcmNfcmVhZChmLHJlZ3R5cGUscmVnaWQpCisgICAgICAgIGVsaWYgaXNfbmV3
X3ZhbChyZWd0eXBlLCByZWdpZCwgdGFnKToKKyAgICAgICAgICAgIGdlbnB0cl9zcmNfcmVhZF9u
ZXcoZixyZWd0eXBlLHJlZ2lkKQorICAgICAgICBlbHNlOgorICAgICAgICAgICAgcHJpbnQoIkJh
ZCByZWdpc3RlciBwYXJzZTogIixyZWd0eXBlLHJlZ2lkLHRvc3MsbnVtcmVncykKKyAgICBlbHNl
OgorICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLHJlZ3R5cGUscmVnaWQsdG9z
cyxudW1yZWdzKQorCitkZWYgZ2VuX2hlbHBlcl9jYWxsX29wbihmLCB0YWcsIHJlZ3R5cGUsIHJl
Z2lkLCB0b3NzLCBudW1yZWdzLCBpKToKKyAgICBpZiAoaSA+IDApOiBmLndyaXRlKCIsICIpCisg
ICAgaWYgKGlzX3BhaXIocmVnaWQpKToKKyAgICAgICAgZi53cml0ZSgiJXMlc1YiICUgKHJlZ3R5
cGUscmVnaWQpKQorICAgIGVsaWYgKGlzX3NpbmdsZShyZWdpZCkpOgorICAgICAgICBpZiBpc19v
bGRfdmFsKHJlZ3R5cGUsIHJlZ2lkLCB0YWcpOgorICAgICAgICAgICAgZi53cml0ZSgiJXMlc1Yi
ICUgKHJlZ3R5cGUscmVnaWQpKQorICAgICAgICBlbGlmIGlzX25ld192YWwocmVndHlwZSwgcmVn
aWQsIHRhZyk6CisgICAgICAgICAgICBmLndyaXRlKCIlcyVzTiIgJSAocmVndHlwZSxyZWdpZCkp
CisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAi
LHJlZ3R5cGUscmVnaWQsdG9zcyxudW1yZWdzKQorICAgIGVsc2U6CisgICAgICAgIHByaW50KCJC
YWQgcmVnaXN0ZXIgcGFyc2U6ICIscmVndHlwZSxyZWdpZCx0b3NzLG51bXJlZ3MpCisKK2RlZiBn
ZW5faGVscGVyX2RlY2xfaW1tKGYsaW1tbGV0dCk6CisgICAgZi53cml0ZSgiICAgIFRDR3YgdGNn
dl8lcyA9IHRjZ19jb25zdF90bCglcyk7XG4iICUgXAorICAgICAgICAoaW1tX25hbWUoaW1tbGV0
dCksIGltbV9uYW1lKGltbWxldHQpKSkKKworZGVmIGdlbl9oZWxwZXJfY2FsbF9pbW0oZixpbW1s
ZXR0KToKKyAgICBmLndyaXRlKCIsIHRjZ3ZfJXMiICUgaW1tX25hbWUoaW1tbGV0dCkpCisKK2Rl
ZiBnZW5faGVscGVyX2ZyZWVfaW1tKGYsaW1tbGV0dCk6CisgICAgZi53cml0ZSgiICAgIHRjZ190
ZW1wX2ZyZWUodGNndl8lcyk7XG4iICUgaW1tX25hbWUoaW1tbGV0dCkpCisKK2RlZiBnZW5wdHJf
ZHN0X3dyaXRlX3BhaXIoZiwgdGFnLCByZWd0eXBlLCByZWdpZCk6CisgICAgaWYgKCdBX0NPTkRF
WEVDJyBpbiBhdHRyaWJkaWN0W3RhZ10pOgorICAgICAgICBmLndyaXRlKCIgICAgZ2VuX2xvZ19w
cmVkaWNhdGVkX3JlZ193cml0ZV9wYWlyKCVzJXNOLCAlcyVzViwgaW5zbi0+c2xvdCk7XG4iICUg
XAorICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWd0eXBlLCByZWdpZCkpCisgICAgZWxz
ZToKKyAgICAgICAgZi53cml0ZSgiICAgIGdlbl9sb2dfcmVnX3dyaXRlX3BhaXIoJXMlc04sICVz
JXNWKTtcbiIgJSBcCisgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQsIHJlZ3R5cGUsIHJlZ2lk
KSkKKyAgICBmLndyaXRlKCIgICAgY3R4X2xvZ19yZWdfd3JpdGUoY3R4LCAlcyVzTik7XG4iICUg
XAorICAgICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgIGYud3JpdGUoIiAgICBjdHhfbG9nX3Jl
Z193cml0ZShjdHgsICVzJXNOICsgMSk7XG4iICUgXAorICAgICAgICAocmVndHlwZSwgcmVnaWQp
KQorCitkZWYgZ2VucHRyX2RzdF93cml0ZShmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkKToKKyAgICBp
ZiAocmVndHlwZSA9PSAiUiIpOgorICAgICAgICBpZiAocmVnaWQgaW4geyJkZCIsICJ4eCIsICJ5
eSJ9KToKKyAgICAgICAgICAgIGdlbnB0cl9kc3Rfd3JpdGVfcGFpcihmLCB0YWcsIHJlZ3R5cGUs
IHJlZ2lkKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7ImQiLCAiZSIsICJ4IiwgInkifSk6Cisg
ICAgICAgICAgICBpZiAoJ0FfQ09OREVYRUMnIGluIGF0dHJpYmRpY3RbdGFnXSk6CisgICAgICAg
ICAgICAgICAgZi53cml0ZSgiICAgIGdlbl9sb2dfcHJlZGljYXRlZF9yZWdfd3JpdGUoJXMlc04s
ICVzJXNWLFxuIiAlIFwKKyAgICAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWd0
eXBlLCByZWdpZCkpCisgICAgICAgICAgICAgICAgZi53cml0ZSgiICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgaW5zbi0+c2xvdCk7XG4iKQorICAgICAgICAgICAgZWxzZToKKyAgICAg
ICAgICAgICAgICBmLndyaXRlKCIgICAgZ2VuX2xvZ19yZWdfd3JpdGUoJXMlc04sICVzJXNWKTtc
biIgJSBcCisgICAgICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCwgcmVndHlwZSwgcmVn
aWQpKQorICAgICAgICAgICAgZi53cml0ZSgiICAgIGN0eF9sb2dfcmVnX3dyaXRlKGN0eCwgJXMl
c04pO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICBl
bHNlOgorICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwg
cmVnaWQpCisgICAgZWxpZiAocmVndHlwZSA9PSAiUCIpOgorICAgICAgICBpZiAocmVnaWQgaW4g
eyJkIiwgImUiLCAieCJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICBnZW5fbG9nX3ByZWRf
d3JpdGUoJXMlc04sICVzJXNWKTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJl
Z2lkLCByZWd0eXBlLCByZWdpZCkpCisgICAgICAgICAgICBmLndyaXRlKCIgICAgY3R4X2xvZ19w
cmVkX3dyaXRlKGN0eCwgJXMlc04pO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVndHlwZSwg
cmVnaWQpKQorICAgICAgICBlbHNlOgorICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBw
YXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCisgICAgZWxpZiAocmVndHlwZSA9PSAiQyIpOgorICAg
ICAgICBpZiAocmVnaWQgPT0gImRkIik6CisgICAgICAgICAgICBmLndyaXRlKCIgICAgaWYgKCVz
JXNOICsgSEVYX1JFR19TQTAgPT0gSEVYX1JFR19QM18wKSB7XG4iICUgXAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgICAgIGYud3Jp
dGUoIiAgICAgICAgVENHdiB2YWwzMiA9IHRjZ190ZW1wX25ldygpO1xuIikKKyAgICAgICAgICAg
IGYud3JpdGUoIiAgICAgICAgdGNnX2dlbl9leHRybF9pNjRfaTMyKHZhbDMyLCAlcyVzVik7XG4i
ICUgXAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkK
KyAgICAgICAgICAgIGYud3JpdGUoIiAgICAgICAgZ2VuX3dyaXRlX3AzXzAodmFsMzIpO1xuIikK
KyAgICAgICAgICAgIGYud3JpdGUoIiAgICAgICAgdGNnX2dlbl9leHRyaF9pNjRfaTMyKHZhbDMy
LCAlcyVzVik7XG4iICUgXAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlZ3R5
cGUsIHJlZ2lkKSkKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICAgICAgZ2VuX2xvZ19yZWdfd3Jp
dGUoJXMlc04gKyBIRVhfUkVHX1NBMCArIDEsIHZhbDMyKTtcbiIgJSBcCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICAgICAgZi53cml0
ZSgiICAgICAgICB0Y2dfdGVtcF9mcmVlKHZhbDMyKTtcbiIpCisgICAgICAgICAgICBmLndyaXRl
KCIgICAgICAgIGN0eF9sb2dfcmVnX3dyaXRlKGN0eCwgJXMlc04gKyBIRVhfUkVHX1NBMCArIDEp
O1xuIiAlIFwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdp
ZCkpCisgICAgICAgICAgICBmLndyaXRlKCIgICAgfSBlbHNlIHtcbiIpCisgICAgICAgICAgICBm
LndyaXRlKCIgICAgICAgIGdlbl9sb2dfcmVnX3dyaXRlX3BhaXIoJXMlc04gKyBIRVhfUkVHX1NB
MCwgJXMlc1YpO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChyZWd0
eXBlLCByZWdpZCwgcmVndHlwZSwgcmVnaWQpKQorICAgICAgICAgICAgZi53cml0ZSgiICAgICAg
ICBjdHhfbG9nX3JlZ193cml0ZShjdHgsICVzJXNOICsgSEVYX1JFR19TQTApO1xuIiAlIFwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkpCisgICAgICAg
ICAgICBmLndyaXRlKCIgICAgICAgIGN0eF9sb2dfcmVnX3dyaXRlKGN0eCwgJXMlc04gKyBIRVhf
UkVHX1NBMCArIDEpO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChy
ZWd0eXBlLCByZWdpZCkpCisgICAgICAgICAgICBmLndyaXRlKCIgICAgfVxuIikKKyAgICAgICAg
ZWxpZiAocmVnaWQgPT0gImQiKToKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICBpZiAoJXMlc04g
KyBIRVhfUkVHX1NBMCA9PSBIRVhfUkVHX1AzXzApIHtcbiIgJSBcCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICAgICAgZi53cml0ZSgi
ICAgICAgICBnZW5fd3JpdGVfcDNfMCglcyVzVik7XG4iICUgXAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgICAgIGYud3JpdGUoIiAg
ICB9IGVsc2Uge1xuIikKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICAgICAgZ2VuX2xvZ19yZWdf
d3JpdGUoJXMlc04gKyBIRVhfUkVHX1NBMCwgJXMlc1YpO1xuIiAlIFwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCwgcmVndHlwZSwgcmVnaWQpKQorICAg
ICAgICAgICAgZi53cml0ZSgiICAgICAgICBjdHhfbG9nX3JlZ193cml0ZShjdHgsICVzJXNOICsg
SEVYX1JFR19TQTApO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChy
ZWd0eXBlLCByZWdpZCkpCisgICAgICAgICAgICBmLndyaXRlKCIgICAgfVxuIikKKyAgICAgICAg
ZWxzZToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUs
IHJlZ2lkKQorICAgIGVsc2U6CisgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIs
IHJlZ3R5cGUsIHJlZ2lkKQorCitkZWYgZ2VucHRyX2RzdF93cml0ZV9vcG4oZixyZWd0eXBlLCBy
ZWdpZCwgdGFnKToKKyAgICBpZiAoaXNfcGFpcihyZWdpZCkpOgorICAgICAgICBnZW5wdHJfZHN0
X3dyaXRlKGYsIHRhZywgcmVndHlwZSwgcmVnaWQpCisgICAgZWxpZiAoaXNfc2luZ2xlKHJlZ2lk
KSk6CisgICAgICAgIGdlbnB0cl9kc3Rfd3JpdGUoZiwgdGFnLCByZWd0eXBlLCByZWdpZCkKKyAg
ICBlbHNlOgorICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLHJlZ3R5cGUscmVn
aWQsdG9zcyxudW1yZWdzKQorCisjIworIyMgR2VuZXJhdGUgdGhlIFRDRyBjb2RlIHRvIGNhbGwg
dGhlIGhlbHBlcgorIyMgICAgIEZvciBBMl9hZGQ6IFJkMzI9YWRkKFJzMzIsUnQzMiksIHsgUmRW
PVJzVitSdFY7fQorIyMgICAgIFdlIHByb2R1Y2U6CisjIyAgICBzdGF0aWMgdm9pZCBnZW5lcmF0
ZV9BMl9hZGQoKQorIyMgICAgICAgICAgICAgICAgICAgIENQVUhleGFnb25TdGF0ZSAqZW52Cisj
IyAgICAgICAgICAgICAgICAgICAgRGlzYXNDb250ZXh0ICpjdHgsCisjIyAgICAgICAgICAgICAg
ICAgICAgSW5zbiAqaW5zbiwKKyMjICAgICAgICAgICAgICAgICAgICBQYWNrZXQgKnBrdCkKKyMj
ICAgICAgIHsKKyMjICAgICAgICAgICBUQ0d2IFJkViA9IHRjZ190ZW1wX2xvY2FsX25ldygpOwor
IyMgICAgICAgICAgIGNvbnN0IGludCBSZE4gPSBpbnNuLT5yZWdub1swXTsKKyMjICAgICAgICAg
ICBUQ0d2IFJzViA9IGhleF9ncHJbaW5zbi0+cmVnbm9bMV1dOworIyMgICAgICAgICAgIFRDR3Yg
UnRWID0gaGV4X2dwcltpbnNuLT5yZWdub1syXV07CisjIyAgICAgICAgICAgPEdFTj4KKyMjICAg
ICAgICAgICBnZW5fbG9nX3JlZ193cml0ZShSZE4sIFJkVik7CisjIyAgICAgICAgICAgY3R4X2xv
Z19yZWdfd3JpdGUoY3R4LCBSZE4pOworIyMgICAgICAgICAgIHRjZ190ZW1wX2ZyZWUoUmRWKTsK
KyMjICAgICAgIH0KKyMjCisjIyAgICAgICB3aGVyZSA8R0VOPiBkZXBlbmRzIG9uIHNraXBfcWVt
dV9oZWxwZXIodGFnKQorIyMgICAgICAgaWYgc2tpcF9xZW11X2hlbHBlcih0YWcpIGlzIFRydWUK
KyMjICAgICAgIDxHRU4+ICBpcyBmR0VOX1RDR19BMl9hZGQoeyBSZFY9UnNWK1J0Vjt9KTsKKyMj
ICAgICAgIGlmIHNraXBfcWVtdV9oZWxwZXIodGFnKSBpcyBGYWxzZQorIyMgICAgICAgPEdFTj4g
IGlzIGdlbl9oZWxwZXJfQTJfYWRkKFJkViwgY3B1X2VudiwgUnNWLCBSdFYpOworIyMKK2RlZiBn
ZW5fdGNnX2Z1bmMoZiwgdGFnLCByZWdzLCBpbW1zKToKKyAgICBmLndyaXRlKCJzdGF0aWMgdm9p
ZCBnZW5lcmF0ZV8lcyhcbiIgJXRhZykKKyAgICBmLndyaXRlKCIgICAgICAgICAgICAgICAgQ1BV
SGV4YWdvblN0YXRlICplbnYsXG4iKQorICAgIGYud3JpdGUoIiAgICAgICAgICAgICAgICBEaXNh
c0NvbnRleHQgKmN0eCxcbiIpCisgICAgZi53cml0ZSgiICAgICAgICAgICAgICAgIEluc24gKmlu
c24sXG4iKQorICAgIGYud3JpdGUoIiAgICAgICAgICAgICAgICBQYWNrZXQgKnBrdClcbiIpCisg
ICAgZi53cml0ZSgne1xuJykKKyAgICBpZiBuZWVkX2VhKHRhZyk6IGdlbl9kZWNsX2VhX3RjZyhm
LCB0YWcpCisgICAgaT0wCisgICAgIyMgRGVjbGFyZSBhbGwgdGhlIG9wZXJhbmRzIChyZWdzIGFu
ZCBpbW1lZGlhdGVzKQorICAgIGZvciByZWd0eXBlLHJlZ2lkLHRvc3MsbnVtcmVncyBpbiByZWdz
OgorICAgICAgICBnZW5wdHJfZGVjbF9vcG4oZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgdG9zcywg
bnVtcmVncywgaSkKKyAgICAgICAgaSArPSAxCisgICAgZm9yIGltbWxldHQsYml0cyxpbW1zaGlm
dCBpbiBpbW1zOgorICAgICAgICBnZW5wdHJfZGVjbF9pbW0oZixpbW1sZXR0KQorCisgICAgaWYg
J0FfUFJJVicgaW4gYXR0cmliZGljdFt0YWddOgorICAgICAgICBmLndyaXRlKCcgICAgZkNIRUNL
Rk9SUFJJVigpO1xuJykKKyAgICBpZiAnQV9HVUVTVCcgaW4gYXR0cmliZGljdFt0YWddOgorICAg
ICAgICBmLndyaXRlKCcgICAgZkNIRUNLRk9SR1VFU1QoKTtcbicpCisKKyAgICAjIyBSZWFkIGFs
bCB0aGUgaW5wdXRzCisgICAgZm9yIHJlZ3R5cGUscmVnaWQsdG9zcyxudW1yZWdzIGluIHJlZ3M6
CisgICAgICAgIGlmIChpc19yZWFkKHJlZ2lkKSk6CisgICAgICAgICAgICBnZW5wdHJfc3JjX3Jl
YWRfb3BuKGYscmVndHlwZSxyZWdpZCx0YWcpCisKKyAgICBpZiAoIHNraXBfcWVtdV9oZWxwZXIo
dGFnKSApOgorICAgICAgICBmLndyaXRlKCIgICAgZkdFTl9UQ0dfJXMoJXMpO1xuIiAlICh0YWcs
IHNlbWRpY3RbdGFnXSkpCisgICAgZWxzZToKKyAgICAgICAgIyMgR2VuZXJhdGUgdGhlIGNhbGwg
dG8gdGhlIGhlbHBlcgorICAgICAgICBmb3IgaW1tbGV0dCxiaXRzLGltbXNoaWZ0IGluIGltbXM6
CisgICAgICAgICAgICBnZW5faGVscGVyX2RlY2xfaW1tKGYsaW1tbGV0dCkKKyAgICAgICAgaWYg
bmVlZF9wYXJ0MSh0YWcpOgorICAgICAgICAgICAgZi53cml0ZSgiICAgIFRDR3YgcGFydDEgPSB0
Y2dfY29uc3RfdGwoaW5zbi0+cGFydDEpO1xuIikKKyAgICAgICAgaWYgbmVlZF9zbG90KHRhZyk6
CisgICAgICAgICAgICBmLndyaXRlKCIgICAgVENHdiBzbG90ID0gdGNnX2NvbnN0X3RsKGluc24t
PnNsb3QpO1xuIikKKyAgICAgICAgZi53cml0ZSgiICAgIGdlbl9oZWxwZXJfJXMoIiAlICh0YWcp
KQorICAgICAgICBpPTAKKyAgICAgICAgIyMgSWYgdGhlcmUgaXMgYSBzY2FsYXIgcmVzdWx0LCBp
dCBpcyB0aGUgcmV0dXJuIHR5cGUKKyAgICAgICAgZm9yIHJlZ3R5cGUscmVnaWQsdG9zcyxudW1y
ZWdzIGluIHJlZ3M6CisgICAgICAgICAgICBpZiAoaXNfd3JpdHRlbihyZWdpZCkpOgorICAgICAg
ICAgICAgICAgIGdlbl9oZWxwZXJfY2FsbF9vcG4oZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgdG9z
cywgbnVtcmVncywgaSkKKyAgICAgICAgICAgICAgICBpICs9IDEKKyAgICAgICAgaWYgKGkgPiAw
KTogZi53cml0ZSgiLCAiKQorICAgICAgICBmLndyaXRlKCJjcHVfZW52IikKKyAgICAgICAgaT0x
CisgICAgICAgIGZvciByZWd0eXBlLHJlZ2lkLHRvc3MsbnVtcmVncyBpbiByZWdzOgorICAgICAg
ICAgICAgaWYgKGlzX3JlYWQocmVnaWQpKToKKyAgICAgICAgICAgICAgICBnZW5faGVscGVyX2Nh
bGxfb3BuKGYsIHRhZywgcmVndHlwZSwgcmVnaWQsIHRvc3MsIG51bXJlZ3MsIGkpCisgICAgICAg
ICAgICAgICAgaSArPSAxCisgICAgICAgIGZvciBpbW1sZXR0LGJpdHMsaW1tc2hpZnQgaW4gaW1t
czoKKyAgICAgICAgICAgIGdlbl9oZWxwZXJfY2FsbF9pbW0oZixpbW1sZXR0KQorCisgICAgICAg
IGlmIG5lZWRfc2xvdCh0YWcpOiBmLndyaXRlKCIsIHNsb3QiKQorICAgICAgICBpZiBuZWVkX3Bh
cnQxKHRhZyk6IGYud3JpdGUoIiwgcGFydDEiICkKKyAgICAgICAgZi53cml0ZSgiKTtcbiIpCisg
ICAgICAgIGlmIG5lZWRfc2xvdCh0YWcpOgorICAgICAgICAgICAgZi53cml0ZSgiICAgIHRjZ190
ZW1wX2ZyZWUoc2xvdCk7XG4iKQorICAgICAgICBpZiBuZWVkX3BhcnQxKHRhZyk6CisgICAgICAg
ICAgICBmLndyaXRlKCIgICAgdGNnX3RlbXBfZnJlZShwYXJ0MSk7XG4iKQorICAgICAgICBmb3Ig
aW1tbGV0dCxiaXRzLGltbXNoaWZ0IGluIGltbXM6CisgICAgICAgICAgICBnZW5faGVscGVyX2Zy
ZWVfaW1tKGYsaW1tbGV0dCkKKworICAgICMjIFdyaXRlIGFsbCB0aGUgb3V0cHV0cworICAgIGZv
ciByZWd0eXBlLHJlZ2lkLHRvc3MsbnVtcmVncyBpbiByZWdzOgorICAgICAgICBpZiAoaXNfd3Jp
dHRlbihyZWdpZCkpOgorICAgICAgICAgICAgZ2VucHRyX2RzdF93cml0ZV9vcG4oZixyZWd0eXBl
LCByZWdpZCwgdGFnKQorCisgICAgIyMgRnJlZSBhbGwgdGhlIG9wZXJhbmRzIChyZWdzIGFuZCBp
bW1lZGlhdGVzKQorICAgIGlmIG5lZWRfZWEodGFnKTogZ2VuX2ZyZWVfZWFfdGNnKGYpCisgICAg
Zm9yIHJlZ3R5cGUscmVnaWQsdG9zcyxudW1yZWdzIGluIHJlZ3M6CisgICAgICAgIGdlbnB0cl9m
cmVlX29wbihmLHJlZ3R5cGUscmVnaWQsaSx0YWcpCisgICAgICAgIGkgKz0gMQorCisgICAgZi53
cml0ZSgifVxuXG4iKQorCitkZWYgZ2VuX2RlZl90Y2dfZnVuYyhmLCB0YWcsIHRhZ3JlZ3MsIHRh
Z2ltbXMpOgorICAgIHJlZ3MgPSB0YWdyZWdzW3RhZ10KKyAgICBpbW1zID0gdGFnaW1tc1t0YWdd
CisKKyAgICBnZW5fdGNnX2Z1bmMoZiwgdGFnLCByZWdzLCBpbW1zKQorCitkZWYgbWFpbigpOgor
ICAgIHJlYWRfc2VtYW50aWNzX2ZpbGUoc3lzLmFyZ3ZbMV0pCisgICAgcmVhZF9hdHRyaWJzX2Zp
bGUoc3lzLmFyZ3ZbMl0pCisgICAgcmVhZF9vdmVycmlkZXNfZmlsZShzeXMuYXJndlszXSkKKyAg
ICBjYWxjdWxhdGVfYXR0cmlicygpCisgICAgdGFncmVncyA9IGdldF90YWdyZWdzKCkKKyAgICB0
YWdpbW1zID0gZ2V0X3RhZ2ltbXMoKQorCisgICAgZiA9IFN0cmluZ0lPKCkKKworICAgIGYud3Jp
dGUoIiNpZm5kZWYgSEVYQUdPTl9UQ0dfRlVOQ1NfSFxuIikKKyAgICBmLndyaXRlKCIjZGVmaW5l
IEhFWEFHT05fVENHX0ZVTkNTX0hcblxuIikKKworICAgIGZvciB0YWcgaW4gdGFnczoKKyAgICAg
ICAgIyMgU2tpcCB0aGUgcHJpdiBpbnN0cnVjdGlvbnMKKyAgICAgICAgaWYgKCAiQV9QUklWIiBp
biBhdHRyaWJkaWN0W3RhZ10gKSA6CisgICAgICAgICAgICBjb250aW51ZQorICAgICAgICAjIyBT
a2lwIHRoZSBndWVzdCBpbnN0cnVjdGlvbnMKKyAgICAgICAgaWYgKCAiQV9HVUVTVCIgaW4gYXR0
cmliZGljdFt0YWddICkgOgorICAgICAgICAgICAgY29udGludWUKKyAgICAgICAgIyMgU2tpcCB0
aGUgZGlhZyBpbnN0cnVjdGlvbnMKKyAgICAgICAgaWYgKCB0YWcgPT0gIlk2X2RpYWciICkgOgor
ICAgICAgICAgICAgY29udGludWUKKyAgICAgICAgaWYgKCB0YWcgPT0gIlk2X2RpYWcwIiApIDoK
KyAgICAgICAgICAgIGNvbnRpbnVlCisgICAgICAgIGlmICggdGFnID09ICJZNl9kaWFnMSIgKSA6
CisgICAgICAgICAgICBjb250aW51ZQorCisgICAgICAgIGdlbl9kZWZfdGNnX2Z1bmMoZiwgdGFn
LCB0YWdyZWdzLCB0YWdpbW1zKQorCisgICAgZi53cml0ZSgiI2VuZGlmICAgIC8qIEhFWEFHT05f
VENHX0ZVTkNTX0ggKi9cbiIpCisKKyAgICByZWFsZiA9IG9wZW4oc3lzLmFyZ3ZbNF0sICd3JykK
KyAgICByZWFsZi53cml0ZShmLmdldHZhbHVlKCkpCisgICAgcmVhbGYuY2xvc2UoKQorICAgIGYu
Y2xvc2UoKQorCitpZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgorICAgIG1haW4oKQpkaWZmIC0t
Z2l0IGEvdGFyZ2V0L2hleGFnb24vaGV4X2NvbW1vbi5weSBiL3RhcmdldC9oZXhhZ29uL2hleF9j
b21tb24ucHkKbmV3IGZpbGUgbW9kZSAxMDA3NTUKaW5kZXggMDAwMDAwMC4uMjZmOTYyNAotLS0g
L2Rldi9udWxsCisrKyBiL3RhcmdldC9oZXhhZ29uL2hleF9jb21tb24ucHkKQEAgLTAsMCArMSwy
MTYgQEAKKyMhL3Vzci9iaW4vZW52IHB5dGhvbjMKKworIyMKKyMjICBDb3B5cmlnaHQoYykgMjAx
OS0yMDIwIFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2
ZWQuCisjIworIyMgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlz
dHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CisjIyAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBH
TlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKKyMjICB0aGUgRnJlZSBT
b2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvcgor
IyMgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisjIworIyMgIFRoaXMgcHJv
Z3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAor
IyMgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdh
cnJhbnR5IG9mCisjIyAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxB
UiBQVVJQT1NFLiAgU2VlIHRoZQorIyMgIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBt
b3JlIGRldGFpbHMuCisjIworIyMgIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2Yg
dGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCisjIyAgYWxvbmcgd2l0aCB0aGlzIHByb2dy
YW07IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KKyMjCisKK2lt
cG9ydCBzeXMKK2ltcG9ydCByZQoraW1wb3J0IHN0cmluZworZnJvbSBpbyBpbXBvcnQgU3RyaW5n
SU8KKworYmVoZGljdCA9IHt9ICAgICAgICAgICMgdGFnIC0+YmVoYXZpb3IKK3NlbWRpY3QgPSB7
fSAgICAgICAgICAjIHRhZyAtPiBzZW1hbnRpY3MKK2F0dHJpYmRpY3QgPSB7fSAgICAgICAjIHRh
ZyAtPiBhdHRyaWJ1dGVzCittYWNyb3MgPSB7fSAgICAgICAgICAgIyBtYWNybyAtPiBtYWNybyBp
bmZvcm1hdGlvbi4uLgorYXR0cmliaW5mbyA9IHt9ICAgICAgICMgUmVnaXN0ZXIgaW5mb3JtYXRp
b24gYW5kIG1pc2MKK3RhZ3MgPSBbXSAgICAgICAgICAgICAjIGxpc3Qgb2YgYWxsIHRhZ3MKK292
ZXJyaWRlcyA9IHt9ICAgICAgICAjIHRhZ3Mgd2l0aCBoZWxwZXIgb3ZlcnJpZGVzCisKKyMgV2Ug
c2hvdWxkIGRvIHRoaXMgYXMgYSBoYXNoIGZvciBwZXJmb3JtYW5jZSwKKyMgYnV0IHRvIGtlZXAg
b3JkZXIgbGV0J3Mga2VlcCBpdCBhcyBhIGxpc3QuCitkZWYgdW5pcXVpZnkoc2VxKToKKyAgICBz
ZWVuID0gc2V0KCkKKyAgICBzZWVuX2FkZCA9IHNlZW4uYWRkCisgICAgcmV0dXJuIFt4IGZvciB4
IGluIHNlcSBpZiB4IG5vdCBpbiBzZWVuIGFuZCBub3Qgc2Vlbl9hZGQoeCldCisKK3JlZ3JlID0g
cmUuY29tcGlsZSgKKyAgICByIigoPzwhRFVQKVtNTk9SQ1BRWFNHVlpBXSkoW3N0dXZ3eHl6ZGVm
Z10rKShbLl0/W0xsSGhdPykoXGQrUz8pIikKK2ltbXJlID0gcmUuY29tcGlsZShyIlsjXShbclJz
U3VVbV0pKFxkKykoPzpbOl0oXGQrKSk/IikKK3JlZ19vcl9pbW1yZSA9IFwKKyAgICByZS5jb21w
aWxlKHIiKCgoPzwhRFVQKVtNTlJDT1BRWFNHVlpBXSkoW3N0dXZ3eHl6ZGVmZ10rKSIgKyBcCisg
ICAgICAgICAgICAgICAgIihbLl0/W0xsSGhdPykoXGQrUz8pKXwoWyNdKFtyUnNTdVVtXSkoXGQr
KVs6XT8oXGQrKT8pIikKK3JlbGltbXJlID0gcmUuY29tcGlsZShyIlsjXShbclJdKShcZCspKD86
WzpdKFxkKykpPyIpCithYnNpbW1yZSA9IHJlLmNvbXBpbGUociJbI10oW3NTdVVtXSkoXGQrKSg/
Ols6XShcZCspKT8iKQorCitmaW5pc2hlZF9tYWNyb3MgPSBzZXQoKQorCitkZWYgZXhwYW5kX21h
Y3JvX2F0dHJpYnMobWFjcm8sYWxsbWFjX3JlKToKKyAgICBpZiBtYWNyby5rZXkgbm90IGluIGZp
bmlzaGVkX21hY3JvczoKKyAgICAgICAgIyBHZXQgYSBsaXN0IG9mIGFsbCB0aGluZ3MgdGhhdCBt
aWdodCBiZSBtYWNyb3MKKyAgICAgICAgbCA9IGFsbG1hY19yZS5maW5kYWxsKG1hY3JvLmJlaCkK
KyAgICAgICAgZm9yIHN1Ym1hY3JvIGluIGw6CisgICAgICAgICAgICBpZiBub3Qgc3VibWFjcm86
IGNvbnRpbnVlCisgICAgICAgICAgICBpZiBub3QgbWFjcm9zW3N1Ym1hY3JvXToKKyAgICAgICAg
ICAgICAgICByYWlzZSBFeGNlcHRpb24oIkNvdWxkbid0IGZpbmQgbWFjcm86IDwlcz4iICUgbCkK
KyAgICAgICAgICAgIG1hY3JvLmF0dHJpYnMgfD0gZXhwYW5kX21hY3JvX2F0dHJpYnMoCisgICAg
ICAgICAgICAgICAgbWFjcm9zW3N1Ym1hY3JvXSwgYWxsbWFjX3JlKQorICAgICAgICAgICAgZmlu
aXNoZWRfbWFjcm9zLmFkZChtYWNyby5rZXkpCisgICAgcmV0dXJuIG1hY3JvLmF0dHJpYnMKKwor
aW1tZXh0cmUgPSByZS5jb21waWxlKHInZihNVVNUXyk/SU1NRVhUWyhdKFtVdVNzUnJdKScpCitk
ZWYgY2FsY3VsYXRlX2F0dHJpYnMoKToKKyAgICAjIFJlY3Vyc2UgZG93biBtYWNyb3MsIGZpbmQg
YXR0cmlidXRlcyBmcm9tIHN1Yi1tYWNyb3MKKyAgICBtYWNyb1ZhbHVlcyA9IGxpc3QobWFjcm9z
LnZhbHVlcygpKQorICAgIGFsbG1hY3Jvc19yZXN0ciA9ICJ8Ii5qb2luKHNldChbIG0ucmUucGF0
dGVybiBmb3IgbSBpbiBtYWNyb1ZhbHVlcyBdKSkKKyAgICBhbGxtYWNyb3NfcmUgPSByZS5jb21w
aWxlKGFsbG1hY3Jvc19yZXN0cikKKyAgICBmb3IgbWFjcm8gaW4gbWFjcm9WYWx1ZXM6CisgICAg
ICAgIGV4cGFuZF9tYWNyb19hdHRyaWJzKG1hY3JvLGFsbG1hY3Jvc19yZSkKKyAgICAjIEFwcGVu
ZCBhdHRyaWJ1dGVzIHRvIGFsbCBpbnN0cnVjdGlvbnMKKyAgICBmb3IgdGFnIGluIHRhZ3M6Cisg
ICAgICAgIGZvciBtYWNuYW1lIGluIGFsbG1hY3Jvc19yZS5maW5kYWxsKHNlbWRpY3RbdGFnXSk6
CisgICAgICAgICAgICBpZiBub3QgbWFjbmFtZTogY29udGludWUKKyAgICAgICAgICAgIG1hY3Jv
ID0gbWFjcm9zW21hY25hbWVdCisgICAgICAgICAgICBhdHRyaWJkaWN0W3RhZ10gfD0gc2V0KG1h
Y3JvLmF0dHJpYnMpCisKK2RlZiBTRU1BTlRJQ1ModGFnLCBiZWgsIHNlbSk6CisgICAgI3ByaW50
IHRhZyxiZWgsc2VtCisgICAgYmVoZGljdFt0YWddID0gYmVoCisgICAgc2VtZGljdFt0YWddID0g
c2VtCisgICAgYXR0cmliZGljdFt0YWddID0gc2V0KCkKKyAgICB0YWdzLmFwcGVuZCh0YWcpICAg
ICAgICAjIGRpY3RzIGhhdmUgbm8gb3JkZXIsIHRoaXMgaXMgZm9yIG9yZGVyCisKK2RlZiBBVFRS
SUJVVEVTKHRhZywgYXR0cmlic3RyaW5nKToKKyAgICBhdHRyaWJzdHJpbmcgPSBcCisgICAgICAg
IGF0dHJpYnN0cmluZy5yZXBsYWNlKCJBVFRSSUJTIiwiIikucmVwbGFjZSgiKCIsIiIpLnJlcGxh
Y2UoIikiLCIiKQorICAgIGlmIG5vdCBhdHRyaWJzdHJpbmc6CisgICAgICAgIHJldHVybgorICAg
IGF0dHJpYnMgPSBhdHRyaWJzdHJpbmcuc3BsaXQoIiwiKQorICAgIGZvciBhdHRyaWIgaW4gYXR0
cmliczoKKyAgICAgICAgYXR0cmliZGljdFt0YWddLmFkZChhdHRyaWIuc3RyaXAoKSkKKworY2xh
c3MgTWFjcm8ob2JqZWN0KToKKyAgICBfX3Nsb3RzX18gPSBbJ2tleScsJ25hbWUnLCAnYmVoJywg
J2F0dHJpYnMnLCAncmUnXQorICAgIGRlZiBfX2luaXRfXyhzZWxmLCBuYW1lLCBiZWgsIGF0dHJp
YnMpOgorICAgICAgICBzZWxmLmtleSA9IG5hbWUKKyAgICAgICAgc2VsZi5uYW1lID0gbmFtZQor
ICAgICAgICBzZWxmLmJlaCA9IGJlaAorICAgICAgICBzZWxmLmF0dHJpYnMgPSBzZXQoYXR0cmli
cykKKyAgICAgICAgc2VsZi5yZSA9IHJlLmNvbXBpbGUoIlxcYiIgKyBuYW1lICsgIlxcYiIpCisK
K2RlZiBNQUNST0FUVFJJQihtYWNuYW1lLGJlaCxhdHRyaWJzdHJpbmcpOgorICAgIGF0dHJpYnN0
cmluZyA9IGF0dHJpYnN0cmluZy5yZXBsYWNlKCIoIiwiIikucmVwbGFjZSgiKSIsIiIpCisgICAg
aWYgYXR0cmlic3RyaW5nOgorICAgICAgICBhdHRyaWJzID0gYXR0cmlic3RyaW5nLnNwbGl0KCIs
IikKKyAgICBlbHNlOgorICAgICAgICBhdHRyaWJzID0gW10KKyAgICBtYWNyb3NbbWFjbmFtZV0g
PSBNYWNybyhtYWNuYW1lLGJlaCxhdHRyaWJzKQorCitkZWYgY29tcHV0ZV90YWdfcmVncyh0YWcp
OgorICAgIHJldHVybiB1bmlxdWlmeShyZWdyZS5maW5kYWxsKGJlaGRpY3RbdGFnXSkpCisKK2Rl
ZiBjb21wdXRlX3RhZ19pbW1lZGlhdGVzKHRhZyk6CisgICAgcmV0dXJuIHVuaXF1aWZ5KGltbXJl
LmZpbmRhbGwoYmVoZGljdFt0YWddKSkKKworIyMKKyMjICB0YWdyZWdzIGlzIHRoZSBtYWluIGRh
dGEgc3RydWN0dXJlIHdlJ2xsIHVzZQorIyMgIHRhZ3JlZ3NbdGFnXSB3aWxsIGNvbnRhaW4gdGhl
IHJlZ2lzdGVycyB1c2VkIGJ5IGFuIGluc3RydWN0aW9uCisjIyAgV2l0aGluIGVhY2ggZW50cnks
IHdlJ2xsIHVzZSB0aGUgcmVndHlwZSBhbmQgcmVnaWQgZmllbGRzCisjIyAgICAgIHJlZ3R5cGUg
Y2FuIGJlIG9uZSBvZiB0aGUgZm9sbG93aW5nCisjIyAgICAgICAgICBDICAgICAgICAgICAgICAg
IGNvbnRyb2wgcmVnaXN0ZXIKKyMjICAgICAgICAgIE4gICAgICAgICAgICAgICAgbmV3IHJlZ2lz
dGVyIHZhbHVlCisjIyAgICAgICAgICBQICAgICAgICAgICAgICAgIHByZWRpY2F0ZSByZWdpc3Rl
cgorIyMgICAgICAgICAgUiAgICAgICAgICAgICAgICBHUFIgcmVnaXN0ZXIKKyMjICAgICAgICAg
IE0gICAgICAgICAgICAgICAgbW9kaWZpZXIgcmVnaXN0ZXIKKyMjICAgICAgcmVnaWQgY2FuIGJl
IG9uZSBvZiB0aGUgZm9sbG93aW5nCisjIyAgICAgICAgICBkLCBlICAgICAgICAgICAgIGRlc3Rp
bmF0aW9uIHJlZ2lzdGVyCisjIyAgICAgICAgICBkZCAgICAgICAgICAgICAgIGRlc3RpbmF0aW9u
IHJlZ2lzdGVyIHBhaXIKKyMjICAgICAgICAgIHMsIHQsIHUsIHYsIHcgICAgc291cmNlIHJlZ2lz
dGVyCisjIyAgICAgICAgICBzcywgdHQsIHV1LCB2diAgIHNvdXJjZSByZWdpc3RlciBwYWlyCisj
IyAgICAgICAgICB4LCB5ICAgICAgICAgICAgIHJlYWQtd3JpdGUgcmVnaXN0ZXIKKyMjICAgICAg
ICAgIHh4LCB5eSAgICAgICAgICAgcmVhZC13cml0ZSByZWdpc3RlciBwYWlyCisjIworZGVmIGdl
dF90YWdyZWdzKCk6CisgICAgcmV0dXJuIGRpY3QoemlwKHRhZ3MsIGxpc3QobWFwKGNvbXB1dGVf
dGFnX3JlZ3MsIHRhZ3MpKSkpCisKK2RlZiBnZXRfdGFnaW1tcygpOgorICAgIHJldHVybiBkaWN0
KHppcCh0YWdzLCBsaXN0KG1hcChjb21wdXRlX3RhZ19pbW1lZGlhdGVzLCB0YWdzKSkpKQorCitk
ZWYgaXNfcGFpcihyZWdpZCk6CisgICAgcmV0dXJuIGxlbihyZWdpZCkgPT0gMgorCitkZWYgaXNf
c2luZ2xlKHJlZ2lkKToKKyAgICByZXR1cm4gbGVuKHJlZ2lkKSA9PSAxCisKK2RlZiBpc193cml0
dGVuKHJlZ2lkKToKKyAgICByZXR1cm4gcmVnaWRbMF0gaW4gImRleHkiCisKK2RlZiBpc193cml0
ZW9ubHkocmVnaWQpOgorICAgIHJldHVybiByZWdpZFswXSBpbiAiZGUiCisKK2RlZiBpc19yZWFk
KHJlZ2lkKToKKyAgICByZXR1cm4gcmVnaWRbMF0gaW4gInN0dXZ3eHkiCisKK2RlZiBpc19yZWFk
d3JpdGUocmVnaWQpOgorICAgIHJldHVybiByZWdpZFswXSBpbiAieHkiCisKK2RlZiBpc19zY2Fs
YXJfcmVnKHJlZ3R5cGUpOgorICAgIHJldHVybiByZWd0eXBlIGluICJSUEMiCisKK2RlZiBpc19v
bGRfdmFsKHJlZ3R5cGUsIHJlZ2lkLCB0YWcpOgorICAgIHJldHVybiByZWd0eXBlK3JlZ2lkKydW
JyBpbiBzZW1kaWN0W3RhZ10KKworZGVmIGlzX25ld192YWwocmVndHlwZSwgcmVnaWQsIHRhZyk6
CisgICAgcmV0dXJuIHJlZ3R5cGUrcmVnaWQrJ04nIGluIHNlbWRpY3RbdGFnXQorCitkZWYgbmVl
ZF9zbG90KHRhZyk6CisgICAgaWYgKCdBX0NPTkRFWEVDJyBpbiBhdHRyaWJkaWN0W3RhZ10gb3IK
KyAgICAgICAgJ0FfU1RPUkUnIGluIGF0dHJpYmRpY3RbdGFnXSBvcgorICAgICAgICAnQV9MT0FE
JyBpbiBhdHRyaWJkaWN0W3RhZ10pOgorICAgICAgICByZXR1cm4gMQorICAgIGVsc2U6CisgICAg
ICAgIHJldHVybiAwCisKK2RlZiBuZWVkX3BhcnQxKHRhZyk6CisgICAgcmV0dXJuIHJlLmNvbXBp
bGUociJmUEFSVDEiKS5zZWFyY2goc2VtZGljdFt0YWddKQorCitkZWYgbmVlZF9lYSh0YWcpOgor
ICAgIHJldHVybiByZS5jb21waWxlKHIiXGJFQVxiIikuc2VhcmNoKHNlbWRpY3RbdGFnXSkKKwor
ZGVmIHNraXBfcWVtdV9oZWxwZXIodGFnKToKKyAgICByZXR1cm4gdGFnIGluIG92ZXJyaWRlcy5r
ZXlzKCkKKworZGVmIGltbV9uYW1lKGltbWxldHQpOgorICAgIHJldHVybiAiJXNpViIgJSBpbW1s
ZXR0CisKK2RlZiByZWFkX3NlbWFudGljc19maWxlKG5hbWUpOgorICAgIGV2YWxfbGluZSA9ICIi
CisgICAgZm9yIGxpbmUgaW4gb3BlbihuYW1lLCAncnQnKS5yZWFkbGluZXMoKToKKyAgICAgICAg
aWYgbm90IGxpbmUuc3RhcnRzd2l0aCgiIyIpOgorICAgICAgICAgICAgZXZhbF9saW5lICs9IGxp
bmUKKyAgICAgICAgICAgIGlmIGxpbmUuZW5kc3dpdGgoIlxcXG4iKToKKyAgICAgICAgICAgICAg
ICBldmFsX2xpbmUucnN0cmlwKCJcXFxuIikKKyAgICAgICAgICAgIGVsc2U6CisgICAgICAgICAg
ICAgICAgZXZhbChldmFsX2xpbmUuc3RyaXAoKSkKKyAgICAgICAgICAgICAgICBldmFsX2xpbmUg
PSAiIgorCitkZWYgcmVhZF9hdHRyaWJzX2ZpbGUobmFtZSk6CisgICAgYXR0cmlicmUgPSByZS5j
b21waWxlKHInREVGX0FUVFJJQlwoKFtBLVphLXowLTlfXSspLCAoW14sXSopLCAnICsKKyAgICAg
ICAgICAgIHInIihbQS1aYS16MC05X1wuXSopIiwgIihbQS1aYS16MC05X1wuXSopIlwpJykKKyAg
ICBmb3IgbGluZSBpbiBvcGVuKG5hbWUsICdydCcpLnJlYWRsaW5lcygpOgorICAgICAgICBpZiBu
b3QgYXR0cmlicmUubWF0Y2gobGluZSk6CisgICAgICAgICAgICBjb250aW51ZQorICAgICAgICAo
YXR0cmliX2Jhc2UsZGVzY3IscnJlZyx3cmVnKSA9IGF0dHJpYnJlLmZpbmRhbGwobGluZSlbMF0K
KyAgICAgICAgYXR0cmliX2Jhc2UgPSAnQV8nICsgYXR0cmliX2Jhc2UKKyAgICAgICAgYXR0cmli
aW5mb1thdHRyaWJfYmFzZV0gPSB7J3JyZWcnOnJyZWcsICd3cmVnJzp3cmVnLCAnZGVzY3InOmRl
c2NyfQorCitkZWYgcmVhZF9vdmVycmlkZXNfZmlsZShuYW1lKToKKyAgICBvdmVycmlkZXJlID0g
cmUuY29tcGlsZSgiI2RlZmluZSBmR0VOX1RDR18oW0EtWmEtejAtOV9dKylcKC4qIikKKyAgICBm
b3IgbGluZSBpbiBvcGVuKG5hbWUsICdydCcpLnJlYWRsaW5lcygpOgorICAgICAgICBpZiBub3Qg
b3ZlcnJpZGVyZS5tYXRjaChsaW5lKToKKyAgICAgICAgICAgIGNvbnRpbnVlCisgICAgICAgIHRh
ZyA9IG92ZXJyaWRlcmUuZmluZGFsbChsaW5lKVswXQorICAgICAgICBvdmVycmlkZXNbdGFnXSA9
IFRydWUKLS0gCjIuNy40Cgo=

