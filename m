Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id 1219065F6B9
	for <lists+qemu-devel@lfdr.de>; Thu,  5 Jan 2023 23:26:17 +0100 (CET)
Received: from localhost ([::1] helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces@nongnu.org>)
	id 1pDYUe-00072t-0u; Thu, 05 Jan 2023 17:13:48 -0500
Received: from eggs.gnu.org ([2001:470:142:3::10])
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1pDYUa-0006zv-Nv
 for qemu-devel@nongnu.org; Thu, 05 Jan 2023 17:13:44 -0500
Received: from mx0a-0031df01.pphosted.com ([205.220.168.131])
 by eggs.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1pDYUU-00028G-Jg
 for qemu-devel@nongnu.org; Thu, 05 Jan 2023 17:13:44 -0500
Received: from pps.filterd (m0279863.ppops.net [127.0.0.1])
 by mx0a-0031df01.pphosted.com (8.17.1.19/8.17.1.19) with ESMTP id
 305EuIPm009390; Thu, 5 Jan 2023 22:13:36 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=quicinc.com;
 h=from : to : cc :
 subject : date : message-id : in-reply-to : references : mime-version :
 content-type : content-transfer-encoding; s=qcppdkim1;
 bh=/X95UmrrnyrNxZL7P8tu+335gayQxA3I0PM8ZfMkf7A=;
 b=eBGI+ILq1FS3pWkKoTL656ZCO26GsRJ4aK//vOWUnU5A1DCq+bDQTo/8RMsEa1Q4uncn
 YUX4QYlclC6xIcFORGZbI3wJy8uTh5ATSaCCYJu7kpdMUI+w6yGBdUojRK1co52HfdYH
 mZzoQ4ZCGTJrWILQf4kjeoa7dk0jqWJm0iAgIUJYRzlMuIWdrymfES0ABQXo50b2LIHn
 oDMdK00d+d8GZf14FHTtsEQMtHpc34jGag/QDCT9Ab4fht3x9l7GQVNoFGpqenRZPn9n
 Hhnvl1L3lmUHzxdtEq2KN/MzodnQaU48ANMer2rpafMLgIaMVjN2x3gzbwW5BE06yZiE 1w== 
Received: from nalasppmta04.qualcomm.com (Global_NAT1.qualcomm.com
 [129.46.96.20])
 by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 3mwpwnt16n-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Thu, 05 Jan 2023 22:13:36 +0000
Received: from pps.filterd (NALASPPMTA04.qualcomm.com [127.0.0.1])
 by NALASPPMTA04.qualcomm.com (8.17.1.5/8.17.1.5) with ESMTP id 305MDZRg027155; 
 Thu, 5 Jan 2023 22:13:35 GMT
Received: from pps.reinject (localhost [127.0.0.1])
 by NALASPPMTA04.qualcomm.com (PPS) with ESMTP id 3mx6kmg398-1;
 Thu, 05 Jan 2023 22:13:35 +0000
Received: from NALASPPMTA04.qualcomm.com (NALASPPMTA04.qualcomm.com
 [127.0.0.1])
 by pps.reinject (8.17.1.5/8.17.1.5) with ESMTP id 305MDZcr027149;
 Thu, 5 Jan 2023 22:13:35 GMT
Received: from hu-devc-lv-u18-c.qualcomm.com (hu-tsimpson-lv.qualcomm.com
 [10.47.235.220])
 by NALASPPMTA04.qualcomm.com (PPS) with ESMTP id 305MDYkS027145;
 Thu, 05 Jan 2023 22:13:35 +0000
Received: by hu-devc-lv-u18-c.qualcomm.com (Postfix, from userid 47164)
 id 41A1D5000B1; Thu,  5 Jan 2023 14:13:34 -0800 (PST)
From: Taylor Simpson <tsimpson@quicinc.com>
To: qemu-devel@nongnu.org
Cc: tsimpson@quicinc.com, richard.henderson@linaro.org, philmd@linaro.org,
 ale@rev.ng, anjo@rev.ng, bcain@quicinc.com, quic_mathbern@quicinc.com
Subject: [PATCH v3 5/9] Hexagon (target/hexagon) Analyze packet before
 generating TCG
Date: Thu,  5 Jan 2023 14:13:27 -0800
Message-Id: <20230105221331.12069-6-tsimpson@quicinc.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20230105221331.12069-1-tsimpson@quicinc.com>
References: <20230105221331.12069-1-tsimpson@quicinc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
X-QCInternal: smtphost
X-QCInternal: smtphost
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-ORIG-GUID: O0MHOTTyKGdjYX2Qz9Hi0HufW6RzLaII
X-Proofpoint-GUID: O0MHOTTyKGdjYX2Qz9Hi0HufW6RzLaII
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.205,Aquarius:18.0.923,Hydra:6.0.545,FMLib:17.11.122.1
 definitions=2023-01-05_12,2023-01-05_02,2022-06-22_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 mlxscore=0 mlxlogscore=851
 suspectscore=0 adultscore=0 lowpriorityscore=0 phishscore=0 spamscore=0
 malwarescore=0 priorityscore=1501 bulkscore=0 impostorscore=0
 clxscore=1015 classifier=spam adjust=0 reason=mlx scancount=1
 engine=8.12.0-2212070000 definitions=main-2301050174
Received-SPF: pass client-ip=205.220.168.131;
 envelope-from=tsimpson@qualcomm.com; helo=mx0a-0031df01.pphosted.com
X-Spam_score_int: -24
X-Spam_score: -2.5
X-Spam_bar: --
X-Spam_report: (-2.5 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, HEADER_FROM_DIFFERENT_DOMAINS=0.25,
 RCVD_IN_DNSWL_LOW=-0.7, SPF_HELO_NONE=0.001,
 SPF_PASS=-0.001 autolearn=ham autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org

V2UgY3JlYXRlIGEgbmV3IGdlbmVyYXRvciB0aGF0IGNyZWF0ZXMgYW4gYW5hbHl6ZV88dGFnPiBm
dW5jdGlvbiBmb3IKZWFjaCBpbnN0cnVjdGlvbi4gIEN1cnJlbnRseSwgdGhlc2UgZnVuY3Rpb25z
IHJlY29yZCB0aGUgd3JpdGVzIHRvClIsIFAsIGFuZCBDIHJlZ2lzdGVycyBieSBjYWxsaW5nIGN0
eF9sb2dfcmVnX3dyaXRlW19wYWlyXSBvcgpjdHhfbG9nX3ByZWRfd3JpdGUuCgpEdXJpbmcgZ2Vu
X3N0YXJ0X3BhY2tldCwgd2UgaW52b2tlIHRoZSBhbmFseXplXzx0YWc+IGZ1bmN0aW9uIGZvcgpl
YWNoIGluc3RydWN0aW9uIGluIHRoZSBwYWNrZXQsIGFuZCB3ZSBtYXJrIHRoZSBpbXBsaWNpdCBy
ZWdpc3RlcgphbmQgcHJlZGljYXRlIHdyaXRlcy4KCkRvaW5nIHRoZSBhbmFseXNpcyB1cCBmcm9u
dCBoYXMgc2V2ZXJhbCBhZHZhbnRhZ2VzCi0gV2UgcmVtb3ZlIGNhbGxzIHRvIGN0eF9sb2dfKiBm
cm9tIGdlbl90Y2dfZnVuY3MucHkgYW5kIGdlbnB0ci5jCi0gQWZ0ZXIgdGhlIGFuYWx5c2lzIGlz
IHBlcmZvcm1lZCwgd2UgY2FuIGluaXRpYWxpemUgaGV4X25ld192YWx1ZQogIGZvciBlYWNoIG9m
IHRoZSBwcmVkaWNhdGVkIGFzc2lnbm1lbnRzIHJhdGhlciB0aGFuIGR1cmluZyBUQ0cKICBnZW5l
cmF0aW9uIGZvciB0aGUgaW5zdHJ1Y3Rpb25zCi0gVGhpcyBpcyBhIHN0ZXBwaW5nIHN0b25lIGZv
ciBmdXR1cmUgd29yayB3aGVyZSB0aGUgYW5hbHlzaXMgd2lsbAogIGluY2x1ZGUgdGhlIHNldCBv
ZiByZWdpc3RlcnMgdGhhdCBhcmUgd3JpdHRlbi4gIEluIGNhc2VzIHdoZXJlCiAgdGhlIHBhY2tl
dCBkb2Vzbid0IGhhdmUgYW4gb3ZlcmxhcCBiZXR3ZWVuIHRoZSByZWdpc3RlcnMgdGhhdCBhcmUK
ICB3cml0dGVuIGFuZCByZWdpc3RlcnMgdGhhdCBhcmUgcmVhZCwgd2UgY2FuIGF2b2lkIHRoZSBp
bnRlcm1lZGlhdGUKICBzdGVwIG9mIHdyaXRpbmcgdG8gaGV4X25ld192YWx1ZS4gIE5vdGUgdGhh
dCBvdGhlciBjaGVja3Mgd2lsbCBhbHNvCiAgYmUgbmVlZGVkIChlLmcuLCBubyBpbnN0cnVjdGlv
bnMgY2FuIHJhaXNlIGFuIGV4Y2VwdGlvbikuCgpTaWduZWQtb2ZmLWJ5OiBUYXlsb3IgU2ltcHNv
biA8dHNpbXBzb25AcXVpY2luYy5jb20+Ci0tLQogdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmgg
ICAgICAgICAgICAgICAgICB8ICA0NiArKy0tCiB0YXJnZXQvaGV4YWdvbi9nZW5wdHIuYyAgICAg
ICAgICAgICAgICAgICAgIHwgICA1ICstCiB0YXJnZXQvaGV4YWdvbi9pZGVmLXBhcnNlci9wYXJz
ZXItaGVscGVycy5jIHwgICA3ICstCiB0YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuYyAgICAgICAg
ICAgICAgICAgIHwgMTU3ICsrKysrKystLS0tLS0KIHRhcmdldC9oZXhhZ29uL1JFQURNRSAgICAg
ICAgICAgICAgICAgICAgICAgfCAgMTEgKy0KIHRhcmdldC9oZXhhZ29uL2dlbl9hbmFseXplX2Z1
bmNfdGFibGUucHkgICAgfCAgNTIgKysrKysKIHRhcmdldC9oZXhhZ29uL2dlbl9hbmFseXplX2Z1
bmNzLnB5ICAgICAgICAgfCAyMzkgKysrKysrKysrKysrKysrKysrKysKIHRhcmdldC9oZXhhZ29u
L2dlbl90Y2dfZnVuY3MucHkgICAgICAgICAgICAgfCAgMjMgKy0KIHRhcmdldC9oZXhhZ29uL21l
c29uLmJ1aWxkICAgICAgICAgICAgICAgICAgfCAgMjAgKy0KIDkgZmlsZXMgY2hhbmdlZCwgNDQy
IGluc2VydGlvbnMoKyksIDExOCBkZWxldGlvbnMoLSkKIGNyZWF0ZSBtb2RlIDEwMDc1NSB0YXJn
ZXQvaGV4YWdvbi9nZW5fYW5hbHl6ZV9mdW5jX3RhYmxlLnB5CiBjcmVhdGUgbW9kZSAxMDA3NTUg
dGFyZ2V0L2hleGFnb24vZ2VuX2FuYWx5emVfZnVuY3MucHkKCmRpZmYgLS1naXQgYS90YXJnZXQv
aGV4YWdvbi90cmFuc2xhdGUuaCBiL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5oCmluZGV4IGQ5
NzFmNGYwOTUuLjdlODY0YjQxN2QgMTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0
ZS5oCisrKyBiL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5oCkBAIC0xLDUgKzEsNSBAQAogLyoK
LSAqICBDb3B5cmlnaHQoYykgMjAxOS0yMDIyIFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJ
bmMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCisgKiAgQ29weXJpZ2h0KGMpIDIwMTktMjAyMyBRdWFs
Y29tbSBJbm5vdmF0aW9uIENlbnRlciwgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogICoKICAq
ICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQg
YW5kL29yIG1vZGlmeQogICogIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwg
UHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5CkBAIC0zOCw2ICszOCw3IEBAIHR5cGVkZWYg
c3RydWN0IERpc2FzQ29udGV4dCB7CiAgICAgaW50IHJlZ19sb2dbUkVHX1dSSVRFU19NQVhdOwog
ICAgIGludCByZWdfbG9nX2lkeDsKICAgICBERUNMQVJFX0JJVE1BUChyZWdzX3dyaXR0ZW4sIFRP
VEFMX1BFUl9USFJFQURfUkVHUyk7CisgICAgREVDTEFSRV9CSVRNQVAocHJlZGljYXRlZF9yZWdz
LCBUT1RBTF9QRVJfVEhSRUFEX1JFR1MpOwogICAgIGludCBwcmVnX2xvZ1tQUkVEX1dSSVRFU19N
QVhdOwogICAgIGludCBwcmVnX2xvZ19pZHg7CiAgICAgREVDTEFSRV9CSVRNQVAocHJlZ3Nfd3Jp
dHRlbiwgTlVNX1BSRUdTKTsKQEAgLTYyLDMyICs2MywzOSBAQCB0eXBlZGVmIHN0cnVjdCBEaXNh
c0NvbnRleHQgewogICAgIGJvb2wgaXNfdGlnaHRfbG9vcDsKIH0gRGlzYXNDb250ZXh0OwogCi1z
dGF0aWMgaW5saW5lIHZvaWQgY3R4X2xvZ19yZWdfd3JpdGUoRGlzYXNDb250ZXh0ICpjdHgsIGlu
dCBybnVtKQorc3RhdGljIGlubGluZSB2b2lkIGN0eF9sb2dfcHJlZF93cml0ZShEaXNhc0NvbnRl
eHQgKmN0eCwgaW50IHBudW0pCiB7Ci0gICAgaWYgKHRlc3RfYml0KHJudW0sIGN0eC0+cmVnc193
cml0dGVuKSkgewotICAgICAgICBIRVhfREVCVUdfTE9HKCJXQVJOSU5HOiBNdWx0aXBsZSB3cml0
ZXMgdG8gciVkXG4iLCBybnVtKTsKKyAgICBpZiAoIXRlc3RfYml0KHBudW0sIGN0eC0+cHJlZ3Nf
d3JpdHRlbikpIHsKKyAgICAgICAgY3R4LT5wcmVnX2xvZ1tjdHgtPnByZWdfbG9nX2lkeF0gPSBw
bnVtOworICAgICAgICBjdHgtPnByZWdfbG9nX2lkeCsrOworICAgICAgICBzZXRfYml0KHBudW0s
IGN0eC0+cHJlZ3Nfd3JpdHRlbik7CiAgICAgfQotICAgIGN0eC0+cmVnX2xvZ1tjdHgtPnJlZ19s
b2dfaWR4XSA9IHJudW07Ci0gICAgY3R4LT5yZWdfbG9nX2lkeCsrOwotICAgIHNldF9iaXQocm51
bSwgY3R4LT5yZWdzX3dyaXR0ZW4pOwotfQotCi1zdGF0aWMgaW5saW5lIHZvaWQgY3R4X2xvZ19y
ZWdfd3JpdGVfcGFpcihEaXNhc0NvbnRleHQgKmN0eCwgaW50IHJudW0pCi17Ci0gICAgY3R4X2xv
Z19yZWdfd3JpdGUoY3R4LCBybnVtKTsKLSAgICBjdHhfbG9nX3JlZ193cml0ZShjdHgsIHJudW0g
KyAxKTsKIH0KIAotc3RhdGljIGlubGluZSB2b2lkIGN0eF9sb2dfcHJlZF93cml0ZShEaXNhc0Nv
bnRleHQgKmN0eCwgaW50IHBudW0pCitzdGF0aWMgaW5saW5lIHZvaWQgY3R4X2xvZ19yZWdfd3Jp
dGUoRGlzYXNDb250ZXh0ICpjdHgsIGludCBybnVtLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGJvb2wgaXNfcHJlZGljYXRlZCkKIHsKLSAgICBjdHgtPnByZWdfbG9nW2N0
eC0+cHJlZ19sb2dfaWR4XSA9IHBudW07Ci0gICAgY3R4LT5wcmVnX2xvZ19pZHgrKzsKLSAgICBz
ZXRfYml0KHBudW0sIGN0eC0+cHJlZ3Nfd3JpdHRlbik7CisgICAgaWYgKHJudW0gPT0gSEVYX1JF
R19QM18wKSB7CisgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgTlVNX1BSRUdTOyBpKyspIHsK
KyAgICAgICAgICAgIGN0eF9sb2dfcHJlZF93cml0ZShjdHgsIGkpOworICAgICAgICB9CisgICAg
fSBlbHNlIHsKKyAgICAgICAgaWYgKCF0ZXN0X2JpdChybnVtLCBjdHgtPnJlZ3Nfd3JpdHRlbikp
IHsKKyAgICAgICAgICAgIGN0eC0+cmVnX2xvZ1tjdHgtPnJlZ19sb2dfaWR4XSA9IHJudW07Cisg
ICAgICAgICAgICBjdHgtPnJlZ19sb2dfaWR4Kys7CisgICAgICAgICAgICBzZXRfYml0KHJudW0s
IGN0eC0+cmVnc193cml0dGVuKTsKKyAgICAgICAgfQorICAgICAgICBpZiAoaXNfcHJlZGljYXRl
ZCkgeworICAgICAgICAgICAgc2V0X2JpdChybnVtLCBjdHgtPnByZWRpY2F0ZWRfcmVncyk7Cisg
ICAgICAgIH0KKyAgICB9CiB9CiAKLXN0YXRpYyBpbmxpbmUgYm9vbCBpc19wcmVsb2FkZWQoRGlz
YXNDb250ZXh0ICpjdHgsIGludCBudW0pCitzdGF0aWMgaW5saW5lIHZvaWQgY3R4X2xvZ19yZWdf
d3JpdGVfcGFpcihEaXNhc0NvbnRleHQgKmN0eCwgaW50IHJudW0sCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBib29sIGlzX3ByZWRpY2F0ZWQpCiB7Ci0gICAgcmV0
dXJuIHRlc3RfYml0KG51bSwgY3R4LT5yZWdzX3dyaXR0ZW4pOworICAgIGN0eF9sb2dfcmVnX3dy
aXRlKGN0eCwgcm51bSwgaXNfcHJlZGljYXRlZCk7CisgICAgY3R4X2xvZ19yZWdfd3JpdGUoY3R4
LCBybnVtICsgMSwgaXNfcHJlZGljYXRlZCk7CiB9CiAKIHN0YXRpYyBpbmxpbmUgYm9vbCBpc192
cmVnX3ByZWxvYWRlZChEaXNhc0NvbnRleHQgKmN0eCwgaW50IG51bSkKZGlmZiAtLWdpdCBhL3Rh
cmdldC9oZXhhZ29uL2dlbnB0ci5jIGIvdGFyZ2V0L2hleGFnb24vZ2VucHRyLmMKaW5kZXggNzI0
M2JiMDBhYS4uNWU1YWUwY2RjYSAxMDA2NDQKLS0tIGEvdGFyZ2V0L2hleGFnb24vZ2VucHRyLmMK
KysrIGIvdGFyZ2V0L2hleGFnb24vZ2VucHRyLmMKQEAgLTE0OSw2ICsxNDksNyBAQCB2b2lkIGdl
bl9sb2dfcHJlZF93cml0ZShEaXNhc0NvbnRleHQgKmN0eCwgaW50IHBudW0sIFRDR3YgdmFsKQog
ICAgICAgICAgICAgICAgICAgICAgICBoZXhfbmV3X3ByZWRfdmFsdWVbcG51bV0sIGJhc2VfdmFs
KTsKICAgICB9CiAgICAgdGNnX2dlbl9vcmlfdGwoaGV4X3ByZWRfd3JpdHRlbiwgaGV4X3ByZWRf
d3JpdHRlbiwgMSA8PCBwbnVtKTsKKyAgICBzZXRfYml0KHBudW0sIGN0eC0+cHJlZ3Nfd3JpdHRl
bik7CiAKICAgICB0Y2dfdGVtcF9mcmVlKGJhc2VfdmFsKTsKIH0KQEAgLTIzMSw3ICsyMzIsNiBA
QCBzdGF0aWMgdm9pZCBnZW5fd3JpdGVfcDNfMChEaXNhc0NvbnRleHQgKmN0eCwgVENHdiBjb250
cm9sX3JlZykKICAgICBmb3IgKGludCBpID0gMDsgaSA8IE5VTV9QUkVHUzsgaSsrKSB7CiAgICAg
ICAgIHRjZ19nZW5fZXh0cmFjdF90bChoZXhfcDgsIGNvbnRyb2xfcmVnLCBpICogOCwgOCk7CiAg
ICAgICAgIGdlbl9sb2dfcHJlZF93cml0ZShjdHgsIGksIGhleF9wOCk7Ci0gICAgICAgIGN0eF9s
b2dfcHJlZF93cml0ZShjdHgsIGkpOwogICAgIH0KICAgICB0Y2dfdGVtcF9mcmVlKGhleF9wOCk7
CiB9CkBAIC0yNTAsNyArMjUwLDYgQEAgc3RhdGljIGlubGluZSB2b2lkIGdlbl93cml0ZV9jdHJs
X3JlZyhEaXNhc0NvbnRleHQgKmN0eCwgaW50IHJlZ19udW0sCiAgICAgICAgIGdlbl93cml0ZV9w
M18wKGN0eCwgdmFsKTsKICAgICB9IGVsc2UgewogICAgICAgICBnZW5fbG9nX3JlZ193cml0ZShy
ZWdfbnVtLCB2YWwpOwotICAgICAgICBjdHhfbG9nX3JlZ193cml0ZShjdHgsIHJlZ19udW0pOwog
ICAgICAgICBpZiAocmVnX251bSA9PSBIRVhfUkVHX1FFTVVfUEtUX0NOVCkgewogICAgICAgICAg
ICAgY3R4LT5udW1fcGFja2V0cyA9IDA7CiAgICAgICAgIH0KQEAgLTI3MywxMCArMjcyLDggQEAg
c3RhdGljIGlubGluZSB2b2lkIGdlbl93cml0ZV9jdHJsX3JlZ19wYWlyKERpc2FzQ29udGV4dCAq
Y3R4LCBpbnQgcmVnX251bSwKICAgICAgICAgdGNnX2dlbl9leHRyaF9pNjRfaTMyKHZhbDMyLCB2
YWwpOwogICAgICAgICBnZW5fbG9nX3JlZ193cml0ZShyZWdfbnVtICsgMSwgdmFsMzIpOwogICAg
ICAgICB0Y2dfdGVtcF9mcmVlKHZhbDMyKTsKLSAgICAgICAgY3R4X2xvZ19yZWdfd3JpdGUoY3R4
LCByZWdfbnVtICsgMSk7CiAgICAgfSBlbHNlIHsKICAgICAgICAgZ2VuX2xvZ19yZWdfd3JpdGVf
cGFpcihyZWdfbnVtLCB2YWwpOwotICAgICAgICBjdHhfbG9nX3JlZ193cml0ZV9wYWlyKGN0eCwg
cmVnX251bSk7CiAgICAgICAgIGlmIChyZWdfbnVtID09IEhFWF9SRUdfUUVNVV9QS1RfQ05UKSB7
CiAgICAgICAgICAgICBjdHgtPm51bV9wYWNrZXRzID0gMDsKICAgICAgICAgICAgIGN0eC0+bnVt
X2luc25zID0gMDsKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29uL2lkZWYtcGFyc2VyL3BhcnNl
ci1oZWxwZXJzLmMgYi90YXJnZXQvaGV4YWdvbi9pZGVmLXBhcnNlci9wYXJzZXItaGVscGVycy5j
CmluZGV4IDgxMTA2ODZjNTEuLmRlOTgzODgwNmIgMTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29u
L2lkZWYtcGFyc2VyL3BhcnNlci1oZWxwZXJzLmMKKysrIGIvdGFyZ2V0L2hleGFnb24vaWRlZi1w
YXJzZXIvcGFyc2VyLWhlbHBlcnMuYwpAQCAtMSw1ICsxLDUgQEAKIC8qCi0gKiAgQ29weXJpZ2h0
KGMpIDIwMTktMjAyMiByZXYubmcgTGFicyBTcmwuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCisgKiAg
Q29weXJpZ2h0KGMpIDIwMTktMjAyMyByZXYubmcgTGFicyBTcmwuIEFsbCBSaWdodHMgUmVzZXJ2
ZWQuCiAgKgogICogIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlz
dHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAgKiAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBH
TlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKQEAgLTE0MzgsMTAgKzE0
MzgsNiBAQCB2b2lkIGdlbl93cml0ZV9yZWcoQ29udGV4dCAqYywgWVlMVFlQRSAqbG9jcCwgSGV4
VmFsdWUgKnJlZywgSGV4VmFsdWUgKnZhbHVlKQogICAgICAgICBsb2NwLAogICAgICAgICAiZ2Vu
X2xvZ19yZWdfd3JpdGUoIiwgJnJlZy0+cmVnLmlkLCAiLCAiLAogICAgICAgICAmdmFsdWVfbSwg
Iik7XG4iKTsKLSAgICBPVVQoYywKLSAgICAgICAgbG9jcCwKLSAgICAgICAgImN0eF9sb2dfcmVn
X3dyaXRlKGN0eCwgIiwgJnJlZy0+cmVnLmlkLAotICAgICAgICAiKTtcbiIpOwogICAgIGdlbl9y
dmFsdWVfZnJlZShjLCBsb2NwLCByZWcpOwogICAgIGdlbl9ydmFsdWVfZnJlZShjLCBsb2NwLCAm
dmFsdWVfbSk7CiB9CkBAIC0xODk0LDcgKzE4OTAsNiBAQCB2b2lkIGdlbl9wcmVkX2Fzc2lnbihD
b250ZXh0ICpjLCBZWUxUWVBFICpsb2NwLCBIZXhWYWx1ZSAqbGVmdF9wcmVkLAogICAgIGlmIChp
c19kaXJlY3QpIHsKICAgICAgICAgT1VUKGMsIGxvY3AsICJnZW5fbG9nX3ByZWRfd3JpdGUoY3R4
LCAiLCBwcmVkX2lkLCAiLCAiLCBsZWZ0X3ByZWQsCiAgICAgICAgICAgICAiKTtcbiIpOwotICAg
ICAgICBPVVQoYywgbG9jcCwgImN0eF9sb2dfcHJlZF93cml0ZShjdHgsICIsIHByZWRfaWQsICIp
O1xuIik7CiAgICAgICAgIGdlbl9ydmFsdWVfZnJlZShjLCBsb2NwLCBsZWZ0X3ByZWQpOwogICAg
IH0KICAgICAvKiBGcmVlIHRlbXBvcmFyeSB2YWx1ZSAqLwpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hl
eGFnb24vdHJhbnNsYXRlLmMgYi90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuYwppbmRleCA3NWYy
OGUwOGFkLi4zZTZlNzJkMDQ2IDEwMDY0NAotLS0gYS90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUu
YworKysgYi90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuYwpAQCAtMSw1ICsxLDUgQEAKIC8qCi0g
KiAgQ29weXJpZ2h0KGMpIDIwMTktMjAyMiBRdWFsY29tbSBJbm5vdmF0aW9uIENlbnRlciwgSW5j
LiBBbGwgUmlnaHRzIFJlc2VydmVkLgorICogIENvcHlyaWdodChjKSAyMDE5LTIwMjMgUXVhbGNv
bW0gSW5ub3ZhdGlvbiBDZW50ZXIsIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KICAqCiAgKiAg
VGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFu
ZC9vciBtb2RpZnkKICAqICBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1
YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQpAQCAtMjksNiArMjksMTAgQEAKICNpbmNsdWRl
ICJ0cmFuc2xhdGUuaCIKICNpbmNsdWRlICJwcmludGluc24uaCIKIAordHlwZWRlZiB2b2lkICgq
QW5hbHl6ZUluc24pKHN0cnVjdCBEaXNhc0NvbnRleHQgKmN0eCk7CisjaW5jbHVkZSAiYW5hbHl6
ZV9mdW5jc19nZW5lcmF0ZWQuYy5pbmMiCisjaW5jbHVkZSAiYW5hbHl6ZV9mdW5jX3RhYmxlX2dl
bmVyYXRlZC5jLmluYyIKKwogVENHdiBoZXhfZ3ByW1RPVEFMX1BFUl9USFJFQURfUkVHU107CiBU
Q0d2IGhleF9wcmVkW05VTV9QUkVHU107CiBUQ0d2IGhleF90aGlzX1BDOwpAQCAtMjY1LDYgKzI2
OSw3NiBAQCBzdGF0aWMgYm9vbCBuZWVkX25leHRfUEMoRGlzYXNDb250ZXh0ICpjdHgpCiAgICAg
cmV0dXJuIGZhbHNlOwogfQogCisvKgorICogVGhlIG9wY29kZV9hbmFseXplIGZ1bmN0aW9ucyBt
YXJrIG1vc3Qgb2YgdGhlIHdyaXRlcyBpbiBhIHBhY2tldAorICogSG93ZXZlciwgdGhlcmUgYXJl
IHNvbWUgaW1wbGljaXQgd3JpdGVzIG1hcmtlZCBhcyBhdHRyaWJ1dGVzCisgKiBvZiB0aGUgYXBw
bGljYWJsZSBpbnN0cnVjdGlvbnMuCisgKi8KK3N0YXRpYyB2b2lkIG1hcmtfaW1wbGljaXRfcmVn
X3dyaXRlKERpc2FzQ29udGV4dCAqY3R4LCBpbnQgYXR0cmliLCBpbnQgcm51bSkKK3sKKyAgICB1
aW50MTZfdCBvcGNvZGUgPSBjdHgtPmluc24tPm9wY29kZTsKKyAgICBpZiAoR0VUX0FUVFJJQihv
cGNvZGUsIGF0dHJpYikpIHsKKyAgICAgICAgLyoKKyAgICAgICAgICogVVNSIGlzIHVzZWQgdG8g
c2V0IG92ZXJmbG93IGFuZCBGUCBleGNlcHRpb25zLAorICAgICAgICAgKiBzbyB0cmVhdCBpdCBh
cyBjb25kaXRpb25hbAorICAgICAgICAgKi8KKyAgICAgICAgYm9vbCBpc19wcmVkaWNhdGVkID0g
R0VUX0FUVFJJQihvcGNvZGUsIEFfQ09OREVYRUMpIHx8CisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHJudW0gPT0gSEVYX1JFR19VU1I7CisKKyAgICAgICAgLyogTEMwL0xDMSBpcyBjb25k
aXRpb25hbGx5IHdyaXR0ZW4gYnkgZW5kbG9vcCBpbnN0cnVjdGlvbnMgKi8KKyAgICAgICAgaWYg
KChybnVtID09IEhFWF9SRUdfTEMwIHx8IHJudW0gPT0gSEVYX1JFR19MQzEpICYmCisgICAgICAg
ICAgICAob3Bjb2RlID09IEoyX2VuZGxvb3AwIHx8CisgICAgICAgICAgICAgb3Bjb2RlID09IEoy
X2VuZGxvb3AxIHx8CisgICAgICAgICAgICAgb3Bjb2RlID09IEoyX2VuZGxvb3AwMSkpIHsKKyAg
ICAgICAgICAgIGlzX3ByZWRpY2F0ZWQgPSB0cnVlOworICAgICAgICB9CisKKyAgICAgICAgY3R4
X2xvZ19yZWdfd3JpdGUoY3R4LCBybnVtLCBpc19wcmVkaWNhdGVkKTsKKyAgICB9Cit9CisKK3N0
YXRpYyB2b2lkIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlcyhEaXNhc0NvbnRleHQgKmN0eCkKK3sK
KyAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX0ZQLCAg
SEVYX1JFR19GUCk7CisgICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0lNUExJQ0lU
X1dSSVRFU19TUCwgIEhFWF9SRUdfU1ApOworICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0
eCwgQV9JTVBMSUNJVF9XUklURVNfTFIsICBIRVhfUkVHX0xSKTsKKyAgICBtYXJrX2ltcGxpY2l0
X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX0xDMCwgSEVYX1JFR19MQzApOworICAg
IG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfU0EwLCBIRVhf
UkVHX1NBMCk7CisgICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dS
SVRFU19MQzEsIEhFWF9SRUdfTEMxKTsKKyAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgs
IEFfSU1QTElDSVRfV1JJVEVTX1NBMSwgSEVYX1JFR19TQTEpOworICAgIG1hcmtfaW1wbGljaXRf
cmVnX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfVVNSLCBIRVhfUkVHX1VTUik7CisgICAg
bWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0ZQT1AsIEhFWF9SRUdfVVNSKTsKK30KKwor
c3RhdGljIHZvaWQgbWFya19pbXBsaWNpdF9wcmVkX3dyaXRlKERpc2FzQ29udGV4dCAqY3R4LCBp
bnQgYXR0cmliLCBpbnQgcG51bSkKK3sKKyAgICBpZiAoR0VUX0FUVFJJQihjdHgtPmluc24tPm9w
Y29kZSwgYXR0cmliKSkgeworICAgICAgICBjdHhfbG9nX3ByZWRfd3JpdGUoY3R4LCBwbnVtKTsK
KyAgICB9Cit9CisKK3N0YXRpYyB2b2lkIG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZXMoRGlzYXND
b250ZXh0ICpjdHgpCit7CisgICAgbWFya19pbXBsaWNpdF9wcmVkX3dyaXRlKGN0eCwgQV9JTVBM
SUNJVF9XUklURVNfUDAsIDApOworICAgIG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZShjdHgsIEFf
SU1QTElDSVRfV1JJVEVTX1AxLCAxKTsKKyAgICBtYXJrX2ltcGxpY2l0X3ByZWRfd3JpdGUoY3R4
LCBBX0lNUExJQ0lUX1dSSVRFU19QMiwgMik7CisgICAgbWFya19pbXBsaWNpdF9wcmVkX3dyaXRl
KGN0eCwgQV9JTVBMSUNJVF9XUklURVNfUDMsIDMpOworfQorCitzdGF0aWMgdm9pZCBhbmFseXpl
X3BhY2tldChEaXNhc0NvbnRleHQgKmN0eCkKK3sKKyAgICBQYWNrZXQgKnBrdCA9IGN0eC0+cGt0
OworICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcGt0LT5udW1faW5zbnM7IGkrKykgeworICAgICAg
ICBJbnNuICppbnNuID0gJnBrdC0+aW5zbltpXTsKKyAgICAgICAgY3R4LT5pbnNuID0gaW5zbjsK
KyAgICAgICAgaWYgKG9wY29kZV9hbmFseXplW2luc24tPm9wY29kZV0pIHsKKyAgICAgICAgICAg
IG9wY29kZV9hbmFseXplW2luc24tPm9wY29kZV0oY3R4KTsKKyAgICAgICAgfQorICAgICAgICBt
YXJrX2ltcGxpY2l0X3JlZ193cml0ZXMoY3R4KTsKKyAgICAgICAgbWFya19pbXBsaWNpdF9wcmVk
X3dyaXRlcyhjdHgpOworICAgIH0KK30KKwogc3RhdGljIHZvaWQgZ2VuX3N0YXJ0X3BhY2tldChE
aXNhc0NvbnRleHQgKmN0eCkKIHsKICAgICBQYWNrZXQgKnBrdCA9IGN0eC0+cGt0OwpAQCAtMjc1
LDYgKzM0OSw3IEBAIHN0YXRpYyB2b2lkIGdlbl9zdGFydF9wYWNrZXQoRGlzYXNDb250ZXh0ICpj
dHgpCiAgICAgY3R4LT5uZXh0X1BDID0gbmV4dF9QQzsKICAgICBjdHgtPnJlZ19sb2dfaWR4ID0g
MDsKICAgICBiaXRtYXBfemVybyhjdHgtPnJlZ3Nfd3JpdHRlbiwgVE9UQUxfUEVSX1RIUkVBRF9S
RUdTKTsKKyAgICBiaXRtYXBfemVybyhjdHgtPnByZWRpY2F0ZWRfcmVncywgVE9UQUxfUEVSX1RI
UkVBRF9SRUdTKTsKICAgICBjdHgtPnByZWdfbG9nX2lkeCA9IDA7CiAgICAgYml0bWFwX3plcm8o
Y3R4LT5wcmVnc193cml0dGVuLCBOVU1fUFJFR1MpOwogICAgIGN0eC0+ZnV0dXJlX3ZyZWdzX2lk
eCA9IDA7CkBAIC0yOTEsNiArMzY2LDE0IEBAIHN0YXRpYyB2b2lkIGdlbl9zdGFydF9wYWNrZXQo
RGlzYXNDb250ZXh0ICpjdHgpCiAgICAgY3R4LT5zMV9zdG9yZV9wcm9jZXNzZWQgPSBmYWxzZTsK
ICAgICBjdHgtPnByZV9jb21taXQgPSB0cnVlOwogCisgICAgYW5hbHl6ZV9wYWNrZXQoY3R4KTsK
KworICAgIC8qCisgICAgICogcHJlZ3Nfd3JpdHRlbiBpcyB1c2VkIGJvdGggaW4gdGhlIGFuYWx5
emUgcGhhc2UgYXMgd2VsbCBhcyB0aGUgY29kZQorICAgICAqIGdlbiBwaGFzZSwgc28gY2xlYXIg
aXQgYWdhaW4uCisgICAgICovCisgICAgYml0bWFwX3plcm8oY3R4LT5wcmVnc193cml0dGVuLCBO
VU1fUFJFR1MpOworCiAgICAgaWYgKEhFWF9ERUJVRykgewogICAgICAgICAvKiBIYW5keSBwbGFj
ZSB0byBzZXQgYSBicmVha3BvaW50IGJlZm9yZSB0aGUgcGFja2V0IGV4ZWN1dGVzICovCiAgICAg
ICAgIGdlbl9oZWxwZXJfZGVidWdfc3RhcnRfcGFja2V0KGNwdV9lbnYpOwpAQCAtMzEzLDYgKzM5
NiwxNiBAQCBzdGF0aWMgdm9pZCBnZW5fc3RhcnRfcGFja2V0KERpc2FzQ29udGV4dCAqY3R4KQog
ICAgICAgICB0Y2dfZ2VuX21vdmlfdGwoaGV4X3ByZWRfd3JpdHRlbiwgMCk7CiAgICAgfQogCisg
ICAgLyogUHJlbG9hZCB0aGUgcHJlZGljYXRlZCByZWdpc3RlcnMgaW50byBoZXhfbmV3X3ZhbHVl
W2ldICovCisgICAgaWYgKCFiaXRtYXBfZW1wdHkoY3R4LT5wcmVkaWNhdGVkX3JlZ3MsIFRPVEFM
X1BFUl9USFJFQURfUkVHUykpIHsKKyAgICAgICAgaW50IGkgPSBmaW5kX2ZpcnN0X2JpdChjdHgt
PnByZWRpY2F0ZWRfcmVncywgVE9UQUxfUEVSX1RIUkVBRF9SRUdTKTsKKyAgICAgICAgd2hpbGUg
KGkgPCBUT1RBTF9QRVJfVEhSRUFEX1JFR1MpIHsKKyAgICAgICAgICAgIHRjZ19nZW5fbW92X3Rs
KGhleF9uZXdfdmFsdWVbaV0sIGhleF9ncHJbaV0pOworICAgICAgICAgICAgaSA9IGZpbmRfbmV4
dF9iaXQoY3R4LT5wcmVkaWNhdGVkX3JlZ3MsIFRPVEFMX1BFUl9USFJFQURfUkVHUywKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGkgKyAxKTsKKyAgICAgICAgfQorICAgIH0KKwogICAg
IGlmIChwa3QtPnBrdF9oYXNfaHZ4KSB7CiAgICAgICAgIHRjZ19nZW5fbW92aV90bChoZXhfVlJl
Z3NfdXBkYXRlZCwgMCk7CiAgICAgICAgIHRjZ19nZW5fbW92aV90bChoZXhfUVJlZ3NfdXBkYXRl
ZCwgMCk7CkBAIC0zMzYsNjYgKzQyOSw2IEBAIGJvb2wgaXNfZ2F0aGVyX3N0b3JlX2luc24oRGlz
YXNDb250ZXh0ICpjdHgpCiAgICAgcmV0dXJuIGZhbHNlOwogfQogCi0vKgotICogVGhlIExPR18q
X1dSSVRFIG1hY3JvcyBtYXJrIG1vc3Qgb2YgdGhlIHdyaXRlcyBpbiBhIHBhY2tldAotICogSG93
ZXZlciwgdGhlcmUgYXJlIHNvbWUgaW1wbGljaXQgd3JpdGVzIG1hcmtlZCBhcyBhdHRyaWJ1dGVz
Ci0gKiBvZiB0aGUgYXBwbGljYWJsZSBpbnN0cnVjdGlvbnMuCi0gKi8KLXN0YXRpYyB2b2lkIG1h
cmtfaW1wbGljaXRfcmVnX3dyaXRlKERpc2FzQ29udGV4dCAqY3R4LCBpbnQgYXR0cmliLCBpbnQg
cm51bSkKLXsKLSAgICB1aW50MTZfdCBvcGNvZGUgPSBjdHgtPmluc24tPm9wY29kZTsKLSAgICBp
ZiAoR0VUX0FUVFJJQihvcGNvZGUsIGF0dHJpYikpIHsKLSAgICAgICAgLyoKLSAgICAgICAgICog
VVNSIGlzIHVzZWQgdG8gc2V0IG92ZXJmbG93IGFuZCBGUCBleGNlcHRpb25zLAotICAgICAgICAg
KiBzbyB0cmVhdCBpdCBhcyBjb25kaXRpb25hbAotICAgICAgICAgKi8KLSAgICAgICAgYm9vbCBp
c19wcmVkaWNhdGVkID0gR0VUX0FUVFJJQihvcGNvZGUsIEFfQ09OREVYRUMpIHx8Ci0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHJudW0gPT0gSEVYX1JFR19VU1I7Ci0KLSAgICAgICAgLyog
TEMwL0xDMSBpcyBjb25kaXRpb25hbGx5IHdyaXR0ZW4gYnkgZW5kbG9vcCBpbnN0cnVjdGlvbnMg
Ki8KLSAgICAgICAgaWYgKChybnVtID09IEhFWF9SRUdfTEMwIHx8IHJudW0gPT0gSEVYX1JFR19M
QzEpICYmCi0gICAgICAgICAgICAob3Bjb2RlID09IEoyX2VuZGxvb3AwIHx8Ci0gICAgICAgICAg
ICAgb3Bjb2RlID09IEoyX2VuZGxvb3AxIHx8Ci0gICAgICAgICAgICAgb3Bjb2RlID09IEoyX2Vu
ZGxvb3AwMSkpIHsKLSAgICAgICAgICAgIGlzX3ByZWRpY2F0ZWQgPSB0cnVlOwotICAgICAgICB9
Ci0KLSAgICAgICAgaWYgKGlzX3ByZWRpY2F0ZWQgJiYgIWlzX3ByZWxvYWRlZChjdHgsIHJudW0p
KSB7Ci0gICAgICAgICAgICB0Y2dfZ2VuX21vdl90bChoZXhfbmV3X3ZhbHVlW3JudW1dLCBoZXhf
Z3ByW3JudW1dKTsKLSAgICAgICAgfQotCi0gICAgICAgIGN0eF9sb2dfcmVnX3dyaXRlKGN0eCwg
cm51bSk7Ci0gICAgfQotfQotCi1zdGF0aWMgdm9pZCBtYXJrX2ltcGxpY2l0X3ByZWRfd3JpdGUo
RGlzYXNDb250ZXh0ICpjdHgsIGludCBhdHRyaWIsIGludCBwbnVtKQotewotICAgIGlmIChHRVRf
QVRUUklCKGN0eC0+aW5zbi0+b3Bjb2RlLCBhdHRyaWIpKSB7Ci0gICAgICAgIGN0eF9sb2dfcHJl
ZF93cml0ZShjdHgsIHBudW0pOwotICAgIH0KLX0KLQotc3RhdGljIHZvaWQgbWFya19pbXBsaWNp
dF9yZWdfd3JpdGVzKERpc2FzQ29udGV4dCAqY3R4KQotewotICAgIG1hcmtfaW1wbGljaXRfcmVn
X3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfRlAsICBIRVhfUkVHX0ZQKTsKLSAgICBtYXJr
X2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX1NQLCAgSEVYX1JFR19T
UCk7Ci0gICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19M
UiwgIEhFWF9SRUdfTFIpOwotICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9JTVBM
SUNJVF9XUklURVNfTEMwLCBIRVhfUkVHX0xDMCk7Ci0gICAgbWFya19pbXBsaWNpdF9yZWdfd3Jp
dGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19TQTAsIEhFWF9SRUdfU0EwKTsKLSAgICBtYXJrX2lt
cGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX0xDMSwgSEVYX1JFR19MQzEp
OwotICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfU0Ex
LCBIRVhfUkVHX1NBMSk7Ci0gICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0lNUExJ
Q0lUX1dSSVRFU19VU1IsIEhFWF9SRUdfVVNSKTsKLSAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0
ZShjdHgsIEFfRlBPUCwgSEVYX1JFR19VU1IpOwotfQotCi1zdGF0aWMgdm9pZCBtYXJrX2ltcGxp
Y2l0X3ByZWRfd3JpdGVzKERpc2FzQ29udGV4dCAqY3R4KQotewotICAgIG1hcmtfaW1wbGljaXRf
cHJlZF93cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX1AwLCAwKTsKLSAgICBtYXJrX2ltcGxp
Y2l0X3ByZWRfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19QMSwgMSk7Ci0gICAgbWFya19p
bXBsaWNpdF9wcmVkX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfUDIsIDIpOwotICAgIG1h
cmtfaW1wbGljaXRfcHJlZF93cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX1AzLCAzKTsKLX0K
LQogc3RhdGljIHZvaWQgbWFya19zdG9yZV93aWR0aChEaXNhc0NvbnRleHQgKmN0eCkKIHsKICAg
ICB1aW50MTZfdCBvcGNvZGUgPSBjdHgtPmluc24tPm9wY29kZTsKQEAgLTQyMyw5ICs0NTYsNyBA
QCBzdGF0aWMgdm9pZCBtYXJrX3N0b3JlX3dpZHRoKERpc2FzQ29udGV4dCAqY3R4KQogc3RhdGlj
IHZvaWQgZ2VuX2luc24oRGlzYXNDb250ZXh0ICpjdHgpCiB7CiAgICAgaWYgKGN0eC0+aW5zbi0+
Z2VuZXJhdGUpIHsKLSAgICAgICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGVzKGN0eCk7CiAgICAg
ICAgIGN0eC0+aW5zbi0+Z2VuZXJhdGUoY3R4KTsKLSAgICAgICAgbWFya19pbXBsaWNpdF9wcmVk
X3dyaXRlcyhjdHgpOwogICAgICAgICBtYXJrX3N0b3JlX3dpZHRoKGN0eCk7CiAgICAgfSBlbHNl
IHsKICAgICAgICAgZ2VuX2V4Y2VwdGlvbl9lbmRfdGIoY3R4LCBIRVhfRVhDUF9JTlZBTElEX09Q
Q09ERSk7CmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi9SRUFETUUgYi90YXJnZXQvaGV4YWdv
bi9SRUFETUUKaW5kZXggNmNiNWFmZmRkYi4uZDAwYzg1ZDU1NCAxMDA2NDQKLS0tIGEvdGFyZ2V0
L2hleGFnb24vUkVBRE1FCisrKyBiL3RhcmdldC9oZXhhZ29uL1JFQURNRQpAQCAtNTIsNiArNTIs
OCBAQCBoZWFkZXIgZmlsZXMgaW4gPEJVSUxEX0RJUj4vdGFyZ2V0L2hleGFnb24KICAgICAgICAg
Z2VuX3RjZ19mdW5jX3RhYmxlLnB5ICAgICAgICAgICAtPiB0Y2dfZnVuY190YWJsZV9nZW5lcmF0
ZWQuYy5pbmMKICAgICAgICAgZ2VuX2hlbHBlcl9mdW5jcy5weSAgICAgICAgICAgICAtPiBoZWxw
ZXJfZnVuY3NfZ2VuZXJhdGVkLmMuaW5jCiAgICAgICAgIGdlbl9pZGVmX3BhcnNlcl9mdW5jcy5w
eSAgICAgICAgLT4gaWRlZl9wYXJzZXJfaW5wdXQuaAorICAgICAgICBnZW5fYW5hbHl6ZV9mdW5j
cy5weSAgICAgICAgICAgIC0+IGFuYWx5emVfZnVuY3NfZ2VuZXJhdGVkLmMuaW5jCisgICAgICAg
IGdlbl9hbmFseXplX2Z1bmNfdGFibGUucHkgICAgICAgLT4gYW5hbHl6ZV9mdW5jX3RhYmxlLmMu
aW5jCiAKIFFlbXUgaGVscGVyIGZ1bmN0aW9ucyBoYXZlIDMgcGFydHMKICAgICBERUZfSEVMUEVS
IGRlY2xhcmF0aW9uIGluZGljYXRlcyB0aGUgc2lnbmF0dXJlIG9mIHRoZSBoZWxwZXIKQEAgLTg3
LDcgKzg5LDYgQEAgdGNnX2Z1bmNzX2dlbmVyYXRlZC5jLmluYwogICAgICAgICBUQ0d2IFJ0ViA9
IGhleF9ncHJbaW5zbi0+cmVnbm9bMl1dOwogICAgICAgICBnZW5faGVscGVyX0EyX2FkZChSZFYs
IGNwdV9lbnYsIFJzViwgUnRWKTsKICAgICAgICAgZ2VuX2xvZ19yZWdfd3JpdGUoUmROLCBSZFYp
OwotICAgICAgICBjdHhfbG9nX3JlZ193cml0ZShjdHgsIFJkTik7CiAgICAgICAgIHRjZ190ZW1w
X2ZyZWUoUmRWKTsKICAgICB9CiAKQEAgLTE2Miw3ICsxNjMsNiBAQCBpc3RydWN0aW9uLgogICAg
ICAgICBnZW5faGVscGVyX1Y2X3ZhZGR3KGNwdV9lbnYsIFZkViwgVnVWLCBWdlYsIHNsb3QpOwog
ICAgICAgICB0Y2dfdGVtcF9mcmVlKHNsb3QpOwogICAgICAgICBnZW5fbG9nX3ZyZWdfd3JpdGUo
Y3R4LCBWZFZfb2ZmLCBWZE4sIEVYVF9ERkwsIGluc24tPnNsb3QsIGZhbHNlKTsKLSAgICAgICAg
Y3R4X2xvZ192cmVnX3dyaXRlKGN0eCwgVmROLCBFWFRfREZMLCBmYWxzZSk7CiAgICAgICAgIHRj
Z190ZW1wX2ZyZWVfcHRyKFZkVik7CiAgICAgICAgIHRjZ190ZW1wX2ZyZWVfcHRyKFZ1Vik7CiAg
ICAgICAgIHRjZ190ZW1wX2ZyZWVfcHRyKFZ2Vik7CkBAIC0xOTUsOSArMTk1LDE0IEBAIHdoZW4g
dGhlIG92ZXJyaWRlIGlzIHByZXNlbnQuCiAgICAgICAgICAgICB2cmVnX3NyY19vZmYoY3R4LCBW
dk4pOwogICAgICAgICBmR0VOX1RDR19WNl92YWRkdyh7IGZISURFKGludCBpOykgZlZGT1JFQUNI
KDMyLCBpKSB7IFZkVi53W2ldID0gVnVWLndbaV0gKyBWdlYud1tpXSA7IH0gfSk7CiAgICAgICAg
IGdlbl9sb2dfdnJlZ193cml0ZShjdHgsIFZkVl9vZmYsIFZkTiwgRVhUX0RGTCwgaW5zbi0+c2xv
dCwgZmFsc2UpOwotICAgICAgICBjdHhfbG9nX3ZyZWdfd3JpdGUoY3R4LCBWZE4sIEVYVF9ERkws
IGZhbHNlKTsKICAgICB9CiAKK1dlIGFsc28gZ2VuZXJhdGUgYW4gYW5hbHl6ZV88dGFnPiBmdW5j
dGlvbiBmb3IgZWFjaCBpbnN0cnVjdGlvbi4gIEN1cnJlbnRseSwKK3RoZXNlIGZ1bmN0aW9ucyBy
ZWNvcmQgdGhlIHdyaXRlcyB0byByZWdpc3RlcnMgYnkgY2FsbGluZyBjdHhfbG9nXyouICBEdXJp
bmcKK2dlbl9zdGFydF9wYWNrZXQsIHdlIGludm9rZSB0aGUgYW5hbHl6ZV88dGFnPiBmdW5jdGlv
biBmb3IgZWFjaCBpbnN0cnVjdGlvbiBpbgordGhlIHBhY2tldCwgYW5kIHdlIG1hcmsgdGhlIGlt
cGxpY2l0IHdyaXRlcy4gIEFmdGVyIHRoZSBhbmFseXNpcyBpcyBwZXJmb3JtZWQsCit3ZSBpbml0
aWFsaXplIGhleF9uZXdfdmFsdWUgZm9yIGVhY2ggb2YgdGhlIHByZWRpY2F0ZWQgYXNzaWdubWVu
dHMuCisKIEluIGFkZGl0aW9uIHRvIGluc3RydWN0aW9uIHNlbWFudGljcywgd2UgdXNlIGEgZ2Vu
ZXJhdG9yIHRvIGNyZWF0ZSB0aGUgZGVjb2RlCiB0cmVlLiAgVGhpcyBnZW5lcmF0aW9uIGlzIGFs
c28gYSB0d28gc3RlcCBwcm9jZXNzLiAgVGhlIGZpcnN0IHN0ZXAgaXMgdG8gcnVuCiB0YXJnZXQv
aGV4YWdvbi9nZW5fZGVjdHJlZV9pbXBvcnQuYyB0byBwcm9kdWNlCmRpZmYgLS1naXQgYS90YXJn
ZXQvaGV4YWdvbi9nZW5fYW5hbHl6ZV9mdW5jX3RhYmxlLnB5IGIvdGFyZ2V0L2hleGFnb24vZ2Vu
X2FuYWx5emVfZnVuY190YWJsZS5weQpuZXcgZmlsZSBtb2RlIDEwMDc1NQppbmRleCAwMDAwMDAw
MDAwLi5lZWUzOTRiNDM5Ci0tLSAvZGV2L251bGwKKysrIGIvdGFyZ2V0L2hleGFnb24vZ2VuX2Fu
YWx5emVfZnVuY190YWJsZS5weQpAQCAtMCwwICsxLDUyIEBACisjIS91c3IvYmluL2VudiBweXRo
b24zCisKKyMjCisjIyAgQ29weXJpZ2h0KGMpIDIwMjItMjAyMyBRdWFsY29tbSBJbm5vdmF0aW9u
IENlbnRlciwgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLgorIyMKKyMjICBUaGlzIHByb2dyYW0g
aXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQor
IyMgIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2Ug
YXMgcHVibGlzaGVkIGJ5CisjIyAgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVy
IHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IKKyMjICAoYXQgeW91ciBvcHRpb24pIGFueSBs
YXRlciB2ZXJzaW9uLgorIyMKKyMjICBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhl
IGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyMjICBidXQgV0lUSE9VVCBBTlkgV0FSUkFO
VFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgorIyMgIE1FUkNIQU5UQUJJ
TElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKKyMjICBH
TlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorIyMKKyMjICBZb3Ug
c2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGlj
ZW5zZQorIyMgIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtOyBpZiBub3QsIHNlZSA8aHR0cDovL3d3
dy5nbnUub3JnL2xpY2Vuc2VzLz4uCisjIworCitpbXBvcnQgc3lzCitpbXBvcnQgcmUKK2ltcG9y
dCBzdHJpbmcKK2ltcG9ydCBoZXhfY29tbW9uCisKK2RlZiBtYWluKCk6CisgICAgaGV4X2NvbW1v
bi5yZWFkX3NlbWFudGljc19maWxlKHN5cy5hcmd2WzFdKQorICAgIGhleF9jb21tb24ucmVhZF9h
dHRyaWJzX2ZpbGUoc3lzLmFyZ3ZbMl0pCisgICAgaGV4X2NvbW1vbi5jYWxjdWxhdGVfYXR0cmli
cygpCisgICAgdGFncmVncyA9IGhleF9jb21tb24uZ2V0X3RhZ3JlZ3MoKQorICAgIHRhZ2ltbXMg
PSBoZXhfY29tbW9uLmdldF90YWdpbW1zKCkKKworICAgIHdpdGggb3BlbihzeXMuYXJndlszXSwg
J3cnKSBhcyBmOgorICAgICAgICBmLndyaXRlKCIjaWZuZGVmIEhFWEFHT05fQU5BTFlaRV9UQUJM
RV9IXG4iKQorICAgICAgICBmLndyaXRlKCIjZGVmaW5lIEhFWEFHT05fQU5BTFlaRV9UQUJMRV9I
XG5cbiIpCisKKyAgICAgICAgZi53cml0ZSgic3RhdGljIGNvbnN0IEFuYWx5emVJbnNuIG9wY29k
ZV9hbmFseXplW1hYX0xBU1RfT1BDT0RFXSA9IHtcbiIpCisgICAgICAgIGZvciB0YWcgaW4gaGV4
X2NvbW1vbi50YWdzOgorICAgICAgICAgICAgIyMgU2tpcCB0aGUgZGlhZyBpbnN0cnVjdGlvbnMK
KyAgICAgICAgICAgIGlmICggdGFnID09ICJZNl9kaWFnIiApIDoKKyAgICAgICAgICAgICAgICBj
b250aW51ZQorICAgICAgICAgICAgaWYgKCB0YWcgPT0gIlk2X2RpYWcwIiApIDoKKyAgICAgICAg
ICAgICAgICBjb250aW51ZQorICAgICAgICAgICAgaWYgKCB0YWcgPT0gIlk2X2RpYWcxIiApIDoK
KyAgICAgICAgICAgICAgICBjb250aW51ZQorCisgICAgICAgICAgICBmLndyaXRlKCIgICAgWyVz
XSA9IGFuYWx5emVfJXMsXG4iICUgKHRhZywgdGFnKSkKKyAgICAgICAgZi53cml0ZSgifTtcblxu
IikKKworICAgICAgICBmLndyaXRlKCIjZW5kaWYgICAgLyogSEVYQUdPTl9BTkFMWVpFX1RBQkxF
X0ggKi9cbiIpCisKK2lmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CisgICAgbWFpbigpCmRpZmYg
LS1naXQgYS90YXJnZXQvaGV4YWdvbi9nZW5fYW5hbHl6ZV9mdW5jcy5weSBiL3RhcmdldC9oZXhh
Z29uL2dlbl9hbmFseXplX2Z1bmNzLnB5Cm5ldyBmaWxlIG1vZGUgMTAwNzU1CmluZGV4IDAwMDAw
MDAwMDAuLjQzNThjYzZjYTMKLS0tIC9kZXYvbnVsbAorKysgYi90YXJnZXQvaGV4YWdvbi9nZW5f
YW5hbHl6ZV9mdW5jcy5weQpAQCAtMCwwICsxLDIzOSBAQAorIyEvdXNyL2Jpbi9lbnYgcHl0aG9u
MworCisjIworIyMgIENvcHlyaWdodChjKSAyMDIyLTIwMjMgUXVhbGNvbW0gSW5ub3ZhdGlvbiBD
ZW50ZXIsIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KKyMjCisjIyAgVGhpcyBwcm9ncmFtIGlz
IGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKKyMj
ICBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFz
IHB1Ymxpc2hlZCBieQorIyMgIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2
ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yCisjIyAgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0
ZXIgdmVyc2lvbi4KKyMjCisjIyAgVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBo
b3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisjIyAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZ
OyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyMjICBNRVJDSEFOVEFCSUxJ
VFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCisjIyAgR05V
IEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKyMjCisjIyAgWW91IHNo
b3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vu
c2UKKyMjICBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93d3cu
Z251Lm9yZy9saWNlbnNlcy8+LgorIyMKKworaW1wb3J0IHN5cworaW1wb3J0IHJlCitpbXBvcnQg
c3RyaW5nCitpbXBvcnQgaGV4X2NvbW1vbgorCisjIworIyMgSGVscGVycyBmb3IgZ2VuX2FuYWx5
emVfZnVuYworIyMKK2RlZiBpc19wcmVkaWNhdGVkKHRhZyk6CisgICAgcmV0dXJuICdBX0NPTkRF
WEVDJyBpbiBoZXhfY29tbW9uLmF0dHJpYmRpY3RbdGFnXQorCitkZWYgYW5hbHl6ZV9vcG5fb2xk
KGYsIHRhZywgcmVndHlwZSwgcmVnaWQsIHJlZ25vKToKKyAgICByZWdOID0gIiVzJXNOIiAlIChy
ZWd0eXBlLCByZWdpZCkKKyAgICBwcmVkaWNhdGVkID0gInRydWUiIGlmIGlzX3ByZWRpY2F0ZWQo
dGFnKSBlbHNlICJmYWxzZSIKKyAgICBpZiAocmVndHlwZSA9PSAiUiIpOgorICAgICAgICBpZiAo
cmVnaWQgaW4geyJzcyIsICJ0dCJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0
IGludCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04s
IHJlZ25vKSkKKyAgICAgICAgZWxpZiAocmVnaWQgaW4geyJkZCIsICJlZSIsICJ4eCIsICJ5eSJ9
KToKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1sl
ZF07XG4iICUgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICBjdHhfbG9n
X3JlZ193cml0ZV9wYWlyKGN0eCwgJXMsICVzKTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJl
Z04sIHByZWRpY2F0ZWQpKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7InMiLCAidCIsICJ1Iiwg
InYifSk6CisgICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5y
ZWdub1slZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAg
IGVsaWYgKHJlZ2lkIGluIHsiZCIsICJlIiwgIngiLCAieSJ9KToKKyAgICAgICAgICAgIGYud3Jp
dGUoIiAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4iICUgKHJlZ04sIHJlZ25v
KSkKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICBjdHhfbG9nX3JlZ193cml0ZShjdHgsICVzLCAl
cyk7XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCBwcmVkaWNhdGVkKSkKKyAgICAgICAg
ZWxzZToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUs
IHJlZ2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIlAiKToKKyAgICAgICAgaWYgKHJlZ2lkIGlu
IHsicyIsICJ0IiwgInUiLCAidiJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0
IGludCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04s
IHJlZ25vKSkKKyAgICAgICAgZWxpZiAocmVnaWQgaW4geyJkIiwgImUiLCAieCJ9KToKKyAgICAg
ICAgICAgIGYud3JpdGUoIiAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4iICUg
KHJlZ04sIHJlZ25vKSkKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICBjdHhfbG9nX3ByZWRfd3Jp
dGUoY3R4LCAlcyk7XG4iICUgKHJlZ04pKQorICAgICAgICBlbHNlOgorICAgICAgICAgICAgcHJp
bnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCisgICAgZWxpZiAocmVn
dHlwZSA9PSAiQyIpOgorICAgICAgICBpZiAocmVnaWQgPT0gInNzIik6CisgICAgICAgICAgICBm
LndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF0gKyBIRVhfUkVHX1NB
MDtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxpZiAo
cmVnaWQgPT0gImRkIik6CisgICAgICAgICAgICBmLndyaXRlKCIgICAgY29uc3QgaW50ICVzID0g
aW5zbi0+cmVnbm9bJWRdICsgSEVYX1JFR19TQTA7XG4iICUgXAorICAgICAgICAgICAgICAgIChy
ZWdOLCByZWdubykpCisgICAgICAgICAgICBmLndyaXRlKCIgICAgY3R4X2xvZ19yZWdfd3JpdGVf
cGFpcihjdHgsICVzLCAlcyk7XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCBwcmVkaWNh
dGVkKSkKKyAgICAgICAgZWxpZiAocmVnaWQgPT0gInMiKToKKyAgICAgICAgICAgIGYud3JpdGUo
Ii8vICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVkXSArIEhFWF9SRUdfU0EwO1xuIiAl
IFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbGlmIChyZWdpZCA9
PSAiZCIpOgorICAgICAgICAgICAgZi53cml0ZSgiICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJl
Z25vWyVkXSArIEhFWF9SRUdfU0EwO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVn
bm8pKQorICAgICAgICAgICAgZi53cml0ZSgiICAgIGN0eF9sb2dfcmVnX3dyaXRlKGN0eCwgJXMs
ICVzKTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHByZWRpY2F0ZWQpKQorICAgICAg
ICBlbHNlOgorICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlw
ZSwgcmVnaWQpCisgICAgZWxpZiAocmVndHlwZSA9PSAiTSIpOgorICAgICAgICBpZiAocmVnaWQg
PT0gInUiKToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24t
PnJlZ25vWyVkXTtcbiIlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAg
ICBlbHNlOgorICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlw
ZSwgcmVnaWQpCisgICAgZWxpZiAocmVndHlwZSA9PSAiViIpOgorICAgICAgICBpZiAocmVnaWQg
aW4geyJkZCIsICJ4eCJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAl
cyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJVwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8p
KQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7InV1IiwgInZ2In0pOgorICAgICAgICAgICAgZi53
cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwKKyAgICAg
ICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7InMiLCAi
dSIsICJ2IiwgIncifSk6CisgICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMg
PSBpbnNuLT5yZWdub1slZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykp
CisgICAgICAgIGVsaWYgKHJlZ2lkIGluIHsiZCIsICJ4IiwgInkifSk6CisgICAgICAgICAgICBm
LndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4iICUgXAorICAg
ICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBw
cmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKyAgICBlbGlmIChy
ZWd0eXBlID09ICJRIik6CisgICAgICAgIGlmIChyZWdpZCBpbiB7ImQiLCAiZSIsICJ4In0pOgor
ICAgICAgICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRd
O1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbGlmIChy
ZWdpZCBpbiB7InMiLCAidCIsICJ1IiwgInYifSk6CisgICAgICAgICAgICBmLndyaXRlKCIvLyAg
ICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4iICUgXAorICAgICAgICAgICAgICAg
IChyZWdOLCByZWdubykpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFkIHJl
Z2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKyAgICBlbGlmIChyZWd0eXBlID09ICJH
Iik6CisgICAgICAgIGlmIChyZWdpZCBpbiB7ImRkIn0pOgorICAgICAgICAgICAgZi53cml0ZSgi
Ly8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwKKyAgICAgICAgICAg
ICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7ImQifSk6CisgICAg
ICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4i
ICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVsaWYgKHJlZ2lk
IGluIHsic3MifSk6CisgICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBp
bnNuLT5yZWdub1slZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisg
ICAgICAgIGVsaWYgKHJlZ2lkIGluIHsicyJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAg
IGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAg
KHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxzZToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVn
aXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIlMi
KToKKyAgICAgICAgaWYgKHJlZ2lkIGluIHsiZGQifSk6CisgICAgICAgICAgICBmLndyaXRlKCIv
LyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4iICUgXAorICAgICAgICAgICAg
ICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVsaWYgKHJlZ2lkIGluIHsiZCJ9KToKKyAgICAg
ICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIg
JSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxpZiAocmVnaWQg
aW4geyJzcyJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGlu
c24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAg
ICAgICAgZWxpZiAocmVnaWQgaW4geyJzIn0pOgorICAgICAgICAgICAgZi53cml0ZSgiLy8gICAg
Y29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAo
cmVnTiwgcmVnbm8pKQorICAgICAgICBlbHNlOgorICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdp
c3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCisgICAgZWxzZToKKyAgICAgICAgcHJpbnQo
IkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCisKK2RlZiBhbmFseXplX29w
bl9uZXcoZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgcmVnbm8pOgorICAgIHJlZ04gPSAiJXMlc04i
ICUgKHJlZ3R5cGUsIHJlZ2lkKQorICAgIGlmIChyZWd0eXBlID09ICJOIik6CisgICAgICAgIGlm
IChyZWdpZCBpbiB7InMiLCAidCJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0
IGludCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04s
IHJlZ25vKSkKKyAgICAgICAgZWxzZToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIg
cGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIlAiKToKKyAg
ICAgICAgaWYgKHJlZ2lkIGluIHsidCIsICJ1IiwgInYifSk6CisgICAgICAgICAgICBmLndyaXRl
KCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4iICUgXAorICAgICAgICAg
ICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBwcmludCgi
QmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKyAgICBlbGlmIChyZWd0eXBl
ID09ICJPIik6CisgICAgICAgIGlmIChyZWdpZCA9PSAicyIpOgorICAgICAgICAgICAgZi53cml0
ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwKKyAgICAgICAg
ICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbHNlOgorICAgICAgICAgICAgcHJpbnQo
IkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCisgICAgZWxzZToKKyAgICAg
ICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCisKK2RlZiBh
bmFseXplX29wbihmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCB0b3NzLCBudW1yZWdzLCBpKToKKyAg
ICBpZiAoaGV4X2NvbW1vbi5pc19wYWlyKHJlZ2lkKSk6CisgICAgICAgIGFuYWx5emVfb3BuX29s
ZChmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCBpKQorICAgIGVsaWYgKGhleF9jb21tb24uaXNfc2lu
Z2xlKHJlZ2lkKSk6CisgICAgICAgIGlmIGhleF9jb21tb24uaXNfb2xkX3ZhbChyZWd0eXBlLCBy
ZWdpZCwgdGFnKToKKyAgICAgICAgICAgIGFuYWx5emVfb3BuX29sZChmLHRhZywgcmVndHlwZSwg
cmVnaWQsIGkpCisgICAgICAgIGVsaWYgaGV4X2NvbW1vbi5pc19uZXdfdmFsKHJlZ3R5cGUsIHJl
Z2lkLCB0YWcpOgorICAgICAgICAgICAgYW5hbHl6ZV9vcG5fbmV3KGYsIHRhZywgcmVndHlwZSwg
cmVnaWQsIGkpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVy
IHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCwgdG9zcywgbnVtcmVncykKKyAgICBlbHNlOgorICAg
ICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCwgdG9zcywg
bnVtcmVncykKKworIyMKKyMjIEdlbmVyYXRlIHRoZSBjb2RlIHRvIGFuYWx5emUgdGhlIGluc3Ry
dWN0aW9uCisjIyAgICAgRm9yIEEyX2FkZDogUmQzMj1hZGQoUnMzMixSdDMyKSwgeyBSZFY9UnNW
K1J0Vjt9CisjIyAgICAgV2UgcHJvZHVjZToKKyMjICAgICBzdGF0aWMgdm9pZCBhbmFseXplX0Ey
X2FkZChEaXNhc0NvbnRleHQgKmN0eCkKKyMjICAgICB7CisjIyAgICAgICAgIEluc24gKmluc24g
X19hdHRyaWJ1dGVfXygodW51c2VkKSkgPSBjdHgtPmluc247CisjIyAgICAgICAgIGNvbnN0IGlu
dCBSZE4gPSBpbnNuLT5yZWdub1swXTsKKyMjICAgICAgICAgY3R4X2xvZ19yZWdfd3JpdGUoY3R4
LCBSZE4sIGZhbHNlKTsKKyMjICAgICAvLyAgICBjb25zdCBpbnQgUnNOID0gaW5zbi0+cmVnbm9b
MV07CisjIyAgICAgLy8gICAgY29uc3QgaW50IFJ0TiA9IGluc24tPnJlZ25vWzJdOworIyMgICAg
IH0KKyMjCitkZWYgZ2VuX2FuYWx5emVfZnVuYyhmLCB0YWcsIHJlZ3MsIGltbXMpOgorICAgIGYu
d3JpdGUoInN0YXRpYyB2b2lkIGFuYWx5emVfJXMoRGlzYXNDb250ZXh0ICpjdHgpXG4iICV0YWcp
CisgICAgZi53cml0ZSgne1xuJykKKworICAgIGYud3JpdGUoIiAgICBJbnNuICppbnNuIF9fYXR0
cmlidXRlX18oKHVudXNlZCkpID0gY3R4LT5pbnNuO1xuIikKKworICAgIGk9MAorICAgICMjIEFu
YWx5emUgYWxsIHRoZSByZWdpc3RlcnMKKyAgICBmb3IgcmVndHlwZSwgcmVnaWQsIHRvc3MsIG51
bXJlZ3MgaW4gcmVnczoKKyAgICAgICAgYW5hbHl6ZV9vcG4oZiwgdGFnLCByZWd0eXBlLCByZWdp
ZCwgdG9zcywgbnVtcmVncywgaSkKKyAgICAgICAgaSArPSAxCisKKworICAgIGYud3JpdGUoIn1c
blxuIikKKworZGVmIGdlbl9kZWZfYW5hbHl6ZV9mdW5jKGYsIHRhZywgdGFncmVncywgdGFnaW1t
cyk6CisgICAgcmVncyA9IHRhZ3JlZ3NbdGFnXQorICAgIGltbXMgPSB0YWdpbW1zW3RhZ10KKwor
ICAgIGdlbl9hbmFseXplX2Z1bmMoZiwgdGFnLCByZWdzLCBpbW1zKQorCitkZWYgbWFpbigpOgor
ICAgIGhleF9jb21tb24ucmVhZF9zZW1hbnRpY3NfZmlsZShzeXMuYXJndlsxXSkKKyAgICBoZXhf
Y29tbW9uLnJlYWRfYXR0cmlic19maWxlKHN5cy5hcmd2WzJdKQorICAgIGhleF9jb21tb24ucmVh
ZF9vdmVycmlkZXNfZmlsZShzeXMuYXJndlszXSkKKyAgICBoZXhfY29tbW9uLnJlYWRfb3ZlcnJp
ZGVzX2ZpbGUoc3lzLmFyZ3ZbNF0pCisgICAgaGV4X2NvbW1vbi5jYWxjdWxhdGVfYXR0cmlicygp
CisgICAgdGFncmVncyA9IGhleF9jb21tb24uZ2V0X3RhZ3JlZ3MoKQorICAgIHRhZ2ltbXMgPSBo
ZXhfY29tbW9uLmdldF90YWdpbW1zKCkKKworICAgIHdpdGggb3BlbihzeXMuYXJndls1XSwgJ3cn
KSBhcyBmOgorICAgICAgICBmLndyaXRlKCIjaWZuZGVmIEhFWEFHT05fVENHX0ZVTkNTX0hcbiIp
CisgICAgICAgIGYud3JpdGUoIiNkZWZpbmUgSEVYQUdPTl9UQ0dfRlVOQ1NfSFxuXG4iKQorCisg
ICAgICAgIGZvciB0YWcgaW4gaGV4X2NvbW1vbi50YWdzOgorICAgICAgICAgICAgIyMgU2tpcCB0
aGUgZGlhZyBpbnN0cnVjdGlvbnMKKyAgICAgICAgICAgIGlmICggdGFnID09ICJZNl9kaWFnIiAp
IDoKKyAgICAgICAgICAgICAgICBjb250aW51ZQorICAgICAgICAgICAgaWYgKCB0YWcgPT0gIlk2
X2RpYWcwIiApIDoKKyAgICAgICAgICAgICAgICBjb250aW51ZQorICAgICAgICAgICAgaWYgKCB0
YWcgPT0gIlk2X2RpYWcxIiApIDoKKyAgICAgICAgICAgICAgICBjb250aW51ZQorCisgICAgICAg
ICAgICBnZW5fZGVmX2FuYWx5emVfZnVuYyhmLCB0YWcsIHRhZ3JlZ3MsIHRhZ2ltbXMpCisKKyAg
ICAgICAgZi53cml0ZSgiI2VuZGlmICAgIC8qIEhFWEFHT05fVENHX0ZVTkNTX0ggKi9cbiIpCisK
K2lmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CisgICAgbWFpbigpCmRpZmYgLS1naXQgYS90YXJn
ZXQvaGV4YWdvbi9nZW5fdGNnX2Z1bmNzLnB5IGIvdGFyZ2V0L2hleGFnb24vZ2VuX3RjZ19mdW5j
cy5weQppbmRleCA3ZThiYTE3Y2EyLi41ZDY4NmViY2YxIDEwMDc1NQotLS0gYS90YXJnZXQvaGV4
YWdvbi9nZW5fdGNnX2Z1bmNzLnB5CisrKyBiL3RhcmdldC9oZXhhZ29uL2dlbl90Y2dfZnVuY3Mu
cHkKQEAgLTEsNyArMSw3IEBACiAjIS91c3IvYmluL2VudiBweXRob24zCiAKICMjCi0jIyAgQ29w
eXJpZ2h0KGMpIDIwMTktMjAyMiBRdWFsY29tbSBJbm5vdmF0aW9uIENlbnRlciwgSW5jLiBBbGwg
UmlnaHRzIFJlc2VydmVkLgorIyMgIENvcHlyaWdodChjKSAyMDE5LTIwMjMgUXVhbGNvbW0gSW5u
b3ZhdGlvbiBDZW50ZXIsIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KICMjCiAjIyAgVGhpcyBw
cm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBt
b2RpZnkKICMjICBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBM
aWNlbnNlIGFzIHB1Ymxpc2hlZCBieQpAQCAtNDQsMTUgKzQ0LDYgQEAgZGVmIGdlbnB0cl9kZWNs
X3BhaXJfd3JpdGFibGUoZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgcmVnbm8pOgogICAgICAgICAg
ICAgKHJlZ04sIHJlZ25vKSkKICAgICBlbHNlOgogICAgICAgICBmLndyaXRlKCIgICAgY29uc3Qg
aW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIChyZWdOLCByZWdubykpCi0gICAgaWYgKCdB
X0NPTkRFWEVDJyBpbiBoZXhfY29tbW9uLmF0dHJpYmRpY3RbdGFnXSk6Ci0gICAgICAgIGYud3Jp
dGUoIiAgICBpZiAoIWlzX3ByZWxvYWRlZChjdHgsICVzKSkge1xuIiAlIHJlZ04pCi0gICAgICAg
IGYud3JpdGUoIiAgICAgICAgdGNnX2dlbl9tb3ZfdGwoaGV4X25ld192YWx1ZVslc10sIGhleF9n
cHJbJXNdKTtcbiIgJSBcCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIChyZWdOLCByZWdO
KSkKLSAgICAgICAgZi53cml0ZSgiICAgIH1cbiIpCi0gICAgICAgIGYud3JpdGUoIiAgICBpZiAo
IWlzX3ByZWxvYWRlZChjdHgsICVzICsgMSkpIHtcbiIgJSByZWdOKQotICAgICAgICBmLndyaXRl
KCIgICAgICAgIHRjZ19nZW5fbW92X3RsKGhleF9uZXdfdmFsdWVbJXMgKyAxXSwgaGV4X2dwclsl
cyArIDFdKTtcbiIgJSBcCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIChyZWdOLCByZWdO
KSkKLSAgICAgICAgZi53cml0ZSgiICAgIH1cbiIpCiAKIGRlZiBnZW5wdHJfZGVjbF93cml0YWJs
ZShmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCByZWdubyk6CiAgICAgcmVnTj0iJXMlc04iICUgKHJl
Z3R5cGUscmVnaWQpCkBAIC02MywxMSArNTQsNiBAQCBkZWYgZ2VucHRyX2RlY2xfd3JpdGFibGUo
ZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgcmVnbm8pOgogICAgICAgICAgICAgKHJlZ04sIHJlZ25v
KSkKICAgICBlbHNlOgogICAgICAgICBmLndyaXRlKCIgICAgY29uc3QgaW50ICVzID0gaW5zbi0+
cmVnbm9bJWRdO1xuIiAlIChyZWdOLCByZWdubykpCi0gICAgaWYgKCdBX0NPTkRFWEVDJyBpbiBo
ZXhfY29tbW9uLmF0dHJpYmRpY3RbdGFnXSk6Ci0gICAgICAgIGYud3JpdGUoIiAgICBpZiAoIWlz
X3ByZWxvYWRlZChjdHgsICVzKSkge1xuIiAlIHJlZ04pCi0gICAgICAgIGYud3JpdGUoIiAgICAg
ICAgdGNnX2dlbl9tb3ZfdGwoaGV4X25ld192YWx1ZVslc10sIGhleF9ncHJbJXNdKTtcbiIgJSBc
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIChyZWdOLCByZWdOKSkKLSAgICAgICAgZi53
cml0ZSgiICAgIH1cbiIpCiAKIGRlZiBnZW5wdHJfZGVjbChmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lk
LCByZWdubyk6CiAgICAgcmVnTj0iJXMlc04iICUgKHJlZ3R5cGUscmVnaWQpCkBAIC00NjUsOCAr
NDUxLDYgQEAgZGVmIGdlbnB0cl9kc3Rfd3JpdGVfcGFpcihmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lk
KToKICAgICBlbHNlOgogICAgICAgICBmLndyaXRlKCIgICAgZ2VuX2xvZ19yZWdfd3JpdGVfcGFp
ciglcyVzTiwgJXMlc1YpO1xuIiAlIFwKICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCwgcmVn
dHlwZSwgcmVnaWQpKQotICAgIGYud3JpdGUoIiAgICBjdHhfbG9nX3JlZ193cml0ZV9wYWlyKGN0
eCwgJXMlc04pO1xuIiAlIFwKLSAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkKIAogZGVmIGdlbnB0
cl9kc3Rfd3JpdGUoZiwgdGFnLCByZWd0eXBlLCByZWdpZCk6CiAgICAgaWYgKHJlZ3R5cGUgPT0g
IlIiKToKQEAgLTQ4MCwxNiArNDY0LDEyIEBAIGRlZiBnZW5wdHJfZHN0X3dyaXRlKGYsIHRhZywg
cmVndHlwZSwgcmVnaWQpOgogICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICBmLndy
aXRlKCIgICAgZ2VuX2xvZ19yZWdfd3JpdGUoJXMlc04sICVzJXNWKTtcbiIgJSBcCiAgICAgICAg
ICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCwgcmVndHlwZSwgcmVnaWQpKQotICAgICAgICAg
ICAgZi53cml0ZSgiICAgIGN0eF9sb2dfcmVnX3dyaXRlKGN0eCwgJXMlc04pO1xuIiAlIFwKLSAg
ICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQpKQogICAgICAgICBlbHNlOgogICAgICAgICAg
ICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCiAgICAgZWxp
ZiAocmVndHlwZSA9PSAiUCIpOgogICAgICAgICBpZiAocmVnaWQgaW4geyJkIiwgImUiLCAieCJ9
KToKICAgICAgICAgICAgIGYud3JpdGUoIiAgICBnZW5fbG9nX3ByZWRfd3JpdGUoY3R4LCAlcyVz
TiwgJXMlc1YpO1xuIiAlIFwKICAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQsIHJlZ3R5
cGUsIHJlZ2lkKSkKLSAgICAgICAgICAgIGYud3JpdGUoIiAgICBjdHhfbG9nX3ByZWRfd3JpdGUo
Y3R4LCAlcyVzTik7XG4iICUgXAotICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkpCiAg
ICAgICAgIGVsc2U6CiAgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCBy
ZWd0eXBlLCByZWdpZCkKICAgICBlbGlmIChyZWd0eXBlID09ICJDIik6CkBAIC01ODEsNyArNTYx
LDYgQEAgZGVmIGdlbnB0cl9kc3Rfd3JpdGVfb3BuKGYscmVndHlwZSwgcmVnaWQsIHRhZyk6CiAj
IyAgICAgICAgICAgVENHdiBSdFYgPSBoZXhfZ3ByW2luc24tPnJlZ25vWzJdXTsKICMjICAgICAg
ICAgICA8R0VOPgogIyMgICAgICAgICAgIGdlbl9sb2dfcmVnX3dyaXRlKFJkTiwgUmRWKTsKLSMj
ICAgICAgICAgICBjdHhfbG9nX3JlZ193cml0ZShjdHgsIFJkTik7CiAjIyAgICAgICAgICAgdGNn
X3RlbXBfZnJlZShSZFYpOwogIyMgICAgICAgfQogIyMKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhh
Z29uL21lc29uLmJ1aWxkIGIvdGFyZ2V0L2hleGFnb24vbWVzb24uYnVpbGQKaW5kZXggZThmMjUw
ZmNhYy4uYmE3Mzc0Zjg3ZiAxMDA2NDQKLS0tIGEvdGFyZ2V0L2hleGFnb24vbWVzb24uYnVpbGQK
KysrIGIvdGFyZ2V0L2hleGFnb24vbWVzb24uYnVpbGQKQEAgLTEsNSArMSw1IEBACiAjIwotIyMg
IENvcHlyaWdodChjKSAyMDIwLTIwMjEgUXVhbGNvbW0gSW5ub3ZhdGlvbiBDZW50ZXIsIEluYy4g
QWxsIFJpZ2h0cyBSZXNlcnZlZC4KKyMjICBDb3B5cmlnaHQoYykgMjAyMC0yMDIzIFF1YWxjb21t
IElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAjIwogIyMgIFRo
aXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQv
b3IgbW9kaWZ5CiAjIyAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJs
aWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKQEAgLTY3LDYgKzY3LDI0IEBAIHRjZ19mdW5jX3Rh
YmxlX2dlbmVyYXRlZCA9IGN1c3RvbV90YXJnZXQoCiApCiBoZXhhZ29uX3NzLmFkZCh0Y2dfZnVu
Y190YWJsZV9nZW5lcmF0ZWQpCiAKK2FuYWx5emVfZnVuY3NfZ2VuZXJhdGVkID0gY3VzdG9tX3Rh
cmdldCgKKyAgICAnYW5hbHl6ZV9mdW5jc19nZW5lcmF0ZWQuYy5pbmMnLAorICAgIG91dHB1dDog
J2FuYWx5emVfZnVuY3NfZ2VuZXJhdGVkLmMuaW5jJywKKyAgICBkZXBlbmRzOiBbc2VtYW50aWNz
X2dlbmVyYXRlZF0sCisgICAgZGVwZW5kX2ZpbGVzOiBbaGV4X2NvbW1vbl9weSwgYXR0cmlic19k
ZWYsIGdlbl90Y2dfaCwgZ2VuX3RjZ19odnhfaF0sCisgICAgY29tbWFuZDogW3B5dGhvbiwgZmls
ZXMoJ2dlbl9hbmFseXplX2Z1bmNzLnB5JyksIHNlbWFudGljc19nZW5lcmF0ZWQsIGF0dHJpYnNf
ZGVmLCBnZW5fdGNnX2gsIGdlbl90Y2dfaHZ4X2gsICdAT1VUUFVUQCddLAorKQoraGV4YWdvbl9z
cy5hZGQoYW5hbHl6ZV9mdW5jc19nZW5lcmF0ZWQpCisKK2FuYWx5emVfZnVuY190YWJsZV9nZW5l
cmF0ZWQgPSBjdXN0b21fdGFyZ2V0KAorICAgICdhbmFseXplX2Z1bmNfdGFibGVfZ2VuZXJhdGVk
LmMuaW5jJywKKyAgICBvdXRwdXQ6ICdhbmFseXplX2Z1bmNfdGFibGVfZ2VuZXJhdGVkLmMuaW5j
JywKKyAgICBkZXBlbmRzOiBbc2VtYW50aWNzX2dlbmVyYXRlZF0sCisgICAgZGVwZW5kX2ZpbGVz
OiBbaGV4X2NvbW1vbl9weSwgYXR0cmlic19kZWZdLAorICAgIGNvbW1hbmQ6IFtweXRob24sIGZp
bGVzKCdnZW5fYW5hbHl6ZV9mdW5jX3RhYmxlLnB5JyksIHNlbWFudGljc19nZW5lcmF0ZWQsIGF0
dHJpYnNfZGVmLCAnQE9VVFBVVEAnXSwKKykKK2hleGFnb25fc3MuYWRkKGFuYWx5emVfZnVuY190
YWJsZV9nZW5lcmF0ZWQpCisKIHByaW50aW5zbl9nZW5lcmF0ZWQgPSBjdXN0b21fdGFyZ2V0KAog
ICAgICdwcmludGluc25fZ2VuZXJhdGVkLmguaW5jJywKICAgICBvdXRwdXQ6ICdwcmludGluc25f
Z2VuZXJhdGVkLmguaW5jJywKLS0gCjIuMTcuMQoK

