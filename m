Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id 69C6767A8F3
	for <lists+qemu-devel@lfdr.de>; Wed, 25 Jan 2023 03:44:18 +0100 (CET)
Received: from localhost ([::1] helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces@nongnu.org>)
	id 1pKVkH-0006lB-8t; Tue, 24 Jan 2023 21:42:41 -0500
Received: from eggs.gnu.org ([2001:470:142:3::10])
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1pKVkB-0006ja-Vy
 for qemu-devel@nongnu.org; Tue, 24 Jan 2023 21:42:36 -0500
Received: from mx0b-0031df01.pphosted.com ([205.220.180.131])
 by eggs.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1pKVk7-0007A4-4X
 for qemu-devel@nongnu.org; Tue, 24 Jan 2023 21:42:35 -0500
Received: from pps.filterd (m0279873.ppops.net [127.0.0.1])
 by mx0a-0031df01.pphosted.com (8.17.1.19/8.17.1.19) with ESMTP id
 30P2NWcI018644; Wed, 25 Jan 2023 02:42:19 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=quicinc.com;
 h=from : to : cc :
 subject : date : message-id : in-reply-to : references : mime-version :
 content-type : content-transfer-encoding; s=qcppdkim1;
 bh=tw5/ipo92FrC6fC6urTglBFfI/7UfnYAQ0rNPGMGpv4=;
 b=YkPixeSwlzGNqWfDytgw48ompH2ySsATobP7uqkBsUCX9PFEc8r7X8p4Ka/2Bk43nLte
 UPEUIzEWa2uY5lQ5SdNwmK5ZXD1sPGHrcqhLiWEhLbgoBxQjadAEUda8gKDmHO8VkJxI
 jH/dPuVItgQ44dKjFUKRsd/hEgwjL39VwLgl/Mb7wOIE3DHe3PV2a15M/M9tAerwgkSB
 8kgs4VyF0wZbeqDReG9cyIdUxeCPX7KyH/hu6uYxAb/fSgZ3S8KI3bbpCODr1lJ7j8Ul
 yMuD4A3dviqy3CTP+sVWRIu6KtAOVaFfXSZRA2mN31GJEJmZ0RnRxBaMRLOVIl8q+uoD zA== 
Received: from nalasppmta04.qualcomm.com (Global_NAT1.qualcomm.com
 [129.46.96.20])
 by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 3najkh920n-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Wed, 25 Jan 2023 02:42:18 +0000
Received: from pps.filterd (NALASPPMTA04.qualcomm.com [127.0.0.1])
 by NALASPPMTA04.qualcomm.com (8.17.1.5/8.17.1.5) with ESMTP id 30P2gHXS026523; 
 Wed, 25 Jan 2023 02:42:17 GMT
Received: from pps.reinject (localhost [127.0.0.1])
 by NALASPPMTA04.qualcomm.com (PPS) with ESMTP id 3n894kr76v-1;
 Wed, 25 Jan 2023 02:42:17 +0000
Received: from NALASPPMTA04.qualcomm.com (NALASPPMTA04.qualcomm.com
 [127.0.0.1])
 by pps.reinject (8.17.1.5/8.17.1.5) with ESMTP id 30P2gHX9026510;
 Wed, 25 Jan 2023 02:42:17 GMT
Received: from hu-devc-lv-u18-c.qualcomm.com (hu-tsimpson-lv.qualcomm.com
 [10.47.235.220])
 by NALASPPMTA04.qualcomm.com (PPS) with ESMTP id 30P2gHS7026504;
 Wed, 25 Jan 2023 02:42:17 +0000
Received: by hu-devc-lv-u18-c.qualcomm.com (Postfix, from userid 47164)
 id 7F52B5000B1; Tue, 24 Jan 2023 18:42:16 -0800 (PST)
From: Taylor Simpson <tsimpson@quicinc.com>
To: qemu-devel@nongnu.org
Cc: tsimpson@quicinc.com, richard.henderson@linaro.org, philmd@linaro.org,
 ale@rev.ng, anjo@rev.ng, bcain@quicinc.com, quic_mathbern@quicinc.com
Subject: [PATCH v4 05/13] Hexagon (target/hexagon) Analyze packet before
 generating TCG
Date: Tue, 24 Jan 2023 18:42:07 -0800
Message-Id: <20230125024215.10430-6-tsimpson@quicinc.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20230125024215.10430-1-tsimpson@quicinc.com>
References: <20230125024215.10430-1-tsimpson@quicinc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
X-QCInternal: smtphost
X-QCInternal: smtphost
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-ORIG-GUID: LDzfgBeV15RQFIP6770zcHdTt2WgQYay
X-Proofpoint-GUID: LDzfgBeV15RQFIP6770zcHdTt2WgQYay
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.219,Aquarius:18.0.930,Hydra:6.0.562,FMLib:17.11.122.1
 definitions=2023-01-24_17,2023-01-24_01,2022-06-22_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 malwarescore=0 bulkscore=0
 adultscore=0 spamscore=0 suspectscore=0 mlxlogscore=767 clxscore=1015
 lowpriorityscore=0 impostorscore=0 mlxscore=0 priorityscore=1501
 phishscore=0 classifier=spam adjust=0 reason=mlx scancount=1
 engine=8.12.0-2212070000 definitions=main-2301250020
Received-SPF: pass client-ip=205.220.180.131;
 envelope-from=tsimpson@qualcomm.com; helo=mx0b-0031df01.pphosted.com
X-Spam_score_int: -17
X-Spam_score: -1.8
X-Spam_bar: -
X-Spam_report: (-1.8 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, HEADER_FROM_DIFFERENT_DOMAINS=0.248,
 SPF_HELO_NONE=0.001, SPF_PASS=-0.001 autolearn=no autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org

V2UgY3JlYXRlIGEgbmV3IGdlbmVyYXRvciB0aGF0IGNyZWF0ZXMgYW4gYW5hbHl6ZV88dGFnPiBm
dW5jdGlvbiBmb3IKZWFjaCBpbnN0cnVjdGlvbi4gIEN1cnJlbnRseSwgdGhlc2UgZnVuY3Rpb25z
IHJlY29yZCB0aGUgd3JpdGVzIHRvClIsIFAsIGFuZCBDIHJlZ2lzdGVycyBieSBjYWxsaW5nIGN0
eF9sb2dfcmVnX3dyaXRlW19wYWlyXSBvcgpjdHhfbG9nX3ByZWRfd3JpdGUuCgpEdXJpbmcgZ2Vu
X3N0YXJ0X3BhY2tldCwgd2UgaW52b2tlIHRoZSBhbmFseXplXzx0YWc+IGZ1bmN0aW9uIGZvcgpl
YWNoIGluc3RydWN0aW9uIGluIHRoZSBwYWNrZXQsIGFuZCB3ZSBtYXJrIHRoZSBpbXBsaWNpdCBy
ZWdpc3RlcgphbmQgcHJlZGljYXRlIHdyaXRlcy4KCkRvaW5nIHRoZSBhbmFseXNpcyB1cCBmcm9u
dCBoYXMgc2V2ZXJhbCBhZHZhbnRhZ2VzCi0gV2UgcmVtb3ZlIGNhbGxzIHRvIGN0eF9sb2dfKiBm
cm9tIGdlbl90Y2dfZnVuY3MucHkgYW5kIGdlbnB0ci5jCi0gQWZ0ZXIgdGhlIGFuYWx5c2lzIGlz
IHBlcmZvcm1lZCwgd2UgY2FuIGluaXRpYWxpemUgaGV4X25ld192YWx1ZQogIGZvciBlYWNoIG9m
IHRoZSBwcmVkaWNhdGVkIGFzc2lnbm1lbnRzIHJhdGhlciB0aGFuIGR1cmluZyBUQ0cKICBnZW5l
cmF0aW9uIGZvciB0aGUgaW5zdHJ1Y3Rpb25zCi0gVGhpcyBpcyBhIHN0ZXBwaW5nIHN0b25lIGZv
ciBmdXR1cmUgd29yayB3aGVyZSB0aGUgYW5hbHlzaXMgd2lsbAogIGluY2x1ZGUgdGhlIHNldCBv
ZiByZWdpc3RlcnMgdGhhdCBhcmUgcmVhZC4gIEluIGNhc2VzIHdoZXJlCiAgdGhlIHBhY2tldCBk
b2Vzbid0IGhhdmUgYW4gb3ZlcmxhcCBiZXR3ZWVuIHRoZSByZWdpc3RlcnMgdGhhdCBhcmUKICB3
cml0dGVuIGFuZCByZWdpc3RlcnMgdGhhdCBhcmUgcmVhZCwgd2UgY2FuIGF2b2lkIHRoZSBpbnRl
cm1lZGlhdGUKICBzdGVwIG9mIHdyaXRpbmcgdG8gaGV4X25ld192YWx1ZS4gIE5vdGUgdGhhdCBv
dGhlciBjaGVja3Mgd2lsbCBhbHNvCiAgYmUgbmVlZGVkIChlLmcuLCBubyBpbnN0cnVjdGlvbnMg
Y2FuIHJhaXNlIGFuIGV4Y2VwdGlvbikuCgpTaWduZWQtb2ZmLWJ5OiBUYXlsb3IgU2ltcHNvbiA8
dHNpbXBzb25AcXVpY2luYy5jb20+Ci0tLQogdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmggICAg
ICAgICAgICAgICAgICB8ICA0NiArKy0tCiB0YXJnZXQvaGV4YWdvbi9nZW5wdHIuYyAgICAgICAg
ICAgICAgICAgICAgIHwgICA1ICstCiB0YXJnZXQvaGV4YWdvbi9pZGVmLXBhcnNlci9wYXJzZXIt
aGVscGVycy5jIHwgICA3ICstCiB0YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuYyAgICAgICAgICAg
ICAgICAgIHwgMTYwICsrKysrKysrLS0tLS0tCiB0YXJnZXQvaGV4YWdvbi9SRUFETUUgICAgICAg
ICAgICAgICAgICAgICAgIHwgIDEwICstCiB0YXJnZXQvaGV4YWdvbi9nZW5fYW5hbHl6ZV9mdW5j
cy5weSAgICAgICAgIHwgMjI1ICsrKysrKysrKysrKysrKysrKysrCiB0YXJnZXQvaGV4YWdvbi9n
ZW5fdGNnX2Z1bmNzLnB5ICAgICAgICAgICAgIHwgIDIzICstCiB0YXJnZXQvaGV4YWdvbi9tZXNv
bi5idWlsZCAgICAgICAgICAgICAgICAgIHwgIDExICstCiA4IGZpbGVzIGNoYW5nZWQsIDM3MCBp
bnNlcnRpb25zKCspLCAxMTcgZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9kZSAxMDA3NTUgdGFyZ2V0
L2hleGFnb24vZ2VuX2FuYWx5emVfZnVuY3MucHkKCmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdv
bi90cmFuc2xhdGUuaCBiL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5oCmluZGV4IGQ5NzFmNGYw
OTUuLmQ0NWQzYTRiYjAgMTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5oCisr
KyBiL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5oCkBAIC0xLDUgKzEsNSBAQAogLyoKLSAqICBD
b3B5cmlnaHQoYykgMjAxOS0yMDIyIFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFs
bCBSaWdodHMgUmVzZXJ2ZWQuCisgKiAgQ29weXJpZ2h0KGMpIDIwMTktMjAyMyBRdWFsY29tbSBJ
bm5vdmF0aW9uIENlbnRlciwgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogICoKICAqICBUaGlz
IHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29y
IG1vZGlmeQogICogIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGlj
IExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5CkBAIC0zOCw2ICszOCw3IEBAIHR5cGVkZWYgc3RydWN0
IERpc2FzQ29udGV4dCB7CiAgICAgaW50IHJlZ19sb2dbUkVHX1dSSVRFU19NQVhdOwogICAgIGlu
dCByZWdfbG9nX2lkeDsKICAgICBERUNMQVJFX0JJVE1BUChyZWdzX3dyaXR0ZW4sIFRPVEFMX1BF
Ul9USFJFQURfUkVHUyk7CisgICAgREVDTEFSRV9CSVRNQVAocHJlZGljYXRlZF9yZWdzLCBUT1RB
TF9QRVJfVEhSRUFEX1JFR1MpOwogICAgIGludCBwcmVnX2xvZ1tQUkVEX1dSSVRFU19NQVhdOwog
ICAgIGludCBwcmVnX2xvZ19pZHg7CiAgICAgREVDTEFSRV9CSVRNQVAocHJlZ3Nfd3JpdHRlbiwg
TlVNX1BSRUdTKTsKQEAgLTYyLDMyICs2MywzOSBAQCB0eXBlZGVmIHN0cnVjdCBEaXNhc0NvbnRl
eHQgewogICAgIGJvb2wgaXNfdGlnaHRfbG9vcDsKIH0gRGlzYXNDb250ZXh0OwogCi1zdGF0aWMg
aW5saW5lIHZvaWQgY3R4X2xvZ19yZWdfd3JpdGUoRGlzYXNDb250ZXh0ICpjdHgsIGludCBybnVt
KQorc3RhdGljIGlubGluZSB2b2lkIGN0eF9sb2dfcHJlZF93cml0ZShEaXNhc0NvbnRleHQgKmN0
eCwgaW50IHBudW0pCiB7Ci0gICAgaWYgKHRlc3RfYml0KHJudW0sIGN0eC0+cmVnc193cml0dGVu
KSkgewotICAgICAgICBIRVhfREVCVUdfTE9HKCJXQVJOSU5HOiBNdWx0aXBsZSB3cml0ZXMgdG8g
ciVkXG4iLCBybnVtKTsKKyAgICBpZiAoIXRlc3RfYml0KHBudW0sIGN0eC0+cHJlZ3Nfd3JpdHRl
bikpIHsKKyAgICAgICAgY3R4LT5wcmVnX2xvZ1tjdHgtPnByZWdfbG9nX2lkeF0gPSBwbnVtOwor
ICAgICAgICBjdHgtPnByZWdfbG9nX2lkeCsrOworICAgICAgICBzZXRfYml0KHBudW0sIGN0eC0+
cHJlZ3Nfd3JpdHRlbik7CiAgICAgfQotICAgIGN0eC0+cmVnX2xvZ1tjdHgtPnJlZ19sb2dfaWR4
XSA9IHJudW07Ci0gICAgY3R4LT5yZWdfbG9nX2lkeCsrOwotICAgIHNldF9iaXQocm51bSwgY3R4
LT5yZWdzX3dyaXR0ZW4pOwotfQotCi1zdGF0aWMgaW5saW5lIHZvaWQgY3R4X2xvZ19yZWdfd3Jp
dGVfcGFpcihEaXNhc0NvbnRleHQgKmN0eCwgaW50IHJudW0pCi17Ci0gICAgY3R4X2xvZ19yZWdf
d3JpdGUoY3R4LCBybnVtKTsKLSAgICBjdHhfbG9nX3JlZ193cml0ZShjdHgsIHJudW0gKyAxKTsK
IH0KIAotc3RhdGljIGlubGluZSB2b2lkIGN0eF9sb2dfcHJlZF93cml0ZShEaXNhc0NvbnRleHQg
KmN0eCwgaW50IHBudW0pCitzdGF0aWMgaW5saW5lIHZvaWQgY3R4X2xvZ19yZWdfd3JpdGUoRGlz
YXNDb250ZXh0ICpjdHgsIGludCBybnVtLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGJvb2wgaXNfcHJlZGljYXRlZCkKIHsKLSAgICBjdHgtPnByZWdfbG9nW2N0eC0+cHJl
Z19sb2dfaWR4XSA9IHBudW07Ci0gICAgY3R4LT5wcmVnX2xvZ19pZHgrKzsKLSAgICBzZXRfYml0
KHBudW0sIGN0eC0+cHJlZ3Nfd3JpdHRlbik7CisgICAgaWYgKHJudW0gPT0gSEVYX1JFR19QM18w
X0FMSUFTRUQpIHsKKyAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBOVU1fUFJFR1M7IGkrKykg
eworICAgICAgICAgICAgY3R4X2xvZ19wcmVkX3dyaXRlKGN0eCwgaSk7CisgICAgICAgIH0KKyAg
ICB9IGVsc2UgeworICAgICAgICBpZiAoIXRlc3RfYml0KHJudW0sIGN0eC0+cmVnc193cml0dGVu
KSkgeworICAgICAgICAgICAgY3R4LT5yZWdfbG9nW2N0eC0+cmVnX2xvZ19pZHhdID0gcm51bTsK
KyAgICAgICAgICAgIGN0eC0+cmVnX2xvZ19pZHgrKzsKKyAgICAgICAgICAgIHNldF9iaXQocm51
bSwgY3R4LT5yZWdzX3dyaXR0ZW4pOworICAgICAgICB9CisgICAgICAgIGlmIChpc19wcmVkaWNh
dGVkKSB7CisgICAgICAgICAgICBzZXRfYml0KHJudW0sIGN0eC0+cHJlZGljYXRlZF9yZWdzKTsK
KyAgICAgICAgfQorICAgIH0KIH0KIAotc3RhdGljIGlubGluZSBib29sIGlzX3ByZWxvYWRlZChE
aXNhc0NvbnRleHQgKmN0eCwgaW50IG51bSkKK3N0YXRpYyBpbmxpbmUgdm9pZCBjdHhfbG9nX3Jl
Z193cml0ZV9wYWlyKERpc2FzQ29udGV4dCAqY3R4LCBpbnQgcm51bSwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgaXNfcHJlZGljYXRlZCkKIHsKLSAgICBy
ZXR1cm4gdGVzdF9iaXQobnVtLCBjdHgtPnJlZ3Nfd3JpdHRlbik7CisgICAgY3R4X2xvZ19yZWdf
d3JpdGUoY3R4LCBybnVtLCBpc19wcmVkaWNhdGVkKTsKKyAgICBjdHhfbG9nX3JlZ193cml0ZShj
dHgsIHJudW0gKyAxLCBpc19wcmVkaWNhdGVkKTsKIH0KIAogc3RhdGljIGlubGluZSBib29sIGlz
X3ZyZWdfcHJlbG9hZGVkKERpc2FzQ29udGV4dCAqY3R4LCBpbnQgbnVtKQpkaWZmIC0tZ2l0IGEv
dGFyZ2V0L2hleGFnb24vZ2VucHRyLmMgYi90YXJnZXQvaGV4YWdvbi9nZW5wdHIuYwppbmRleCBl
ZmQzNmY3NjBmLi42N2VjM2FjNTUxIDEwMDY0NAotLS0gYS90YXJnZXQvaGV4YWdvbi9nZW5wdHIu
YworKysgYi90YXJnZXQvaGV4YWdvbi9nZW5wdHIuYwpAQCAtMTg5LDYgKzE4OSw3IEBAIHZvaWQg
Z2VuX2xvZ19wcmVkX3dyaXRlKERpc2FzQ29udGV4dCAqY3R4LCBpbnQgcG51bSwgVENHdiB2YWwp
CiAgICAgICAgICAgICAgICAgICAgICAgIGhleF9uZXdfcHJlZF92YWx1ZVtwbnVtXSwgYmFzZV92
YWwpOwogICAgIH0KICAgICB0Y2dfZ2VuX29yaV90bChoZXhfcHJlZF93cml0dGVuLCBoZXhfcHJl
ZF93cml0dGVuLCAxIDw8IHBudW0pOworICAgIHNldF9iaXQocG51bSwgY3R4LT5wcmVnc193cml0
dGVuKTsKIAogICAgIHRjZ190ZW1wX2ZyZWUoYmFzZV92YWwpOwogfQpAQCAtMjcxLDcgKzI3Miw2
IEBAIHN0YXRpYyB2b2lkIGdlbl93cml0ZV9wM18wKERpc2FzQ29udGV4dCAqY3R4LCBUQ0d2IGNv
bnRyb2xfcmVnKQogICAgIGZvciAoaW50IGkgPSAwOyBpIDwgTlVNX1BSRUdTOyBpKyspIHsKICAg
ICAgICAgdGNnX2dlbl9leHRyYWN0X3RsKGhleF9wOCwgY29udHJvbF9yZWcsIGkgKiA4LCA4KTsK
ICAgICAgICAgZ2VuX2xvZ19wcmVkX3dyaXRlKGN0eCwgaSwgaGV4X3A4KTsKLSAgICAgICAgY3R4
X2xvZ19wcmVkX3dyaXRlKGN0eCwgaSk7CiAgICAgfQogICAgIHRjZ190ZW1wX2ZyZWUoaGV4X3A4
KTsKIH0KQEAgLTI5MCw3ICsyOTAsNiBAQCBzdGF0aWMgaW5saW5lIHZvaWQgZ2VuX3dyaXRlX2N0
cmxfcmVnKERpc2FzQ29udGV4dCAqY3R4LCBpbnQgcmVnX251bSwKICAgICAgICAgZ2VuX3dyaXRl
X3AzXzAoY3R4LCB2YWwpOwogICAgIH0gZWxzZSB7CiAgICAgICAgIGdlbl9sb2dfcmVnX3dyaXRl
KHJlZ19udW0sIHZhbCk7Ci0gICAgICAgIGN0eF9sb2dfcmVnX3dyaXRlKGN0eCwgcmVnX251bSk7
CiAgICAgICAgIGlmIChyZWdfbnVtID09IEhFWF9SRUdfUUVNVV9QS1RfQ05UKSB7CiAgICAgICAg
ICAgICBjdHgtPm51bV9wYWNrZXRzID0gMDsKICAgICAgICAgfQpAQCAtMzEzLDEwICszMTIsOCBA
QCBzdGF0aWMgaW5saW5lIHZvaWQgZ2VuX3dyaXRlX2N0cmxfcmVnX3BhaXIoRGlzYXNDb250ZXh0
ICpjdHgsIGludCByZWdfbnVtLAogICAgICAgICB0Y2dfZ2VuX2V4dHJoX2k2NF9pMzIodmFsMzIs
IHZhbCk7CiAgICAgICAgIGdlbl9sb2dfcmVnX3dyaXRlKHJlZ19udW0gKyAxLCB2YWwzMik7CiAg
ICAgICAgIHRjZ190ZW1wX2ZyZWUodmFsMzIpOwotICAgICAgICBjdHhfbG9nX3JlZ193cml0ZShj
dHgsIHJlZ19udW0gKyAxKTsKICAgICB9IGVsc2UgewogICAgICAgICBnZW5fbG9nX3JlZ193cml0
ZV9wYWlyKHJlZ19udW0sIHZhbCk7Ci0gICAgICAgIGN0eF9sb2dfcmVnX3dyaXRlX3BhaXIoY3R4
LCByZWdfbnVtKTsKICAgICAgICAgaWYgKHJlZ19udW0gPT0gSEVYX1JFR19RRU1VX1BLVF9DTlQp
IHsKICAgICAgICAgICAgIGN0eC0+bnVtX3BhY2tldHMgPSAwOwogICAgICAgICAgICAgY3R4LT5u
dW1faW5zbnMgPSAwOwpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vaWRlZi1wYXJzZXIvcGFy
c2VyLWhlbHBlcnMuYyBiL3RhcmdldC9oZXhhZ29uL2lkZWYtcGFyc2VyL3BhcnNlci1oZWxwZXJz
LmMKaW5kZXggODExMDY4NmM1MS4uZGU5ODM4ODA2YiAxMDA2NDQKLS0tIGEvdGFyZ2V0L2hleGFn
b24vaWRlZi1wYXJzZXIvcGFyc2VyLWhlbHBlcnMuYworKysgYi90YXJnZXQvaGV4YWdvbi9pZGVm
LXBhcnNlci9wYXJzZXItaGVscGVycy5jCkBAIC0xLDUgKzEsNSBAQAogLyoKLSAqICBDb3B5cmln
aHQoYykgMjAxOS0yMDIyIHJldi5uZyBMYWJzIFNybC4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KKyAq
ICBDb3B5cmlnaHQoYykgMjAxOS0yMDIzIHJldi5uZyBMYWJzIFNybC4gQWxsIFJpZ2h0cyBSZXNl
cnZlZC4KICAqCiAgKiAgVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVk
aXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKICAqICBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhl
IEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQpAQCAtMTQzOCwxMCAr
MTQzOCw2IEBAIHZvaWQgZ2VuX3dyaXRlX3JlZyhDb250ZXh0ICpjLCBZWUxUWVBFICpsb2NwLCBI
ZXhWYWx1ZSAqcmVnLCBIZXhWYWx1ZSAqdmFsdWUpCiAgICAgICAgIGxvY3AsCiAgICAgICAgICJn
ZW5fbG9nX3JlZ193cml0ZSgiLCAmcmVnLT5yZWcuaWQsICIsICIsCiAgICAgICAgICZ2YWx1ZV9t
LCAiKTtcbiIpOwotICAgIE9VVChjLAotICAgICAgICBsb2NwLAotICAgICAgICAiY3R4X2xvZ19y
ZWdfd3JpdGUoY3R4LCAiLCAmcmVnLT5yZWcuaWQsCi0gICAgICAgICIpO1xuIik7CiAgICAgZ2Vu
X3J2YWx1ZV9mcmVlKGMsIGxvY3AsIHJlZyk7CiAgICAgZ2VuX3J2YWx1ZV9mcmVlKGMsIGxvY3As
ICZ2YWx1ZV9tKTsKIH0KQEAgLTE4OTQsNyArMTg5MCw2IEBAIHZvaWQgZ2VuX3ByZWRfYXNzaWdu
KENvbnRleHQgKmMsIFlZTFRZUEUgKmxvY3AsIEhleFZhbHVlICpsZWZ0X3ByZWQsCiAgICAgaWYg
KGlzX2RpcmVjdCkgewogICAgICAgICBPVVQoYywgbG9jcCwgImdlbl9sb2dfcHJlZF93cml0ZShj
dHgsICIsIHByZWRfaWQsICIsICIsIGxlZnRfcHJlZCwKICAgICAgICAgICAgICIpO1xuIik7Ci0g
ICAgICAgIE9VVChjLCBsb2NwLCAiY3R4X2xvZ19wcmVkX3dyaXRlKGN0eCwgIiwgcHJlZF9pZCwg
Iik7XG4iKTsKICAgICAgICAgZ2VuX3J2YWx1ZV9mcmVlKGMsIGxvY3AsIGxlZnRfcHJlZCk7CiAg
ICAgfQogICAgIC8qIEZyZWUgdGVtcG9yYXJ5IHZhbHVlICovCmRpZmYgLS1naXQgYS90YXJnZXQv
aGV4YWdvbi90cmFuc2xhdGUuYyBiL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5jCmluZGV4IDVi
ZTI0MTAyYWEuLjhmMzQzNmQ2OWEgMTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0
ZS5jCisrKyBiL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5jCkBAIC0yOSw2ICsyOSwxNSBAQAog
I2luY2x1ZGUgInRyYW5zbGF0ZS5oIgogI2luY2x1ZGUgInByaW50aW5zbi5oIgogCisjaW5jbHVk
ZSAiYW5hbHl6ZV9mdW5jc19nZW5lcmF0ZWQuYy5pbmMiCisKK3R5cGVkZWYgdm9pZCAoKkFuYWx5
emVJbnNuKShEaXNhc0NvbnRleHQgKmN0eCk7CitzdGF0aWMgY29uc3QgQW5hbHl6ZUluc24gb3Bj
b2RlX2FuYWx5emVbWFhfTEFTVF9PUENPREVdID0geworI2RlZmluZSBPUENPREUoWCkgICAgW1hd
ID0gYW5hbHl6ZV8jI1gKKyNpbmNsdWRlICJvcGNvZGVzX2RlZl9nZW5lcmF0ZWQuaC5pbmMiCisj
dW5kZWYgT1BDT0RFCit9OworCiBUQ0d2IGhleF9ncHJbVE9UQUxfUEVSX1RIUkVBRF9SRUdTXTsK
IFRDR3YgaGV4X3ByZWRbTlVNX1BSRUdTXTsKIFRDR3YgaGV4X3RoaXNfUEM7CkBAIC0yNjQsNiAr
MjczLDc2IEBAIHN0YXRpYyBib29sIG5lZWRfbmV4dF9QQyhEaXNhc0NvbnRleHQgKmN0eCkKICAg
ICByZXR1cm4gZmFsc2U7CiB9CiAKKy8qCisgKiBUaGUgb3Bjb2RlX2FuYWx5emUgZnVuY3Rpb25z
IG1hcmsgbW9zdCBvZiB0aGUgd3JpdGVzIGluIGEgcGFja2V0CisgKiBIb3dldmVyLCB0aGVyZSBh
cmUgc29tZSBpbXBsaWNpdCB3cml0ZXMgbWFya2VkIGFzIGF0dHJpYnV0ZXMKKyAqIG9mIHRoZSBh
cHBsaWNhYmxlIGluc3RydWN0aW9ucy4KKyAqLworc3RhdGljIHZvaWQgbWFya19pbXBsaWNpdF9y
ZWdfd3JpdGUoRGlzYXNDb250ZXh0ICpjdHgsIGludCBhdHRyaWIsIGludCBybnVtKQoreworICAg
IHVpbnQxNl90IG9wY29kZSA9IGN0eC0+aW5zbi0+b3Bjb2RlOworICAgIGlmIChHRVRfQVRUUklC
KG9wY29kZSwgYXR0cmliKSkgeworICAgICAgICAvKgorICAgICAgICAgKiBVU1IgaXMgdXNlZCB0
byBzZXQgb3ZlcmZsb3cgYW5kIEZQIGV4Y2VwdGlvbnMsCisgICAgICAgICAqIHNvIHRyZWF0IGl0
IGFzIGNvbmRpdGlvbmFsCisgICAgICAgICAqLworICAgICAgICBib29sIGlzX3ByZWRpY2F0ZWQg
PSBHRVRfQVRUUklCKG9wY29kZSwgQV9DT05ERVhFQykgfHwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgcm51bSA9PSBIRVhfUkVHX1VTUjsKKworICAgICAgICAvKiBMQzAvTEMxIGlzIGNv
bmRpdGlvbmFsbHkgd3JpdHRlbiBieSBlbmRsb29wIGluc3RydWN0aW9ucyAqLworICAgICAgICBp
ZiAoKHJudW0gPT0gSEVYX1JFR19MQzAgfHwgcm51bSA9PSBIRVhfUkVHX0xDMSkgJiYKKyAgICAg
ICAgICAgIChvcGNvZGUgPT0gSjJfZW5kbG9vcDAgfHwKKyAgICAgICAgICAgICBvcGNvZGUgPT0g
SjJfZW5kbG9vcDEgfHwKKyAgICAgICAgICAgICBvcGNvZGUgPT0gSjJfZW5kbG9vcDAxKSkgewor
ICAgICAgICAgICAgaXNfcHJlZGljYXRlZCA9IHRydWU7CisgICAgICAgIH0KKworICAgICAgICBj
dHhfbG9nX3JlZ193cml0ZShjdHgsIHJudW0sIGlzX3ByZWRpY2F0ZWQpOworICAgIH0KK30KKwor
c3RhdGljIHZvaWQgbWFya19pbXBsaWNpdF9yZWdfd3JpdGVzKERpc2FzQ29udGV4dCAqY3R4KQor
eworICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfRlAs
ICBIRVhfUkVHX0ZQKTsKKyAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1QTElD
SVRfV1JJVEVTX1NQLCAgSEVYX1JFR19TUCk7CisgICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUo
Y3R4LCBBX0lNUExJQ0lUX1dSSVRFU19MUiwgIEhFWF9SRUdfTFIpOworICAgIG1hcmtfaW1wbGlj
aXRfcmVnX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfTEMwLCBIRVhfUkVHX0xDMCk7Cisg
ICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19TQTAsIEhF
WF9SRUdfU0EwKTsKKyAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRf
V1JJVEVTX0xDMSwgSEVYX1JFR19MQzEpOworICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0
eCwgQV9JTVBMSUNJVF9XUklURVNfU0ExLCBIRVhfUkVHX1NBMSk7CisgICAgbWFya19pbXBsaWNp
dF9yZWdfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19VU1IsIEhFWF9SRUdfVVNSKTsKKyAg
ICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFfRlBPUCwgSEVYX1JFR19VU1IpOworfQor
CitzdGF0aWMgdm9pZCBtYXJrX2ltcGxpY2l0X3ByZWRfd3JpdGUoRGlzYXNDb250ZXh0ICpjdHgs
IGludCBhdHRyaWIsIGludCBwbnVtKQoreworICAgIGlmIChHRVRfQVRUUklCKGN0eC0+aW5zbi0+
b3Bjb2RlLCBhdHRyaWIpKSB7CisgICAgICAgIGN0eF9sb2dfcHJlZF93cml0ZShjdHgsIHBudW0p
OworICAgIH0KK30KKworc3RhdGljIHZvaWQgbWFya19pbXBsaWNpdF9wcmVkX3dyaXRlcyhEaXNh
c0NvbnRleHQgKmN0eCkKK3sKKyAgICBtYXJrX2ltcGxpY2l0X3ByZWRfd3JpdGUoY3R4LCBBX0lN
UExJQ0lUX1dSSVRFU19QMCwgMCk7CisgICAgbWFya19pbXBsaWNpdF9wcmVkX3dyaXRlKGN0eCwg
QV9JTVBMSUNJVF9XUklURVNfUDEsIDEpOworICAgIG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZShj
dHgsIEFfSU1QTElDSVRfV1JJVEVTX1AyLCAyKTsKKyAgICBtYXJrX2ltcGxpY2l0X3ByZWRfd3Jp
dGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19QMywgMyk7Cit9CisKK3N0YXRpYyB2b2lkIGFuYWx5
emVfcGFja2V0KERpc2FzQ29udGV4dCAqY3R4KQoreworICAgIFBhY2tldCAqcGt0ID0gY3R4LT5w
a3Q7CisgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBwa3QtPm51bV9pbnNuczsgaSsrKSB7CisgICAg
ICAgIEluc24gKmluc24gPSAmcGt0LT5pbnNuW2ldOworICAgICAgICBjdHgtPmluc24gPSBpbnNu
OworICAgICAgICBpZiAob3Bjb2RlX2FuYWx5emVbaW5zbi0+b3Bjb2RlXSkgeworICAgICAgICAg
ICAgb3Bjb2RlX2FuYWx5emVbaW5zbi0+b3Bjb2RlXShjdHgpOworICAgICAgICB9CisgICAgICAg
IG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlcyhjdHgpOworICAgICAgICBtYXJrX2ltcGxpY2l0X3By
ZWRfd3JpdGVzKGN0eCk7CisgICAgfQorfQorCiBzdGF0aWMgdm9pZCBnZW5fc3RhcnRfcGFja2V0
KERpc2FzQ29udGV4dCAqY3R4KQogewogICAgIFBhY2tldCAqcGt0ID0gY3R4LT5wa3Q7CkBAIC0y
NzQsNiArMzUzLDcgQEAgc3RhdGljIHZvaWQgZ2VuX3N0YXJ0X3BhY2tldChEaXNhc0NvbnRleHQg
KmN0eCkKICAgICBjdHgtPm5leHRfUEMgPSBuZXh0X1BDOwogICAgIGN0eC0+cmVnX2xvZ19pZHgg
PSAwOwogICAgIGJpdG1hcF96ZXJvKGN0eC0+cmVnc193cml0dGVuLCBUT1RBTF9QRVJfVEhSRUFE
X1JFR1MpOworICAgIGJpdG1hcF96ZXJvKGN0eC0+cHJlZGljYXRlZF9yZWdzLCBUT1RBTF9QRVJf
VEhSRUFEX1JFR1MpOwogICAgIGN0eC0+cHJlZ19sb2dfaWR4ID0gMDsKICAgICBiaXRtYXBfemVy
byhjdHgtPnByZWdzX3dyaXR0ZW4sIE5VTV9QUkVHUyk7CiAgICAgY3R4LT5mdXR1cmVfdnJlZ3Nf
aWR4ID0gMDsKQEAgLTI4OSw2ICszNjksMTQgQEAgc3RhdGljIHZvaWQgZ2VuX3N0YXJ0X3BhY2tl
dChEaXNhc0NvbnRleHQgKmN0eCkKICAgICBjdHgtPnMxX3N0b3JlX3Byb2Nlc3NlZCA9IGZhbHNl
OwogICAgIGN0eC0+cHJlX2NvbW1pdCA9IHRydWU7CiAKKyAgICBhbmFseXplX3BhY2tldChjdHgp
OworCisgICAgLyoKKyAgICAgKiBwcmVnc193cml0dGVuIGlzIHVzZWQgYm90aCBpbiB0aGUgYW5h
bHl6ZSBwaGFzZSBhcyB3ZWxsIGFzIHRoZSBjb2RlCisgICAgICogZ2VuIHBoYXNlLCBzbyBjbGVh
ciBpdCBhZ2Fpbi4KKyAgICAgKi8KKyAgICBiaXRtYXBfemVybyhjdHgtPnByZWdzX3dyaXR0ZW4s
IE5VTV9QUkVHUyk7CisKICAgICBpZiAoSEVYX0RFQlVHKSB7CiAgICAgICAgIC8qIEhhbmR5IHBs
YWNlIHRvIHNldCBhIGJyZWFrcG9pbnQgYmVmb3JlIHRoZSBwYWNrZXQgZXhlY3V0ZXMgKi8KICAg
ICAgICAgZ2VuX2hlbHBlcl9kZWJ1Z19zdGFydF9wYWNrZXQoY3B1X2Vudik7CkBAIC0zMTEsNiAr
Mzk5LDE2IEBAIHN0YXRpYyB2b2lkIGdlbl9zdGFydF9wYWNrZXQoRGlzYXNDb250ZXh0ICpjdHgp
CiAgICAgICAgIHRjZ19nZW5fbW92aV90bChoZXhfcHJlZF93cml0dGVuLCAwKTsKICAgICB9CiAK
KyAgICAvKiBQcmVsb2FkIHRoZSBwcmVkaWNhdGVkIHJlZ2lzdGVycyBpbnRvIGhleF9uZXdfdmFs
dWVbaV0gKi8KKyAgICBpZiAoIWJpdG1hcF9lbXB0eShjdHgtPnByZWRpY2F0ZWRfcmVncywgVE9U
QUxfUEVSX1RIUkVBRF9SRUdTKSkgeworICAgICAgICBpbnQgaSA9IGZpbmRfZmlyc3RfYml0KGN0
eC0+cHJlZGljYXRlZF9yZWdzLCBUT1RBTF9QRVJfVEhSRUFEX1JFR1MpOworICAgICAgICB3aGls
ZSAoaSA8IFRPVEFMX1BFUl9USFJFQURfUkVHUykgeworICAgICAgICAgICAgdGNnX2dlbl9tb3Zf
dGwoaGV4X25ld192YWx1ZVtpXSwgaGV4X2dwcltpXSk7CisgICAgICAgICAgICBpID0gZmluZF9u
ZXh0X2JpdChjdHgtPnByZWRpY2F0ZWRfcmVncywgVE9UQUxfUEVSX1RIUkVBRF9SRUdTLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgaSArIDEpOworICAgICAgICB9CisgICAgfQorCiAg
ICAgaWYgKHBrdC0+cGt0X2hhc19odngpIHsKICAgICAgICAgdGNnX2dlbl9tb3ZpX3RsKGhleF9W
UmVnc191cGRhdGVkLCAwKTsKICAgICAgICAgdGNnX2dlbl9tb3ZpX3RsKGhleF9RUmVnc191cGRh
dGVkLCAwKTsKQEAgLTMzNCw2NiArNDMyLDYgQEAgYm9vbCBpc19nYXRoZXJfc3RvcmVfaW5zbihE
aXNhc0NvbnRleHQgKmN0eCkKICAgICByZXR1cm4gZmFsc2U7CiB9CiAKLS8qCi0gKiBUaGUgTE9H
XypfV1JJVEUgbWFjcm9zIG1hcmsgbW9zdCBvZiB0aGUgd3JpdGVzIGluIGEgcGFja2V0Ci0gKiBI
b3dldmVyLCB0aGVyZSBhcmUgc29tZSBpbXBsaWNpdCB3cml0ZXMgbWFya2VkIGFzIGF0dHJpYnV0
ZXMKLSAqIG9mIHRoZSBhcHBsaWNhYmxlIGluc3RydWN0aW9ucy4KLSAqLwotc3RhdGljIHZvaWQg
bWFya19pbXBsaWNpdF9yZWdfd3JpdGUoRGlzYXNDb250ZXh0ICpjdHgsIGludCBhdHRyaWIsIGlu
dCBybnVtKQotewotICAgIHVpbnQxNl90IG9wY29kZSA9IGN0eC0+aW5zbi0+b3Bjb2RlOwotICAg
IGlmIChHRVRfQVRUUklCKG9wY29kZSwgYXR0cmliKSkgewotICAgICAgICAvKgotICAgICAgICAg
KiBVU1IgaXMgdXNlZCB0byBzZXQgb3ZlcmZsb3cgYW5kIEZQIGV4Y2VwdGlvbnMsCi0gICAgICAg
ICAqIHNvIHRyZWF0IGl0IGFzIGNvbmRpdGlvbmFsCi0gICAgICAgICAqLwotICAgICAgICBib29s
IGlzX3ByZWRpY2F0ZWQgPSBHRVRfQVRUUklCKG9wY29kZSwgQV9DT05ERVhFQykgfHwKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgcm51bSA9PSBIRVhfUkVHX1VTUjsKLQotICAgICAgICAv
KiBMQzAvTEMxIGlzIGNvbmRpdGlvbmFsbHkgd3JpdHRlbiBieSBlbmRsb29wIGluc3RydWN0aW9u
cyAqLwotICAgICAgICBpZiAoKHJudW0gPT0gSEVYX1JFR19MQzAgfHwgcm51bSA9PSBIRVhfUkVH
X0xDMSkgJiYKLSAgICAgICAgICAgIChvcGNvZGUgPT0gSjJfZW5kbG9vcDAgfHwKLSAgICAgICAg
ICAgICBvcGNvZGUgPT0gSjJfZW5kbG9vcDEgfHwKLSAgICAgICAgICAgICBvcGNvZGUgPT0gSjJf
ZW5kbG9vcDAxKSkgewotICAgICAgICAgICAgaXNfcHJlZGljYXRlZCA9IHRydWU7Ci0gICAgICAg
IH0KLQotICAgICAgICBpZiAoaXNfcHJlZGljYXRlZCAmJiAhaXNfcHJlbG9hZGVkKGN0eCwgcm51
bSkpIHsKLSAgICAgICAgICAgIHRjZ19nZW5fbW92X3RsKGhleF9uZXdfdmFsdWVbcm51bV0sIGhl
eF9ncHJbcm51bV0pOwotICAgICAgICB9Ci0KLSAgICAgICAgY3R4X2xvZ19yZWdfd3JpdGUoY3R4
LCBybnVtKTsKLSAgICB9Ci19Ci0KLXN0YXRpYyB2b2lkIG1hcmtfaW1wbGljaXRfcHJlZF93cml0
ZShEaXNhc0NvbnRleHQgKmN0eCwgaW50IGF0dHJpYiwgaW50IHBudW0pCi17Ci0gICAgaWYgKEdF
VF9BVFRSSUIoY3R4LT5pbnNuLT5vcGNvZGUsIGF0dHJpYikpIHsKLSAgICAgICAgY3R4X2xvZ19w
cmVkX3dyaXRlKGN0eCwgcG51bSk7Ci0gICAgfQotfQotCi1zdGF0aWMgdm9pZCBtYXJrX2ltcGxp
Y2l0X3JlZ193cml0ZXMoRGlzYXNDb250ZXh0ICpjdHgpCi17Ci0gICAgbWFya19pbXBsaWNpdF9y
ZWdfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19GUCwgIEhFWF9SRUdfRlApOwotICAgIG1h
cmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfU1AsICBIRVhfUkVH
X1NQKTsKLSAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVT
X0xSLCAgSEVYX1JFR19MUik7Ci0gICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0lN
UExJQ0lUX1dSSVRFU19MQzAsIEhFWF9SRUdfTEMwKTsKLSAgICBtYXJrX2ltcGxpY2l0X3JlZ193
cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX1NBMCwgSEVYX1JFR19TQTApOwotICAgIG1hcmtf
aW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfTEMxLCBIRVhfUkVHX0xD
MSk7Ci0gICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19T
QTEsIEhFWF9SRUdfU0ExKTsKLSAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1Q
TElDSVRfV1JJVEVTX1VTUiwgSEVYX1JFR19VU1IpOwotICAgIG1hcmtfaW1wbGljaXRfcmVnX3dy
aXRlKGN0eCwgQV9GUE9QLCBIRVhfUkVHX1VTUik7Ci19Ci0KLXN0YXRpYyB2b2lkIG1hcmtfaW1w
bGljaXRfcHJlZF93cml0ZXMoRGlzYXNDb250ZXh0ICpjdHgpCi17Ci0gICAgbWFya19pbXBsaWNp
dF9wcmVkX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfUDAsIDApOwotICAgIG1hcmtfaW1w
bGljaXRfcHJlZF93cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX1AxLCAxKTsKLSAgICBtYXJr
X2ltcGxpY2l0X3ByZWRfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19QMiwgMik7Ci0gICAg
bWFya19pbXBsaWNpdF9wcmVkX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfUDMsIDMpOwot
fQotCiBzdGF0aWMgdm9pZCBtYXJrX3N0b3JlX3dpZHRoKERpc2FzQ29udGV4dCAqY3R4KQogewog
ICAgIHVpbnQxNl90IG9wY29kZSA9IGN0eC0+aW5zbi0+b3Bjb2RlOwpAQCAtNDIxLDkgKzQ1OSw3
IEBAIHN0YXRpYyB2b2lkIG1hcmtfc3RvcmVfd2lkdGgoRGlzYXNDb250ZXh0ICpjdHgpCiBzdGF0
aWMgdm9pZCBnZW5faW5zbihEaXNhc0NvbnRleHQgKmN0eCkKIHsKICAgICBpZiAoY3R4LT5pbnNu
LT5nZW5lcmF0ZSkgewotICAgICAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZXMoY3R4KTsKICAg
ICAgICAgY3R4LT5pbnNuLT5nZW5lcmF0ZShjdHgpOwotICAgICAgICBtYXJrX2ltcGxpY2l0X3By
ZWRfd3JpdGVzKGN0eCk7CiAgICAgICAgIG1hcmtfc3RvcmVfd2lkdGgoY3R4KTsKICAgICB9IGVs
c2UgewogICAgICAgICBnZW5fZXhjZXB0aW9uX2VuZF90YihjdHgsIEhFWF9FWENQX0lOVkFMSURf
T1BDT0RFKTsKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29uL1JFQURNRSBiL3RhcmdldC9oZXhh
Z29uL1JFQURNRQppbmRleCA2Y2I1YWZmZGRiLi5kOTI3MzFlMzQ2IDEwMDY0NAotLS0gYS90YXJn
ZXQvaGV4YWdvbi9SRUFETUUKKysrIGIvdGFyZ2V0L2hleGFnb24vUkVBRE1FCkBAIC01Miw2ICs1
Miw3IEBAIGhlYWRlciBmaWxlcyBpbiA8QlVJTERfRElSPi90YXJnZXQvaGV4YWdvbgogICAgICAg
ICBnZW5fdGNnX2Z1bmNfdGFibGUucHkgICAgICAgICAgIC0+IHRjZ19mdW5jX3RhYmxlX2dlbmVy
YXRlZC5jLmluYwogICAgICAgICBnZW5faGVscGVyX2Z1bmNzLnB5ICAgICAgICAgICAgIC0+IGhl
bHBlcl9mdW5jc19nZW5lcmF0ZWQuYy5pbmMKICAgICAgICAgZ2VuX2lkZWZfcGFyc2VyX2Z1bmNz
LnB5ICAgICAgICAtPiBpZGVmX3BhcnNlcl9pbnB1dC5oCisgICAgICAgIGdlbl9hbmFseXplX2Z1
bmNzLnB5ICAgICAgICAgICAgLT4gYW5hbHl6ZV9mdW5jc19nZW5lcmF0ZWQuYy5pbmMKIAogUWVt
dSBoZWxwZXIgZnVuY3Rpb25zIGhhdmUgMyBwYXJ0cwogICAgIERFRl9IRUxQRVIgZGVjbGFyYXRp
b24gaW5kaWNhdGVzIHRoZSBzaWduYXR1cmUgb2YgdGhlIGhlbHBlcgpAQCAtODcsNyArODgsNiBA
QCB0Y2dfZnVuY3NfZ2VuZXJhdGVkLmMuaW5jCiAgICAgICAgIFRDR3YgUnRWID0gaGV4X2dwcltp
bnNuLT5yZWdub1syXV07CiAgICAgICAgIGdlbl9oZWxwZXJfQTJfYWRkKFJkViwgY3B1X2Vudiwg
UnNWLCBSdFYpOwogICAgICAgICBnZW5fbG9nX3JlZ193cml0ZShSZE4sIFJkVik7Ci0gICAgICAg
IGN0eF9sb2dfcmVnX3dyaXRlKGN0eCwgUmROKTsKICAgICAgICAgdGNnX3RlbXBfZnJlZShSZFYp
OwogICAgIH0KIApAQCAtMTYyLDcgKzE2Miw2IEBAIGlzdHJ1Y3Rpb24uCiAgICAgICAgIGdlbl9o
ZWxwZXJfVjZfdmFkZHcoY3B1X2VudiwgVmRWLCBWdVYsIFZ2Viwgc2xvdCk7CiAgICAgICAgIHRj
Z190ZW1wX2ZyZWUoc2xvdCk7CiAgICAgICAgIGdlbl9sb2dfdnJlZ193cml0ZShjdHgsIFZkVl9v
ZmYsIFZkTiwgRVhUX0RGTCwgaW5zbi0+c2xvdCwgZmFsc2UpOwotICAgICAgICBjdHhfbG9nX3Zy
ZWdfd3JpdGUoY3R4LCBWZE4sIEVYVF9ERkwsIGZhbHNlKTsKICAgICAgICAgdGNnX3RlbXBfZnJl
ZV9wdHIoVmRWKTsKICAgICAgICAgdGNnX3RlbXBfZnJlZV9wdHIoVnVWKTsKICAgICAgICAgdGNn
X3RlbXBfZnJlZV9wdHIoVnZWKTsKQEAgLTE5NSw5ICsxOTQsMTQgQEAgd2hlbiB0aGUgb3ZlcnJp
ZGUgaXMgcHJlc2VudC4KICAgICAgICAgICAgIHZyZWdfc3JjX29mZihjdHgsIFZ2Tik7CiAgICAg
ICAgIGZHRU5fVENHX1Y2X3ZhZGR3KHsgZkhJREUoaW50IGk7KSBmVkZPUkVBQ0goMzIsIGkpIHsg
VmRWLndbaV0gPSBWdVYud1tpXSArIFZ2Vi53W2ldIDsgfSB9KTsKICAgICAgICAgZ2VuX2xvZ192
cmVnX3dyaXRlKGN0eCwgVmRWX29mZiwgVmROLCBFWFRfREZMLCBpbnNuLT5zbG90LCBmYWxzZSk7
Ci0gICAgICAgIGN0eF9sb2dfdnJlZ193cml0ZShjdHgsIFZkTiwgRVhUX0RGTCwgZmFsc2UpOwog
ICAgIH0KIAorV2UgYWxzbyBnZW5lcmF0ZSBhbiBhbmFseXplXzx0YWc+IGZ1bmN0aW9uIGZvciBl
YWNoIGluc3RydWN0aW9uLiAgQ3VycmVudGx5LAordGhlc2UgZnVuY3Rpb25zIHJlY29yZCB0aGUg
d3JpdGVzIHRvIHJlZ2lzdGVycyBieSBjYWxsaW5nIGN0eF9sb2dfKi4gIER1cmluZworZ2VuX3N0
YXJ0X3BhY2tldCwgd2UgaW52b2tlIHRoZSBhbmFseXplXzx0YWc+IGZ1bmN0aW9uIGZvciBlYWNo
IGluc3RydWN0aW9uIGluCit0aGUgcGFja2V0LCBhbmQgd2UgbWFyayB0aGUgaW1wbGljaXQgd3Jp
dGVzLiAgQWZ0ZXIgdGhlIGFuYWx5c2lzIGlzIHBlcmZvcm1lZCwKK3dlIGluaXRpYWxpemUgaGV4
X25ld192YWx1ZSBmb3IgZWFjaCBvZiB0aGUgcHJlZGljYXRlZCBhc3NpZ25tZW50cy4KKwogSW4g
YWRkaXRpb24gdG8gaW5zdHJ1Y3Rpb24gc2VtYW50aWNzLCB3ZSB1c2UgYSBnZW5lcmF0b3IgdG8g
Y3JlYXRlIHRoZSBkZWNvZGUKIHRyZWUuICBUaGlzIGdlbmVyYXRpb24gaXMgYWxzbyBhIHR3byBz
dGVwIHByb2Nlc3MuICBUaGUgZmlyc3Qgc3RlcCBpcyB0byBydW4KIHRhcmdldC9oZXhhZ29uL2dl
bl9kZWN0cmVlX2ltcG9ydC5jIHRvIHByb2R1Y2UKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29u
L2dlbl9hbmFseXplX2Z1bmNzLnB5IGIvdGFyZ2V0L2hleGFnb24vZ2VuX2FuYWx5emVfZnVuY3Mu
cHkKbmV3IGZpbGUgbW9kZSAxMDA3NTUKaW5kZXggMDAwMDAwMDAwMC4uNjdhOGU1ZTVlMgotLS0g
L2Rldi9udWxsCisrKyBiL3RhcmdldC9oZXhhZ29uL2dlbl9hbmFseXplX2Z1bmNzLnB5CkBAIC0w
LDAgKzEsMjI1IEBACisjIS91c3IvYmluL2VudiBweXRob24zCisKKyMjCisjIyAgQ29weXJpZ2h0
KGMpIDIwMjItMjAyMyBRdWFsY29tbSBJbm5vdmF0aW9uIENlbnRlciwgSW5jLiBBbGwgUmlnaHRz
IFJlc2VydmVkLgorIyMKKyMjICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNh
biByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQorIyMgIGl0IHVuZGVyIHRoZSB0ZXJtcyBv
ZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5CisjIyAgdGhl
IEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5z
ZSwgb3IKKyMjICAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorIyMKKyMjICBU
aGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVz
ZWZ1bCwKKyMjICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1w
bGllZCB3YXJyYW50eSBvZgorIyMgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBB
UlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKKyMjICBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5z
ZSBmb3IgbW9yZSBkZXRhaWxzLgorIyMKKyMjICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBj
b3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQorIyMgIGFsb25nIHdpdGggdGhp
cyBwcm9ncmFtOyBpZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCisj
IworCitpbXBvcnQgc3lzCitpbXBvcnQgcmUKK2ltcG9ydCBzdHJpbmcKK2ltcG9ydCBoZXhfY29t
bW9uCisKKyMjCisjIyBIZWxwZXJzIGZvciBnZW5fYW5hbHl6ZV9mdW5jCisjIworZGVmIGlzX3By
ZWRpY2F0ZWQodGFnKToKKyAgICByZXR1cm4gJ0FfQ09OREVYRUMnIGluIGhleF9jb21tb24uYXR0
cmliZGljdFt0YWddCisKK2RlZiBhbmFseXplX29wbl9vbGQoZiwgdGFnLCByZWd0eXBlLCByZWdp
ZCwgcmVnbm8pOgorICAgIHJlZ04gPSAiJXMlc04iICUgKHJlZ3R5cGUsIHJlZ2lkKQorICAgIHBy
ZWRpY2F0ZWQgPSAidHJ1ZSIgaWYgaXNfcHJlZGljYXRlZCh0YWcpIGVsc2UgImZhbHNlIgorICAg
IGlmIChyZWd0eXBlID09ICJSIik6CisgICAgICAgIGlmIChyZWdpZCBpbiB7InNzIiwgInR0In0p
OgorICAgICAgICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9b
JWRdO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbGlm
IChyZWdpZCBpbiB7ImRkIiwgImVlIiwgInh4IiwgInl5In0pOgorICAgICAgICAgICAgZi53cml0
ZSgiICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSAocmVnTiwgcmVnbm8p
KQorICAgICAgICAgICAgZi53cml0ZSgiICAgIGN0eF9sb2dfcmVnX3dyaXRlX3BhaXIoY3R4LCAl
cywgJXMpO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcHJlZGljYXRlZCkpCisgICAg
ICAgIGVsaWYgKHJlZ2lkIGluIHsicyIsICJ0IiwgInUiLCAidiJ9KToKKyAgICAgICAgICAgIGYu
d3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAg
ICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxpZiAocmVnaWQgaW4geyJkIiwg
ImUiLCAieCIsICJ5In0pOgorICAgICAgICAgICAgZi53cml0ZSgiICAgIGNvbnN0IGludCAlcyA9
IGluc24tPnJlZ25vWyVkXTtcbiIgJSAocmVnTiwgcmVnbm8pKQorICAgICAgICAgICAgZi53cml0
ZSgiICAgIGN0eF9sb2dfcmVnX3dyaXRlKGN0eCwgJXMsICVzKTtcbiIgJSBcCisgICAgICAgICAg
ICAgICAgKHJlZ04sIHByZWRpY2F0ZWQpKQorICAgICAgICBlbHNlOgorICAgICAgICAgICAgcHJp
bnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCisgICAgZWxpZiAocmVn
dHlwZSA9PSAiUCIpOgorICAgICAgICBpZiAocmVnaWQgaW4geyJzIiwgInQiLCAidSIsICJ2In0p
OgorICAgICAgICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9b
JWRdO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbGlm
IChyZWdpZCBpbiB7ImQiLCAiZSIsICJ4In0pOgorICAgICAgICAgICAgZi53cml0ZSgiICAgIGNv
bnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSAocmVnTiwgcmVnbm8pKQorICAgICAg
ICAgICAgZi53cml0ZSgiICAgIGN0eF9sb2dfcHJlZF93cml0ZShjdHgsICVzKTtcbiIgJSAocmVn
TikpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNl
OiAiLCByZWd0eXBlLCByZWdpZCkKKyAgICBlbGlmIChyZWd0eXBlID09ICJDIik6CisgICAgICAg
IGlmIChyZWdpZCA9PSAic3MiKToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGlu
dCAlcyA9IGluc24tPnJlZ25vWyVkXSArIEhFWF9SRUdfU0EwO1xuIiAlIFwKKyAgICAgICAgICAg
ICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbGlmIChyZWdpZCA9PSAiZGQiKToKKyAgICAg
ICAgICAgIGYud3JpdGUoIiAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF0gKyBIRVhf
UkVHX1NBMDtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAg
ICAgIGYud3JpdGUoIiAgICBjdHhfbG9nX3JlZ193cml0ZV9wYWlyKGN0eCwgJXMsICVzKTtcbiIg
JSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHByZWRpY2F0ZWQpKQorICAgICAgICBlbGlmIChy
ZWdpZCA9PSAicyIpOgorICAgICAgICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0g
aW5zbi0+cmVnbm9bJWRdICsgSEVYX1JFR19TQTA7XG4iICUgXAorICAgICAgICAgICAgICAgIChy
ZWdOLCByZWdubykpCisgICAgICAgIGVsaWYgKHJlZ2lkID09ICJkIik6CisgICAgICAgICAgICBm
LndyaXRlKCIgICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdICsgSEVYX1JFR19TQTA7
XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgICAgICBmLndy
aXRlKCIgICAgY3R4X2xvZ19yZWdfd3JpdGUoY3R4LCAlcywgJXMpO1xuIiAlIFwKKyAgICAgICAg
ICAgICAgICAocmVnTiwgcHJlZGljYXRlZCkpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBw
cmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKyAgICBlbGlmIChy
ZWd0eXBlID09ICJNIik6CisgICAgICAgIGlmIChyZWdpZCA9PSAidSIpOgorICAgICAgICAgICAg
Zi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiUgXAorICAg
ICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBw
cmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKyAgICBlbGlmIChy
ZWd0eXBlID09ICJWIik6CisgICAgICAgIGlmIChyZWdpZCBpbiB7ImRkIiwgInh4In0pOgorICAg
ICAgICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xu
IiAlXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVsaWYgKHJlZ2lk
IGluIHsidXUiLCAidnYifSk6CisgICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQg
JXMgPSBpbnNuLT5yZWdub1slZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdu
bykpCisgICAgICAgIGVsaWYgKHJlZ2lkIGluIHsicyIsICJ1IiwgInYiLCAidyJ9KToKKyAgICAg
ICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIg
JSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxpZiAocmVnaWQg
aW4geyJkIiwgIngiLCAieSJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGlu
dCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJl
Z25vKSkKKyAgICAgICAgZWxzZToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFy
c2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIlEiKToKKyAgICAg
ICAgaWYgKHJlZ2lkIGluIHsiZCIsICJlIiwgIngifSk6CisgICAgICAgICAgICBmLndyaXRlKCIv
LyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4iICUgXAorICAgICAgICAgICAg
ICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVsaWYgKHJlZ2lkIGluIHsicyIsICJ0IiwgInUi
LCAidiJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24t
PnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAg
ICAgZWxzZToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5
cGUsIHJlZ2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIkciKToKKyAgICAgICAgaWYgKHJlZ2lk
IGluIHsiZGQifSk6CisgICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBp
bnNuLT5yZWdub1slZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisg
ICAgICAgIGVsaWYgKHJlZ2lkIGluIHsiZCJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAg
IGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAg
KHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxpZiAocmVnaWQgaW4geyJzcyJ9KToKKyAgICAgICAg
ICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSBc
CisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxpZiAocmVnaWQgaW4g
eyJzIn0pOgorICAgICAgICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+
cmVnbm9bJWRdO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAg
ICBlbHNlOgorICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlw
ZSwgcmVnaWQpCisgICAgZWxpZiAocmVndHlwZSA9PSAiUyIpOgorICAgICAgICBpZiAocmVnaWQg
aW4geyJkZCJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGlu
c24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAg
ICAgICAgZWxpZiAocmVnaWQgaW4geyJkIn0pOgorICAgICAgICAgICAgZi53cml0ZSgiLy8gICAg
Y29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAo
cmVnTiwgcmVnbm8pKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7InNzIn0pOgorICAgICAgICAg
ICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwK
KyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7
InMifSk6CisgICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5y
ZWdub1slZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAg
IGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBl
LCByZWdpZCkKKyAgICBlbHNlOgorICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAi
LCByZWd0eXBlLCByZWdpZCkKKworZGVmIGFuYWx5emVfb3BuX25ldyhmLCB0YWcsIHJlZ3R5cGUs
IHJlZ2lkLCByZWdubyk6CisgICAgcmVnTiA9ICIlcyVzTiIgJSAocmVndHlwZSwgcmVnaWQpCisg
ICAgaWYgKHJlZ3R5cGUgPT0gIk4iKToKKyAgICAgICAgaWYgKHJlZ2lkIGluIHsicyIsICJ0In0p
OgorICAgICAgICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9b
JWRdO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbHNl
OgorICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVn
aWQpCisgICAgZWxpZiAocmVndHlwZSA9PSAiUCIpOgorICAgICAgICBpZiAocmVnaWQgaW4geyJ0
IiwgInUiLCAidiJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9
IGluc24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkK
KyAgICAgICAgZWxzZToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIs
IHJlZ3R5cGUsIHJlZ2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIk8iKToKKyAgICAgICAgaWYg
KHJlZ2lkID09ICJzIik6CisgICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMg
PSBpbnNuLT5yZWdub1slZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykp
CisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAi
LCByZWd0eXBlLCByZWdpZCkKKyAgICBlbHNlOgorICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVy
IHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKworZGVmIGFuYWx5emVfb3BuKGYsIHRhZywgcmVn
dHlwZSwgcmVnaWQsIHRvc3MsIG51bXJlZ3MsIGkpOgorICAgIGlmIChoZXhfY29tbW9uLmlzX3Bh
aXIocmVnaWQpKToKKyAgICAgICAgYW5hbHl6ZV9vcG5fb2xkKGYsIHRhZywgcmVndHlwZSwgcmVn
aWQsIGkpCisgICAgZWxpZiAoaGV4X2NvbW1vbi5pc19zaW5nbGUocmVnaWQpKToKKyAgICAgICAg
aWYgaGV4X2NvbW1vbi5pc19vbGRfdmFsKHJlZ3R5cGUsIHJlZ2lkLCB0YWcpOgorICAgICAgICAg
ICAgYW5hbHl6ZV9vcG5fb2xkKGYsdGFnLCByZWd0eXBlLCByZWdpZCwgaSkKKyAgICAgICAgZWxp
ZiBoZXhfY29tbW9uLmlzX25ld192YWwocmVndHlwZSwgcmVnaWQsIHRhZyk6CisgICAgICAgICAg
ICBhbmFseXplX29wbl9uZXcoZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgaSkKKyAgICAgICAgZWxz
ZToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJl
Z2lkLCB0b3NzLCBudW1yZWdzKQorICAgIGVsc2U6CisgICAgICAgIHByaW50KCJCYWQgcmVnaXN0
ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkLCB0b3NzLCBudW1yZWdzKQorCisjIworIyMgR2Vu
ZXJhdGUgdGhlIGNvZGUgdG8gYW5hbHl6ZSB0aGUgaW5zdHJ1Y3Rpb24KKyMjICAgICBGb3IgQTJf
YWRkOiBSZDMyPWFkZChSczMyLFJ0MzIpLCB7IFJkVj1Sc1YrUnRWO30KKyMjICAgICBXZSBwcm9k
dWNlOgorIyMgICAgIHN0YXRpYyB2b2lkIGFuYWx5emVfQTJfYWRkKERpc2FzQ29udGV4dCAqY3R4
KQorIyMgICAgIHsKKyMjICAgICAgICAgSW5zbiAqaW5zbiBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQp
KSA9IGN0eC0+aW5zbjsKKyMjICAgICAgICAgY29uc3QgaW50IFJkTiA9IGluc24tPnJlZ25vWzBd
OworIyMgICAgICAgICBjdHhfbG9nX3JlZ193cml0ZShjdHgsIFJkTiwgZmFsc2UpOworIyMgICAg
IC8vICAgIGNvbnN0IGludCBSc04gPSBpbnNuLT5yZWdub1sxXTsKKyMjICAgICAvLyAgICBjb25z
dCBpbnQgUnROID0gaW5zbi0+cmVnbm9bMl07CisjIyAgICAgfQorIyMKK2RlZiBnZW5fYW5hbHl6
ZV9mdW5jKGYsIHRhZywgcmVncywgaW1tcyk6CisgICAgZi53cml0ZSgic3RhdGljIHZvaWQgYW5h
bHl6ZV8lcyhEaXNhc0NvbnRleHQgKmN0eClcbiIgJXRhZykKKyAgICBmLndyaXRlKCd7XG4nKQor
CisgICAgZi53cml0ZSgiICAgIEluc24gKmluc24gX19hdHRyaWJ1dGVfXygodW51c2VkKSkgPSBj
dHgtPmluc247XG4iKQorCisgICAgaT0wCisgICAgIyMgQW5hbHl6ZSBhbGwgdGhlIHJlZ2lzdGVy
cworICAgIGZvciByZWd0eXBlLCByZWdpZCwgdG9zcywgbnVtcmVncyBpbiByZWdzOgorICAgICAg
ICBhbmFseXplX29wbihmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCB0b3NzLCBudW1yZWdzLCBpKQor
ICAgICAgICBpICs9IDEKKworCisgICAgZi53cml0ZSgifVxuXG4iKQorCitkZWYgbWFpbigpOgor
ICAgIGhleF9jb21tb24ucmVhZF9zZW1hbnRpY3NfZmlsZShzeXMuYXJndlsxXSkKKyAgICBoZXhf
Y29tbW9uLnJlYWRfYXR0cmlic19maWxlKHN5cy5hcmd2WzJdKQorICAgIGhleF9jb21tb24ucmVh
ZF9vdmVycmlkZXNfZmlsZShzeXMuYXJndlszXSkKKyAgICBoZXhfY29tbW9uLnJlYWRfb3ZlcnJp
ZGVzX2ZpbGUoc3lzLmFyZ3ZbNF0pCisgICAgaGV4X2NvbW1vbi5jYWxjdWxhdGVfYXR0cmlicygp
CisgICAgdGFncmVncyA9IGhleF9jb21tb24uZ2V0X3RhZ3JlZ3MoKQorICAgIHRhZ2ltbXMgPSBo
ZXhfY29tbW9uLmdldF90YWdpbW1zKCkKKworICAgIHdpdGggb3BlbihzeXMuYXJndls1XSwgJ3cn
KSBhcyBmOgorICAgICAgICBmLndyaXRlKCIjaWZuZGVmIEhFWEFHT05fVENHX0ZVTkNTX0hcbiIp
CisgICAgICAgIGYud3JpdGUoIiNkZWZpbmUgSEVYQUdPTl9UQ0dfRlVOQ1NfSFxuXG4iKQorCisg
ICAgICAgIGZvciB0YWcgaW4gaGV4X2NvbW1vbi50YWdzOgorICAgICAgICAgICAgZ2VuX2FuYWx5
emVfZnVuYyhmLCB0YWcsIHRhZ3JlZ3NbdGFnXSwgdGFnaW1tc1t0YWddKQorCisgICAgICAgIGYu
d3JpdGUoIiNlbmRpZiAgICAvKiBIRVhBR09OX1RDR19GVU5DU19IICovXG4iKQorCitpZiBfX25h
bWVfXyA9PSAiX19tYWluX18iOgorICAgIG1haW4oKQpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFn
b24vZ2VuX3RjZ19mdW5jcy5weSBiL3RhcmdldC9oZXhhZ29uL2dlbl90Y2dfZnVuY3MucHkKaW5k
ZXggN2U4YmExN2NhMi4uNWQ2ODZlYmNmMSAxMDA3NTUKLS0tIGEvdGFyZ2V0L2hleGFnb24vZ2Vu
X3RjZ19mdW5jcy5weQorKysgYi90YXJnZXQvaGV4YWdvbi9nZW5fdGNnX2Z1bmNzLnB5CkBAIC0x
LDcgKzEsNyBAQAogIyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwogCiAjIwotIyMgIENvcHlyaWdodChj
KSAyMDE5LTIwMjIgUXVhbGNvbW0gSW5ub3ZhdGlvbiBDZW50ZXIsIEluYy4gQWxsIFJpZ2h0cyBS
ZXNlcnZlZC4KKyMjICBDb3B5cmlnaHQoYykgMjAxOS0yMDIzIFF1YWxjb21tIElubm92YXRpb24g
Q2VudGVyLCBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAjIwogIyMgIFRoaXMgcHJvZ3JhbSBp
cyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAj
IyAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBh
cyBwdWJsaXNoZWQgYnkKQEAgLTQ0LDE1ICs0NCw2IEBAIGRlZiBnZW5wdHJfZGVjbF9wYWlyX3dy
aXRhYmxlKGYsIHRhZywgcmVndHlwZSwgcmVnaWQsIHJlZ25vKToKICAgICAgICAgICAgIChyZWdO
LCByZWdubykpCiAgICAgZWxzZToKICAgICAgICAgZi53cml0ZSgiICAgIGNvbnN0IGludCAlcyA9
IGluc24tPnJlZ25vWyVkXTtcbiIgJSAocmVnTiwgcmVnbm8pKQotICAgIGlmICgnQV9DT05ERVhF
QycgaW4gaGV4X2NvbW1vbi5hdHRyaWJkaWN0W3RhZ10pOgotICAgICAgICBmLndyaXRlKCIgICAg
aWYgKCFpc19wcmVsb2FkZWQoY3R4LCAlcykpIHtcbiIgJSByZWdOKQotICAgICAgICBmLndyaXRl
KCIgICAgICAgIHRjZ19nZW5fbW92X3RsKGhleF9uZXdfdmFsdWVbJXNdLCBoZXhfZ3ByWyVzXSk7
XG4iICUgXAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAocmVnTiwgcmVnTikpCi0gICAg
ICAgIGYud3JpdGUoIiAgICB9XG4iKQotICAgICAgICBmLndyaXRlKCIgICAgaWYgKCFpc19wcmVs
b2FkZWQoY3R4LCAlcyArIDEpKSB7XG4iICUgcmVnTikKLSAgICAgICAgZi53cml0ZSgiICAgICAg
ICB0Y2dfZ2VuX21vdl90bChoZXhfbmV3X3ZhbHVlWyVzICsgMV0sIGhleF9ncHJbJXMgKyAxXSk7
XG4iICUgXAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAocmVnTiwgcmVnTikpCi0gICAg
ICAgIGYud3JpdGUoIiAgICB9XG4iKQogCiBkZWYgZ2VucHRyX2RlY2xfd3JpdGFibGUoZiwgdGFn
LCByZWd0eXBlLCByZWdpZCwgcmVnbm8pOgogICAgIHJlZ049IiVzJXNOIiAlIChyZWd0eXBlLHJl
Z2lkKQpAQCAtNjMsMTEgKzU0LDYgQEAgZGVmIGdlbnB0cl9kZWNsX3dyaXRhYmxlKGYsIHRhZywg
cmVndHlwZSwgcmVnaWQsIHJlZ25vKToKICAgICAgICAgICAgIChyZWdOLCByZWdubykpCiAgICAg
ZWxzZToKICAgICAgICAgZi53cml0ZSgiICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVk
XTtcbiIgJSAocmVnTiwgcmVnbm8pKQotICAgIGlmICgnQV9DT05ERVhFQycgaW4gaGV4X2NvbW1v
bi5hdHRyaWJkaWN0W3RhZ10pOgotICAgICAgICBmLndyaXRlKCIgICAgaWYgKCFpc19wcmVsb2Fk
ZWQoY3R4LCAlcykpIHtcbiIgJSByZWdOKQotICAgICAgICBmLndyaXRlKCIgICAgICAgIHRjZ19n
ZW5fbW92X3RsKGhleF9uZXdfdmFsdWVbJXNdLCBoZXhfZ3ByWyVzXSk7XG4iICUgXAotICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAocmVnTiwgcmVnTikpCi0gICAgICAgIGYud3JpdGUoIiAg
ICB9XG4iKQogCiBkZWYgZ2VucHRyX2RlY2woZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgcmVnbm8p
OgogICAgIHJlZ049IiVzJXNOIiAlIChyZWd0eXBlLHJlZ2lkKQpAQCAtNDY1LDggKzQ1MSw2IEBA
IGRlZiBnZW5wdHJfZHN0X3dyaXRlX3BhaXIoZiwgdGFnLCByZWd0eXBlLCByZWdpZCk6CiAgICAg
ZWxzZToKICAgICAgICAgZi53cml0ZSgiICAgIGdlbl9sb2dfcmVnX3dyaXRlX3BhaXIoJXMlc04s
ICVzJXNWKTtcbiIgJSBcCiAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQsIHJlZ3R5cGUsIHJl
Z2lkKSkKLSAgICBmLndyaXRlKCIgICAgY3R4X2xvZ19yZWdfd3JpdGVfcGFpcihjdHgsICVzJXNO
KTtcbiIgJSBcCi0gICAgICAgIChyZWd0eXBlLCByZWdpZCkpCiAKIGRlZiBnZW5wdHJfZHN0X3dy
aXRlKGYsIHRhZywgcmVndHlwZSwgcmVnaWQpOgogICAgIGlmIChyZWd0eXBlID09ICJSIik6CkBA
IC00ODAsMTYgKzQ2NCwxMiBAQCBkZWYgZ2VucHRyX2RzdF93cml0ZShmLCB0YWcsIHJlZ3R5cGUs
IHJlZ2lkKToKICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgZi53cml0ZSgiICAg
IGdlbl9sb2dfcmVnX3dyaXRlKCVzJXNOLCAlcyVzVik7XG4iICUgXAogICAgICAgICAgICAgICAg
ICAgICAocmVndHlwZSwgcmVnaWQsIHJlZ3R5cGUsIHJlZ2lkKSkKLSAgICAgICAgICAgIGYud3Jp
dGUoIiAgICBjdHhfbG9nX3JlZ193cml0ZShjdHgsICVzJXNOKTtcbiIgJSBcCi0gICAgICAgICAg
ICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkKICAgICAgICAgZWxzZToKICAgICAgICAgICAgIHByaW50
KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQogICAgIGVsaWYgKHJlZ3R5
cGUgPT0gIlAiKToKICAgICAgICAgaWYgKHJlZ2lkIGluIHsiZCIsICJlIiwgIngifSk6CiAgICAg
ICAgICAgICBmLndyaXRlKCIgICAgZ2VuX2xvZ19wcmVkX3dyaXRlKGN0eCwgJXMlc04sICVzJXNW
KTtcbiIgJSBcCiAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWd0eXBlLCByZWdp
ZCkpCi0gICAgICAgICAgICBmLndyaXRlKCIgICAgY3R4X2xvZ19wcmVkX3dyaXRlKGN0eCwgJXMl
c04pO1xuIiAlIFwKLSAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQpKQogICAgICAgICBl
bHNlOgogICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwg
cmVnaWQpCiAgICAgZWxpZiAocmVndHlwZSA9PSAiQyIpOgpAQCAtNTgxLDcgKzU2MSw2IEBAIGRl
ZiBnZW5wdHJfZHN0X3dyaXRlX29wbihmLHJlZ3R5cGUsIHJlZ2lkLCB0YWcpOgogIyMgICAgICAg
ICAgIFRDR3YgUnRWID0gaGV4X2dwcltpbnNuLT5yZWdub1syXV07CiAjIyAgICAgICAgICAgPEdF
Tj4KICMjICAgICAgICAgICBnZW5fbG9nX3JlZ193cml0ZShSZE4sIFJkVik7Ci0jIyAgICAgICAg
ICAgY3R4X2xvZ19yZWdfd3JpdGUoY3R4LCBSZE4pOwogIyMgICAgICAgICAgIHRjZ190ZW1wX2Zy
ZWUoUmRWKTsKICMjICAgICAgIH0KICMjCmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi9tZXNv
bi5idWlsZCBiL3RhcmdldC9oZXhhZ29uL21lc29uLmJ1aWxkCmluZGV4IGM5ZDMxZDA5NWMuLmJk
OTFmNzI3ZGUgMTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29uL21lc29uLmJ1aWxkCisrKyBiL3Rh
cmdldC9oZXhhZ29uL21lc29uLmJ1aWxkCkBAIC0xLDUgKzEsNSBAQAogIyMKLSMjICBDb3B5cmln
aHQoYykgMjAyMC0yMDIxIFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFsbCBSaWdo
dHMgUmVzZXJ2ZWQuCisjIyAgQ29weXJpZ2h0KGMpIDIwMjAtMjAyMyBRdWFsY29tbSBJbm5vdmF0
aW9uIENlbnRlciwgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogIyMKICMjICBUaGlzIHByb2dy
YW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlm
eQogIyMgIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vu
c2UgYXMgcHVibGlzaGVkIGJ5CkBAIC02Nyw2ICs2NywxNSBAQCB0Y2dfZnVuY190YWJsZV9nZW5l
cmF0ZWQgPSBjdXN0b21fdGFyZ2V0KAogKQogaGV4YWdvbl9zcy5hZGQodGNnX2Z1bmNfdGFibGVf
Z2VuZXJhdGVkKQogCithbmFseXplX2Z1bmNzX2dlbmVyYXRlZCA9IGN1c3RvbV90YXJnZXQoCisg
ICAgJ2FuYWx5emVfZnVuY3NfZ2VuZXJhdGVkLmMuaW5jJywKKyAgICBvdXRwdXQ6ICdhbmFseXpl
X2Z1bmNzX2dlbmVyYXRlZC5jLmluYycsCisgICAgZGVwZW5kczogW3NlbWFudGljc19nZW5lcmF0
ZWRdLAorICAgIGRlcGVuZF9maWxlczogW2hleF9jb21tb25fcHksIGF0dHJpYnNfZGVmLCBnZW5f
dGNnX2gsIGdlbl90Y2dfaHZ4X2hdLAorICAgIGNvbW1hbmQ6IFtweXRob24sIGZpbGVzKCdnZW5f
YW5hbHl6ZV9mdW5jcy5weScpLCBzZW1hbnRpY3NfZ2VuZXJhdGVkLCBhdHRyaWJzX2RlZiwgZ2Vu
X3RjZ19oLCBnZW5fdGNnX2h2eF9oLCAnQE9VVFBVVEAnXSwKKykKK2hleGFnb25fc3MuYWRkKGFu
YWx5emVfZnVuY3NfZ2VuZXJhdGVkKQorCiBwcmludGluc25fZ2VuZXJhdGVkID0gY3VzdG9tX3Rh
cmdldCgKICAgICAncHJpbnRpbnNuX2dlbmVyYXRlZC5oLmluYycsCiAgICAgb3V0cHV0OiAncHJp
bnRpbnNuX2dlbmVyYXRlZC5oLmluYycsCi0tIAoyLjE3LjEKCg==

