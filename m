Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id 4847D6AD535
	for <lists+qemu-devel@lfdr.de>; Tue,  7 Mar 2023 04:00:48 +0100 (CET)
Received: from localhost ([::1] helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces@nongnu.org>)
	id 1pZNXM-0000UA-Cp; Mon, 06 Mar 2023 21:58:48 -0500
Received: from eggs.gnu.org ([2001:470:142:3::10])
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1pZNXG-0000DB-JI
 for qemu-devel@nongnu.org; Mon, 06 Mar 2023 21:58:42 -0500
Received: from mx0a-0031df01.pphosted.com ([205.220.168.131])
 by eggs.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1pZNXA-0005nP-3K
 for qemu-devel@nongnu.org; Mon, 06 Mar 2023 21:58:42 -0500
Received: from pps.filterd (m0279867.ppops.net [127.0.0.1])
 by mx0a-0031df01.pphosted.com (8.17.1.19/8.17.1.19) with ESMTP id
 3272PnUW005084; Tue, 7 Mar 2023 02:58:33 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=quicinc.com;
 h=from : to : cc :
 subject : date : message-id : in-reply-to : references : mime-version :
 content-type : content-transfer-encoding; s=qcppdkim1;
 bh=AjRw5I9k8WyWoLbD4AlAH6tolt15jvq+Jl/aC2vWaqs=;
 b=I7UuRRO7aj12P7AXiOMevAzjkM3gAAfp9ToW200FqPuGQJPWtVDBnMEsR/rBVxIxrMw8
 0d5ns93A+lFv/ARlDubqgJdJhPOmqYnPj28Ov+m4UYFexoIGfL7D1S2foC/P/7xPK0cO
 ALI36eZW1oYYgCzqIOPjX3KTNoST6Asx+KMsS6jq0/SfTm6cLikI/zAZ/QTuVQUTbFbu
 irC6JNAseqXAwuCz5jmqeHIukvXZwX9vz6+n/UY1wFX79zANhqglgn+Q3hrUSjNwt6DU
 UrgC57ArVPlEm5SOZHPUZykaCdbNGM9Mufl+2tMF8DW6NlRzjVEsuJUBfHK9tfG3AuHX oQ== 
Received: from nalasppmta02.qualcomm.com (Global_NAT1.qualcomm.com
 [129.46.96.20])
 by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 3p5nkw8yy2-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Tue, 07 Mar 2023 02:58:33 +0000
Received: from pps.filterd (NALASPPMTA02.qualcomm.com [127.0.0.1])
 by NALASPPMTA02.qualcomm.com (8.17.1.5/8.17.1.5) with ESMTP id 3272wWIn028406; 
 Tue, 7 Mar 2023 02:58:32 GMT
Received: from pps.reinject (localhost [127.0.0.1])
 by NALASPPMTA02.qualcomm.com (PPS) with ESMTPS id 3p4fg0bjty-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Tue, 07 Mar 2023 02:58:32 +0000
Received: from NALASPPMTA02.qualcomm.com (NALASPPMTA02.qualcomm.com
 [127.0.0.1])
 by pps.reinject (8.17.1.5/8.17.1.5) with ESMTP id 3272tEqe024863;
 Tue, 7 Mar 2023 02:58:32 GMT
Received: from hu-devc-sd-u20-a-1.qualcomm.com (hu-tsimpson-lv.qualcomm.com
 [10.47.204.221])
 by NALASPPMTA02.qualcomm.com (PPS) with ESMTPS id 3272wVtt028392
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Tue, 07 Mar 2023 02:58:31 +0000
Received: by hu-devc-sd-u20-a-1.qualcomm.com (Postfix, from userid 47164)
 id C9CFA6A6; Mon,  6 Mar 2023 18:58:30 -0800 (PST)
From: Taylor Simpson <tsimpson@quicinc.com>
To: qemu-devel@nongnu.org
Cc: tsimpson@quicinc.com, richard.henderson@linaro.org, philmd@linaro.org,
 ale@rev.ng, anjo@rev.ng, bcain@quicinc.com, quic_mathbern@quicinc.com
Subject: [PATCH v6 05/14] Hexagon (target/hexagon) Analyze packet before
 generating TCG
Date: Mon,  6 Mar 2023 18:58:19 -0800
Message-Id: <20230307025828.1612809-6-tsimpson@quicinc.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20230307025828.1612809-1-tsimpson@quicinc.com>
References: <20230307025828.1612809-1-tsimpson@quicinc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
X-QCInternal: smtphost
X-QCInternal: smtphost
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-GUID: gaDumyS-uI7JHcZj1IQLbU8i8fr3y_Rg
X-Proofpoint-ORIG-GUID: gaDumyS-uI7JHcZj1IQLbU8i8fr3y_Rg
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.219,Aquarius:18.0.942,Hydra:6.0.573,FMLib:17.11.170.22
 definitions=2023-03-06_14,2023-03-06_01,2023-02-09_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 bulkscore=0 clxscore=1015
 adultscore=0 malwarescore=0 mlxlogscore=838 lowpriorityscore=0
 suspectscore=0 mlxscore=0 phishscore=0 impostorscore=0 priorityscore=1501
 spamscore=0 classifier=spam adjust=0 reason=mlx scancount=1
 engine=8.12.0-2212070000 definitions=main-2303070025
Received-SPF: pass client-ip=205.220.168.131;
 envelope-from=tsimpson@qualcomm.com; helo=mx0a-0031df01.pphosted.com
X-Spam_score_int: -24
X-Spam_score: -2.5
X-Spam_bar: --
X-Spam_report: (-2.5 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, HEADER_FROM_DIFFERENT_DOMAINS=0.25,
 RCVD_IN_DNSWL_LOW=-0.7, SPF_HELO_NONE=0.001,
 SPF_PASS=-0.001 autolearn=ham autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org

V2UgY3JlYXRlIGEgbmV3IGdlbmVyYXRvciB0aGF0IGNyZWF0ZXMgYW4gYW5hbHl6ZV88dGFnPiBm
dW5jdGlvbiBmb3IKZWFjaCBpbnN0cnVjdGlvbi4gIEN1cnJlbnRseSwgdGhlc2UgZnVuY3Rpb25z
IHJlY29yZCB0aGUgd3JpdGVzIHRvClIsIFAsIGFuZCBDIHJlZ2lzdGVycyBieSBjYWxsaW5nIGN0
eF9sb2dfcmVnX3dyaXRlW19wYWlyXSBvcgpjdHhfbG9nX3ByZWRfd3JpdGUuCgpEdXJpbmcgZ2Vu
X3N0YXJ0X3BhY2tldCwgd2UgaW52b2tlIHRoZSBhbmFseXplXzx0YWc+IGZ1bmN0aW9uIGZvcgpl
YWNoIGluc3RydWN0aW9uIGluIHRoZSBwYWNrZXQsIGFuZCB3ZSBtYXJrIHRoZSBpbXBsaWNpdCBy
ZWdpc3RlcgphbmQgcHJlZGljYXRlIHdyaXRlcy4KCkRvaW5nIHRoZSBhbmFseXNpcyB1cCBmcm9u
dCBoYXMgc2V2ZXJhbCBhZHZhbnRhZ2VzCi0gV2UgcmVtb3ZlIGNhbGxzIHRvIGN0eF9sb2dfKiBm
cm9tIGdlbl90Y2dfZnVuY3MucHkgYW5kIGdlbnB0ci5jCi0gQWZ0ZXIgdGhlIGFuYWx5c2lzIGlz
IHBlcmZvcm1lZCwgd2UgY2FuIGluaXRpYWxpemUgaGV4X25ld192YWx1ZQogIGZvciBlYWNoIG9m
IHRoZSBwcmVkaWNhdGVkIGFzc2lnbm1lbnRzIHJhdGhlciB0aGFuIGR1cmluZyBUQ0cKICBnZW5l
cmF0aW9uIGZvciB0aGUgaW5zdHJ1Y3Rpb25zCi0gVGhpcyBpcyBhIHN0ZXBwaW5nIHN0b25lIGZv
ciBmdXR1cmUgd29yayB3aGVyZSB0aGUgYW5hbHlzaXMgd2lsbAogIGluY2x1ZGUgdGhlIHNldCBv
ZiByZWdpc3RlcnMgdGhhdCBhcmUgcmVhZC4gIEluIGNhc2VzIHdoZXJlCiAgdGhlIHBhY2tldCBk
b2Vzbid0IGhhdmUgYW4gb3ZlcmxhcCBiZXR3ZWVuIHRoZSByZWdpc3RlcnMgdGhhdCBhcmUKICB3
cml0dGVuIGFuZCByZWdpc3RlcnMgdGhhdCBhcmUgcmVhZCwgd2UgY2FuIGF2b2lkIHRoZSBpbnRl
cm1lZGlhdGUKICBzdGVwIG9mIHdyaXRpbmcgdG8gaGV4X25ld192YWx1ZS4gIE5vdGUgdGhhdCBv
dGhlciBjaGVja3Mgd2lsbCBhbHNvCiAgYmUgbmVlZGVkIChlLmcuLCBubyBpbnN0cnVjdGlvbnMg
Y2FuIHJhaXNlIGFuIGV4Y2VwdGlvbikuCgpTaWduZWQtb2ZmLWJ5OiBUYXlsb3IgU2ltcHNvbiA8
dHNpbXBzb25AcXVpY2luYy5jb20+ClJldmlld2VkLWJ5OiBBbnRvbiBKb2hhbnNzb24gPGFuam9A
cmV2Lm5nPgotLS0KIHRhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5oICAgICAgICAgICAgICAgICAg
fCAgNDYgKystLQogdGFyZ2V0L2hleGFnb24vZ2VucHRyLmMgICAgICAgICAgICAgICAgICAgICB8
ICAgNSArLQogdGFyZ2V0L2hleGFnb24vaWRlZi1wYXJzZXIvcGFyc2VyLWhlbHBlcnMuYyB8ICAg
NyArLQogdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmMgICAgICAgICAgICAgICAgICB8IDE2MiAr
KysrKysrLS0tLS0tCiB0YXJnZXQvaGV4YWdvbi9SRUFETUUgICAgICAgICAgICAgICAgICAgICAg
IHwgIDEwICstCiB0YXJnZXQvaGV4YWdvbi9nZW5fYW5hbHl6ZV9mdW5jcy5weSAgICAgICAgIHwg
MjM3ICsrKysrKysrKysrKysrKysrKysrCiB0YXJnZXQvaGV4YWdvbi9nZW5fdGNnX2Z1bmNzLnB5
ICAgICAgICAgICAgIHwgIDIzICstCiB0YXJnZXQvaGV4YWdvbi9tZXNvbi5idWlsZCAgICAgICAg
ICAgICAgICAgIHwgIDExICstCiA4IGZpbGVzIGNoYW5nZWQsIDM4MyBpbnNlcnRpb25zKCspLCAx
MTggZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9kZSAxMDA3NTUgdGFyZ2V0L2hleGFnb24vZ2VuX2Fu
YWx5emVfZnVuY3MucHkKCmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuaCBi
L3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5oCmluZGV4IGQ5NzFmNGYwOTUuLmQ0NWQzYTRiYjAg
MTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5oCisrKyBiL3RhcmdldC9oZXhh
Z29uL3RyYW5zbGF0ZS5oCkBAIC0xLDUgKzEsNSBAQAogLyoKLSAqICBDb3B5cmlnaHQoYykgMjAx
OS0yMDIyIFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2
ZWQuCisgKiAgQ29weXJpZ2h0KGMpIDIwMTktMjAyMyBRdWFsY29tbSBJbm5vdmF0aW9uIENlbnRl
ciwgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogICoKICAqICBUaGlzIHByb2dyYW0gaXMgZnJl
ZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQogICogIGl0
IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVi
bGlzaGVkIGJ5CkBAIC0zOCw2ICszOCw3IEBAIHR5cGVkZWYgc3RydWN0IERpc2FzQ29udGV4dCB7
CiAgICAgaW50IHJlZ19sb2dbUkVHX1dSSVRFU19NQVhdOwogICAgIGludCByZWdfbG9nX2lkeDsK
ICAgICBERUNMQVJFX0JJVE1BUChyZWdzX3dyaXR0ZW4sIFRPVEFMX1BFUl9USFJFQURfUkVHUyk7
CisgICAgREVDTEFSRV9CSVRNQVAocHJlZGljYXRlZF9yZWdzLCBUT1RBTF9QRVJfVEhSRUFEX1JF
R1MpOwogICAgIGludCBwcmVnX2xvZ1tQUkVEX1dSSVRFU19NQVhdOwogICAgIGludCBwcmVnX2xv
Z19pZHg7CiAgICAgREVDTEFSRV9CSVRNQVAocHJlZ3Nfd3JpdHRlbiwgTlVNX1BSRUdTKTsKQEAg
LTYyLDMyICs2MywzOSBAQCB0eXBlZGVmIHN0cnVjdCBEaXNhc0NvbnRleHQgewogICAgIGJvb2wg
aXNfdGlnaHRfbG9vcDsKIH0gRGlzYXNDb250ZXh0OwogCi1zdGF0aWMgaW5saW5lIHZvaWQgY3R4
X2xvZ19yZWdfd3JpdGUoRGlzYXNDb250ZXh0ICpjdHgsIGludCBybnVtKQorc3RhdGljIGlubGlu
ZSB2b2lkIGN0eF9sb2dfcHJlZF93cml0ZShEaXNhc0NvbnRleHQgKmN0eCwgaW50IHBudW0pCiB7
Ci0gICAgaWYgKHRlc3RfYml0KHJudW0sIGN0eC0+cmVnc193cml0dGVuKSkgewotICAgICAgICBI
RVhfREVCVUdfTE9HKCJXQVJOSU5HOiBNdWx0aXBsZSB3cml0ZXMgdG8gciVkXG4iLCBybnVtKTsK
KyAgICBpZiAoIXRlc3RfYml0KHBudW0sIGN0eC0+cHJlZ3Nfd3JpdHRlbikpIHsKKyAgICAgICAg
Y3R4LT5wcmVnX2xvZ1tjdHgtPnByZWdfbG9nX2lkeF0gPSBwbnVtOworICAgICAgICBjdHgtPnBy
ZWdfbG9nX2lkeCsrOworICAgICAgICBzZXRfYml0KHBudW0sIGN0eC0+cHJlZ3Nfd3JpdHRlbik7
CiAgICAgfQotICAgIGN0eC0+cmVnX2xvZ1tjdHgtPnJlZ19sb2dfaWR4XSA9IHJudW07Ci0gICAg
Y3R4LT5yZWdfbG9nX2lkeCsrOwotICAgIHNldF9iaXQocm51bSwgY3R4LT5yZWdzX3dyaXR0ZW4p
OwotfQotCi1zdGF0aWMgaW5saW5lIHZvaWQgY3R4X2xvZ19yZWdfd3JpdGVfcGFpcihEaXNhc0Nv
bnRleHQgKmN0eCwgaW50IHJudW0pCi17Ci0gICAgY3R4X2xvZ19yZWdfd3JpdGUoY3R4LCBybnVt
KTsKLSAgICBjdHhfbG9nX3JlZ193cml0ZShjdHgsIHJudW0gKyAxKTsKIH0KIAotc3RhdGljIGlu
bGluZSB2b2lkIGN0eF9sb2dfcHJlZF93cml0ZShEaXNhc0NvbnRleHQgKmN0eCwgaW50IHBudW0p
CitzdGF0aWMgaW5saW5lIHZvaWQgY3R4X2xvZ19yZWdfd3JpdGUoRGlzYXNDb250ZXh0ICpjdHgs
IGludCBybnVtLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgaXNf
cHJlZGljYXRlZCkKIHsKLSAgICBjdHgtPnByZWdfbG9nW2N0eC0+cHJlZ19sb2dfaWR4XSA9IHBu
dW07Ci0gICAgY3R4LT5wcmVnX2xvZ19pZHgrKzsKLSAgICBzZXRfYml0KHBudW0sIGN0eC0+cHJl
Z3Nfd3JpdHRlbik7CisgICAgaWYgKHJudW0gPT0gSEVYX1JFR19QM18wX0FMSUFTRUQpIHsKKyAg
ICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBOVU1fUFJFR1M7IGkrKykgeworICAgICAgICAgICAg
Y3R4X2xvZ19wcmVkX3dyaXRlKGN0eCwgaSk7CisgICAgICAgIH0KKyAgICB9IGVsc2UgeworICAg
ICAgICBpZiAoIXRlc3RfYml0KHJudW0sIGN0eC0+cmVnc193cml0dGVuKSkgeworICAgICAgICAg
ICAgY3R4LT5yZWdfbG9nW2N0eC0+cmVnX2xvZ19pZHhdID0gcm51bTsKKyAgICAgICAgICAgIGN0
eC0+cmVnX2xvZ19pZHgrKzsKKyAgICAgICAgICAgIHNldF9iaXQocm51bSwgY3R4LT5yZWdzX3dy
aXR0ZW4pOworICAgICAgICB9CisgICAgICAgIGlmIChpc19wcmVkaWNhdGVkKSB7CisgICAgICAg
ICAgICBzZXRfYml0KHJudW0sIGN0eC0+cHJlZGljYXRlZF9yZWdzKTsKKyAgICAgICAgfQorICAg
IH0KIH0KIAotc3RhdGljIGlubGluZSBib29sIGlzX3ByZWxvYWRlZChEaXNhc0NvbnRleHQgKmN0
eCwgaW50IG51bSkKK3N0YXRpYyBpbmxpbmUgdm9pZCBjdHhfbG9nX3JlZ193cml0ZV9wYWlyKERp
c2FzQ29udGV4dCAqY3R4LCBpbnQgcm51bSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGJvb2wgaXNfcHJlZGljYXRlZCkKIHsKLSAgICByZXR1cm4gdGVzdF9iaXQo
bnVtLCBjdHgtPnJlZ3Nfd3JpdHRlbik7CisgICAgY3R4X2xvZ19yZWdfd3JpdGUoY3R4LCBybnVt
LCBpc19wcmVkaWNhdGVkKTsKKyAgICBjdHhfbG9nX3JlZ193cml0ZShjdHgsIHJudW0gKyAxLCBp
c19wcmVkaWNhdGVkKTsKIH0KIAogc3RhdGljIGlubGluZSBib29sIGlzX3ZyZWdfcHJlbG9hZGVk
KERpc2FzQ29udGV4dCAqY3R4LCBpbnQgbnVtKQpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24v
Z2VucHRyLmMgYi90YXJnZXQvaGV4YWdvbi9nZW5wdHIuYwppbmRleCAzNDkwMzEwODEyLi42MWFi
OWFmOWU0IDEwMDY0NAotLS0gYS90YXJnZXQvaGV4YWdvbi9nZW5wdHIuYworKysgYi90YXJnZXQv
aGV4YWdvbi9nZW5wdHIuYwpAQCAtMTgwLDYgKzE4MCw3IEBAIHZvaWQgZ2VuX2xvZ19wcmVkX3dy
aXRlKERpc2FzQ29udGV4dCAqY3R4LCBpbnQgcG51bSwgVENHdiB2YWwpCiAgICAgICAgICAgICAg
ICAgICAgICAgIGhleF9uZXdfcHJlZF92YWx1ZVtwbnVtXSwgYmFzZV92YWwpOwogICAgIH0KICAg
ICB0Y2dfZ2VuX29yaV90bChoZXhfcHJlZF93cml0dGVuLCBoZXhfcHJlZF93cml0dGVuLCAxIDw8
IHBudW0pOworICAgIHNldF9iaXQocG51bSwgY3R4LT5wcmVnc193cml0dGVuKTsKIH0KIAogc3Rh
dGljIGlubGluZSB2b2lkIGdlbl9yZWFkX3AzXzAoVENHdiBjb250cm9sX3JlZykKQEAgLTI1Niw3
ICsyNTcsNiBAQCBzdGF0aWMgdm9pZCBnZW5fd3JpdGVfcDNfMChEaXNhc0NvbnRleHQgKmN0eCwg
VENHdiBjb250cm9sX3JlZykKICAgICBmb3IgKGludCBpID0gMDsgaSA8IE5VTV9QUkVHUzsgaSsr
KSB7CiAgICAgICAgIHRjZ19nZW5fZXh0cmFjdF90bChoZXhfcDgsIGNvbnRyb2xfcmVnLCBpICog
OCwgOCk7CiAgICAgICAgIGdlbl9sb2dfcHJlZF93cml0ZShjdHgsIGksIGhleF9wOCk7Ci0gICAg
ICAgIGN0eF9sb2dfcHJlZF93cml0ZShjdHgsIGkpOwogICAgIH0KIH0KIApAQCAtMjc0LDcgKzI3
NCw2IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBnZW5fd3JpdGVfY3RybF9yZWcoRGlzYXNDb250ZXh0
ICpjdHgsIGludCByZWdfbnVtLAogICAgICAgICBnZW5fd3JpdGVfcDNfMChjdHgsIHZhbCk7CiAg
ICAgfSBlbHNlIHsKICAgICAgICAgZ2VuX2xvZ19yZWdfd3JpdGUocmVnX251bSwgdmFsKTsKLSAg
ICAgICAgY3R4X2xvZ19yZWdfd3JpdGUoY3R4LCByZWdfbnVtKTsKICAgICAgICAgaWYgKHJlZ19u
dW0gPT0gSEVYX1JFR19RRU1VX1BLVF9DTlQpIHsKICAgICAgICAgICAgIGN0eC0+bnVtX3BhY2tl
dHMgPSAwOwogICAgICAgICB9CkBAIC0yOTYsMTAgKzI5NSw4IEBAIHN0YXRpYyBpbmxpbmUgdm9p
ZCBnZW5fd3JpdGVfY3RybF9yZWdfcGFpcihEaXNhc0NvbnRleHQgKmN0eCwgaW50IHJlZ19udW0s
CiAgICAgICAgIGdlbl93cml0ZV9wM18wKGN0eCwgdmFsMzIpOwogICAgICAgICB0Y2dfZ2VuX2V4
dHJoX2k2NF9pMzIodmFsMzIsIHZhbCk7CiAgICAgICAgIGdlbl9sb2dfcmVnX3dyaXRlKHJlZ19u
dW0gKyAxLCB2YWwzMik7Ci0gICAgICAgIGN0eF9sb2dfcmVnX3dyaXRlKGN0eCwgcmVnX251bSAr
IDEpOwogICAgIH0gZWxzZSB7CiAgICAgICAgIGdlbl9sb2dfcmVnX3dyaXRlX3BhaXIocmVnX251
bSwgdmFsKTsKLSAgICAgICAgY3R4X2xvZ19yZWdfd3JpdGVfcGFpcihjdHgsIHJlZ19udW0pOwog
ICAgICAgICBpZiAocmVnX251bSA9PSBIRVhfUkVHX1FFTVVfUEtUX0NOVCkgewogICAgICAgICAg
ICAgY3R4LT5udW1fcGFja2V0cyA9IDA7CiAgICAgICAgICAgICBjdHgtPm51bV9pbnNucyA9IDA7
CmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi9pZGVmLXBhcnNlci9wYXJzZXItaGVscGVycy5j
IGIvdGFyZ2V0L2hleGFnb24vaWRlZi1wYXJzZXIvcGFyc2VyLWhlbHBlcnMuYwppbmRleCBlMWE1
NTQxMmM4Li42NDRhMjJhZjM2IDEwMDY0NAotLS0gYS90YXJnZXQvaGV4YWdvbi9pZGVmLXBhcnNl
ci9wYXJzZXItaGVscGVycy5jCisrKyBiL3RhcmdldC9oZXhhZ29uL2lkZWYtcGFyc2VyL3BhcnNl
ci1oZWxwZXJzLmMKQEAgLTEsNSArMSw1IEBACiAvKgotICogIENvcHlyaWdodChjKSAyMDE5LTIw
MjIgcmV2Lm5nIExhYnMgU3JsLiBBbGwgUmlnaHRzIFJlc2VydmVkLgorICogIENvcHlyaWdodChj
KSAyMDE5LTIwMjMgcmV2Lm5nIExhYnMgU3JsLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogICoKICAq
ICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQg
YW5kL29yIG1vZGlmeQogICogIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwg
UHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5CkBAIC0xMzIzLDEwICsxMzIzLDYgQEAgdm9p
ZCBnZW5fd3JpdGVfcmVnKENvbnRleHQgKmMsIFlZTFRZUEUgKmxvY3AsIEhleFZhbHVlICpyZWcs
IEhleFZhbHVlICp2YWx1ZSkKICAgICAgICAgbG9jcCwKICAgICAgICAgImdlbl9sb2dfcmVnX3dy
aXRlKCIsICZyZWctPnJlZy5pZCwgIiwgIiwKICAgICAgICAgJnZhbHVlX20sICIpO1xuIik7Ci0g
ICAgT1VUKGMsCi0gICAgICAgIGxvY3AsCi0gICAgICAgICJjdHhfbG9nX3JlZ193cml0ZShjdHgs
ICIsICZyZWctPnJlZy5pZCwKLSAgICAgICAgIik7XG4iKTsKIH0KIAogdm9pZCBnZW5fYXNzaWdu
KENvbnRleHQgKmMsCkBAIC0xNzI4LDcgKzE3MjQsNiBAQCB2b2lkIGdlbl9wcmVkX2Fzc2lnbihD
b250ZXh0ICpjLCBZWUxUWVBFICpsb2NwLCBIZXhWYWx1ZSAqbGVmdF9wcmVkLAogICAgIGlmIChp
c19kaXJlY3QpIHsKICAgICAgICAgT1VUKGMsIGxvY3AsICJnZW5fbG9nX3ByZWRfd3JpdGUoY3R4
LCAiLCBwcmVkX2lkLCAiLCAiLCBsZWZ0X3ByZWQsCiAgICAgICAgICAgICAiKTtcbiIpOwotICAg
ICAgICBPVVQoYywgbG9jcCwgImN0eF9sb2dfcHJlZF93cml0ZShjdHgsICIsIHByZWRfaWQsICIp
O1xuIik7CiAgICAgfQogfQogCmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUu
YyBiL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5jCmluZGV4IDkzZmQxYjU1ZTMuLjllNWZjZWUx
ZWUgMTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5jCisrKyBiL3RhcmdldC9o
ZXhhZ29uL3RyYW5zbGF0ZS5jCkBAIC0xLDUgKzEsNSBAQAogLyoKLSAqICBDb3B5cmlnaHQoYykg
MjAxOS0yMDIyIFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFsbCBSaWdodHMgUmVz
ZXJ2ZWQuCisgKiAgQ29weXJpZ2h0KGMpIDIwMTktMjAyMyBRdWFsY29tbSBJbm5vdmF0aW9uIENl
bnRlciwgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogICoKICAqICBUaGlzIHByb2dyYW0gaXMg
ZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQogICog
IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMg
cHVibGlzaGVkIGJ5CkBAIC0yOSw2ICsyOSwxNSBAQAogI2luY2x1ZGUgInRyYW5zbGF0ZS5oIgog
I2luY2x1ZGUgInByaW50aW5zbi5oIgogCisjaW5jbHVkZSAiYW5hbHl6ZV9mdW5jc19nZW5lcmF0
ZWQuYy5pbmMiCisKK3R5cGVkZWYgdm9pZCAoKkFuYWx5emVJbnNuKShEaXNhc0NvbnRleHQgKmN0
eCk7CitzdGF0aWMgY29uc3QgQW5hbHl6ZUluc24gb3Bjb2RlX2FuYWx5emVbWFhfTEFTVF9PUENP
REVdID0geworI2RlZmluZSBPUENPREUoWCkgICAgW1hdID0gYW5hbHl6ZV8jI1gKKyNpbmNsdWRl
ICJvcGNvZGVzX2RlZl9nZW5lcmF0ZWQuaC5pbmMiCisjdW5kZWYgT1BDT0RFCit9OworCiBUQ0d2
IGhleF9ncHJbVE9UQUxfUEVSX1RIUkVBRF9SRUdTXTsKIFRDR3YgaGV4X3ByZWRbTlVNX1BSRUdT
XTsKIFRDR3YgaGV4X3RoaXNfUEM7CkBAIC0yNjUsNiArMjc0LDc2IEBAIHN0YXRpYyBib29sIG5l
ZWRfbmV4dF9QQyhEaXNhc0NvbnRleHQgKmN0eCkKICAgICByZXR1cm4gZmFsc2U7CiB9CiAKKy8q
CisgKiBUaGUgb3Bjb2RlX2FuYWx5emUgZnVuY3Rpb25zIG1hcmsgbW9zdCBvZiB0aGUgd3JpdGVz
IGluIGEgcGFja2V0CisgKiBIb3dldmVyLCB0aGVyZSBhcmUgc29tZSBpbXBsaWNpdCB3cml0ZXMg
bWFya2VkIGFzIGF0dHJpYnV0ZXMKKyAqIG9mIHRoZSBhcHBsaWNhYmxlIGluc3RydWN0aW9ucy4K
KyAqLworc3RhdGljIHZvaWQgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoRGlzYXNDb250ZXh0ICpj
dHgsIGludCBhdHRyaWIsIGludCBybnVtKQoreworICAgIHVpbnQxNl90IG9wY29kZSA9IGN0eC0+
aW5zbi0+b3Bjb2RlOworICAgIGlmIChHRVRfQVRUUklCKG9wY29kZSwgYXR0cmliKSkgeworICAg
ICAgICAvKgorICAgICAgICAgKiBVU1IgaXMgdXNlZCB0byBzZXQgb3ZlcmZsb3cgYW5kIEZQIGV4
Y2VwdGlvbnMsCisgICAgICAgICAqIHNvIHRyZWF0IGl0IGFzIGNvbmRpdGlvbmFsCisgICAgICAg
ICAqLworICAgICAgICBib29sIGlzX3ByZWRpY2F0ZWQgPSBHRVRfQVRUUklCKG9wY29kZSwgQV9D
T05ERVhFQykgfHwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm51bSA9PSBIRVhfUkVH
X1VTUjsKKworICAgICAgICAvKiBMQzAvTEMxIGlzIGNvbmRpdGlvbmFsbHkgd3JpdHRlbiBieSBl
bmRsb29wIGluc3RydWN0aW9ucyAqLworICAgICAgICBpZiAoKHJudW0gPT0gSEVYX1JFR19MQzAg
fHwgcm51bSA9PSBIRVhfUkVHX0xDMSkgJiYKKyAgICAgICAgICAgIChvcGNvZGUgPT0gSjJfZW5k
bG9vcDAgfHwKKyAgICAgICAgICAgICBvcGNvZGUgPT0gSjJfZW5kbG9vcDEgfHwKKyAgICAgICAg
ICAgICBvcGNvZGUgPT0gSjJfZW5kbG9vcDAxKSkgeworICAgICAgICAgICAgaXNfcHJlZGljYXRl
ZCA9IHRydWU7CisgICAgICAgIH0KKworICAgICAgICBjdHhfbG9nX3JlZ193cml0ZShjdHgsIHJu
dW0sIGlzX3ByZWRpY2F0ZWQpOworICAgIH0KK30KKworc3RhdGljIHZvaWQgbWFya19pbXBsaWNp
dF9yZWdfd3JpdGVzKERpc2FzQ29udGV4dCAqY3R4KQoreworICAgIG1hcmtfaW1wbGljaXRfcmVn
X3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfRlAsICBIRVhfUkVHX0ZQKTsKKyAgICBtYXJr
X2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX1NQLCAgSEVYX1JFR19T
UCk7CisgICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19M
UiwgIEhFWF9SRUdfTFIpOworICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9JTVBM
SUNJVF9XUklURVNfTEMwLCBIRVhfUkVHX0xDMCk7CisgICAgbWFya19pbXBsaWNpdF9yZWdfd3Jp
dGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19TQTAsIEhFWF9SRUdfU0EwKTsKKyAgICBtYXJrX2lt
cGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX0xDMSwgSEVYX1JFR19MQzEp
OworICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfU0Ex
LCBIRVhfUkVHX1NBMSk7CisgICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0lNUExJ
Q0lUX1dSSVRFU19VU1IsIEhFWF9SRUdfVVNSKTsKKyAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0
ZShjdHgsIEFfRlBPUCwgSEVYX1JFR19VU1IpOworfQorCitzdGF0aWMgdm9pZCBtYXJrX2ltcGxp
Y2l0X3ByZWRfd3JpdGUoRGlzYXNDb250ZXh0ICpjdHgsIGludCBhdHRyaWIsIGludCBwbnVtKQor
eworICAgIGlmIChHRVRfQVRUUklCKGN0eC0+aW5zbi0+b3Bjb2RlLCBhdHRyaWIpKSB7CisgICAg
ICAgIGN0eF9sb2dfcHJlZF93cml0ZShjdHgsIHBudW0pOworICAgIH0KK30KKworc3RhdGljIHZv
aWQgbWFya19pbXBsaWNpdF9wcmVkX3dyaXRlcyhEaXNhc0NvbnRleHQgKmN0eCkKK3sKKyAgICBt
YXJrX2ltcGxpY2l0X3ByZWRfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19QMCwgMCk7Cisg
ICAgbWFya19pbXBsaWNpdF9wcmVkX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfUDEsIDEp
OworICAgIG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX1Ay
LCAyKTsKKyAgICBtYXJrX2ltcGxpY2l0X3ByZWRfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRF
U19QMywgMyk7Cit9CisKK3N0YXRpYyB2b2lkIGFuYWx5emVfcGFja2V0KERpc2FzQ29udGV4dCAq
Y3R4KQoreworICAgIFBhY2tldCAqcGt0ID0gY3R4LT5wa3Q7CisgICAgZm9yIChpbnQgaSA9IDA7
IGkgPCBwa3QtPm51bV9pbnNuczsgaSsrKSB7CisgICAgICAgIEluc24gKmluc24gPSAmcGt0LT5p
bnNuW2ldOworICAgICAgICBjdHgtPmluc24gPSBpbnNuOworICAgICAgICBpZiAob3Bjb2RlX2Fu
YWx5emVbaW5zbi0+b3Bjb2RlXSkgeworICAgICAgICAgICAgb3Bjb2RlX2FuYWx5emVbaW5zbi0+
b3Bjb2RlXShjdHgpOworICAgICAgICB9CisgICAgICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRl
cyhjdHgpOworICAgICAgICBtYXJrX2ltcGxpY2l0X3ByZWRfd3JpdGVzKGN0eCk7CisgICAgfQor
fQorCiBzdGF0aWMgdm9pZCBnZW5fc3RhcnRfcGFja2V0KERpc2FzQ29udGV4dCAqY3R4KQogewog
ICAgIFBhY2tldCAqcGt0ID0gY3R4LT5wa3Q7CkBAIC0yNzUsNiArMzU0LDcgQEAgc3RhdGljIHZv
aWQgZ2VuX3N0YXJ0X3BhY2tldChEaXNhc0NvbnRleHQgKmN0eCkKICAgICBjdHgtPm5leHRfUEMg
PSBuZXh0X1BDOwogICAgIGN0eC0+cmVnX2xvZ19pZHggPSAwOwogICAgIGJpdG1hcF96ZXJvKGN0
eC0+cmVnc193cml0dGVuLCBUT1RBTF9QRVJfVEhSRUFEX1JFR1MpOworICAgIGJpdG1hcF96ZXJv
KGN0eC0+cHJlZGljYXRlZF9yZWdzLCBUT1RBTF9QRVJfVEhSRUFEX1JFR1MpOwogICAgIGN0eC0+
cHJlZ19sb2dfaWR4ID0gMDsKICAgICBiaXRtYXBfemVybyhjdHgtPnByZWdzX3dyaXR0ZW4sIE5V
TV9QUkVHUyk7CiAgICAgY3R4LT5mdXR1cmVfdnJlZ3NfaWR4ID0gMDsKQEAgLTI5MSw2ICszNzEs
MTQgQEAgc3RhdGljIHZvaWQgZ2VuX3N0YXJ0X3BhY2tldChEaXNhc0NvbnRleHQgKmN0eCkKICAg
ICBjdHgtPnMxX3N0b3JlX3Byb2Nlc3NlZCA9IGZhbHNlOwogICAgIGN0eC0+cHJlX2NvbW1pdCA9
IHRydWU7CiAKKyAgICBhbmFseXplX3BhY2tldChjdHgpOworCisgICAgLyoKKyAgICAgKiBwcmVn
c193cml0dGVuIGlzIHVzZWQgYm90aCBpbiB0aGUgYW5hbHl6ZSBwaGFzZSBhcyB3ZWxsIGFzIHRo
ZSBjb2RlCisgICAgICogZ2VuIHBoYXNlLCBzbyBjbGVhciBpdCBhZ2Fpbi4KKyAgICAgKi8KKyAg
ICBiaXRtYXBfemVybyhjdHgtPnByZWdzX3dyaXR0ZW4sIE5VTV9QUkVHUyk7CisKICAgICBpZiAo
SEVYX0RFQlVHKSB7CiAgICAgICAgIC8qIEhhbmR5IHBsYWNlIHRvIHNldCBhIGJyZWFrcG9pbnQg
YmVmb3JlIHRoZSBwYWNrZXQgZXhlY3V0ZXMgKi8KICAgICAgICAgZ2VuX2hlbHBlcl9kZWJ1Z19z
dGFydF9wYWNrZXQoY3B1X2Vudik7CkBAIC0zMTMsNiArNDAxLDE2IEBAIHN0YXRpYyB2b2lkIGdl
bl9zdGFydF9wYWNrZXQoRGlzYXNDb250ZXh0ICpjdHgpCiAgICAgICAgIHRjZ19nZW5fbW92aV90
bChoZXhfcHJlZF93cml0dGVuLCAwKTsKICAgICB9CiAKKyAgICAvKiBQcmVsb2FkIHRoZSBwcmVk
aWNhdGVkIHJlZ2lzdGVycyBpbnRvIGhleF9uZXdfdmFsdWVbaV0gKi8KKyAgICBpZiAoIWJpdG1h
cF9lbXB0eShjdHgtPnByZWRpY2F0ZWRfcmVncywgVE9UQUxfUEVSX1RIUkVBRF9SRUdTKSkgewor
ICAgICAgICBpbnQgaSA9IGZpbmRfZmlyc3RfYml0KGN0eC0+cHJlZGljYXRlZF9yZWdzLCBUT1RB
TF9QRVJfVEhSRUFEX1JFR1MpOworICAgICAgICB3aGlsZSAoaSA8IFRPVEFMX1BFUl9USFJFQURf
UkVHUykgeworICAgICAgICAgICAgdGNnX2dlbl9tb3ZfdGwoaGV4X25ld192YWx1ZVtpXSwgaGV4
X2dwcltpXSk7CisgICAgICAgICAgICBpID0gZmluZF9uZXh0X2JpdChjdHgtPnByZWRpY2F0ZWRf
cmVncywgVE9UQUxfUEVSX1RIUkVBRF9SRUdTLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgaSArIDEpOworICAgICAgICB9CisgICAgfQorCiAgICAgaWYgKHBrdC0+cGt0X2hhc19odngp
IHsKICAgICAgICAgdGNnX2dlbl9tb3ZpX3RsKGhleF9WUmVnc191cGRhdGVkLCAwKTsKICAgICAg
ICAgdGNnX2dlbl9tb3ZpX3RsKGhleF9RUmVnc191cGRhdGVkLCAwKTsKQEAgLTMzNiw2NiArNDM0
LDYgQEAgYm9vbCBpc19nYXRoZXJfc3RvcmVfaW5zbihEaXNhc0NvbnRleHQgKmN0eCkKICAgICBy
ZXR1cm4gZmFsc2U7CiB9CiAKLS8qCi0gKiBUaGUgTE9HXypfV1JJVEUgbWFjcm9zIG1hcmsgbW9z
dCBvZiB0aGUgd3JpdGVzIGluIGEgcGFja2V0Ci0gKiBIb3dldmVyLCB0aGVyZSBhcmUgc29tZSBp
bXBsaWNpdCB3cml0ZXMgbWFya2VkIGFzIGF0dHJpYnV0ZXMKLSAqIG9mIHRoZSBhcHBsaWNhYmxl
IGluc3RydWN0aW9ucy4KLSAqLwotc3RhdGljIHZvaWQgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUo
RGlzYXNDb250ZXh0ICpjdHgsIGludCBhdHRyaWIsIGludCBybnVtKQotewotICAgIHVpbnQxNl90
IG9wY29kZSA9IGN0eC0+aW5zbi0+b3Bjb2RlOwotICAgIGlmIChHRVRfQVRUUklCKG9wY29kZSwg
YXR0cmliKSkgewotICAgICAgICAvKgotICAgICAgICAgKiBVU1IgaXMgdXNlZCB0byBzZXQgb3Zl
cmZsb3cgYW5kIEZQIGV4Y2VwdGlvbnMsCi0gICAgICAgICAqIHNvIHRyZWF0IGl0IGFzIGNvbmRp
dGlvbmFsCi0gICAgICAgICAqLwotICAgICAgICBib29sIGlzX3ByZWRpY2F0ZWQgPSBHRVRfQVRU
UklCKG9wY29kZSwgQV9DT05ERVhFQykgfHwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
cm51bSA9PSBIRVhfUkVHX1VTUjsKLQotICAgICAgICAvKiBMQzAvTEMxIGlzIGNvbmRpdGlvbmFs
bHkgd3JpdHRlbiBieSBlbmRsb29wIGluc3RydWN0aW9ucyAqLwotICAgICAgICBpZiAoKHJudW0g
PT0gSEVYX1JFR19MQzAgfHwgcm51bSA9PSBIRVhfUkVHX0xDMSkgJiYKLSAgICAgICAgICAgIChv
cGNvZGUgPT0gSjJfZW5kbG9vcDAgfHwKLSAgICAgICAgICAgICBvcGNvZGUgPT0gSjJfZW5kbG9v
cDEgfHwKLSAgICAgICAgICAgICBvcGNvZGUgPT0gSjJfZW5kbG9vcDAxKSkgewotICAgICAgICAg
ICAgaXNfcHJlZGljYXRlZCA9IHRydWU7Ci0gICAgICAgIH0KLQotICAgICAgICBpZiAoaXNfcHJl
ZGljYXRlZCAmJiAhaXNfcHJlbG9hZGVkKGN0eCwgcm51bSkpIHsKLSAgICAgICAgICAgIHRjZ19n
ZW5fbW92X3RsKGhleF9uZXdfdmFsdWVbcm51bV0sIGhleF9ncHJbcm51bV0pOwotICAgICAgICB9
Ci0KLSAgICAgICAgY3R4X2xvZ19yZWdfd3JpdGUoY3R4LCBybnVtKTsKLSAgICB9Ci19Ci0KLXN0
YXRpYyB2b2lkIG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZShEaXNhc0NvbnRleHQgKmN0eCwgaW50
IGF0dHJpYiwgaW50IHBudW0pCi17Ci0gICAgaWYgKEdFVF9BVFRSSUIoY3R4LT5pbnNuLT5vcGNv
ZGUsIGF0dHJpYikpIHsKLSAgICAgICAgY3R4X2xvZ19wcmVkX3dyaXRlKGN0eCwgcG51bSk7Ci0g
ICAgfQotfQotCi1zdGF0aWMgdm9pZCBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZXMoRGlzYXNDb250
ZXh0ICpjdHgpCi17Ci0gICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0lNUExJQ0lU
X1dSSVRFU19GUCwgIEhFWF9SRUdfRlApOwotICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0
eCwgQV9JTVBMSUNJVF9XUklURVNfU1AsICBIRVhfUkVHX1NQKTsKLSAgICBtYXJrX2ltcGxpY2l0
X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX0xSLCAgSEVYX1JFR19MUik7Ci0gICAg
bWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19MQzAsIEhFWF9S
RUdfTEMwKTsKLSAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJ
VEVTX1NBMCwgSEVYX1JFR19TQTApOwotICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwg
QV9JTVBMSUNJVF9XUklURVNfTEMxLCBIRVhfUkVHX0xDMSk7Ci0gICAgbWFya19pbXBsaWNpdF9y
ZWdfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19TQTEsIEhFWF9SRUdfU0ExKTsKLSAgICBt
YXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX1VTUiwgSEVYX1JF
R19VU1IpOwotICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9GUE9QLCBIRVhfUkVH
X1VTUik7Ci19Ci0KLXN0YXRpYyB2b2lkIG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZXMoRGlzYXND
b250ZXh0ICpjdHgpCi17Ci0gICAgbWFya19pbXBsaWNpdF9wcmVkX3dyaXRlKGN0eCwgQV9JTVBM
SUNJVF9XUklURVNfUDAsIDApOwotICAgIG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZShjdHgsIEFf
SU1QTElDSVRfV1JJVEVTX1AxLCAxKTsKLSAgICBtYXJrX2ltcGxpY2l0X3ByZWRfd3JpdGUoY3R4
LCBBX0lNUExJQ0lUX1dSSVRFU19QMiwgMik7Ci0gICAgbWFya19pbXBsaWNpdF9wcmVkX3dyaXRl
KGN0eCwgQV9JTVBMSUNJVF9XUklURVNfUDMsIDMpOwotfQotCiBzdGF0aWMgdm9pZCBtYXJrX3N0
b3JlX3dpZHRoKERpc2FzQ29udGV4dCAqY3R4KQogewogICAgIHVpbnQxNl90IG9wY29kZSA9IGN0
eC0+aW5zbi0+b3Bjb2RlOwpAQCAtNDIzLDkgKzQ2MSw3IEBAIHN0YXRpYyB2b2lkIG1hcmtfc3Rv
cmVfd2lkdGgoRGlzYXNDb250ZXh0ICpjdHgpCiBzdGF0aWMgdm9pZCBnZW5faW5zbihEaXNhc0Nv
bnRleHQgKmN0eCkKIHsKICAgICBpZiAoY3R4LT5pbnNuLT5nZW5lcmF0ZSkgewotICAgICAgICBt
YXJrX2ltcGxpY2l0X3JlZ193cml0ZXMoY3R4KTsKICAgICAgICAgY3R4LT5pbnNuLT5nZW5lcmF0
ZShjdHgpOwotICAgICAgICBtYXJrX2ltcGxpY2l0X3ByZWRfd3JpdGVzKGN0eCk7CiAgICAgICAg
IG1hcmtfc3RvcmVfd2lkdGgoY3R4KTsKICAgICB9IGVsc2UgewogICAgICAgICBnZW5fZXhjZXB0
aW9uX2VuZF90YihjdHgsIEhFWF9FWENQX0lOVkFMSURfT1BDT0RFKTsKZGlmZiAtLWdpdCBhL3Rh
cmdldC9oZXhhZ29uL1JFQURNRSBiL3RhcmdldC9oZXhhZ29uL1JFQURNRQppbmRleCAyNTE5NjBi
ODYyLi4zNjU2MDZmMWU2IDEwMDY0NAotLS0gYS90YXJnZXQvaGV4YWdvbi9SRUFETUUKKysrIGIv
dGFyZ2V0L2hleGFnb24vUkVBRE1FCkBAIC01Miw2ICs1Miw3IEBAIGhlYWRlciBmaWxlcyBpbiA8
QlVJTERfRElSPi90YXJnZXQvaGV4YWdvbgogICAgICAgICBnZW5fdGNnX2Z1bmNfdGFibGUucHkg
ICAgICAgICAgIC0+IHRjZ19mdW5jX3RhYmxlX2dlbmVyYXRlZC5jLmluYwogICAgICAgICBnZW5f
aGVscGVyX2Z1bmNzLnB5ICAgICAgICAgICAgIC0+IGhlbHBlcl9mdW5jc19nZW5lcmF0ZWQuYy5p
bmMKICAgICAgICAgZ2VuX2lkZWZfcGFyc2VyX2Z1bmNzLnB5ICAgICAgICAtPiBpZGVmX3BhcnNl
cl9pbnB1dC5oCisgICAgICAgIGdlbl9hbmFseXplX2Z1bmNzLnB5ICAgICAgICAgICAgLT4gYW5h
bHl6ZV9mdW5jc19nZW5lcmF0ZWQuYy5pbmMKIAogUWVtdSBoZWxwZXIgZnVuY3Rpb25zIGhhdmUg
MyBwYXJ0cwogICAgIERFRl9IRUxQRVIgZGVjbGFyYXRpb24gaW5kaWNhdGVzIHRoZSBzaWduYXR1
cmUgb2YgdGhlIGhlbHBlcgpAQCAtODcsNyArODgsNiBAQCB0Y2dfZnVuY3NfZ2VuZXJhdGVkLmMu
aW5jCiAgICAgICAgIFRDR3YgUnRWID0gaGV4X2dwcltpbnNuLT5yZWdub1syXV07CiAgICAgICAg
IGdlbl9oZWxwZXJfQTJfYWRkKFJkViwgY3B1X2VudiwgUnNWLCBSdFYpOwogICAgICAgICBnZW5f
bG9nX3JlZ193cml0ZShSZE4sIFJkVik7Ci0gICAgICAgIGN0eF9sb2dfcmVnX3dyaXRlKGN0eCwg
UmROKTsKICAgICB9CiAKIGhlbHBlcl9mdW5jc19nZW5lcmF0ZWQuYy5pbmMKQEAgLTE2MCw3ICsx
NjAsNiBAQCBpc3RydWN0aW9uLgogICAgICAgICBUQ0d2IHNsb3QgPSB0Y2dfY29uc3RhbnRfdGwo
aW5zbi0+c2xvdCk7CiAgICAgICAgIGdlbl9oZWxwZXJfVjZfdmFkZHcoY3B1X2VudiwgVmRWLCBW
dVYsIFZ2Viwgc2xvdCk7CiAgICAgICAgIGdlbl9sb2dfdnJlZ193cml0ZShjdHgsIFZkVl9vZmYs
IFZkTiwgRVhUX0RGTCwgaW5zbi0+c2xvdCwgZmFsc2UpOwotICAgICAgICBjdHhfbG9nX3ZyZWdf
d3JpdGUoY3R4LCBWZE4sIEVYVF9ERkwsIGZhbHNlKTsKICAgICB9CiAKIE5vdGljZSB0aGF0IHdl
IGFsc28gZ2VuZXJhdGUgYSB2YXJpYWJsZSBuYW1lZCA8b3BlcmFuZD5fb2ZmIGZvciBlYWNoIG9w
ZXJhbmQgb2YKQEAgLTE5MCw5ICsxODksMTQgQEAgd2hlbiB0aGUgb3ZlcnJpZGUgaXMgcHJlc2Vu
dC4KICAgICAgICAgICAgIHZyZWdfc3JjX29mZihjdHgsIFZ2Tik7CiAgICAgICAgIGZHRU5fVENH
X1Y2X3ZhZGR3KHsgZkhJREUoaW50IGk7KSBmVkZPUkVBQ0goMzIsIGkpIHsgVmRWLndbaV0gPSBW
dVYud1tpXSArIFZ2Vi53W2ldIDsgfSB9KTsKICAgICAgICAgZ2VuX2xvZ192cmVnX3dyaXRlKGN0
eCwgVmRWX29mZiwgVmROLCBFWFRfREZMLCBpbnNuLT5zbG90LCBmYWxzZSk7Ci0gICAgICAgIGN0
eF9sb2dfdnJlZ193cml0ZShjdHgsIFZkTiwgRVhUX0RGTCwgZmFsc2UpOwogICAgIH0KIAorV2Ug
YWxzbyBnZW5lcmF0ZSBhbiBhbmFseXplXzx0YWc+IGZ1bmN0aW9uIGZvciBlYWNoIGluc3RydWN0
aW9uLiAgQ3VycmVudGx5LAordGhlc2UgZnVuY3Rpb25zIHJlY29yZCB0aGUgd3JpdGVzIHRvIHJl
Z2lzdGVycyBieSBjYWxsaW5nIGN0eF9sb2dfKi4gIER1cmluZworZ2VuX3N0YXJ0X3BhY2tldCwg
d2UgaW52b2tlIHRoZSBhbmFseXplXzx0YWc+IGZ1bmN0aW9uIGZvciBlYWNoIGluc3RydWN0aW9u
IGluCit0aGUgcGFja2V0LCBhbmQgd2UgbWFyayB0aGUgaW1wbGljaXQgd3JpdGVzLiAgQWZ0ZXIg
dGhlIGFuYWx5c2lzIGlzIHBlcmZvcm1lZCwKK3dlIGluaXRpYWxpemUgaGV4X25ld192YWx1ZSBm
b3IgZWFjaCBvZiB0aGUgcHJlZGljYXRlZCBhc3NpZ25tZW50cy4KKwogSW4gYWRkaXRpb24gdG8g
aW5zdHJ1Y3Rpb24gc2VtYW50aWNzLCB3ZSB1c2UgYSBnZW5lcmF0b3IgdG8gY3JlYXRlIHRoZSBk
ZWNvZGUKIHRyZWUuICBUaGlzIGdlbmVyYXRpb24gaXMgYWxzbyBhIHR3byBzdGVwIHByb2Nlc3Mu
ICBUaGUgZmlyc3Qgc3RlcCBpcyB0byBydW4KIHRhcmdldC9oZXhhZ29uL2dlbl9kZWN0cmVlX2lt
cG9ydC5jIHRvIHByb2R1Y2UKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29uL2dlbl9hbmFseXpl
X2Z1bmNzLnB5IGIvdGFyZ2V0L2hleGFnb24vZ2VuX2FuYWx5emVfZnVuY3MucHkKbmV3IGZpbGUg
bW9kZSAxMDA3NTUKaW5kZXggMDAwMDAwMDAwMC4uMzdjMTY2ZGMwZAotLS0gL2Rldi9udWxsCisr
KyBiL3RhcmdldC9oZXhhZ29uL2dlbl9hbmFseXplX2Z1bmNzLnB5CkBAIC0wLDAgKzEsMjM3IEBA
CisjIS91c3IvYmluL2VudiBweXRob24zCisKKyMjCisjIyAgQ29weXJpZ2h0KGMpIDIwMjItMjAy
MyBRdWFsY29tbSBJbm5vdmF0aW9uIENlbnRlciwgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLgor
IyMKKyMjICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1
dGUgaXQgYW5kL29yIG1vZGlmeQorIyMgIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdl
bmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5CisjIyAgdGhlIEZyZWUgU29mdHdh
cmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IKKyMjICAo
YXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorIyMKKyMjICBUaGlzIHByb2dyYW0g
aXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyMjICBi
dXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50
eSBvZgorIyMgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVS
UE9TRS4gIFNlZSB0aGUKKyMjICBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBk
ZXRhaWxzLgorIyMKKyMjICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBH
TlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQorIyMgIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtOyBp
ZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCisjIworCitpbXBvcnQg
c3lzCitpbXBvcnQgcmUKK2ltcG9ydCBzdHJpbmcKK2ltcG9ydCBoZXhfY29tbW9uCisKKyMjCisj
IyBIZWxwZXJzIGZvciBnZW5fYW5hbHl6ZV9mdW5jCisjIworZGVmIGlzX3ByZWRpY2F0ZWQodGFn
KToKKyAgICByZXR1cm4gJ0FfQ09OREVYRUMnIGluIGhleF9jb21tb24uYXR0cmliZGljdFt0YWdd
CisKK2RlZiBhbmFseXplX29wbl9vbGQoZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgcmVnbm8pOgor
ICAgIHJlZ04gPSAiJXMlc04iICUgKHJlZ3R5cGUsIHJlZ2lkKQorICAgIHByZWRpY2F0ZWQgPSAi
dHJ1ZSIgaWYgaXNfcHJlZGljYXRlZCh0YWcpIGVsc2UgImZhbHNlIgorICAgIGlmIChyZWd0eXBl
ID09ICJSIik6CisgICAgICAgIGlmIChyZWdpZCBpbiB7InNzIiwgInR0In0pOgorICAgICAgICAg
ICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwK
KyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7
ImRkIiwgImVlIiwgInh4IiwgInl5In0pOgorICAgICAgICAgICAgZi53cml0ZSgiICAgIGNvbnN0
IGludCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSAocmVnTiwgcmVnbm8pKQorICAgICAgICAg
ICAgZi53cml0ZSgiICAgIGN0eF9sb2dfcmVnX3dyaXRlX3BhaXIoY3R4LCAlcywgJXMpO1xuIiAl
IFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcHJlZGljYXRlZCkpCisgICAgICAgIGVsaWYgKHJl
Z2lkIGluIHsicyIsICJ0IiwgInUiLCAidiJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAg
IGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAg
KHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxpZiAocmVnaWQgaW4geyJkIiwgImUiLCAieCIsICJ5
In0pOgorICAgICAgICAgICAgZi53cml0ZSgiICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25v
WyVkXTtcbiIgJSAocmVnTiwgcmVnbm8pKQorICAgICAgICAgICAgZi53cml0ZSgiICAgIGN0eF9s
b2dfcmVnX3dyaXRlKGN0eCwgJXMsICVzKTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04s
IHByZWRpY2F0ZWQpKQorICAgICAgICBlbHNlOgorICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdp
c3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCisgICAgZWxpZiAocmVndHlwZSA9PSAiUCIp
OgorICAgICAgICBpZiAocmVnaWQgaW4geyJzIiwgInQiLCAidSIsICJ2In0pOgorICAgICAgICAg
ICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwK
KyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7
ImQiLCAiZSIsICJ4In0pOgorICAgICAgICAgICAgZi53cml0ZSgiICAgIGNvbnN0IGludCAlcyA9
IGluc24tPnJlZ25vWyVkXTtcbiIgJSAocmVnTiwgcmVnbm8pKQorICAgICAgICAgICAgZi53cml0
ZSgiICAgIGN0eF9sb2dfcHJlZF93cml0ZShjdHgsICVzKTtcbiIgJSAocmVnTikpCisgICAgICAg
IGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBl
LCByZWdpZCkKKyAgICBlbGlmIChyZWd0eXBlID09ICJDIik6CisgICAgICAgIGlmIChyZWdpZCA9
PSAic3MiKToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24t
PnJlZ25vWyVkXSArIEhFWF9SRUdfU0EwO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwg
cmVnbm8pKQorICAgICAgICBlbGlmIChyZWdpZCA9PSAiZGQiKToKKyAgICAgICAgICAgIGYud3Jp
dGUoIiAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF0gKyBIRVhfUkVHX1NBMDtcbiIg
JSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgICAgIGYud3JpdGUo
IiAgICBjdHhfbG9nX3JlZ193cml0ZV9wYWlyKGN0eCwgJXMsICVzKTtcbiIgJSBcCisgICAgICAg
ICAgICAgICAgKHJlZ04sIHByZWRpY2F0ZWQpKQorICAgICAgICBlbGlmIChyZWdpZCA9PSAicyIp
OgorICAgICAgICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9b
JWRdICsgSEVYX1JFR19TQTA7XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykp
CisgICAgICAgIGVsaWYgKHJlZ2lkID09ICJkIik6CisgICAgICAgICAgICBmLndyaXRlKCIgICAg
Y29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdICsgSEVYX1JFR19TQTA7XG4iICUgXAorICAg
ICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgICAgICBmLndyaXRlKCIgICAgY3R4
X2xvZ19yZWdfd3JpdGUoY3R4LCAlcywgJXMpO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVn
TiwgcHJlZGljYXRlZCkpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFkIHJl
Z2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKyAgICBlbGlmIChyZWd0eXBlID09ICJN
Iik6CisgICAgICAgIGlmIChyZWdpZCA9PSAidSIpOgorICAgICAgICAgICAgZi53cml0ZSgiLy8g
ICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiUgXAorICAgICAgICAgICAgICAg
IChyZWdOLCByZWdubykpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFkIHJl
Z2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKyAgICBlbGlmIChyZWd0eXBlID09ICJW
Iik6CisgICAgICAgIGlmIChyZWdpZCBpbiB7ImRkIiwgInh4In0pOgorICAgICAgICAgICAgZi53
cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlXAorICAgICAg
ICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVsaWYgKHJlZ2lkIGluIHsidXUiLCAi
dnYifSk6CisgICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5y
ZWdub1slZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAg
IGVsaWYgKHJlZ2lkIGluIHsicyIsICJ1IiwgInYiLCAidyJ9KToKKyAgICAgICAgICAgIGYud3Jp
dGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAg
ICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxpZiAocmVnaWQgaW4geyJkIiwgIngi
LCAieSJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24t
PnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAg
ICAgZWxzZToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5
cGUsIHJlZ2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIlEiKToKKyAgICAgICAgaWYgKHJlZ2lk
IGluIHsiZCIsICJlIiwgIngifSk6CisgICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBp
bnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCBy
ZWdubykpCisgICAgICAgIGVsaWYgKHJlZ2lkIGluIHsicyIsICJ0IiwgInUiLCAidiJ9KToKKyAg
ICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVkXTtc
biIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxzZToKKyAg
ICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQor
ICAgIGVsaWYgKHJlZ3R5cGUgPT0gIkciKToKKyAgICAgICAgaWYgKHJlZ2lkIGluIHsiZGQifSk6
CisgICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1sl
ZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVsaWYg
KHJlZ2lkIGluIHsiZCJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAl
cyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25v
KSkKKyAgICAgICAgZWxpZiAocmVnaWQgaW4geyJzcyJ9KToKKyAgICAgICAgICAgIGYud3JpdGUo
Ii8vICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAg
ICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxpZiAocmVnaWQgaW4geyJzIn0pOgorICAg
ICAgICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xu
IiAlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbHNlOgorICAg
ICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCisg
ICAgZWxpZiAocmVndHlwZSA9PSAiUyIpOgorICAgICAgICBpZiAocmVnaWQgaW4geyJkZCJ9KToK
KyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVk
XTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxpZiAo
cmVnaWQgaW4geyJkIn0pOgorICAgICAgICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVz
ID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8p
KQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7InNzIn0pOgorICAgICAgICAgICAgZi53cml0ZSgi
Ly8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwKKyAgICAgICAgICAg
ICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7InMifSk6CisgICAg
ICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4i
ICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVsc2U6CisgICAg
ICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKyAg
ICBlbHNlOgorICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCBy
ZWdpZCkKKworZGVmIGFuYWx5emVfb3BuX25ldyhmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCByZWdu
byk6CisgICAgcmVnTiA9ICIlcyVzTiIgJSAocmVndHlwZSwgcmVnaWQpCisgICAgaWYgKHJlZ3R5
cGUgPT0gIk4iKToKKyAgICAgICAgaWYgKHJlZ2lkIGluIHsicyIsICJ0In0pOgorICAgICAgICAg
ICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwK
KyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbHNlOgorICAgICAgICAg
ICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCisgICAgZWxp
ZiAocmVndHlwZSA9PSAiUCIpOgorICAgICAgICBpZiAocmVnaWQgaW4geyJ0IiwgInUiLCAidiJ9
KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25v
WyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxz
ZToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJl
Z2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIk8iKToKKyAgICAgICAgaWYgKHJlZ2lkID09ICJz
Iik6CisgICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdu
b1slZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVs
c2U6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCBy
ZWdpZCkKKyAgICBlbHNlOgorICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCBy
ZWd0eXBlLCByZWdpZCkKKworZGVmIGFuYWx5emVfb3BuKGYsIHRhZywgcmVndHlwZSwgcmVnaWQs
IHRvc3MsIG51bXJlZ3MsIGkpOgorICAgIGlmIChoZXhfY29tbW9uLmlzX3BhaXIocmVnaWQpKToK
KyAgICAgICAgYW5hbHl6ZV9vcG5fb2xkKGYsIHRhZywgcmVndHlwZSwgcmVnaWQsIGkpCisgICAg
ZWxpZiAoaGV4X2NvbW1vbi5pc19zaW5nbGUocmVnaWQpKToKKyAgICAgICAgaWYgaGV4X2NvbW1v
bi5pc19vbGRfdmFsKHJlZ3R5cGUsIHJlZ2lkLCB0YWcpOgorICAgICAgICAgICAgYW5hbHl6ZV9v
cG5fb2xkKGYsdGFnLCByZWd0eXBlLCByZWdpZCwgaSkKKyAgICAgICAgZWxpZiBoZXhfY29tbW9u
LmlzX25ld192YWwocmVndHlwZSwgcmVnaWQsIHRhZyk6CisgICAgICAgICAgICBhbmFseXplX29w
bl9uZXcoZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgaSkKKyAgICAgICAgZWxzZToKKyAgICAgICAg
ICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkLCB0b3NzLCBu
dW1yZWdzKQorICAgIGVsc2U6CisgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIs
IHJlZ3R5cGUsIHJlZ2lkLCB0b3NzLCBudW1yZWdzKQorCisjIworIyMgR2VuZXJhdGUgdGhlIGNv
ZGUgdG8gYW5hbHl6ZSB0aGUgaW5zdHJ1Y3Rpb24KKyMjICAgICBGb3IgQTJfYWRkOiBSZDMyPWFk
ZChSczMyLFJ0MzIpLCB7IFJkVj1Sc1YrUnRWO30KKyMjICAgICBXZSBwcm9kdWNlOgorIyMgICAg
IHN0YXRpYyB2b2lkIGFuYWx5emVfQTJfYWRkKERpc2FzQ29udGV4dCAqY3R4KQorIyMgICAgIHsK
KyMjICAgICAgICAgSW5zbiAqaW5zbiBHX0dOVUNfVU5VU0VEID0gY3R4LT5pbnNuOworIyMgICAg
ICAgICBjb25zdCBpbnQgUmROID0gaW5zbi0+cmVnbm9bMF07CisjIyAgICAgICAgIGN0eF9sb2df
cmVnX3dyaXRlKGN0eCwgUmROLCBmYWxzZSk7CisjIyAgICAgLy8gICAgY29uc3QgaW50IFJzTiA9
IGluc24tPnJlZ25vWzFdOworIyMgICAgIC8vICAgIGNvbnN0IGludCBSdE4gPSBpbnNuLT5yZWdu
b1syXTsKKyMjICAgICB9CisjIworZGVmIGdlbl9hbmFseXplX2Z1bmMoZiwgdGFnLCByZWdzLCBp
bW1zKToKKyAgICBmLndyaXRlKCJzdGF0aWMgdm9pZCBhbmFseXplXyVzKERpc2FzQ29udGV4dCAq
Y3R4KVxuIiAldGFnKQorICAgIGYud3JpdGUoJ3tcbicpCisKKyAgICBmLndyaXRlKCIgICAgSW5z
biAqaW5zbiBHX0dOVUNfVU5VU0VEID0gY3R4LT5pbnNuO1xuIikKKworICAgIGk9MAorICAgICMj
IEFuYWx5emUgYWxsIHRoZSByZWdpc3RlcnMKKyAgICBmb3IgcmVndHlwZSwgcmVnaWQsIHRvc3Ms
IG51bXJlZ3MgaW4gcmVnczoKKyAgICAgICAgYW5hbHl6ZV9vcG4oZiwgdGFnLCByZWd0eXBlLCBy
ZWdpZCwgdG9zcywgbnVtcmVncywgaSkKKyAgICAgICAgaSArPSAxCisKKworICAgIGYud3JpdGUo
In1cblxuIikKKworZGVmIG1haW4oKToKKyAgICBoZXhfY29tbW9uLnJlYWRfc2VtYW50aWNzX2Zp
bGUoc3lzLmFyZ3ZbMV0pCisgICAgaGV4X2NvbW1vbi5yZWFkX2F0dHJpYnNfZmlsZShzeXMuYXJn
dlsyXSkKKyAgICBoZXhfY29tbW9uLnJlYWRfb3ZlcnJpZGVzX2ZpbGUoc3lzLmFyZ3ZbM10pCisg
ICAgaGV4X2NvbW1vbi5yZWFkX292ZXJyaWRlc19maWxlKHN5cy5hcmd2WzRdKQorICAgICMjIFdo
ZXRoZXIgb3Igbm90IGlkZWYtcGFyc2VyIGlzIGVuYWJsZWQgaXMKKyAgICAjIyBkZXRlcm1pbmVk
IGJ5IHRoZSBudW1iZXIgb2YgYXJndW1lbnRzIHRvCisgICAgIyMgdGhpcyBzY3JpcHQ6CisgICAg
IyMKKyAgICAjIyAgIDUgYXJncy4gLT4gbm90IGVuYWJsZWQsCisgICAgIyMgICA2IGFyZ3MuIC0+
IGlkZWYtcGFyc2VyIGVuYWJsZWQuCisgICAgIyMKKyAgICAjIyBUaGUgNjp0aCBhcmcuIHRoZW4g
aG9sZHMgYSBsaXN0IG9mIHRoZSBzdWNjZXNzZnVsbHkKKyAgICAjIyBwYXJzZWQgaW5zdHJ1Y3Rp
b25zLgorICAgIGlzX2lkZWZfcGFyc2VyX2VuYWJsZWQgPSBsZW4oc3lzLmFyZ3YpID4gNgorICAg
IGlmIGlzX2lkZWZfcGFyc2VyX2VuYWJsZWQ6CisgICAgICAgIGhleF9jb21tb24ucmVhZF9pZGVm
X3BhcnNlcl9lbmFibGVkX2ZpbGUoc3lzLmFyZ3ZbNV0pCisgICAgaGV4X2NvbW1vbi5jYWxjdWxh
dGVfYXR0cmlicygpCisgICAgdGFncmVncyA9IGhleF9jb21tb24uZ2V0X3RhZ3JlZ3MoKQorICAg
IHRhZ2ltbXMgPSBoZXhfY29tbW9uLmdldF90YWdpbW1zKCkKKworICAgIHdpdGggb3BlbihzeXMu
YXJndlstMV0sICd3JykgYXMgZjoKKyAgICAgICAgZi53cml0ZSgiI2lmbmRlZiBIRVhBR09OX1RD
R19GVU5DU19IXG4iKQorICAgICAgICBmLndyaXRlKCIjZGVmaW5lIEhFWEFHT05fVENHX0ZVTkNT
X0hcblxuIikKKworICAgICAgICBmb3IgdGFnIGluIGhleF9jb21tb24udGFnczoKKyAgICAgICAg
ICAgIGdlbl9hbmFseXplX2Z1bmMoZiwgdGFnLCB0YWdyZWdzW3RhZ10sIHRhZ2ltbXNbdGFnXSkK
KworICAgICAgICBmLndyaXRlKCIjZW5kaWYgICAgLyogSEVYQUdPTl9UQ0dfRlVOQ1NfSCAqL1xu
IikKKworaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKKyAgICBtYWluKCkKZGlmZiAtLWdpdCBh
L3RhcmdldC9oZXhhZ29uL2dlbl90Y2dfZnVuY3MucHkgYi90YXJnZXQvaGV4YWdvbi9nZW5fdGNn
X2Z1bmNzLnB5CmluZGV4IDAyY2I1MmMyMWUuLjAyZmE2NWM1YzkgMTAwNzU1Ci0tLSBhL3Rhcmdl
dC9oZXhhZ29uL2dlbl90Y2dfZnVuY3MucHkKKysrIGIvdGFyZ2V0L2hleGFnb24vZ2VuX3RjZ19m
dW5jcy5weQpAQCAtMSw3ICsxLDcgQEAKICMhL3Vzci9iaW4vZW52IHB5dGhvbjMKIAogIyMKLSMj
ICBDb3B5cmlnaHQoYykgMjAxOS0yMDIyIFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJbmMu
IEFsbCBSaWdodHMgUmVzZXJ2ZWQuCisjIyAgQ29weXJpZ2h0KGMpIDIwMTktMjAyMyBRdWFsY29t
bSBJbm5vdmF0aW9uIENlbnRlciwgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogIyMKICMjICBU
aGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5k
L29yIG1vZGlmeQogIyMgIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVi
bGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5CkBAIC0zNywxNSArMzcsNiBAQCBkZWYgZ2VucHRy
X2RlY2xfcGFpcl93cml0YWJsZShmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCByZWdubyk6CiAgICAg
ICAgICAgICAocmVnTiwgcmVnbm8pKQogICAgIGVsc2U6CiAgICAgICAgIGYud3JpdGUoIiAgICBj
b25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4iICUgKHJlZ04sIHJlZ25vKSkKLSAgICBp
ZiAoJ0FfQ09OREVYRUMnIGluIGhleF9jb21tb24uYXR0cmliZGljdFt0YWddKToKLSAgICAgICAg
Zi53cml0ZSgiICAgIGlmICghaXNfcHJlbG9hZGVkKGN0eCwgJXMpKSB7XG4iICUgcmVnTikKLSAg
ICAgICAgZi53cml0ZSgiICAgICAgICB0Y2dfZ2VuX21vdl90bChoZXhfbmV3X3ZhbHVlWyVzXSwg
aGV4X2dwclslc10pO1xuIiAlIFwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlZ04s
IHJlZ04pKQotICAgICAgICBmLndyaXRlKCIgICAgfVxuIikKLSAgICAgICAgZi53cml0ZSgiICAg
IGlmICghaXNfcHJlbG9hZGVkKGN0eCwgJXMgKyAxKSkge1xuIiAlIHJlZ04pCi0gICAgICAgIGYu
d3JpdGUoIiAgICAgICAgdGNnX2dlbl9tb3ZfdGwoaGV4X25ld192YWx1ZVslcyArIDFdLCBoZXhf
Z3ByWyVzICsgMV0pO1xuIiAlIFwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlZ04s
IHJlZ04pKQotICAgICAgICBmLndyaXRlKCIgICAgfVxuIikKIAogZGVmIGdlbnB0cl9kZWNsX3dy
aXRhYmxlKGYsIHRhZywgcmVndHlwZSwgcmVnaWQsIHJlZ25vKToKICAgICByZWdOPSIlcyVzTiIg
JSAocmVndHlwZSxyZWdpZCkKQEAgLTU2LDExICs0Nyw2IEBAIGRlZiBnZW5wdHJfZGVjbF93cml0
YWJsZShmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCByZWdubyk6CiAgICAgICAgICAgICAocmVnTiwg
cmVnbm8pKQogICAgIGVsc2U6CiAgICAgICAgIGYud3JpdGUoIiAgICBjb25zdCBpbnQgJXMgPSBp
bnNuLT5yZWdub1slZF07XG4iICUgKHJlZ04sIHJlZ25vKSkKLSAgICBpZiAoJ0FfQ09OREVYRUMn
IGluIGhleF9jb21tb24uYXR0cmliZGljdFt0YWddKToKLSAgICAgICAgZi53cml0ZSgiICAgIGlm
ICghaXNfcHJlbG9hZGVkKGN0eCwgJXMpKSB7XG4iICUgcmVnTikKLSAgICAgICAgZi53cml0ZSgi
ICAgICAgICB0Y2dfZ2VuX21vdl90bChoZXhfbmV3X3ZhbHVlWyVzXSwgaGV4X2dwclslc10pO1xu
IiAlIFwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ04pKQotICAgICAg
ICBmLndyaXRlKCIgICAgfVxuIikKIAogZGVmIGdlbnB0cl9kZWNsKGYsIHRhZywgcmVndHlwZSwg
cmVnaWQsIHJlZ25vKToKICAgICByZWdOPSIlcyVzTiIgJSAocmVndHlwZSxyZWdpZCkKQEAgLTM5
MSw4ICszNzcsNiBAQCBkZWYgZ2VucHRyX2RzdF93cml0ZV9wYWlyKGYsIHRhZywgcmVndHlwZSwg
cmVnaWQpOgogICAgIGVsc2U6CiAgICAgICAgIGYud3JpdGUoIiAgICBnZW5fbG9nX3JlZ193cml0
ZV9wYWlyKCVzJXNOLCAlcyVzVik7XG4iICUgXAogICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lk
LCByZWd0eXBlLCByZWdpZCkpCi0gICAgZi53cml0ZSgiICAgIGN0eF9sb2dfcmVnX3dyaXRlX3Bh
aXIoY3R4LCAlcyVzTik7XG4iICUgXAotICAgICAgICAocmVndHlwZSwgcmVnaWQpKQogCiBkZWYg
Z2VucHRyX2RzdF93cml0ZShmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkKToKICAgICBpZiAocmVndHlw
ZSA9PSAiUiIpOgpAQCAtNDA2LDE2ICszOTAsMTIgQEAgZGVmIGdlbnB0cl9kc3Rfd3JpdGUoZiwg
dGFnLCByZWd0eXBlLCByZWdpZCk6CiAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAg
IGYud3JpdGUoIiAgICBnZW5fbG9nX3JlZ193cml0ZSglcyVzTiwgJXMlc1YpO1xuIiAlIFwKICAg
ICAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWd0eXBlLCByZWdpZCkpCi0gICAg
ICAgICAgICBmLndyaXRlKCIgICAgY3R4X2xvZ19yZWdfd3JpdGUoY3R4LCAlcyVzTik7XG4iICUg
XAotICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkpCiAgICAgICAgIGVsc2U6CiAgICAg
ICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKICAg
ICBlbGlmIChyZWd0eXBlID09ICJQIik6CiAgICAgICAgIGlmIChyZWdpZCBpbiB7ImQiLCAiZSIs
ICJ4In0pOgogICAgICAgICAgICAgZi53cml0ZSgiICAgIGdlbl9sb2dfcHJlZF93cml0ZShjdHgs
ICVzJXNOLCAlcyVzVik7XG4iICUgXAogICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCwg
cmVndHlwZSwgcmVnaWQpKQotICAgICAgICAgICAgZi53cml0ZSgiICAgIGN0eF9sb2dfcHJlZF93
cml0ZShjdHgsICVzJXNOKTtcbiIgJSBcCi0gICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lk
KSkKICAgICAgICAgZWxzZToKICAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6
ICIsIHJlZ3R5cGUsIHJlZ2lkKQogICAgIGVsaWYgKHJlZ3R5cGUgPT0gIkMiKToKQEAgLTUwNyw3
ICs0ODcsNiBAQCBkZWYgZ2VucHRyX2RzdF93cml0ZV9vcG4oZixyZWd0eXBlLCByZWdpZCwgdGFn
KToKICMjICAgICAgICAgICBUQ0d2IFJ0ViA9IGhleF9ncHJbaW5zbi0+cmVnbm9bMl1dOwogIyMg
ICAgICAgICAgIDxHRU4+CiAjIyAgICAgICAgICAgZ2VuX2xvZ19yZWdfd3JpdGUoUmROLCBSZFYp
OwotIyMgICAgICAgICAgIGN0eF9sb2dfcmVnX3dyaXRlKGN0eCwgUmROKTsKICMjICAgICAgIH0K
ICMjCiAjIyAgICAgICB3aGVyZSA8R0VOPiBkZXBlbmRzIG9uIGhleF9jb21tb24uc2tpcF9xZW11
X2hlbHBlcih0YWcpCmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi9tZXNvbi5idWlsZCBiL3Rh
cmdldC9oZXhhZ29uL21lc29uLmJ1aWxkCmluZGV4IGM5ZDMxZDA5NWMuLjQ4YzlmNTNjZmEgMTAw
NjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29uL21lc29uLmJ1aWxkCisrKyBiL3RhcmdldC9oZXhhZ29u
L21lc29uLmJ1aWxkCkBAIC0xLDUgKzEsNSBAQAogIyMKLSMjICBDb3B5cmlnaHQoYykgMjAyMC0y
MDIxIFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQu
CisjIyAgQ29weXJpZ2h0KGMpIDIwMjAtMjAyMyBRdWFsY29tbSBJbm5vdmF0aW9uIENlbnRlciwg
SW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogIyMKICMjICBUaGlzIHByb2dyYW0gaXMgZnJlZSBz
b2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQogIyMgIGl0IHVu
ZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlz
aGVkIGJ5CkBAIC0yNzYsNCArMjc2LDEzIEBAIHRjZ19mdW5jc19nZW5lcmF0ZWQgPSBjdXN0b21f
dGFyZ2V0KAogKQogaGV4YWdvbl9zcy5hZGQodGNnX2Z1bmNzX2dlbmVyYXRlZCkKIAorYW5hbHl6
ZV9mdW5jc19nZW5lcmF0ZWQgPSBjdXN0b21fdGFyZ2V0KAorICAgICdhbmFseXplX2Z1bmNzX2dl
bmVyYXRlZC5jLmluYycsCisgICAgb3V0cHV0OiAnYW5hbHl6ZV9mdW5jc19nZW5lcmF0ZWQuYy5p
bmMnLAorICAgIGRlcGVuZHM6IGhlbHBlcl9kZXAsCisgICAgZGVwZW5kX2ZpbGVzOiBbaGV4X2Nv
bW1vbl9weSwgYXR0cmlic19kZWYsIGdlbl90Y2dfaCwgZ2VuX3RjZ19odnhfaF0sCisgICAgY29t
bWFuZDogW3B5dGhvbiwgZmlsZXMoJ2dlbl9hbmFseXplX2Z1bmNzLnB5JyksIGhlbHBlcl9pbiwg
J0BPVVRQVVRAJ10sCispCitoZXhhZ29uX3NzLmFkZChhbmFseXplX2Z1bmNzX2dlbmVyYXRlZCkK
KwogdGFyZ2V0X2FyY2ggKz0geydoZXhhZ29uJzogaGV4YWdvbl9zc30KLS0gCjIuMjUuMQoK

