Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id CC3B63BC424
	for <lists+qemu-devel@lfdr.de>; Tue,  6 Jul 2021 01:38:54 +0200 (CEST)
Received: from localhost ([::1]:37578 helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>)
	id 1m0YAv-0003R7-Rk
	for lists+qemu-devel@lfdr.de; Mon, 05 Jul 2021 19:38:53 -0400
Received: from eggs.gnu.org ([2001:470:142:3::10]:35410)
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1m0Y6x-0003Ft-Sy
 for qemu-devel@nongnu.org; Mon, 05 Jul 2021 19:34:47 -0400
Received: from alexa-out-sd-02.qualcomm.com ([199.106.114.39]:53655)
 by eggs.gnu.org with esmtps (TLS1.2:RSA_AES_256_CBC_SHA1:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1m0Y6u-0004a7-QQ
 for qemu-devel@nongnu.org; Mon, 05 Jul 2021 19:34:47 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
 d=quicinc.com; i=@quicinc.com; q=dns/txt; s=qcdkim;
 t=1625528084; x=1657064084;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version:content-transfer-encoding;
 bh=eVRxswSTEcdSxnOB3XskHNM8hfcCOdAV8SdozU3/MsM=;
 b=tW0d4J2tGvnbjNvcA6ozmC0t1oPFjpp2dy/Tku69cFze7VhTQv/eQGfx
 GaxnDd6uln1UrUPBns22xaDqLT2XgUEvQtMq+TTeBqNH9ZK8pKj50OwDV
 4mDdXZojr6tGPDwur42qdKWzxeAn3FDXZtiw+78NcHXBubLr2IQ6LgU4Q 0=;
Received: from unknown (HELO ironmsg-SD-alpha.qualcomm.com) ([10.53.140.30])
 by alexa-out-sd-02.qualcomm.com with ESMTP; 05 Jul 2021 16:34:39 -0700
X-QCInternal: smtphost
Received: from vu-tsimpson-aus.qualcomm.com (HELO
 vu-tsimpson1-aus.qualcomm.com) ([10.222.150.1])
 by ironmsg-SD-alpha.qualcomm.com with ESMTP; 05 Jul 2021 16:34:38 -0700
Received: by vu-tsimpson1-aus.qualcomm.com (Postfix, from userid 47164)
 id E773C118F; Mon,  5 Jul 2021 18:34:37 -0500 (CDT)
From: Taylor Simpson <tsimpson@quicinc.com>
To: qemu-devel@nongnu.org
Subject: [PATCH 09/20] Hexagon HVX (target/hexagon) semantics generator - part
 2
Date: Mon,  5 Jul 2021 18:34:23 -0500
Message-Id: <1625528074-19440-10-git-send-email-tsimpson@quicinc.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1625528074-19440-1-git-send-email-tsimpson@quicinc.com>
References: <1625528074-19440-1-git-send-email-tsimpson@quicinc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Received-SPF: pass client-ip=199.106.114.39;
 envelope-from=tsimpson@qualcomm.com; helo=alexa-out-sd-02.qualcomm.com
X-Spam_score_int: -40
X-Spam_score: -4.1
X-Spam_bar: ----
X-Spam_report: (-4.1 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, HEADER_FROM_DIFFERENT_DOMAINS=0.249,
 RCVD_IN_DNSWL_MED=-2.3, SPF_HELO_NONE=0.001,
 SPF_PASS=-0.001 autolearn=ham autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Cc: ale@rev.ng, peter.maydell@linaro.org, bcain@quicinc.com,
 richard.henderson@linaro.org, tsimpson@quicinc.com, philmd@redhat.com
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: "Qemu-devel" <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>

U2lnbmVkLW9mZi1ieTogVGF5bG9yIFNpbXBzb24gPHRzaW1wc29uQHF1aWNpbmMuY29tPgotLS0K
IHRhcmdldC9oZXhhZ29uL2dlbl9oZWxwZXJfZnVuY3MucHkgIHwgMTExICsrKysrKysrKysrKysr
LS0KIHRhcmdldC9oZXhhZ29uL2dlbl9oZWxwZXJfcHJvdG9zLnB5IHwgIDE2ICsrLQogdGFyZ2V0
L2hleGFnb24vZ2VuX3RjZ19mdW5jcy5weSAgICAgfCAyNTQgKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKy0tCiAzIGZpbGVzIGNoYW5nZWQsIDM1OSBpbnNlcnRpb25zKCspLCAyMiBk
ZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi9nZW5faGVscGVyX2Z1bmNz
LnB5IGIvdGFyZ2V0L2hleGFnb24vZ2VuX2hlbHBlcl9mdW5jcy5weQppbmRleCAyYjFjNWQ4Li5j
MTUyMDAyIDEwMDc1NQotLS0gYS90YXJnZXQvaGV4YWdvbi9nZW5faGVscGVyX2Z1bmNzLnB5Cisr
KyBiL3RhcmdldC9oZXhhZ29uL2dlbl9oZWxwZXJfZnVuY3MucHkKQEAgLTQ4LDEyICs0OCwyNiBA
QCBkZWYgZ2VuX2hlbHBlcl9hcmdfcGFpcihmLHJlZ3R5cGUscmVnaWQscmVnbm8pOgogICAgIGlm
IHJlZ25vID49IDAgOiBmLndyaXRlKCIsICIpCiAgICAgZi53cml0ZSgiaW50NjRfdCAlcyVzViIg
JSAocmVndHlwZSxyZWdpZCkpCiAKK2RlZiBnZW5faGVscGVyX2FyZ19leHQoZixyZWd0eXBlLHJl
Z2lkLHJlZ25vKToKKyAgICBpZiByZWdubyA+IDAgOiBmLndyaXRlKCIsICIpCisgICAgZi53cml0
ZSgidm9pZCAqJXMlc1Zfdm9pZCIgJSAocmVndHlwZSxyZWdpZCkpCisKK2RlZiBnZW5faGVscGVy
X2FyZ19leHRfcGFpcihmLHJlZ3R5cGUscmVnaWQscmVnbm8pOgorICAgIGlmIHJlZ25vID4gMCA6
IGYud3JpdGUoIiwgIikKKyAgICBmLndyaXRlKCJ2b2lkIColcyVzVl92b2lkIiAlIChyZWd0eXBl
LHJlZ2lkKSkKKwogZGVmIGdlbl9oZWxwZXJfYXJnX29wbihmLHJlZ3R5cGUscmVnaWQsaSx0YWcp
OgogICAgIGlmIChoZXhfY29tbW9uLmlzX3BhaXIocmVnaWQpKToKLSAgICAgICAgZ2VuX2hlbHBl
cl9hcmdfcGFpcihmLHJlZ3R5cGUscmVnaWQsaSkKKyAgICAgICAgaWYgKGhleF9jb21tb24uaXNf
aHZ4X3JlZyhyZWd0eXBlKSk6CisgICAgICAgICAgICBnZW5faGVscGVyX2FyZ19leHRfcGFpcihm
LHJlZ3R5cGUscmVnaWQsaSkKKyAgICAgICAgZWxzZToKKyAgICAgICAgICAgIGdlbl9oZWxwZXJf
YXJnX3BhaXIoZixyZWd0eXBlLHJlZ2lkLGkpCiAgICAgZWxpZiAoaGV4X2NvbW1vbi5pc19zaW5n
bGUocmVnaWQpKToKICAgICAgICAgaWYgaGV4X2NvbW1vbi5pc19vbGRfdmFsKHJlZ3R5cGUsIHJl
Z2lkLCB0YWcpOgotICAgICAgICAgICAgZ2VuX2hlbHBlcl9hcmcoZixyZWd0eXBlLHJlZ2lkLGkp
CisgICAgICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc19odnhfcmVnKHJlZ3R5cGUpKToKKyAgICAg
ICAgICAgICAgICBnZW5faGVscGVyX2FyZ19leHQoZixyZWd0eXBlLHJlZ2lkLGkpCisgICAgICAg
ICAgICBlbHNlOgorICAgICAgICAgICAgICAgIGdlbl9oZWxwZXJfYXJnKGYscmVndHlwZSxyZWdp
ZCxpKQogICAgICAgICBlbGlmIGhleF9jb21tb24uaXNfbmV3X3ZhbChyZWd0eXBlLCByZWdpZCwg
dGFnKToKICAgICAgICAgICAgIGdlbl9oZWxwZXJfYXJnX25ldyhmLHJlZ3R5cGUscmVnaWQsaSkK
ICAgICAgICAgZWxzZToKQEAgLTcyLDI1ICs4Niw2NyBAQCBkZWYgZ2VuX2hlbHBlcl9kZXN0X2Rl
Y2xfcGFpcihmLHJlZ3R5cGUscmVnaWQscmVnbm8sc3ViZmllbGQ9IiIpOgogICAgIGYud3JpdGUo
IiAgICBpbnQ2NF90ICVzJXNWJXMgPSAwO1xuIiAlIFwKICAgICAgICAgKHJlZ3R5cGUscmVnaWQs
c3ViZmllbGQpKQogCitkZWYgZ2VuX2hlbHBlcl9kZXN0X2RlY2xfZXh0KGYscmVndHlwZSxyZWdp
ZCk6CisgICAgaWYgKHJlZ3R5cGUgPT0gIlEiKToKKyAgICAgICAgZi53cml0ZSgiICAgIC8qICVz
JXNWIGlzICooTU1RUmVnICopKCVzJXNWX3ZvaWQpICovXG4iICUgXAorICAgICAgICAgICAgKHJl
Z3R5cGUscmVnaWQscmVndHlwZSxyZWdpZCkpCisgICAgZWxzZToKKyAgICAgICAgZi53cml0ZSgi
ICAgIC8qICVzJXNWIGlzICooTU1WZWN0b3IgKikoJXMlc1Zfdm9pZCkgKi9cbiIgJSBcCisgICAg
ICAgICAgICAocmVndHlwZSxyZWdpZCxyZWd0eXBlLHJlZ2lkKSkKKworZGVmIGdlbl9oZWxwZXJf
ZGVzdF9kZWNsX2V4dF9wYWlyKGYscmVndHlwZSxyZWdpZCxyZWdubyk6CisgICAgZi53cml0ZSgi
ICAgIC8qICVzJXNWIGlzICooTU1WZWN0b3JQYWlyICopKSVzJXNWX3ZvaWQpICovXG4iICUgXAor
ICAgICAgICAocmVndHlwZSxyZWdpZCxyZWd0eXBlLCByZWdpZCkpCisKIGRlZiBnZW5faGVscGVy
X2Rlc3RfZGVjbF9vcG4oZixyZWd0eXBlLHJlZ2lkLGkpOgogICAgIGlmIChoZXhfY29tbW9uLmlz
X3BhaXIocmVnaWQpKToKLSAgICAgICAgZ2VuX2hlbHBlcl9kZXN0X2RlY2xfcGFpcihmLHJlZ3R5
cGUscmVnaWQsaSkKKyAgICAgICAgaWYgKGhleF9jb21tb24uaXNfaHZ4X3JlZyhyZWd0eXBlKSk6
CisgICAgICAgICAgICBnZW5faGVscGVyX2Rlc3RfZGVjbF9leHRfcGFpcihmLHJlZ3R5cGUscmVn
aWQsIGkpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBnZW5faGVscGVyX2Rlc3RfZGVjbF9w
YWlyKGYscmVndHlwZSxyZWdpZCxpKQogICAgIGVsaWYgKGhleF9jb21tb24uaXNfc2luZ2xlKHJl
Z2lkKSk6Ci0gICAgICAgIGdlbl9oZWxwZXJfZGVzdF9kZWNsKGYscmVndHlwZSxyZWdpZCxpKQor
ICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc19odnhfcmVnKHJlZ3R5cGUpKToKKyAgICAgICAgICAg
IGdlbl9oZWxwZXJfZGVzdF9kZWNsX2V4dChmLHJlZ3R5cGUscmVnaWQpCisgICAgICAgIGVsc2U6
CisgICAgICAgICAgICBnZW5faGVscGVyX2Rlc3RfZGVjbChmLHJlZ3R5cGUscmVnaWQsaSkKICAg
ICBlbHNlOgogICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLHJlZ3R5cGUscmVn
aWQsdG9zcyxudW1yZWdzKQogCitkZWYgZ2VuX2hlbHBlcl9zcmNfdmFyX2V4dChmLHJlZ3R5cGUs
cmVnaWQpOgorICAgIGlmIChyZWd0eXBlID09ICJRIik6CisgICAgICAgZi53cml0ZSgiICAgIC8q
ICVzJXNWIGlzICooTU1RUmVnICopKCVzJXNWX3ZvaWQpICovXG4iICUgXAorICAgICAgICAgICAo
cmVndHlwZSxyZWdpZCxyZWd0eXBlLHJlZ2lkKSkKKyAgICBlbHNlOgorICAgICAgIGYud3JpdGUo
IiAgICAvKiAlcyVzViBpcyAqKE1NVmVjdG9yICopKCVzJXNWX3ZvaWQpICovXG4iICUgXAorICAg
ICAgICAgICAocmVndHlwZSxyZWdpZCxyZWd0eXBlLHJlZ2lkKSkKKworZGVmIGdlbl9oZWxwZXJf
c3JjX3Zhcl9leHRfcGFpcihmLHJlZ3R5cGUscmVnaWQscmVnbm8pOgorICAgIGYud3JpdGUoIiAg
ICAvKiAlcyVzViVzIGlzICooTU1WZWN0b3JQYWlyICopKCVzJXNWJXNfdm9pZCkgKi9cbiIgJSBc
CisgICAgICAgIChyZWd0eXBlLHJlZ2lkLHJlZ25vLHJlZ3R5cGUscmVnaWQscmVnbm8pKQorCiBk
ZWYgZ2VuX2hlbHBlcl9yZXR1cm4oZixyZWd0eXBlLHJlZ2lkLHJlZ25vKToKICAgICBmLndyaXRl
KCIgICAgcmV0dXJuICVzJXNWO1xuIiAlIChyZWd0eXBlLHJlZ2lkKSkKIAogZGVmIGdlbl9oZWxw
ZXJfcmV0dXJuX3BhaXIoZixyZWd0eXBlLHJlZ2lkLHJlZ25vKToKICAgICBmLndyaXRlKCIgICAg
cmV0dXJuICVzJXNWO1xuIiAlIChyZWd0eXBlLHJlZ2lkKSkKIAorZGVmIGdlbl9oZWxwZXJfZHN0
X3dyaXRlX2V4dChmLHJlZ3R5cGUscmVnaWQpOgorICAgIHJldHVybgorCitkZWYgZ2VuX2hlbHBl
cl9kc3Rfd3JpdGVfZXh0X3BhaXIoZixyZWd0eXBlLHJlZ2lkKToKKyAgICByZXR1cm4KKwogZGVm
IGdlbl9oZWxwZXJfcmV0dXJuX29wbihmLCByZWd0eXBlLCByZWdpZCwgaSk6CiAgICAgaWYgKGhl
eF9jb21tb24uaXNfcGFpcihyZWdpZCkpOgotICAgICAgICBnZW5faGVscGVyX3JldHVybl9wYWly
KGYscmVndHlwZSxyZWdpZCxpKQorICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc19odnhfcmVnKHJl
Z3R5cGUpKToKKyAgICAgICAgICAgIGdlbl9oZWxwZXJfZHN0X3dyaXRlX2V4dF9wYWlyKGYscmVn
dHlwZSxyZWdpZCkKKyAgICAgICAgZWxzZToKKyAgICAgICAgICAgIGdlbl9oZWxwZXJfcmV0dXJu
X3BhaXIoZixyZWd0eXBlLHJlZ2lkLGkpCiAgICAgZWxpZiAoaGV4X2NvbW1vbi5pc19zaW5nbGUo
cmVnaWQpKToKLSAgICAgICAgZ2VuX2hlbHBlcl9yZXR1cm4oZixyZWd0eXBlLHJlZ2lkLGkpCisg
ICAgICAgIGlmIChoZXhfY29tbW9uLmlzX2h2eF9yZWcocmVndHlwZSkpOgorICAgICAgICAgICAg
Z2VuX2hlbHBlcl9kc3Rfd3JpdGVfZXh0KGYscmVndHlwZSxyZWdpZCkKKyAgICAgICAgZWxzZToK
KyAgICAgICAgICAgIGdlbl9oZWxwZXJfcmV0dXJuKGYscmVndHlwZSxyZWdpZCxpKQogICAgIGVs
c2U6CiAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIscmVndHlwZSxyZWdpZCx0
b3NzLG51bXJlZ3MpCiAKQEAgLTEyOSwxNCArMTg1LDIwIEBAIGRlZiBnZW5faGVscGVyX2Z1bmN0
aW9uKGYsIHRhZywgdGFncmVncywgdGFnaW1tcyk6CiAgICAgICAgICAgICAgICAgJSAodGFnLCB0
YWcpKQogICAgIGVsc2U6CiAgICAgICAgICMjIFRoZSByZXR1cm4gdHlwZSBvZiB0aGUgZnVuY3Rp
b24gaXMgdGhlIHR5cGUgb2YgdGhlIGRlc3RpbmF0aW9uCi0gICAgICAgICMjIHJlZ2lzdGVyCisg
ICAgICAgICMjIHJlZ2lzdGVyIChpZiBzY2FsYXIpCiAgICAgICAgIGk9MAogICAgICAgICBmb3Ig
cmVndHlwZSxyZWdpZCx0b3NzLG51bXJlZ3MgaW4gcmVnczoKICAgICAgICAgICAgIGlmIChoZXhf
Y29tbW9uLmlzX3dyaXR0ZW4ocmVnaWQpKToKICAgICAgICAgICAgICAgICBpZiAoaGV4X2NvbW1v
bi5pc19wYWlyKHJlZ2lkKSk6Ci0gICAgICAgICAgICAgICAgICAgIGdlbl9oZWxwZXJfcmV0dXJu
X3R5cGVfcGFpcihmLHJlZ3R5cGUscmVnaWQsaSkKKyAgICAgICAgICAgICAgICAgICAgaWYgKGhl
eF9jb21tb24uaXNfaHZ4X3JlZyhyZWd0eXBlKSk6CisgICAgICAgICAgICAgICAgICAgICAgICBj
b250aW51ZQorICAgICAgICAgICAgICAgICAgICBlbHNlOgorICAgICAgICAgICAgICAgICAgICAg
ICAgZ2VuX2hlbHBlcl9yZXR1cm5fdHlwZV9wYWlyKGYscmVndHlwZSxyZWdpZCxpKQogICAgICAg
ICAgICAgICAgIGVsaWYgKGhleF9jb21tb24uaXNfc2luZ2xlKHJlZ2lkKSk6Ci0gICAgICAgICAg
ICAgICAgICAgIGdlbl9oZWxwZXJfcmV0dXJuX3R5cGUoZixyZWd0eXBlLHJlZ2lkLGkpCisgICAg
ICAgICAgICAgICAgICAgIGlmIChoZXhfY29tbW9uLmlzX2h2eF9yZWcocmVndHlwZSkpOgorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCisgICAgICAgICAgICAgICAgICAgIGVs
c2U6CisgICAgICAgICAgICAgICAgICAgICAgICBnZW5faGVscGVyX3JldHVybl90eXBlKGYscmVn
dHlwZSxyZWdpZCxpKQogICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAg
IHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIscmVndHlwZSxyZWdpZCx0b3NzLG51bXJlZ3Mp
CiAgICAgICAgICAgICBpICs9IDEKQEAgLTE0NSwxMSArMjA3LDMxIEBAIGRlZiBnZW5faGVscGVy
X2Z1bmN0aW9uKGYsIHRhZywgdGFncmVncywgdGFnaW1tcyk6CiAgICAgICAgICAgICBmLndyaXRl
KCJ2b2lkIikKICAgICAgICAgZi53cml0ZSgiIEhFTFBFUiglcykoQ1BVSGV4YWdvblN0YXRlICpl
bnYiICUgdGFnKQogCisgICAgICAgICMjIEFyZ3VtZW50cyBpbmNsdWRlIHRoZSB2ZWN0b3IgZGVz
dGluYXRpb24gb3BlcmFuZHMKICAgICAgICAgaSA9IDEKKyAgICAgICAgZm9yIHJlZ3R5cGUscmVn
aWQsdG9zcyxudW1yZWdzIGluIHJlZ3M6CisgICAgICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc193
cml0dGVuKHJlZ2lkKSk6CisgICAgICAgICAgICAgICAgaWYgKGhleF9jb21tb24uaXNfcGFpcihy
ZWdpZCkpOgorICAgICAgICAgICAgICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc19odnhfcmVnKHJl
Z3R5cGUpKToKKyAgICAgICAgICAgICAgICAgICAgICAgIGdlbl9oZWxwZXJfYXJnX2V4dF9wYWly
KGYscmVndHlwZSxyZWdpZCxpKQorICAgICAgICAgICAgICAgICAgICBlbHNlOgorICAgICAgICAg
ICAgICAgICAgICAgICAgY29udGludWUKKyAgICAgICAgICAgICAgICBlbGlmIChoZXhfY29tbW9u
LmlzX3NpbmdsZShyZWdpZCkpOgorICAgICAgICAgICAgICAgICAgICBpZiAoaGV4X2NvbW1vbi5p
c19odnhfcmVnKHJlZ3R5cGUpKToKKyAgICAgICAgICAgICAgICAgICAgICAgIGdlbl9oZWxwZXJf
YXJnX2V4dChmLHJlZ3R5cGUscmVnaWQsaSkKKyAgICAgICAgICAgICAgICAgICAgZWxzZToKKyAg
ICAgICAgICAgICAgICAgICAgICAgICMgVGhpcyBpcyB0aGUgcmV0dXJuIHZhbHVlIG9mIHRoZSBm
dW5jdGlvbgorICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUKKyAgICAgICAgICAgICAg
ICBlbHNlOgorICAgICAgICAgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAi
LHJlZ3R5cGUscmVnaWQsdG9zcyxudW1yZWdzKQorICAgICAgICAgICAgICAgIGkgKz0gMQogCiAg
ICAgICAgICMjIEFyZ3VtZW50cyB0byB0aGUgaGVscGVyIGZ1bmN0aW9uIGFyZSB0aGUgc291cmNl
IHJlZ3MgYW5kIGltbWVkaWF0ZXMKICAgICAgICAgZm9yIHJlZ3R5cGUscmVnaWQsdG9zcyxudW1y
ZWdzIGluIHJlZ3M6CiAgICAgICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc19yZWFkKHJlZ2lkKSk6
CisgICAgICAgICAgICAgICAgaWYgKGhleF9jb21tb24uaXNfaHZ4X3JlZyhyZWd0eXBlKSBhbmQK
KyAgICAgICAgICAgICAgICAgICAgaGV4X2NvbW1vbi5pc19yZWFkd3JpdGUocmVnaWQpKToKKyAg
ICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgICBnZW5faGVscGVyX2Fy
Z19vcG4oZixyZWd0eXBlLHJlZ2lkLGksdGFnKQogICAgICAgICAgICAgICAgIGkgKz0gMQogICAg
ICAgICBmb3IgaW1tbGV0dCxiaXRzLGltbXNoaWZ0IGluIGltbXM6CkBAIC0xNzMsNiArMjU1LDE3
IEBAIGRlZiBnZW5faGVscGVyX2Z1bmN0aW9uKGYsIHRhZywgdGFncmVncywgdGFnaW1tcyk6CiAg
ICAgICAgICAgICAgICAgZ2VuX2hlbHBlcl9kZXN0X2RlY2xfb3BuKGYscmVndHlwZSxyZWdpZCxp
KQogICAgICAgICAgICAgaSArPSAxCiAKKyAgICAgICAgZm9yIHJlZ3R5cGUscmVnaWQsdG9zcyxu
dW1yZWdzIGluIHJlZ3M6CisgICAgICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc19yZWFkKHJlZ2lk
KSk6CisgICAgICAgICAgICAgICAgaWYgKGhleF9jb21tb24uaXNfcGFpcihyZWdpZCkpOgorICAg
ICAgICAgICAgICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc19odnhfcmVnKHJlZ3R5cGUpKToKKyAg
ICAgICAgICAgICAgICAgICAgICAgIGdlbl9oZWxwZXJfc3JjX3Zhcl9leHRfcGFpcihmLHJlZ3R5
cGUscmVnaWQsaSkKKyAgICAgICAgICAgICAgICBlbGlmIChoZXhfY29tbW9uLmlzX3NpbmdsZShy
ZWdpZCkpOgorICAgICAgICAgICAgICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc19odnhfcmVnKHJl
Z3R5cGUpKToKKyAgICAgICAgICAgICAgICAgICAgICAgIGdlbl9oZWxwZXJfc3JjX3Zhcl9leHQo
ZixyZWd0eXBlLHJlZ2lkKQorICAgICAgICAgICAgICAgIGVsc2U6CisgICAgICAgICAgICAgICAg
ICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIscmVndHlwZSxyZWdpZCx0b3NzLG51bXJl
Z3MpCisKICAgICAgICAgaWYgJ0FfRlBPUCcgaW4gaGV4X2NvbW1vbi5hdHRyaWJkaWN0W3RhZ106
CiAgICAgICAgICAgICBmLndyaXRlKCcgICAgYXJjaF9mcG9wX3N0YXJ0KGVudik7XG4nKTsKIApk
aWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vZ2VuX2hlbHBlcl9wcm90b3MucHkgYi90YXJnZXQv
aGV4YWdvbi9nZW5faGVscGVyX3Byb3Rvcy5weQppbmRleCBlYTQxMDA3Li4yMjllZjhkIDEwMDc1
NQotLS0gYS90YXJnZXQvaGV4YWdvbi9nZW5faGVscGVyX3Byb3Rvcy5weQorKysgYi90YXJnZXQv
aGV4YWdvbi9nZW5faGVscGVyX3Byb3Rvcy5weQpAQCAtOTQsMTkgKzk0LDMzIEBAIGRlZiBnZW5f
aGVscGVyX3Byb3RvdHlwZShmLCB0YWcsIHRhZ3JlZ3MsIHRhZ2ltbXMpOgogICAgICAgICAgICAg
Zi53cml0ZSgnREVGX0hFTFBFUl8lcyglcycgJSAoZGVmX2hlbHBlcl9zaXplLCB0YWcpKQogCiAg
ICAgICAgICMjIEdlbmVyYXRlIHRoZSBxZW11IERFRl9IRUxQRVIgdHlwZSBmb3IgZWFjaCByZXN1
bHQKKyAgICAgICAgIyMgSXRlcmF0ZSBvdmVyIHRoaXMgbGlzdCB0d2ljZQorICAgICAgICAjIyAt
IEVtaXQgdGhlIHNjYWxhciByZXN1bHQKKyAgICAgICAgIyMgLSBFbWl0IHRoZSB2ZWN0b3IgcmVz
dWx0CiAgICAgICAgIGk9MAogICAgICAgICBmb3IgcmVndHlwZSxyZWdpZCx0b3NzLG51bXJlZ3Mg
aW4gcmVnczoKICAgICAgICAgICAgIGlmIChoZXhfY29tbW9uLmlzX3dyaXR0ZW4ocmVnaWQpKToK
LSAgICAgICAgICAgICAgICBnZW5fZGVmX2hlbHBlcl9vcG4oZiwgdGFnLCByZWd0eXBlLCByZWdp
ZCwgdG9zcywgbnVtcmVncywgaSkKKyAgICAgICAgICAgICAgICBpZiAobm90IGhleF9jb21tb24u
aXNfaHZ4X3JlZyhyZWd0eXBlKSk6CisgICAgICAgICAgICAgICAgICAgIGdlbl9kZWZfaGVscGVy
X29wbihmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCB0b3NzLCBudW1yZWdzLCBpKQogICAgICAgICAg
ICAgICAgIGkgKz0gMQogCiAgICAgICAgICMjIFB1dCB0aGUgZW52IGJldHdlZW4gdGhlIG91dHB1
dHMgYW5kIGlucHV0cwogICAgICAgICBmLndyaXRlKCcsIGVudicgKQogICAgICAgICBpICs9IDEK
IAorICAgICAgICAjIFNlY29uZCBwYXNzCisgICAgICAgIGZvciByZWd0eXBlLHJlZ2lkLHRvc3Ms
bnVtcmVncyBpbiByZWdzOgorICAgICAgICAgICAgaWYgKGhleF9jb21tb24uaXNfd3JpdHRlbihy
ZWdpZCkpOgorICAgICAgICAgICAgICAgIGlmIChoZXhfY29tbW9uLmlzX2h2eF9yZWcocmVndHlw
ZSkpOgorICAgICAgICAgICAgICAgICAgICBnZW5fZGVmX2hlbHBlcl9vcG4oZiwgdGFnLCByZWd0
eXBlLCByZWdpZCwgdG9zcywgbnVtcmVncywgaSkKKyAgICAgICAgICAgICAgICAgICAgaSArPSAx
CisKICAgICAgICAgIyMgR2VuZXJhdGUgdGhlIHFlbXUgdHlwZSBmb3IgZWFjaCBpbnB1dCBvcGVy
YW5kIChyZWdzIGFuZCBpbW1lZGlhdGVzKQogICAgICAgICBmb3IgcmVndHlwZSxyZWdpZCx0b3Nz
LG51bXJlZ3MgaW4gcmVnczoKICAgICAgICAgICAgIGlmIChoZXhfY29tbW9uLmlzX3JlYWQocmVn
aWQpKToKKyAgICAgICAgICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc19odnhfcmVnKHJlZ3R5cGUp
IGFuZAorICAgICAgICAgICAgICAgICAgICBoZXhfY29tbW9uLmlzX3JlYWR3cml0ZShyZWdpZCkp
OgorICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgIGdlbl9kZWZf
aGVscGVyX29wbihmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCB0b3NzLCBudW1yZWdzLCBpKQogICAg
ICAgICAgICAgICAgIGkgKz0gMQogICAgICAgICBmb3IgaW1tbGV0dCxiaXRzLGltbXNoaWZ0IGlu
IGltbXM6CmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi9nZW5fdGNnX2Z1bmNzLnB5IGIvdGFy
Z2V0L2hleGFnb24vZ2VuX3RjZ19mdW5jcy5weQppbmRleCA3Y2ViMjViLi5iY2YyOGJiIDEwMDc1
NQotLS0gYS90YXJnZXQvaGV4YWdvbi9nZW5fdGNnX2Z1bmNzLnB5CisrKyBiL3RhcmdldC9oZXhh
Z29uL2dlbl90Y2dfZnVuY3MucHkKQEAgLTExOSwxMCArMTE5LDg2IEBAIGRlZiBnZW5wdHJfZGVj
bChmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCByZWdubyk6CiAgICAgICAgICAgICAgICAgKHJlZ3R5
cGUsIHJlZ2lkLCByZWd0eXBlLCByZWdpZCkpCiAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICBw
cmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKyAgICBlbGlmIChy
ZWd0eXBlID09ICJWIik6CisgICAgICAgIGlmIChyZWdpZCBpbiB7ImRkIn0pOgorICAgICAgICAg
ICAgZi53cml0ZSgiICAgIGNvbnN0IGludCAlcyVzTiA9IGluc24tPnJlZ25vWyVkXTtcbiIgJVwK
KyAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQsIHJlZ25vKSkKKyAgICAgICAgICAgIGYu
d3JpdGUoIiAgICBjb25zdCBpbnRwdHJfdCAlcyVzVl9vZmYgPVxuIiAlXAorICAgICAgICAgICAg
ICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICAgICAgZi53cml0ZSgiICAgICAgICBvZmZz
ZXRvZihDUFVIZXhhZ29uU3RhdGUsICVzJXNWKTtcbiIgJSBcCisgICAgICAgICAgICAgICAgIChy
ZWd0eXBlLCByZWdpZCkpCisgICAgICAgICAgICBpZiAobm90IGhleF9jb21tb24uc2tpcF9xZW11
X2hlbHBlcih0YWcpKToKKyAgICAgICAgICAgICAgICBmLndyaXRlKCIgICAgVENHdl9wdHIgJXMl
c1YgPSB0Y2dfdGVtcF9sb2NhbF9uZXdfcHRyKCk7XG4iICUgXAorICAgICAgICAgICAgICAgICAg
ICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICAgICAgICAgIGYud3JpdGUoIiAgICB0Y2dfZ2Vu
X2FkZGlfcHRyKCVzJXNWLCBjcHVfZW52LCAlcyVzVl9vZmYpO1xuIiAlIFwKKyAgICAgICAgICAg
ICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWd0eXBlLCByZWdpZCkpCisgICAgICAgIGVsaWYg
KHJlZ2lkIGluIHsidXUiLCAidnYiLCAieHgifSk6CisgICAgICAgICAgICBmLndyaXRlKCIgICAg
Y29uc3QgaW50ICVzJXNOID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlXAorICAgICAgICAgICAgICAg
IChyZWd0eXBlLCByZWdpZCwgcmVnbm8pKQorICAgICAgICAgICAgZi53cml0ZSgiICAgIGNvbnN0
IGludHB0cl90ICVzJXNWX29mZiA9XG4iICUgXAorICAgICAgICAgICAgICAgICAocmVndHlwZSwg
cmVnaWQpKQorICAgICAgICAgICAgZi53cml0ZSgiICAgICAgICBvZmZzZXRvZihDUFVIZXhhZ29u
U3RhdGUsICVzJXNWKTtcbiIgJSBcCisgICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkp
CisgICAgICAgICAgICBpZiAobm90IGhleF9jb21tb24uc2tpcF9xZW11X2hlbHBlcih0YWcpKToK
KyAgICAgICAgICAgICAgICBmLndyaXRlKCIgICAgVENHdl9wdHIgJXMlc1YgPSB0Y2dfdGVtcF9s
b2NhbF9uZXdfcHRyKCk7XG4iICUgXAorICAgICAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVn
aWQpKQorICAgICAgICAgICAgICAgIGYud3JpdGUoIiAgICB0Y2dfZ2VuX2FkZGlfcHRyKCVzJXNW
LCBjcHVfZW52LCAlcyVzVl9vZmYpO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAgICAgKHJlZ3R5
cGUsIHJlZ2lkLCByZWd0eXBlLCByZWdpZCkpCisgICAgICAgIGVsaWYgKHJlZ2lkIGluIHsicyIs
ICJ1IiwgInYiLCAidyJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICBjb25zdCBpbnQgJXMl
c04gPSBpbnNuLT5yZWdub1slZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWd0eXBlLCBy
ZWdpZCwgcmVnbm8pKQorICAgICAgICAgICAgZi53cml0ZSgiICAgIGNvbnN0IGludHB0cl90ICVz
JXNWX29mZiA9XG4iICUgXAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlZ3R5cGUs
IHJlZ2lkKSkKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICAgICAgdnJlZ19zcmNfb2ZmKGN0eCwg
JXMlc04pO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChyZWd0eXBlLCBy
ZWdpZCkpCisgICAgICAgICAgICBpZiAobm90IGhleF9jb21tb24uc2tpcF9xZW11X2hlbHBlcih0
YWcpKToKKyAgICAgICAgICAgICAgICBmLndyaXRlKCIgICAgVENHdl9wdHIgJXMlc1YgPSB0Y2df
dGVtcF9sb2NhbF9uZXdfcHRyKCk7XG4iICUgXAorICAgICAgICAgICAgICAgICAgICAocmVndHlw
ZSwgcmVnaWQpKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7ImQiLCAieCIsICJ5In0pOgorICAg
ICAgICAgICAgZi53cml0ZSgiICAgIGNvbnN0IGludCAlcyVzTiA9IGluc24tPnJlZ25vWyVkXTtc
biIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWdubykpCisgICAgICAg
ICAgICBmLndyaXRlKCIgICAgY29uc3QgaW50cHRyX3QgJXMlc1Zfb2ZmID1cbiIgJSBcCisgICAg
ICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICAg
ICAgb2Zmc2V0b2YoQ1BVSGV4YWdvblN0YXRlLFxuIikKKyAgICAgICAgICAgIGYud3JpdGUoIiAg
ICAgICAgICAgICAgICAgZnV0dXJlX1ZSZWdzWyVzJXNOXSk7XG4iICUgXAorICAgICAgICAgICAg
ICAgIChyZWd0eXBlLCByZWdpZCkpCisgICAgICAgICAgICBpZiAobm90IGhleF9jb21tb24uc2tp
cF9xZW11X2hlbHBlcih0YWcpKToKKyAgICAgICAgICAgICAgICBmLndyaXRlKCIgICAgVENHdl9w
dHIgJXMlc1YgPSB0Y2dfdGVtcF9sb2NhbF9uZXdfcHRyKCk7XG4iICUgXAorICAgICAgICAgICAg
ICAgICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICAgICAgICAgIGYud3JpdGUoIiAgICB0
Y2dfZ2VuX2FkZGlfcHRyKCVzJXNWLCBjcHVfZW52LCAlcyVzVl9vZmYpO1xuIiAlIFwKKyAgICAg
ICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWd0eXBlLCByZWdpZCkpCisgICAgICAg
IGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBl
LCByZWdpZCkKKyAgICBlbGlmIChyZWd0eXBlID09ICJRIik6CisgICAgICAgIGlmIChyZWdpZCBp
biB7ImQiLCAiZSIsICJ4In0pOgorICAgICAgICAgICAgZi53cml0ZSgiICAgIGNvbnN0IGludCAl
cyVzTiA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ3R5cGUs
IHJlZ2lkLCByZWdubykpCisgICAgICAgICAgICBmLndyaXRlKCIgICAgY29uc3QgaW50cHRyX3Qg
JXMlc1Zfb2ZmID1cbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkKKyAg
ICAgICAgICAgIGYud3JpdGUoIiAgICAgICAgb2Zmc2V0b2YoQ1BVSGV4YWdvblN0YXRlLFxuIikK
KyAgICAgICAgICAgIGYud3JpdGUoIiAgICAgICAgICAgICAgICAgZnV0dXJlX1FSZWdzWyVzJXNO
XSk7XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkpCisgICAgICAgICAg
ICBpZiAobm90IGhleF9jb21tb24uc2tpcF9xZW11X2hlbHBlcih0YWcpKToKKyAgICAgICAgICAg
ICAgICBmLndyaXRlKCIgICAgVENHdl9wdHIgJXMlc1YgPSB0Y2dfdGVtcF9sb2NhbF9uZXdfcHRy
KCk7XG4iICUgXAorICAgICAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAg
ICAgICAgICAgIGYud3JpdGUoIiAgICB0Y2dfZ2VuX2FkZGlfcHRyKCVzJXNWLCBjcHVfZW52LCAl
cyVzVl9vZmYpO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCBy
ZWd0eXBlLCByZWdpZCkpCisgICAgICAgIGVsaWYgKHJlZ2lkIGluIHsicyIsICJ0IiwgInUiLCAi
diJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICBjb25zdCBpbnQgJXMlc04gPSBpbnNuLT5y
ZWdub1slZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCwgcmVnbm8p
KQorICAgICAgICAgICAgZi53cml0ZSgiICAgIGNvbnN0IGludHB0cl90ICVzJXNWX29mZiA9XG4i
ICVcCisgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgICAgIGYud3Jp
dGUoIiAgICAgICAgb2Zmc2V0b2YoQ1BVSGV4YWdvblN0YXRlLCBRUmVnc1slcyVzTl0pO1xuIiAl
IFwKKyAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICAgICAgaWYgKG5v
dCBoZXhfY29tbW9uLnNraXBfcWVtdV9oZWxwZXIodGFnKSk6CisgICAgICAgICAgICAgICAgZi53
cml0ZSgiICAgIFRDR3ZfcHRyICVzJXNWID0gdGNnX3RlbXBfbG9jYWxfbmV3X3B0cigpO1xuIiAl
IFwKKyAgICAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgZWxzZToK
KyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lk
KQogICAgIGVsc2U6CiAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5
cGUsIHJlZ2lkKQogCi1kZWYgZ2VucHRyX2RlY2xfbmV3KGYscmVndHlwZSxyZWdpZCxyZWdubyk6
CitkZWYgZ2VucHRyX2RlY2xfbmV3KGYsIHRhZywgcmVndHlwZSwgcmVnaWQsIHJlZ25vKToKICAg
ICBpZiAocmVndHlwZSA9PSAiTiIpOgogICAgICAgICBpZiAocmVnaWQgaW4geyJzIiwgInQifSk6
CiAgICAgICAgICAgICBmLndyaXRlKCIgICAgVENHdiAlcyVzTiA9IGhleF9uZXdfdmFsdWVbaW5z
bi0+cmVnbm9bJWRdXTtcbiIgJSBcCkBAIC0xMzUsNiArMjExLDI1IEBAIGRlZiBnZW5wdHJfZGVj
bF9uZXcoZixyZWd0eXBlLHJlZ2lkLHJlZ25vKToKICAgICAgICAgICAgICAgICAocmVndHlwZSwg
cmVnaWQsIHJlZ25vKSkKICAgICAgICAgZWxzZToKICAgICAgICAgICAgIHByaW50KCJCYWQgcmVn
aXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIk8i
KToKKyAgICAgICAgaWYgKHJlZ2lkID09ICJzIik6CisgICAgICAgICAgICBmLndyaXRlKCIgICAg
Y29uc3QgaW50cHRyX3QgJXMlc05fbnVtID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwKKyAgICAg
ICAgICAgICAgICAocmVndHlwZSwgcmVnaWQsIHJlZ25vKSkKKyAgICAgICAgICAgIGlmIChoZXhf
Y29tbW9uLnNraXBfcWVtdV9oZWxwZXIodGFnKSk6CisgICAgICAgICAgICAgICAgZi53cml0ZSgi
ICAgIGNvbnN0IGludHB0cl90ICVzJXNOX29mZiA9XG4iICUgXAorICAgICAgICAgICAgICAgICAg
ICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICAgICAgICAgIGYud3JpdGUoIiAgICAgICAgdGVz
dF9iaXQoJXMlc05fbnVtLCBjdHgtPnZyZWdzX3VwZGF0ZWQpXG4iICUgXAorICAgICAgICAgICAg
ICAgICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICAgICAgICAgIGYud3JpdGUoIiAgICAg
ICAgICAgID8gb2Zmc2V0b2YoQ1BVSGV4YWdvblN0YXRlLCAiKQorICAgICAgICAgICAgICAgIGYu
d3JpdGUoImZ1dHVyZV9WUmVnc1slcyVzTl9udW1dKVxuIiAlIFwKKyAgICAgICAgICAgICAgICAg
ICAgKHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgICAgICAgICBmLndyaXRlKCIgICAgICAgICAg
ICA6IG9mZnNldG9mKENQVUhleGFnb25TdGF0ZSwgIikKKyAgICAgICAgICAgICAgICBmLndyaXRl
KCJ6ZXJvX3ZlY3Rvcik7XG4iKQorICAgICAgICAgICAgZWxzZToKKyAgICAgICAgICAgICAgICBm
LndyaXRlKCIgICAgVENHdiAlcyVzTiA9IHRjZ19jb25zdF90bCglcyVzTl9udW0pO1xuIiAlIFwK
KyAgICAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWd0eXBlLCByZWdpZCkpCisg
ICAgICAgIGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCBy
ZWd0eXBlLCByZWdpZCkKICAgICBlbHNlOgogICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBh
cnNlOiAiLCByZWd0eXBlLCByZWdpZCkKIApAQCAtMTQ1LDcgKzI0MCw3IEBAIGRlZiBnZW5wdHJf
ZGVjbF9vcG4oZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgdG9zcywgbnVtcmVncywgaSk6CiAgICAg
ICAgIGlmIGhleF9jb21tb24uaXNfb2xkX3ZhbChyZWd0eXBlLCByZWdpZCwgdGFnKToKICAgICAg
ICAgICAgIGdlbnB0cl9kZWNsKGYsdGFnLCByZWd0eXBlLCByZWdpZCwgaSkKICAgICAgICAgZWxp
ZiBoZXhfY29tbW9uLmlzX25ld192YWwocmVndHlwZSwgcmVnaWQsIHRhZyk6Ci0gICAgICAgICAg
ICBnZW5wdHJfZGVjbF9uZXcoZixyZWd0eXBlLHJlZ2lkLGkpCisgICAgICAgICAgICBnZW5wdHJf
ZGVjbF9uZXcoZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgaSkKICAgICAgICAgZWxzZToKICAgICAg
ICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIscmVndHlwZSxyZWdpZCx0b3NzLG51
bXJlZ3MpCiAgICAgZWxzZToKQEAgLTE1OSw3ICsyNTQsNyBAQCBkZWYgZ2VucHRyX2RlY2xfaW1t
KGYsaW1tbGV0dCk6CiAgICAgZi53cml0ZSgiICAgIGludCAlcyA9IGluc24tPmltbWVkWyVkXTtc
biIgJSBcCiAgICAgICAgIChoZXhfY29tbW9uLmltbV9uYW1lKGltbWxldHQpLCBpKSkKIAotZGVm
IGdlbnB0cl9mcmVlKGYscmVndHlwZSxyZWdpZCxyZWdubyk6CitkZWYgZ2VucHRyX2ZyZWUoZiwg
dGFnLCByZWd0eXBlLCByZWdpZCwgcmVnbm8pOgogICAgIGlmIChyZWd0eXBlID09ICJSIik6CiAg
ICAgICAgIGlmIChyZWdpZCBpbiB7ImRkIiwgInNzIiwgInR0IiwgInh4IiwgInl5In0pOgogICAg
ICAgICAgICAgZi53cml0ZSgiICAgIHRjZ190ZW1wX2ZyZWVfaTY0KCVzJXNWKTtcbiIgJSAocmVn
dHlwZSwgcmVnaWQpKQpAQCAtMTgyLDMzICsyNzcsNTUgQEAgZGVmIGdlbnB0cl9mcmVlKGYscmVn
dHlwZSxyZWdpZCxyZWdubyk6CiAgICAgZWxpZiAocmVndHlwZSA9PSAiTSIpOgogICAgICAgICBp
ZiAocmVnaWQgIT0gInUiKToKICAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6
ICIsIHJlZ3R5cGUsIHJlZ2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIlYiKToKKyAgICAgICAg
aWYgKHJlZ2lkIGluIHsiZGQiLCAidXUiLCAidnYiLCAieHgiLCBcCisgICAgICAgICAgICAgICAg
ICAgICAgImQiLCAicyIsICJ1IiwgInYiLCAidyIsICJ4IiwgInkifSk6CisgICAgICAgICAgICBp
ZiAobm90IGhleF9jb21tb24uc2tpcF9xZW11X2hlbHBlcih0YWcpKToKKyAgICAgICAgICAgICAg
ICBmLndyaXRlKCIgICAgdGNnX3RlbXBfZnJlZV9wdHIoJXMlc1YpO1xuIiAlIFwKKyAgICAgICAg
ICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgZWxzZToKKyAgICAgICAgICAg
IHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQorICAgIGVsaWYg
KHJlZ3R5cGUgPT0gIlEiKToKKyAgICAgICAgaWYgKHJlZ2lkIGluIHsiZCIsICJlIiwgInMiLCAi
dCIsICJ1IiwgInYiLCAieCJ9KToKKyAgICAgICAgICAgIGlmIChub3QgaGV4X2NvbW1vbi5za2lw
X3FlbXVfaGVscGVyKHRhZykpOgorICAgICAgICAgICAgICAgIGYud3JpdGUoIiAgICB0Y2dfdGVt
cF9mcmVlX3B0ciglcyVzVik7XG4iICUgXAorICAgICAgICAgICAgICAgICAgICAocmVndHlwZSwg
cmVnaWQpKQorICAgICAgICBlbHNlOgorICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBw
YXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCiAgICAgZWxzZToKICAgICAgICAgcHJpbnQoIkJhZCBy
ZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCiAKLWRlZiBnZW5wdHJfZnJlZV9uZXco
ZixyZWd0eXBlLHJlZ2lkLHJlZ25vKToKK2RlZiBnZW5wdHJfZnJlZV9uZXcoZiwgdGFnLCByZWd0
eXBlLCByZWdpZCwgcmVnbm8pOgogICAgIGlmIChyZWd0eXBlID09ICJOIik6CiAgICAgICAgIGlm
IChyZWdpZCBub3QgaW4geyJzIiwgInQifSk6CiAgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lz
dGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKICAgICBlbGlmIChyZWd0eXBlID09ICJQIik6
CiAgICAgICAgIGlmIChyZWdpZCBub3QgaW4geyJ0IiwgInUiLCAidiJ9KToKICAgICAgICAgICAg
IHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQorICAgIGVsaWYg
KHJlZ3R5cGUgPT0gIk8iKToKKyAgICAgICAgaWYgKHJlZ2lkID09ICJzIik6CisgICAgICAgICAg
ICBpZiAobm90IGhleF9jb21tb24uc2tpcF9xZW11X2hlbHBlcih0YWcpKToKKyAgICAgICAgICAg
ICAgICBmLndyaXRlKCIgICAgdGNnX3RlbXBfZnJlZSglcyVzTik7XG4iICUgXAorICAgICAgICAg
ICAgICAgICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICBlbHNlOgorICAgICAgICAgICAg
cHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCiAgICAgZWxzZToK
ICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCiAK
IGRlZiBnZW5wdHJfZnJlZV9vcG4oZixyZWd0eXBlLHJlZ2lkLGksdGFnKToKICAgICBpZiAoaGV4
X2NvbW1vbi5pc19wYWlyKHJlZ2lkKSk6Ci0gICAgICAgIGdlbnB0cl9mcmVlKGYscmVndHlwZSxy
ZWdpZCxpKQorICAgICAgICBnZW5wdHJfZnJlZShmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCBpKQog
ICAgIGVsaWYgKGhleF9jb21tb24uaXNfc2luZ2xlKHJlZ2lkKSk6CiAgICAgICAgIGlmIGhleF9j
b21tb24uaXNfb2xkX3ZhbChyZWd0eXBlLCByZWdpZCwgdGFnKToKLSAgICAgICAgICAgIGdlbnB0
cl9mcmVlKGYscmVndHlwZSxyZWdpZCxpKQorICAgICAgICAgICAgZ2VucHRyX2ZyZWUoZiwgdGFn
LCByZWd0eXBlLCByZWdpZCwgaSkKICAgICAgICAgZWxpZiBoZXhfY29tbW9uLmlzX25ld192YWwo
cmVndHlwZSwgcmVnaWQsIHRhZyk6Ci0gICAgICAgICAgICBnZW5wdHJfZnJlZV9uZXcoZixyZWd0
eXBlLHJlZ2lkLGkpCisgICAgICAgICAgICBnZW5wdHJfZnJlZV9uZXcoZiwgdGFnLCByZWd0eXBl
LCByZWdpZCwgaSkKICAgICAgICAgZWxzZToKICAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0
ZXIgcGFyc2U6ICIscmVndHlwZSxyZWdpZCx0b3NzLG51bXJlZ3MpCiAgICAgZWxzZToKICAgICAg
ICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIixyZWd0eXBlLHJlZ2lkLHRvc3MsbnVtcmVn
cykKIAotZGVmIGdlbnB0cl9zcmNfcmVhZChmLHJlZ3R5cGUscmVnaWQpOgorZGVmIGdlbnB0cl9z
cmNfcmVhZChmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkKToKICAgICBpZiAocmVndHlwZSA9PSAiUiIp
OgogICAgICAgICBpZiAocmVnaWQgaW4geyJzcyIsICJ0dCIsICJ4eCIsICJ5eSJ9KToKICAgICAg
ICAgICAgIGYud3JpdGUoIiAgICB0Y2dfZ2VuX2NvbmNhdF9pMzJfaTY0KCVzJXNWLCBoZXhfZ3By
WyVzJXNOXSxcbiIgJSBcCkBAIC0yMzgsNiArMzU1LDQ3IEBAIGRlZiBnZW5wdHJfc3JjX3JlYWQo
ZixyZWd0eXBlLHJlZ2lkKToKICAgICBlbGlmIChyZWd0eXBlID09ICJNIik6CiAgICAgICAgIGlm
IChyZWdpZCAhPSAidSIpOgogICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTog
IiwgcmVndHlwZSwgcmVnaWQpCisgICAgZWxpZiAocmVndHlwZSA9PSAiViIpOgorICAgICAgICBp
ZiAocmVnaWQgaW4geyJ1dSIsICJ2diIsICJ4eCJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIiAg
ICB0Y2dfZ2VuX2d2ZWNfbW92KE1PXzY0LCAlcyVzVl9vZmYsXG4iICUgXAorICAgICAgICAgICAg
ICAgIChyZWd0eXBlLCByZWdpZCkpCisgICAgICAgICAgICBmLndyaXRlKCIgICAgICAgIHZyZWdf
c3JjX29mZihjdHgsICVzJXNOKSxcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJl
Z2lkKSkKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICAgICAgc2l6ZW9mKE1NVmVjdG9yKSwgc2l6
ZW9mKE1NVmVjdG9yKSk7XG4iKQorICAgICAgICAgICAgZi53cml0ZSgiICAgIHRjZ19nZW5fZ3Zl
Y19tb3YoTU9fNjQsXG4iKQorICAgICAgICAgICAgZi53cml0ZSgiICAgICAgICAlcyVzVl9vZmYg
KyBzaXplb2YoTU1WZWN0b3IpLFxuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVn
aWQpKQorICAgICAgICAgICAgZi53cml0ZSgiICAgICAgICB2cmVnX3NyY19vZmYoY3R4LCAlcyVz
TiBeIDEpLFxuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAg
ICAgICAgZi53cml0ZSgiICAgICAgICBzaXplb2YoTU1WZWN0b3IpLCBzaXplb2YoTU1WZWN0b3Ip
KTtcbiIpCisgICAgICAgIGVsaWYgKHJlZ2lkIGluIHsicyIsICJ1IiwgInYiLCAidyJ9KToKKyAg
ICAgICAgICAgIGlmIChub3QgaGV4X2NvbW1vbi5za2lwX3FlbXVfaGVscGVyKHRhZykpOgorICAg
ICAgICAgICAgICAgIGYud3JpdGUoIiAgICB0Y2dfZ2VuX2FkZGlfcHRyKCVzJXNWLCBjcHVfZW52
LCAlcyVzVl9vZmYpO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChy
ZWd0eXBlLCByZWdpZCwgcmVndHlwZSwgcmVnaWQpKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7
IngiLCAieSJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICB0Y2dfZ2VuX2d2ZWNfbW92KE1P
XzY0LCAlcyVzVl9vZmYsXG4iICUgXAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAocmVn
dHlwZSwgcmVnaWQpKQorICAgICAgICAgICAgZi53cml0ZSgiICAgICAgICB2cmVnX3NyY19vZmYo
Y3R4LCAlcyVzTiksXG4iICUgXAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAocmVndHlw
ZSwgcmVnaWQpKQorICAgICAgICAgICAgZi53cml0ZSgiICAgICAgICBzaXplb2YoTU1WZWN0b3Ip
LCBzaXplb2YoTU1WZWN0b3IpKTtcbiIpCisgICAgICAgICAgICBpZiAobm90IGhleF9jb21tb24u
c2tpcF9xZW11X2hlbHBlcih0YWcpKToKKyAgICAgICAgICAgICAgICBmLndyaXRlKCIgICAgdGNn
X2dlbl9hZGRpX3B0ciglcyVzViwgY3B1X2VudiwgJXMlc1Zfb2ZmKTtcbiIgJSBcCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQsIHJlZ3R5cGUsIHJlZ2lk
KSkKKyAgICAgICAgZWxzZToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6
ICIsIHJlZ3R5cGUsIHJlZ2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIlEiKToKKyAgICAgICAg
aWYgKHJlZ2lkIGluIHsicyIsICJ0IiwgInUiLCAidiJ9KToKKyAgICAgICAgICAgIGlmIChub3Qg
aGV4X2NvbW1vbi5za2lwX3FlbXVfaGVscGVyKHRhZykpOgorICAgICAgICAgICAgICAgIGYud3Jp
dGUoIiAgICB0Y2dfZ2VuX2FkZGlfcHRyKCVzJXNWLCBjcHVfZW52LCAlcyVzVl9vZmYpO1xuIiAl
IFwKKyAgICAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWd0eXBlLCByZWdpZCkp
CisgICAgICAgIGVsaWYgKHJlZ2lkIGluIHsieCJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIiAg
ICB0Y2dfZ2VuX2d2ZWNfbW92KE1PXzY0LCAlcyVzVl9vZmYsXG4iICUgXAorICAgICAgICAgICAg
ICAgIChyZWd0eXBlLCByZWdpZCkpCisgICAgICAgICAgICBmLndyaXRlKCIgICAgICAgIG9mZnNl
dG9mKENQVUhleGFnb25TdGF0ZSwgUVJlZ3NbJXMlc05dKSxcbiIgJSBcCisgICAgICAgICAgICAg
ICAgKHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICAgICAgc2l6ZW9m
KE1NUVJlZyksIHNpemVvZihNTVFSZWcpKTtcbiIpCisgICAgICAgIGVsc2U6CisgICAgICAgICAg
ICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKICAgICBlbHNl
OgogICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkK
IApAQCAtMjQ4LDE1ICs0MDYsMTggQEAgZGVmIGdlbnB0cl9zcmNfcmVhZF9uZXcoZixyZWd0eXBl
LHJlZ2lkKToKICAgICBlbGlmIChyZWd0eXBlID09ICJQIik6CiAgICAgICAgIGlmIChyZWdpZCBu
b3QgaW4geyJ0IiwgInUiLCAidiJ9KToKICAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIg
cGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIk8iKToKKyAg
ICAgICAgaWYgKHJlZ2lkICE9ICJzIik6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVy
IHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKICAgICBlbHNlOgogICAgICAgICBwcmludCgiQmFk
IHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKIAogZGVmIGdlbnB0cl9zcmNfcmVh
ZF9vcG4oZixyZWd0eXBlLHJlZ2lkLHRhZyk6CiAgICAgaWYgKGhleF9jb21tb24uaXNfcGFpcihy
ZWdpZCkpOgotICAgICAgICBnZW5wdHJfc3JjX3JlYWQoZixyZWd0eXBlLHJlZ2lkKQorICAgICAg
ICBnZW5wdHJfc3JjX3JlYWQoZiwgdGFnLCByZWd0eXBlLCByZWdpZCkKICAgICBlbGlmIChoZXhf
Y29tbW9uLmlzX3NpbmdsZShyZWdpZCkpOgogICAgICAgICBpZiBoZXhfY29tbW9uLmlzX29sZF92
YWwocmVndHlwZSwgcmVnaWQsIHRhZyk6Ci0gICAgICAgICAgICBnZW5wdHJfc3JjX3JlYWQoZixy
ZWd0eXBlLHJlZ2lkKQorICAgICAgICAgICAgZ2VucHRyX3NyY19yZWFkKGYsIHRhZywgcmVndHlw
ZSwgcmVnaWQpCiAgICAgICAgIGVsaWYgaGV4X2NvbW1vbi5pc19uZXdfdmFsKHJlZ3R5cGUsIHJl
Z2lkLCB0YWcpOgogICAgICAgICAgICAgZ2VucHRyX3NyY19yZWFkX25ldyhmLHJlZ3R5cGUscmVn
aWQpCiAgICAgICAgIGVsc2U6CkBAIC0zMzQsMTEgKzQ5NSw2OSBAQCBkZWYgZ2VucHRyX2RzdF93
cml0ZShmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkKToKICAgICBlbHNlOgogICAgICAgICBwcmludCgi
QmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKIAorZGVmIGdlbnB0cl9kc3Rf
d3JpdGVfZXh0KGYsIHRhZywgcmVndHlwZSwgcmVnaWQsIG5ld3Y9IjAiKToKKyAgICBpZiAocmVn
dHlwZSA9PSAiViIpOgorICAgICAgICBpZiAocmVnaWQgaW4geyJkZCIsICJ4eCIsICJ5eSJ9KToK
KyAgICAgICAgICAgIGlmICgnQV9DT05ERVhFQycgaW4gaGV4X2NvbW1vbi5hdHRyaWJkaWN0W3Rh
Z10pOgorICAgICAgICAgICAgICAgIGlzX3ByZWRpY2F0ZWQgPSAidHJ1ZSIKKyAgICAgICAgICAg
IGVsc2U6CisgICAgICAgICAgICAgICAgaXNfcHJlZGljYXRlZCA9ICJmYWxzZSIKKyAgICAgICAg
ICAgIGYud3JpdGUoIiAgICBnZW5fbG9nX3ZyZWdfd3JpdGVfcGFpciglcyVzVl9vZmYsICVzJXNO
LCAlcywgIiAlIFwKKyAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQsIHJlZ3R5cGUsIHJl
Z2lkLCBuZXd2KSkKKyAgICAgICAgICAgIGYud3JpdGUoImluc24tPnNsb3QsICVzLCBwa3QtPnBr
dF9oYXNfdmhpc3QpO1xuIiAlIChpc19wcmVkaWNhdGVkKSkKKyAgICAgICAgICAgIGYud3JpdGUo
IiAgICBjdHhfbG9nX3ZyZWdfd3JpdGVfcGFpcihjdHgsICVzJXNOLCAlcyxcbiIgJSBcCisgICAg
ICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCBuZXd2KSkKKyAgICAgICAgICAgIGYud3JpdGUo
IiAgICAgICAgJXMpO1xuIiAlIChpc19wcmVkaWNhdGVkKSkKKyAgICAgICAgZWxpZiAocmVnaWQg
aW4geyJkIiwgIngiLCAieSJ9KToKKyAgICAgICAgICAgIGlmICgnQV9DT05ERVhFQycgaW4gaGV4
X2NvbW1vbi5hdHRyaWJkaWN0W3RhZ10pOgorICAgICAgICAgICAgICAgIGlzX3ByZWRpY2F0ZWQg
PSAidHJ1ZSIKKyAgICAgICAgICAgIGVsc2U6CisgICAgICAgICAgICAgICAgaXNfcHJlZGljYXRl
ZCA9ICJmYWxzZSIKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICBnZW5fbG9nX3ZyZWdfd3JpdGUo
JXMlc1Zfb2ZmLCAlcyVzTiwgJXMsICIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJl
Z2lkLCByZWd0eXBlLCByZWdpZCwgbmV3dikpCisgICAgICAgICAgICBmLndyaXRlKCJpbnNuLT5z
bG90LCAlcywgcGt0LT5wa3RfaGFzX3ZoaXN0KTtcbiIgJSAoaXNfcHJlZGljYXRlZCkpCisgICAg
ICAgICAgICBmLndyaXRlKCIgICAgY3R4X2xvZ192cmVnX3dyaXRlKGN0eCwgJXMlc04sICVzLCAl
cyk7XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCwgbmV3diwgaXNfcHJl
ZGljYXRlZCkpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVy
IHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKyAgICBlbGlmIChyZWd0eXBlID09ICJRIik6Cisg
ICAgICAgIGlmIChyZWdpZCBpbiB7ImQiLCAiZSIsICJ4In0pOgorICAgICAgICAgICAgaWYgKCdB
X0NPTkRFWEVDJyBpbiBoZXhfY29tbW9uLmF0dHJpYmRpY3RbdGFnXSk6CisgICAgICAgICAgICAg
ICAgaXNfcHJlZGljYXRlZCA9ICJ0cnVlIgorICAgICAgICAgICAgZWxzZToKKyAgICAgICAgICAg
ICAgICBpc19wcmVkaWNhdGVkID0gImZhbHNlIgorICAgICAgICAgICAgZi53cml0ZSgiICAgIGdl
bl9sb2dfcXJlZ193cml0ZSglcyVzVl9vZmYsICVzJXNOLCAlcywgIiAlIFwKKyAgICAgICAgICAg
ICAgICAocmVndHlwZSwgcmVnaWQsIHJlZ3R5cGUsIHJlZ2lkLCBuZXd2KSkKKyAgICAgICAgICAg
IGYud3JpdGUoImluc24tPnNsb3QsICVzKTtcbiIgJSAoaXNfcHJlZGljYXRlZCkpCisgICAgICAg
ICAgICBmLndyaXRlKCIgICAgY3R4X2xvZ19xcmVnX3dyaXRlKGN0eCwgJXMlc04sICVzKTtcbiIg
JSBcCisgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCBpc19wcmVkaWNhdGVkKSkKKyAg
ICAgICAgZWxzZToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJl
Z3R5cGUsIHJlZ2lkKQorICAgIGVsc2U6CisgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFy
c2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQorCiBkZWYgZ2VucHRyX2RzdF93cml0ZV9vcG4oZixyZWd0
eXBlLCByZWdpZCwgdGFnKToKICAgICBpZiAoaGV4X2NvbW1vbi5pc19wYWlyKHJlZ2lkKSk6Ci0g
ICAgICAgIGdlbnB0cl9kc3Rfd3JpdGUoZiwgdGFnLCByZWd0eXBlLCByZWdpZCkKKyAgICAgICAg
aWYgKGhleF9jb21tb24uaXNfaHZ4X3JlZyhyZWd0eXBlKSk6CisgICAgICAgICAgICBpZiAoJ0Ff
Q1ZJX1RNUCcgaW4gaGV4X2NvbW1vbi5hdHRyaWJkaWN0W3RhZ10gb3IKKyAgICAgICAgICAgICAg
ICAnQV9DVklfVE1QX0RTVCcgaW4gaGV4X2NvbW1vbi5hdHRyaWJkaWN0W3RhZ10pOgorICAgICAg
ICAgICAgICAgIGdlbnB0cl9kc3Rfd3JpdGVfZXh0KGYsIHRhZywgcmVndHlwZSwgcmVnaWQsICJF
WFRfVE1QIikKKyAgICAgICAgICAgIGVsc2U6CisgICAgICAgICAgICAgICAgZ2VucHRyX2RzdF93
cml0ZV9leHQoZiwgdGFnLCByZWd0eXBlLCByZWdpZCkKKyAgICAgICAgZWxzZToKKyAgICAgICAg
ICAgIGdlbnB0cl9kc3Rfd3JpdGUoZiwgdGFnLCByZWd0eXBlLCByZWdpZCkKICAgICBlbGlmICho
ZXhfY29tbW9uLmlzX3NpbmdsZShyZWdpZCkpOgotICAgICAgICBnZW5wdHJfZHN0X3dyaXRlKGYs
IHRhZywgcmVndHlwZSwgcmVnaWQpCisgICAgICAgIGlmIChoZXhfY29tbW9uLmlzX2h2eF9yZWco
cmVndHlwZSkpOgorICAgICAgICAgICAgaWYgJ0FfQ1ZJX05FVycgaW4gaGV4X2NvbW1vbi5hdHRy
aWJkaWN0W3RhZ106CisgICAgICAgICAgICAgICAgZ2VucHRyX2RzdF93cml0ZV9leHQoZiwgdGFn
LCByZWd0eXBlLCByZWdpZCwgIkVYVF9ORVciKQorICAgICAgICAgICAgZWxpZiAnQV9DVklfVE1Q
JyBpbiBoZXhfY29tbW9uLmF0dHJpYmRpY3RbdGFnXToKKyAgICAgICAgICAgICAgICBnZW5wdHJf
ZHN0X3dyaXRlX2V4dChmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCAiRVhUX1RNUCIpCisgICAgICAg
ICAgICBlbGlmICdBX0NWSV9UTVBfRFNUJyBpbiBoZXhfY29tbW9uLmF0dHJpYmRpY3RbdGFnXToK
KyAgICAgICAgICAgICAgICBnZW5wdHJfZHN0X3dyaXRlX2V4dChmLCB0YWcsIHJlZ3R5cGUsIHJl
Z2lkLCAiRVhUX1RNUCIpCisgICAgICAgICAgICBlbHNlOgorICAgICAgICAgICAgICAgIGdlbnB0
cl9kc3Rfd3JpdGVfZXh0KGYsIHRhZywgcmVndHlwZSwgcmVnaWQsICJFWFRfREZMIikKKyAgICAg
ICAgZWxzZToKKyAgICAgICAgICAgIGdlbnB0cl9kc3Rfd3JpdGUoZiwgdGFnLCByZWd0eXBlLCBy
ZWdpZCkKICAgICBlbHNlOgogICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLHJl
Z3R5cGUscmVnaWQsdG9zcyxudW1yZWdzKQogCkBAIC00MDksMTMgKzYyOCwyNCBAQCBkZWYgZ2Vu
X3RjZ19mdW5jKGYsIHRhZywgcmVncywgaW1tcyk6CiAgICAgICAgICMjIElmIHRoZXJlIGlzIGEg
c2NhbGFyIHJlc3VsdCwgaXQgaXMgdGhlIHJldHVybiB0eXBlCiAgICAgICAgIGZvciByZWd0eXBl
LHJlZ2lkLHRvc3MsbnVtcmVncyBpbiByZWdzOgogICAgICAgICAgICAgaWYgKGhleF9jb21tb24u
aXNfd3JpdHRlbihyZWdpZCkpOgorICAgICAgICAgICAgICAgIGlmIChoZXhfY29tbW9uLmlzX2h2
eF9yZWcocmVndHlwZSkpOgorICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAg
ICAgICAgIGdlbl9oZWxwZXJfY2FsbF9vcG4oZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgdG9zcywg
bnVtcmVncywgaSkKICAgICAgICAgICAgICAgICBpICs9IDEKICAgICAgICAgaWYgKGkgPiAwKTog
Zi53cml0ZSgiLCAiKQogICAgICAgICBmLndyaXRlKCJjcHVfZW52IikKICAgICAgICAgaT0xCiAg
ICAgICAgIGZvciByZWd0eXBlLHJlZ2lkLHRvc3MsbnVtcmVncyBpbiByZWdzOgorICAgICAgICAg
ICAgaWYgKGhleF9jb21tb24uaXNfd3JpdHRlbihyZWdpZCkpOgorICAgICAgICAgICAgICAgIGlm
IChub3QgaGV4X2NvbW1vbi5pc19odnhfcmVnKHJlZ3R5cGUpKToKKyAgICAgICAgICAgICAgICAg
ICAgY29udGludWUKKyAgICAgICAgICAgICAgICBnZW5faGVscGVyX2NhbGxfb3BuKGYsIHRhZywg
cmVndHlwZSwgcmVnaWQsIHRvc3MsIG51bXJlZ3MsIGkpCisgICAgICAgICAgICAgICAgaSArPSAx
CisgICAgICAgIGZvciByZWd0eXBlLHJlZ2lkLHRvc3MsbnVtcmVncyBpbiByZWdzOgogICAgICAg
ICAgICAgaWYgKGhleF9jb21tb24uaXNfcmVhZChyZWdpZCkpOgorICAgICAgICAgICAgICAgIGlm
IChoZXhfY29tbW9uLmlzX2h2eF9yZWcocmVndHlwZSkgYW5kCisgICAgICAgICAgICAgICAgICAg
IGhleF9jb21tb24uaXNfcmVhZHdyaXRlKHJlZ2lkKSk6CisgICAgICAgICAgICAgICAgICAgIGNv
bnRpbnVlCiAgICAgICAgICAgICAgICAgZ2VuX2hlbHBlcl9jYWxsX29wbihmLCB0YWcsIHJlZ3R5
cGUsIHJlZ2lkLCB0b3NzLCBudW1yZWdzLCBpKQogICAgICAgICAgICAgICAgIGkgKz0gMQogICAg
ICAgICBmb3IgaW1tbGV0dCxiaXRzLGltbXNoaWZ0IGluIGltbXM6Ci0tIAoyLjcuNAoK

