Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id 213166AD532
	for <lists+qemu-devel@lfdr.de>; Tue,  7 Mar 2023 04:00:27 +0100 (CET)
Received: from localhost ([::1] helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces@nongnu.org>)
	id 1pZNXT-0000YQ-Jx; Mon, 06 Mar 2023 21:58:55 -0500
Received: from eggs.gnu.org ([2001:470:142:3::10])
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1pZNXR-0000XO-Ao
 for qemu-devel@nongnu.org; Mon, 06 Mar 2023 21:58:53 -0500
Received: from mx0a-0031df01.pphosted.com ([205.220.168.131])
 by eggs.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1pZNXL-0005o1-Nd
 for qemu-devel@nongnu.org; Mon, 06 Mar 2023 21:58:50 -0500
Received: from pps.filterd (m0279865.ppops.net [127.0.0.1])
 by mx0a-0031df01.pphosted.com (8.17.1.19/8.17.1.19) with ESMTP id
 3270oKxj008517; Tue, 7 Mar 2023 02:58:34 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=quicinc.com;
 h=from : to : cc :
 subject : date : message-id : in-reply-to : references : mime-version :
 content-type : content-transfer-encoding; s=qcppdkim1;
 bh=9JAzlF4vG3f9wVAuDvi+EwU9xEbHu7L4gL9WUJNEsmc=;
 b=Ur8H43fu0JzREgd0kmAAS0hWJmTWkEuP9t/y6xhULuNJbAZWtOdtF9YMSdT70jNNoBbf
 wA21+poxtgXkATTKi9dtwXASoW/twKWnXWr9S62gw9fBOEVsBJPA5yGI18hLyyDDAMmF
 a1d1sBGyzPv23k06b6dAA00BcRhdjye1uQgBgr4i4QnaJZywMkbEbOBuWxryjpvjYWFy
 WkiNJ7e5xzLWVdHAq3vRpSznWpPXmfdCvVreKCxGVeaN6Iyj/+FtzMaCmBz3vUDBsbJ1
 9A7hIH+nDbjtFVS1W93uKkiActqfdSBFlfS/UNAqQppep4WUD3XfeZFrBhYpGpys20x6 aw== 
Received: from nalasppmta03.qualcomm.com (Global_NAT1.qualcomm.com
 [129.46.96.20])
 by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 3p419d6p7v-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Tue, 07 Mar 2023 02:58:34 +0000
Received: from pps.filterd (NALASPPMTA03.qualcomm.com [127.0.0.1])
 by NALASPPMTA03.qualcomm.com (8.17.1.5/8.17.1.5) with ESMTP id 3272wVRD023791; 
 Tue, 7 Mar 2023 02:58:33 GMT
Received: from pps.reinject (localhost [127.0.0.1])
 by NALASPPMTA03.qualcomm.com (PPS) with ESMTPS id 3p4fjsun8s-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Tue, 07 Mar 2023 02:58:33 +0000
Received: from NALASPPMTA03.qualcomm.com (NALASPPMTA03.qualcomm.com
 [127.0.0.1])
 by pps.reinject (8.17.1.5/8.17.1.5) with ESMTP id 3272tIM1020341;
 Tue, 7 Mar 2023 02:58:32 GMT
Received: from hu-devc-sd-u20-a-1.qualcomm.com (hu-tsimpson-lv.qualcomm.com
 [10.47.204.221])
 by NALASPPMTA03.qualcomm.com (PPS) with ESMTPS id 3272wVx8023790
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Tue, 07 Mar 2023 02:58:32 +0000
Received: by hu-devc-sd-u20-a-1.qualcomm.com (Postfix, from userid 47164)
 id E4490A84; Mon,  6 Mar 2023 18:58:30 -0800 (PST)
From: Taylor Simpson <tsimpson@quicinc.com>
To: qemu-devel@nongnu.org
Cc: tsimpson@quicinc.com, richard.henderson@linaro.org, philmd@linaro.org,
 ale@rev.ng, anjo@rev.ng, bcain@quicinc.com, quic_mathbern@quicinc.com
Subject: [PATCH v6 14/14] Hexagon (target/hexagon) Improve code gen for
 predicated HVX instructions
Date: Mon,  6 Mar 2023 18:58:28 -0800
Message-Id: <20230307025828.1612809-15-tsimpson@quicinc.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20230307025828.1612809-1-tsimpson@quicinc.com>
References: <20230307025828.1612809-1-tsimpson@quicinc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
X-QCInternal: smtphost
X-QCInternal: smtphost
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-ORIG-GUID: i2vRq5--qrIHFTlyDrecjfu1zoWqVLz7
X-Proofpoint-GUID: i2vRq5--qrIHFTlyDrecjfu1zoWqVLz7
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.219,Aquarius:18.0.942,Hydra:6.0.573,FMLib:17.11.170.22
 definitions=2023-03-06_14,2023-03-06_01,2023-02-09_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 mlxscore=0 lowpriorityscore=0
 phishscore=0 malwarescore=0 impostorscore=0 priorityscore=1501
 clxscore=1015 suspectscore=0 mlxlogscore=421 adultscore=0 bulkscore=0
 spamscore=0 classifier=spam adjust=0 reason=mlx scancount=1
 engine=8.12.0-2212070000 definitions=main-2303070025
Received-SPF: pass client-ip=205.220.168.131;
 envelope-from=tsimpson@qualcomm.com; helo=mx0a-0031df01.pphosted.com
X-Spam_score_int: -24
X-Spam_score: -2.5
X-Spam_bar: --
X-Spam_report: (-2.5 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, HEADER_FROM_DIFFERENT_DOMAINS=0.25,
 RCVD_IN_DNSWL_LOW=-0.7, SPF_HELO_NONE=0.001,
 SPF_PASS=-0.001 autolearn=ham autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org

VGhlIGZvbGxvd2luZyBpbXByb3ZlbWVudHMgYXJlIG1hZGUgZm9yIHByZWRpY2F0ZWQgSFZYIGlu
c3RydWN0aW9ucwogICAgRHVyaW5nIGdlbl9jb21taXRfaHZ4LCB1bmNvbmRpdGlvbmFsbHkgbW92
ZSB0aGUgIm5ldyIgdmFsdWUgaW50bwogICAgICAgIHRoZSBkZXN0CiAgICBEb24ndCBzZXQgc2xv
dF9jYW5jZWxsZWQKICAgIFJlbW92ZSBydW50aW1lIGJvb2trZWVwaW5nIG9mIHdoaWNoIHJlZ2lz
dGVycyB3ZXJlIHVwZGF0ZWQKICAgIFJlZHVjZSB0aGUgY2FzZXMgd2hlcmUgZ2VuX2xvZ192cmVn
X3dyaXRlW19wYWlyXSBpcyBjYWxsZWQKICAgICAgICBJdCdzIG9ubHkgbmVlZGVkIGZvciBzcGVj
aWFsIG9wZXJhbmRzIFZ4eFYgYW5kIFZ5VgogICAgUmVtb3ZlIGdlbl9sb2dfcXJlZ193cml0ZQoK
U2lnbmVkLW9mZi1ieTogVGF5bG9yIFNpbXBzb24gPHRzaW1wc29uQHF1aWNpbmMuY29tPgpSZXZp
ZXdlZC1ieTogQW50b24gSm9oYW5zc29uIDxhbmpvQHJldi5uZz4KLS0tCiB0YXJnZXQvaGV4YWdv
bi9jcHUuaCAgICAgICAgICAgICAgICB8ICA1ICstLQogdGFyZ2V0L2hleGFnb24vZ2VuX3RjZ19o
dnguaCAgICAgICAgfCAxNyArLS0tLS0tLS0KIHRhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5oICAg
ICAgICAgIHwgMTUgKysrLS0tLS0KIHRhcmdldC9oZXhhZ29uL2dlbnB0ci5jICAgICAgICAgICAg
IHwgNDggKysrLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiB0YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUu
YyAgICAgICAgICB8IDU4ICsrKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiB0YXJnZXQvaGV4
YWdvbi9SRUFETUUgICAgICAgICAgICAgICB8IDIxICsrKy0tLS0tLS0tCiB0YXJnZXQvaGV4YWdv
bi9nZW5fYW5hbHl6ZV9mdW5jcy5weSB8ICAzICstCiB0YXJnZXQvaGV4YWdvbi9nZW5fdGNnX2Z1
bmNzLnB5ICAgICB8IDM1ICsrKystLS0tLS0tLS0tLS0tCiA4IGZpbGVzIGNoYW5nZWQsIDM0IGlu
c2VydGlvbnMoKyksIDE2OCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdv
bi9jcHUuaCBiL3RhcmdldC9oZXhhZ29uL2NwdS5oCmluZGV4IDM0YzBhZTBhNjcuLjgxYjY2M2Vj
ZmIgMTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29uL2NwdS5oCisrKyBiL3RhcmdldC9oZXhhZ29u
L2NwdS5oCkBAIC0xLDUgKzEsNSBAQAogLyoKLSAqICBDb3B5cmlnaHQoYykgMjAxOS0yMDIyIFF1
YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCisgKiAg
Q29weXJpZ2h0KGMpIDIwMTktMjAyMyBRdWFsY29tbSBJbm5vdmF0aW9uIENlbnRlciwgSW5jLiBB
bGwgUmlnaHRzIFJlc2VydmVkLgogICoKICAqICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2Fy
ZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQogICogIGl0IHVuZGVyIHRo
ZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5
CkBAIC0xMTEsMTEgKzExMSw4IEBAIHR5cGVkZWYgc3RydWN0IENQVUFyY2hTdGF0ZSB7CiAgICAg
TU1WZWN0b3IgZnV0dXJlX1ZSZWdzW1ZFQ1RPUl9URU1QU19NQVhdIFFFTVVfQUxJR05FRCgxNik7
CiAgICAgTU1WZWN0b3IgdG1wX1ZSZWdzW1ZFQ1RPUl9URU1QU19NQVhdIFFFTVVfQUxJR05FRCgx
Nik7CiAKLSAgICBWUmVnTWFzayBWUmVnc191cGRhdGVkOwotCiAgICAgTU1RUmVnIFFSZWdzW05V
TV9RUkVHU10gUUVNVV9BTElHTkVEKDE2KTsKICAgICBNTVFSZWcgZnV0dXJlX1FSZWdzW05VTV9R
UkVHU10gUUVNVV9BTElHTkVEKDE2KTsKLSAgICBRUmVnTWFzayBRUmVnc191cGRhdGVkOwogCiAg
ICAgLyogVGVtcG9yYXJpZXMgdXNlZCB3aXRoaW4gaW5zdHJ1Y3Rpb25zICovCiAgICAgTU1WZWN0
b3JQYWlyIFZ1dVYgUUVNVV9BTElHTkVEKDE2KTsKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29u
L2dlbl90Y2dfaHZ4LmggYi90YXJnZXQvaGV4YWdvbi9nZW5fdGNnX2h2eC5oCmluZGV4IDk0ZjI3
MmUyODYuLmQ0YWVmZThlM2YgMTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29uL2dlbl90Y2dfaHZ4
LmgKKysrIGIvdGFyZ2V0L2hleGFnb24vZ2VuX3RjZ19odnguaApAQCAtMSw1ICsxLDUgQEAKIC8q
Ci0gKiAgQ29weXJpZ2h0KGMpIDIwMTktMjAyMiBRdWFsY29tbSBJbm5vdmF0aW9uIENlbnRlciwg
SW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLgorICogIENvcHlyaWdodChjKSAyMDE5LTIwMjMgUXVh
bGNvbW0gSW5ub3ZhdGlvbiBDZW50ZXIsIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KICAqCiAg
KiAgVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0
IGFuZC9vciBtb2RpZnkKICAqICBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFs
IFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQpAQCAtMTMzLDE2ICsxMzMsMTEgQEAgc3Rh
dGljIGlubGluZSB2b2lkIGFzc2VydF92aGlzdF90bXAoRGlzYXNDb250ZXh0ICpjdHgpCiAgICAg
ZG8geyBcCiAgICAgICAgIFRDR3YgbHNiID0gdGNnX3RlbXBfbmV3KCk7IFwKICAgICAgICAgVENH
TGFiZWwgKmZhbHNlX2xhYmVsID0gZ2VuX25ld19sYWJlbCgpOyBcCi0gICAgICAgIFRDR0xhYmVs
ICplbmRfbGFiZWwgPSBnZW5fbmV3X2xhYmVsKCk7IFwKICAgICAgICAgdGNnX2dlbl9hbmRpX3Rs
KGxzYiwgUHNWLCAxKTsgXAogICAgICAgICB0Y2dfZ2VuX2JyY29uZGlfdGwoVENHX0NPTkRfTkUs
IGxzYiwgUFJFRCwgZmFsc2VfbGFiZWwpOyBcCiAgICAgICAgIHRjZ19nZW5fZ3ZlY19tb3YoTU9f
NjQsIFZkVl9vZmYsIFZ1Vl9vZmYsIFwKICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplb2Yo
TU1WZWN0b3IpLCBzaXplb2YoTU1WZWN0b3IpKTsgXAotICAgICAgICB0Y2dfZ2VuX2JyKGVuZF9s
YWJlbCk7IFwKICAgICAgICAgZ2VuX3NldF9sYWJlbChmYWxzZV9sYWJlbCk7IFwKLSAgICAgICAg
dGNnX2dlbl9vcmlfdGwoaGV4X3Nsb3RfY2FuY2VsbGVkLCBoZXhfc2xvdF9jYW5jZWxsZWQsIFwK
LSAgICAgICAgICAgICAgICAgICAgICAgMSA8PCBpbnNuLT5zbG90KTsgXAotICAgICAgICBnZW5f
c2V0X2xhYmVsKGVuZF9sYWJlbCk7IFwKICAgICB9IHdoaWxlICgwKQogCiAKQEAgLTU0NywxNyAr
NTQyLDEyIEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBhc3NlcnRfdmhpc3RfdG1wKERpc2FzQ29udGV4
dCAqY3R4KQogICAgIGRvIHsgXAogICAgICAgICBUQ0d2IExTQiA9IHRjZ190ZW1wX25ldygpOyBc
CiAgICAgICAgIFRDR0xhYmVsICpmYWxzZV9sYWJlbCA9IGdlbl9uZXdfbGFiZWwoKTsgXAotICAg
ICAgICBUQ0dMYWJlbCAqZW5kX2xhYmVsID0gZ2VuX25ld19sYWJlbCgpOyBcCiAgICAgICAgIEdF
VF9FQTsgXAogICAgICAgICBQUkVEOyBcCiAgICAgICAgIHRjZ19nZW5fYnJjb25kaV90bChUQ0df
Q09ORF9FUSwgTFNCLCAwLCBmYWxzZV9sYWJlbCk7IFwKICAgICAgICAgZ2VuX3ZyZWdfbG9hZChj
dHgsIERTVE9GRiwgRUEsIHRydWUpOyBcCiAgICAgICAgIElOQzsgXAotICAgICAgICB0Y2dfZ2Vu
X2JyKGVuZF9sYWJlbCk7IFwKICAgICAgICAgZ2VuX3NldF9sYWJlbChmYWxzZV9sYWJlbCk7IFwK
LSAgICAgICAgdGNnX2dlbl9vcmlfdGwoaGV4X3Nsb3RfY2FuY2VsbGVkLCBoZXhfc2xvdF9jYW5j
ZWxsZWQsIFwKLSAgICAgICAgICAgICAgICAgICAgICAgMSA8PCBpbnNuLT5zbG90KTsgXAotICAg
ICAgICBnZW5fc2V0X2xhYmVsKGVuZF9sYWJlbCk7IFwKICAgICB9IHdoaWxlICgwKQogCiAjZGVm
aW5lIGZHRU5fVENHX1BSRURfVkVDX0xPQURfcHJlZF9waSBcCkBAIC03MTcsMTcgKzcwNywxMiBA
QCBzdGF0aWMgaW5saW5lIHZvaWQgYXNzZXJ0X3ZoaXN0X3RtcChEaXNhc0NvbnRleHQgKmN0eCkK
ICAgICBkbyB7IFwKICAgICAgICAgVENHdiBMU0IgPSB0Y2dfdGVtcF9uZXcoKTsgXAogICAgICAg
ICBUQ0dMYWJlbCAqZmFsc2VfbGFiZWwgPSBnZW5fbmV3X2xhYmVsKCk7IFwKLSAgICAgICAgVENH
TGFiZWwgKmVuZF9sYWJlbCA9IGdlbl9uZXdfbGFiZWwoKTsgXAogICAgICAgICBHRVRfRUE7IFwK
ICAgICAgICAgUFJFRDsgXAogICAgICAgICB0Y2dfZ2VuX2JyY29uZGlfdGwoVENHX0NPTkRfRVEs
IExTQiwgMCwgZmFsc2VfbGFiZWwpOyBcCiAgICAgICAgIGdlbl92cmVnX3N0b3JlKGN0eCwgRUEs
IFNSQ09GRiwgaW5zbi0+c2xvdCwgQUxJR04pOyBcCiAgICAgICAgIElOQzsgXAotICAgICAgICB0
Y2dfZ2VuX2JyKGVuZF9sYWJlbCk7IFwKICAgICAgICAgZ2VuX3NldF9sYWJlbChmYWxzZV9sYWJl
bCk7IFwKLSAgICAgICAgdGNnX2dlbl9vcmlfdGwoaGV4X3Nsb3RfY2FuY2VsbGVkLCBoZXhfc2xv
dF9jYW5jZWxsZWQsIFwKLSAgICAgICAgICAgICAgICAgICAgICAgMSA8PCBpbnNuLT5zbG90KTsg
XAotICAgICAgICBnZW5fc2V0X2xhYmVsKGVuZF9sYWJlbCk7IFwKICAgICB9IHdoaWxlICgwKQog
CiAjZGVmaW5lIGZHRU5fVENHX1BSRURfVkVDX1NUT1JFX3ByZWRfcGkoQUxJR04pIFwKZGlmZiAt
LWdpdCBhL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5oIGIvdGFyZ2V0L2hleGFnb24vdHJhbnNs
YXRlLmgKaW5kZXggNmU1OWE5MGM0MS4uZGI4MzJiMGY4OCAxMDA2NDQKLS0tIGEvdGFyZ2V0L2hl
eGFnb24vdHJhbnNsYXRlLmgKKysrIGIvdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmgKQEAgLTQ5
LDcgKzQ5LDYgQEAgdHlwZWRlZiBzdHJ1Y3QgRGlzYXNDb250ZXh0IHsKICAgICBpbnQgdG1wX3Zy
ZWdzX2lkeDsKICAgICBpbnQgdG1wX3ZyZWdzX251bVtWRUNUT1JfVEVNUFNfTUFYXTsKICAgICBp
bnQgdnJlZ19sb2dbTlVNX1ZSRUdTXTsKLSAgICBib29sIHZyZWdfaXNfcHJlZGljYXRlZFtOVU1f
VlJFR1NdOwogICAgIGludCB2cmVnX2xvZ19pZHg7CiAgICAgREVDTEFSRV9CSVRNQVAodnJlZ3Nf
dXBkYXRlZF90bXAsIE5VTV9WUkVHUyk7CiAgICAgREVDTEFSRV9CSVRNQVAodnJlZ3NfdXBkYXRl
ZCwgTlVNX1ZSRUdTKTsKQEAgLTU3LDcgKzU2LDYgQEAgdHlwZWRlZiBzdHJ1Y3QgRGlzYXNDb250
ZXh0IHsKICAgICBERUNMQVJFX0JJVE1BUChwcmVkaWNhdGVkX2Z1dHVyZV92cmVncywgTlVNX1ZS
RUdTKTsKICAgICBERUNMQVJFX0JJVE1BUChwcmVkaWNhdGVkX3RtcF92cmVncywgTlVNX1ZSRUdT
KTsKICAgICBpbnQgcXJlZ19sb2dbTlVNX1FSRUdTXTsKLSAgICBib29sIHFyZWdfaXNfcHJlZGlj
YXRlZFtOVU1fUVJFR1NdOwogICAgIGludCBxcmVnX2xvZ19pZHg7CiAgICAgYm9vbCBwcmVfY29t
bWl0OwogICAgIFRDR0NvbmQgYnJhbmNoX2NvbmQ7CkBAIC0xMTEsOSArMTA5LDExIEBAIHN0YXRp
YyBpbmxpbmUgdm9pZCBjdHhfbG9nX3ZyZWdfd3JpdGUoRGlzYXNDb250ZXh0ICpjdHgsCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgaXNfcHJlZGljYXRlZCkKIHsK
ICAgICBpZiAodHlwZSAhPSBFWFRfVE1QKSB7Ci0gICAgICAgIGN0eC0+dnJlZ19sb2dbY3R4LT52
cmVnX2xvZ19pZHhdID0gcm51bTsKLSAgICAgICAgY3R4LT52cmVnX2lzX3ByZWRpY2F0ZWRbY3R4
LT52cmVnX2xvZ19pZHhdID0gaXNfcHJlZGljYXRlZDsKLSAgICAgICAgY3R4LT52cmVnX2xvZ19p
ZHgrKzsKKyAgICAgICAgaWYgKCF0ZXN0X2JpdChybnVtLCBjdHgtPnZyZWdzX3VwZGF0ZWQpKSB7
CisgICAgICAgICAgICBjdHgtPnZyZWdfbG9nW2N0eC0+dnJlZ19sb2dfaWR4XSA9IHJudW07Cisg
ICAgICAgICAgICBjdHgtPnZyZWdfbG9nX2lkeCsrOworICAgICAgICAgICAgc2V0X2JpdChybnVt
LCBjdHgtPnZyZWdzX3VwZGF0ZWQpOworICAgICAgICB9CiAKICAgICAgICAgc2V0X2JpdChybnVt
LCBjdHgtPnZyZWdzX3VwZGF0ZWQpOwogICAgICAgICBpZiAoaXNfcHJlZGljYXRlZCkgewpAQCAt
MTQwLDEwICsxNDAsOSBAQCBzdGF0aWMgaW5saW5lIHZvaWQgY3R4X2xvZ192cmVnX3dyaXRlX3Bh
aXIoRGlzYXNDb250ZXh0ICpjdHgsCiB9CiAKIHN0YXRpYyBpbmxpbmUgdm9pZCBjdHhfbG9nX3Fy
ZWdfd3JpdGUoRGlzYXNDb250ZXh0ICpjdHgsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGludCBybnVtLCBib29sIGlzX3ByZWRpY2F0ZWQpCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGludCBybnVtKQogewogICAgIGN0eC0+cXJlZ19sb2dbY3R4
LT5xcmVnX2xvZ19pZHhdID0gcm51bTsKLSAgICBjdHgtPnFyZWdfaXNfcHJlZGljYXRlZFtjdHgt
PnFyZWdfbG9nX2lkeF0gPSBpc19wcmVkaWNhdGVkOwogICAgIGN0eC0+cXJlZ19sb2dfaWR4Kys7
CiB9CiAKQEAgLTE2NCw4ICsxNjMsNiBAQCBleHRlcm4gVENHdiBoZXhfZGN6ZXJvX2FkZHI7CiBl
eHRlcm4gVENHdiBoZXhfbGxzY19hZGRyOwogZXh0ZXJuIFRDR3YgaGV4X2xsc2NfdmFsOwogZXh0
ZXJuIFRDR3ZfaTY0IGhleF9sbHNjX3ZhbF9pNjQ7Ci1leHRlcm4gVENHdiBoZXhfVlJlZ3NfdXBk
YXRlZDsKLWV4dGVybiBUQ0d2IGhleF9RUmVnc191cGRhdGVkOwogZXh0ZXJuIFRDR3YgaGV4X3Zz
dG9yZV9hZGRyW1ZTVE9SRVNfTUFYXTsKIGV4dGVybiBUQ0d2IGhleF92c3RvcmVfc2l6ZVtWU1RP
UkVTX01BWF07CiBleHRlcm4gVENHdiBoZXhfdnN0b3JlX3BlbmRpbmdbVlNUT1JFU19NQVhdOwpk
aWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vZ2VucHRyLmMgYi90YXJnZXQvaGV4YWdvbi9nZW5w
dHIuYwppbmRleCBkYTVkYmM4M2NmLi5iYjI3NGQ0YTcxIDEwMDY0NAotLS0gYS90YXJnZXQvaGV4
YWdvbi9nZW5wdHIuYworKysgYi90YXJnZXQvaGV4YWdvbi9nZW5wdHIuYwpAQCAtOTg1LDY4ICs5
ODUsMzIgQEAgc3RhdGljIGludHB0cl90IHZyZWdfc3JjX29mZihEaXNhc0NvbnRleHQgKmN0eCwg
aW50IG51bSkKIH0KIAogc3RhdGljIHZvaWQgZ2VuX2xvZ192cmVnX3dyaXRlKERpc2FzQ29udGV4
dCAqY3R4LCBpbnRwdHJfdCBzcmNvZmYsIGludCBudW0sCi0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgVlJlZ1dyaXRlVHlwZSB0eXBlLCBpbnQgc2xvdF9udW0sCi0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgYm9vbCBpc19wcmVkaWNhdGVkKQorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFZSZWdXcml0ZVR5cGUgdHlwZSkKIHsKLSAgICBUQ0dMYWJlbCAqbGFiZWxf
ZW5kID0gTlVMTDsKICAgICBpbnRwdHJfdCBkc3RvZmY7CiAKLSAgICBpZiAoaXNfcHJlZGljYXRl
ZCkgewotICAgICAgICBUQ0d2IGNhbmNlbGxlZCA9IHRjZ190ZW1wX25ldygpOwotICAgICAgICBs
YWJlbF9lbmQgPSBnZW5fbmV3X2xhYmVsKCk7Ci0KLSAgICAgICAgLyogRG9uJ3QgZG8gYW55dGhp
bmcgaWYgdGhlIHNsb3Qgd2FzIGNhbmNlbGxlZCAqLwotICAgICAgICB0Y2dfZ2VuX2V4dHJhY3Rf
dGwoY2FuY2VsbGVkLCBoZXhfc2xvdF9jYW5jZWxsZWQsIHNsb3RfbnVtLCAxKTsKLSAgICAgICAg
dGNnX2dlbl9icmNvbmRpX3RsKFRDR19DT05EX05FLCBjYW5jZWxsZWQsIDAsIGxhYmVsX2VuZCk7
Ci0gICAgfQotCiAgICAgaWYgKHR5cGUgIT0gRVhUX1RNUCkgewogICAgICAgICBkc3RvZmYgPSBj
dHhfZnV0dXJlX3ZyZWdfb2ZmKGN0eCwgbnVtLCAxLCB0cnVlKTsKICAgICAgICAgdGNnX2dlbl9n
dmVjX21vdihNT182NCwgZHN0b2ZmLCBzcmNvZmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAg
c2l6ZW9mKE1NVmVjdG9yKSwgc2l6ZW9mKE1NVmVjdG9yKSk7Ci0gICAgICAgIHRjZ19nZW5fb3Jp
X3RsKGhleF9WUmVnc191cGRhdGVkLCBoZXhfVlJlZ3NfdXBkYXRlZCwgMSA8PCBudW0pOwogICAg
IH0gZWxzZSB7CiAgICAgICAgIGRzdG9mZiA9IGN0eF90bXBfdnJlZ19vZmYoY3R4LCBudW0sIDEs
IGZhbHNlKTsKICAgICAgICAgdGNnX2dlbl9ndmVjX21vdihNT182NCwgZHN0b2ZmLCBzcmNvZmYs
CiAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZW9mKE1NVmVjdG9yKSwgc2l6ZW9mKE1NVmVj
dG9yKSk7CiAgICAgfQotCi0gICAgaWYgKGlzX3ByZWRpY2F0ZWQpIHsKLSAgICAgICAgZ2VuX3Nl
dF9sYWJlbChsYWJlbF9lbmQpOwotICAgIH0KIH0KIAogc3RhdGljIHZvaWQgZ2VuX2xvZ192cmVn
X3dyaXRlX3BhaXIoRGlzYXNDb250ZXh0ICpjdHgsIGludHB0cl90IHNyY29mZiwgaW50IG51bSwK
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZSZWdXcml0ZVR5cGUgdHlwZSwg
aW50IHNsb3RfbnVtLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCBp
c19wcmVkaWNhdGVkKQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVlJlZ1dy
aXRlVHlwZSB0eXBlKQogewotICAgIGdlbl9sb2dfdnJlZ193cml0ZShjdHgsIHNyY29mZiwgbnVt
IF4gMCwgdHlwZSwgc2xvdF9udW0sIGlzX3ByZWRpY2F0ZWQpOworICAgIGdlbl9sb2dfdnJlZ193
cml0ZShjdHgsIHNyY29mZiwgbnVtIF4gMCwgdHlwZSk7CiAgICAgc3Jjb2ZmICs9IHNpemVvZihN
TVZlY3Rvcik7Ci0gICAgZ2VuX2xvZ192cmVnX3dyaXRlKGN0eCwgc3Jjb2ZmLCBudW0gXiAxLCB0
eXBlLCBzbG90X251bSwgaXNfcHJlZGljYXRlZCk7CisgICAgZ2VuX2xvZ192cmVnX3dyaXRlKGN0
eCwgc3Jjb2ZmLCBudW0gXiAxLCB0eXBlKTsKIH0KIAotc3RhdGljIHZvaWQgZ2VuX2xvZ19xcmVn
X3dyaXRlKGludHB0cl90IHNyY29mZiwgaW50IG51bSwgaW50IHZuZXcsCi0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgaW50IHNsb3RfbnVtLCBib29sIGlzX3ByZWRpY2F0ZWQpCitzdGF0
aWMgaW50cHRyX3QgZ2V0X3Jlc3VsdF9xcmVnKERpc2FzQ29udGV4dCAqY3R4LCBpbnQgcW51bSkK
IHsKLSAgICBUQ0dMYWJlbCAqbGFiZWxfZW5kID0gTlVMTDsKLSAgICBpbnRwdHJfdCBkc3RvZmY7
Ci0KLSAgICBpZiAoaXNfcHJlZGljYXRlZCkgewotICAgICAgICBUQ0d2IGNhbmNlbGxlZCA9IHRj
Z190ZW1wX25ldygpOwotICAgICAgICBsYWJlbF9lbmQgPSBnZW5fbmV3X2xhYmVsKCk7Ci0KLSAg
ICAgICAgLyogRG9uJ3QgZG8gYW55dGhpbmcgaWYgdGhlIHNsb3Qgd2FzIGNhbmNlbGxlZCAqLwot
ICAgICAgICB0Y2dfZ2VuX2V4dHJhY3RfdGwoY2FuY2VsbGVkLCBoZXhfc2xvdF9jYW5jZWxsZWQs
IHNsb3RfbnVtLCAxKTsKLSAgICAgICAgdGNnX2dlbl9icmNvbmRpX3RsKFRDR19DT05EX05FLCBj
YW5jZWxsZWQsIDAsIGxhYmVsX2VuZCk7Ci0gICAgfQotCi0gICAgZHN0b2ZmID0gb2Zmc2V0b2Yo
Q1BVSGV4YWdvblN0YXRlLCBmdXR1cmVfUVJlZ3NbbnVtXSk7Ci0gICAgdGNnX2dlbl9ndmVjX21v
dihNT182NCwgZHN0b2ZmLCBzcmNvZmYsIHNpemVvZihNTVFSZWcpLCBzaXplb2YoTU1RUmVnKSk7
Ci0KLSAgICBpZiAoaXNfcHJlZGljYXRlZCkgewotICAgICAgICB0Y2dfZ2VuX29yaV90bChoZXhf
UVJlZ3NfdXBkYXRlZCwgaGV4X1FSZWdzX3VwZGF0ZWQsIDEgPDwgbnVtKTsKLSAgICAgICAgZ2Vu
X3NldF9sYWJlbChsYWJlbF9lbmQpOwotICAgIH0KKyAgICByZXR1cm4gIG9mZnNldG9mKENQVUhl
eGFnb25TdGF0ZSwgZnV0dXJlX1FSZWdzW3FudW1dKTsKIH0KIAogc3RhdGljIHZvaWQgZ2VuX3Zy
ZWdfbG9hZChEaXNhc0NvbnRleHQgKmN0eCwgaW50cHRyX3QgZHN0b2ZmLCBUQ0d2IHNyYywKZGlm
ZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5jIGIvdGFyZ2V0L2hleGFnb24vdHJh
bnNsYXRlLmMKaW5kZXggMWUzYTc2YWVjZS4uNjY1NDc2YWI0OCAxMDA2NDQKLS0tIGEvdGFyZ2V0
L2hleGFnb24vdHJhbnNsYXRlLmMKKysrIGIvdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmMKQEAg
LTU2LDggKzU2LDYgQEAgVENHdiBoZXhfZGN6ZXJvX2FkZHI7CiBUQ0d2IGhleF9sbHNjX2FkZHI7
CiBUQ0d2IGhleF9sbHNjX3ZhbDsKIFRDR3ZfaTY0IGhleF9sbHNjX3ZhbF9pNjQ7Ci1UQ0d2IGhl
eF9WUmVnc191cGRhdGVkOwotVENHdiBoZXhfUVJlZ3NfdXBkYXRlZDsKIFRDR3YgaGV4X3ZzdG9y
ZV9hZGRyW1ZTVE9SRVNfTUFYXTsKIFRDR3YgaGV4X3ZzdG9yZV9zaXplW1ZTVE9SRVNfTUFYXTsK
IFRDR3YgaGV4X3ZzdG9yZV9wZW5kaW5nW1ZTVE9SRVNfTUFYXTsKQEAgLTI0OCwxMiArMjQ2LDEx
IEBAIHN0YXRpYyBib29sIGNoZWNrX2Zvcl9hdHRyaWIoUGFja2V0ICpwa3QsIGludCBhdHRyaWIp
CiAKIHN0YXRpYyBib29sIG5lZWRfc2xvdF9jYW5jZWxsZWQoUGFja2V0ICpwa3QpCiB7Ci0gICAg
LyogV2Ugb25seSBuZWVkIHNsb3RfY2FuY2VsbGVkIGZvciBjb25kaXRpb25hbCBzdG9yZSBhbmQg
SFZYIGluc3RydWN0aW9ucyAqLworICAgIC8qIFdlIG9ubHkgbmVlZCBzbG90X2NhbmNlbGxlZCBm
b3IgY29uZGl0aW9uYWwgc3RvcmUgaW5zdHJ1Y3Rpb25zICovCiAgICAgZm9yIChpbnQgaSA9IDA7
IGkgPCBwa3QtPm51bV9pbnNuczsgaSsrKSB7CiAgICAgICAgIHVpbnQxNl90IG9wY29kZSA9IHBr
dC0+aW5zbltpXS5vcGNvZGU7CiAgICAgICAgIGlmIChHRVRfQVRUUklCKG9wY29kZSwgQV9DT05E
RVhFQykgJiYKLSAgICAgICAgICAgIChHRVRfQVRUUklCKG9wY29kZSwgQV9TVE9SRSkgfHwKLSAg
ICAgICAgICAgICBHRVRfQVRUUklCKG9wY29kZSwgQV9DVkkpKSkgeworICAgICAgICAgICAgR0VU
X0FUVFJJQihvcGNvZGUsIEFfU0NBTEFSX1NUT1JFKSkgewogICAgICAgICAgICAgcmV0dXJuIHRy
dWU7CiAgICAgICAgIH0KICAgICB9CkBAIC00NTMsMTEgKzQ1MCw2IEBAIHN0YXRpYyB2b2lkIGdl
bl9zdGFydF9wYWNrZXQoRGlzYXNDb250ZXh0ICpjdHgpCiAgICAgICAgICAgICBpID0gZmluZF9u
ZXh0X2JpdChjdHgtPnByZWRpY2F0ZWRfdG1wX3ZyZWdzLCBOVU1fVlJFR1MsIGkgKyAxKTsKICAg
ICAgICAgfQogICAgIH0KLQotICAgIGlmIChwa3QtPnBrdF9oYXNfaHZ4KSB7Ci0gICAgICAgIHRj
Z19nZW5fbW92aV90bChoZXhfVlJlZ3NfdXBkYXRlZCwgMCk7Ci0gICAgICAgIHRjZ19nZW5fbW92
aV90bChoZXhfUVJlZ3NfdXBkYXRlZCwgMCk7Ci0gICAgfQogfQogCiBib29sIGlzX2dhdGhlcl9z
dG9yZV9pbnNuKERpc2FzQ29udGV4dCAqY3R4KQpAQCAtNzI1LDY1ICs3MTcsMzEgQEAgc3RhdGlj
IHZvaWQgZ2VuX2NvbW1pdF9odngoRGlzYXNDb250ZXh0ICpjdHgpCiAgICAgLyoKICAgICAgKiAg
ICBmb3IgKGkgPSAwOyBpIDwgY3R4LT52cmVnX2xvZ19pZHg7IGkrKykgewogICAgICAqICAgICAg
ICBpbnQgcm51bSA9IGN0eC0+dnJlZ19sb2dbaV07Ci0gICAgICogICAgICAgIGlmIChjdHgtPnZy
ZWdfaXNfcHJlZGljYXRlZFtpXSkgewotICAgICAqICAgICAgICAgICAgaWYgKGVudi0+VlJlZ3Nf
dXBkYXRlZCAmICgxIDw8IHJudW0pKSB7Ci0gICAgICogICAgICAgICAgICAgICAgZW52LT5WUmVn
c1tybnVtXSA9IGVudi0+ZnV0dXJlX1ZSZWdzW3JudW1dOwotICAgICAqICAgICAgICAgICAgfQot
ICAgICAqICAgICAgICB9IGVsc2UgewotICAgICAqICAgICAgICAgICAgZW52LT5WUmVnc1tybnVt
XSA9IGVudi0+ZnV0dXJlX1ZSZWdzW3JudW1dOwotICAgICAqICAgICAgICB9CisgICAgICogICAg
ICAgIGVudi0+VlJlZ3Nbcm51bV0gPSBlbnYtPmZ1dHVyZV9WUmVnc1tybnVtXTsKICAgICAgKiAg
ICB9CiAgICAgICovCiAgICAgZm9yIChpID0gMDsgaSA8IGN0eC0+dnJlZ19sb2dfaWR4OyBpKysp
IHsKICAgICAgICAgaW50IHJudW0gPSBjdHgtPnZyZWdfbG9nW2ldOwotICAgICAgICBib29sIGlz
X3ByZWRpY2F0ZWQgPSBjdHgtPnZyZWdfaXNfcHJlZGljYXRlZFtpXTsKICAgICAgICAgaW50cHRy
X3QgZHN0b2ZmID0gb2Zmc2V0b2YoQ1BVSGV4YWdvblN0YXRlLCBWUmVnc1tybnVtXSk7CiAgICAg
ICAgIGludHB0cl90IHNyY29mZiA9IGN0eF9mdXR1cmVfdnJlZ19vZmYoY3R4LCBybnVtLCAxLCBm
YWxzZSk7CiAgICAgICAgIHNpemVfdCBzaXplID0gc2l6ZW9mKE1NVmVjdG9yKTsKIAotICAgICAg
ICBpZiAoaXNfcHJlZGljYXRlZCkgewotICAgICAgICAgICAgVENHdiBjbXAgPSB0Y2dfdGVtcF9u
ZXcoKTsKLSAgICAgICAgICAgIFRDR0xhYmVsICpsYWJlbF9za2lwID0gZ2VuX25ld19sYWJlbCgp
OwotCi0gICAgICAgICAgICB0Y2dfZ2VuX2FuZGlfdGwoY21wLCBoZXhfVlJlZ3NfdXBkYXRlZCwg
MSA8PCBybnVtKTsKLSAgICAgICAgICAgIHRjZ19nZW5fYnJjb25kaV90bChUQ0dfQ09ORF9FUSwg
Y21wLCAwLCBsYWJlbF9za2lwKTsKLSAgICAgICAgICAgIHRjZ19nZW5fZ3ZlY19tb3YoTU9fNjQs
IGRzdG9mZiwgc3Jjb2ZmLCBzaXplLCBzaXplKTsKLSAgICAgICAgICAgIGdlbl9zZXRfbGFiZWwo
bGFiZWxfc2tpcCk7Ci0gICAgICAgIH0gZWxzZSB7Ci0gICAgICAgICAgICB0Y2dfZ2VuX2d2ZWNf
bW92KE1PXzY0LCBkc3RvZmYsIHNyY29mZiwgc2l6ZSwgc2l6ZSk7Ci0gICAgICAgIH0KKyAgICAg
ICAgdGNnX2dlbl9ndmVjX21vdihNT182NCwgZHN0b2ZmLCBzcmNvZmYsIHNpemUsIHNpemUpOwog
ICAgIH0KIAogICAgIC8qCiAgICAgICogICAgZm9yIChpID0gMDsgaSA8IGN0eC0+cXJlZ19sb2df
aWR4OyBpKyspIHsKICAgICAgKiAgICAgICAgaW50IHJudW0gPSBjdHgtPnFyZWdfbG9nW2ldOwot
ICAgICAqICAgICAgICBpZiAoY3R4LT5xcmVnX2lzX3ByZWRpY2F0ZWRbaV0pIHsKLSAgICAgKiAg
ICAgICAgICAgIGlmIChlbnYtPlFSZWdzX3VwZGF0ZWQpICYgKDEgPDwgcm51bSkpIHsKLSAgICAg
KiAgICAgICAgICAgICAgICBlbnYtPlFSZWdzW3JudW1dID0gZW52LT5mdXR1cmVfUVJlZ3Nbcm51
bV07Ci0gICAgICogICAgICAgICAgICB9Ci0gICAgICogICAgICAgIH0gZWxzZSB7Ci0gICAgICog
ICAgICAgICAgICBlbnYtPlFSZWdzW3JudW1dID0gZW52LT5mdXR1cmVfUVJlZ3Nbcm51bV07Ci0g
ICAgICogICAgICAgIH0KKyAgICAgKiAgICAgICAgZW52LT5RUmVnc1tybnVtXSA9IGVudi0+ZnV0
dXJlX1FSZWdzW3JudW1dOwogICAgICAqICAgIH0KICAgICAgKi8KICAgICBmb3IgKGkgPSAwOyBp
IDwgY3R4LT5xcmVnX2xvZ19pZHg7IGkrKykgewogICAgICAgICBpbnQgcm51bSA9IGN0eC0+cXJl
Z19sb2dbaV07Ci0gICAgICAgIGJvb2wgaXNfcHJlZGljYXRlZCA9IGN0eC0+cXJlZ19pc19wcmVk
aWNhdGVkW2ldOwogICAgICAgICBpbnRwdHJfdCBkc3RvZmYgPSBvZmZzZXRvZihDUFVIZXhhZ29u
U3RhdGUsIFFSZWdzW3JudW1dKTsKICAgICAgICAgaW50cHRyX3Qgc3Jjb2ZmID0gb2Zmc2V0b2Yo
Q1BVSGV4YWdvblN0YXRlLCBmdXR1cmVfUVJlZ3Nbcm51bV0pOwogICAgICAgICBzaXplX3Qgc2l6
ZSA9IHNpemVvZihNTVFSZWcpOwogCi0gICAgICAgIGlmIChpc19wcmVkaWNhdGVkKSB7Ci0gICAg
ICAgICAgICBUQ0d2IGNtcCA9IHRjZ190ZW1wX25ldygpOwotICAgICAgICAgICAgVENHTGFiZWwg
KmxhYmVsX3NraXAgPSBnZW5fbmV3X2xhYmVsKCk7Ci0KLSAgICAgICAgICAgIHRjZ19nZW5fYW5k
aV90bChjbXAsIGhleF9RUmVnc191cGRhdGVkLCAxIDw8IHJudW0pOwotICAgICAgICAgICAgdGNn
X2dlbl9icmNvbmRpX3RsKFRDR19DT05EX0VRLCBjbXAsIDAsIGxhYmVsX3NraXApOwotICAgICAg
ICAgICAgdGNnX2dlbl9ndmVjX21vdihNT182NCwgZHN0b2ZmLCBzcmNvZmYsIHNpemUsIHNpemUp
OwotICAgICAgICAgICAgZ2VuX3NldF9sYWJlbChsYWJlbF9za2lwKTsKLSAgICAgICAgfSBlbHNl
IHsKLSAgICAgICAgICAgIHRjZ19nZW5fZ3ZlY19tb3YoTU9fNjQsIGRzdG9mZiwgc3Jjb2ZmLCBz
aXplLCBzaXplKTsKLSAgICAgICAgfQorICAgICAgICB0Y2dfZ2VuX2d2ZWNfbW92KE1PXzY0LCBk
c3RvZmYsIHNyY29mZiwgc2l6ZSwgc2l6ZSk7CiAgICAgfQogCiAgICAgaWYgKHBrdF9oYXNfaHZ4
X3N0b3JlKGN0eC0+cGt0KSkgewpAQCAtMTEyOSwxMCArMTA4Nyw2IEBAIHZvaWQgaGV4YWdvbl90
cmFuc2xhdGVfaW5pdCh2b2lkKQogICAgICAgICBvZmZzZXRvZihDUFVIZXhhZ29uU3RhdGUsIGxs
c2NfdmFsKSwgImxsc2NfdmFsIik7CiAgICAgaGV4X2xsc2NfdmFsX2k2NCA9IHRjZ19nbG9iYWxf
bWVtX25ld19pNjQoY3B1X2VudiwKICAgICAgICAgb2Zmc2V0b2YoQ1BVSGV4YWdvblN0YXRlLCBs
bHNjX3ZhbF9pNjQpLCAibGxzY192YWxfaTY0Iik7Ci0gICAgaGV4X1ZSZWdzX3VwZGF0ZWQgPSB0
Y2dfZ2xvYmFsX21lbV9uZXcoY3B1X2VudiwKLSAgICAgICAgb2Zmc2V0b2YoQ1BVSGV4YWdvblN0
YXRlLCBWUmVnc191cGRhdGVkKSwgIlZSZWdzX3VwZGF0ZWQiKTsKLSAgICBoZXhfUVJlZ3NfdXBk
YXRlZCA9IHRjZ19nbG9iYWxfbWVtX25ldyhjcHVfZW52LAotICAgICAgICBvZmZzZXRvZihDUFVI
ZXhhZ29uU3RhdGUsIFFSZWdzX3VwZGF0ZWQpLCAiUVJlZ3NfdXBkYXRlZCIpOwogICAgIGZvciAo
aSA9IDA7IGkgPCBTVE9SRVNfTUFYOyBpKyspIHsKICAgICAgICAgc25wcmludGYoc3RvcmVfYWRk
cl9uYW1lc1tpXSwgTkFNRV9MRU4sICJzdG9yZV9hZGRyXyVkIiwgaSk7CiAgICAgICAgIGhleF9z
dG9yZV9hZGRyW2ldID0gdGNnX2dsb2JhbF9tZW1fbmV3KGNwdV9lbnYsCmRpZmYgLS1naXQgYS90
YXJnZXQvaGV4YWdvbi9SRUFETUUgYi90YXJnZXQvaGV4YWdvbi9SRUFETUUKaW5kZXggMzY1NjA2
ZjFlNi4uZWJhZmM3OGIxYyAxMDA2NDQKLS0tIGEvdGFyZ2V0L2hleGFnb24vUkVBRE1FCisrKyBi
L3RhcmdldC9oZXhhZ29uL1JFQURNRQpAQCAtMTM2LDEyICsxMzYsOSBAQCBGb3IgSFZYIHZlY3Rv
cnMsIHRoZSBnZW5lcmF0b3IgYmVoYXZlcyBzbGlnaHRseSBkaWZmZXJlbnRseS4gIFRoZSB3aWRl
IHZlY3RvcnMKIHdvbid0IGZpdCBpbiBhIFRDR3Ygb3IgVENHdl9pNjQsIHNvIHdlIHBhc3MgVENH
dl9wdHIgdmFyaWFibGVzIHRvIHBhc3MgdGhlCiBhZGRyZXNzIHRvIGhlbHBlciBmdW5jdGlvbnMu
ICBIZXJlJ3MgYW4gZXhhbXBsZSBmb3IgYW4gSFZYIHZlY3Rvci1hZGQtd29yZAogaXN0cnVjdGlv
bi4KLSAgICBzdGF0aWMgdm9pZCBnZW5lcmF0ZV9WNl92YWRkdygKLSAgICAgICAgICAgICAgICAg
ICAgQ1BVSGV4YWdvblN0YXRlICplbnYsCi0gICAgICAgICAgICAgICAgICAgIERpc2FzQ29udGV4
dCAqY3R4LAotICAgICAgICAgICAgICAgICAgICBJbnNuICppbnNuLAotICAgICAgICAgICAgICAg
ICAgICBQYWNrZXQgKnBrdCkKKyAgICBzdGF0aWMgdm9pZCBnZW5lcmF0ZV9WNl92YWRkdyhEaXNh
c0NvbnRleHQgKmN0eCkKICAgICB7CisgICAgICAgIEluc24gKmluc24gX19hdHRyaWJ1dGVfXygo
dW51c2VkKSkgPSBjdHgtPmluc247CiAgICAgICAgIGNvbnN0IGludCBWZE4gPSBpbnNuLT5yZWdu
b1swXTsKICAgICAgICAgY29uc3QgaW50cHRyX3QgVmRWX29mZiA9CiAgICAgICAgICAgICBjdHhf
ZnV0dXJlX3ZyZWdfb2ZmKGN0eCwgVmROLCAxLCB0cnVlKTsKQEAgLTE1Nyw5ICsxNTQsNyBAQCBp
c3RydWN0aW9uLgogICAgICAgICBUQ0d2X3B0ciBWdlYgPSB0Y2dfdGVtcF9uZXdfcHRyKCk7CiAg
ICAgICAgIHRjZ19nZW5fYWRkaV9wdHIoVnVWLCBjcHVfZW52LCBWdVZfb2ZmKTsKICAgICAgICAg
dGNnX2dlbl9hZGRpX3B0cihWdlYsIGNwdV9lbnYsIFZ2Vl9vZmYpOwotICAgICAgICBUQ0d2IHNs
b3QgPSB0Y2dfY29uc3RhbnRfdGwoaW5zbi0+c2xvdCk7Ci0gICAgICAgIGdlbl9oZWxwZXJfVjZf
dmFkZHcoY3B1X2VudiwgVmRWLCBWdVYsIFZ2Viwgc2xvdCk7Ci0gICAgICAgIGdlbl9sb2dfdnJl
Z193cml0ZShjdHgsIFZkVl9vZmYsIFZkTiwgRVhUX0RGTCwgaW5zbi0+c2xvdCwgZmFsc2UpOwor
ICAgICAgICBnZW5faGVscGVyX1Y2X3ZhZGR3KGNwdV9lbnYsIFZkViwgVnVWLCBWdlYpOwogICAg
IH0KIAogTm90aWNlIHRoYXQgd2UgYWxzbyBnZW5lcmF0ZSBhIHZhcmlhYmxlIG5hbWVkIDxvcGVy
YW5kPl9vZmYgZm9yIGVhY2ggb3BlcmFuZCBvZgpAQCAtMTcyLDEyICsxNjcsOSBAQCBmdW5jdGlv
bnMgZnJvbSB0Y2ctb3AtZ3ZlYy5oLiAgSGVyZSdzIHRoZSBvdmVycmlkZSBmb3IgdGhpcyBpbnN0
cnVjdGlvbi4KIEZpbmFsbHksIHdlIG5vdGljZSB0aGF0IHRoZSBvdmVycmlkZSBkb2Vzbid0IHVz
ZSB0aGUgVENHdl9wdHIgdmFyaWFibGVzLCBzbwogd2UgZG9uJ3QgZ2VuZXJhdGUgdGhlbSB3aGVu
IGFuIG92ZXJyaWRlIGlzIHByZXNlbnQuICBIZXJlIGlzIHdoYXQgd2UgZ2VuZXJhdGUKIHdoZW4g
dGhlIG92ZXJyaWRlIGlzIHByZXNlbnQuCi0gICAgc3RhdGljIHZvaWQgZ2VuZXJhdGVfVjZfdmFk
ZHcoCi0gICAgICAgICAgICAgICAgICAgIENQVUhleGFnb25TdGF0ZSAqZW52LAotICAgICAgICAg
ICAgICAgICAgICBEaXNhc0NvbnRleHQgKmN0eCwKLSAgICAgICAgICAgICAgICAgICAgSW5zbiAq
aW5zbiwKLSAgICAgICAgICAgICAgICAgICAgUGFja2V0ICpwa3QpCisgICAgc3RhdGljIHZvaWQg
Z2VuZXJhdGVfVjZfdmFkZHcoRGlzYXNDb250ZXh0ICpjdHgpCiAgICAgeworICAgICAgICBJbnNu
ICppbnNuIF9fYXR0cmlidXRlX18oKHVudXNlZCkpID0gY3R4LT5pbnNuOwogICAgICAgICBjb25z
dCBpbnQgVmROID0gaW5zbi0+cmVnbm9bMF07CiAgICAgICAgIGNvbnN0IGludHB0cl90IFZkVl9v
ZmYgPQogICAgICAgICAgICAgY3R4X2Z1dHVyZV92cmVnX29mZihjdHgsIFZkTiwgMSwgdHJ1ZSk7
CkBAIC0xODgsNyArMTgwLDYgQEAgd2hlbiB0aGUgb3ZlcnJpZGUgaXMgcHJlc2VudC4KICAgICAg
ICAgY29uc3QgaW50cHRyX3QgVnZWX29mZiA9CiAgICAgICAgICAgICB2cmVnX3NyY19vZmYoY3R4
LCBWdk4pOwogICAgICAgICBmR0VOX1RDR19WNl92YWRkdyh7IGZISURFKGludCBpOykgZlZGT1JF
QUNIKDMyLCBpKSB7IFZkVi53W2ldID0gVnVWLndbaV0gKyBWdlYud1tpXSA7IH0gfSk7Ci0gICAg
ICAgIGdlbl9sb2dfdnJlZ193cml0ZShjdHgsIFZkVl9vZmYsIFZkTiwgRVhUX0RGTCwgaW5zbi0+
c2xvdCwgZmFsc2UpOwogICAgIH0KIAogV2UgYWxzbyBnZW5lcmF0ZSBhbiBhbmFseXplXzx0YWc+
IGZ1bmN0aW9uIGZvciBlYWNoIGluc3RydWN0aW9uLiAgQ3VycmVudGx5LApAQCAtMjgxLDEwICsy
NzIsOCBAQCBGb3IgSGV4YWdvbiBWZWN0b3IgZVh0ZW5zaW9ucyAoSFZYKSwgdGhlIGZvbGxvd2lu
ZyBmaWVsZHMgYXJlIHVzZWQKICAgICBWUmVncyAgICAgICAgICAgICAgICAgICAgICAgVmVjdG9y
IHJlZ2lzdGVycwogICAgIGZ1dHVyZV9WUmVncyAgICAgICAgICAgICAgICBSZWdpc3RlcnMgdG8g
YmUgc3RvcmVkIGR1cmluZyBwYWNrZXQgY29tbWl0CiAgICAgdG1wX1ZSZWdzICAgICAgICAgICAg
ICAgICAgIFRlbXBvcmFyeSByZWdpc3RlcnMgKm5vdCogc3RvcmVkIGR1cmluZyBjb21taXQKLSAg
ICBWUmVnc191cGRhdGVkICAgICAgICAgICAgICAgTWFzayBvZiBwcmVkaWNhdGVkIHZlY3RvciB3
cml0ZXMKICAgICBRUmVncyAgICAgICAgICAgICAgICAgICAgICAgUSAodmVjdG9yIHByZWRpY2F0
ZSkgcmVnaXN0ZXJzCiAgICAgZnV0dXJlX1FSZWdzICAgICAgICAgICAgICAgIFJlZ2lzdGVycyB0
byBiZSBzdG9yZWQgZHVyaW5nIHBhY2tldCBjb21taXQKLSAgICBRUmVnc191cGRhdGVkICAgICAg
ICAgICAgICAgTWFzayBvZiBwcmVkaWNhdGVkIHZlY3RvciB3cml0ZXMKIAogKioqIERlYnVnZ2lu
ZyAqKioKIApkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vZ2VuX2FuYWx5emVfZnVuY3MucHkg
Yi90YXJnZXQvaGV4YWdvbi9nZW5fYW5hbHl6ZV9mdW5jcy5weQppbmRleCAwYmI0ZmNiNDc2Li5l
YmQzZTdhZmI5IDEwMDc1NQotLS0gYS90YXJnZXQvaGV4YWdvbi9nZW5fYW5hbHl6ZV9mdW5jcy5w
eQorKysgYi90YXJnZXQvaGV4YWdvbi9nZW5fYW5hbHl6ZV9mdW5jcy5weQpAQCAtMTEwLDggKzEx
MCw3IEBAIGRlZiBhbmFseXplX29wbl9vbGQoZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgcmVnbm8p
OgogICAgICAgICBpZiAocmVnaWQgaW4geyJkIiwgImUiLCAieCJ9KToKICAgICAgICAgICAgIGYu
d3JpdGUoIiAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4iICUgXAogICAgICAg
ICAgICAgICAgIChyZWdOLCByZWdubykpCi0gICAgICAgICAgICBmLndyaXRlKCIgICAgY3R4X2xv
Z19xcmVnX3dyaXRlKGN0eCwgJXMsICVzKTtcbiIgJSBcCi0gICAgICAgICAgICAgICAgKHJlZ04s
IHByZWRpY2F0ZWQpKQorICAgICAgICAgICAgZi53cml0ZSgiICAgIGN0eF9sb2dfcXJlZ193cml0
ZShjdHgsICVzKTtcbiIgJSAocmVnTikpCiAgICAgICAgIGVsaWYgKHJlZ2lkIGluIHsicyIsICJ0
IiwgInUiLCAidiJ9KToKICAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9
IGluc24tPnJlZ25vWyVkXTtcbiIgJSBcCiAgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkK
ZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29uL2dlbl90Y2dfZnVuY3MucHkgYi90YXJnZXQvaGV4
YWdvbi9nZW5fdGNnX2Z1bmNzLnB5CmluZGV4IDkzMzY1MjhlNTAuLmZhOTNlMTg1Y2UgMTAwNzU1
Ci0tLSBhL3RhcmdldC9oZXhhZ29uL2dlbl90Y2dfZnVuY3MucHkKKysrIGIvdGFyZ2V0L2hleGFn
b24vZ2VuX3RjZ19mdW5jcy5weQpAQCAtMTc2LDggKzE3Niw3IEBAIGRlZiBnZW5wdHJfZGVjbChm
LCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCByZWdubyk6CiAgICAgICAgICAgICAgICAgKHJlZ3R5cGUs
IHJlZ2lkLCByZWdubykpCiAgICAgICAgICAgICBmLndyaXRlKCIgICAgY29uc3QgaW50cHRyX3Qg
JXMlc1Zfb2ZmID1cbiIgJSBcCiAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkKLSAg
ICAgICAgICAgIGYud3JpdGUoIiAgICAgICAgb2Zmc2V0b2YoQ1BVSGV4YWdvblN0YXRlLFxuIikK
LSAgICAgICAgICAgIGYud3JpdGUoIiAgICAgICAgICAgICAgICAgZnV0dXJlX1FSZWdzWyVzJXNO
XSk7XG4iICUgXAorICAgICAgICAgICAgZi53cml0ZSgiICAgICAgICBnZXRfcmVzdWx0X3FyZWco
Y3R4LCAlcyVzTik7XG4iICUgXAogICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkpCiAg
ICAgICAgICAgICBpZiAobm90IGhleF9jb21tb24uc2tpcF9xZW11X2hlbHBlcih0YWcpKToKICAg
ICAgICAgICAgICAgICBmLndyaXRlKCIgICAgVENHdl9wdHIgJXMlc1YgPSB0Y2dfdGVtcF9uZXdf
cHRyKCk7XG4iICUgXApAQCAtNDA2LDM2ICs0MDUsMTggQEAgZGVmIGdlbnB0cl9kc3Rfd3JpdGUo
ZiwgdGFnLCByZWd0eXBlLCByZWdpZCk6CiAKIGRlZiBnZW5wdHJfZHN0X3dyaXRlX2V4dChmLCB0
YWcsIHJlZ3R5cGUsIHJlZ2lkLCBuZXd2PSJFWFRfREZMIik6CiAgICAgaWYgKHJlZ3R5cGUgPT0g
IlYiKToKLSAgICAgICAgaWYgKHJlZ2lkIGluIHsiZGQiLCAieHgiLCAieXkifSk6Ci0gICAgICAg
ICAgICBpZiAoJ0FfQ09OREVYRUMnIGluIGhleF9jb21tb24uYXR0cmliZGljdFt0YWddKToKLSAg
ICAgICAgICAgICAgICBpc19wcmVkaWNhdGVkID0gInRydWUiCi0gICAgICAgICAgICBlbHNlOgot
ICAgICAgICAgICAgICAgIGlzX3ByZWRpY2F0ZWQgPSAiZmFsc2UiCisgICAgICAgIGlmIChyZWdp
ZCBpbiB7Inh4In0pOgogICAgICAgICAgICAgZi53cml0ZSgiICAgIGdlbl9sb2dfdnJlZ193cml0
ZV9wYWlyKGN0eCwgJXMlc1Zfb2ZmLCAlcyVzTiwgIiAlIFwKICAgICAgICAgICAgICAgICAocmVn
dHlwZSwgcmVnaWQsIHJlZ3R5cGUsIHJlZ2lkKSkKLSAgICAgICAgICAgIGYud3JpdGUoIiVzLCBp
bnNuLT5zbG90LCAlcyk7XG4iICUgXAotICAgICAgICAgICAgICAgIChuZXd2LCBpc19wcmVkaWNh
dGVkKSkKLSAgICAgICAgZWxpZiAocmVnaWQgaW4geyJkIiwgIngiLCAieSJ9KToKLSAgICAgICAg
ICAgIGlmICgnQV9DT05ERVhFQycgaW4gaGV4X2NvbW1vbi5hdHRyaWJkaWN0W3RhZ10pOgotICAg
ICAgICAgICAgICAgIGlzX3ByZWRpY2F0ZWQgPSAidHJ1ZSIKLSAgICAgICAgICAgIGVsc2U6Ci0g
ICAgICAgICAgICAgICAgaXNfcHJlZGljYXRlZCA9ICJmYWxzZSIKLSAgICAgICAgICAgIGYud3Jp
dGUoIiAgICBnZW5fbG9nX3ZyZWdfd3JpdGUoY3R4LCAlcyVzVl9vZmYsICVzJXNOLCAlcywgIiAl
IFwKKyAgICAgICAgICAgIGYud3JpdGUoIiVzKTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKG5l
d3YpKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7InkifSk6CisgICAgICAgICAgICBmLndyaXRl
KCIgICAgZ2VuX2xvZ192cmVnX3dyaXRlKGN0eCwgJXMlc1Zfb2ZmLCAlcyVzTiwgJXMpO1xuIiAl
IFwKICAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQsIHJlZ3R5cGUsIHJlZ2lkLCBuZXd2
KSkKLSAgICAgICAgICAgIGYud3JpdGUoImluc24tPnNsb3QsICVzKTtcbiIgJSBcCi0gICAgICAg
ICAgICAgICAgKGlzX3ByZWRpY2F0ZWQpKQotICAgICAgICBlbHNlOgorICAgICAgICBlbGlmIChy
ZWdpZCBub3QgaW4geyJkZCIsICJkIiwgIngifSk6CiAgICAgICAgICAgICBwcmludCgiQmFkIHJl
Z2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKICAgICBlbGlmIChyZWd0eXBlID09ICJR
Iik6Ci0gICAgICAgIGlmIChyZWdpZCBpbiB7ImQiLCAiZSIsICJ4In0pOgotICAgICAgICAgICAg
aWYgKCdBX0NPTkRFWEVDJyBpbiBoZXhfY29tbW9uLmF0dHJpYmRpY3RbdGFnXSk6Ci0gICAgICAg
ICAgICAgICAgaXNfcHJlZGljYXRlZCA9ICJ0cnVlIgotICAgICAgICAgICAgZWxzZToKLSAgICAg
ICAgICAgICAgICBpc19wcmVkaWNhdGVkID0gImZhbHNlIgotICAgICAgICAgICAgZi53cml0ZSgi
ICAgIGdlbl9sb2dfcXJlZ193cml0ZSglcyVzVl9vZmYsICVzJXNOLCAlcywgIiAlIFwKLSAgICAg
ICAgICAgICAgICAocmVndHlwZSwgcmVnaWQsIHJlZ3R5cGUsIHJlZ2lkLCBuZXd2KSkKLSAgICAg
ICAgICAgIGYud3JpdGUoImluc24tPnNsb3QsICVzKTtcbiIgJSAoaXNfcHJlZGljYXRlZCkpCi0g
ICAgICAgIGVsc2U6CisgICAgICAgIGlmIChyZWdpZCBub3QgaW4geyJkIiwgImUiLCAieCJ9KToK
ICAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lk
KQogICAgIGVsc2U6CiAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5
cGUsIHJlZ2lkKQotLSAKMi4yNS4xCgo=

