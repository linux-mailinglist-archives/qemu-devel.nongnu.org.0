Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id E6CA51587B1
	for <lists+qemu-devel@lfdr.de>; Tue, 11 Feb 2020 02:08:12 +0100 (CET)
Received: from localhost ([::1]:41920 helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>)
	id 1j1K27-00018K-Vt
	for lists+qemu-devel@lfdr.de; Mon, 10 Feb 2020 20:08:12 -0500
Received: from eggs.gnu.org ([2001:470:142:3::10]:60548)
 by lists.gnu.org with esmtp (Exim 4.90_1)
 (envelope-from <tsimpson@qualcomm.com>) id 1j1JcB-0001Je-NA
 for qemu-devel@nongnu.org; Mon, 10 Feb 2020 19:41:31 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
 (envelope-from <tsimpson@qualcomm.com>) id 1j1Jc2-0005xu-HX
 for qemu-devel@nongnu.org; Mon, 10 Feb 2020 19:41:23 -0500
Received: from alexa-out-sd-02.qualcomm.com ([199.106.114.39]:59208)
 by eggs.gnu.org with esmtps (TLS1.0:RSA_AES_256_CBC_SHA1:32)
 (Exim 4.71) (envelope-from <tsimpson@qualcomm.com>)
 id 1j1Jc1-0004uP-V8
 for qemu-devel@nongnu.org; Mon, 10 Feb 2020 19:41:14 -0500
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
 d=quicinc.com; i=@quicinc.com; q=dns/txt; s=qcdkim;
 t=1581381674; x=1612917674;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version:content-transfer-encoding;
 bh=ZPuOkaZQAn3KiHXiNouLMLCt08ERsbUx6CIpo6D48wg=;
 b=g+auYyZRmarvRjlOjLojZU3OMSK4Sd/T3Y347FQQuQcCTSiv+4e5BbC+
 uisLiIMsAgXYDckHXR1DRVQgTA388vtIx8CZF7yIrX44bGfCb+zDQFHNp
 qVFZuHF7Sfqov5tCDPuuxbw+x1brTN6WQXp5Xbqu1RUuFYJ+z3y3rPo3a c=;
Received: from unknown (HELO ironmsg05-sd.qualcomm.com) ([10.53.140.145])
 by alexa-out-sd-02.qualcomm.com with ESMTP; 10 Feb 2020 16:41:00 -0800
Received: from vu-tsimpson-aus.qualcomm.com (HELO
 vu-tsimpson1-aus.qualcomm.com) ([10.222.150.1])
 by ironmsg05-sd.qualcomm.com with ESMTP; 10 Feb 2020 16:40:59 -0800
Received: by vu-tsimpson1-aus.qualcomm.com (Postfix, from userid 47164)
 id 609B81B48; Mon, 10 Feb 2020 18:40:59 -0600 (CST)
From: Taylor Simpson <tsimpson@quicinc.com>
To: qemu-devel@nongnu.org
Subject: [RFC PATCH 19/66] Hexagon instruction utility functions
Date: Mon, 10 Feb 2020 18:39:57 -0600
Message-Id: <1581381644-13678-20-git-send-email-tsimpson@quicinc.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1581381644-13678-1-git-send-email-tsimpson@quicinc.com>
References: <1581381644-13678-1-git-send-email-tsimpson@quicinc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
X-detected-operating-system: by eggs.gnu.org: FreeBSD 9.x [fuzzy]
X-Received-From: 199.106.114.39
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Cc: riku.voipio@iki.fi, richard.henderson@linaro.org, laurent@vivier.eu,
 Taylor Simpson <tsimpson@quicinc.com>, philmd@redhat.com,
 aleksandar.m.mail@gmail.com
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: "Qemu-devel" <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>

VXRpbGl0eSBmdW5jdGlvbnMgY2FsbGVkIGJ5IHZhcmlvdXMgaW5zdHJ1Y3Rpb25zCgpTaWduZWQt
b2ZmLWJ5OiBUYXlsb3IgU2ltcHNvbiA8dHNpbXBzb25AcXVpY2luYy5jb20+Ci0tLQogdGFyZ2V0
L2hleGFnb24vYXJjaC5jICAgICB8IDY2NCArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysKIHRhcmdldC9oZXhhZ29uL2FyY2guaCAgICAgfCAgNjIgKysrKwogdGFyZ2V0L2hleGFnb24v
Y29udl9lbXUuYyB8IDM3MCArKysrKysrKysrKysrKysrKysrCiB0YXJnZXQvaGV4YWdvbi9jb252
X2VtdS5oIHwgIDUwICsrKwogdGFyZ2V0L2hleGFnb24vZm1hX2VtdS5jICB8IDkxOCArKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiB0YXJnZXQvaGV4YWdvbi9m
bWFfZW11LmggIHwgIDMwICsrCiA2IGZpbGVzIGNoYW5nZWQsIDIwOTQgaW5zZXJ0aW9ucygrKQog
Y3JlYXRlIG1vZGUgMTAwNjQ0IHRhcmdldC9oZXhhZ29uL2FyY2guYwogY3JlYXRlIG1vZGUgMTAw
NjQ0IHRhcmdldC9oZXhhZ29uL2FyY2guaAogY3JlYXRlIG1vZGUgMTAwNjQ0IHRhcmdldC9oZXhh
Z29uL2NvbnZfZW11LmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCB0YXJnZXQvaGV4YWdvbi9jb252X2Vt
dS5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgdGFyZ2V0L2hleGFnb24vZm1hX2VtdS5jCiBjcmVhdGUg
bW9kZSAxMDA2NDQgdGFyZ2V0L2hleGFnb24vZm1hX2VtdS5oCgpkaWZmIC0tZ2l0IGEvdGFyZ2V0
L2hleGFnb24vYXJjaC5jIGIvdGFyZ2V0L2hleGFnb24vYXJjaC5jCm5ldyBmaWxlIG1vZGUgMTAw
NjQ0CmluZGV4IDAwMDAwMDAuLjJmMjJlNjAKLS0tIC9kZXYvbnVsbAorKysgYi90YXJnZXQvaGV4
YWdvbi9hcmNoLmMKQEAgLTAsMCArMSw2NjQgQEAKKy8qCisgKiAgQ29weXJpZ2h0IChjKSAyMDE5
IFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCisg
KgorICogIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0
ZSBpdCBhbmQvb3IgbW9kaWZ5CisgKiAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2Vu
ZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKKyAqICB0aGUgRnJlZSBTb2Z0d2Fy
ZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvcgorICogIChh
dCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisgKgorICogIFRoaXMgcHJvZ3JhbSBp
cyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICogIGJ1
dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5
IG9mCisgKiAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQ
T1NFLiAgU2VlIHRoZQorICogIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRl
dGFpbHMuCisgKgorICogIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdO
VSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCisgKiAgYWxvbmcgd2l0aCB0aGlzIHByb2dyYW07IGlm
IG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KKyAqLworCisjaW5jbHVk
ZSA8c3RkaW8uaD4KKyNpbmNsdWRlIDxtYXRoLmg+CisjaW5jbHVkZSAicWVtdS9vc2RlcC5oIgor
I2luY2x1ZGUgImZtYV9lbXUuaCIKKyNpbmNsdWRlICJhcmNoLmgiCisjaW5jbHVkZSAibWFjcm9z
LmgiCisKKy8qCisgKiBUaGVzZSB0aHJlZSB0YWJsZXMgYXJlIHVzZWQgYnkgdGhlIGNhYmFjZGVj
YmluIGluc3RydWN0aW9uCisgKi8KK3NpemUxdV90IHJMUFNfdGFibGVfNjR4NFs2NF1bNF0gPSB7
CisgICAgezEyOCwgMTc2LCAyMDgsIDI0MH0sCisgICAgezEyOCwgMTY3LCAxOTcsIDIyN30sCisg
ICAgezEyOCwgMTU4LCAxODcsIDIxNn0sCisgICAgezEyMywgMTUwLCAxNzgsIDIwNX0sCisgICAg
ezExNiwgMTQyLCAxNjksIDE5NX0sCisgICAgezExMSwgMTM1LCAxNjAsIDE4NX0sCisgICAgezEw
NSwgMTI4LCAxNTIsIDE3NX0sCisgICAgezEwMCwgMTIyLCAxNDQsIDE2Nn0sCisgICAgezk1LCAx
MTYsIDEzNywgMTU4fSwKKyAgICB7OTAsIDExMCwgMTMwLCAxNTB9LAorICAgIHs4NSwgMTA0LCAx
MjMsIDE0Mn0sCisgICAgezgxLCA5OSwgMTE3LCAxMzV9LAorICAgIHs3NywgOTQsIDExMSwgMTI4
fSwKKyAgICB7NzMsIDg5LCAxMDUsIDEyMn0sCisgICAgezY5LCA4NSwgMTAwLCAxMTZ9LAorICAg
IHs2NiwgODAsIDk1LCAxMTB9LAorICAgIHs2MiwgNzYsIDkwLCAxMDR9LAorICAgIHs1OSwgNzIs
IDg2LCA5OX0sCisgICAgezU2LCA2OSwgODEsIDk0fSwKKyAgICB7NTMsIDY1LCA3NywgODl9LAor
ICAgIHs1MSwgNjIsIDczLCA4NX0sCisgICAgezQ4LCA1OSwgNjksIDgwfSwKKyAgICB7NDYsIDU2
LCA2NiwgNzZ9LAorICAgIHs0MywgNTMsIDYzLCA3Mn0sCisgICAgezQxLCA1MCwgNTksIDY5fSwK
KyAgICB7MzksIDQ4LCA1NiwgNjV9LAorICAgIHszNywgNDUsIDU0LCA2Mn0sCisgICAgezM1LCA0
MywgNTEsIDU5fSwKKyAgICB7MzMsIDQxLCA0OCwgNTZ9LAorICAgIHszMiwgMzksIDQ2LCA1M30s
CisgICAgezMwLCAzNywgNDMsIDUwfSwKKyAgICB7MjksIDM1LCA0MSwgNDh9LAorICAgIHsyNywg
MzMsIDM5LCA0NX0sCisgICAgezI2LCAzMSwgMzcsIDQzfSwKKyAgICB7MjQsIDMwLCAzNSwgNDF9
LAorICAgIHsyMywgMjgsIDMzLCAzOX0sCisgICAgezIyLCAyNywgMzIsIDM3fSwKKyAgICB7MjEs
IDI2LCAzMCwgMzV9LAorICAgIHsyMCwgMjQsIDI5LCAzM30sCisgICAgezE5LCAyMywgMjcsIDMx
fSwKKyAgICB7MTgsIDIyLCAyNiwgMzB9LAorICAgIHsxNywgMjEsIDI1LCAyOH0sCisgICAgezE2
LCAyMCwgMjMsIDI3fSwKKyAgICB7MTUsIDE5LCAyMiwgMjV9LAorICAgIHsxNCwgMTgsIDIxLCAy
NH0sCisgICAgezE0LCAxNywgMjAsIDIzfSwKKyAgICB7MTMsIDE2LCAxOSwgMjJ9LAorICAgIHsx
MiwgMTUsIDE4LCAyMX0sCisgICAgezEyLCAxNCwgMTcsIDIwfSwKKyAgICB7MTEsIDE0LCAxNiwg
MTl9LAorICAgIHsxMSwgMTMsIDE1LCAxOH0sCisgICAgezEwLCAxMiwgMTUsIDE3fSwKKyAgICB7
MTAsIDEyLCAxNCwgMTZ9LAorICAgIHs5LCAxMSwgMTMsIDE1fSwKKyAgICB7OSwgMTEsIDEyLCAx
NH0sCisgICAgezgsIDEwLCAxMiwgMTR9LAorICAgIHs4LCA5LCAxMSwgMTN9LAorICAgIHs3LCA5
LCAxMSwgMTJ9LAorICAgIHs3LCA5LCAxMCwgMTJ9LAorICAgIHs3LCA4LCAxMCwgMTF9LAorICAg
IHs2LCA4LCA5LCAxMX0sCisgICAgezYsIDcsIDksIDEwfSwKKyAgICB7NiwgNywgOCwgOX0sCisg
ICAgezIsIDIsIDIsIDJ9Cit9OworCitzaXplMXVfdCBBQ19uZXh0X3N0YXRlX01QU182NFs2NF0g
PSB7CisgICAgMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOSwgMTAsCisgICAgMTEsIDEyLCAxMywg
MTQsIDE1LCAxNiwgMTcsIDE4LCAxOSwgMjAsCisgICAgMjEsIDIyLCAyMywgMjQsIDI1LCAyNiwg
MjcsIDI4LCAyOSwgMzAsCisgICAgMzEsIDMyLCAzMywgMzQsIDM1LCAzNiwgMzcsIDM4LCAzOSwg
NDAsCisgICAgNDEsIDQyLCA0MywgNDQsIDQ1LCA0NiwgNDcsIDQ4LCA0OSwgNTAsCisgICAgNTEs
IDUyLCA1MywgNTQsIDU1LCA1NiwgNTcsIDU4LCA1OSwgNjAsCisgICAgNjEsIDYyLCA2MiwgNjMK
K307CisKKworc2l6ZTF1X3QgQUNfbmV4dF9zdGF0ZV9MUFNfNjRbNjRdID0geworICAgIDAsIDAs
IDEsIDIsIDIsIDQsIDQsIDUsIDYsIDcsCisgICAgOCwgOSwgOSwgMTEsIDExLCAxMiwgMTMsIDEz
LCAxNSwgMTUsCisgICAgMTYsIDE2LCAxOCwgMTgsIDE5LCAxOSwgMjEsIDIxLCAyMiwgMjIsCisg
ICAgMjMsIDI0LCAyNCwgMjUsIDI2LCAyNiwgMjcsIDI3LCAyOCwgMjksCisgICAgMjksIDMwLCAz
MCwgMzAsIDMxLCAzMiwgMzIsIDMzLCAzMywgMzMsCisgICAgMzQsIDM0LCAzNSwgMzUsIDM1LCAz
NiwgMzYsIDM2LCAzNywgMzcsCisgICAgMzcsIDM4LCAzOCwgNjMKK307CisKK3NpemU0dV90IGZi
cmV2YWRkcihzaXplNHVfdCBwb2ludGVyKQoreworICAgIHNpemU0dV90IG9mZnNldCA9IHBvaW50
ZXIgJiAweGZmZmY7CisgICAgc2l6ZTR1X3QgYnJldm9mZnNldCA9IDA7CisgICAgaW50IGk7CisK
KyAgICBmb3IgKGkgPSAwOyBpIDwgMTY7IGkrKykgeworICAgICAgICBmU0VUQklUKGksIGJyZXZv
ZmZzZXQsIChmR0VUQklUKCgxNSAtIGkpLCBvZmZzZXQpKSk7CisgICAgfQorICAgIHJldHVybiAo
cG9pbnRlciAmIDB4ZmZmZjAwMDApIHwgYnJldm9mZnNldDsKK30KKworLyoKKyAqIENvdW50aW5n
IGJpdHMgc2V0LCBCcmlhbiBLZXJuaWdoYW4ncyB3YXkKKyAqIEJyaWFuIEtlcm5pZ2hhbidzIG1l
dGhvZCBnb2VzIHRocm91Z2ggYXMgbWFueSBpdGVyYXRpb25zIGFzIHRoZXJlIGFyZQorICogc2V0
IGJpdHMuIFNvIGlmIHdlIGhhdmUgYSAzMi1iaXQgd29yZCB3aXRoIG9ubHkgdGhlIGhpZ2ggYml0
IHNldCwKKyAqIHRoZW4gaXQgd2lsbCBvbmx5IGdvIG9uY2UgdGhyb3VnaCB0aGUgbG9vcC4KKyAq
Lworc2l6ZTR1X3QgY291bnRfb25lc18yKHNpemUydV90IHNyYykKK3sKKyAgICBpbnQgcmV0Owor
ICAgIGZvciAocmV0ID0gMDsgc3JjOyByZXQrKykgeworICAgICAgICBzcmMgJj0gc3JjIC0gMTsg
ICAgLyogY2xlYXIgdGhlIGxlYXN0IHNpZ25pZmljYW50IGJpdCBzZXQgKi8KKyAgICB9CisgICAg
cmV0dXJuIHJldDsKK30KKworIHNpemU0dV90IGNvdW50X29uZXNfNChzaXplNHVfdCBzcmMpCit7
CisgICAgaW50IHJldDsKKyAgICBmb3IgKHJldCA9IDA7IHNyYzsgcmV0KyspIHsKKyAgICAgICAg
c3JjICY9IHNyYyAtIDE7ICAgIC8qIGNsZWFyIHRoZSBsZWFzdCBzaWduaWZpY2FudCBiaXQgc2V0
ICovCisgICAgfQorICAgIHJldHVybiByZXQ7Cit9CisKK3NpemU0dV90IGNvdW50X29uZXNfOChz
aXplOHVfdCBzcmMpCit7CisgICAgaW50IHJldDsKKyAgICBmb3IgKHJldCA9IDA7IHNyYzsgcmV0
KyspIHsKKyAgICAgICAgc3JjICY9IHNyYyAtIDE7ICAgIC8qIGNsZWFyIHRoZSBsZWFzdCBzaWdu
aWZpY2FudCBiaXQgc2V0ICovCisgICAgfQorICAgIHJldHVybiByZXQ7Cit9CisKK3NpemU0dV90
IGNvdW50X2xlYWRpbmdfb25lc184KHNpemU4dV90IHNyYykKK3sKKyAgICBpbnQgcmV0OworICAg
IGZvciAocmV0ID0gMDsgc3JjICYgMHg4MDAwMDAwMDAwMDAwMDAwTEw7IHNyYyA8PD0gMSkgewor
ICAgICAgICByZXQrKzsKKyAgICB9CisgICAgcmV0dXJuIHJldDsKK30KKworCitzaXplNHVfdCBj
b3VudF9sZWFkaW5nX29uZXNfNChzaXplNHVfdCBzcmMpCit7CisgICAgaW50IHJldDsKKyAgICBm
b3IgKHJldCA9IDA7IHNyYyAmIDB4ODAwMDAwMDA7IHNyYyA8PD0gMSkgeworICAgICAgICByZXQr
KzsKKyAgICB9CisgICAgcmV0dXJuIHJldDsKK30KKworc2l6ZTR1X3QgY291bnRfbGVhZGluZ19v
bmVzXzIoc2l6ZTJ1X3Qgc3JjKQoreworICAgIGludCByZXQ7CisgICAgZm9yIChyZXQgPSAwOyBz
cmMgJiAweDgwMDA7IHNyYyA8PD0gMSkgeworICAgICAgICByZXQrKzsKKyAgICB9CisgICAgcmV0
dXJuIHJldDsKK30KKworc2l6ZTR1X3QgY291bnRfbGVhZGluZ19vbmVzXzEoc2l6ZTF1X3Qgc3Jj
KQoreworICAgIGludCByZXQ7CisgICAgZm9yIChyZXQgPSAwOyBzcmMgJiAweDgwOyBzcmMgPDw9
IDEpIHsKKyAgICAgICAgcmV0Kys7CisgICAgfQorICAgIHJldHVybiByZXQ7Cit9CisKKyNkZWZp
bmUgQklUU19NQVNLXzggMHg1NTU1NTU1NTU1NTU1NTU1VUxMCisjZGVmaW5lIFBBSVJfTUFTS184
IDB4MzMzMzMzMzMzMzMzMzMzM1VMTAorI2RlZmluZSBOWUJMX01BU0tfOCAweDBmMGYwZjBmMGYw
ZjBmMGZVTEwKKyNkZWZpbmUgQllURV9NQVNLXzggMHgwMGZmMDBmZjAwZmYwMGZmVUxMCisjZGVm
aW5lIEhBTEZfTUFTS184IDB4MDAwMGZmZmYwMDAwZmZmZlVMTAorI2RlZmluZSBXT1JEX01BU0tf
OCAweDAwMDAwMDAwZmZmZmZmZmZVTEwKKworc2l6ZTh1X3QgcmV2ZXJzZV9iaXRzXzgoc2l6ZTh1
X3Qgc3JjKQoreworICAgIHNyYyA9ICgoc3JjID4+IDEpICYgQklUU19NQVNLXzgpIHwgKChzcmMg
JiBCSVRTX01BU0tfOCkgPDwgMSk7CisgICAgc3JjID0gKChzcmMgPj4gMikgJiBQQUlSX01BU0tf
OCkgfCAoKHNyYyAmIFBBSVJfTUFTS184KSA8PCAyKTsKKyAgICBzcmMgPSAoKHNyYyA+PiA0KSAm
IE5ZQkxfTUFTS184KSB8ICgoc3JjICYgTllCTF9NQVNLXzgpIDw8IDQpOworICAgIHNyYyA9ICgo
c3JjID4+IDgpICYgQllURV9NQVNLXzgpIHwgKChzcmMgJiBCWVRFX01BU0tfOCkgPDwgOCk7Cisg
ICAgc3JjID0gKChzcmMgPj4gMTYpICYgSEFMRl9NQVNLXzgpIHwgKChzcmMgJiBIQUxGX01BU0tf
OCkgPDwgMTYpOworICAgIHNyYyA9ICgoc3JjID4+IDMyKSAmIFdPUkRfTUFTS184KSB8ICgoc3Jj
ICYgV09SRF9NQVNLXzgpIDw8IDMyKTsKKyAgICByZXR1cm4gc3JjOworfQorCisKKyNkZWZpbmUg
QklUU19NQVNLXzQgMHg1NTU1NTU1NVVMTAorI2RlZmluZSBQQUlSX01BU0tfNCAweDMzMzMzMzMz
VUxMCisjZGVmaW5lIE5ZQkxfTUFTS180IDB4MGYwZjBmMGZVTEwKKyNkZWZpbmUgQllURV9NQVNL
XzQgMHgwMGZmMDBmZlVMTAorI2RlZmluZSBIQUxGX01BU0tfNCAweDAwMDBmZmZmVUxMCisKK3Np
emU0dV90IHJldmVyc2VfYml0c180KHNpemU0dV90IHNyYykKK3sKKyAgICBzcmMgPSAoKHNyYyA+
PiAxKSAmIEJJVFNfTUFTS180KSB8ICgoc3JjICYgQklUU19NQVNLXzQpIDw8IDEpOworICAgIHNy
YyA9ICgoc3JjID4+IDIpICYgUEFJUl9NQVNLXzQpIHwgKChzcmMgJiBQQUlSX01BU0tfNCkgPDwg
Mik7CisgICAgc3JjID0gKChzcmMgPj4gNCkgJiBOWUJMX01BU0tfNCkgfCAoKHNyYyAmIE5ZQkxf
TUFTS180KSA8PCA0KTsKKyAgICBzcmMgPSAoKHNyYyA+PiA4KSAmIEJZVEVfTUFTS180KSB8ICgo
c3JjICYgQllURV9NQVNLXzQpIDw8IDgpOworICAgIHNyYyA9ICgoc3JjID4+IDE2KSAmIEhBTEZf
TUFTS180KSB8ICgoc3JjICYgSEFMRl9NQVNLXzQpIDw8IDE2KTsKKyAgICByZXR1cm4gc3JjOwor
fQorCisjZGVmaW5lIEJJVFNfTUFTS18yIDB4NTU1NVVMTAorI2RlZmluZSBQQUlSX01BU0tfMiAw
eDMzMzNVTEwKKyNkZWZpbmUgTllCTF9NQVNLXzIgMHgwZjBmVUxMCisjZGVmaW5lIEJZVEVfTUFT
S18yIDB4MDBmZlVMTAorI2RlZmluZSBIQUxGX01BU0tfMiAweDAwMDBVTEwKKworc2l6ZTR1X3Qg
cmV2ZXJzZV9iaXRzXzIoc2l6ZTJ1X3Qgc3JjKQoreworICAgIHNyYyA9ICgoc3JjID4+IDEpICYg
QklUU19NQVNLXzIpIHwgKChzcmMgJiBCSVRTX01BU0tfMikgPDwgMSk7CisgICAgc3JjID0gKChz
cmMgPj4gMikgJiBQQUlSX01BU0tfMikgfCAoKHNyYyAmIFBBSVJfTUFTS18yKSA8PCAyKTsKKyAg
ICBzcmMgPSAoKHNyYyA+PiA0KSAmIE5ZQkxfTUFTS18yKSB8ICgoc3JjICYgTllCTF9NQVNLXzIp
IDw8IDQpOworICAgIHNyYyA9ICgoc3JjID4+IDgpICYgQllURV9NQVNLXzIpIHwgKChzcmMgJiBC
WVRFX01BU0tfMikgPDwgOCk7CisgICAgcmV0dXJuIHNyYzsKK30KKworI2RlZmluZSBCSVRTX01B
U0tfMSAweDU1VUxMCisjZGVmaW5lIFBBSVJfTUFTS18xIDB4MzNVTEwKKyNkZWZpbmUgTllCTF9N
QVNLXzEgMHgwZlVMTAorI2RlZmluZSBCWVRFX01BU0tfMSAweDAwVUxMCisjZGVmaW5lIEhBTEZf
TUFTS18xIDB4MDBVTEwKKworc2l6ZTR1X3QgcmV2ZXJzZV9iaXRzXzEoc2l6ZTF1X3Qgc3JjKQor
eworICAgIHNyYyA9ICgoc3JjID4+IDEpICYgQklUU19NQVNLXzEpIHwgKChzcmMgJiBCSVRTX01B
U0tfMSkgPDwgMSk7CisgICAgc3JjID0gKChzcmMgPj4gMikgJiBQQUlSX01BU0tfMSkgfCAoKHNy
YyAmIFBBSVJfTUFTS18xKSA8PCAyKTsKKyAgICBzcmMgPSAoKHNyYyA+PiA0KSAmIE5ZQkxfTUFT
S18xKSB8ICgoc3JjICYgTllCTF9NQVNLXzEpIDw8IDQpOworICAgIHJldHVybiBzcmM7Cit9CisK
K3NpemU4dV90IGV4Y2hhbmdlKHNpemU4dV90IGJpdHMsIHNpemU0dV90IGNudHJsKQoreworICAg
IGludCBpOworICAgIHNpemU0dV90IG1hc2sgPSAxIDw8IDMxOworICAgIHNpemU4dV90IG1hc2sw
ID0gMHgxTEwgPDwgNjI7CisgICAgc2l6ZTh1X3QgbWFzazEgPSAweDJMTCA8PCA2MjsKKyAgICBz
aXplOHVfdCBvdXRiaXRzID0gMDsKKyAgICBzaXplOHVfdCBiMCwgYjE7CisKKyAgICBmb3IgKGkg
PSAwOyBpIDwgMzI7IGkrKykgeworICAgICAgICBiMCA9IChiaXRzICYgbWFzazApID4+ICgyICog
aSk7CisgICAgICAgIGIxID0gKGJpdHMgJiBtYXNrMSkgPj4gKDIgKiBpKTsKKyAgICAgICAgaWYg
KGNudHJsICYgbWFzaykgeworICAgICAgICAgICAgb3V0Yml0cyB8PSAoYjEgPj4gMSkgfCAoYjAg
PDwgMSk7CisgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICBvdXRiaXRzIHw9IChiMSB8IGIw
KTsKKyAgICAgICAgfQorICAgICAgICBvdXRiaXRzIDw8PSAyOworICAgICAgICBtYXNrID4+PSAx
OworICAgICAgICBtYXNrMCA+Pj0gMjsKKyAgICAgICAgbWFzazEgPj49IDI7CisgICAgfQorICAg
IHJldHVybiBvdXRiaXRzOworfQorCitzaXplOHVfdCBpbnRlcmxlYXZlKHNpemU0dV90IG9kZCwg
c2l6ZTR1X3QgZXZlbikKK3sKKyAgICAvKiBDb252ZXJ0IHRvIGxvbmcgbG9uZyAqLworICAgIHNp
emU4dV90IG15b2RkID0gb2RkOworICAgIHNpemU4dV90IG15ZXZlbiA9IGV2ZW47CisgICAgLyog
Rmlyc3QsIHNwcmVhZCBiaXRzIG91dCAqLworICAgIG15b2RkID0gKG15b2RkIHwgKG15b2RkIDw8
IDE2KSkgJiBIQUxGX01BU0tfODsKKyAgICBteWV2ZW4gPSAobXlldmVuIHwgKG15ZXZlbiA8PCAx
NikpICYgSEFMRl9NQVNLXzg7CisgICAgbXlvZGQgPSAobXlvZGQgfCAobXlvZGQgPDwgOCkpICYg
QllURV9NQVNLXzg7CisgICAgbXlldmVuID0gKG15ZXZlbiB8IChteWV2ZW4gPDwgOCkpICYgQllU
RV9NQVNLXzg7CisgICAgbXlvZGQgPSAobXlvZGQgfCAobXlvZGQgPDwgNCkpICYgTllCTF9NQVNL
Xzg7CisgICAgbXlldmVuID0gKG15ZXZlbiB8IChteWV2ZW4gPDwgNCkpICYgTllCTF9NQVNLXzg7
CisgICAgbXlvZGQgPSAobXlvZGQgfCAobXlvZGQgPDwgMikpICYgUEFJUl9NQVNLXzg7CisgICAg
bXlldmVuID0gKG15ZXZlbiB8IChteWV2ZW4gPDwgMikpICYgUEFJUl9NQVNLXzg7CisgICAgbXlv
ZGQgPSAobXlvZGQgfCAobXlvZGQgPDwgMSkpICYgQklUU19NQVNLXzg7CisgICAgbXlldmVuID0g
KG15ZXZlbiB8IChteWV2ZW4gPDwgMSkpICYgQklUU19NQVNLXzg7CisgICAgLyogTm93IE9SIHRv
Z2V0aGVyICovCisgICAgcmV0dXJuIG15ZXZlbiB8IChteW9kZCA8PCAxKTsKK30KKworc2l6ZTh1
X3QgZGVpbnRlcmxlYXZlKHNpemU4dV90IHNyYykKK3sKKyAgICAvKiBHZXQgb2RkIGFuZCBldmVu
IGJpdHMgKi8KKyAgICBzaXplOHVfdCBteW9kZCA9ICgoc3JjID4+IDEpICYgQklUU19NQVNLXzgp
OworICAgIHNpemU4dV90IG15ZXZlbiA9IChzcmMgJiBCSVRTX01BU0tfOCk7CisKKyAgICAvKiBV
bnNwcmVhZCBiaXRzICovCisgICAgbXlldmVuID0gKG15ZXZlbiB8IChteWV2ZW4gPj4gMSkpICYg
UEFJUl9NQVNLXzg7CisgICAgbXlvZGQgPSAobXlvZGQgfCAobXlvZGQgPj4gMSkpICYgUEFJUl9N
QVNLXzg7CisgICAgbXlldmVuID0gKG15ZXZlbiB8IChteWV2ZW4gPj4gMikpICYgTllCTF9NQVNL
Xzg7CisgICAgbXlvZGQgPSAobXlvZGQgfCAobXlvZGQgPj4gMikpICYgTllCTF9NQVNLXzg7Cisg
ICAgbXlldmVuID0gKG15ZXZlbiB8IChteWV2ZW4gPj4gNCkpICYgQllURV9NQVNLXzg7CisgICAg
bXlvZGQgPSAobXlvZGQgfCAobXlvZGQgPj4gNCkpICYgQllURV9NQVNLXzg7CisgICAgbXlldmVu
ID0gKG15ZXZlbiB8IChteWV2ZW4gPj4gOCkpICYgSEFMRl9NQVNLXzg7CisgICAgbXlvZGQgPSAo
bXlvZGQgfCAobXlvZGQgPj4gOCkpICYgSEFMRl9NQVNLXzg7CisgICAgbXlldmVuID0gKG15ZXZl
biB8IChteWV2ZW4gPj4gMTYpKSAmIFdPUkRfTUFTS184OworICAgIG15b2RkID0gKG15b2RkIHwg
KG15b2RkID4+IDE2KSkgJiBXT1JEX01BU0tfODsKKworICAgIC8qIFJldHVybiBvZGQgYml0cyBp
biB1cHBlciBoYWxmICovCisgICAgcmV0dXJuIG15ZXZlbiB8IChteW9kZCA8PCAzMik7Cit9CisK
K3NpemU0dV90IGNhcnJ5X2Zyb21fYWRkNjQoc2l6ZTh1X3QgYSwgc2l6ZTh1X3QgYiwgc2l6ZTR1
X3QgYykKK3sKKyAgICBzaXplOHVfdCB0bXBhLCB0bXBiLCB0bXBjOworICAgIHRtcGEgPSBmR0VU
VVdPUkQoMCwgYSk7CisgICAgdG1wYiA9IGZHRVRVV09SRCgwLCBiKTsKKyAgICB0bXBjID0gdG1w
YSArIHRtcGIgKyBjOworICAgIHRtcGEgPSBmR0VUVVdPUkQoMSwgYSk7CisgICAgdG1wYiA9IGZH
RVRVV09SRCgxLCBiKTsKKyAgICB0bXBjID0gdG1wYSArIHRtcGIgKyBmR0VUVVdPUkQoMSwgdG1w
Yyk7CisgICAgdG1wYyA9IGZHRVRVV09SRCgxLCB0bXBjKTsKKyAgICByZXR1cm4gdG1wYzsKK30K
Kworc2l6ZTRzX3QgY29udl9yb3VuZChzaXplNHNfdCBhLCBpbnQgbikKK3sKKyAgICBzaXplOHNf
dCB2YWw7CisKKyAgICBpZiAobiA9PSAwKSB7CisgICAgICAgIHZhbCA9IGE7CisgICAgfSBlbHNl
IGlmICgoYSAmICgoMSA8PCAobiAtIDEpKSAtIDEpKSA9PSAwKSB7ICAgIC8qIE4tMS4uMCBhbGwg
emVybz8gKi8KKyAgICAgICAgLyogQWRkIExTQiBmcm9tIGludCBwYXJ0ICovCisgICAgICAgIHZh
bCA9ICgoZlNFMzJfNjQoYSkpICsgKHNpemU4c190KSAoKChzaXplNHVfdCkgKCgxIDw8IG4pICYg
YSkpID4+IDEpKTsKKyAgICB9IGVsc2UgeworICAgICAgICB2YWwgPSAoKGZTRTMyXzY0KGEpKSAr
ICgxIDw8IChuIC0gMSkpKTsKKyAgICB9CisKKyAgICB2YWwgPSB2YWwgPj4gbjsKKyAgICByZXR1
cm4gKHNpemU0c190KXZhbDsKK30KKworc2l6ZTE2c190IGNhc3Q4c190b18xNnMoc2l6ZThzX3Qg
YSkKK3sKKyAgICBzaXplMTZzX3QgcmVzdWx0ID0gey5oaSA9IDAsIC5sbyA9IDB9OworICAgIHJl
c3VsdC5sbyA9IGE7CisgICAgaWYgKGEgPCAwKSB7CisgICAgICAgIHJlc3VsdC5oaSA9IC0xOwor
ICAgIH0KKyAgICByZXR1cm4gcmVzdWx0OworfQorCitzaXplOHNfdCBjYXN0MTZzX3RvXzhzKHNp
emUxNnNfdCBhKQoreworICAgIHJldHVybiBhLmxvOworfQorCitzaXplNHNfdCBjYXN0MTZzX3Rv
XzRzKHNpemUxNnNfdCBhKQoreworICAgIHJldHVybiAoc2l6ZTRzX3QpYS5sbzsKK30KKworc2l6
ZTE2c190IGFkZDEyOChzaXplMTZzX3QgYSwgc2l6ZTE2c190IGIpCit7CisgICAgc2l6ZTE2c190
IHJlc3VsdCA9IHsuaGkgPSAwLCAubG8gPSAwfTsKKyAgICByZXN1bHQubG8gPSBhLmxvICsgYi5s
bzsKKyAgICByZXN1bHQuaGkgPSBhLmhpICsgYi5oaTsKKworICAgIGlmIChyZXN1bHQubG8gPCBi
LmxvKSB7CisgICAgICAgIHJlc3VsdC5oaSsrOworICAgIH0KKworICAgIHJldHVybiByZXN1bHQ7
Cit9CisKK3NpemUxNnNfdCBzdWIxMjgoc2l6ZTE2c190IGEsIHNpemUxNnNfdCBiKQoreworICAg
IHNpemUxNnNfdCByZXN1bHQgPSB7LmhpID0gMCwgLmxvID0gMH07CisgICAgcmVzdWx0LmxvID0g
YS5sbyAtIGIubG87CisgICAgcmVzdWx0LmhpID0gYS5oaSAtIGIuaGk7CisgICAgaWYgKHJlc3Vs
dC5sbyA+IGEubG8pIHsKKyAgICAgICAgcmVzdWx0LmhpLS07CisgICAgfQorCisgICAgcmV0dXJu
IHJlc3VsdDsKK30KKworc2l6ZTE2c190IHNoaWZ0cjEyOChzaXplMTZzX3QgYSwgc2l6ZTR1X3Qg
bikKK3sKKyAgICBzaXplMTZzX3QgcmVzdWx0OworICAgIHJlc3VsdC5sbyA9IChhLmxvID4+IG4p
IHwgKGEuaGkgPDwgKDY0IC0gbikpOworICAgIHJlc3VsdC5oaSA9IGEuaGkgPj4gbjsKKyAgICBy
ZXR1cm4gcmVzdWx0OworfQorCitzaXplMTZzX3Qgc2hpZnRsMTI4KHNpemUxNnNfdCBhLCBzaXpl
NHVfdCBuKQoreworICAgIHNpemUxNnNfdCByZXN1bHQ7CisgICAgcmVzdWx0LmxvID0gYS5sbyA8
PCBuOworICAgIHJlc3VsdC5oaSA9IChhLmhpIDw8IG4pIHwgKGEubG8gPj4gKDY0IC0gbikpOwor
ICAgIHJldHVybiByZXN1bHQ7Cit9CisKK3NpemUxNnNfdCBhbmQxMjgoc2l6ZTE2c190IGEsIHNp
emUxNnNfdCBiKQoreworICAgIHNpemUxNnNfdCByZXN1bHQ7CisgICAgcmVzdWx0LmxvID0gYS5s
byAmIGIubG87CisgICAgcmVzdWx0LmhpID0gYS5oaSAmIGIuaGk7CisgICAgcmV0dXJuIHJlc3Vs
dDsKK30KKworLyogRmxvYXRpbmcgUG9pbnQgU3R1ZmYgKi8KKworc3RhdGljIGNvbnN0IGludCBy
b3VuZGluZ21vZGVzW10gPSB7CisgICAgRkVfVE9ORUFSRVNULAorICAgIEZFX1RPV0FSRFpFUk8s
CisgICAgRkVfRE9XTldBUkQsCisgICAgRkVfVVBXQVJECit9OworCit2b2lkIGFyY2hfZnBvcF9z
dGFydChDUFVIZXhhZ29uU3RhdGUgKmVudikKK3sKKyAgICBmZWdldGVudigmZW52LT5mZW52KTsK
KyAgICBmZWNsZWFyZXhjZXB0KEZFX0FMTF9FWENFUFQpOworICAgIGZlc2V0cm91bmQocm91bmRp
bmdtb2Rlc1tmUkVBRF9SRUdfRklFTEQoVVNSLCBVU1JfRlBSTkQpXSk7Cit9CisKKyNkZWZpbmUg
Tk9USElORyAgICAgICAgICAgICAvKiBEb24ndCBkbyBhbnl0aGluZyAqLworCisjZGVmaW5lIFRF
U1RfRkxBRyhMSUJDRiwgTVlGLCBNWUUpIFwKKyAgICBkbyB7IFwKKyAgICAgICAgaWYgKGZldGVz
dGV4Y2VwdChMSUJDRikpIHsgXAorICAgICAgICAgICAgaWYgKEdFVF9VU1JfRklFTEQoVVNSXyMj
TVlGKSA9PSAwKSB7IFwKKyAgICAgICAgICAgICAgICBTRVRfVVNSX0ZJRUxEKFVTUl8jI01ZRiwg
MSk7IFwKKyAgICAgICAgICAgICAgICBpZiAoR0VUX1VTUl9GSUVMRChVU1JfIyNNWUUpKSB7IFwK
KyAgICAgICAgICAgICAgICAgICAgTk9USElORyBcCisgICAgICAgICAgICAgICAgfSBcCisgICAg
ICAgICAgICB9IFwKKyAgICAgICAgfSBcCisgICAgfSB3aGlsZSAoMCkKKwordm9pZCBhcmNoX2Zw
b3BfZW5kKENQVUhleGFnb25TdGF0ZSAqZW52KQoreworICAgIGlmIChmZXRlc3RleGNlcHQoRkVf
QUxMX0VYQ0VQVCkpIHsKKyAgICAgICAgVEVTVF9GTEFHKEZFX0lORVhBQ1QsIEZQSU5QRiwgRlBJ
TlBFKTsKKyAgICAgICAgVEVTVF9GTEFHKEZFX0RJVkJZWkVSTywgRlBEQlpGLCBGUERCWkUpOwor
ICAgICAgICBURVNUX0ZMQUcoRkVfSU5WQUxJRCwgRlBJTlZGLCBGUElOVkUpOworICAgICAgICBU
RVNUX0ZMQUcoRkVfT1ZFUkZMT1csIEZQT1ZGRiwgRlBPVkZFKTsKKyAgICAgICAgVEVTVF9GTEFH
KEZFX1VOREVSRkxPVywgRlBVTkZGLCBGUFVORkUpOworICAgIH0KKyAgICBmZXNldGVudigmZW52
LT5mZW52KTsKK30KKworI3VuZGVmIFRFU1RfRkxBRworCisKK3ZvaWQgYXJjaF9yYWlzZV9mcGZs
YWcodW5zaWduZWQgaW50IGZsYWdzKQoreworICAgIGZlcmFpc2VleGNlcHQoZmxhZ3MpOworfQor
CitpbnQgYXJjaF9zZl9yZWNpcF9jb21tb24oc2l6ZTRzX3QgKlJzLCBzaXplNHNfdCAqUnQsIHNp
emU0c190ICpSZCwgaW50ICphZGp1c3QpCit7CisgICAgaW50IG5fY2xhc3M7CisgICAgaW50IGRf
Y2xhc3M7CisgICAgaW50IG5fZXhwOworICAgIGludCBkX2V4cDsKKyAgICBpbnQgcmV0ID0gMDsK
KyAgICBzaXplNHNfdCBSc1YsIFJ0ViwgUmRWOworICAgIGludCBQZVYgPSAwOworICAgIFJzViA9
ICpSczsKKyAgICBSdFYgPSAqUnQ7CisgICAgbl9jbGFzcyA9IGZwY2xhc3NpZnkoZkZMT0FUKFJz
VikpOworICAgIGRfY2xhc3MgPSBmcGNsYXNzaWZ5KGZGTE9BVChSdFYpKTsKKyAgICBpZiAoKG5f
Y2xhc3MgPT0gRlBfTkFOKSAmJiAoZF9jbGFzcyA9PSBGUF9OQU4pKSB7CisgICAgICAgIGlmIChm
R0VUQklUKDIyLCBSc1YgJiBSdFYpID09IDApIHsKKyAgICAgICAgICAgIGZSQUlTRUZMQUdTKEZF
X0lOVkFMSUQpOworICAgICAgICB9CisgICAgICAgIFJkViA9IFJzViA9IFJ0ViA9IGZTRk5BTlZB
TCgpOworICAgIH0gZWxzZSBpZiAobl9jbGFzcyA9PSBGUF9OQU4pIHsKKyAgICAgICAgaWYgKGZH
RVRCSVQoMjIsIFJzVikgPT0gMCkgeworICAgICAgICAgICAgZlJBSVNFRkxBR1MoRkVfSU5WQUxJ
RCk7CisgICAgICAgIH0KKyAgICAgICAgUmRWID0gUnNWID0gUnRWID0gZlNGTkFOVkFMKCk7Cisg
ICAgfSBlbHNlIGlmIChkX2NsYXNzID09IEZQX05BTikgeworICAgICAgICAvKiBFSlA6IG9yIHB1
dCBOYU4gaW4gbnVtL2RlbiBmaXh1cD8gKi8KKyAgICAgICAgaWYgKGZHRVRCSVQoMjIsIFJ0Vikg
PT0gMCkgeworICAgICAgICAgICAgZlJBSVNFRkxBR1MoRkVfSU5WQUxJRCk7CisgICAgICAgIH0K
KyAgICAgICAgUmRWID0gUnNWID0gUnRWID0gZlNGTkFOVkFMKCk7CisgICAgfSBlbHNlIGlmICgo
bl9jbGFzcyA9PSBGUF9JTkZJTklURSkgJiYgKGRfY2xhc3MgPT0gRlBfSU5GSU5JVEUpKSB7Cisg
ICAgICAgIC8qIEVKUDogb3IgcHV0IEluZiBpbiBudW0gZml4dXA/ICovCisgICAgICAgIFJkViA9
IFJzViA9IFJ0ViA9IGZTRk5BTlZBTCgpOworICAgICAgICBmUkFJU0VGTEFHUyhGRV9JTlZBTElE
KTsKKyAgICB9IGVsc2UgaWYgKChuX2NsYXNzID09IEZQX1pFUk8pICYmIChkX2NsYXNzID09IEZQ
X1pFUk8pKSB7CisgICAgICAgIC8qIEVKUDogb3IgcHV0IHplcm8gaW4gbnVtIGZpeHVwPyAqLwor
ICAgICAgICBSZFYgPSBSc1YgPSBSdFYgPSBmU0ZOQU5WQUwoKTsKKyAgICAgICAgZlJBSVNFRkxB
R1MoRkVfSU5WQUxJRCk7CisgICAgfSBlbHNlIGlmIChkX2NsYXNzID09IEZQX1pFUk8pIHsKKyAg
ICAgICAgLyogRUpQOiBvciBwdXQgSW5mIGluIG51bSBmaXh1cD8gKi8KKyAgICAgICAgUnNWID0g
ZlNGSU5GVkFMKFJzViBeIFJ0Vik7CisgICAgICAgIFJ0ViA9IGZTRk9ORVZBTCgwKTsKKyAgICAg
ICAgUmRWID0gZlNGT05FVkFMKDApOworICAgICAgICBpZiAobl9jbGFzcyAhPSBGUF9JTkZJTklU
RSkgeworICAgICAgICAgICAgZlJBSVNFRkxBR1MoRkVfRElWQllaRVJPKTsKKyAgICAgICAgfQor
ICAgIH0gZWxzZSBpZiAoZF9jbGFzcyA9PSBGUF9JTkZJTklURSkgeworICAgICAgICBSc1YgPSAw
eDgwMDAwMDAwICYgKFJzViBeIFJ0Vik7CisgICAgICAgIFJ0ViA9IGZTRk9ORVZBTCgwKTsKKyAg
ICAgICAgUmRWID0gZlNGT05FVkFMKDApOworICAgIH0gZWxzZSBpZiAobl9jbGFzcyA9PSBGUF9a
RVJPKSB7CisgICAgICAgIC8qIEVKUDogRG9lcyB0aGlzIGp1c3Qgd29yayBpdHNlbGYgb3V0PyAq
LworICAgICAgICAvKiBFSlA6IE5vLCAwL0luZiBjYXVzZXMgcHJvYmxlbXMuICovCisgICAgICAg
IFJzViA9IDB4ODAwMDAwMDAgJiAoUnNWIF4gUnRWKTsKKyAgICAgICAgUnRWID0gZlNGT05FVkFM
KDApOworICAgICAgICBSZFYgPSBmU0ZPTkVWQUwoMCk7CisgICAgfSBlbHNlIGlmIChuX2NsYXNz
ID09IEZQX0lORklOSVRFKSB7CisgICAgICAgIC8qIEVKUDogRG9lcyB0aGlzIGp1c3Qgd29yayBp
dHNlbGYgb3V0PyAqLworICAgICAgICBSc1YgPSBmU0ZJTkZWQUwoUnNWIF4gUnRWKTsKKyAgICAg
ICAgUnRWID0gZlNGT05FVkFMKDApOworICAgICAgICBSZFYgPSBmU0ZPTkVWQUwoMCk7CisgICAg
fSBlbHNlIHsKKyAgICAgICAgUGVWID0gMHgwMDsKKyAgICAgICAgLyogQmFzaWMgY2hlY2tzIHBh
c3NlZCAqLworICAgICAgICBuX2V4cCA9IGZTRl9HRVRFWFAoUnNWKTsKKyAgICAgICAgZF9leHAg
PSBmU0ZfR0VURVhQKFJ0Vik7CisgICAgICAgIGlmICgobl9leHAgLSBkX2V4cCArIGZTRl9CSUFT
KCkpIDw9IGZTRl9NQU5UQklUUygpKSB7CisgICAgICAgICAgICAvKiBOZWFyIHF1b3RpZW50IHVu
ZGVyZmxvdyAvIGluZXhhY3QgUSAqLworICAgICAgICAgICAgUGVWID0gMHg4MDsKKyAgICAgICAg
ICAgIFJ0ViA9IGZTRl9NVUxfUE9XMihSdFYsIC02NCk7CisgICAgICAgICAgICBSc1YgPSBmU0Zf
TVVMX1BPVzIoUnNWLCA2NCk7CisgICAgICAgIH0gZWxzZSBpZiAoKG5fZXhwIC0gZF9leHAgKyBm
U0ZfQklBUygpKSA+IChmU0ZfTUFYRVhQKCkgLSAyNCkpIHsKKyAgICAgICAgICAgIC8qIE5lYXIg
cXVvdGllbnQgb3ZlcmZsb3cgKi8KKyAgICAgICAgICAgIFBlViA9IDB4NDA7CisgICAgICAgICAg
ICBSdFYgPSBmU0ZfTVVMX1BPVzIoUnRWLCAzMik7CisgICAgICAgICAgICBSc1YgPSBmU0ZfTVVM
X1BPVzIoUnNWLCAtMzIpOworICAgICAgICB9IGVsc2UgaWYgKG5fZXhwIDw9IGZTRl9NQU5UQklU
UygpICsgMikgeworICAgICAgICAgICAgUnRWID0gZlNGX01VTF9QT1cyKFJ0ViwgNjQpOworICAg
ICAgICAgICAgUnNWID0gZlNGX01VTF9QT1cyKFJzViwgNjQpOworICAgICAgICB9IGVsc2UgaWYg
KGRfZXhwIDw9IDEpIHsKKyAgICAgICAgICAgIFJ0ViA9IGZTRl9NVUxfUE9XMihSdFYsIDMyKTsK
KyAgICAgICAgICAgIFJzViA9IGZTRl9NVUxfUE9XMihSc1YsIDMyKTsKKyAgICAgICAgfSBlbHNl
IGlmIChkX2V4cCA+IDI1MikgeworICAgICAgICAgICAgUnRWID0gZlNGX01VTF9QT1cyKFJ0Viwg
LTMyKTsKKyAgICAgICAgICAgIFJzViA9IGZTRl9NVUxfUE9XMihSc1YsIC0zMik7CisgICAgICAg
IH0KKyAgICAgICAgUmRWID0gMDsKKyAgICAgICAgcmV0ID0gMTsKKyAgICB9CisgICAgKlJzID0g
UnNWOworICAgICpSdCA9IFJ0VjsKKyAgICAqUmQgPSBSZFY7CisgICAgKmFkanVzdCA9IFBlVjsK
KyAgICByZXR1cm4gcmV0OworfQorCitpbnQgYXJjaF9zZl9pbnZzcXJ0X2NvbW1vbihzaXplNHNf
dCAqUnMsIHNpemU0c190ICpSZCwgaW50ICphZGp1c3QpCit7CisgICAgaW50IHJfY2xhc3M7Cisg
ICAgc2l6ZTRzX3QgUnNWLCBSZFY7CisgICAgaW50IFBlViA9IDA7CisgICAgaW50IHJfZXhwOwor
ICAgIGludCByZXQgPSAwOworICAgIFJzViA9ICpSczsKKyAgICByX2NsYXNzID0gZnBjbGFzc2lm
eShmRkxPQVQoUnNWKSk7CisgICAgaWYgKHJfY2xhc3MgPT0gRlBfTkFOKSB7CisgICAgICAgIGlm
IChmR0VUQklUKDIyLCBSc1YpID09IDApIHsKKyAgICAgICAgICAgIGZSQUlTRUZMQUdTKEZFX0lO
VkFMSUQpOworICAgICAgICB9CisgICAgICAgIFJkViA9IFJzViA9IGZTRk5BTlZBTCgpOworICAg
IH0gZWxzZSBpZiAoZkZMT0FUKFJzVikgPCAwLjApIHsKKyAgICAgICAgLyogTmVnYXRpdmUgbm9u
emVybyB2YWx1ZXMgYXJlIE5hTiAqLworICAgICAgICBmUkFJU0VGTEFHUyhGRV9JTlZBTElEKTsK
KyAgICAgICAgUnNWID0gZlNGTkFOVkFMKCk7CisgICAgICAgIFJkViA9IGZTRk5BTlZBTCgpOwor
ICAgIH0gZWxzZSBpZiAocl9jbGFzcyA9PSBGUF9JTkZJTklURSkgeworICAgICAgICAvKiBFSlA6
IG9yIHB1dCBJbmYgaW4gbnVtIGZpeHVwPyAqLworICAgICAgICBSc1YgPSBmU0ZJTkZWQUwoLTEp
OworICAgICAgICBSZFYgPSBmU0ZJTkZWQUwoLTEpOworICAgIH0gZWxzZSBpZiAocl9jbGFzcyA9
PSBGUF9aRVJPKSB7CisgICAgICAgIC8qIEVKUDogb3IgcHV0IHplcm8gaW4gbnVtIGZpeHVwPyAq
LworICAgICAgICBSc1YgPSBSc1Y7CisgICAgICAgIFJkViA9IGZTRk9ORVZBTCgwKTsKKyAgICB9
IGVsc2UgeworICAgICAgICBQZVYgPSAweDAwOworICAgICAgICAvKiBCYXNpYyBjaGVja3MgcGFz
c2VkICovCisgICAgICAgIHJfZXhwID0gZlNGX0dFVEVYUChSc1YpOworICAgICAgICBpZiAocl9l
eHAgPD0gMjQpIHsKKyAgICAgICAgICAgIFJzViA9IGZTRl9NVUxfUE9XMihSc1YsIDY0KTsKKyAg
ICAgICAgICAgIFBlViA9IDB4ZTA7CisgICAgICAgIH0KKyAgICAgICAgUmRWID0gMDsKKyAgICAg
ICAgcmV0ID0gMTsKKyAgICB9CisgICAgKlJzID0gUnNWOworICAgICpSZCA9IFJkVjsKKyAgICAq
YWRqdXN0ID0gUGVWOworICAgIHJldHVybiByZXQ7Cit9CisKK2ludCBhcmNoX3JlY2lwX2xvb2t1
cChpbnQgaW5kZXgpCit7CisgICAgaW5kZXggJj0gMHg3ZjsKKyAgICB1bnNpZ25lZCBjb25zdCBp
bnQgcm91bmRyb21bMTI4XSA9IHsKKyAgICAgICAgMHgwZmUsIDB4MGZhLCAweDBmNiwgMHgwZjIs
IDB4MGVmLCAweDBlYiwgMHgwZTcsIDB4MGU0LAorICAgICAgICAweDBlMCwgMHgwZGQsIDB4MGQ5
LCAweDBkNiwgMHgwZDIsIDB4MGNmLCAweDBjYywgMHgwYzksCisgICAgICAgIDB4MGM2LCAweDBj
MiwgMHgwYmYsIDB4MGJjLCAweDBiOSwgMHgwYjYsIDB4MGIzLCAweDBiMSwKKyAgICAgICAgMHgw
YWUsIDB4MGFiLCAweDBhOCwgMHgwYTUsIDB4MGEzLCAweDBhMCwgMHgwOWQsIDB4MDliLAorICAg
ICAgICAweDA5OCwgMHgwOTYsIDB4MDkzLCAweDA5MSwgMHgwOGUsIDB4MDhjLCAweDA4YSwgMHgw
ODcsCisgICAgICAgIDB4MDg1LCAweDA4MywgMHgwODAsIDB4MDdlLCAweDA3YywgMHgwN2EsIDB4
MDc4LCAweDA3NSwKKyAgICAgICAgMHgwNzMsIDB4MDcxLCAweDA2ZiwgMHgwNmQsIDB4MDZiLCAw
eDA2OSwgMHgwNjcsIDB4MDY1LAorICAgICAgICAweDA2MywgMHgwNjEsIDB4MDVmLCAweDA1ZSwg
MHgwNWMsIDB4MDVhLCAweDA1OCwgMHgwNTYsCisgICAgICAgIDB4MDU0LCAweDA1MywgMHgwNTEs
IDB4MDRmLCAweDA0ZSwgMHgwNGMsIDB4MDRhLCAweDA0OSwKKyAgICAgICAgMHgwNDcsIDB4MDQ1
LCAweDA0NCwgMHgwNDIsIDB4MDQwLCAweDAzZiwgMHgwM2QsIDB4MDNjLAorICAgICAgICAweDAz
YSwgMHgwMzksIDB4MDM3LCAweDAzNiwgMHgwMzQsIDB4MDMzLCAweDAzMiwgMHgwMzAsCisgICAg
ICAgIDB4MDJmLCAweDAyZCwgMHgwMmMsIDB4MDJiLCAweDAyOSwgMHgwMjgsIDB4MDI3LCAweDAy
NSwKKyAgICAgICAgMHgwMjQsIDB4MDIzLCAweDAyMSwgMHgwMjAsIDB4MDFmLCAweDAxZSwgMHgw
MWMsIDB4MDFiLAorICAgICAgICAweDAxYSwgMHgwMTksIDB4MDE3LCAweDAxNiwgMHgwMTUsIDB4
MDE0LCAweDAxMywgMHgwMTIsCisgICAgICAgIDB4MDExLCAweDAwZiwgMHgwMGUsIDB4MDBkLCAw
eDAwYywgMHgwMGIsIDB4MDBhLCAweDAwOSwKKyAgICAgICAgMHgwMDgsIDB4MDA3LCAweDAwNiwg
MHgwMDUsIDB4MDA0LCAweDAwMywgMHgwMDIsIDB4MDAwLAorICAgIH07CisgICAgcmV0dXJuIHJv
dW5kcm9tW2luZGV4XTsKK307CisKK2ludCBhcmNoX2ludnNxcnRfbG9va3VwKGludCBpbmRleCkK
K3sKKyAgICBpbmRleCAmPSAweDdmOworICAgIHVuc2lnbmVkIGNvbnN0IGludCByb3VuZHJvbVsx
MjhdID0geworICAgICAgICAweDA2OSwgMHgwNjYsIDB4MDYzLCAweDA2MSwgMHgwNWUsIDB4MDVi
LCAweDA1OSwgMHgwNTcsCisgICAgICAgIDB4MDU0LCAweDA1MiwgMHgwNTAsIDB4MDRkLCAweDA0
YiwgMHgwNDksIDB4MDQ3LCAweDA0NSwKKyAgICAgICAgMHgwNDMsIDB4MDQxLCAweDAzZiwgMHgw
M2QsIDB4MDNiLCAweDAzOSwgMHgwMzcsIDB4MDM2LAorICAgICAgICAweDAzNCwgMHgwMzIsIDB4
MDMwLCAweDAyZiwgMHgwMmQsIDB4MDJjLCAweDAyYSwgMHgwMjgsCisgICAgICAgIDB4MDI3LCAw
eDAyNSwgMHgwMjQsIDB4MDIyLCAweDAyMSwgMHgwMWYsIDB4MDFlLCAweDAxZCwKKyAgICAgICAg
MHgwMWIsIDB4MDFhLCAweDAxOSwgMHgwMTcsIDB4MDE2LCAweDAxNSwgMHgwMTQsIDB4MDEyLAor
ICAgICAgICAweDAxMSwgMHgwMTAsIDB4MDBmLCAweDAwZCwgMHgwMGMsIDB4MDBiLCAweDAwYSwg
MHgwMDksCisgICAgICAgIDB4MDA4LCAweDAwNywgMHgwMDYsIDB4MDA1LCAweDAwNCwgMHgwMDMs
IDB4MDAyLCAweDAwMSwKKyAgICAgICAgMHgwZmUsIDB4MGZhLCAweDBmNiwgMHgwZjMsIDB4MGVm
LCAweDBlYiwgMHgwZTgsIDB4MGU0LAorICAgICAgICAweDBlMSwgMHgwZGUsIDB4MGRiLCAweDBk
NywgMHgwZDQsIDB4MGQxLCAweDBjZSwgMHgwY2IsCisgICAgICAgIDB4MGM5LCAweDBjNiwgMHgw
YzMsIDB4MGMwLCAweDBiZSwgMHgwYmIsIDB4MGI4LCAweDBiNiwKKyAgICAgICAgMHgwYjMsIDB4
MGIxLCAweDBhZiwgMHgwYWMsIDB4MGFhLCAweDBhOCwgMHgwYTUsIDB4MGEzLAorICAgICAgICAw
eDBhMSwgMHgwOWYsIDB4MDlkLCAweDA5YiwgMHgwOTksIDB4MDk3LCAweDA5NSwgMHgwOTMsCisg
ICAgICAgIDB4MDkxLCAweDA4ZiwgMHgwOGQsIDB4MDhiLCAweDA4OSwgMHgwODcsIDB4MDg2LCAw
eDA4NCwKKyAgICAgICAgMHgwODIsIDB4MDgwLCAweDA3ZiwgMHgwN2QsIDB4MDdiLCAweDA3YSwg
MHgwNzgsIDB4MDc3LAorICAgICAgICAweDA3NSwgMHgwNzQsIDB4MDcyLCAweDA3MSwgMHgwNmYs
IDB4MDZlLCAweDA2YywgMHgwNmIsCisgICAgfTsKKyAgICByZXR1cm4gcm91bmRyb21baW5kZXhd
OworfTsKKwpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vYXJjaC5oIGIvdGFyZ2V0L2hleGFn
b24vYXJjaC5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLjY2NWE5N2YKLS0t
IC9kZXYvbnVsbAorKysgYi90YXJnZXQvaGV4YWdvbi9hcmNoLmgKQEAgLTAsMCArMSw2MiBAQAor
LyoKKyAqICBDb3B5cmlnaHQgKGMpIDIwMTkgUXVhbGNvbW0gSW5ub3ZhdGlvbiBDZW50ZXIsIElu
Yy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KKyAqCisgKiAgVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29m
dHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKKyAqICBpdCB1bmRl
ciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hl
ZCBieQorICogIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIg
b2YgdGhlIExpY2Vuc2UsIG9yCisgKiAgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lv
bi4KKyAqCisgKiAgVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQg
aXQgd2lsbCBiZSB1c2VmdWwsCisgKiAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0
IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAqICBNRVJDSEFOVEFCSUxJVFkgb3IgRklU
TkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCisgKiAgR05VIEdlbmVyYWwg
UHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKyAqCisgKiAgWW91IHNob3VsZCBoYXZl
IHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKKyAqICBh
bG9uZyB3aXRoIHRoaXMgcHJvZ3JhbTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9s
aWNlbnNlcy8+LgorICovCisKKyNpZm5kZWYgQVJDSF9ICisjZGVmaW5lIEFSQ0hfSAorCisjaW5j
bHVkZSAiY3B1LmgiCisjaW5jbHVkZSAiaGV4X2FyY2hfdHlwZXMuaCIKKworZXh0ZXJuIHNpemUx
dV90IHJMUFNfdGFibGVfNjR4NFs2NF1bNF07CitleHRlcm4gc2l6ZTF1X3QgQUNfbmV4dF9zdGF0
ZV9NUFNfNjRbNjRdOworZXh0ZXJuIHNpemUxdV90IEFDX25leHRfc3RhdGVfTFBTXzY0WzY0XTsK
KworZXh0ZXJuIHNpemU0dV90IGZicmV2YWRkcihzaXplNHVfdCBwb2ludGVyKTsKK2V4dGVybiBz
aXplNHVfdCBjb3VudF9vbmVzXzIoc2l6ZTJ1X3Qgc3JjKTsKK2V4dGVybiBzaXplNHVfdCBjb3Vu
dF9vbmVzXzQoc2l6ZTR1X3Qgc3JjKTsKK2V4dGVybiBzaXplNHVfdCBjb3VudF9vbmVzXzgoc2l6
ZTh1X3Qgc3JjKTsKK2V4dGVybiBzaXplNHVfdCBjb3VudF9sZWFkaW5nX29uZXNfOChzaXplOHVf
dCBzcmMpOworZXh0ZXJuIHNpemU0dV90IGNvdW50X2xlYWRpbmdfb25lc180KHNpemU0dV90IHNy
Yyk7CitleHRlcm4gc2l6ZTR1X3QgY291bnRfbGVhZGluZ19vbmVzXzIoc2l6ZTJ1X3Qgc3JjKTsK
K2V4dGVybiBzaXplNHVfdCBjb3VudF9sZWFkaW5nX29uZXNfMShzaXplMXVfdCBzcmMpOworZXh0
ZXJuIHNpemU4dV90IHJldmVyc2VfYml0c184KHNpemU4dV90IHNyYyk7CitleHRlcm4gc2l6ZTR1
X3QgcmV2ZXJzZV9iaXRzXzQoc2l6ZTR1X3Qgc3JjKTsKK2V4dGVybiBzaXplNHVfdCByZXZlcnNl
X2JpdHNfMihzaXplMnVfdCBzcmMpOworZXh0ZXJuIHNpemU0dV90IHJldmVyc2VfYml0c18xKHNp
emUxdV90IHNyYyk7CitleHRlcm4gc2l6ZTh1X3QgZXhjaGFuZ2Uoc2l6ZTh1X3QgYml0cywgc2l6
ZTR1X3QgY250cmwpOworZXh0ZXJuIHNpemU4dV90IGludGVybGVhdmUoc2l6ZTR1X3Qgb2RkLCBz
aXplNHVfdCBldmVuKTsKK2V4dGVybiBzaXplOHVfdCBkZWludGVybGVhdmUoc2l6ZTh1X3Qgc3Jj
KTsKK2V4dGVybiBzaXplNHVfdCBjYXJyeV9mcm9tX2FkZDY0KHNpemU4dV90IGEsIHNpemU4dV90
IGIsIHNpemU0dV90IGMpOworZXh0ZXJuIHNpemU0c190IGNvbnZfcm91bmQoc2l6ZTRzX3QgYSwg
aW50IG4pOworZXh0ZXJuIHNpemUxNnNfdCBjYXN0OHNfdG9fMTZzKHNpemU4c190IGEpOworZXh0
ZXJuIHNpemU4c190IGNhc3QxNnNfdG9fOHMoc2l6ZTE2c190IGEpOworZXh0ZXJuIHNpemU0c190
IGNhc3QxNnNfdG9fNHMoc2l6ZTE2c190IGEpOworZXh0ZXJuIHNpemUxNnNfdCBhZGQxMjgoc2l6
ZTE2c190IGEsIHNpemUxNnNfdCBiKTsKK2V4dGVybiBzaXplMTZzX3Qgc3ViMTI4KHNpemUxNnNf
dCBhLCBzaXplMTZzX3QgYik7CitleHRlcm4gc2l6ZTE2c190IHNoaWZ0cjEyOChzaXplMTZzX3Qg
YSwgc2l6ZTR1X3Qgbik7CitleHRlcm4gc2l6ZTE2c190IHNoaWZ0bDEyOChzaXplMTZzX3QgYSwg
c2l6ZTR1X3Qgbik7CitleHRlcm4gc2l6ZTE2c190IGFuZDEyOChzaXplMTZzX3QgYSwgc2l6ZTE2
c190IGIpOworZXh0ZXJuIHZvaWQgYXJjaF9mcG9wX3N0YXJ0KENQVUhleGFnb25TdGF0ZSAqZW52
KTsKK2V4dGVybiB2b2lkIGFyY2hfZnBvcF9lbmQoQ1BVSGV4YWdvblN0YXRlICplbnYpOworZXh0
ZXJuIHZvaWQgYXJjaF9yYWlzZV9mcGZsYWcodW5zaWduZWQgaW50IGZsYWdzKTsKK2V4dGVybiBp
bnQgYXJjaF9zZl9yZWNpcF9jb21tb24oc2l6ZTRzX3QgKlJzLCBzaXplNHNfdCAqUnQsIHNpemU0
c190ICpSZCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50ICphZGp1c3QpOwor
ZXh0ZXJuIGludCBhcmNoX3NmX2ludnNxcnRfY29tbW9uKHNpemU0c190ICpScywgc2l6ZTRzX3Qg
KlJkLCBpbnQgKmFkanVzdCk7CitleHRlcm4gaW50IGFyY2hfcmVjaXBfbG9va3VwKGludCBpbmRl
eCk7CitleHRlcm4gaW50IGFyY2hfaW52c3FydF9sb29rdXAoaW50IGluZGV4KTsKKworI2VuZGlm
CmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi9jb252X2VtdS5jIGIvdGFyZ2V0L2hleGFnb24v
Y29udl9lbXUuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi43OWMyODIzCi0t
LSAvZGV2L251bGwKKysrIGIvdGFyZ2V0L2hleGFnb24vY29udl9lbXUuYwpAQCAtMCwwICsxLDM3
MCBAQAorLyoKKyAqICBDb3B5cmlnaHQgKGMpIDIwMTkgUXVhbGNvbW0gSW5ub3ZhdGlvbiBDZW50
ZXIsIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KKyAqCisgKiAgVGhpcyBwcm9ncmFtIGlzIGZy
ZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKKyAqICBp
dCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1
Ymxpc2hlZCBieQorICogIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJz
aW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yCisgKiAgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIg
dmVyc2lvbi4KKyAqCisgKiAgVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3Bl
IHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisgKiAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3
aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAqICBNRVJDSEFOVEFCSUxJVFkg
b3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCisgKiAgR05VIEdl
bmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKyAqCisgKiAgWW91IHNob3Vs
ZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UK
KyAqICBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251
Lm9yZy9saWNlbnNlcy8+LgorICovCisKKyNpbmNsdWRlICJxZW11L29zZGVwLmgiCisjaW5jbHVk
ZSAiaGV4X2FyY2hfdHlwZXMuaCIKKyNpbmNsdWRlICJtYWNyb3MuaCIKKyNpbmNsdWRlIDxzdGRp
by5oPgorI2luY2x1ZGUgPG1hdGguaD4KKyNpbmNsdWRlICJjb252X2VtdS5oIgorCisjZGVmaW5l
IGlzeihYKSAoZnBjbGFzc2lmeShYKSA9PSBGUF9aRVJPKQorI2RlZmluZSBERl9CSUFTIDEwMjMK
KyNkZWZpbmUgU0ZfQklBUyAxMjcKKworI2RlZmluZSBMTF9NQVhfUE9TIDB4N2ZmZmZmZmZmZmZm
ZmZmZlVMTAorI2RlZmluZSBNQVhfUE9TIDB4N2ZmZmZmZmZVCisKKyNpZmRlZiBWQ1BQCisvKgor
ICogVmlzdWFsIEMgaXNuJ3QgR05VIEMgYW5kIGRvZXNuJ3QgaGF2ZSBfX2J1aWx0aW5fY2x6bGwK
KyAqLworCitzdGF0aWMgaW50IF9fYnVpbHRpbl9jbHpsbCh1bnNpZ25lZCBsb25nIGxvbmcgaW50
IGlucHV0KQoreworICAgIGludCB0b3RhbCA9IDA7CisgICAgaWYgKGlucHV0ID09IDApIHsKKyAg
ICAgICAgcmV0dXJuIDY0OworICAgIH0KKyAgICB0b3RhbCArPSAoKGlucHV0ID4+ICh0b3RhbCAr
IDMyKSkgIT0gMCkgPyAzMiA6IDA7CisgICAgdG90YWwgKz0gKChpbnB1dCA+PiAodG90YWwgKyAx
NikpICE9IDApID8gMTYgOiAwOworICAgIHRvdGFsICs9ICgoaW5wdXQgPj4gKHRvdGFsICsgIDgp
KSAhPSAwKSA/ICA4IDogMDsKKyAgICB0b3RhbCArPSAoKGlucHV0ID4+ICh0b3RhbCArICA0KSkg
IT0gMCkgPyAgNCA6IDA7CisgICAgdG90YWwgKz0gKChpbnB1dCA+PiAodG90YWwgKyAgMikpICE9
IDApID8gIDIgOiAwOworICAgIHRvdGFsICs9ICgoaW5wdXQgPj4gKHRvdGFsICsgIDEpKSAhPSAw
KSA/ICAxIDogMDsKKyAgICByZXR1cm4gNjMgLSB0b3RhbDsKK30KKyNlbmRpZgorCit0eXBlZGVm
IHVuaW9uIHsKKyAgICBkb3VibGUgZjsKKyAgICBzaXplOHVfdCBpOworICAgIHN0cnVjdCB7Cisg
ICAgICAgIHNpemU4dV90IG1hbnQ6NTI7CisgICAgICAgIHNpemU4dV90IGV4cDoxMTsKKyAgICAg
ICAgc2l6ZTh1X3Qgc2lnbjoxOworICAgIH0geDsKK30gZGZfdDsKKworCit0eXBlZGVmIHVuaW9u
IHsKKyAgICBmbG9hdCBmOworICAgIHNpemU0dV90IGk7CisgICAgc3RydWN0IHsKKyAgICAgICAg
c2l6ZTR1X3QgbWFudDoyMzsKKyAgICAgICAgc2l6ZTR1X3QgZXhwOjg7CisgICAgICAgIHNpemU0
dV90IHNpZ246MTsKKyAgICB9IHg7Cit9IHNmX3Q7CisKKworI2RlZmluZSBNQUtFX0NPTlZfOFVf
VE9fWEZfTihGTE9BVElELCBCSUdGTE9BVElELCBSRVRUWVBFKSBcCitzdGF0aWMgUkVUVFlQRSBj
b252Xzh1X3RvXyMjRkxPQVRJRCMjX24oc2l6ZTh1X3QgaW4sIGludCBuZWdhdGUpIFwKK3sgXAor
ICAgIEZMT0FUSUQjI190IHg7IFwKKyAgICBzaXplOHVfdCB0bXAsIHRydW5jYml0cywgc2hhbXQ7
IFwKKyAgICBpbnQgbGVhZGluZ196ZXJvczsgXAorICAgIGlmIChpbiA9PSAwKSB7IFwKKyAgICAg
ICAgcmV0dXJuIDAuMDsgXAorICAgIH0gXAorICAgIGxlYWRpbmdfemVyb3MgPSBfX2J1aWx0aW5f
Y2x6bGwoaW4pOyBcCisgICAgdG1wID0gaW4gPDwgKGxlYWRpbmdfemVyb3MpOyBcCisgICAgdG1w
IDw8PSAxOyBcCisgICAgc2hhbXQgPSA2NCAtIGYjI0JJR0ZMT0FUSUQjI19NQU5UQklUUygpOyBc
CisgICAgdHJ1bmNiaXRzID0gdG1wICYgKCgxVUxMIDw8IChzaGFtdCkpIC0gMSk7IFwKKyAgICB0
bXAgPj49IHNoYW10OyBcCisgICAgaWYgKHRydW5jYml0cyAhPSAwKSB7IFwKKyAgICAgICAgZmVy
YWlzZWV4Y2VwdChGRV9JTkVYQUNUKTsgXAorICAgICAgICBzd2l0Y2ggKGZlZ2V0cm91bmQoKSkg
eyBcCisgICAgICAgIGNhc2UgRkVfVE9XQVJEWkVSTzogXAorICAgICAgICAgICAgYnJlYWs7IFwK
KyAgICAgICAgY2FzZSBGRV9ET1dOV0FSRDogXAorICAgICAgICAgICAgaWYgKG5lZ2F0ZSkgeyBc
CisgICAgICAgICAgICAgICAgdG1wICs9IDE7IFwKKyAgICAgICAgICAgIH0gXAorICAgICAgICAg
ICAgYnJlYWs7IFwKKyAgICAgICAgY2FzZSBGRV9VUFdBUkQ6IFwKKyAgICAgICAgICAgIGlmICgh
bmVnYXRlKSB7IFwKKyAgICAgICAgICAgICAgICB0bXAgKz0gMTsgXAorICAgICAgICAgICAgfSBc
CisgICAgICAgICAgICBicmVhazsgXAorICAgICAgICBkZWZhdWx0OiBcCisgICAgICAgICAgICBp
ZiAoKHRydW5jYml0cyAmICgoMVVMTCA8PCAoc2hhbXQgLSAxKSkgLSAxKSkgPT0gMCkgeyBcCisg
ICAgICAgICAgICAgICAgdG1wICs9ICh0bXAgJiAxKTsgXAorICAgICAgICAgICAgfSBlbHNlIHsg
XAorICAgICAgICAgICAgICAgIHRtcCArPSAoKHRydW5jYml0cyA+PiAoc2hhbXQgLSAxKSkgJiAx
KTsgXAorICAgICAgICAgICAgfSBcCisgICAgICAgICAgICBicmVhazsgXAorICAgICAgICB9IFwK
KyAgICB9IFwKKyAgICBpZiAoKCh0bXAgPDwgc2hhbXQpID4+IHNoYW10KSAhPSB0bXApIHsgXAor
ICAgICAgICBsZWFkaW5nX3plcm9zLS07IFwKKyAgICB9IFwKKyAgICB4LngubWFudCA9IHRtcDsg
XAorICAgIHgueC5leHAgPSBCSUdGTE9BVElEIyNfQklBUyArIGYjI0JJR0ZMT0FUSUQjI19NQU5U
QklUUygpIC0gXAorICAgICAgICAgICAgICBsZWFkaW5nX3plcm9zICsgc2hhbXQgLSAxOyBcCisg
ICAgeC54LnNpZ24gPSBuZWdhdGU7IFwKKyAgICByZXR1cm4geC5mOyBcCit9CisKK01BS0VfQ09O
Vl84VV9UT19YRl9OKGRmLCBERiwgZG91YmxlKQorTUFLRV9DT05WXzhVX1RPX1hGX04oc2YsIFNG
LCBmbG9hdCkKKworZG91YmxlIGNvbnZfOHVfdG9fZGYoc2l6ZTh1X3QgaW4pCit7CisgICAgcmV0
dXJuIGNvbnZfOHVfdG9fZGZfbihpbiwgMCk7Cit9CisKK2RvdWJsZSBjb252XzhzX3RvX2RmKHNp
emU4c190IGluKQoreworICAgIGlmIChpbiA9PSAweDgwMDAwMDAwMDAwMDAwMDApIHsKKyAgICAg
ICAgcmV0dXJuIC0weDFwNjM7CisgICAgfQorICAgIGlmIChpbiA8IDApIHsKKyAgICAgICAgcmV0
dXJuIGNvbnZfOHVfdG9fZGZfbigtaW4sIDEpOworICAgIH0gZWxzZSB7CisgICAgICAgIHJldHVy
biBjb252Xzh1X3RvX2RmX24oaW4sIDApOworICAgIH0KK30KKworZG91YmxlIGNvbnZfNHVfdG9f
ZGYoc2l6ZTR1X3QgaW4pCit7CisgICAgcmV0dXJuIGNvbnZfOHVfdG9fZGYoKHNpemU4dV90KSBp
bik7Cit9CisKK2RvdWJsZSBjb252XzRzX3RvX2RmKHNpemU0c190IGluKQoreworICAgIHJldHVy
biBjb252XzhzX3RvX2RmKGluKTsKK30KKworZmxvYXQgY29udl84dV90b19zZihzaXplOHVfdCBp
bikKK3sKKyAgICByZXR1cm4gY29udl84dV90b19zZl9uKGluLCAwKTsKK30KKworZmxvYXQgY29u
dl84c190b19zZihzaXplOHNfdCBpbikKK3sKKyAgICBpZiAoaW4gPT0gMHg4MDAwMDAwMDAwMDAw
MDAwKSB7CisgICAgICAgIHJldHVybiAtMHgxcDYzOworICAgIH0KKyAgICBpZiAoaW4gPCAwKSB7
CisgICAgICAgIHJldHVybiBjb252Xzh1X3RvX3NmX24oLWluLCAxKTsKKyAgICB9IGVsc2Ugewor
ICAgICAgICByZXR1cm4gY29udl84dV90b19zZl9uKGluLCAwKTsKKyAgICB9Cit9CisKK2Zsb2F0
IGNvbnZfNHVfdG9fc2Yoc2l6ZTR1X3QgaW4pCit7CisgICAgcmV0dXJuIGNvbnZfOHVfdG9fc2Yo
aW4pOworfQorCitmbG9hdCBjb252XzRzX3RvX3NmKHNpemU0c190IGluKQoreworICAgIHJldHVy
biBjb252XzhzX3RvX3NmKGluKTsKK30KKworCitzdGF0aWMgc2l6ZTh1X3QgY29udl9kZl90b184
dV9uKGRvdWJsZSBpbiwgaW50IHdpbGxfbmVnYXRlKQoreworICAgIGRmX3QgeDsKKyAgICBpbnQg
ZnJhY3NoaWZ0LCBlbmRzaGlmdDsKKyAgICBzaXplOHVfdCB0bXAsIHRydW5jYml0czsKKyAgICB4
LmYgPSBpbjsKKyAgICBpZiAoaXNpbmYoaW4pKSB7CisgICAgICAgIGZlcmFpc2VleGNlcHQoRkVf
SU5WQUxJRCk7CisgICAgICAgIGlmIChpbiA+IDAuMCkgeworICAgICAgICAgICAgcmV0dXJuIH4w
VUxMOworICAgICAgICB9IGVsc2UgeworICAgICAgICAgICAgcmV0dXJuIDBVTEw7CisgICAgICAg
IH0KKyAgICB9CisgICAgaWYgKGlzbmFuKGluKSkgeworICAgICAgICBmZXJhaXNlZXhjZXB0KEZF
X0lOVkFMSUQpOworICAgICAgICByZXR1cm4gfjBVTEw7CisgICAgfQorICAgIGlmIChpc3ooaW4p
KSB7CisgICAgICAgIHJldHVybiAwOworICAgIH0KKyAgICBpZiAoeC54LnNpZ24pIHsKKyAgICAg
ICAgZmVyYWlzZWV4Y2VwdChGRV9JTlZBTElEKTsKKyAgICAgICAgcmV0dXJuIDA7CisgICAgfQor
ICAgIGlmIChpbiA8IDAuNSkgeworICAgICAgICAvKiBOZWFyIHplcm8sIGNhcHR1cmVzIGxhcmdl
IGZyYWNzaGlmdHMsIGRlbm9ybXMsIGV0YyAqLworICAgICAgICBmZXJhaXNlZXhjZXB0KEZFX0lO
RVhBQ1QpOworICAgICAgICBzd2l0Y2ggKGZlZ2V0cm91bmQoKSkgeworICAgICAgICBjYXNlIEZF
X0RPV05XQVJEOgorICAgICAgICAgICAgaWYgKHdpbGxfbmVnYXRlKSB7CisgICAgICAgICAgICAg
ICAgcmV0dXJuIDE7CisgICAgICAgICAgICB9IGVsc2UgeworICAgICAgICAgICAgICAgIHJldHVy
biAwOworICAgICAgICAgICAgfQorICAgICAgICBjYXNlIEZFX1VQV0FSRDoKKyAgICAgICAgICAg
IGlmICghd2lsbF9uZWdhdGUpIHsKKyAgICAgICAgICAgICAgICByZXR1cm4gMTsKKyAgICAgICAg
ICAgIH0gZWxzZSB7CisgICAgICAgICAgICAgICAgcmV0dXJuIDA7CisgICAgICAgICAgICB9Cisg
ICAgICAgIGRlZmF1bHQ6CisgICAgICAgICAgICByZXR1cm4gMDsgICAgLyogbmVhcmVzdCBvciB0
b3dhcmRzIHplcm8gKi8KKyAgICAgICAgfQorICAgIH0KKyAgICBpZiAoKHgueC5leHAgLSBERl9C
SUFTKSA+PSA2NCkgeworICAgICAgICAvKiB3YXkgdG9vIGJpZyAqLworICAgICAgICBmZXJhaXNl
ZXhjZXB0KEZFX0lOVkFMSUQpOworICAgICAgICByZXR1cm4gfjBVTEw7CisgICAgfQorICAgIGZy
YWNzaGlmdCA9IGZNQVgoMCwgKGZERl9NQU5UQklUUygpIC0gKHgueC5leHAgLSBERl9CSUFTKSkp
OworICAgIGVuZHNoaWZ0ID0gZk1BWCgwLCAoKHgueC5leHAgLSBERl9CSUFTIC0gZkRGX01BTlRC
SVRTKCkpKSk7CisgICAgdG1wID0geC54Lm1hbnQgfCAoMVVMTCA8PCBmREZfTUFOVEJJVFMoKSk7
CisgICAgdHJ1bmNiaXRzID0gdG1wICYgKCgxVUxMIDw8IGZyYWNzaGlmdCkgLSAxKTsKKyAgICB0
bXAgPj49IGZyYWNzaGlmdDsKKyAgICBpZiAodHJ1bmNiaXRzKSB7CisgICAgICAgIC8qIEFwcGx5
IFJvdW5kaW5nICovCisgICAgICAgIGZlcmFpc2VleGNlcHQoRkVfSU5FWEFDVCk7CisgICAgICAg
IHN3aXRjaCAoZmVnZXRyb3VuZCgpKSB7CisgICAgICAgIGNhc2UgRkVfVE9XQVJEWkVSTzoKKyAg
ICAgICAgICAgIGJyZWFrOworICAgICAgICBjYXNlIEZFX0RPV05XQVJEOgorICAgICAgICAgICAg
aWYgKHdpbGxfbmVnYXRlKSB7CisgICAgICAgICAgICAgICAgdG1wICs9IDE7CisgICAgICAgICAg
ICB9CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgY2FzZSBGRV9VUFdBUkQ6CisgICAgICAg
ICAgICBpZiAoIXdpbGxfbmVnYXRlKSB7CisgICAgICAgICAgICAgICAgdG1wICs9IDE7CisgICAg
ICAgICAgICB9CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgZGVmYXVsdDoKKyAgICAgICAg
ICAgIGlmICgodHJ1bmNiaXRzICYgKCgxVUxMIDw8IChmcmFjc2hpZnQgLSAxKSkgLSAxKSkgPT0g
MCkgeworICAgICAgICAgICAgICAgIC8qIEV4YWN0bHkgLjUgKi8KKyAgICAgICAgICAgICAgICB0
bXAgKz0gKHRtcCAmIDEpOworICAgICAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgICAgICB0
bXAgKz0gKCh0cnVuY2JpdHMgPj4gKGZyYWNzaGlmdCAtIDEpKSAmIDEpOworICAgICAgICAgICAg
fQorICAgICAgICB9CisgICAgfQorICAgIC8qCisgICAgICogSWYgd2UgYWRkZWQgb25lIGFuZCBp
dCBjYXJyaWVkIGFsbCB0aGUgd2F5IG91dCwKKyAgICAgKiBjaGVjayB0byBzZWUgaWYgb3ZlcmZs
b3cKKyAgICAgKi8KKyAgICBpZiAoKHRtcCAmICgoMVVMTCA8PCAoZkRGX01BTlRCSVRTKCkgKyAx
KSkgLSAxKSkgPT0gMCkgeworICAgICAgICBpZiAoKHgueC5leHAgLSBERl9CSUFTKSA9PSA2Mykg
eworICAgICAgICAgICAgZmVjbGVhcmV4Y2VwdChGRV9JTkVYQUNUKTsKKyAgICAgICAgICAgIGZl
cmFpc2VleGNlcHQoRkVfSU5WQUxJRCk7CisgICAgICAgICAgICByZXR1cm4gfjBVTEw7CisgICAg
ICAgIH0KKyAgICB9CisgICAgdG1wIDw8PSBlbmRzaGlmdDsKKyAgICByZXR1cm4gdG1wOworfQor
CitzdGF0aWMgc2l6ZTR1X3QgY29udl9kZl90b180dV9uKGRvdWJsZSBpbiwgaW50IHdpbGxfbmVn
YXRlKQoreworICAgIHNpemU4dV90IHRtcDsKKyAgICB0bXAgPSBjb252X2RmX3RvXzh1X24oaW4s
IHdpbGxfbmVnYXRlKTsKKyAgICBpZiAodG1wID4gMHgwMDAwMDAwMGZmZmZmZmZmVUxMKSB7Cisg
ICAgICAgIGZlY2xlYXJleGNlcHQoRkVfSU5FWEFDVCk7CisgICAgICAgIGZlcmFpc2VleGNlcHQo
RkVfSU5WQUxJRCk7CisgICAgICAgIHJldHVybiB+MFU7CisgICAgfQorICAgIHJldHVybiAoc2l6
ZTR1X3QpdG1wOworfQorCitzaXplOHVfdCBjb252X2RmX3RvXzh1KGRvdWJsZSBpbikKK3sKKyAg
ICByZXR1cm4gY29udl9kZl90b184dV9uKGluLCAwKTsKK30KKworc2l6ZTR1X3QgY29udl9kZl90
b180dShkb3VibGUgaW4pCit7CisgICAgcmV0dXJuIGNvbnZfZGZfdG9fNHVfbihpbiwgMCk7Cit9
CisKK3NpemU4c190IGNvbnZfZGZfdG9fOHMoZG91YmxlIGluKQoreworICAgIHNpemU4dV90IHRt
cDsKKyAgICBkZl90IHg7CisgICAgeC5mID0gaW47CisgICAgaWYgKGlzbmFuKGluKSkgeworICAg
ICAgICBmZXJhaXNlZXhjZXB0KEZFX0lOVkFMSUQpOworICAgICAgICByZXR1cm4gLTE7CisgICAg
fQorICAgIGlmICh4Lnguc2lnbikgeworICAgICAgICB0bXAgPSBjb252X2RmX3RvXzh1X24oLWlu
LCAxKTsKKyAgICB9IGVsc2UgeworICAgICAgICB0bXAgPSBjb252X2RmX3RvXzh1X24oaW4sIDAp
OworICAgIH0KKyAgICBpZiAodG1wID4gKExMX01BWF9QT1MgKyB4Lnguc2lnbikpIHsKKyAgICAg
ICAgZmVjbGVhcmV4Y2VwdChGRV9JTkVYQUNUKTsKKyAgICAgICAgZmVyYWlzZWV4Y2VwdChGRV9J
TlZBTElEKTsKKyAgICAgICAgdG1wID0gKExMX01BWF9QT1MgKyB4Lnguc2lnbik7CisgICAgfQor
ICAgIGlmICh4Lnguc2lnbikgeworICAgICAgICByZXR1cm4gLXRtcDsKKyAgICB9IGVsc2Ugewor
ICAgICAgICByZXR1cm4gdG1wOworICAgIH0KK30KKworc2l6ZTRzX3QgY29udl9kZl90b180cyhk
b3VibGUgaW4pCit7CisgICAgc2l6ZTh1X3QgdG1wOworICAgIGRmX3QgeDsKKyAgICB4LmYgPSBp
bjsKKyAgICBpZiAoaXNuYW4oaW4pKSB7CisgICAgICAgIGZlcmFpc2VleGNlcHQoRkVfSU5WQUxJ
RCk7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgaWYgKHgueC5zaWduKSB7CisgICAg
ICAgIHRtcCA9IGNvbnZfZGZfdG9fOHVfbigtaW4sIDEpOworICAgIH0gZWxzZSB7CisgICAgICAg
IHRtcCA9IGNvbnZfZGZfdG9fOHVfbihpbiwgMCk7CisgICAgfQorICAgIGlmICh0bXAgPiAoTUFY
X1BPUyArIHgueC5zaWduKSkgeworICAgICAgICBmZWNsZWFyZXhjZXB0KEZFX0lORVhBQ1QpOwor
ICAgICAgICBmZXJhaXNlZXhjZXB0KEZFX0lOVkFMSUQpOworICAgICAgICB0bXAgPSAoTUFYX1BP
UyArIHgueC5zaWduKTsKKyAgICB9CisgICAgaWYgKHgueC5zaWduKSB7CisgICAgICAgIHJldHVy
biAtdG1wOworICAgIH0gZWxzZSB7CisgICAgICAgIHJldHVybiB0bXA7CisgICAgfQorfQorCitz
aXplOHVfdCBjb252X3NmX3RvXzh1KGZsb2F0IGluKQoreworICAgIHJldHVybiBjb252X2RmX3Rv
Xzh1KGluKTsKK30KKworc2l6ZTR1X3QgY29udl9zZl90b180dShmbG9hdCBpbikKK3sKKyAgICBy
ZXR1cm4gY29udl9kZl90b180dShpbik7Cit9CisKK3NpemU4c190IGNvbnZfc2ZfdG9fOHMoZmxv
YXQgaW4pCit7CisgICAgcmV0dXJuIGNvbnZfZGZfdG9fOHMoaW4pOworfQorCitzaXplNHNfdCBj
b252X3NmX3RvXzRzKGZsb2F0IGluKQoreworICAgIHJldHVybiBjb252X2RmX3RvXzRzKGluKTsK
K30KKwpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vY29udl9lbXUuaCBiL3RhcmdldC9oZXhh
Z29uL2NvbnZfZW11LmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uYTVlZTIw
NgotLS0gL2Rldi9udWxsCisrKyBiL3RhcmdldC9oZXhhZ29uL2NvbnZfZW11LmgKQEAgLTAsMCAr
MSw1MCBAQAorLyoKKyAqICBDb3B5cmlnaHQgKGMpIDIwMTkgUXVhbGNvbW0gSW5ub3ZhdGlvbiBD
ZW50ZXIsIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KKyAqCisgKiAgVGhpcyBwcm9ncmFtIGlz
IGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKKyAq
ICBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFz
IHB1Ymxpc2hlZCBieQorICogIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2
ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yCisgKiAgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0
ZXIgdmVyc2lvbi4KKyAqCisgKiAgVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBo
b3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisgKiAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZ
OyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAqICBNRVJDSEFOVEFCSUxJ
VFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCisgKiAgR05V
IEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKyAqCisgKiAgWW91IHNo
b3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vu
c2UKKyAqICBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93d3cu
Z251Lm9yZy9saWNlbnNlcy8+LgorICovCisKKyNpZm5kZWYgQ09OVl9FTVVfSAorI2RlZmluZSBD
T05WX0VNVV9ICisKKyNpbmNsdWRlICJoZXhfYXJjaF90eXBlcy5oIgorCitleHRlcm4gc2l6ZTh1
X3QgY29udl9zZl90b184dShmbG9hdCBpbik7CitleHRlcm4gc2l6ZTR1X3QgY29udl9zZl90b180
dShmbG9hdCBpbik7CitleHRlcm4gc2l6ZThzX3QgY29udl9zZl90b184cyhmbG9hdCBpbik7Citl
eHRlcm4gc2l6ZTRzX3QgY29udl9zZl90b180cyhmbG9hdCBpbik7CisKK2V4dGVybiBzaXplOHVf
dCBjb252X2RmX3RvXzh1KGRvdWJsZSBpbik7CitleHRlcm4gc2l6ZTR1X3QgY29udl9kZl90b180
dShkb3VibGUgaW4pOworZXh0ZXJuIHNpemU4c190IGNvbnZfZGZfdG9fOHMoZG91YmxlIGluKTsK
K2V4dGVybiBzaXplNHNfdCBjb252X2RmX3RvXzRzKGRvdWJsZSBpbik7CisKK2V4dGVybiBkb3Vi
bGUgY29udl84dV90b19kZihzaXplOHVfdCBpbik7CitleHRlcm4gZG91YmxlIGNvbnZfNHVfdG9f
ZGYoc2l6ZTR1X3QgaW4pOworZXh0ZXJuIGRvdWJsZSBjb252XzhzX3RvX2RmKHNpemU4c190IGlu
KTsKK2V4dGVybiBkb3VibGUgY29udl80c190b19kZihzaXplNHNfdCBpbik7CisKK2V4dGVybiBm
bG9hdCBjb252Xzh1X3RvX3NmKHNpemU4dV90IGluKTsKK2V4dGVybiBmbG9hdCBjb252XzR1X3Rv
X3NmKHNpemU0dV90IGluKTsKK2V4dGVybiBmbG9hdCBjb252XzhzX3RvX3NmKHNpemU4c190IGlu
KTsKK2V4dGVybiBmbG9hdCBjb252XzRzX3RvX3NmKHNpemU0c190IGluKTsKKworZXh0ZXJuIGZs
b2F0IGNvbnZfZGZfdG9fc2YoZG91YmxlIGluKTsKKworc3RhdGljIGlubGluZSBkb3VibGUgY29u
dl9zZl90b19kZihmbG9hdCBpbikKK3sKKyAgICByZXR1cm4gaW47Cit9CisKKyNlbmRpZgpkaWZm
IC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vZm1hX2VtdS5jIGIvdGFyZ2V0L2hleGFnb24vZm1hX2Vt
dS5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLjkzY2FjMGQKLS0tIC9kZXYv
bnVsbAorKysgYi90YXJnZXQvaGV4YWdvbi9mbWFfZW11LmMKQEAgLTAsMCArMSw5MTggQEAKKy8q
CisgKiAgQ29weXJpZ2h0IChjKSAyMDE5IFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJbmMu
IEFsbCBSaWdodHMgUmVzZXJ2ZWQuCisgKgorICogIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3
YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CisgKiAgaXQgdW5kZXIg
dGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQg
YnkKKyAqICB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9m
IHRoZSBMaWNlbnNlLCBvcgorICogIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24u
CisgKgorICogIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0
IHdpbGwgYmUgdXNlZnVsLAorICogIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBl
dmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgKiAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5F
U1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQorICogIEdOVSBHZW5lcmFsIFB1
YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisgKgorICogIFlvdSBzaG91bGQgaGF2ZSBy
ZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCisgKiAgYWxv
bmcgd2l0aCB0aGlzIHByb2dyYW07IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGlj
ZW5zZXMvPi4KKyAqLworCisjaW5jbHVkZSAicWVtdS9vc2RlcC5oIgorCisjaW5jbHVkZSA8c3Rk
aW8uaD4KKyNpbmNsdWRlIDxtYXRoLmg+CisjaW5jbHVkZSAibWFjcm9zLmgiCisjaW5jbHVkZSAi
Y29udl9lbXUuaCIKKyNpbmNsdWRlICJmbWFfZW11LmgiCisKKyNkZWZpbmUgREZfSU5GX0VYUCAw
eDdmZgorI2RlZmluZSBERl9CSUFTIDEwMjMKKworI2RlZmluZSBTRl9JTkZfRVhQIDB4ZmYKKyNk
ZWZpbmUgU0ZfQklBUyAxMjcKKworI2RlZmluZSBIRl9JTkZfRVhQIDB4MWYKKyNkZWZpbmUgSEZf
QklBUyAxNQorCisjZGVmaW5lIFdBWV9CSUdfRVhQIDQwOTYKKworI2RlZmluZSBpc3ooWCkgKGZw
Y2xhc3NpZnkoWCkgPT0gRlBfWkVSTykKKworI2RlZmluZSBkZWJ1Z19mcHJpbnRmKC4uLikgICAg
Lyogbm90aGluZyAqLworCit0eXBlZGVmIHVuaW9uIHsKKyAgICBkb3VibGUgZjsKKyAgICBzaXpl
OHVfdCBpOworICAgIHN0cnVjdCB7CisgICAgICAgIHNpemU4dV90IG1hbnQ6NTI7CisgICAgICAg
IHNpemU4dV90IGV4cDoxMTsKKyAgICAgICAgc2l6ZTh1X3Qgc2lnbjoxOworICAgIH0geDsKK30g
ZGZfdDsKKwordHlwZWRlZiB1bmlvbiB7CisgICAgZmxvYXQgZjsKKyAgICBzaXplNHVfdCBpOwor
ICAgIHN0cnVjdCB7CisgICAgICAgIHNpemU0dV90IG1hbnQ6MjM7CisgICAgICAgIHNpemU0dV90
IGV4cDo4OworICAgICAgICBzaXplNHVfdCBzaWduOjE7CisgICAgfSB4OworfSBzZl90OworCit0
eXBlZGVmIHN0cnVjdCB7CisgICAgdW5pb24geworICAgICAgICBzaXplOHVfdCBsb3c7CisgICAg
ICAgIHN0cnVjdCB7CisgICAgICAgICAgICBzaXplNHVfdCB3MDsKKyAgICAgICAgICAgIHNpemU0
dV90IHcxOworICAgICAgICB9OworICAgIH07CisgICAgdW5pb24geworICAgICAgICBzaXplOHVf
dCBoaWdoOworICAgICAgICBzdHJ1Y3QgeworICAgICAgICAgICAgc2l6ZTR1X3QgdzM7CisgICAg
ICAgICAgICBzaXplNHVfdCB3MjsKKyAgICAgICAgfTsKKyAgICB9OworfSBpbnQxMjhfdDsKKwor
dHlwZWRlZiBzdHJ1Y3QgeworICAgIGludDEyOF90IG1hbnQ7CisgICAgc2l6ZTRzX3QgZXhwOwor
ICAgIHNpemUxdV90IHNpZ247CisgICAgc2l6ZTF1X3QgZ3VhcmQ7CisgICAgc2l6ZTF1X3Qgcm91
bmQ7CisgICAgc2l6ZTF1X3Qgc3RpY2t5OworfSB4Zl90OworCitzdGF0aWMgaW5saW5lIHZvaWQg
eGZfZGVidWcoY29uc3QgY2hhciAqbXNnLCB4Zl90IGEpCit7CisgICAgZGVidWdfZnByaW50Zihz
dGRvdXQsICIlcyAlYzB4JTAxNmxseF8lMDE2bGx4IC8lZC8lZC8lZCBwJWRcbiIsIG1zZywKKyAg
ICAgICAgICAgICAgICAgIGEuc2lnbiA/ICctJyA6ICcrJywgYS5tYW50LmhpZ2gsIGEubWFudC5s
b3csIGEuZ3VhcmQsCisgICAgICAgICAgICAgICAgICBhLnJvdW5kLCBhLnN0aWNreSwgYS5leHAp
OworfQorCitzdGF0aWMgaW5saW5lIHZvaWQgeGZfaW5pdCh4Zl90ICpwKQoreworICAgIHAtPm1h
bnQubG93ID0gMDsKKyAgICBwLT5tYW50LmhpZ2ggPSAwOworICAgIHAtPmV4cCA9IDA7CisgICAg
cC0+c2lnbiA9IDA7CisgICAgcC0+Z3VhcmQgPSAwOworICAgIHAtPnJvdW5kID0gMDsKKyAgICBw
LT5zdGlja3kgPSAwOworfQorCitzdGF0aWMgaW5saW5lIHNpemU4dV90IGRmX2dldG1hbnQoZGZf
dCBhKQoreworICAgIGludCBjbGFzcyA9IGZwY2xhc3NpZnkoYS5mKTsKKyAgICBzd2l0Y2ggKGNs
YXNzKSB7CisgICAgY2FzZSBGUF9OT1JNQUw6CisgICAgcmV0dXJuIGEueC5tYW50IHwgMVVMTCA8
PCA1MjsKKyAgICBjYXNlIEZQX1pFUk86CisgICAgICAgIHJldHVybiAwOworICAgIGNhc2UgRlBf
U1VCTk9STUFMOgorICAgICAgICByZXR1cm4gYS54Lm1hbnQ7CisgICAgZGVmYXVsdDoKKyAgICAg
ICAgcmV0dXJuIC0xOworICAgIH07Cit9CisKK3N0YXRpYyBpbmxpbmUgc2l6ZTRzX3QgZGZfZ2V0
ZXhwKGRmX3QgYSkKK3sKKyAgICBpbnQgY2xhc3MgPSBmcGNsYXNzaWZ5KGEuZik7CisgICAgc3dp
dGNoIChjbGFzcykgeworICAgIGNhc2UgRlBfTk9STUFMOgorICAgICAgICByZXR1cm4gYS54LmV4
cDsKKyAgICBjYXNlIEZQX1NVQk5PUk1BTDoKKyAgICAgICAgcmV0dXJuIGEueC5leHAgKyAxOwor
ICAgIGRlZmF1bHQ6CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9OworfQorCitzdGF0aWMgaW5s
aW5lIHNpemU4dV90IHNmX2dldG1hbnQoc2ZfdCBhKQoreworICAgIGludCBjbGFzcyA9IGZwY2xh
c3NpZnkoYS5mKTsKKyAgICBzd2l0Y2ggKGNsYXNzKSB7CisgICAgY2FzZSBGUF9OT1JNQUw6Cisg
ICAgICAgIHJldHVybiBhLngubWFudCB8IDFVTEwgPDwgMjM7CisgICAgY2FzZSBGUF9aRVJPOgor
ICAgICAgICByZXR1cm4gMDsKKyAgICBjYXNlIEZQX1NVQk5PUk1BTDoKKyAgICAgICAgcmV0dXJu
IGEueC5tYW50IHwgMFVMTDsKKyAgICBkZWZhdWx0OgorICAgICAgICByZXR1cm4gLTE7CisgICAg
fTsKK30KKworc3RhdGljIGlubGluZSBzaXplNHNfdCBzZl9nZXRleHAoc2ZfdCBhKQoreworICAg
IGludCBjbGFzcyA9IGZwY2xhc3NpZnkoYS5mKTsKKyAgICBzd2l0Y2ggKGNsYXNzKSB7CisgICAg
Y2FzZSBGUF9OT1JNQUw6CisgICAgICAgIHJldHVybiBhLnguZXhwOworICAgIGNhc2UgRlBfU1VC
Tk9STUFMOgorICAgICAgICByZXR1cm4gYS54LmV4cCArIDE7CisgICAgZGVmYXVsdDoKKyAgICAg
ICAgcmV0dXJuIC0xOworICAgIH07Cit9CisKK3N0YXRpYyBpbmxpbmUgaW50MTI4X3QgaW50MTI4
X211bF82NDY0KHNpemU4dV90IGFpLCBzaXplOHVfdCBiaSkKK3sKKyAgICBpbnQxMjhfdCByZXQ7
CisgICAgaW50MTI4X3QgYSwgYjsKKyAgICBzaXplOHVfdCBwcDAsIHBwMWEsIHBwMWIsIHBwMXMs
IHBwMjsKKworICAgIGRlYnVnX2ZwcmludGYoc3Rkb3V0LCAiYWkvYmk6IDB4JTAxNmxseC8weCUw
MTZsbHhcbiIsIGFpLCBiaSk7CisKKyAgICBhLmhpZ2ggPSBiLmhpZ2ggPSAwOworICAgIGEubG93
ID0gYWk7CisgICAgYi5sb3cgPSBiaTsKKyAgICBwcDAgPSAoc2l6ZTh1X3QpYS53MCAqIChzaXpl
OHVfdCliLncwOworICAgIHBwMWEgPSAoc2l6ZTh1X3QpYS53MSAqIChzaXplOHVfdCliLncwOwor
ICAgIHBwMWIgPSAoc2l6ZTh1X3QpYi53MSAqIChzaXplOHVfdClhLncwOworICAgIHBwMiA9IChz
aXplOHVfdClhLncxICogKHNpemU4dV90KWIudzE7CisKKyAgICBkZWJ1Z19mcHJpbnRmKHN0ZG91
dCwKKyAgICAgICAgICAgICAgICAgICJwcDIvMWIvMWEvMDogMHglMDE2bGx4LzB4JTAxNmxseC8w
eCUwMTZsbHgvMHglMDE2bGx4XG4iLAorICAgICAgICAgICAgICAgICAgcHAyLCBwcDFiLCBwcDFh
LCBwcDApOworCisgICAgcHAxcyA9IHBwMWEgKyBwcDFiOworICAgIGlmICgocHAxcyA8IHBwMWEp
IHx8IChwcDFzIDwgcHAxYikpIHsKKyAgICAgICAgcHAyICs9ICgxVUxMIDw8IDMyKTsKKyAgICB9
CisgICAgcmV0LmxvdyA9IHBwMCArIChwcDFzIDw8IDMyKTsKKyAgICBpZiAoKHJldC5sb3cgPCBw
cDApIHx8IChyZXQubG93IDwgKHBwMXMgPDwgMzIpKSkgeworICAgICAgICBwcDIgKz0gMTsKKyAg
ICB9CisgICAgcmV0LmhpZ2ggPSBwcDIgKyAocHAxcyA+PiAzMik7CisKKyAgICBkZWJ1Z19mcHJp
bnRmKHN0ZG91dCwKKyAgICAgICAgICAgICAgICAgICJwcDFzL3JldGhpL3JldGxvOiAweCUwMTZs
bHgvMHglMDE2bGx4LzB4JTAxNmxseFxuIiwKKyAgICAgICAgICAgICAgICAgIHBwMXMsIHJldC5o
aWdoLCByZXQubG93KTsKKworICAgIHJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbmxpbmUgaW50
MTI4X3QgaW50MTI4X3NobChpbnQxMjhfdCBhLCBzaXplNHVfdCBhbXQpCit7CisgICAgaW50MTI4
X3QgcmV0OworICAgIGlmIChhbXQgPT0gMCkgeworICAgICAgICByZXR1cm4gYTsKKyAgICB9Cisg
ICAgaWYgKGFtdCA+IDEyOCkgeworICAgICAgICByZXQuaGlnaCA9IDA7CisgICAgICAgIHJldC5s
b3cgPSAwOworICAgICAgICByZXR1cm4gcmV0OworICAgIH0KKyAgICBpZiAoYW10ID49IDY0KSB7
CisgICAgICAgIGFtdCAtPSA2NDsKKyAgICAgICAgYS5oaWdoID0gYS5sb3c7CisgICAgICAgIGEu
bG93ID0gMDsKKyAgICB9CisgICAgcmV0LmhpZ2ggPSBhLmhpZ2ggPDwgYW10OworICAgIHJldC5o
aWdoIHw9IChhLmxvdyA+PiAoNjQgLSBhbXQpKTsKKyAgICByZXQubG93ID0gYS5sb3cgPDwgYW10
OworICAgIHJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbmxpbmUgaW50MTI4X3QgaW50MTI4X3No
cihpbnQxMjhfdCBhLCBzaXplNHVfdCBhbXQpCit7CisgICAgaW50MTI4X3QgcmV0OworICAgIGlm
IChhbXQgPT0gMCkgeworICAgICAgICByZXR1cm4gYTsKKyAgICB9CisgICAgaWYgKGFtdCA+IDEy
OCkgeworICAgICAgICByZXQuaGlnaCA9IDA7CisgICAgICAgIHJldC5sb3cgPSAwOworICAgICAg
ICByZXR1cm4gcmV0OworICAgIH0KKyAgICBpZiAoYW10ID49IDY0KSB7CisgICAgICAgIGFtdCAt
PSA2NDsKKyAgICAgICAgYS5sb3cgPSBhLmhpZ2g7CisgICAgICAgIGEuaGlnaCA9IDA7CisgICAg
fQorICAgIHJldC5sb3cgPSBhLmxvdyA+PiBhbXQ7CisgICAgcmV0LmxvdyB8PSAoYS5oaWdoIDw8
ICg2NCAtIGFtdCkpOworICAgIHJldC5oaWdoID0gYS5oaWdoID4+IGFtdDsKKyAgICByZXR1cm4g
cmV0OworfQorCitzdGF0aWMgaW5saW5lIGludDEyOF90IGludDEyOF9hZGQoaW50MTI4X3QgYSwg
aW50MTI4X3QgYikKK3sKKyAgICBpbnQxMjhfdCByZXQ7CisgICAgcmV0LmxvdyA9IGEubG93ICsg
Yi5sb3c7CisgICAgaWYgKChyZXQubG93IDwgYS5sb3cpIHx8IChyZXQubG93IDwgYi5sb3cpKSB7
CisgICAgICAgIC8qIGNhcnJ5IGludG8gaGlnaCBwYXJ0ICovCisgICAgICAgIGEuaGlnaCArPSAx
OworICAgIH0KKyAgICByZXQuaGlnaCA9IGEuaGlnaCArIGIuaGlnaDsKKyAgICByZXR1cm4gcmV0
OworfQorCitzdGF0aWMgaW5saW5lIGludDEyOF90IGludDEyOF9zdWIoaW50MTI4X3QgYSwgaW50
MTI4X3QgYiwgaW50IGJvcnJvdykKK3sKKyAgICBpbnQxMjhfdCByZXQ7CisgICAgcmV0LmxvdyA9
IGEubG93IC0gYi5sb3c7CisgICAgaWYgKHJldC5sb3cgPiBhLmxvdykgeworICAgICAgICAvKiBi
b3Jyb3cgaW50byBoaWdoIHBhcnQgKi8KKyAgICAgICAgYS5oaWdoIC09IDE7CisgICAgfQorICAg
IHJldC5oaWdoID0gYS5oaWdoIC0gYi5oaWdoOworICAgIGlmIChib3Jyb3cgPT0gMCkgeworICAg
ICAgICByZXR1cm4gcmV0OworICAgIH0gZWxzZSB7CisgICAgICAgIGEuaGlnaCA9IDA7CisgICAg
ICAgIGEubG93ID0gMTsKKyAgICAgICAgcmV0dXJuIGludDEyOF9zdWIocmV0LCBhLCAwKTsKKyAg
ICB9Cit9CisKK3N0YXRpYyBpbmxpbmUgaW50IGludDEyOF9ndChpbnQxMjhfdCBhLCBpbnQxMjhf
dCBiKQoreworICAgIGlmIChhLmhpZ2ggPT0gYi5oaWdoKSB7CisgICAgICAgIHJldHVybiBhLmxv
dyA+IGIubG93OworICAgIH0KKyAgICByZXR1cm4gYS5oaWdoID4gYi5oaWdoOworfQorCitzdGF0
aWMgaW5saW5lIHhmX3QgeGZfbm9ybV9sZWZ0KHhmX3QgYSkKK3sKKyAgICBhLmV4cC0tOworICAg
IGEubWFudCA9IGludDEyOF9zaGwoYS5tYW50LCAxKTsKKyAgICBhLm1hbnQubG93IHw9IGEuZ3Vh
cmQ7CisgICAgYS5ndWFyZCA9IGEucm91bmQ7CisgICAgYS5yb3VuZCA9IGEuc3RpY2t5OworICAg
IHJldHVybiBhOworfQorCitzdGF0aWMgaW5saW5lIHhmX3QgeGZfbm9ybV9yaWdodCh4Zl90IGEs
IGludCBhbXQpCit7CisgICAgaWYgKGFtdCA+IDEzMCkgeworICAgICAgICBhLnN0aWNreSB8PQor
ICAgICAgICAgICAgYS5yb3VuZCB8IGEuZ3VhcmQgfCAoYS5tYW50LmxvdyAhPSAwKSB8IChhLm1h
bnQuaGlnaCAhPSAwKTsKKyAgICAgICAgYS5ndWFyZCA9IGEucm91bmQgPSBhLm1hbnQuaGlnaCA9
IGEubWFudC5sb3cgPSAwOworICAgICAgICBhLmV4cCArPSBhbXQ7CisgICAgICAgIHJldHVybiBh
OworCisgICAgfQorICAgIHdoaWxlIChhbXQgPj0gNjQpIHsKKyAgICAgICAgYS5zdGlja3kgfD0g
YS5yb3VuZCB8IGEuZ3VhcmQgfCAoYS5tYW50LmxvdyAhPSAwKTsKKyAgICAgICAgYS5ndWFyZCA9
IChhLm1hbnQubG93ID4+IDYzKSAmIDE7CisgICAgICAgIGEucm91bmQgPSAoYS5tYW50LmxvdyA+
PiA2MikgJiAxOworICAgICAgICBhLm1hbnQubG93ID0gYS5tYW50LmhpZ2g7CisgICAgICAgIGEu
bWFudC5oaWdoID0gMDsKKyAgICAgICAgYS5leHAgKz0gNjQ7CisgICAgICAgIGFtdCAtPSA2NDsK
KyAgICB9CisgICAgd2hpbGUgKGFtdCA+IDApIHsKKyAgICAgICAgYS5leHArKzsKKyAgICAgICAg
YS5zdGlja3kgfD0gYS5yb3VuZDsKKyAgICAgICAgYS5yb3VuZCA9IGEuZ3VhcmQ7CisgICAgICAg
IGEuZ3VhcmQgPSBhLm1hbnQubG93ICYgMTsKKyAgICAgICAgYS5tYW50ID0gaW50MTI4X3Nocihh
Lm1hbnQsIDEpOworICAgICAgICBhbXQtLTsKKyAgICB9CisgICAgcmV0dXJuIGE7Cit9CisKKwor
LyoKKyAqIE9uIHRoZSBhZGQvc3ViLCB3ZSBuZWVkIHRvIGJlIGFibGUgdG8gc2hpZnQgb3V0IGxv
dHMgb2YgYml0cywgYnV0IG5lZWQgYQorICogc3RpY2t5IGJpdCBmb3Igd2hhdCB3YXMgc2hpZnRl
ZCBvdXQsIEkgdGhpbmsuCisgKi8KK3N0YXRpYyB4Zl90IHhmX2FkZCh4Zl90IGEsIHhmX3QgYik7
CisKK3N0YXRpYyBpbmxpbmUgeGZfdCB4Zl9zdWIoeGZfdCBhLCB4Zl90IGIsIGludCBuZWdhdGUp
Cit7CisgICAgeGZfdCByZXQ7CisgICAgeGZfaW5pdCgmcmV0KTsKKyAgICBpbnQgYm9ycm93Owor
CisgICAgeGZfZGVidWcoIi0tPlN1Yi9hOiAiLCBhKTsKKyAgICB4Zl9kZWJ1ZygiLS0+U3ViL2I6
ICIsIGIpOworCisgICAgaWYgKGEuc2lnbiAhPSBiLnNpZ24pIHsKKyAgICAgICAgYi5zaWduID0g
IWIuc2lnbjsKKyAgICAgICAgcmV0dXJuIHhmX2FkZChhLCBiKTsKKyAgICB9CisgICAgaWYgKGIu
ZXhwID4gYS5leHApIHsKKyAgICAgICAgLyogc21hbGwgLSBiaWcgPT0gLSAoYmlnIC0gc21hbGwp
ICovCisgICAgICAgIHJldHVybiB4Zl9zdWIoYiwgYSwgIW5lZ2F0ZSk7CisgICAgfQorICAgIGlm
ICgoYi5leHAgPT0gYS5leHApICYmIChpbnQxMjhfZ3QoYi5tYW50LCBhLm1hbnQpKSkgeworICAg
ICAgICAvKiBzbWFsbCAtIGJpZyA9PSAtIChiaWcgLSBzbWFsbCkgKi8KKyAgICAgICAgcmV0dXJu
IHhmX3N1YihiLCBhLCAhbmVnYXRlKTsKKyAgICB9CisKKyAgICB4Zl9kZWJ1ZygiT0s6IFN1Yi9h
OiAiLCBhKTsKKyAgICB4Zl9kZWJ1ZygiT0s6IFN1Yi9iOiAiLCBiKTsKKworICAgIHdoaWxlIChh
LmV4cCA+IGIuZXhwKSB7CisgICAgICAgIC8qIFRyeSB0byBub3JtYWxpemUgZXhwb25lbnRzOiBz
aHJpbmsgYSBleHBvbmVudCBhbmQgZ3JvdyBtYW50aXNzYSAqLworICAgICAgICBpZiAoYS5tYW50
LmhpZ2ggJiAoMVVMTCA8PCA2MikpIHsKKyAgICAgICAgICAgIC8qIENhbid0IGdyb3cgYSBhbnkg
bW9yZSAqLworICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAg
ICBhID0geGZfbm9ybV9sZWZ0KGEpOworICAgICAgICB9CisgICAgfQorCisgICAgeGZfZGVidWco
Im5vcm1fbDogU3ViL2E6ICIsIGEpOworICAgIHhmX2RlYnVnKCJub3JtX2w6IFN1Yi9iOiAiLCBi
KTsKKworICAgIHdoaWxlIChhLmV4cCA+IGIuZXhwKSB7CisgICAgICAgIC8qIFRyeSB0byBub3Jt
YWxpemUgZXhwb25lbnRzOiBncm93IGIgZXhwb25lbnQgYW5kIHNocmluayBtYW50aXNzYSAqLwor
ICAgICAgICAvKiBLZWVwIGFyb3VuZCBzaGlmdGVkIG91dCBiaXRzLi4uIHdlIG1pZ2h0IG5lZWQg
dGhvc2UgbGF0ZXIgKi8KKyAgICAgICAgYiA9IHhmX25vcm1fcmlnaHQoYiwgYS5leHAgLSBiLmV4
cCk7CisgICAgfQorCisgICAgeGZfZGVidWcoIm5vcm1fcjogU3ViL2E6ICIsIGEpOworICAgIHhm
X2RlYnVnKCJub3JtX3I6IFN1Yi9iOiAiLCBiKTsKKworICAgIGlmICgoaW50MTI4X2d0KGIubWFu
dCwgYS5tYW50KSkpIHsKKyAgICAgICAgeGZfZGVidWcoInJldHJ5OiBTdWIvYTogIiwgYSk7Cisg
ICAgICAgIHhmX2RlYnVnKCJyZXRyeTogU3ViL2I6ICIsIGIpOworICAgICAgICByZXR1cm4geGZf
c3ViKGIsIGEsICFuZWdhdGUpOworICAgIH0KKworICAgIC8qIE9LLCBub3cgdGhpbmdzIHNob3Vs
ZCBiZSBub3JtYWxpemVkISAqLworICAgIHJldC5zaWduID0gYS5zaWduOworICAgIHJldC5leHAg
PSBhLmV4cDsKKyAgICBhc3NlcnQoIWludDEyOF9ndChiLm1hbnQsIGEubWFudCkpOworICAgIGJv
cnJvdyA9IChiLnJvdW5kIDw8IDIpIHwgKGIuZ3VhcmQgPDwgMSkgfCBiLnN0aWNreTsKKyAgICBy
ZXQubWFudCA9IGludDEyOF9zdWIoYS5tYW50LCBiLm1hbnQsIChib3Jyb3cgIT0gMCkpOworICAg
IGJvcnJvdyA9IDAgLSBib3Jyb3c7CisgICAgcmV0Lmd1YXJkID0gKGJvcnJvdyA+PiAyKSAmIDE7
CisgICAgcmV0LnJvdW5kID0gKGJvcnJvdyA+PiAxKSAmIDE7CisgICAgcmV0LnN0aWNreSA9IChi
b3Jyb3cgPj4gMCkgJiAxOworICAgIGlmIChuZWdhdGUpIHsKKyAgICAgICAgcmV0LnNpZ24gPSAh
cmV0LnNpZ247CisgICAgfQorICAgIHJldHVybiByZXQ7Cit9CisKK3N0YXRpYyB4Zl90IHhmX2Fk
ZCh4Zl90IGEsIHhmX3QgYikKK3sKKyAgICB4Zl90IHJldDsKKyAgICB4Zl9pbml0KCZyZXQpOwor
ICAgIHhmX2RlYnVnKCItLT5BZGQvYTogIiwgYSk7CisgICAgeGZfZGVidWcoIi0tPkFkZC9iOiAi
LCBiKTsKKyAgICBpZiAoYS5zaWduICE9IGIuc2lnbikgeworICAgICAgICBiLnNpZ24gPSAhYi5z
aWduOworICAgICAgICByZXR1cm4geGZfc3ViKGEsIGIsIDApOworICAgIH0KKyAgICBpZiAoYi5l
eHAgPiBhLmV4cCkgeworICAgICAgICAvKiBzbWFsbCArIGJpZyA9PSAgKGJpZyArIHNtYWxsKSAq
LworICAgICAgICByZXR1cm4geGZfYWRkKGIsIGEpOworICAgIH0KKyAgICBpZiAoKGIuZXhwID09
IGEuZXhwKSAmJiBpbnQxMjhfZ3QoYi5tYW50LCBhLm1hbnQpKSB7CisgICAgICAgIC8qIHNtYWxs
ICsgYmlnID09ICAoYmlnICsgc21hbGwpICovCisgICAgICAgIHJldHVybiB4Zl9hZGQoYiwgYSk7
CisgICAgfQorCisgICAgeGZfZGVidWcoIk9LPyBBZGQvYTogIiwgYSk7CisgICAgeGZfZGVidWco
Ik9LPyBBZGQvYjogIiwgYik7CisKKyAgICB3aGlsZSAoYS5leHAgPiBiLmV4cCkgeworICAgICAg
ICAvKiBUcnkgdG8gbm9ybWFsaXplIGV4cG9uZW50czogc2hyaW5rIGEgZXhwb25lbnQgYW5kIGdy
b3cgbWFudGlzc2EgKi8KKyAgICAgICAgaWYgKGEubWFudC5oaWdoICYgKDFVTEwgPDwgNjIpKSB7
CisgICAgICAgICAgICAvKiBDYW4ndCBncm93IGEgYW55IG1vcmUgKi8KKyAgICAgICAgICAgIGJy
ZWFrOworICAgICAgICB9IGVsc2UgeworICAgICAgICAgICAgYSA9IHhmX25vcm1fbGVmdChhKTsK
KyAgICAgICAgfQorICAgIH0KKworICAgIHhmX2RlYnVnKCJub3JtX2w6IEFkZC9hOiAiLCBhKTsK
KyAgICB4Zl9kZWJ1Zygibm9ybV9sOiBBZGQvYjogIiwgYik7CisKKyAgICB3aGlsZSAoYS5leHAg
PiBiLmV4cCkgeworICAgICAgICAvKiBUcnkgdG8gbm9ybWFsaXplIGV4cG9uZW50czogZ3JvdyBi
IGV4cG9uZW50IGFuZCBzaHJpbmsgbWFudGlzc2EgKi8KKyAgICAgICAgLyogS2VlcCBhcm91bmQg
c2hpZnRlZCBvdXQgYml0cy4uLiB3ZSBtaWdodCBuZWVkIHRob3NlIGxhdGVyICovCisgICAgICAg
IGIgPSB4Zl9ub3JtX3JpZ2h0KGIsIGEuZXhwIC0gYi5leHApOworICAgIH0KKworICAgIHhmX2Rl
YnVnKCJub3JtX3I6IEFkZC9hOiAiLCBhKTsKKyAgICB4Zl9kZWJ1Zygibm9ybV9yOiBBZGQvYjog
IiwgYik7CisKKyAgICAvKiBPSywgbm93IHRoaW5ncyBzaG91bGQgYmUgbm9ybWFsaXplZCEgKi8K
KyAgICBpZiAoaW50MTI4X2d0KGIubWFudCwgYS5tYW50KSkgeworICAgICAgICB4Zl9kZWJ1Zygi
cmV0cnk6IEFkZC9hOiAiLCBhKTsKKyAgICAgICAgeGZfZGVidWcoInJldHJ5OiBBZGQvYjogIiwg
Yik7CisgICAgICAgIHJldHVybiB4Zl9hZGQoYiwgYSk7CisgICAgfTsKKyAgICByZXQuc2lnbiA9
IGEuc2lnbjsKKyAgICByZXQuZXhwID0gYS5leHA7CisgICAgYXNzZXJ0KCFpbnQxMjhfZ3QoYi5t
YW50LCBhLm1hbnQpKTsKKyAgICByZXQubWFudCA9IGludDEyOF9hZGQoYS5tYW50LCBiLm1hbnQp
OworICAgIHJldC5ndWFyZCA9IGIuZ3VhcmQ7CisgICAgcmV0LnJvdW5kID0gYi5yb3VuZDsKKyAg
ICByZXQuc3RpY2t5ID0gYi5zdGlja3k7CisgICAgcmV0dXJuIHJldDsKK30KKworLyogUmV0dXJu
IGFuIGluZmluaXR5IHdpdGggdGhlIHNhbWUgc2lnbiBhcyBhICovCitzdGF0aWMgaW5saW5lIGRm
X3QgaW5maW5pdGVfZGZfdCh4Zl90IGEpCit7CisgICAgZGZfdCByZXQ7CisgICAgcmV0Lnguc2ln
biA9IGEuc2lnbjsKKyAgICByZXQueC5leHAgPSBERl9JTkZfRVhQOworICAgIHJldC54Lm1hbnQg
PSAwVUxMOworICAgIHJldHVybiByZXQ7Cit9CisKKy8qIFJldHVybiBhIG1heGltdW0gZmluaXRl
IHZhbHVlIHdpdGggdGhlIHNhbWUgc2lnbiBhcyBhICovCitzdGF0aWMgaW5saW5lIGRmX3QgbWF4
ZmluaXRlX2RmX3QoeGZfdCBhKQoreworICAgIGRmX3QgcmV0OworICAgIHJldC54LnNpZ24gPSBh
LnNpZ247CisgICAgcmV0LnguZXhwID0gREZfSU5GX0VYUCAtIDE7CisgICAgcmV0LngubWFudCA9
IDB4MDAwZmZmZmZmZmZmZmZmZlVMTDsKKyAgICByZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW5s
aW5lIGRmX3QgZjJkZl90KGRvdWJsZSBpbikKK3sKKyAgICBkZl90IHJldDsKKyAgICByZXQuZiA9
IGluOworICAgIHJldHVybiByZXQ7Cit9CisKKy8qIFJldHVybiBhbiBpbmZpbml0eSB3aXRoIHRo
ZSBzYW1lIHNpZ24gYXMgYSAqLworc3RhdGljIGlubGluZSBzZl90IGluZmluaXRlX3NmX3QoeGZf
dCBhKQoreworICAgIHNmX3QgcmV0OworICAgIHJldC54LnNpZ24gPSBhLnNpZ247CisgICAgcmV0
LnguZXhwID0gU0ZfSU5GX0VYUDsKKyAgICByZXQueC5tYW50ID0gMFVMTDsKKyAgICByZXR1cm4g
cmV0OworfQorCisvKiBSZXR1cm4gYSBtYXhpbXVtIGZpbml0ZSB2YWx1ZSB3aXRoIHRoZSBzYW1l
IHNpZ24gYXMgYSAqLworc3RhdGljIGlubGluZSBzZl90IG1heGZpbml0ZV9zZl90KHhmX3QgYSkK
K3sKKyAgICBzZl90IHJldDsKKyAgICByZXQueC5zaWduID0gYS5zaWduOworICAgIHJldC54LmV4
cCA9IFNGX0lORl9FWFAgLSAxOworICAgIHJldC54Lm1hbnQgPSAweDAwN2ZmZmZmVUw7CisgICAg
cmV0dXJuIHJldDsKK30KKworc3RhdGljIGlubGluZSBzZl90IGYyc2ZfdChmbG9hdCBpbikKK3sK
KyAgICBzZl90IHJldDsKKyAgICByZXQuZiA9IGluOworICAgIHJldHVybiByZXQ7Cit9CisKKyNk
ZWZpbmUgR0VOX1hGX1JPVU5EKFRZUEUsIE1BTlRCSVRTLCBJTkZfRVhQKSBcCitzdGF0aWMgaW5s
aW5lIFRZUEUgeGZfcm91bmRfIyNUWVBFKHhmX3QgYSkgXAoreyBcCisgICAgVFlQRSByZXQ7IFwK
KyAgICByZXQuaSA9IDA7IFwKKyAgICByZXQueC5zaWduID0gYS5zaWduOyBcCisgICAgaWYgKChh
Lm1hbnQuaGlnaCA9PSAwKSAmJiAoYS5tYW50LmxvdyA9PSAwKSBcCisgICAgICAgICYmICgoYS5n
dWFyZCB8IGEucm91bmQgfCBhLnN0aWNreSkgPT0gMCkpIHsgXAorICAgICAgICAvKiByZXN1bHQg
emVybyAqLyBcCisgICAgICAgIHN3aXRjaCAoZmVnZXRyb3VuZCgpKSB7IFwKKyAgICAgICAgY2Fz
ZSBGRV9ET1dOV0FSRDogXAorICAgICAgICAgICAgcmV0dXJuIGYyIyNUWVBFKC0wLjApOyBcCisg
ICAgICAgIGRlZmF1bHQ6IFwKKyAgICAgICAgICAgIHJldHVybiBmMiMjVFlQRSgwLjApOyBcCisg
ICAgICAgIH0gXAorICAgIH0gXAorICAgIC8qIE5vcm1hbGl6ZSByaWdodCAqLyBcCisgICAgLyog
V2Ugd2FudCBNQU5UQklUUyBiaXRzIG9mIG1hbnRpc3NhIHBsdXMgdGhlIGxlYWRpbmcgb25lLiAq
LyBcCisgICAgLyogVGhhdCBtZWFucyB0aGF0IHdlIHdhbnQgTUFOVEJJVFMrMSBiaXRzLCBvciAw
eDAwMDAwMDAwMDAwMEZGX0ZGRkYgKi8gXAorICAgIC8qIFNvIHdlIG5lZWQgdG8gbm9ybWFsaXpl
IHJpZ2h0IHdoaWxlIHRoZSBoaWdoIHdvcmQgaXMgbm9uLXplcm8gYW5kIFwKKyAgICAqIHdoaWxl
IHRoZSBsb3cgd29yZCBpcyBub256ZXJvIHdoZW4gbWFza2VkIHdpdGggMHhmZmUwXzAwMDBfMDAw
MF8wMDAwICovIFwKKyAgICB4Zl9kZWJ1ZygiaW5wdXQ6ICIsIGEpOyBcCisgICAgd2hpbGUgKChh
Lm1hbnQuaGlnaCAhPSAwKSB8fCAoKGEubWFudC5sb3cgPj4gKE1BTlRCSVRTICsgMSkpICE9IDAp
KSB7IFwKKyAgICAgICAgYSA9IHhmX25vcm1fcmlnaHQoYSwgMSk7IFwKKyAgICB9IFwKKyAgICB4
Zl9kZWJ1Zygibm9ybV9yaWdodDogIiwgYSk7IFwKKyAgICAvKiBcCisgICAgICogT0ssIG5vdyBu
b3JtYWxpemUgbGVmdCBcCisgICAgICogV2Ugd2FudCB0byBub3JtYWxpemUgbGVmdCB1bnRpbCB3
ZSBoYXZlIGEgbGVhZGluZyBvbmUgaW4gYml0IDI0IFwKKyAgICAgKiBUaGVvcmV0aWNhbGx5LCB3
ZSBvbmx5IG5lZWQgdG8gc2hpZnQgYSBtYXhpbXVtIG9mIG9uZSB0byB0aGUgbGVmdCBpZiB3ZSBc
CisgICAgICogc2hpZnRlZCBvdXQgbG90cyBvZiBiaXRzIGZyb20gQiwgb3IgaWYgd2UgaGFkIG5v
IHNoaWZ0IC8gMSBzaGlmdCBzdGlja3kgXAorICAgICAqIHNob3VkbCBiZSAwICBcCisgICAgICov
IFwKKyAgICB3aGlsZSAoKGEubWFudC5sb3cgJiAoMVVMTCA8PCBNQU5UQklUUykpID09IDApIHsg
XAorICAgICAgICBhID0geGZfbm9ybV9sZWZ0KGEpOyBcCisgICAgfSBcCisgICAgeGZfZGVidWco
Im5vcm1fbGVmdDogIiwgYSk7IFwKKyAgICAvKiBcCisgICAgICogT0ssIG5vdyB3ZSBtaWdodCBu
ZWVkIHRvIGRlbm9ybWFsaXplIGJlY2F1c2Ugb2YgcG90ZW50aWFsIHVuZGVyZmxvdy4gXAorICAg
ICAqIFdlIG5lZWQgdG8gZG8gdGhpcyBiZWZvcmUgcm91bmRpbmcsIGFuZCByb3VuZGluZyBtaWdo
dCBtYWtlIHVzIG5vcm1hbCBcCisgICAgICogYWdhaW4gXAorICAgICAqLyBcCisgICAgd2hpbGUg
KGEuZXhwIDw9IDApIHsgXAorICAgICAgICBhID0geGZfbm9ybV9yaWdodChhLCAxIC0gYS5leHAp
OyBcCisgICAgICAgIC8qIFwKKyAgICAgICAgICogRG8gd2UgaGF2ZSB1bmRlcmZsb3c/IFwKKyAg
ICAgICAgICogVGhhdCdzIHdoZW4gd2UgZ2V0IGFuIGluZXhhY3QgYW5zd2VyIGJlY2F1c2Ugd2Ug
cmFuIG91dCBvZiBiaXRzIFwKKyAgICAgICAgICogaW4gYSBkZW5vcm1hbC4gXAorICAgICAgICAg
Ki8gXAorICAgICAgICBpZiAoYS5ndWFyZCB8fCBhLnJvdW5kIHx8IGEuc3RpY2t5KSB7IFwKKyAg
ICAgICAgICAgIGZlcmFpc2VleGNlcHQoRkVfVU5ERVJGTE9XKTsgXAorICAgICAgICB9IFwKKyAg
ICB9IFwKKyAgICB4Zl9kZWJ1Zygibm9ybV9kZW5vcm06ICIsIGEpOyBcCisgICAgLyogT0ssIHdl
J3JlIHJlbGF0aXZlbHkgY2Fub25pY2FsLi4uIG5vdyB3ZSBuZWVkIHRvIHJvdW5kICovIFwKKyAg
ICBpZiAoYS5ndWFyZCB8fCBhLnJvdW5kIHx8IGEuc3RpY2t5KSB7IFwKKyAgICAgICAgZmVyYWlz
ZWV4Y2VwdChGRV9JTkVYQUNUKTsgXAorICAgICAgICBzd2l0Y2ggKGZlZ2V0cm91bmQoKSkgeyBc
CisgICAgICAgIGNhc2UgRkVfVE9XQVJEWkVSTzogXAorICAgICAgICAgICAgLyogQ2hvcCBhbmQg
d2UncmUgZG9uZSAqLyBcCisgICAgICAgICAgICBicmVhazsgXAorICAgICAgICBjYXNlIEZFX1VQ
V0FSRDogXAorICAgICAgICAgICAgaWYgKGEuc2lnbiA9PSAwKSB7IFwKKyAgICAgICAgICAgICAg
ICBhLm1hbnQubG93ICs9IDE7IFwKKyAgICAgICAgICAgIH0gXAorICAgICAgICAgICAgYnJlYWs7
IFwKKyAgICAgICAgY2FzZSBGRV9ET1dOV0FSRDogXAorICAgICAgICAgICAgaWYgKGEuc2lnbiAh
PSAwKSB7IFwKKyAgICAgICAgICAgICAgICBhLm1hbnQubG93ICs9IDE7IFwKKyAgICAgICAgICAg
IH0gXAorICAgICAgICAgICAgYnJlYWs7IFwKKyAgICAgICAgZGVmYXVsdDogXAorICAgICAgICAg
ICAgaWYgKGEucm91bmQgfHwgYS5zdGlja3kpIHsgXAorICAgICAgICAgICAgICAgIC8qIHJvdW5k
IHVwIGlmIGd1YXJkIGlzIDEsIGRvd24gaWYgZ3VhcmQgaXMgemVybyAqLyBcCisgICAgICAgICAg
ICAgICAgYS5tYW50LmxvdyArPSBhLmd1YXJkOyBcCisgICAgICAgICAgICB9IGVsc2UgaWYgKGEu
Z3VhcmQpIHsgXAorICAgICAgICAgICAgICAgIC8qIGV4YWN0bHkgLjUsIHJvdW5kIHVwIGlmIG9k
ZCAqLyBcCisgICAgICAgICAgICAgICAgYS5tYW50LmxvdyArPSAoYS5tYW50LmxvdyAmIDEpOyBc
CisgICAgICAgICAgICB9IFwKKyAgICAgICAgICAgIGJyZWFrOyBcCisgICAgICAgIH0gXAorICAg
IH0gXAorICAgIHhmX2RlYnVnKCJwb3N0X3JvdW5kOiAiLCBhKTsgXAorICAgIC8qIFwKKyAgICAg
KiBPSywgbm93IHdlIG1pZ2h0IGhhdmUgY2FycmllZCBhbGwgdGhlIHdheSB1cC4gXAorICAgICAq
IFNvIHdlIG1pZ2h0IG5lZWQgdG8gc2hyIG9uY2UgXAorICAgICAqIGF0IGxlYXN0IHdlIGtub3cg
dGhhdCB0aGUgbHNiIHNob3VsZCBiZSB6ZXJvIGlmIHdlIHJvdW5kZWQgYW5kIFwKKyAgICAgKiBn
b3QgYSBjYXJyeSBvdXQuLi4gXAorICAgICAqLyBcCisgICAgaWYgKChhLm1hbnQubG93ID4+IChN
QU5UQklUUyArIDEpKSAhPSAwKSB7IFwKKyAgICAgICAgYSA9IHhmX25vcm1fcmlnaHQoYSwgMSk7
IFwKKyAgICB9IFwKKyAgICB4Zl9kZWJ1Zygib25jZV9ub3JtX3JpZ2h0OiAiLCBhKTsgXAorICAg
IC8qIE92ZXJmbG93PyAqLyBcCisgICAgaWYgKGEuZXhwID49IElORl9FWFApIHsgXAorICAgICAg
ICAvKiBZZXAsIGluZiByZXN1bHQgKi8gXAorICAgICAgICB4Zl9kZWJ1ZygiaW5mOiAiLCBhKTsg
XAorICAgICAgICBmZXJhaXNlZXhjZXB0KEZFX09WRVJGTE9XKTsgXAorICAgICAgICBmZXJhaXNl
ZXhjZXB0KEZFX0lORVhBQ1QpOyBcCisgICAgICAgIHN3aXRjaCAoZmVnZXRyb3VuZCgpKSB7IFwK
KyAgICAgICAgY2FzZSBGRV9UT1dBUkRaRVJPOiBcCisgICAgICAgICAgICByZXR1cm4gbWF4Zmlu
aXRlXyMjVFlQRShhKTsgXAorICAgICAgICBjYXNlIEZFX1VQV0FSRDogXAorICAgICAgICAgICAg
aWYgKGEuc2lnbiA9PSAwKSB7IFwKKyAgICAgICAgICAgICAgICByZXR1cm4gaW5maW5pdGVfIyNU
WVBFKGEpOyBcCisgICAgICAgICAgICB9IGVsc2UgeyBcCisgICAgICAgICAgICAgICAgcmV0dXJu
IG1heGZpbml0ZV8jI1RZUEUoYSk7IFwKKyAgICAgICAgICAgIH0gXAorICAgICAgICBjYXNlIEZF
X0RPV05XQVJEOiBcCisgICAgICAgICAgICBpZiAoYS5zaWduICE9IDApIHsgXAorICAgICAgICAg
ICAgICAgIHJldHVybiBpbmZpbml0ZV8jI1RZUEUoYSk7IFwKKyAgICAgICAgICAgIH0gZWxzZSB7
IFwKKyAgICAgICAgICAgICAgICByZXR1cm4gbWF4ZmluaXRlXyMjVFlQRShhKTsgXAorICAgICAg
ICAgICAgfSBcCisgICAgICAgIGRlZmF1bHQ6IFwKKyAgICAgICAgICAgIHJldHVybiBpbmZpbml0
ZV8jI1RZUEUoYSk7IFwKKyAgICAgICAgfSBcCisgICAgfSBcCisgICAgLyogVW5kZXJmbG93PyAq
LyBcCisgICAgaWYgKGEubWFudC5sb3cgJiAoMVVMTCA8PCBNQU5UQklUUykpIHsgXAorICAgICAg
ICAvKiBMZWFkaW5nIG9uZSBtZWFuczogTm8sIHdlJ3JlIG5vcm1hbC4gU28sIHdlIHNob3VsZCBi
ZSBkb25lLi4uICovIFwKKyAgICAgICAgeGZfZGVidWcoIm5vcm06ICIsIGEpOyBcCisgICAgICAg
IHJldC54LmV4cCA9IGEuZXhwOyBcCisgICAgICAgIHJldC54Lm1hbnQgPSBhLm1hbnQubG93OyBc
CisgICAgICAgIHJldHVybiByZXQ7IFwKKyAgICB9IFwKKyAgICB4Zl9kZWJ1ZygiZGVub3JtOiAi
LCBhKTsgXAorICAgIGlmIChhLmV4cCAhPSAxKSB7IFwKKyAgICAgICAgcHJpbnRmKCJhLmV4cCA9
PSAlZFxuIiwgYS5leHApOyBcCisgICAgfSBcCisgICAgYXNzZXJ0KGEuZXhwID09IDEpOyBcCisg
ICAgcmV0LnguZXhwID0gMDsgXAorICAgIHJldC54Lm1hbnQgPSBhLm1hbnQubG93OyBcCisgICAg
cmV0dXJuIHJldDsgXAorfQorCitHRU5fWEZfUk9VTkQoZGZfdCwgZkRGX01BTlRCSVRTKCksIERG
X0lORl9FWFApCitHRU5fWEZfUk9VTkQoc2ZfdCwgZlNGX01BTlRCSVRTKCksIFNGX0lORl9FWFAp
CisKK3N0YXRpYyBpbmxpbmUgZG91YmxlIHNwZWNpYWxfZm1hKGRmX3QgYSwgZGZfdCBiLCBkZl90
IGMpCit7CisgICAgZGZfdCByZXQ7CisgICAgcmV0LmkgPSAwOworCisgICAgLyoKKyAgICAgKiBJ
ZiBBIG11bHRpcGxpZWQgYnkgQiBpcyBhbiBleGFjdCBpbmZpbml0eSBhbmQgQyBpcyBhbHNvIGFu
IGluZmluaXR5CisgICAgICogYnV0IHdpdGggdGhlIG9wcG9zaXRlIHNpZ24sIEZNQSByZXR1cm5z
IE5hTiBhbmQgcmFpc2VzIGludmFsaWQuCisgICAgICovCisgICAgaWYgKGZJU0lORlBST0QoYS5m
LCBiLmYpICYmIGlzaW5mKGMuZikpIHsKKyAgICAgICAgaWYgKChhLnguc2lnbiBeIGIueC5zaWdu
KSAhPSBjLnguc2lnbikgeworICAgICAgICAgICAgcmV0LmkgPSBmREZOQU5WQUwoKTsKKyAgICAg
ICAgICAgIGZlcmFpc2VleGNlcHQoRkVfSU5WQUxJRCk7CisgICAgICAgICAgICByZXR1cm4gcmV0
LmY7CisgICAgICAgIH0KKyAgICB9CisgICAgaWYgKChpc2luZihhLmYpICYmIGlzeihiLmYpKSB8
fCAoaXN6KGEuZikgJiYgaXNpbmYoYi5mKSkpIHsKKyAgICAgICAgcmV0LmkgPSBmREZOQU5WQUwo
KTsKKyAgICAgICAgZmVyYWlzZWV4Y2VwdChGRV9JTlZBTElEKTsKKyAgICAgICAgcmV0dXJuIHJl
dC5mOworICAgIH0KKyAgICAvKgorICAgICAqIElmIG5vbmUgb2YgdGhlIGFib3ZlIGNoZWNrcyBh
cmUgdHJ1ZSBhbmQgQyBpcyBhIE5hTiwKKyAgICAgKiBhIE5hTiBzaGFsbCBiZSByZXR1cm5lZAor
ICAgICAqIElmIEEgb3IgQiBhcmUgTmFOLCBhIE5BTiBzaGFsbCBiZSByZXR1cm5lZC4KKyAgICAg
Ki8KKyAgICBpZiAoaXNuYW4oYS5mKSB8fCBpc25hbihiLmYpIHx8IChpc25hbihjLmYpKSkgewor
ICAgICAgICBpZiAoaXNuYW4oYS5mKSAmJiAoZkdFVEJJVCg1MSwgYS5pKSA9PSAwKSkgeworICAg
ICAgICAgICAgZmVyYWlzZWV4Y2VwdChGRV9JTlZBTElEKTsKKyAgICAgICAgfQorICAgICAgICBp
ZiAoaXNuYW4oYi5mKSAmJiAoZkdFVEJJVCg1MSwgYi5pKSA9PSAwKSkgeworICAgICAgICAgICAg
ZmVyYWlzZWV4Y2VwdChGRV9JTlZBTElEKTsKKyAgICAgICAgfQorICAgICAgICBpZiAoaXNuYW4o
Yy5mKSAmJiAoZkdFVEJJVCg1MSwgYy5pKSA9PSAwKSkgeworICAgICAgICAgICAgZmVyYWlzZWV4
Y2VwdChGRV9JTlZBTElEKTsKKyAgICAgICAgfQorICAgICAgICByZXQuaSA9IGZERk5BTlZBTCgp
OworICAgICAgICByZXR1cm4gcmV0LmY7CisgICAgfQorICAgIC8qCisgICAgICogV2UgaGF2ZSBj
aGVja2VkIGZvciBhZGRpbmcgb3Bwb3NpdGUtc2lnbmVkIGluZmluaXRpZXMuCisgICAgICogT3Ro
ZXIgaW5maW5pdGllcyByZXR1cm4gaW5maW5pdHkgd2l0aCB0aGUgY29ycmVjdCBzaWduCisgICAg
ICovCisgICAgaWYgKGlzaW5mKGMuZikpIHsKKyAgICAgICAgcmV0LnguZXhwID0gREZfSU5GX0VY
UDsKKyAgICAgICAgcmV0LngubWFudCA9IDA7CisgICAgICAgIHJldC54LnNpZ24gPSBjLnguc2ln
bjsKKyAgICAgICAgcmV0dXJuIHJldC5mOworICAgIH0KKyAgICBpZiAoaXNpbmYoYS5mKSB8fCBp
c2luZihiLmYpKSB7CisgICAgICAgIHJldC54LmV4cCA9IERGX0lORl9FWFA7CisgICAgICAgIHJl
dC54Lm1hbnQgPSAwOworICAgICAgICByZXQueC5zaWduID0gKGEueC5zaWduIF4gYi54LnNpZ24p
OworICAgICAgICByZXR1cm4gcmV0LmY7CisgICAgfQorICAgIGdfYXNzZXJ0X25vdF9yZWFjaGVk
KCk7CisgICAgcmV0LnguZXhwID0gMHgxMjM7CisgICAgcmV0LngubWFudCA9IDB4ZGVhZDsKKyAg
ICByZXR1cm4gcmV0LmY7Cit9CisKK3N0YXRpYyBpbmxpbmUgZmxvYXQgc3BlY2lhbF9mbWFmKHNm
X3QgYSwgc2ZfdCBiLCBzZl90IGMpCit7CisgICAgZGZfdCBhYSwgYmIsIGNjOworICAgIGFhLmYg
PSBhLmY7CisgICAgYmIuZiA9IGIuZjsKKyAgICBjYy5mID0gYy5mOworICAgIHJldHVybiBzcGVj
aWFsX2ZtYShhYSwgYmIsIGNjKTsKK30KKworZG91YmxlIGludGVybmFsX2ZtYXgoZG91YmxlIGFf
aW4sIGRvdWJsZSBiX2luLCBkb3VibGUgY19pbiwgaW50IHNjYWxlKQoreworICAgIGRmX3QgYSwg
YiwgYzsKKyAgICB4Zl90IHByb2Q7CisgICAgeGZfdCBhY2M7CisgICAgeGZfdCByZXN1bHQ7Cisg
ICAgeGZfaW5pdCgmcHJvZCk7CisgICAgeGZfaW5pdCgmYWNjKTsKKyAgICB4Zl9pbml0KCZyZXN1
bHQpOworICAgIGEuZiA9IGFfaW47CisgICAgYi5mID0gYl9pbjsKKyAgICBjLmYgPSBjX2luOwor
CisgICAgZGVidWdfZnByaW50ZihzdGRvdXQsCisgICAgICAgICAgICAgICAgICAiaW50ZXJuYWxf
Zm1heDogMHglMDE2bGx4ICogMHglMDE2bGx4ICsgMHglMDE2bGx4IHNjOiAlZFxuIiwKKyAgICAg
ICAgICAgICAgICAgIGZVTkRPVUJMRShhX2luKSwgZlVORE9VQkxFKGJfaW4pLCBmVU5ET1VCTEUo
Y19pbiksCisgICAgICAgICAgICAgICAgICBzY2FsZSk7CisKKyAgICBpZiAoaXNpbmYoYS5mKSB8
fCBpc2luZihiLmYpIHx8IGlzaW5mKGMuZikpIHsKKyAgICAgICAgcmV0dXJuIHNwZWNpYWxfZm1h
KGEsIGIsIGMpOworICAgIH0KKyAgICBpZiAoaXNuYW4oYS5mKSB8fCBpc25hbihiLmYpIHx8IGlz
bmFuKGMuZikpIHsKKyAgICAgICAgcmV0dXJuIHNwZWNpYWxfZm1hKGEsIGIsIGMpOworICAgIH0K
KyAgICBpZiAoKHNjYWxlID09IDApICYmIChpc3ooYS5mKSB8fCBpc3ooYi5mKSkpIHsKKyAgICAg
ICAgcmV0dXJuIGEuZiAqIGIuZiArIGMuZjsKKyAgICB9CisKKyAgICAvKiAoYSAqIDIqKmIpICog
KGMgKiAyKipkKSA9PSBhKmMgKiAyKiooYitkKSAqLworICAgIHByb2QubWFudCA9IGludDEyOF9t
dWxfNjQ2NChkZl9nZXRtYW50KGEpLCBkZl9nZXRtYW50KGIpKTsKKworICAgIC8qCisgICAgICog
Tm90ZTogZXh0cmFjdGluZyB0aGUgbWFudGlzc2EgaW50byBhbiBpbnQgaXMgbXVsdGlwbHlpbmcg
YnkKKyAgICAgKiAyKio1Miwgc28gYWRqdXN0IGhlcmUKKyAgICAgKi8KKyAgICBwcm9kLmV4cCA9
IGRmX2dldGV4cChhKSArIGRmX2dldGV4cChiKSAtIERGX0JJQVMgLSA1MjsKKyAgICBwcm9kLnNp
Z24gPSBhLnguc2lnbiBeIGIueC5zaWduOworICAgIHhmX2RlYnVnKCJwcm9kOiAiLCBwcm9kKTsK
KyAgICBpZiAoIWlzeihjLmYpKSB7CisgICAgICAgIGFjYy5tYW50ID0gaW50MTI4X211bF82NDY0
KGRmX2dldG1hbnQoYyksIDEpOworICAgICAgICBhY2MuZXhwID0gZGZfZ2V0ZXhwKGMpOworICAg
ICAgICBhY2Muc2lnbiA9IGMueC5zaWduOworICAgICAgICB4Zl9kZWJ1ZygiYWNjOiAiLCBhY2Mp
OworICAgICAgICByZXN1bHQgPSB4Zl9hZGQocHJvZCwgYWNjKTsKKyAgICB9IGVsc2UgeworICAg
ICAgICByZXN1bHQgPSBwcm9kOworICAgIH0KKyAgICB4Zl9kZWJ1Zygic3VtOiAiLCByZXN1bHQp
OworICAgIGRlYnVnX2ZwcmludGYoc3Rkb3V0LCAiU2NhbGluZzogJWRcbiIsIHNjYWxlKTsKKyAg
ICByZXN1bHQuZXhwICs9IHNjYWxlOworICAgIHhmX2RlYnVnKCJwb3N0LXNjYWxlOiAiLCByZXN1
bHQpOworICAgIHJldHVybiB4Zl9yb3VuZF9kZl90KHJlc3VsdCkuZjsKK30KKworZmxvYXQgaW50
ZXJuYWxfZm1hZngoZmxvYXQgYV9pbiwgZmxvYXQgYl9pbiwgZmxvYXQgY19pbiwgaW50IHNjYWxl
KQoreworICAgIHNmX3QgYSwgYiwgYzsKKyAgICB4Zl90IHByb2Q7CisgICAgeGZfdCBhY2M7Cisg
ICAgeGZfdCByZXN1bHQ7CisgICAgeGZfaW5pdCgmcHJvZCk7CisgICAgeGZfaW5pdCgmYWNjKTsK
KyAgICB4Zl9pbml0KCZyZXN1bHQpOworICAgIGEuZiA9IGFfaW47CisgICAgYi5mID0gYl9pbjsK
KyAgICBjLmYgPSBjX2luOworCisgICAgZGVidWdfZnByaW50ZihzdGRvdXQsCisgICAgICAgICAg
ICAgICAgICAiaW50ZXJuYWxfZm1heDogMHglMDE2eCAqIDB4JTAxNnggKyAweCUwMTZ4IHNjOiAl
ZFxuIiwKKyAgICAgICAgICAgICAgICAgIGZVTkZMT0FUKGFfaW4pLCBmVU5GTE9BVChiX2luKSwg
ZlVORkxPQVQoY19pbiksIHNjYWxlKTsKKyAgICBpZiAoaXNpbmYoYS5mKSB8fCBpc2luZihiLmYp
IHx8IGlzaW5mKGMuZikpIHsKKyAgICAgICAgcmV0dXJuIHNwZWNpYWxfZm1hZihhLCBiLCBjKTsK
KyAgICB9CisgICAgaWYgKGlzbmFuKGEuZikgfHwgaXNuYW4oYi5mKSB8fCBpc25hbihjLmYpKSB7
CisgICAgICAgIHJldHVybiBzcGVjaWFsX2ZtYWYoYSwgYiwgYyk7CisgICAgfQorICAgIGlmICgo
c2NhbGUgPT0gMCkgJiYgKGlzeihhLmYpIHx8IGlzeihiLmYpKSkgeworICAgICAgICByZXR1cm4g
YS5mICogYi5mICsgYy5mOworICAgIH0KKworICAgIC8qIChhICogMioqYikgKiAoYyAqIDIqKmQp
ID09IGEqYyAqIDIqKihiK2QpICovCisgICAgcHJvZC5tYW50ID0gaW50MTI4X211bF82NDY0KHNm
X2dldG1hbnQoYSksIHNmX2dldG1hbnQoYikpOworCisgICAgLyoKKyAgICAgKiBOb3RlOiBleHRy
YWN0aW5nIHRoZSBtYW50aXNzYSBpbnRvIGFuIGludCBpcyBtdWx0aXBseWluZyBieQorICAgICAq
IDIqKjIzLCBzbyBhZGp1c3QgaGVyZQorICAgICAqLworICAgIHByb2QuZXhwID0gc2ZfZ2V0ZXhw
KGEpICsgc2ZfZ2V0ZXhwKGIpIC0gU0ZfQklBUyAtIDIzOworICAgIHByb2Quc2lnbiA9IGEueC5z
aWduIF4gYi54LnNpZ247CisgICAgaWYgKGlzeihhLmYpIHx8IGlzeihiLmYpKSB7CisgICAgICAg
IHByb2QuZXhwID0gLTIgKiBXQVlfQklHX0VYUDsKKyAgICB9CisgICAgeGZfZGVidWcoInByb2Q6
ICIsIHByb2QpOworICAgIGlmICgoc2NhbGUgPiAwKSAmJiAoZnBjbGFzc2lmeShjLmYpID09IEZQ
X1NVQk5PUk1BTCkpIHsKKyAgICAgICAgYWNjLm1hbnQgPSBpbnQxMjhfbXVsXzY0NjQoMCwgMCk7
CisgICAgICAgIGFjYy5leHAgPSAtV0FZX0JJR19FWFA7CisgICAgICAgIGFjYy5zaWduID0gYy54
LnNpZ247CisgICAgICAgIGFjYy5zdGlja3kgPSAxOworICAgICAgICB4Zl9kZWJ1Zygic3BlY2lh
bCBkZW5vcm0gYWNjOiAiLCBhY2MpOworICAgICAgICByZXN1bHQgPSB4Zl9hZGQocHJvZCwgYWNj
KTsKKyAgICB9IGVsc2UgaWYgKCFpc3ooYy5mKSkgeworICAgICAgICBhY2MubWFudCA9IGludDEy
OF9tdWxfNjQ2NChzZl9nZXRtYW50KGMpLCAxKTsKKyAgICAgICAgYWNjLmV4cCA9IHNmX2dldGV4
cChjKTsKKyAgICAgICAgYWNjLnNpZ24gPSBjLnguc2lnbjsKKyAgICAgICAgeGZfZGVidWcoImFj
YzogIiwgYWNjKTsKKyAgICAgICAgcmVzdWx0ID0geGZfYWRkKHByb2QsIGFjYyk7CisgICAgfSBl
bHNlIHsKKyAgICAgICAgcmVzdWx0ID0gcHJvZDsKKyAgICB9CisgICAgeGZfZGVidWcoInN1bTog
IiwgcmVzdWx0KTsKKyAgICBkZWJ1Z19mcHJpbnRmKHN0ZG91dCwgIlNjYWxpbmc6ICVkXG4iLCBz
Y2FsZSk7CisgICAgcmVzdWx0LmV4cCArPSBzY2FsZTsKKyAgICB4Zl9kZWJ1ZygicG9zdC1zY2Fs
ZTogIiwgcmVzdWx0KTsKKyAgICByZXR1cm4geGZfcm91bmRfc2ZfdChyZXN1bHQpLmY7Cit9CisK
KworZmxvYXQgaW50ZXJuYWxfZm1hZihmbG9hdCBhX2luLCBmbG9hdCBiX2luLCBmbG9hdCBjX2lu
KQoreworICAgIHJldHVybiBpbnRlcm5hbF9mbWFmeChhX2luLCBiX2luLCBjX2luLCAwKTsKK30K
KworZG91YmxlIGludGVybmFsX2ZtYShkb3VibGUgYV9pbiwgZG91YmxlIGJfaW4sIGRvdWJsZSBj
X2luKQoreworICAgIHJldHVybiBpbnRlcm5hbF9mbWF4KGFfaW4sIGJfaW4sIGNfaW4sIDApOwor
fQorCitmbG9hdCBpbnRlcm5hbF9tcHlmKGZsb2F0IGFfaW4sIGZsb2F0IGJfaW4pCit7CisgICAg
aWYgKGlzeihhX2luKSB8fCBpc3ooYl9pbikpIHsKKyAgICAgICAgcmV0dXJuIGFfaW4gKiBiX2lu
OworICAgIH0KKyAgICByZXR1cm4gaW50ZXJuYWxfZm1hZngoYV9pbiwgYl9pbiwgMC4wLCAwKTsK
K30KKworZG91YmxlIGludGVybmFsX21weShkb3VibGUgYV9pbiwgZG91YmxlIGJfaW4pCit7Cisg
ICAgaWYgKGlzeihhX2luKSB8fCBpc3ooYl9pbikpIHsKKyAgICAgICAgcmV0dXJuIGFfaW4gKiBi
X2luOworICAgIH0KKyAgICByZXR1cm4gaW50ZXJuYWxfZm1heChhX2luLCBiX2luLCAwLjAsIDAp
OworfQorCitzdGF0aWMgaW5saW5lIGRvdWJsZSBpbnRlcm5hbF9tcHloaF9zcGVjaWFsKGRvdWJs
ZSBhLCBkb3VibGUgYikKK3sKKyAgICByZXR1cm4gYSAqIGI7Cit9CisKK2RvdWJsZSBpbnRlcm5h
bF9tcHloaChkb3VibGUgYV9pbiwgZG91YmxlIGJfaW4sCisgICAgICAgICAgICAgICAgICAgICAg
dW5zaWduZWQgbG9uZyBsb25nIGludCBhY2N1bXVsYXRlZCkKK3sKKyAgICBkZl90IGEsIGI7Cisg
ICAgeGZfdCB4OworICAgIHVuc2lnbmVkIGxvbmcgbG9uZyBpbnQgcHJvZDsKKyAgICB1bnNpZ25l
ZCBpbnQgc3RpY2t5OworCisgICAgYS5mID0gYV9pbjsKKyAgICBiLmYgPSBiX2luOworICAgIHN0
aWNreSA9IGFjY3VtdWxhdGVkICYgMTsKKyAgICBhY2N1bXVsYXRlZCA+Pj0gMTsKKyAgICB4Zl9p
bml0KCZ4KTsKKyAgICBpZiAoaXN6KGFfaW4pIHx8IGlzbmFuKGFfaW4pIHx8IGlzaW5mKGFfaW4p
KSB7CisgICAgICAgIHJldHVybiBpbnRlcm5hbF9tcHloaF9zcGVjaWFsKGFfaW4sIGJfaW4pOwor
ICAgIH0KKyAgICBpZiAoaXN6KGJfaW4pIHx8IGlzbmFuKGJfaW4pIHx8IGlzaW5mKGJfaW4pKSB7
CisgICAgICAgIHJldHVybiBpbnRlcm5hbF9tcHloaF9zcGVjaWFsKGFfaW4sIGJfaW4pOworICAg
IH0KKyAgICB4Lm1hbnQgPSBpbnQxMjhfbXVsXzY0NjQoYWNjdW11bGF0ZWQsIDEpOworICAgIHgu
c3RpY2t5ID0gc3RpY2t5OworICAgIHByb2QgPSBmR0VUVVdPUkQoMSwgZGZfZ2V0bWFudChhKSkg
KiBmR0VUVVdPUkQoMSwgZGZfZ2V0bWFudChiKSk7CisgICAgeC5tYW50ID0gaW50MTI4X2FkZCh4
Lm1hbnQsIGludDEyOF9tdWxfNjQ2NChwcm9kLCAweDEwMDAwMDAwMFVMTCkpOworICAgIHguZXhw
ID0gZGZfZ2V0ZXhwKGEpICsgZGZfZ2V0ZXhwKGIpIC0gREZfQklBUyAtIDIwOworICAgIHhmX2Rl
YnVnKCJmb3JtZWQ6ICIsIHgpOworICAgIGlmICghaXNub3JtYWwoYV9pbikgfHwgIWlzbm9ybWFs
KGJfaW4pKSB7CisgICAgICAgIC8qIGNydXNoIHRvIGluZXhhY3QgemVybyAqLworICAgICAgICB4
LnN0aWNreSA9IDE7CisgICAgICAgIHguZXhwID0gLTQwOTY7CisgICAgICAgIHhmX2RlYnVnKCJj
cnVzaGluZzogIiwgeCk7CisgICAgfQorICAgIHguc2lnbiA9IGEueC5zaWduIF4gYi54LnNpZ247
CisgICAgeGZfZGVidWcoIndpdGggc2lnbjogIiwgeCk7CisgICAgcmV0dXJuIHhmX3JvdW5kX2Rm
X3QoeCkuZjsKK30KKworZmxvYXQgY29udl9kZl90b19zZihkb3VibGUgaW5fZikKK3sKKyAgICB4
Zl90IHg7CisgICAgZGZfdCBpbjsKKyAgICBpZiAoaXN6KGluX2YpIHx8IGlzbmFuKGluX2YpIHx8
IGlzaW5mKGluX2YpKSB7CisgICAgICAgIHJldHVybiBpbl9mOworICAgIH0KKyAgICB4Zl9pbml0
KCZ4KTsKKyAgICBpbi5mID0gaW5fZjsKKyAgICB4Lm1hbnQgPSBpbnQxMjhfbXVsXzY0NjQoZGZf
Z2V0bWFudChpbiksIDEpOworICAgIHguZXhwID0gZGZfZ2V0ZXhwKGluKSAtIERGX0JJQVMgKyBT
Rl9CSUFTIC0gNTIgKyAyMzsKKyAgICB4LnNpZ24gPSBpbi54LnNpZ247CisgICAgeGZfZGVidWco
ImNvbnYgdG8gc2Y6IHg6ICIsIHgpOworICAgIHJldHVybiB4Zl9yb3VuZF9zZl90KHgpLmY7Cit9
CisKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29uL2ZtYV9lbXUuaCBiL3RhcmdldC9oZXhhZ29u
L2ZtYV9lbXUuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi5lMzhjYWQ5Ci0t
LSAvZGV2L251bGwKKysrIGIvdGFyZ2V0L2hleGFnb24vZm1hX2VtdS5oCkBAIC0wLDAgKzEsMzAg
QEAKKy8qCisgKiAgQ29weXJpZ2h0IChjKSAyMDE5IFF1YWxjb21tIElubm92YXRpb24gQ2VudGVy
LCBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCisgKgorICogIFRoaXMgcHJvZ3JhbSBpcyBmcmVl
IHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CisgKiAgaXQg
dW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJs
aXNoZWQgYnkKKyAqICB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lv
biAyIG9mIHRoZSBMaWNlbnNlLCBvcgorICogIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZl
cnNpb24uCisgKgorICogIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0
aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICogIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0
aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgKiAgTUVSQ0hBTlRBQklMSVRZIG9y
IEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQorICogIEdOVSBHZW5l
cmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisgKgorICogIFlvdSBzaG91bGQg
aGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCisg
KiAgYWxvbmcgd2l0aCB0aGlzIHByb2dyYW07IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5v
cmcvbGljZW5zZXMvPi4KKyAqLworCisjaWZuZGVmIEZNQV9FTVVfSAorI2RlZmluZSBGTUFfRU1V
X0gKKworZXh0ZXJuIGZsb2F0IGludGVybmFsX2ZtYWZ4KGZsb2F0IGFfaW4sIGZsb2F0IGJfaW4s
IGZsb2F0IGNfaW4sIGludCBzY2FsZSk7CitleHRlcm4gZmxvYXQgaW50ZXJuYWxfZm1hZihmbG9h
dCBhX2luLCBmbG9hdCBiX2luLCBmbG9hdCBjX2luKTsKK2V4dGVybiBkb3VibGUgaW50ZXJuYWxf
Zm1hKGRvdWJsZSBhX2luLCBkb3VibGUgYl9pbiwgZG91YmxlIGNfaW4pOworZXh0ZXJuIGRvdWJs
ZSBpbnRlcm5hbF9mbWF4KGRvdWJsZSBhX2luLCBkb3VibGUgYl9pbiwgZG91YmxlIGNfaW4sIGlu
dCBzY2FsZSk7CitleHRlcm4gZmxvYXQgaW50ZXJuYWxfbXB5ZihmbG9hdCBhX2luLCBmbG9hdCBi
X2luKTsKK2V4dGVybiBkb3VibGUgaW50ZXJuYWxfbXB5KGRvdWJsZSBhX2luLCBkb3VibGUgYl9p
bik7CitleHRlcm4gZG91YmxlIGludGVybmFsX21weWhoKGRvdWJsZSBhX2luLCBkb3VibGUgYl9p
biwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBsb25nIGludCBh
Y2N1bXVsYXRlZCk7CisKKyNlbmRpZgotLSAKMi43LjQKCg==

