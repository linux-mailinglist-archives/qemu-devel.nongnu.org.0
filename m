Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id B05893F8D58
	for <lists+qemu-devel@lfdr.de>; Thu, 26 Aug 2021 19:53:13 +0200 (CEST)
Received: from localhost ([::1]:60824 helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>)
	id 1mJJYu-0003u7-NG
	for lists+qemu-devel@lfdr.de; Thu, 26 Aug 2021 13:53:12 -0400
Received: from eggs.gnu.org ([2001:470:142:3::10]:52236)
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1mJJIk-0004P7-2l
 for qemu-devel@nongnu.org; Thu, 26 Aug 2021 13:36:30 -0400
Received: from alexa-out-sd-01.qualcomm.com ([199.106.114.38]:3083)
 by eggs.gnu.org with esmtps (TLS1.2:RSA_AES_256_CBC_SHA1:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1mJJIf-00058v-I9
 for qemu-devel@nongnu.org; Thu, 26 Aug 2021 13:36:29 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=quicinc.com; i=@quicinc.com; q=dns/txt; s=qcdkim;
 t=1629999385; x=1661535385;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version:content-transfer-encoding;
 bh=MRO+qE/NalPJATfI1yP99/U7N2ayWTHfH8+qq/C//8U=;
 b=yIqHHNCHqLFsHpErgL34++VGddLb+HEd0aROUYg+94znAwnr1opmXR7y
 GGZMhNdb7sRGj9CF9Ardos/k9l9zOOHa2jqdZ2SsRicScrdkk7qyC2QEb
 tDRkUWFJMe7/wsmh/mLAaYGJqfqNQht+Ujitm9bee7dco1qqxCf2va4J/ k=;
Received: from unknown (HELO ironmsg-SD-alpha.qualcomm.com) ([10.53.140.30])
 by alexa-out-sd-01.qualcomm.com with ESMTP; 26 Aug 2021 10:36:15 -0700
X-QCInternal: smtphost
Received: from vu-tsimpson-aus.qualcomm.com (HELO
 vu-tsimpson1-aus.qualcomm.com) ([10.222.150.1])
 by ironmsg-SD-alpha.qualcomm.com with ESMTP; 26 Aug 2021 10:36:14 -0700
Received: by vu-tsimpson1-aus.qualcomm.com (Postfix, from userid 47164)
 id 6CC1113B9; Thu, 26 Aug 2021 12:36:13 -0500 (CDT)
From: Taylor Simpson <tsimpson@quicinc.com>
To: qemu-devel@nongnu.org
Subject: [PATCH v2 08/30] Hexagon HVX (target/hexagon) semantics generator -
 part 2
Date: Thu, 26 Aug 2021 12:35:36 -0500
Message-Id: <1629999358-25304-9-git-send-email-tsimpson@quicinc.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1629999358-25304-1-git-send-email-tsimpson@quicinc.com>
References: <1629999358-25304-1-git-send-email-tsimpson@quicinc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Received-SPF: pass client-ip=199.106.114.38;
 envelope-from=tsimpson@qualcomm.com; helo=alexa-out-sd-01.qualcomm.com
X-Spam_score_int: -21
X-Spam_score: -2.2
X-Spam_bar: --
X-Spam_report: (-2.2 / 5.0 requ) DKIM_SIGNED=0.1, DKIM_VALID=-0.1,
 DKIM_VALID_AU=-0.1, HEADER_FROM_DIFFERENT_DOMAINS=0.249,
 RCVD_IN_DNSWL_MED=-2.3, SPF_HELO_NONE=0.001,
 SPF_PASS=-0.001 autolearn=ham autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Cc: ale@rev.ng, bcain@quicinc.com, tsimpson@quicinc.com,
 richard.henderson@linaro.org, f4bug@amsat.org
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: "Qemu-devel" <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>

U2lnbmVkLW9mZi1ieTogVGF5bG9yIFNpbXBzb24gPHRzaW1wc29uQHF1aWNpbmMuY29tPgotLS0K
IHRhcmdldC9oZXhhZ29uL2dlbl9oZWxwZXJfZnVuY3MucHkgIHwgMTExICsrKysrKysrKysrKysr
LS0KIHRhcmdldC9oZXhhZ29uL2dlbl9oZWxwZXJfcHJvdG9zLnB5IHwgIDE2ICsrLQogdGFyZ2V0
L2hleGFnb24vZ2VuX3RjZ19mdW5jcy5weSAgICAgfCAyNTggKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKy0tCiAzIGZpbGVzIGNoYW5nZWQsIDM2MyBpbnNlcnRpb25zKCspLCAyMiBk
ZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi9nZW5faGVscGVyX2Z1bmNz
LnB5IGIvdGFyZ2V0L2hleGFnb24vZ2VuX2hlbHBlcl9mdW5jcy5weQppbmRleCAyYjFjNWQ4Li5j
MTUyMDAyIDEwMDc1NQotLS0gYS90YXJnZXQvaGV4YWdvbi9nZW5faGVscGVyX2Z1bmNzLnB5Cisr
KyBiL3RhcmdldC9oZXhhZ29uL2dlbl9oZWxwZXJfZnVuY3MucHkKQEAgLTQ4LDEyICs0OCwyNiBA
QCBkZWYgZ2VuX2hlbHBlcl9hcmdfcGFpcihmLHJlZ3R5cGUscmVnaWQscmVnbm8pOgogICAgIGlm
IHJlZ25vID49IDAgOiBmLndyaXRlKCIsICIpCiAgICAgZi53cml0ZSgiaW50NjRfdCAlcyVzViIg
JSAocmVndHlwZSxyZWdpZCkpCiAKK2RlZiBnZW5faGVscGVyX2FyZ19leHQoZixyZWd0eXBlLHJl
Z2lkLHJlZ25vKToKKyAgICBpZiByZWdubyA+IDAgOiBmLndyaXRlKCIsICIpCisgICAgZi53cml0
ZSgidm9pZCAqJXMlc1Zfdm9pZCIgJSAocmVndHlwZSxyZWdpZCkpCisKK2RlZiBnZW5faGVscGVy
X2FyZ19leHRfcGFpcihmLHJlZ3R5cGUscmVnaWQscmVnbm8pOgorICAgIGlmIHJlZ25vID4gMCA6
IGYud3JpdGUoIiwgIikKKyAgICBmLndyaXRlKCJ2b2lkIColcyVzVl92b2lkIiAlIChyZWd0eXBl
LHJlZ2lkKSkKKwogZGVmIGdlbl9oZWxwZXJfYXJnX29wbihmLHJlZ3R5cGUscmVnaWQsaSx0YWcp
OgogICAgIGlmIChoZXhfY29tbW9uLmlzX3BhaXIocmVnaWQpKToKLSAgICAgICAgZ2VuX2hlbHBl
cl9hcmdfcGFpcihmLHJlZ3R5cGUscmVnaWQsaSkKKyAgICAgICAgaWYgKGhleF9jb21tb24uaXNf
aHZ4X3JlZyhyZWd0eXBlKSk6CisgICAgICAgICAgICBnZW5faGVscGVyX2FyZ19leHRfcGFpcihm
LHJlZ3R5cGUscmVnaWQsaSkKKyAgICAgICAgZWxzZToKKyAgICAgICAgICAgIGdlbl9oZWxwZXJf
YXJnX3BhaXIoZixyZWd0eXBlLHJlZ2lkLGkpCiAgICAgZWxpZiAoaGV4X2NvbW1vbi5pc19zaW5n
bGUocmVnaWQpKToKICAgICAgICAgaWYgaGV4X2NvbW1vbi5pc19vbGRfdmFsKHJlZ3R5cGUsIHJl
Z2lkLCB0YWcpOgotICAgICAgICAgICAgZ2VuX2hlbHBlcl9hcmcoZixyZWd0eXBlLHJlZ2lkLGkp
CisgICAgICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc19odnhfcmVnKHJlZ3R5cGUpKToKKyAgICAg
ICAgICAgICAgICBnZW5faGVscGVyX2FyZ19leHQoZixyZWd0eXBlLHJlZ2lkLGkpCisgICAgICAg
ICAgICBlbHNlOgorICAgICAgICAgICAgICAgIGdlbl9oZWxwZXJfYXJnKGYscmVndHlwZSxyZWdp
ZCxpKQogICAgICAgICBlbGlmIGhleF9jb21tb24uaXNfbmV3X3ZhbChyZWd0eXBlLCByZWdpZCwg
dGFnKToKICAgICAgICAgICAgIGdlbl9oZWxwZXJfYXJnX25ldyhmLHJlZ3R5cGUscmVnaWQsaSkK
ICAgICAgICAgZWxzZToKQEAgLTcyLDI1ICs4Niw2NyBAQCBkZWYgZ2VuX2hlbHBlcl9kZXN0X2Rl
Y2xfcGFpcihmLHJlZ3R5cGUscmVnaWQscmVnbm8sc3ViZmllbGQ9IiIpOgogICAgIGYud3JpdGUo
IiAgICBpbnQ2NF90ICVzJXNWJXMgPSAwO1xuIiAlIFwKICAgICAgICAgKHJlZ3R5cGUscmVnaWQs
c3ViZmllbGQpKQogCitkZWYgZ2VuX2hlbHBlcl9kZXN0X2RlY2xfZXh0KGYscmVndHlwZSxyZWdp
ZCk6CisgICAgaWYgKHJlZ3R5cGUgPT0gIlEiKToKKyAgICAgICAgZi53cml0ZSgiICAgIC8qICVz
JXNWIGlzICooTU1RUmVnICopKCVzJXNWX3ZvaWQpICovXG4iICUgXAorICAgICAgICAgICAgKHJl
Z3R5cGUscmVnaWQscmVndHlwZSxyZWdpZCkpCisgICAgZWxzZToKKyAgICAgICAgZi53cml0ZSgi
ICAgIC8qICVzJXNWIGlzICooTU1WZWN0b3IgKikoJXMlc1Zfdm9pZCkgKi9cbiIgJSBcCisgICAg
ICAgICAgICAocmVndHlwZSxyZWdpZCxyZWd0eXBlLHJlZ2lkKSkKKworZGVmIGdlbl9oZWxwZXJf
ZGVzdF9kZWNsX2V4dF9wYWlyKGYscmVndHlwZSxyZWdpZCxyZWdubyk6CisgICAgZi53cml0ZSgi
ICAgIC8qICVzJXNWIGlzICooTU1WZWN0b3JQYWlyICopKSVzJXNWX3ZvaWQpICovXG4iICUgXAor
ICAgICAgICAocmVndHlwZSxyZWdpZCxyZWd0eXBlLCByZWdpZCkpCisKIGRlZiBnZW5faGVscGVy
X2Rlc3RfZGVjbF9vcG4oZixyZWd0eXBlLHJlZ2lkLGkpOgogICAgIGlmIChoZXhfY29tbW9uLmlz
X3BhaXIocmVnaWQpKToKLSAgICAgICAgZ2VuX2hlbHBlcl9kZXN0X2RlY2xfcGFpcihmLHJlZ3R5
cGUscmVnaWQsaSkKKyAgICAgICAgaWYgKGhleF9jb21tb24uaXNfaHZ4X3JlZyhyZWd0eXBlKSk6
CisgICAgICAgICAgICBnZW5faGVscGVyX2Rlc3RfZGVjbF9leHRfcGFpcihmLHJlZ3R5cGUscmVn
aWQsIGkpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBnZW5faGVscGVyX2Rlc3RfZGVjbF9w
YWlyKGYscmVndHlwZSxyZWdpZCxpKQogICAgIGVsaWYgKGhleF9jb21tb24uaXNfc2luZ2xlKHJl
Z2lkKSk6Ci0gICAgICAgIGdlbl9oZWxwZXJfZGVzdF9kZWNsKGYscmVndHlwZSxyZWdpZCxpKQor
ICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc19odnhfcmVnKHJlZ3R5cGUpKToKKyAgICAgICAgICAg
IGdlbl9oZWxwZXJfZGVzdF9kZWNsX2V4dChmLHJlZ3R5cGUscmVnaWQpCisgICAgICAgIGVsc2U6
CisgICAgICAgICAgICBnZW5faGVscGVyX2Rlc3RfZGVjbChmLHJlZ3R5cGUscmVnaWQsaSkKICAg
ICBlbHNlOgogICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLHJlZ3R5cGUscmVn
aWQsdG9zcyxudW1yZWdzKQogCitkZWYgZ2VuX2hlbHBlcl9zcmNfdmFyX2V4dChmLHJlZ3R5cGUs
cmVnaWQpOgorICAgIGlmIChyZWd0eXBlID09ICJRIik6CisgICAgICAgZi53cml0ZSgiICAgIC8q
ICVzJXNWIGlzICooTU1RUmVnICopKCVzJXNWX3ZvaWQpICovXG4iICUgXAorICAgICAgICAgICAo
cmVndHlwZSxyZWdpZCxyZWd0eXBlLHJlZ2lkKSkKKyAgICBlbHNlOgorICAgICAgIGYud3JpdGUo
IiAgICAvKiAlcyVzViBpcyAqKE1NVmVjdG9yICopKCVzJXNWX3ZvaWQpICovXG4iICUgXAorICAg
ICAgICAgICAocmVndHlwZSxyZWdpZCxyZWd0eXBlLHJlZ2lkKSkKKworZGVmIGdlbl9oZWxwZXJf
c3JjX3Zhcl9leHRfcGFpcihmLHJlZ3R5cGUscmVnaWQscmVnbm8pOgorICAgIGYud3JpdGUoIiAg
ICAvKiAlcyVzViVzIGlzICooTU1WZWN0b3JQYWlyICopKCVzJXNWJXNfdm9pZCkgKi9cbiIgJSBc
CisgICAgICAgIChyZWd0eXBlLHJlZ2lkLHJlZ25vLHJlZ3R5cGUscmVnaWQscmVnbm8pKQorCiBk
ZWYgZ2VuX2hlbHBlcl9yZXR1cm4oZixyZWd0eXBlLHJlZ2lkLHJlZ25vKToKICAgICBmLndyaXRl
KCIgICAgcmV0dXJuICVzJXNWO1xuIiAlIChyZWd0eXBlLHJlZ2lkKSkKIAogZGVmIGdlbl9oZWxw
ZXJfcmV0dXJuX3BhaXIoZixyZWd0eXBlLHJlZ2lkLHJlZ25vKToKICAgICBmLndyaXRlKCIgICAg
cmV0dXJuICVzJXNWO1xuIiAlIChyZWd0eXBlLHJlZ2lkKSkKIAorZGVmIGdlbl9oZWxwZXJfZHN0
X3dyaXRlX2V4dChmLHJlZ3R5cGUscmVnaWQpOgorICAgIHJldHVybgorCitkZWYgZ2VuX2hlbHBl
cl9kc3Rfd3JpdGVfZXh0X3BhaXIoZixyZWd0eXBlLHJlZ2lkKToKKyAgICByZXR1cm4KKwogZGVm
IGdlbl9oZWxwZXJfcmV0dXJuX29wbihmLCByZWd0eXBlLCByZWdpZCwgaSk6CiAgICAgaWYgKGhl
eF9jb21tb24uaXNfcGFpcihyZWdpZCkpOgotICAgICAgICBnZW5faGVscGVyX3JldHVybl9wYWly
KGYscmVndHlwZSxyZWdpZCxpKQorICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc19odnhfcmVnKHJl
Z3R5cGUpKToKKyAgICAgICAgICAgIGdlbl9oZWxwZXJfZHN0X3dyaXRlX2V4dF9wYWlyKGYscmVn
dHlwZSxyZWdpZCkKKyAgICAgICAgZWxzZToKKyAgICAgICAgICAgIGdlbl9oZWxwZXJfcmV0dXJu
X3BhaXIoZixyZWd0eXBlLHJlZ2lkLGkpCiAgICAgZWxpZiAoaGV4X2NvbW1vbi5pc19zaW5nbGUo
cmVnaWQpKToKLSAgICAgICAgZ2VuX2hlbHBlcl9yZXR1cm4oZixyZWd0eXBlLHJlZ2lkLGkpCisg
ICAgICAgIGlmIChoZXhfY29tbW9uLmlzX2h2eF9yZWcocmVndHlwZSkpOgorICAgICAgICAgICAg
Z2VuX2hlbHBlcl9kc3Rfd3JpdGVfZXh0KGYscmVndHlwZSxyZWdpZCkKKyAgICAgICAgZWxzZToK
KyAgICAgICAgICAgIGdlbl9oZWxwZXJfcmV0dXJuKGYscmVndHlwZSxyZWdpZCxpKQogICAgIGVs
c2U6CiAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIscmVndHlwZSxyZWdpZCx0
b3NzLG51bXJlZ3MpCiAKQEAgLTEyOSwxNCArMTg1LDIwIEBAIGRlZiBnZW5faGVscGVyX2Z1bmN0
aW9uKGYsIHRhZywgdGFncmVncywgdGFnaW1tcyk6CiAgICAgICAgICAgICAgICAgJSAodGFnLCB0
YWcpKQogICAgIGVsc2U6CiAgICAgICAgICMjIFRoZSByZXR1cm4gdHlwZSBvZiB0aGUgZnVuY3Rp
b24gaXMgdGhlIHR5cGUgb2YgdGhlIGRlc3RpbmF0aW9uCi0gICAgICAgICMjIHJlZ2lzdGVyCisg
ICAgICAgICMjIHJlZ2lzdGVyIChpZiBzY2FsYXIpCiAgICAgICAgIGk9MAogICAgICAgICBmb3Ig
cmVndHlwZSxyZWdpZCx0b3NzLG51bXJlZ3MgaW4gcmVnczoKICAgICAgICAgICAgIGlmIChoZXhf
Y29tbW9uLmlzX3dyaXR0ZW4ocmVnaWQpKToKICAgICAgICAgICAgICAgICBpZiAoaGV4X2NvbW1v
bi5pc19wYWlyKHJlZ2lkKSk6Ci0gICAgICAgICAgICAgICAgICAgIGdlbl9oZWxwZXJfcmV0dXJu
X3R5cGVfcGFpcihmLHJlZ3R5cGUscmVnaWQsaSkKKyAgICAgICAgICAgICAgICAgICAgaWYgKGhl
eF9jb21tb24uaXNfaHZ4X3JlZyhyZWd0eXBlKSk6CisgICAgICAgICAgICAgICAgICAgICAgICBj
b250aW51ZQorICAgICAgICAgICAgICAgICAgICBlbHNlOgorICAgICAgICAgICAgICAgICAgICAg
ICAgZ2VuX2hlbHBlcl9yZXR1cm5fdHlwZV9wYWlyKGYscmVndHlwZSxyZWdpZCxpKQogICAgICAg
ICAgICAgICAgIGVsaWYgKGhleF9jb21tb24uaXNfc2luZ2xlKHJlZ2lkKSk6Ci0gICAgICAgICAg
ICAgICAgICAgIGdlbl9oZWxwZXJfcmV0dXJuX3R5cGUoZixyZWd0eXBlLHJlZ2lkLGkpCisgICAg
ICAgICAgICAgICAgICAgIGlmIChoZXhfY29tbW9uLmlzX2h2eF9yZWcocmVndHlwZSkpOgorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCisgICAgICAgICAgICAgICAgICAgIGVs
c2U6CisgICAgICAgICAgICAgICAgICAgICAgICBnZW5faGVscGVyX3JldHVybl90eXBlKGYscmVn
dHlwZSxyZWdpZCxpKQogICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAg
IHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIscmVndHlwZSxyZWdpZCx0b3NzLG51bXJlZ3Mp
CiAgICAgICAgICAgICBpICs9IDEKQEAgLTE0NSwxMSArMjA3LDMxIEBAIGRlZiBnZW5faGVscGVy
X2Z1bmN0aW9uKGYsIHRhZywgdGFncmVncywgdGFnaW1tcyk6CiAgICAgICAgICAgICBmLndyaXRl
KCJ2b2lkIikKICAgICAgICAgZi53cml0ZSgiIEhFTFBFUiglcykoQ1BVSGV4YWdvblN0YXRlICpl
bnYiICUgdGFnKQogCisgICAgICAgICMjIEFyZ3VtZW50cyBpbmNsdWRlIHRoZSB2ZWN0b3IgZGVz
dGluYXRpb24gb3BlcmFuZHMKICAgICAgICAgaSA9IDEKKyAgICAgICAgZm9yIHJlZ3R5cGUscmVn
aWQsdG9zcyxudW1yZWdzIGluIHJlZ3M6CisgICAgICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc193
cml0dGVuKHJlZ2lkKSk6CisgICAgICAgICAgICAgICAgaWYgKGhleF9jb21tb24uaXNfcGFpcihy
ZWdpZCkpOgorICAgICAgICAgICAgICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc19odnhfcmVnKHJl
Z3R5cGUpKToKKyAgICAgICAgICAgICAgICAgICAgICAgIGdlbl9oZWxwZXJfYXJnX2V4dF9wYWly
KGYscmVndHlwZSxyZWdpZCxpKQorICAgICAgICAgICAgICAgICAgICBlbHNlOgorICAgICAgICAg
ICAgICAgICAgICAgICAgY29udGludWUKKyAgICAgICAgICAgICAgICBlbGlmIChoZXhfY29tbW9u
LmlzX3NpbmdsZShyZWdpZCkpOgorICAgICAgICAgICAgICAgICAgICBpZiAoaGV4X2NvbW1vbi5p
c19odnhfcmVnKHJlZ3R5cGUpKToKKyAgICAgICAgICAgICAgICAgICAgICAgIGdlbl9oZWxwZXJf
YXJnX2V4dChmLHJlZ3R5cGUscmVnaWQsaSkKKyAgICAgICAgICAgICAgICAgICAgZWxzZToKKyAg
ICAgICAgICAgICAgICAgICAgICAgICMgVGhpcyBpcyB0aGUgcmV0dXJuIHZhbHVlIG9mIHRoZSBm
dW5jdGlvbgorICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUKKyAgICAgICAgICAgICAg
ICBlbHNlOgorICAgICAgICAgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAi
LHJlZ3R5cGUscmVnaWQsdG9zcyxudW1yZWdzKQorICAgICAgICAgICAgICAgIGkgKz0gMQogCiAg
ICAgICAgICMjIEFyZ3VtZW50cyB0byB0aGUgaGVscGVyIGZ1bmN0aW9uIGFyZSB0aGUgc291cmNl
IHJlZ3MgYW5kIGltbWVkaWF0ZXMKICAgICAgICAgZm9yIHJlZ3R5cGUscmVnaWQsdG9zcyxudW1y
ZWdzIGluIHJlZ3M6CiAgICAgICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc19yZWFkKHJlZ2lkKSk6
CisgICAgICAgICAgICAgICAgaWYgKGhleF9jb21tb24uaXNfaHZ4X3JlZyhyZWd0eXBlKSBhbmQK
KyAgICAgICAgICAgICAgICAgICAgaGV4X2NvbW1vbi5pc19yZWFkd3JpdGUocmVnaWQpKToKKyAg
ICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgICBnZW5faGVscGVyX2Fy
Z19vcG4oZixyZWd0eXBlLHJlZ2lkLGksdGFnKQogICAgICAgICAgICAgICAgIGkgKz0gMQogICAg
ICAgICBmb3IgaW1tbGV0dCxiaXRzLGltbXNoaWZ0IGluIGltbXM6CkBAIC0xNzMsNiArMjU1LDE3
IEBAIGRlZiBnZW5faGVscGVyX2Z1bmN0aW9uKGYsIHRhZywgdGFncmVncywgdGFnaW1tcyk6CiAg
ICAgICAgICAgICAgICAgZ2VuX2hlbHBlcl9kZXN0X2RlY2xfb3BuKGYscmVndHlwZSxyZWdpZCxp
KQogICAgICAgICAgICAgaSArPSAxCiAKKyAgICAgICAgZm9yIHJlZ3R5cGUscmVnaWQsdG9zcyxu
dW1yZWdzIGluIHJlZ3M6CisgICAgICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc19yZWFkKHJlZ2lk
KSk6CisgICAgICAgICAgICAgICAgaWYgKGhleF9jb21tb24uaXNfcGFpcihyZWdpZCkpOgorICAg
ICAgICAgICAgICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc19odnhfcmVnKHJlZ3R5cGUpKToKKyAg
ICAgICAgICAgICAgICAgICAgICAgIGdlbl9oZWxwZXJfc3JjX3Zhcl9leHRfcGFpcihmLHJlZ3R5
cGUscmVnaWQsaSkKKyAgICAgICAgICAgICAgICBlbGlmIChoZXhfY29tbW9uLmlzX3NpbmdsZShy
ZWdpZCkpOgorICAgICAgICAgICAgICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc19odnhfcmVnKHJl
Z3R5cGUpKToKKyAgICAgICAgICAgICAgICAgICAgICAgIGdlbl9oZWxwZXJfc3JjX3Zhcl9leHQo
ZixyZWd0eXBlLHJlZ2lkKQorICAgICAgICAgICAgICAgIGVsc2U6CisgICAgICAgICAgICAgICAg
ICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIscmVndHlwZSxyZWdpZCx0b3NzLG51bXJl
Z3MpCisKICAgICAgICAgaWYgJ0FfRlBPUCcgaW4gaGV4X2NvbW1vbi5hdHRyaWJkaWN0W3RhZ106
CiAgICAgICAgICAgICBmLndyaXRlKCcgICAgYXJjaF9mcG9wX3N0YXJ0KGVudik7XG4nKTsKIApk
aWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vZ2VuX2hlbHBlcl9wcm90b3MucHkgYi90YXJnZXQv
aGV4YWdvbi9nZW5faGVscGVyX3Byb3Rvcy5weQppbmRleCBlYTQxMDA3Li4yMjllZjhkIDEwMDc1
NQotLS0gYS90YXJnZXQvaGV4YWdvbi9nZW5faGVscGVyX3Byb3Rvcy5weQorKysgYi90YXJnZXQv
aGV4YWdvbi9nZW5faGVscGVyX3Byb3Rvcy5weQpAQCAtOTQsMTkgKzk0LDMzIEBAIGRlZiBnZW5f
aGVscGVyX3Byb3RvdHlwZShmLCB0YWcsIHRhZ3JlZ3MsIHRhZ2ltbXMpOgogICAgICAgICAgICAg
Zi53cml0ZSgnREVGX0hFTFBFUl8lcyglcycgJSAoZGVmX2hlbHBlcl9zaXplLCB0YWcpKQogCiAg
ICAgICAgICMjIEdlbmVyYXRlIHRoZSBxZW11IERFRl9IRUxQRVIgdHlwZSBmb3IgZWFjaCByZXN1
bHQKKyAgICAgICAgIyMgSXRlcmF0ZSBvdmVyIHRoaXMgbGlzdCB0d2ljZQorICAgICAgICAjIyAt
IEVtaXQgdGhlIHNjYWxhciByZXN1bHQKKyAgICAgICAgIyMgLSBFbWl0IHRoZSB2ZWN0b3IgcmVz
dWx0CiAgICAgICAgIGk9MAogICAgICAgICBmb3IgcmVndHlwZSxyZWdpZCx0b3NzLG51bXJlZ3Mg
aW4gcmVnczoKICAgICAgICAgICAgIGlmIChoZXhfY29tbW9uLmlzX3dyaXR0ZW4ocmVnaWQpKToK
LSAgICAgICAgICAgICAgICBnZW5fZGVmX2hlbHBlcl9vcG4oZiwgdGFnLCByZWd0eXBlLCByZWdp
ZCwgdG9zcywgbnVtcmVncywgaSkKKyAgICAgICAgICAgICAgICBpZiAobm90IGhleF9jb21tb24u
aXNfaHZ4X3JlZyhyZWd0eXBlKSk6CisgICAgICAgICAgICAgICAgICAgIGdlbl9kZWZfaGVscGVy
X29wbihmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCB0b3NzLCBudW1yZWdzLCBpKQogICAgICAgICAg
ICAgICAgIGkgKz0gMQogCiAgICAgICAgICMjIFB1dCB0aGUgZW52IGJldHdlZW4gdGhlIG91dHB1
dHMgYW5kIGlucHV0cwogICAgICAgICBmLndyaXRlKCcsIGVudicgKQogICAgICAgICBpICs9IDEK
IAorICAgICAgICAjIFNlY29uZCBwYXNzCisgICAgICAgIGZvciByZWd0eXBlLHJlZ2lkLHRvc3Ms
bnVtcmVncyBpbiByZWdzOgorICAgICAgICAgICAgaWYgKGhleF9jb21tb24uaXNfd3JpdHRlbihy
ZWdpZCkpOgorICAgICAgICAgICAgICAgIGlmIChoZXhfY29tbW9uLmlzX2h2eF9yZWcocmVndHlw
ZSkpOgorICAgICAgICAgICAgICAgICAgICBnZW5fZGVmX2hlbHBlcl9vcG4oZiwgdGFnLCByZWd0
eXBlLCByZWdpZCwgdG9zcywgbnVtcmVncywgaSkKKyAgICAgICAgICAgICAgICAgICAgaSArPSAx
CisKICAgICAgICAgIyMgR2VuZXJhdGUgdGhlIHFlbXUgdHlwZSBmb3IgZWFjaCBpbnB1dCBvcGVy
YW5kIChyZWdzIGFuZCBpbW1lZGlhdGVzKQogICAgICAgICBmb3IgcmVndHlwZSxyZWdpZCx0b3Nz
LG51bXJlZ3MgaW4gcmVnczoKICAgICAgICAgICAgIGlmIChoZXhfY29tbW9uLmlzX3JlYWQocmVn
aWQpKToKKyAgICAgICAgICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc19odnhfcmVnKHJlZ3R5cGUp
IGFuZAorICAgICAgICAgICAgICAgICAgICBoZXhfY29tbW9uLmlzX3JlYWR3cml0ZShyZWdpZCkp
OgorICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgIGdlbl9kZWZf
aGVscGVyX29wbihmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCB0b3NzLCBudW1yZWdzLCBpKQogICAg
ICAgICAgICAgICAgIGkgKz0gMQogICAgICAgICBmb3IgaW1tbGV0dCxiaXRzLGltbXNoaWZ0IGlu
IGltbXM6CmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi9nZW5fdGNnX2Z1bmNzLnB5IGIvdGFy
Z2V0L2hleGFnb24vZ2VuX3RjZ19mdW5jcy5weQppbmRleCA3Y2ViMjViLi45OGQzNDI0IDEwMDc1
NQotLS0gYS90YXJnZXQvaGV4YWdvbi9nZW5fdGNnX2Z1bmNzLnB5CisrKyBiL3RhcmdldC9oZXhh
Z29uL2dlbl90Y2dfZnVuY3MucHkKQEAgLTExOSwxMCArMTE5LDk1IEBAIGRlZiBnZW5wdHJfZGVj
bChmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCByZWdubyk6CiAgICAgICAgICAgICAgICAgKHJlZ3R5
cGUsIHJlZ2lkLCByZWd0eXBlLCByZWdpZCkpCiAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICBw
cmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKyAgICBlbGlmIChy
ZWd0eXBlID09ICJWIik6CisgICAgICAgIGlmIChyZWdpZCBpbiB7ImRkIn0pOgorICAgICAgICAg
ICAgZi53cml0ZSgiICAgIGNvbnN0IGludCAlcyVzTiA9IGluc24tPnJlZ25vWyVkXTtcbiIgJVwK
KyAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQsIHJlZ25vKSkKKyAgICAgICAgICAgIGYu
d3JpdGUoIiAgICBjb25zdCBpbnRwdHJfdCAlcyVzVl9vZmYgPVxuIiAlXAorICAgICAgICAgICAg
ICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICAgICAgaWYgKGhleF9jb21tb24uaXNfdG1w
X3Jlc3VsdCh0YWcpKToKKyAgICAgICAgICAgICAgICBmLndyaXRlKCIgICAgICAgIGN0eF90bXBf
dnJlZ19vZmYoY3R4LCAlcyVzTiwgMiwgdHJ1ZSk7XG4iICUgXAorICAgICAgICAgICAgICAgICAg
ICAgKHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgICAgIGVsc2U6CisgICAgICAgICAgICAgICAg
Zi53cml0ZSgiICAgICAgICBjdHhfZnV0dXJlX3ZyZWdfb2ZmKGN0eCwgJXMlc04sIiAlIFwKKyAg
ICAgICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkpCisgICAgICAgICAgICAgICAgZi53
cml0ZSgiIDIsIHRydWUpO1xuIikKKyAgICAgICAgICAgIGlmIChub3QgaGV4X2NvbW1vbi5za2lw
X3FlbXVfaGVscGVyKHRhZykpOgorICAgICAgICAgICAgICAgIGYud3JpdGUoIiAgICBUQ0d2X3B0
ciAlcyVzViA9IHRjZ190ZW1wX25ld19wdHIoKTtcbiIgJSBcCisgICAgICAgICAgICAgICAgICAg
IChyZWd0eXBlLCByZWdpZCkpCisgICAgICAgICAgICAgICAgZi53cml0ZSgiICAgIHRjZ19nZW5f
YWRkaV9wdHIoJXMlc1YsIGNwdV9lbnYsICVzJXNWX29mZik7XG4iICUgXAorICAgICAgICAgICAg
ICAgICAgICAocmVndHlwZSwgcmVnaWQsIHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgZWxpZiAo
cmVnaWQgaW4geyJ1dSIsICJ2diIsICJ4eCJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICBj
b25zdCBpbnQgJXMlc04gPSBpbnNuLT5yZWdub1slZF07XG4iICVcCisgICAgICAgICAgICAgICAg
KHJlZ3R5cGUsIHJlZ2lkLCByZWdubykpCisgICAgICAgICAgICBmLndyaXRlKCIgICAgY29uc3Qg
aW50cHRyX3QgJXMlc1Zfb2ZmID1cbiIgJSBcCisgICAgICAgICAgICAgICAgIChyZWd0eXBlLCBy
ZWdpZCkpCisgICAgICAgICAgICBmLndyaXRlKCIgICAgICAgIG9mZnNldG9mKENQVUhleGFnb25T
dGF0ZSwgJXMlc1YpO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkK
KyAgICAgICAgICAgIGlmIChub3QgaGV4X2NvbW1vbi5za2lwX3FlbXVfaGVscGVyKHRhZykpOgor
ICAgICAgICAgICAgICAgIGYud3JpdGUoIiAgICBUQ0d2X3B0ciAlcyVzViA9IHRjZ190ZW1wX25l
d19wdHIoKTtcbiIgJSBcCisgICAgICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkpCisg
ICAgICAgICAgICAgICAgZi53cml0ZSgiICAgIHRjZ19nZW5fYWRkaV9wdHIoJXMlc1YsIGNwdV9l
bnYsICVzJXNWX29mZik7XG4iICUgXAorICAgICAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVn
aWQsIHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgZWxpZiAocmVnaWQgaW4geyJzIiwgInUiLCAi
diIsICJ3In0pOgorICAgICAgICAgICAgZi53cml0ZSgiICAgIGNvbnN0IGludCAlcyVzTiA9IGlu
c24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCBy
ZWdubykpCisgICAgICAgICAgICBmLndyaXRlKCIgICAgY29uc3QgaW50cHRyX3QgJXMlc1Zfb2Zm
ID1cbiIgJSBcCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQp
KQorICAgICAgICAgICAgZi53cml0ZSgiICAgICAgICB2cmVnX3NyY19vZmYoY3R4LCAlcyVzTik7
XG4iICUgXAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkK
KyAgICAgICAgICAgIGlmIChub3QgaGV4X2NvbW1vbi5za2lwX3FlbXVfaGVscGVyKHRhZykpOgor
ICAgICAgICAgICAgICAgIGYud3JpdGUoIiAgICBUQ0d2X3B0ciAlcyVzViA9IHRjZ190ZW1wX25l
d19wdHIoKTtcbiIgJSBcCisgICAgICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkpCisg
ICAgICAgIGVsaWYgKHJlZ2lkIGluIHsiZCIsICJ4IiwgInkifSk6CisgICAgICAgICAgICBmLndy
aXRlKCIgICAgY29uc3QgaW50ICVzJXNOID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwKKyAgICAg
ICAgICAgICAgICAocmVndHlwZSwgcmVnaWQsIHJlZ25vKSkKKyAgICAgICAgICAgIGYud3JpdGUo
IiAgICBjb25zdCBpbnRwdHJfdCAlcyVzVl9vZmYgPVxuIiAlIFwKKyAgICAgICAgICAgICAgICAo
cmVndHlwZSwgcmVnaWQpKQorICAgICAgICAgICAgaWYgKGhleF9jb21tb24uaXNfdG1wX3Jlc3Vs
dCh0YWcpKToKKyAgICAgICAgICAgICAgICBmLndyaXRlKCIgICAgICAgIGN0eF90bXBfdnJlZ19v
ZmYoY3R4LCAlcyVzTiwgMSwgdHJ1ZSk7XG4iICUgXAorICAgICAgICAgICAgICAgICAgICAocmVn
dHlwZSwgcmVnaWQpKQorICAgICAgICAgICAgZWxzZToKKyAgICAgICAgICAgICAgICBmLndyaXRl
KCIgICAgICAgIGN0eF9mdXR1cmVfdnJlZ19vZmYoY3R4LCAlcyVzTiwiICVcCisgICAgICAgICAg
ICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkpCisgICAgICAgICAgICAgICAgZi53cml0ZSgiIDEs
IHRydWUpO1xuIik7CisgICAgICAgICAgICBpZiAobm90IGhleF9jb21tb24uc2tpcF9xZW11X2hl
bHBlcih0YWcpKToKKyAgICAgICAgICAgICAgICBmLndyaXRlKCIgICAgVENHdl9wdHIgJXMlc1Yg
PSB0Y2dfdGVtcF9uZXdfcHRyKCk7XG4iICUgXAorICAgICAgICAgICAgICAgICAgICAocmVndHlw
ZSwgcmVnaWQpKQorICAgICAgICAgICAgICAgIGYud3JpdGUoIiAgICB0Y2dfZ2VuX2FkZGlfcHRy
KCVzJXNWLCBjcHVfZW52LCAlcyVzVl9vZmYpO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAgICAg
KHJlZ3R5cGUsIHJlZ2lkLCByZWd0eXBlLCByZWdpZCkpCisgICAgICAgIGVsc2U6CisgICAgICAg
ICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKyAgICBl
bGlmIChyZWd0eXBlID09ICJRIik6CisgICAgICAgIGlmIChyZWdpZCBpbiB7ImQiLCAiZSIsICJ4
In0pOgorICAgICAgICAgICAgZi53cml0ZSgiICAgIGNvbnN0IGludCAlcyVzTiA9IGluc24tPnJl
Z25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWdubykp
CisgICAgICAgICAgICBmLndyaXRlKCIgICAgY29uc3QgaW50cHRyX3QgJXMlc1Zfb2ZmID1cbiIg
JSBcCisgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgICAgIGYud3Jp
dGUoIiAgICAgICAgb2Zmc2V0b2YoQ1BVSGV4YWdvblN0YXRlLFxuIikKKyAgICAgICAgICAgIGYu
d3JpdGUoIiAgICAgICAgICAgICAgICAgZnV0dXJlX1FSZWdzWyVzJXNOXSk7XG4iICUgXAorICAg
ICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkpCisgICAgICAgICAgICBpZiAobm90IGhleF9j
b21tb24uc2tpcF9xZW11X2hlbHBlcih0YWcpKToKKyAgICAgICAgICAgICAgICBmLndyaXRlKCIg
ICAgVENHdl9wdHIgJXMlc1YgPSB0Y2dfdGVtcF9uZXdfcHRyKCk7XG4iICUgXAorICAgICAgICAg
ICAgICAgICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICAgICAgICAgIGYud3JpdGUoIiAg
ICB0Y2dfZ2VuX2FkZGlfcHRyKCVzJXNWLCBjcHVfZW52LCAlcyVzVl9vZmYpO1xuIiAlIFwKKyAg
ICAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWd0eXBlLCByZWdpZCkpCisgICAg
ICAgIGVsaWYgKHJlZ2lkIGluIHsicyIsICJ0IiwgInUiLCAidiJ9KToKKyAgICAgICAgICAgIGYu
d3JpdGUoIiAgICBjb25zdCBpbnQgJXMlc04gPSBpbnNuLT5yZWdub1slZF07XG4iICUgXAorICAg
ICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCwgcmVnbm8pKQorICAgICAgICAgICAgZi53cml0
ZSgiICAgIGNvbnN0IGludHB0cl90ICVzJXNWX29mZiA9XG4iICVcCisgICAgICAgICAgICAgICAg
KHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICAgICAgb2Zmc2V0b2Yo
Q1BVSGV4YWdvblN0YXRlLCBRUmVnc1slcyVzTl0pO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAo
cmVndHlwZSwgcmVnaWQpKQorICAgICAgICAgICAgaWYgKG5vdCBoZXhfY29tbW9uLnNraXBfcWVt
dV9oZWxwZXIodGFnKSk6CisgICAgICAgICAgICAgICAgZi53cml0ZSgiICAgIFRDR3ZfcHRyICVz
JXNWID0gdGNnX3RlbXBfbmV3X3B0cigpO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAgICAgKHJl
Z3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgZWxzZToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVn
aXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQogICAgIGVsc2U6CiAgICAgICAgIHByaW50
KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQogCi1kZWYgZ2VucHRyX2Rl
Y2xfbmV3KGYscmVndHlwZSxyZWdpZCxyZWdubyk6CitkZWYgZ2VucHRyX2RlY2xfbmV3KGYsIHRh
ZywgcmVndHlwZSwgcmVnaWQsIHJlZ25vKToKICAgICBpZiAocmVndHlwZSA9PSAiTiIpOgogICAg
ICAgICBpZiAocmVnaWQgaW4geyJzIiwgInQifSk6CiAgICAgICAgICAgICBmLndyaXRlKCIgICAg
VENHdiAlcyVzTiA9IGhleF9uZXdfdmFsdWVbaW5zbi0+cmVnbm9bJWRdXTtcbiIgJSBcCkBAIC0x
MzUsNiArMjIwLDIxIEBAIGRlZiBnZW5wdHJfZGVjbF9uZXcoZixyZWd0eXBlLHJlZ2lkLHJlZ25v
KToKICAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQsIHJlZ25vKSkKICAgICAgICAgZWxz
ZToKICAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJl
Z2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIk8iKToKKyAgICAgICAgaWYgKHJlZ2lkID09ICJz
Iik6CisgICAgICAgICAgICBmLndyaXRlKCIgICAgY29uc3QgaW50cHRyX3QgJXMlc05fbnVtID0g
aW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQs
IHJlZ25vKSkKKyAgICAgICAgICAgIGlmIChoZXhfY29tbW9uLnNraXBfcWVtdV9oZWxwZXIodGFn
KSk6CisgICAgICAgICAgICAgICAgZi53cml0ZSgiICAgIGNvbnN0IGludHB0cl90ICVzJXNOX29m
ZiA9XG4iICUgXAorICAgICAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAg
ICAgICAgICAgIGYud3JpdGUoIiAgICAgICAgIGN0eF9mdXR1cmVfdnJlZ19vZmYoY3R4LCAlcyVz
Tl9udW0sIiAlIFwKKyAgICAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAg
ICAgICAgICAgICBmLndyaXRlKCIgMSwgdHJ1ZSk7XG4iKQorICAgICAgICAgICAgZWxzZToKKyAg
ICAgICAgICAgICAgICBmLndyaXRlKCIgICAgVENHdiAlcyVzTiA9IHRjZ19jb25zdF90bCglcyVz
Tl9udW0pO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWd0
eXBlLCByZWdpZCkpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lz
dGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKICAgICBlbHNlOgogICAgICAgICBwcmludCgi
QmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKIApAQCAtMTQ1LDcgKzI0NSw3
IEBAIGRlZiBnZW5wdHJfZGVjbF9vcG4oZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgdG9zcywgbnVt
cmVncywgaSk6CiAgICAgICAgIGlmIGhleF9jb21tb24uaXNfb2xkX3ZhbChyZWd0eXBlLCByZWdp
ZCwgdGFnKToKICAgICAgICAgICAgIGdlbnB0cl9kZWNsKGYsdGFnLCByZWd0eXBlLCByZWdpZCwg
aSkKICAgICAgICAgZWxpZiBoZXhfY29tbW9uLmlzX25ld192YWwocmVndHlwZSwgcmVnaWQsIHRh
Zyk6Ci0gICAgICAgICAgICBnZW5wdHJfZGVjbF9uZXcoZixyZWd0eXBlLHJlZ2lkLGkpCisgICAg
ICAgICAgICBnZW5wdHJfZGVjbF9uZXcoZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgaSkKICAgICAg
ICAgZWxzZToKICAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIscmVndHlw
ZSxyZWdpZCx0b3NzLG51bXJlZ3MpCiAgICAgZWxzZToKQEAgLTE1OSw3ICsyNTksNyBAQCBkZWYg
Z2VucHRyX2RlY2xfaW1tKGYsaW1tbGV0dCk6CiAgICAgZi53cml0ZSgiICAgIGludCAlcyA9IGlu
c24tPmltbWVkWyVkXTtcbiIgJSBcCiAgICAgICAgIChoZXhfY29tbW9uLmltbV9uYW1lKGltbWxl
dHQpLCBpKSkKIAotZGVmIGdlbnB0cl9mcmVlKGYscmVndHlwZSxyZWdpZCxyZWdubyk6CitkZWYg
Z2VucHRyX2ZyZWUoZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgcmVnbm8pOgogICAgIGlmIChyZWd0
eXBlID09ICJSIik6CiAgICAgICAgIGlmIChyZWdpZCBpbiB7ImRkIiwgInNzIiwgInR0IiwgInh4
IiwgInl5In0pOgogICAgICAgICAgICAgZi53cml0ZSgiICAgIHRjZ190ZW1wX2ZyZWVfaTY0KCVz
JXNWKTtcbiIgJSAocmVndHlwZSwgcmVnaWQpKQpAQCAtMTgyLDMzICsyODIsNTUgQEAgZGVmIGdl
bnB0cl9mcmVlKGYscmVndHlwZSxyZWdpZCxyZWdubyk6CiAgICAgZWxpZiAocmVndHlwZSA9PSAi
TSIpOgogICAgICAgICBpZiAocmVnaWQgIT0gInUiKToKICAgICAgICAgICAgIHByaW50KCJCYWQg
cmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0g
IlYiKToKKyAgICAgICAgaWYgKHJlZ2lkIGluIHsiZGQiLCAidXUiLCAidnYiLCAieHgiLCBcCisg
ICAgICAgICAgICAgICAgICAgICAgImQiLCAicyIsICJ1IiwgInYiLCAidyIsICJ4IiwgInkifSk6
CisgICAgICAgICAgICBpZiAobm90IGhleF9jb21tb24uc2tpcF9xZW11X2hlbHBlcih0YWcpKToK
KyAgICAgICAgICAgICAgICBmLndyaXRlKCIgICAgdGNnX3RlbXBfZnJlZV9wdHIoJXMlc1YpO1xu
IiAlIFwKKyAgICAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgZWxz
ZToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJl
Z2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIlEiKToKKyAgICAgICAgaWYgKHJlZ2lkIGluIHsi
ZCIsICJlIiwgInMiLCAidCIsICJ1IiwgInYiLCAieCJ9KToKKyAgICAgICAgICAgIGlmIChub3Qg
aGV4X2NvbW1vbi5za2lwX3FlbXVfaGVscGVyKHRhZykpOgorICAgICAgICAgICAgICAgIGYud3Jp
dGUoIiAgICB0Y2dfdGVtcF9mcmVlX3B0ciglcyVzVik7XG4iICUgXAorICAgICAgICAgICAgICAg
ICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICBlbHNlOgorICAgICAgICAgICAgcHJpbnQo
IkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCiAgICAgZWxzZToKICAgICAg
ICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCiAKLWRlZiBn
ZW5wdHJfZnJlZV9uZXcoZixyZWd0eXBlLHJlZ2lkLHJlZ25vKToKK2RlZiBnZW5wdHJfZnJlZV9u
ZXcoZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgcmVnbm8pOgogICAgIGlmIChyZWd0eXBlID09ICJO
Iik6CiAgICAgICAgIGlmIChyZWdpZCBub3QgaW4geyJzIiwgInQifSk6CiAgICAgICAgICAgICBw
cmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKICAgICBlbGlmIChy
ZWd0eXBlID09ICJQIik6CiAgICAgICAgIGlmIChyZWdpZCBub3QgaW4geyJ0IiwgInUiLCAidiJ9
KToKICAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJl
Z2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIk8iKToKKyAgICAgICAgaWYgKHJlZ2lkID09ICJz
Iik6CisgICAgICAgICAgICBpZiAobm90IGhleF9jb21tb24uc2tpcF9xZW11X2hlbHBlcih0YWcp
KToKKyAgICAgICAgICAgICAgICBmLndyaXRlKCIgICAgdGNnX3RlbXBfZnJlZSglcyVzTik7XG4i
ICUgXAorICAgICAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICBlbHNl
OgorICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVn
aWQpCiAgICAgZWxzZToKICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVn
dHlwZSwgcmVnaWQpCiAKIGRlZiBnZW5wdHJfZnJlZV9vcG4oZixyZWd0eXBlLHJlZ2lkLGksdGFn
KToKICAgICBpZiAoaGV4X2NvbW1vbi5pc19wYWlyKHJlZ2lkKSk6Ci0gICAgICAgIGdlbnB0cl9m
cmVlKGYscmVndHlwZSxyZWdpZCxpKQorICAgICAgICBnZW5wdHJfZnJlZShmLCB0YWcsIHJlZ3R5
cGUsIHJlZ2lkLCBpKQogICAgIGVsaWYgKGhleF9jb21tb24uaXNfc2luZ2xlKHJlZ2lkKSk6CiAg
ICAgICAgIGlmIGhleF9jb21tb24uaXNfb2xkX3ZhbChyZWd0eXBlLCByZWdpZCwgdGFnKToKLSAg
ICAgICAgICAgIGdlbnB0cl9mcmVlKGYscmVndHlwZSxyZWdpZCxpKQorICAgICAgICAgICAgZ2Vu
cHRyX2ZyZWUoZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgaSkKICAgICAgICAgZWxpZiBoZXhfY29t
bW9uLmlzX25ld192YWwocmVndHlwZSwgcmVnaWQsIHRhZyk6Ci0gICAgICAgICAgICBnZW5wdHJf
ZnJlZV9uZXcoZixyZWd0eXBlLHJlZ2lkLGkpCisgICAgICAgICAgICBnZW5wdHJfZnJlZV9uZXco
ZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgaSkKICAgICAgICAgZWxzZToKICAgICAgICAgICAgIHBy
aW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIscmVndHlwZSxyZWdpZCx0b3NzLG51bXJlZ3MpCiAg
ICAgZWxzZToKICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIixyZWd0eXBlLHJl
Z2lkLHRvc3MsbnVtcmVncykKIAotZGVmIGdlbnB0cl9zcmNfcmVhZChmLHJlZ3R5cGUscmVnaWQp
OgorZGVmIGdlbnB0cl9zcmNfcmVhZChmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkKToKICAgICBpZiAo
cmVndHlwZSA9PSAiUiIpOgogICAgICAgICBpZiAocmVnaWQgaW4geyJzcyIsICJ0dCIsICJ4eCIs
ICJ5eSJ9KToKICAgICAgICAgICAgIGYud3JpdGUoIiAgICB0Y2dfZ2VuX2NvbmNhdF9pMzJfaTY0
KCVzJXNWLCBoZXhfZ3ByWyVzJXNOXSxcbiIgJSBcCkBAIC0yMzgsNiArMzYwLDQ3IEBAIGRlZiBn
ZW5wdHJfc3JjX3JlYWQoZixyZWd0eXBlLHJlZ2lkKToKICAgICBlbGlmIChyZWd0eXBlID09ICJN
Iik6CiAgICAgICAgIGlmIChyZWdpZCAhPSAidSIpOgogICAgICAgICAgICAgcHJpbnQoIkJhZCBy
ZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCisgICAgZWxpZiAocmVndHlwZSA9PSAi
ViIpOgorICAgICAgICBpZiAocmVnaWQgaW4geyJ1dSIsICJ2diIsICJ4eCJ9KToKKyAgICAgICAg
ICAgIGYud3JpdGUoIiAgICB0Y2dfZ2VuX2d2ZWNfbW92KE1PXzY0LCAlcyVzVl9vZmYsXG4iICUg
XAorICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkpCisgICAgICAgICAgICBmLndyaXRl
KCIgICAgICAgIHZyZWdfc3JjX29mZihjdHgsICVzJXNOKSxcbiIgJSBcCisgICAgICAgICAgICAg
ICAgKHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICAgICAgc2l6ZW9m
KE1NVmVjdG9yKSwgc2l6ZW9mKE1NVmVjdG9yKSk7XG4iKQorICAgICAgICAgICAgZi53cml0ZSgi
ICAgIHRjZ19nZW5fZ3ZlY19tb3YoTU9fNjQsXG4iKQorICAgICAgICAgICAgZi53cml0ZSgiICAg
ICAgICAlcyVzVl9vZmYgKyBzaXplb2YoTU1WZWN0b3IpLFxuIiAlIFwKKyAgICAgICAgICAgICAg
ICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICAgICAgZi53cml0ZSgiICAgICAgICB2cmVnX3Ny
Y19vZmYoY3R4LCAlcyVzTiBeIDEpLFxuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVndHlwZSwg
cmVnaWQpKQorICAgICAgICAgICAgZi53cml0ZSgiICAgICAgICBzaXplb2YoTU1WZWN0b3IpLCBz
aXplb2YoTU1WZWN0b3IpKTtcbiIpCisgICAgICAgIGVsaWYgKHJlZ2lkIGluIHsicyIsICJ1Iiwg
InYiLCAidyJ9KToKKyAgICAgICAgICAgIGlmIChub3QgaGV4X2NvbW1vbi5za2lwX3FlbXVfaGVs
cGVyKHRhZykpOgorICAgICAgICAgICAgICAgIGYud3JpdGUoIiAgICB0Y2dfZ2VuX2FkZGlfcHRy
KCVzJXNWLCBjcHVfZW52LCAlcyVzVl9vZmYpO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCwgcmVndHlwZSwgcmVnaWQpKQorICAgICAgICBl
bGlmIChyZWdpZCBpbiB7IngiLCAieSJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICB0Y2df
Z2VuX2d2ZWNfbW92KE1PXzY0LCAlcyVzVl9vZmYsXG4iICUgXAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICAgICAgZi53cml0ZSgiICAgICAg
ICB2cmVnX3NyY19vZmYoY3R4LCAlcyVzTiksXG4iICUgXAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICAgICAgZi53cml0ZSgiICAgICAgICBz
aXplb2YoTU1WZWN0b3IpLCBzaXplb2YoTU1WZWN0b3IpKTtcbiIpCisgICAgICAgICAgICBpZiAo
bm90IGhleF9jb21tb24uc2tpcF9xZW11X2hlbHBlcih0YWcpKToKKyAgICAgICAgICAgICAgICBm
LndyaXRlKCIgICAgdGNnX2dlbl9hZGRpX3B0ciglcyVzViwgY3B1X2VudiwgJXMlc1Zfb2ZmKTtc
biIgJSBcCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQs
IHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgZWxzZToKKyAgICAgICAgICAgIHByaW50KCJCYWQg
cmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0g
IlEiKToKKyAgICAgICAgaWYgKHJlZ2lkIGluIHsicyIsICJ0IiwgInUiLCAidiJ9KToKKyAgICAg
ICAgICAgIGlmIChub3QgaGV4X2NvbW1vbi5za2lwX3FlbXVfaGVscGVyKHRhZykpOgorICAgICAg
ICAgICAgICAgIGYud3JpdGUoIiAgICB0Y2dfZ2VuX2FkZGlfcHRyKCVzJXNWLCBjcHVfZW52LCAl
cyVzVl9vZmYpO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCBy
ZWd0eXBlLCByZWdpZCkpCisgICAgICAgIGVsaWYgKHJlZ2lkIGluIHsieCJ9KToKKyAgICAgICAg
ICAgIGYud3JpdGUoIiAgICB0Y2dfZ2VuX2d2ZWNfbW92KE1PXzY0LCAlcyVzVl9vZmYsXG4iICUg
XAorICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkpCisgICAgICAgICAgICBmLndyaXRl
KCIgICAgICAgIG9mZnNldG9mKENQVUhleGFnb25TdGF0ZSwgUVJlZ3NbJXMlc05dKSxcbiIgJSBc
CisgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgICAgIGYud3JpdGUo
IiAgICAgICAgc2l6ZW9mKE1NUVJlZyksIHNpemVvZihNTVFSZWcpKTtcbiIpCisgICAgICAgIGVs
c2U6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCBy
ZWdpZCkKICAgICBlbHNlOgogICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCBy
ZWd0eXBlLCByZWdpZCkKIApAQCAtMjQ4LDE1ICs0MTEsMTggQEAgZGVmIGdlbnB0cl9zcmNfcmVh
ZF9uZXcoZixyZWd0eXBlLHJlZ2lkKToKICAgICBlbGlmIChyZWd0eXBlID09ICJQIik6CiAgICAg
ICAgIGlmIChyZWdpZCBub3QgaW4geyJ0IiwgInUiLCAidiJ9KToKICAgICAgICAgICAgIHByaW50
KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQorICAgIGVsaWYgKHJlZ3R5
cGUgPT0gIk8iKToKKyAgICAgICAgaWYgKHJlZ2lkICE9ICJzIik6CisgICAgICAgICAgICBwcmlu
dCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKICAgICBlbHNlOgogICAg
ICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKIAogZGVm
IGdlbnB0cl9zcmNfcmVhZF9vcG4oZixyZWd0eXBlLHJlZ2lkLHRhZyk6CiAgICAgaWYgKGhleF9j
b21tb24uaXNfcGFpcihyZWdpZCkpOgotICAgICAgICBnZW5wdHJfc3JjX3JlYWQoZixyZWd0eXBl
LHJlZ2lkKQorICAgICAgICBnZW5wdHJfc3JjX3JlYWQoZiwgdGFnLCByZWd0eXBlLCByZWdpZCkK
ICAgICBlbGlmIChoZXhfY29tbW9uLmlzX3NpbmdsZShyZWdpZCkpOgogICAgICAgICBpZiBoZXhf
Y29tbW9uLmlzX29sZF92YWwocmVndHlwZSwgcmVnaWQsIHRhZyk6Ci0gICAgICAgICAgICBnZW5w
dHJfc3JjX3JlYWQoZixyZWd0eXBlLHJlZ2lkKQorICAgICAgICAgICAgZ2VucHRyX3NyY19yZWFk
KGYsIHRhZywgcmVndHlwZSwgcmVnaWQpCiAgICAgICAgIGVsaWYgaGV4X2NvbW1vbi5pc19uZXdf
dmFsKHJlZ3R5cGUsIHJlZ2lkLCB0YWcpOgogICAgICAgICAgICAgZ2VucHRyX3NyY19yZWFkX25l
dyhmLHJlZ3R5cGUscmVnaWQpCiAgICAgICAgIGVsc2U6CkBAIC0zMzQsMTEgKzUwMCw2OCBAQCBk
ZWYgZ2VucHRyX2RzdF93cml0ZShmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkKToKICAgICBlbHNlOgog
ICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKIAor
ZGVmIGdlbnB0cl9kc3Rfd3JpdGVfZXh0KGYsIHRhZywgcmVndHlwZSwgcmVnaWQsIG5ld3Y9IjAi
KToKKyAgICBpZiAocmVndHlwZSA9PSAiViIpOgorICAgICAgICBpZiAocmVnaWQgaW4geyJkZCIs
ICJ4eCIsICJ5eSJ9KToKKyAgICAgICAgICAgIGlmICgnQV9DT05ERVhFQycgaW4gaGV4X2NvbW1v
bi5hdHRyaWJkaWN0W3RhZ10pOgorICAgICAgICAgICAgICAgIGlzX3ByZWRpY2F0ZWQgPSAidHJ1
ZSIKKyAgICAgICAgICAgIGVsc2U6CisgICAgICAgICAgICAgICAgaXNfcHJlZGljYXRlZCA9ICJm
YWxzZSIKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICBnZW5fbG9nX3ZyZWdfd3JpdGVfcGFpcihj
dHgsICVzJXNWX29mZiwgJXMlc04sICIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJl
Z2lkLCByZWd0eXBlLCByZWdpZCkpCisgICAgICAgICAgICBmLndyaXRlKCIlcywgaW5zbi0+c2xv
dCwgJXMsIHBrdC0+dmhpc3RfaW5zbiAhPSBOVUxMKTtcbiIgJSBcCisgICAgICAgICAgICAgICAg
KG5ld3YsIGlzX3ByZWRpY2F0ZWQpKQorICAgICAgICAgICAgZi53cml0ZSgiICAgIGN0eF9sb2df
dnJlZ193cml0ZV9wYWlyKGN0eCwgJXMlc04sICVzLFxuIiAlIFwKKyAgICAgICAgICAgICAgICAo
cmVndHlwZSwgcmVnaWQsIG5ld3YpKQorICAgICAgICAgICAgZi53cml0ZSgiICAgICAgICAlcyk7
XG4iICUgKGlzX3ByZWRpY2F0ZWQpKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7ImQiLCAieCIs
ICJ5In0pOgorICAgICAgICAgICAgaWYgKCdBX0NPTkRFWEVDJyBpbiBoZXhfY29tbW9uLmF0dHJp
YmRpY3RbdGFnXSk6CisgICAgICAgICAgICAgICAgaXNfcHJlZGljYXRlZCA9ICJ0cnVlIgorICAg
ICAgICAgICAgZWxzZToKKyAgICAgICAgICAgICAgICBpc19wcmVkaWNhdGVkID0gImZhbHNlIgor
ICAgICAgICAgICAgZi53cml0ZSgiICAgIGdlbl9sb2dfdnJlZ193cml0ZShjdHgsICVzJXNWX29m
ZiwgJXMlc04sICVzLCAiICUgXAorICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCwgcmVn
dHlwZSwgcmVnaWQsIG5ld3YpKQorICAgICAgICAgICAgZi53cml0ZSgiaW5zbi0+c2xvdCwgJXMs
IHBrdC0+dmhpc3RfaW5zbiAhPSBOVUxMKTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKGlzX3By
ZWRpY2F0ZWQpKQorICAgICAgICAgICAgZi53cml0ZSgiICAgIGN0eF9sb2dfdnJlZ193cml0ZShj
dHgsICVzJXNOLCAlcywgJXMpO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVn
aWQsIG5ld3YsIGlzX3ByZWRpY2F0ZWQpKQorICAgICAgICBlbHNlOgorICAgICAgICAgICAgcHJp
bnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCisgICAgZWxpZiAocmVn
dHlwZSA9PSAiUSIpOgorICAgICAgICBpZiAocmVnaWQgaW4geyJkIiwgImUiLCAieCJ9KToKKyAg
ICAgICAgICAgIGlmICgnQV9DT05ERVhFQycgaW4gaGV4X2NvbW1vbi5hdHRyaWJkaWN0W3RhZ10p
OgorICAgICAgICAgICAgICAgIGlzX3ByZWRpY2F0ZWQgPSAidHJ1ZSIKKyAgICAgICAgICAgIGVs
c2U6CisgICAgICAgICAgICAgICAgaXNfcHJlZGljYXRlZCA9ICJmYWxzZSIKKyAgICAgICAgICAg
IGYud3JpdGUoIiAgICBnZW5fbG9nX3FyZWdfd3JpdGUoJXMlc1Zfb2ZmLCAlcyVzTiwgJXMsICIg
JSBcCisgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWd0eXBlLCByZWdpZCwgbmV3
dikpCisgICAgICAgICAgICBmLndyaXRlKCJpbnNuLT5zbG90LCAlcyk7XG4iICUgKGlzX3ByZWRp
Y2F0ZWQpKQorICAgICAgICAgICAgZi53cml0ZSgiICAgIGN0eF9sb2dfcXJlZ193cml0ZShjdHgs
ICVzJXNOLCAlcyk7XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCwgaXNf
cHJlZGljYXRlZCkpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lz
dGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKyAgICBlbHNlOgorICAgICAgICBwcmludCgi
QmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKwogZGVmIGdlbnB0cl9kc3Rf
d3JpdGVfb3BuKGYscmVndHlwZSwgcmVnaWQsIHRhZyk6CiAgICAgaWYgKGhleF9jb21tb24uaXNf
cGFpcihyZWdpZCkpOgotICAgICAgICBnZW5wdHJfZHN0X3dyaXRlKGYsIHRhZywgcmVndHlwZSwg
cmVnaWQpCisgICAgICAgIGlmIChoZXhfY29tbW9uLmlzX2h2eF9yZWcocmVndHlwZSkpOgorICAg
ICAgICAgICAgaWYgKGhleF9jb21tb24uaXNfdG1wX3Jlc3VsdCh0YWcpKToKKyAgICAgICAgICAg
ICAgICBnZW5wdHJfZHN0X3dyaXRlX2V4dChmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCAiRVhUX1RN
UCIpCisgICAgICAgICAgICBlbHNlOgorICAgICAgICAgICAgICAgIGdlbnB0cl9kc3Rfd3JpdGVf
ZXh0KGYsIHRhZywgcmVndHlwZSwgcmVnaWQpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBn
ZW5wdHJfZHN0X3dyaXRlKGYsIHRhZywgcmVndHlwZSwgcmVnaWQpCiAgICAgZWxpZiAoaGV4X2Nv
bW1vbi5pc19zaW5nbGUocmVnaWQpKToKLSAgICAgICAgZ2VucHRyX2RzdF93cml0ZShmLCB0YWcs
IHJlZ3R5cGUsIHJlZ2lkKQorICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc19odnhfcmVnKHJlZ3R5
cGUpKToKKyAgICAgICAgICAgIGlmIChoZXhfY29tbW9uLmlzX25ld19yZXN1bHQodGFnKSk6Cisg
ICAgICAgICAgICAgICAgZ2VucHRyX2RzdF93cml0ZV9leHQoZiwgdGFnLCByZWd0eXBlLCByZWdp
ZCwgIkVYVF9ORVciKQorICAgICAgICAgICAgaWYgKGhleF9jb21tb24uaXNfdG1wX3Jlc3VsdCh0
YWcpKToKKyAgICAgICAgICAgICAgICBnZW5wdHJfZHN0X3dyaXRlX2V4dChmLCB0YWcsIHJlZ3R5
cGUsIHJlZ2lkLCAiRVhUX1RNUCIpCisgICAgICAgICAgICBlbHNlOgorICAgICAgICAgICAgICAg
IGdlbnB0cl9kc3Rfd3JpdGVfZXh0KGYsIHRhZywgcmVndHlwZSwgcmVnaWQsICJFWFRfREZMIikK
KyAgICAgICAgZWxzZToKKyAgICAgICAgICAgIGdlbnB0cl9kc3Rfd3JpdGUoZiwgdGFnLCByZWd0
eXBlLCByZWdpZCkKICAgICBlbHNlOgogICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNl
OiAiLHJlZ3R5cGUscmVnaWQsdG9zcyxudW1yZWdzKQogCkBAIC00MDksMTMgKzYzMiwyNCBAQCBk
ZWYgZ2VuX3RjZ19mdW5jKGYsIHRhZywgcmVncywgaW1tcyk6CiAgICAgICAgICMjIElmIHRoZXJl
IGlzIGEgc2NhbGFyIHJlc3VsdCwgaXQgaXMgdGhlIHJldHVybiB0eXBlCiAgICAgICAgIGZvciBy
ZWd0eXBlLHJlZ2lkLHRvc3MsbnVtcmVncyBpbiByZWdzOgogICAgICAgICAgICAgaWYgKGhleF9j
b21tb24uaXNfd3JpdHRlbihyZWdpZCkpOgorICAgICAgICAgICAgICAgIGlmIChoZXhfY29tbW9u
LmlzX2h2eF9yZWcocmVndHlwZSkpOgorICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAg
ICAgICAgICAgICAgIGdlbl9oZWxwZXJfY2FsbF9vcG4oZiwgdGFnLCByZWd0eXBlLCByZWdpZCwg
dG9zcywgbnVtcmVncywgaSkKICAgICAgICAgICAgICAgICBpICs9IDEKICAgICAgICAgaWYgKGkg
PiAwKTogZi53cml0ZSgiLCAiKQogICAgICAgICBmLndyaXRlKCJjcHVfZW52IikKICAgICAgICAg
aT0xCiAgICAgICAgIGZvciByZWd0eXBlLHJlZ2lkLHRvc3MsbnVtcmVncyBpbiByZWdzOgorICAg
ICAgICAgICAgaWYgKGhleF9jb21tb24uaXNfd3JpdHRlbihyZWdpZCkpOgorICAgICAgICAgICAg
ICAgIGlmIChub3QgaGV4X2NvbW1vbi5pc19odnhfcmVnKHJlZ3R5cGUpKToKKyAgICAgICAgICAg
ICAgICAgICAgY29udGludWUKKyAgICAgICAgICAgICAgICBnZW5faGVscGVyX2NhbGxfb3BuKGYs
IHRhZywgcmVndHlwZSwgcmVnaWQsIHRvc3MsIG51bXJlZ3MsIGkpCisgICAgICAgICAgICAgICAg
aSArPSAxCisgICAgICAgIGZvciByZWd0eXBlLHJlZ2lkLHRvc3MsbnVtcmVncyBpbiByZWdzOgog
ICAgICAgICAgICAgaWYgKGhleF9jb21tb24uaXNfcmVhZChyZWdpZCkpOgorICAgICAgICAgICAg
ICAgIGlmIChoZXhfY29tbW9uLmlzX2h2eF9yZWcocmVndHlwZSkgYW5kCisgICAgICAgICAgICAg
ICAgICAgIGhleF9jb21tb24uaXNfcmVhZHdyaXRlKHJlZ2lkKSk6CisgICAgICAgICAgICAgICAg
ICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICAgZ2VuX2hlbHBlcl9jYWxsX29wbihmLCB0YWcs
IHJlZ3R5cGUsIHJlZ2lkLCB0b3NzLCBudW1yZWdzLCBpKQogICAgICAgICAgICAgICAgIGkgKz0g
MQogICAgICAgICBmb3IgaW1tbGV0dCxiaXRzLGltbXNoaWZ0IGluIGltbXM6Ci0tIAoyLjcuNAoK

