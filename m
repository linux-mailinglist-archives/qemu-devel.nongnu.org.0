Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id 88EF329F9F6
	for <lists+qemu-devel@lfdr.de>; Fri, 30 Oct 2020 01:47:52 +0100 (CET)
Received: from localhost ([::1]:41110 helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>)
	id 1kYIa7-0001DM-Id
	for lists+qemu-devel@lfdr.de; Thu, 29 Oct 2020 20:47:51 -0400
Received: from eggs.gnu.org ([2001:470:142:3::10]:39092)
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1kYHyp-00044v-IH
 for qemu-devel@nongnu.org; Thu, 29 Oct 2020 20:09:19 -0400
Received: from alexa-out-sd-02.qualcomm.com ([199.106.114.39]:14578)
 by eggs.gnu.org with esmtps (TLS1.2:RSA_AES_256_CBC_SHA1:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1kYHyf-0005Pf-3z
 for qemu-devel@nongnu.org; Thu, 29 Oct 2020 20:09:19 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
 d=quicinc.com; i=@quicinc.com; q=dns/txt; s=qcdkim;
 t=1604016549; x=1635552549;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version:content-transfer-encoding;
 bh=8Q8NssF2GtH77S/CnR7zeX2jFLUyMIgx7wph8YdrbK4=;
 b=pA3AD4NtGX15pPVn/D0T0fRr1TV5ZH1T9kdhurLpvwXs1ItHpBEMwxYa
 +/AcZkaYmQiJrJ8tliYCFWlSDZvE7IFXTcF+kMUyn9htlHIjlOiBcjGNE
 qcUYsFvnMB4CGkMd2zhCs0JudufYzNXg3551uRFqnGwMC6+MWmrLc6aFo s=;
Received: from unknown (HELO ironmsg04-sd.qualcomm.com) ([10.53.140.144])
 by alexa-out-sd-02.qualcomm.com with ESMTP; 29 Oct 2020 17:08:45 -0700
X-QCInternal: smtphost
Received: from vu-tsimpson-aus.qualcomm.com (HELO
 vu-tsimpson1-aus.qualcomm.com) ([10.222.150.1])
 by ironmsg04-sd.qualcomm.com with ESMTP; 29 Oct 2020 17:08:44 -0700
Received: by vu-tsimpson1-aus.qualcomm.com (Postfix, from userid 47164)
 id 78A114129; Thu, 29 Oct 2020 19:08:44 -0500 (CDT)
From: Taylor Simpson <tsimpson@quicinc.com>
To: qemu-devel@nongnu.org
Subject: [RFC PATCH v5 15/33] Hexagon (target/hexagon/arch.[ch]) utility
 functions
Date: Thu, 29 Oct 2020 19:08:21 -0500
Message-Id: <1604016519-28065-16-git-send-email-tsimpson@quicinc.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1604016519-28065-1-git-send-email-tsimpson@quicinc.com>
References: <1604016519-28065-1-git-send-email-tsimpson@quicinc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Received-SPF: pass client-ip=199.106.114.39;
 envelope-from=tsimpson@qualcomm.com; helo=alexa-out-sd-02.qualcomm.com
X-detected-operating-system: by eggs.gnu.org: First seen = 2020/10/29 19:58:53
X-ACL-Warn: Detected OS   = FreeBSD 9.x or newer [fuzzy]
X-Spam_score_int: -40
X-Spam_score: -4.1
X-Spam_bar: ----
X-Spam_report: (-4.1 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, HEADER_FROM_DIFFERENT_DOMAINS=0.249,
 RCVD_IN_DNSWL_MED=-2.3, SPF_HELO_NONE=0.001,
 SPF_PASS=-0.001 autolearn=ham autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Cc: ale@rev.ng, bcain@quicinc.com, richard.henderson@linaro.org,
 at.org@qualcomm.com, laurent@vivier.eu, tsimpson@quicinc.com
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: "Qemu-devel" <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>

U2lnbmVkLW9mZi1ieTogVGF5bG9yIFNpbXBzb24gPHRzaW1wc29uQHF1aWNpbmMuY29tPgotLS0K
IHRhcmdldC9oZXhhZ29uL2FyY2guaCB8ICAzNSArKysrKysKIHRhcmdldC9oZXhhZ29uL2FyY2gu
YyB8IDI5NCArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KwogMiBmaWxlcyBjaGFuZ2VkLCAzMjkgaW5zZXJ0aW9ucygrKQogY3JlYXRlIG1vZGUgMTAwNjQ0
IHRhcmdldC9oZXhhZ29uL2FyY2guaAogY3JlYXRlIG1vZGUgMTAwNjQ0IHRhcmdldC9oZXhhZ29u
L2FyY2guYwoKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29uL2FyY2guaCBiL3RhcmdldC9oZXhh
Z29uL2FyY2guaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi5jZjE0NDgwCi0t
LSAvZGV2L251bGwKKysrIGIvdGFyZ2V0L2hleGFnb24vYXJjaC5oCkBAIC0wLDAgKzEsMzUgQEAK
Ky8qCisgKiAgQ29weXJpZ2h0KGMpIDIwMTktMjAyMCBRdWFsY29tbSBJbm5vdmF0aW9uIENlbnRl
ciwgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLgorICoKKyAqICBUaGlzIHByb2dyYW0gaXMgZnJl
ZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQorICogIGl0
IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVi
bGlzaGVkIGJ5CisgKiAgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNp
b24gMiBvZiB0aGUgTGljZW5zZSwgb3IKKyAqICAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2
ZXJzaW9uLgorICoKKyAqICBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUg
dGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyAqICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdp
dGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgorICogIE1FUkNIQU5UQUJJTElUWSBv
ciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKKyAqICBHTlUgR2Vu
ZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorICoKKyAqICBZb3Ugc2hvdWxk
IGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQor
ICogIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtOyBpZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUu
b3JnL2xpY2Vuc2VzLz4uCisgKi8KKworI2lmbmRlZiBIRVhBR09OX0FSQ0hfSAorI2RlZmluZSBI
RVhBR09OX0FSQ0hfSAorCisjaW5jbHVkZSAicWVtdS9vc2RlcC5oIgorI2luY2x1ZGUgInFlbXUv
aW50MTI4LmgiCisKK2V4dGVybiB1aW50NjRfdCBpbnRlcmxlYXZlKHVpbnQzMl90IG9kZCwgdWlu
dDMyX3QgZXZlbik7CitleHRlcm4gdWludDY0X3QgZGVpbnRlcmxlYXZlKHVpbnQ2NF90IHNyYyk7
CitleHRlcm4gdWludDMyX3QgY2FycnlfZnJvbV9hZGQ2NCh1aW50NjRfdCBhLCB1aW50NjRfdCBi
LCB1aW50MzJfdCBjKTsKK2V4dGVybiBpbnQzMl90IGNvbnZfcm91bmQoaW50MzJfdCBhLCBpbnQg
bik7CitleHRlcm4gdm9pZCBhcmNoX2Zwb3Bfc3RhcnQoQ1BVSGV4YWdvblN0YXRlICplbnYpOwor
ZXh0ZXJuIHZvaWQgYXJjaF9mcG9wX2VuZChDUFVIZXhhZ29uU3RhdGUgKmVudik7CitleHRlcm4g
aW50IGFyY2hfc2ZfcmVjaXBfY29tbW9uKGZsb2F0MzIgKlJzLCBmbG9hdDMyICpSdCwgZmxvYXQz
MiAqUmQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCAqYWRqdXN0LCBmbG9h
dF9zdGF0dXMgKmZwX3N0YXR1cyk7CitleHRlcm4gaW50IGFyY2hfc2ZfaW52c3FydF9jb21tb24o
ZmxvYXQzMiAqUnMsIGZsb2F0MzIgKlJkLCBpbnQgKmFkanVzdCwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBmbG9hdF9zdGF0dXMgKmZwX3N0YXR1cyk7CisKKyNlbmRpZgpkaWZm
IC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vYXJjaC5jIGIvdGFyZ2V0L2hleGFnb24vYXJjaC5jCm5l
dyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLjE2MDAyYmYKLS0tIC9kZXYvbnVsbAor
KysgYi90YXJnZXQvaGV4YWdvbi9hcmNoLmMKQEAgLTAsMCArMSwyOTQgQEAKKy8qCisgKiAgQ29w
eXJpZ2h0KGMpIDIwMTktMjAyMCBRdWFsY29tbSBJbm5vdmF0aW9uIENlbnRlciwgSW5jLiBBbGwg
UmlnaHRzIFJlc2VydmVkLgorICoKKyAqICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsg
eW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQorICogIGl0IHVuZGVyIHRoZSB0
ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5Cisg
KiAgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUg
TGljZW5zZSwgb3IKKyAqICAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorICoK
KyAqICBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxs
IGJlIHVzZWZ1bCwKKyAqICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0
aGUgaW1wbGllZCB3YXJyYW50eSBvZgorICogIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZP
UiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKKyAqICBHTlUgR2VuZXJhbCBQdWJsaWMg
TGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorICoKKyAqICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2
ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQorICogIGFsb25nIHdp
dGggdGhpcyBwcm9ncmFtOyBpZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2Vz
Lz4uCisgKi8KKworI2luY2x1ZGUgInFlbXUvb3NkZXAuaCIKKyNpbmNsdWRlICJmcHUvc29mdGZs
b2F0LmgiCisjaW5jbHVkZSAiY3B1LmgiCisjaW5jbHVkZSAiZm1hX2VtdS5oIgorI2luY2x1ZGUg
ImFyY2guaCIKKyNpbmNsdWRlICJtYWNyb3MuaCIKKworI2RlZmluZSBTRl9CSUFTICAgICAgICAx
MjcKKyNkZWZpbmUgU0ZfTUFYRVhQICAgICAgMjU0CisjZGVmaW5lIFNGX01BTlRCSVRTICAgIDIz
CisjZGVmaW5lIGZsb2F0MzJfbmFuICAgIG1ha2VfZmxvYXQzMigweGZmZmZmZmZmKQorCisjZGVm
aW5lIEJJVFNfTUFTS184IDB4NTU1NTU1NTU1NTU1NTU1NVVMTAorI2RlZmluZSBQQUlSX01BU0tf
OCAweDMzMzMzMzMzMzMzMzMzMzNVTEwKKyNkZWZpbmUgTllCTF9NQVNLXzggMHgwZjBmMGYwZjBm
MGYwZjBmVUxMCisjZGVmaW5lIEJZVEVfTUFTS184IDB4MDBmZjAwZmYwMGZmMDBmZlVMTAorI2Rl
ZmluZSBIQUxGX01BU0tfOCAweDAwMDBmZmZmMDAwMGZmZmZVTEwKKyNkZWZpbmUgV09SRF9NQVNL
XzggMHgwMDAwMDAwMGZmZmZmZmZmVUxMCisKK3VpbnQ2NF90IGludGVybGVhdmUodWludDMyX3Qg
b2RkLCB1aW50MzJfdCBldmVuKQoreworICAgIC8qIENvbnZlcnQgdG8gbG9uZyBsb25nICovCisg
ICAgdWludDY0X3QgbXlvZGQgPSBvZGQ7CisgICAgdWludDY0X3QgbXlldmVuID0gZXZlbjsKKyAg
ICAvKiBGaXJzdCwgc3ByZWFkIGJpdHMgb3V0ICovCisgICAgbXlvZGQgPSAobXlvZGQgfCAobXlv
ZGQgPDwgMTYpKSAmIEhBTEZfTUFTS184OworICAgIG15ZXZlbiA9IChteWV2ZW4gfCAobXlldmVu
IDw8IDE2KSkgJiBIQUxGX01BU0tfODsKKyAgICBteW9kZCA9IChteW9kZCB8IChteW9kZCA8PCA4
KSkgJiBCWVRFX01BU0tfODsKKyAgICBteWV2ZW4gPSAobXlldmVuIHwgKG15ZXZlbiA8PCA4KSkg
JiBCWVRFX01BU0tfODsKKyAgICBteW9kZCA9IChteW9kZCB8IChteW9kZCA8PCA0KSkgJiBOWUJM
X01BU0tfODsKKyAgICBteWV2ZW4gPSAobXlldmVuIHwgKG15ZXZlbiA8PCA0KSkgJiBOWUJMX01B
U0tfODsKKyAgICBteW9kZCA9IChteW9kZCB8IChteW9kZCA8PCAyKSkgJiBQQUlSX01BU0tfODsK
KyAgICBteWV2ZW4gPSAobXlldmVuIHwgKG15ZXZlbiA8PCAyKSkgJiBQQUlSX01BU0tfODsKKyAg
ICBteW9kZCA9IChteW9kZCB8IChteW9kZCA8PCAxKSkgJiBCSVRTX01BU0tfODsKKyAgICBteWV2
ZW4gPSAobXlldmVuIHwgKG15ZXZlbiA8PCAxKSkgJiBCSVRTX01BU0tfODsKKyAgICAvKiBOb3cg
T1IgdG9nZXRoZXIgKi8KKyAgICByZXR1cm4gbXlldmVuIHwgKG15b2RkIDw8IDEpOworfQorCit1
aW50NjRfdCBkZWludGVybGVhdmUodWludDY0X3Qgc3JjKQoreworICAgIC8qIEdldCBvZGQgYW5k
IGV2ZW4gYml0cyAqLworICAgIHVpbnQ2NF90IG15b2RkID0gKChzcmMgPj4gMSkgJiBCSVRTX01B
U0tfOCk7CisgICAgdWludDY0X3QgbXlldmVuID0gKHNyYyAmIEJJVFNfTUFTS184KTsKKworICAg
IC8qIFVuc3ByZWFkIGJpdHMgKi8KKyAgICBteWV2ZW4gPSAobXlldmVuIHwgKG15ZXZlbiA+PiAx
KSkgJiBQQUlSX01BU0tfODsKKyAgICBteW9kZCA9IChteW9kZCB8IChteW9kZCA+PiAxKSkgJiBQ
QUlSX01BU0tfODsKKyAgICBteWV2ZW4gPSAobXlldmVuIHwgKG15ZXZlbiA+PiAyKSkgJiBOWUJM
X01BU0tfODsKKyAgICBteW9kZCA9IChteW9kZCB8IChteW9kZCA+PiAyKSkgJiBOWUJMX01BU0tf
ODsKKyAgICBteWV2ZW4gPSAobXlldmVuIHwgKG15ZXZlbiA+PiA0KSkgJiBCWVRFX01BU0tfODsK
KyAgICBteW9kZCA9IChteW9kZCB8IChteW9kZCA+PiA0KSkgJiBCWVRFX01BU0tfODsKKyAgICBt
eWV2ZW4gPSAobXlldmVuIHwgKG15ZXZlbiA+PiA4KSkgJiBIQUxGX01BU0tfODsKKyAgICBteW9k
ZCA9IChteW9kZCB8IChteW9kZCA+PiA4KSkgJiBIQUxGX01BU0tfODsKKyAgICBteWV2ZW4gPSAo
bXlldmVuIHwgKG15ZXZlbiA+PiAxNikpICYgV09SRF9NQVNLXzg7CisgICAgbXlvZGQgPSAobXlv
ZGQgfCAobXlvZGQgPj4gMTYpKSAmIFdPUkRfTUFTS184OworCisgICAgLyogUmV0dXJuIG9kZCBi
aXRzIGluIHVwcGVyIGhhbGYgKi8KKyAgICByZXR1cm4gbXlldmVuIHwgKG15b2RkIDw8IDMyKTsK
K30KKwordWludDMyX3QgY2FycnlfZnJvbV9hZGQ2NCh1aW50NjRfdCBhLCB1aW50NjRfdCBiLCB1
aW50MzJfdCBjKQoreworICAgIHVpbnQ2NF90IHRtcGEsIHRtcGIsIHRtcGM7CisgICAgdG1wYSA9
IGZHRVRVV09SRCgwLCBhKTsKKyAgICB0bXBiID0gZkdFVFVXT1JEKDAsIGIpOworICAgIHRtcGMg
PSB0bXBhICsgdG1wYiArIGM7CisgICAgdG1wYSA9IGZHRVRVV09SRCgxLCBhKTsKKyAgICB0bXBi
ID0gZkdFVFVXT1JEKDEsIGIpOworICAgIHRtcGMgPSB0bXBhICsgdG1wYiArIGZHRVRVV09SRCgx
LCB0bXBjKTsKKyAgICB0bXBjID0gZkdFVFVXT1JEKDEsIHRtcGMpOworICAgIHJldHVybiB0bXBj
OworfQorCitpbnQzMl90IGNvbnZfcm91bmQoaW50MzJfdCBhLCBpbnQgbikKK3sKKyAgICBpbnQ2
NF90IHZhbDsKKworICAgIGlmIChuID09IDApIHsKKyAgICAgICAgdmFsID0gYTsKKyAgICB9IGVs
c2UgaWYgKChhICYgKCgxIDw8IChuIC0gMSkpIC0gMSkpID09IDApIHsgICAgLyogTi0xLi4wIGFs
bCB6ZXJvPyAqLworICAgICAgICAvKiBBZGQgTFNCIGZyb20gaW50IHBhcnQgKi8KKyAgICAgICAg
dmFsID0gKChmU0UzMl82NChhKSkgKyAoaW50NjRfdCkgKCgodWludDMyX3QpICgoMSA8PCBuKSAm
IGEpKSA+PiAxKSk7CisgICAgfSBlbHNlIHsKKyAgICAgICAgdmFsID0gKChmU0UzMl82NChhKSkg
KyAoMSA8PCAobiAtIDEpKSk7CisgICAgfQorCisgICAgdmFsID0gdmFsID4+IG47CisgICAgcmV0
dXJuIChpbnQzMl90KXZhbDsKK30KKworLyogRmxvYXRpbmcgUG9pbnQgU3R1ZmYgKi8KKworc3Rh
dGljIGNvbnN0IGludCBzb2Z0ZmxvYXRfcm91bmRpbmdtb2Rlc1tdID0geworICAgIGZsb2F0X3Jv
dW5kX25lYXJlc3RfZXZlbiwKKyAgICBmbG9hdF9yb3VuZF90b196ZXJvLAorICAgIGZsb2F0X3Jv
dW5kX2Rvd24sCisgICAgZmxvYXRfcm91bmRfdXAsCit9OworCit2b2lkIGFyY2hfZnBvcF9zdGFy
dChDUFVIZXhhZ29uU3RhdGUgKmVudikKK3sKKyAgICBzZXRfZmxvYXRfZXhjZXB0aW9uX2ZsYWdz
KDAsICZlbnYtPmZwX3N0YXR1cyk7CisgICAgc2V0X2Zsb2F0X3JvdW5kaW5nX21vZGUoCisgICAg
ICAgIHNvZnRmbG9hdF9yb3VuZGluZ21vZGVzW2ZSRUFEX1JFR19GSUVMRChVU1IsIFVTUl9GUFJO
RCldLAorICAgICAgICAmZW52LT5mcF9zdGF0dXMpOworfQorCisjZGVmaW5lIFJBSVNFX0ZQX0VY
Q0VQVElPTiBcCisgICAgZG8ge30gd2hpbGUgKDApICAgICAgICAgICAgLyogTm90IG1vZGVsbGVk
IGluIHFlbXUgdXNlciBtb2RlICovCisKKyNkZWZpbmUgU09GVEZMT0FUX1RFU1RfRkxBRyhGTEFH
LCBNWUYsIE1ZRSkgXAorICAgIGRvIHsgXAorICAgICAgICBpZiAoZmxhZ3MgJiBGTEFHKSB7IFwK
KyAgICAgICAgICAgIGlmIChHRVRfVVNSX0ZJRUxEKFVTUl8jI01ZRikgPT0gMCkgeyBcCisgICAg
ICAgICAgICAgICAgU0VUX1VTUl9GSUVMRChVU1JfIyNNWUYsIDEpOyBcCisgICAgICAgICAgICAg
ICAgaWYgKEdFVF9VU1JfRklFTEQoVVNSXyMjTVlFKSkgeyBcCisgICAgICAgICAgICAgICAgICAg
IFJBSVNFX0ZQX0VYQ0VQVElPTjsgXAorICAgICAgICAgICAgICAgIH0gXAorICAgICAgICAgICAg
fSBcCisgICAgICAgIH0gXAorICAgIH0gd2hpbGUgKDApCisKK3ZvaWQgYXJjaF9mcG9wX2VuZChD
UFVIZXhhZ29uU3RhdGUgKmVudikKK3sKKyAgICBpbnQgZmxhZ3MgPSBnZXRfZmxvYXRfZXhjZXB0
aW9uX2ZsYWdzKCZlbnYtPmZwX3N0YXR1cyk7CisgICAgaWYgKGZsYWdzICE9IDApIHsKKyAgICAg
ICAgU09GVEZMT0FUX1RFU1RfRkxBRyhmbG9hdF9mbGFnX2luZXhhY3QsIEZQSU5QRiwgRlBJTlBF
KTsKKyAgICAgICAgU09GVEZMT0FUX1RFU1RfRkxBRyhmbG9hdF9mbGFnX2RpdmJ5emVybywgRlBE
QlpGLCBGUERCWkUpOworICAgICAgICBTT0ZURkxPQVRfVEVTVF9GTEFHKGZsb2F0X2ZsYWdfaW52
YWxpZCwgRlBJTlZGLCBGUElOVkUpOworICAgICAgICBTT0ZURkxPQVRfVEVTVF9GTEFHKGZsb2F0
X2ZsYWdfb3ZlcmZsb3csIEZQT1ZGRiwgRlBPVkZFKTsKKyAgICAgICAgU09GVEZMT0FUX1RFU1Rf
RkxBRyhmbG9hdF9mbGFnX3VuZGVyZmxvdywgRlBVTkZGLCBGUFVORkUpOworICAgIH0KK30KKwor
c3RhdGljIGZsb2F0MzIgZmxvYXQzMl9tdWxfcG93MihmbG9hdDMyIGEsIHVpbnQzMl90IHAsIGZs
b2F0X3N0YXR1cyAqZnBfc3RhdHVzKQoreworICAgIGZsb2F0MzIgYiA9IG1ha2VfZmxvYXQzMigo
U0ZfQklBUyArIHApIDw8IFNGX01BTlRCSVRTKTsKKyAgICByZXR1cm4gZmxvYXQzMl9tdWwoYSwg
YiwgZnBfc3RhdHVzKTsKK30KKworaW50IGFyY2hfc2ZfcmVjaXBfY29tbW9uKGZsb2F0MzIgKlJz
LCBmbG9hdDMyICpSdCwgZmxvYXQzMiAqUmQsIGludCAqYWRqdXN0LAorICAgICAgICAgICAgICAg
ICAgICAgICAgIGZsb2F0X3N0YXR1cyAqZnBfc3RhdHVzKQoreworICAgIGludCBuX2V4cDsKKyAg
ICBpbnQgZF9leHA7CisgICAgaW50IHJldCA9IDA7CisgICAgZmxvYXQzMiBSc1YsIFJ0ViwgUmRW
OworICAgIGludCBQZVYgPSAwOworICAgIFJzViA9ICpSczsKKyAgICBSdFYgPSAqUnQ7CisgICAg
aWYgKGZsb2F0MzJfaXNfYW55X25hbihSc1YpICYmIGZsb2F0MzJfaXNfYW55X25hbihSdFYpKSB7
CisgICAgICAgIGlmIChleHRyYWN0MzIoUnNWICYgUnRWLCAyMiwgMSkpIHsKKyAgICAgICAgICAg
IGZsb2F0X3JhaXNlKGZsb2F0X2ZsYWdfaW52YWxpZCwgZnBfc3RhdHVzKTsKKyAgICAgICAgfQor
ICAgICAgICBSZFYgPSBSc1YgPSBSdFYgPSBmbG9hdDMyX25hbjsKKyAgICB9IGVsc2UgaWYgKGZs
b2F0MzJfaXNfYW55X25hbihSc1YpKSB7CisgICAgICAgIGlmIChleHRyYWN0MzIoUnNWLCAyMiwg
MSkpIHsKKyAgICAgICAgICAgIGZsb2F0X3JhaXNlKGZsb2F0X2ZsYWdfaW52YWxpZCwgZnBfc3Rh
dHVzKTsKKyAgICAgICAgfQorICAgICAgICBSZFYgPSBSc1YgPSBSdFYgPSBmbG9hdDMyX25hbjsK
KyAgICB9IGVsc2UgaWYgKGZsb2F0MzJfaXNfYW55X25hbihSdFYpKSB7CisgICAgICAgIC8qIG9y
IHB1dCBOYU4gaW4gbnVtL2RlbiBmaXh1cD8gKi8KKyAgICAgICAgaWYgKGV4dHJhY3QzMihSdFYs
IDIyLCAxKSkgeworICAgICAgICAgICAgZmxvYXRfcmFpc2UoZmxvYXRfZmxhZ19pbnZhbGlkLCBm
cF9zdGF0dXMpOworICAgICAgICB9CisgICAgICAgIFJkViA9IFJzViA9IFJ0ViA9IGZsb2F0MzJf
bmFuOworICAgIH0gZWxzZSBpZiAoZmxvYXQzMl9pc19pbmZpbml0eShSc1YpICYmIGZsb2F0MzJf
aXNfaW5maW5pdHkoUnRWKSkgeworICAgICAgICAvKiBvciBwdXQgSW5mIGluIG51bSBmaXh1cD8g
Ki8KKyAgICAgICAgUmRWID0gUnNWID0gUnRWID0gZmxvYXQzMl9uYW47CisgICAgICAgIGZsb2F0
X3JhaXNlKGZsb2F0X2ZsYWdfaW52YWxpZCwgZnBfc3RhdHVzKTsKKyAgICB9IGVsc2UgaWYgKGZs
b2F0MzJfaXNfemVybyhSc1YpICYmIGZsb2F0MzJfaXNfemVybyhSdFYpKSB7CisgICAgICAgIC8q
IG9yIHB1dCB6ZXJvIGluIG51bSBmaXh1cD8gKi8KKyAgICAgICAgUmRWID0gUnNWID0gUnRWID0g
ZmxvYXQzMl9uYW47CisgICAgICAgIGZsb2F0X3JhaXNlKGZsb2F0X2ZsYWdfaW52YWxpZCwgZnBf
c3RhdHVzKTsKKyAgICB9IGVsc2UgaWYgKGZsb2F0MzJfaXNfemVybyhSdFYpKSB7CisgICAgICAg
IC8qIG9yIHB1dCBJbmYgaW4gbnVtIGZpeHVwPyAqLworICAgICAgICB1aW50OF90IFJzVl9zaWdu
ID0gZmxvYXQzMl9pc19uZWcoUnNWKTsKKyAgICAgICAgdWludDhfdCBSdFZfc2lnbiA9IGZsb2F0
MzJfaXNfbmVnKFJ0Vik7CisgICAgICAgIFJzViA9IGluZmluaXRlX2Zsb2F0MzIoUnNWX3NpZ24g
XiBSdFZfc2lnbik7CisgICAgICAgIFJ0ViA9IGZsb2F0MzJfb25lOworICAgICAgICBSZFYgPSBm
bG9hdDMyX29uZTsKKyAgICAgICAgaWYgKGZsb2F0MzJfaXNfaW5maW5pdHkoUnNWKSkgeworICAg
ICAgICAgICAgZmxvYXRfcmFpc2UoZmxvYXRfZmxhZ19kaXZieXplcm8sIGZwX3N0YXR1cyk7Cisg
ICAgICAgIH0KKyAgICB9IGVsc2UgaWYgKGZsb2F0MzJfaXNfaW5maW5pdHkoUnRWKSkgeworICAg
ICAgICBSc1YgPSBtYWtlX2Zsb2F0MzIoMHg4MDAwMDAwMCAmIChSc1YgXiBSdFYpKTsKKyAgICAg
ICAgUnRWID0gZmxvYXQzMl9vbmU7CisgICAgICAgIFJkViA9IGZsb2F0MzJfb25lOworICAgIH0g
ZWxzZSBpZiAoZmxvYXQzMl9pc196ZXJvKFJzVikpIHsKKyAgICAgICAgLyogRG9lcyB0aGlzIGp1
c3Qgd29yayBpdHNlbGYgb3V0PyAqLworICAgICAgICAvKiBObywgMC9JbmYgY2F1c2VzIHByb2Js
ZW1zLiAqLworICAgICAgICBSc1YgPSBtYWtlX2Zsb2F0MzIoMHg4MDAwMDAwMCAmIChSc1YgXiBS
dFYpKTsKKyAgICAgICAgUnRWID0gZmxvYXQzMl9vbmU7CisgICAgICAgIFJkViA9IGZsb2F0MzJf
b25lOworICAgIH0gZWxzZSBpZiAoZmxvYXQzMl9pc19pbmZpbml0eShSc1YpKSB7CisgICAgICAg
IHVpbnQ4X3QgUnNWX3NpZ24gPSBmbG9hdDMyX2lzX25lZyhSc1YpOworICAgICAgICB1aW50OF90
IFJ0Vl9zaWduID0gZmxvYXQzMl9pc19uZWcoUnRWKTsKKyAgICAgICAgUnNWID0gaW5maW5pdGVf
ZmxvYXQzMihSc1Zfc2lnbiBeIFJ0Vl9zaWduKTsKKyAgICAgICAgUnRWID0gZmxvYXQzMl9vbmU7
CisgICAgICAgIFJkViA9IGZsb2F0MzJfb25lOworICAgIH0gZWxzZSB7CisgICAgICAgIFBlViA9
IDB4MDA7CisgICAgICAgIC8qIEJhc2ljIGNoZWNrcyBwYXNzZWQgKi8KKyAgICAgICAgbl9leHAg
PSBmbG9hdDMyX2dldGV4cChSc1YpOworICAgICAgICBkX2V4cCA9IGZsb2F0MzJfZ2V0ZXhwKFJ0
Vik7CisgICAgICAgIGlmICgobl9leHAgLSBkX2V4cCArIFNGX0JJQVMpIDw9IFNGX01BTlRCSVRT
KSB7CisgICAgICAgICAgICAvKiBOZWFyIHF1b3RpZW50IHVuZGVyZmxvdyAvIGluZXhhY3QgUSAq
LworICAgICAgICAgICAgUGVWID0gMHg4MDsKKyAgICAgICAgICAgIFJ0ViA9IGZsb2F0MzJfbXVs
X3BvdzIoUnRWLCAtNjQsIGZwX3N0YXR1cyk7CisgICAgICAgICAgICBSc1YgPSBmbG9hdDMyX211
bF9wb3cyKFJzViwgNjQsIGZwX3N0YXR1cyk7CisgICAgICAgIH0gZWxzZSBpZiAoKG5fZXhwIC0g
ZF9leHAgKyBTRl9CSUFTKSA+IChTRl9NQVhFWFAgLSAyNCkpIHsKKyAgICAgICAgICAgIC8qIE5l
YXIgcXVvdGllbnQgb3ZlcmZsb3cgKi8KKyAgICAgICAgICAgIFBlViA9IDB4NDA7CisgICAgICAg
ICAgICBSdFYgPSBmbG9hdDMyX211bF9wb3cyKFJ0ViwgMzIsIGZwX3N0YXR1cyk7CisgICAgICAg
ICAgICBSc1YgPSBmbG9hdDMyX211bF9wb3cyKFJzViwgLTMyLCBmcF9zdGF0dXMpOworICAgICAg
ICB9IGVsc2UgaWYgKG5fZXhwIDw9IFNGX01BTlRCSVRTICsgMikgeworICAgICAgICAgICAgUnRW
ID0gZmxvYXQzMl9tdWxfcG93MihSdFYsIDY0LCBmcF9zdGF0dXMpOworICAgICAgICAgICAgUnNW
ID0gZmxvYXQzMl9tdWxfcG93MihSc1YsIDY0LCBmcF9zdGF0dXMpOworICAgICAgICB9IGVsc2Ug
aWYgKGRfZXhwIDw9IDEpIHsKKyAgICAgICAgICAgIFJ0ViA9IGZsb2F0MzJfbXVsX3BvdzIoUnRW
LCAzMiwgZnBfc3RhdHVzKTsKKyAgICAgICAgICAgIFJzViA9IGZsb2F0MzJfbXVsX3BvdzIoUnNW
LCAzMiwgZnBfc3RhdHVzKTsKKyAgICAgICAgfSBlbHNlIGlmIChkX2V4cCA+IDI1MikgeworICAg
ICAgICAgICAgUnRWID0gZmxvYXQzMl9tdWxfcG93MihSdFYsIC0zMiwgZnBfc3RhdHVzKTsKKyAg
ICAgICAgICAgIFJzViA9IGZsb2F0MzJfbXVsX3BvdzIoUnNWLCAtMzIsIGZwX3N0YXR1cyk7Cisg
ICAgICAgIH0KKyAgICAgICAgUmRWID0gMDsKKyAgICAgICAgcmV0ID0gMTsKKyAgICB9CisgICAg
KlJzID0gUnNWOworICAgICpSdCA9IFJ0VjsKKyAgICAqUmQgPSBSZFY7CisgICAgKmFkanVzdCA9
IFBlVjsKKyAgICByZXR1cm4gcmV0OworfQorCitpbnQgYXJjaF9zZl9pbnZzcXJ0X2NvbW1vbihm
bG9hdDMyICpScywgZmxvYXQzMiAqUmQsIGludCAqYWRqdXN0LAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgZmxvYXRfc3RhdHVzICpmcF9zdGF0dXMpCit7CisgICAgZmxvYXQzMiBSc1YsIFJk
VjsKKyAgICBpbnQgUGVWID0gMDsKKyAgICBpbnQgcl9leHA7CisgICAgaW50IHJldCA9IDA7Cisg
ICAgUnNWID0gKlJzOworICAgIGlmIChmbG9hdDMyX2lzX2luZmluaXR5KFJzVikpIHsKKyAgICAg
ICAgaWYgKGV4dHJhY3QzMihSc1YsIDIyLCAxKSA9PSAwKSB7CisgICAgICAgICAgICBmbG9hdF9y
YWlzZShmbG9hdF9mbGFnX2ludmFsaWQsIGZwX3N0YXR1cyk7CisgICAgICAgIH0KKyAgICAgICAg
UmRWID0gUnNWID0gZmxvYXQzMl9uYW47CisgICAgfSBlbHNlIGlmIChmbG9hdDMyX2x0KFJzViwg
ZmxvYXQzMl96ZXJvLCBmcF9zdGF0dXMpKSB7CisgICAgICAgIC8qIE5lZ2F0aXZlIG5vbnplcm8g
dmFsdWVzIGFyZSBOYU4gKi8KKyAgICAgICAgZmxvYXRfcmFpc2UoZmxvYXRfZmxhZ19pbnZhbGlk
LCBmcF9zdGF0dXMpOworICAgICAgICBSc1YgPSBmbG9hdDMyX25hbjsKKyAgICAgICAgUmRWID0g
ZmxvYXQzMl9uYW47CisgICAgfSBlbHNlIGlmIChmbG9hdDMyX2lzX2luZmluaXR5KFJzVikpIHsK
KyAgICAgICAgLyogb3IgcHV0IEluZiBpbiBudW0gZml4dXA/ICovCisgICAgICAgIFJzViA9IGlu
ZmluaXRlX2Zsb2F0MzIoMSk7CisgICAgICAgIFJkViA9IGluZmluaXRlX2Zsb2F0MzIoMSk7Cisg
ICAgfSBlbHNlIGlmIChmbG9hdDMyX2lzX3plcm8oUnNWKSkgeworICAgICAgICAvKiBvciBwdXQg
emVybyBpbiBudW0gZml4dXA/ICovCisgICAgICAgIFJkViA9IGZsb2F0MzJfb25lOworICAgIH0g
ZWxzZSB7CisgICAgICAgIFBlViA9IDB4MDA7CisgICAgICAgIC8qIEJhc2ljIGNoZWNrcyBwYXNz
ZWQgKi8KKyAgICAgICAgcl9leHAgPSBmbG9hdDMyX2dldGV4cChSc1YpOworICAgICAgICBpZiAo
cl9leHAgPD0gMjQpIHsKKyAgICAgICAgICAgIFJzViA9IGZsb2F0MzJfbXVsX3BvdzIoUnNWLCA2
NCwgZnBfc3RhdHVzKTsKKyAgICAgICAgICAgIFBlViA9IDB4ZTA7CisgICAgICAgIH0KKyAgICAg
ICAgUmRWID0gMDsKKyAgICAgICAgcmV0ID0gMTsKKyAgICB9CisgICAgKlJzID0gUnNWOworICAg
ICpSZCA9IFJkVjsKKyAgICAqYWRqdXN0ID0gUGVWOworICAgIHJldHVybiByZXQ7Cit9Ci0tIAoy
LjcuNAoK

