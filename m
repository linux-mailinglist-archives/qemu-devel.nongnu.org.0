Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id 006B364F2A4
	for <lists+qemu-devel@lfdr.de>; Fri, 16 Dec 2022 21:51:28 +0100 (CET)
Received: from localhost ([::1] helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces@nongnu.org>)
	id 1p6Hdy-0002k2-MX; Fri, 16 Dec 2022 15:49:22 -0500
Received: from eggs.gnu.org ([2001:470:142:3::10])
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1p6Hdx-0002jo-2P
 for qemu-devel@nongnu.org; Fri, 16 Dec 2022 15:49:21 -0500
Received: from mx0a-0031df01.pphosted.com ([205.220.168.131])
 by eggs.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1p6Hdu-0004PC-La
 for qemu-devel@nongnu.org; Fri, 16 Dec 2022 15:49:20 -0500
Received: from pps.filterd (m0279865.ppops.net [127.0.0.1])
 by mx0a-0031df01.pphosted.com (8.17.1.19/8.17.1.19) with ESMTP id
 2BGKaUCo024937; Fri, 16 Dec 2022 20:49:15 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=quicinc.com;
 h=from : to : cc :
 subject : date : message-id : in-reply-to : references : mime-version :
 content-type : content-transfer-encoding; s=qcppdkim1;
 bh=N+lOjYqD3o/v7v1GRwB5KR2los9HFrQfm5Ekr3zArpk=;
 b=COUL0RCjUsMIic7akSzr4T2ST/emCMxJCrCgAugiXziXX3ovMpEzAguIu2rADLxtCVk/
 YdOpaTWn8QTJU1iTq54SA/43SJmHYxURo6/GWTimO0gg+cDa+hduHNBfF+sEUhfySF3x
 OvGee0hnYGkZBYFoy64VTr+MB/cnwSF7MQRVTBxd4AoCVoWhyw214EzX6M/MmsStpFga
 IBkfGbFokfM+sT0ktFmVzJQppEC0uQfTwHvBuiFyJ/PTVgN95bwU7qyjgET50I8+Nrsw
 EXPJ93bCGNAURxIkRZNYA4+UELDjPd1VfolLdDNDSPPiKJYoPxjhz/otfzL/B4GZ1G29 dQ== 
Received: from nalasppmta04.qualcomm.com (Global_NAT1.qualcomm.com
 [129.46.96.20])
 by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 3mg2vwd6cn-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Fri, 16 Dec 2022 20:49:14 +0000
Received: from pps.filterd (NALASPPMTA04.qualcomm.com [127.0.0.1])
 by NALASPPMTA04.qualcomm.com (8.17.1.5/8.17.1.5) with ESMTP id 2BGKgNrO016068; 
 Fri, 16 Dec 2022 20:49:14 GMT
Received: from pps.reinject (localhost [127.0.0.1])
 by NALASPPMTA04.qualcomm.com (PPS) with ESMTP id 3mgw840n74-1;
 Fri, 16 Dec 2022 20:49:14 +0000
Received: from NALASPPMTA04.qualcomm.com (NALASPPMTA04.qualcomm.com
 [127.0.0.1])
 by pps.reinject (8.17.1.5/8.17.1.5) with ESMTP id 2BGKiGTo017732;
 Fri, 16 Dec 2022 20:49:13 GMT
Received: from hu-devc-lv-u18-c.qualcomm.com (hu-tsimpson-lv.qualcomm.com
 [10.47.235.220])
 by NALASPPMTA04.qualcomm.com (PPS) with ESMTP id 2BGKnDhS024103;
 Fri, 16 Dec 2022 20:49:13 +0000
Received: by hu-devc-lv-u18-c.qualcomm.com (Postfix, from userid 47164)
 id F39CA500118; Fri, 16 Dec 2022 12:49:12 -0800 (PST)
From: Taylor Simpson <tsimpson@quicinc.com>
To: qemu-devel@nongnu.org
Cc: tsimpson@quicinc.com, richard.henderson@linaro.org, philmd@linaro.org,
 peter.maydell@linaro.org, bcain@quicinc.com, quic_mathbern@quicinc.com,
 stefanha@redhat.com
Subject: [PULL 11/21] Hexagon (target/hexagon) Use direct block chaining for
 tight loops
Date: Fri, 16 Dec 2022 12:48:35 -0800
Message-Id: <20221216204845.19290-12-tsimpson@quicinc.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20221216204845.19290-1-tsimpson@quicinc.com>
References: <20221216204845.19290-1-tsimpson@quicinc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
X-QCInternal: smtphost
X-QCInternal: smtphost
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-GUID: uXZSkEGj1WzEhXkGzl_AD5Zu0E1O0uk0
X-Proofpoint-ORIG-GUID: uXZSkEGj1WzEhXkGzl_AD5Zu0E1O0uk0
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.205,Aquarius:18.0.923,Hydra:6.0.545,FMLib:17.11.122.1
 definitions=2022-12-16_14,2022-12-15_02,2022-06-22_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 mlxscore=0 suspectscore=0
 clxscore=1015 phishscore=0 malwarescore=0 lowpriorityscore=0 spamscore=0
 bulkscore=0 impostorscore=0 mlxlogscore=608 adultscore=0
 priorityscore=1501 classifier=spam adjust=0 reason=mlx scancount=1
 engine=8.12.0-2212070000 definitions=main-2212160185
Received-SPF: pass client-ip=205.220.168.131;
 envelope-from=tsimpson@qualcomm.com; helo=mx0a-0031df01.pphosted.com
X-Spam_score_int: -24
X-Spam_score: -2.5
X-Spam_bar: --
X-Spam_report: (-2.5 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, HEADER_FROM_DIFFERENT_DOMAINS=0.25,
 RCVD_IN_DNSWL_LOW=-0.7, SPF_HELO_NONE=0.001,
 SPF_PASS=-0.001 autolearn=ham autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org

RGlyZWN0IGJsb2NrIGNoYWluaW5nIGlzIGRvY3VtZW50ZWQgaGVyZQpodHRwczovL3FlbXUucmVh
ZHRoZWRvY3MuaW8vZW4vbGF0ZXN0L2RldmVsL3RjZy5odG1sI2RpcmVjdC1ibG9jay1jaGFpbmlu
ZwoKSGV4YWdvbiBpbm5lciBsb29wcyBlbmQgd2l0aCB0aGUgZW5kbG9vcDAgaW5zdHJ1Y3Rpb24K
VG8gZ28gYmFjayB0byB0aGUgYmVnaW5uaW5nIG9mIHRoZSBsb29wLCB0aGlzIGluc3RydWN0aW9u
cyB3cml0ZXMgdG8gUEMKZnJvbSByZWdpc3RlciBTQTAgKHN0YXJ0IGFkZHJlc3MgMCkuICBUbyB1
c2UgZGlyZWN0IGJsb2NrIGNoYWluaW5nLCB3ZQpoYXZlIHRvIGFzc2lnbiBQQyB3aXRoIGEgY29u
c3RhbnQgdmFsdWUuICBTbywgd2Ugc3BlY2lhbGl6ZSB0aGUgY29kZQpnZW5lcmF0aW9uIHdoZW4g
dGhlIHN0YXJ0IG9mIHRoZSB0cmFuc2xhdGlvbiBibG9jayBpcyBlcXVhbCB0byBTQTAuCgpXaGVu
IHRoaXMgaXMgdGhlIGNhc2UsIHdlIGRlZmVyIHRoZSBjb21wYXJlL2JyYW5jaCBmcm9tIGVuZGxv
b3AwIHRvCmdlbl9lbmRfdGIuICBXaGVuIHRoaXMgaXMgZG9uZSwgd2UgY2FuIGFzc2lnbiB0aGUg
c3RhcnQgYWRkcmVzcyBvZiB0aGUgVEIKdG8gUEMuCgpSZXZpZXdlZC1ieTogUmljaGFyZCBIZW5k
ZXJzb24gPHJpY2hhcmQuaGVuZGVyc29uQGxpbmFyby5vcmc+ClNpZ25lZC1vZmYtYnk6IFRheWxv
ciBTaW1wc29uIDx0c2ltcHNvbkBxdWljaW5jLmNvbT4KTWVzc2FnZS1JZDogPDIwMjIxMTA4MTYy
OTA2LjMxNjYtMTItdHNpbXBzb25AcXVpY2luYy5jb20+Ci0tLQogdGFyZ2V0L2hleGFnb24vY3B1
LmggICAgICAgfCAxMyArKystLS0KIHRhcmdldC9oZXhhZ29uL2dlbl90Y2cuaCAgIHwgIDMgKysK
IHRhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5oIHwgIDEgKwogdGFyZ2V0L2hleGFnb24vZ2VucHRy
LmMgICAgfCA4NCArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKwogdGFyZ2V0
L2hleGFnb24vdHJhbnNsYXRlLmMgfCAzMyArKysrKysrKysrKysrKysKIDUgZmlsZXMgY2hhbmdl
ZCwgMTI5IGluc2VydGlvbnMoKyksIDUgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvdGFyZ2V0
L2hleGFnb24vY3B1LmggYi90YXJnZXQvaGV4YWdvbi9jcHUuaAppbmRleCBmZjhjMjYyNzJkLi4x
ZDg5ZTExYTFhIDEwMDY0NAotLS0gYS90YXJnZXQvaGV4YWdvbi9jcHUuaAorKysgYi90YXJnZXQv
aGV4YWdvbi9jcHUuaApAQCAtMjUsNiArMjUsNyBAQAogI2luY2x1ZGUgIm1tdmVjL21tdmVjLmgi
CiAjaW5jbHVkZSAicW9tL29iamVjdC5oIgogI2luY2x1ZGUgImh3L2NvcmUvY3B1LmgiCisjaW5j
bHVkZSAiaHcvcmVnaXN0ZXJmaWVsZHMuaCIKIAogI2RlZmluZSBOVU1fUFJFR1MgNAogI2RlZmlu
ZSBUT1RBTF9QRVJfVEhSRUFEX1JFR1MgNjQKQEAgLTE1MiwxNiArMTUzLDE4IEBAIHN0cnVjdCBB
cmNoQ1BVIHsKIAogI2luY2x1ZGUgImNwdV9iaXRzLmgiCiAKK0ZJRUxEKFRCX0ZMQUdTLCBJU19U
SUdIVF9MT09QLCAwLCAxKQorCiBzdGF0aWMgaW5saW5lIHZvaWQgY3B1X2dldF90Yl9jcHVfc3Rh
dGUoQ1BVSGV4YWdvblN0YXRlICplbnYsIHRhcmdldF91bG9uZyAqcGMsCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0X3Vsb25nICpjc19iYXNlLCB1aW50MzJf
dCAqZmxhZ3MpCiB7CisgICAgdWludDMyX3QgaGV4X2ZsYWdzID0gMDsKICAgICAqcGMgPSBlbnYt
PmdwcltIRVhfUkVHX1BDXTsKICAgICAqY3NfYmFzZSA9IDA7Ci0jaWZkZWYgQ09ORklHX1VTRVJf
T05MWQotICAgICpmbGFncyA9IDA7Ci0jZWxzZQotI2Vycm9yIFN5c3RlbSBtb2RlIG5vdCBzdXBw
b3J0ZWQgb24gSGV4YWdvbiB5ZXQKLSNlbmRpZgorICAgIGlmICgqcGMgPT0gZW52LT5ncHJbSEVY
X1JFR19TQTBdKSB7CisgICAgICAgIGhleF9mbGFncyA9IEZJRUxEX0RQMzIoaGV4X2ZsYWdzLCBU
Ql9GTEFHUywgSVNfVElHSFRfTE9PUCwgMSk7CisgICAgfQorICAgICpmbGFncyA9IGhleF9mbGFn
czsKIH0KIAogc3RhdGljIGlubGluZSBpbnQgY3B1X21tdV9pbmRleChDUFVIZXhhZ29uU3RhdGUg
KmVudiwgYm9vbCBpZmV0Y2gpCmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi9nZW5fdGNnLmgg
Yi90YXJnZXQvaGV4YWdvbi9nZW5fdGNnLmgKaW5kZXggMzU4M2YzOTBlOS4uMTk2OTdiNDJhNSAx
MDA2NDQKLS0tIGEvdGFyZ2V0L2hleGFnb24vZ2VuX3RjZy5oCisrKyBiL3RhcmdldC9oZXhhZ29u
L2dlbl90Y2cuaApAQCAtNjIwLDYgKzYyMCw5IEBACiAjZGVmaW5lIGZHRU5fVENHX0oyX2NhbGxm
KFNIT1JUQ09ERSkgXAogICAgIGdlbl9jb25kX2NhbGwoY3R4LCBQdVYsIFRDR19DT05EX05FLCBy
aVYpCiAKKyNkZWZpbmUgZkdFTl9UQ0dfSjJfZW5kbG9vcDAoU0hPUlRDT0RFKSBcCisgICAgZ2Vu
X2VuZGxvb3AwKGN0eCkKKwogLyoKICAqIENvbXBvdW5kIGNvbXBhcmUgYW5kIGp1bXAgaW5zdHJ1
Y3Rpb25zCiAgKiBIZXJlIGlzIGEgcHJpbWVyIHRvIHVuZGVyc3RhbmQgdGhlIHRhZyBuYW1lcwpk
aWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmggYi90YXJnZXQvaGV4YWdvbi90
cmFuc2xhdGUuaAppbmRleCBhYWNmMGIwOTIxLi5kOTcxZjRmMDk1IDEwMDY0NAotLS0gYS90YXJn
ZXQvaGV4YWdvbi90cmFuc2xhdGUuaAorKysgYi90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuaApA
QCAtNTksNiArNTksNyBAQCB0eXBlZGVmIHN0cnVjdCBEaXNhc0NvbnRleHQgewogICAgIGJvb2wg
cHJlX2NvbW1pdDsKICAgICBUQ0dDb25kIGJyYW5jaF9jb25kOwogICAgIHRhcmdldF91bG9uZyBi
cmFuY2hfZGVzdDsKKyAgICBib29sIGlzX3RpZ2h0X2xvb3A7CiB9IERpc2FzQ29udGV4dDsKIAog
c3RhdGljIGlubGluZSB2b2lkIGN0eF9sb2dfcmVnX3dyaXRlKERpc2FzQ29udGV4dCAqY3R4LCBp
bnQgcm51bSkKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29uL2dlbnB0ci5jIGIvdGFyZ2V0L2hl
eGFnb24vZ2VucHRyLmMKaW5kZXggZWUwZjg2ZmFiMi4uYTRhNzljODQ1NCAxMDA2NDQKLS0tIGEv
dGFyZ2V0L2hleGFnb24vZ2VucHRyLmMKKysrIGIvdGFyZ2V0L2hleGFnb24vZ2VucHRyLmMKQEAg
LTQ5Nyw2ICs0OTcsMzMgQEAgc3RhdGljIHZvaWQgZ2VuX3dyaXRlX25ld19wY19wY3JlbChEaXNh
c0NvbnRleHQgKmN0eCwgaW50IHBjX29mZiwKICAgICB9CiB9CiAKK3N0YXRpYyB2b2lkIGdlbl9z
ZXRfdXNyX2ZpZWxkKGludCBmaWVsZCwgVENHdiB2YWwpCit7CisgICAgdGNnX2dlbl9kZXBvc2l0
X3RsKGhleF9uZXdfdmFsdWVbSEVYX1JFR19VU1JdLCBoZXhfbmV3X3ZhbHVlW0hFWF9SRUdfVVNS
XSwKKyAgICAgICAgICAgICAgICAgICAgICAgdmFsLAorICAgICAgICAgICAgICAgICAgICAgICBy
ZWdfZmllbGRfaW5mb1tmaWVsZF0ub2Zmc2V0LAorICAgICAgICAgICAgICAgICAgICAgICByZWdf
ZmllbGRfaW5mb1tmaWVsZF0ud2lkdGgpOworfQorCitzdGF0aWMgdm9pZCBnZW5fc2V0X3Vzcl9m
aWVsZGkoaW50IGZpZWxkLCBpbnQgeCkKK3sKKyAgICBpZiAocmVnX2ZpZWxkX2luZm9bZmllbGRd
LndpZHRoID09IDEpIHsKKyAgICAgICAgdGFyZ2V0X3Vsb25nIGJpdCA9IDEgPDwgcmVnX2ZpZWxk
X2luZm9bZmllbGRdLm9mZnNldDsKKyAgICAgICAgaWYgKCh4ICYgMSkgPT0gMSkgeworICAgICAg
ICAgICAgdGNnX2dlbl9vcmlfdGwoaGV4X25ld192YWx1ZVtIRVhfUkVHX1VTUl0sCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICBoZXhfbmV3X3ZhbHVlW0hFWF9SRUdfVVNSXSwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGJpdCk7CisgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICB0
Y2dfZ2VuX2FuZGlfdGwoaGV4X25ld192YWx1ZVtIRVhfUkVHX1VTUl0sCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgaGV4X25ld192YWx1ZVtIRVhfUkVHX1VTUl0sCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgfmJpdCk7CisgICAgICAgIH0KKyAgICB9IGVsc2UgeworICAgICAgICBU
Q0d2IHZhbCA9IHRjZ19jb25zdGFudF90bCh4KTsKKyAgICAgICAgZ2VuX3NldF91c3JfZmllbGQo
ZmllbGQsIHZhbCk7CisgICAgfQorfQorCiBzdGF0aWMgdm9pZCBnZW5fY29tcGFyZShUQ0dDb25k
IGNvbmQsIFRDR3YgcmVzLCBUQ0d2IGFyZzEsIFRDR3YgYXJnMikKIHsKICAgICBUQ0d2IG9uZSA9
IHRjZ19jb25zdGFudF90bCgweGZmKTsKQEAgLTYzNiw2ICs2NjMsNjMgQEAgc3RhdGljIHZvaWQg
Z2VuX2NvbmRfY2FsbChEaXNhc0NvbnRleHQgKmN0eCwgVENHdiBwcmVkLAogICAgIGdlbl9zZXRf
bGFiZWwoc2tpcCk7CiB9CiAKK3N0YXRpYyB2b2lkIGdlbl9lbmRsb29wMChEaXNhc0NvbnRleHQg
KmN0eCkKK3sKKyAgICBUQ0d2IGxwY2ZnID0gdGNnX3RlbXBfbG9jYWxfbmV3KCk7CisKKyAgICBH
RVRfVVNSX0ZJRUxEKFVTUl9MUENGRywgbHBjZmcpOworCisgICAgLyoKKyAgICAgKiAgICBpZiAo
bHBjZmcgPT0gMSkgeworICAgICAqICAgICAgICBoZXhfbmV3X3ByZWRfdmFsdWVbM10gPSAweGZm
OworICAgICAqICAgICAgICBoZXhfcHJlZF93cml0dGVuIHw9IDEgPDwgMzsKKyAgICAgKiAgICB9
CisgICAgICovCisgICAgVENHTGFiZWwgKmxhYmVsMSA9IGdlbl9uZXdfbGFiZWwoKTsKKyAgICB0
Y2dfZ2VuX2JyY29uZGlfdGwoVENHX0NPTkRfTkUsIGxwY2ZnLCAxLCBsYWJlbDEpOworICAgIHsK
KyAgICAgICAgdGNnX2dlbl9tb3ZpX3RsKGhleF9uZXdfcHJlZF92YWx1ZVszXSwgMHhmZik7Cisg
ICAgICAgIHRjZ19nZW5fb3JpX3RsKGhleF9wcmVkX3dyaXR0ZW4sIGhleF9wcmVkX3dyaXR0ZW4s
IDEgPDwgMyk7CisgICAgfQorICAgIGdlbl9zZXRfbGFiZWwobGFiZWwxKTsKKworICAgIC8qCisg
ICAgICogICAgaWYgKGxwY2ZnKSB7CisgICAgICogICAgICAgIFNFVF9VU1JfRklFTEQoVVNSX0xQ
Q0ZHLCBscGNmZyAtIDEpOworICAgICAqICAgIH0KKyAgICAgKi8KKyAgICBUQ0dMYWJlbCAqbGFi
ZWwyID0gZ2VuX25ld19sYWJlbCgpOworICAgIHRjZ19nZW5fYnJjb25kaV90bChUQ0dfQ09ORF9F
USwgbHBjZmcsIDAsIGxhYmVsMik7CisgICAgeworICAgICAgICB0Y2dfZ2VuX3N1YmlfdGwobHBj
ZmcsIGxwY2ZnLCAxKTsKKyAgICAgICAgU0VUX1VTUl9GSUVMRChVU1JfTFBDRkcsIGxwY2ZnKTsK
KyAgICB9CisgICAgZ2VuX3NldF9sYWJlbChsYWJlbDIpOworCisgICAgLyoKKyAgICAgKiBJZiB3
ZSdyZSBpbiBhIHRpZ2h0IGxvb3AsIHdlJ2xsIGRvIHRoaXMgYXQgdGhlIGVuZCBvZiB0aGUgVEIg
dG8gdGFrZQorICAgICAqIGFkdmFudGFnZSBvZiBkaXJlY3QgYmxvY2sgY2hhaW5pbmcuCisgICAg
ICovCisgICAgaWYgKCFjdHgtPmlzX3RpZ2h0X2xvb3ApIHsKKyAgICAgICAgLyoKKyAgICAgICAg
ICogICAgaWYgKGhleF9ncHJbSEVYX1JFR19MQzBdID4gMSkgeworICAgICAgICAgKiAgICAgICAg
UEMgPSBoZXhfZ3ByW0hFWF9SRUdfU0EwXTsKKyAgICAgICAgICogICAgICAgIGhleF9uZXdfdmFs
dWVbSEVYX1JFR19MQzBdID0gaGV4X2dwcltIRVhfUkVHX0xDMF0gLSAxOworICAgICAgICAgKiAg
ICB9CisgICAgICAgICAqLworICAgICAgICBUQ0dMYWJlbCAqbGFiZWwzID0gZ2VuX25ld19sYWJl
bCgpOworICAgICAgICB0Y2dfZ2VuX2JyY29uZGlfdGwoVENHX0NPTkRfTEVVLCBoZXhfZ3ByW0hF
WF9SRUdfTEMwXSwgMSwgbGFiZWwzKTsKKyAgICAgICAgeworICAgICAgICAgICAgZ2VuX2p1bXBy
KGN0eCwgaGV4X2dwcltIRVhfUkVHX1NBMF0pOworICAgICAgICAgICAgdGNnX2dlbl9zdWJpX3Rs
KGhleF9uZXdfdmFsdWVbSEVYX1JFR19MQzBdLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGhleF9ncHJbSEVYX1JFR19MQzBdLCAxKTsKKyAgICAgICAgfQorICAgICAgICBnZW5fc2V0X2xh
YmVsKGxhYmVsMyk7CisgICAgfQorCisgICAgdGNnX3RlbXBfZnJlZShscGNmZyk7Cit9CisKIHN0
YXRpYyB2b2lkIGdlbl9jbXBfanVtcG52KERpc2FzQ29udGV4dCAqY3R4LAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgVENHQ29uZCBjb25kLCBUQ0d2IHZhbCwgVENHdiBzcmMsIGludCBwY19v
ZmYpCiB7CmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuYyBiL3RhcmdldC9o
ZXhhZ29uL3RyYW5zbGF0ZS5jCmluZGV4IGY1ZWY1NGYwMzkuLjc1ZjI4ZTA4YWQgMTAwNjQ0Ci0t
LSBhL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5jCisrKyBiL3RhcmdldC9oZXhhZ29uL3RyYW5z
bGF0ZS5jCkBAIC0xMzUsNiArMTM1LDggQEAgc3RhdGljIHZvaWQgZ2VuX2dvdG9fdGIoRGlzYXND
b250ZXh0ICpjdHgsIGludCBpZHgsIHRhcmdldF91bG9uZyBkZXN0KQogCiBzdGF0aWMgdm9pZCBn
ZW5fZW5kX3RiKERpc2FzQ29udGV4dCAqY3R4KQogeworICAgIFBhY2tldCAqcGt0ID0gY3R4LT5w
a3Q7CisKICAgICBnZW5fZXhlY19jb3VudGVycyhjdHgpOwogCiAgICAgaWYgKGN0eC0+YnJhbmNo
X2NvbmQgIT0gVENHX0NPTkRfTkVWRVIpIHsKQEAgLTE0Nyw2ICsxNDksMTggQEAgc3RhdGljIHZv
aWQgZ2VuX2VuZF90YihEaXNhc0NvbnRleHQgKmN0eCkKICAgICAgICAgfSBlbHNlIHsKICAgICAg
ICAgICAgIGdlbl9nb3RvX3RiKGN0eCwgMCwgY3R4LT5icmFuY2hfZGVzdCk7CiAgICAgICAgIH0K
KyAgICB9IGVsc2UgaWYgKGN0eC0+aXNfdGlnaHRfbG9vcCAmJgorICAgICAgICAgICAgICAgcGt0
LT5pbnNuW3BrdC0+bnVtX2luc25zIC0gMV0ub3Bjb2RlID09IEoyX2VuZGxvb3AwKSB7CisgICAg
ICAgIC8qCisgICAgICAgICAqIFdoZW4gd2UncmUgaW4gYSB0aWdodCBsb29wLCB3ZSBkZWZlciB0
aGUgZW5kbG9vcDAgcHJvY2Vzc2luZworICAgICAgICAgKiB0byB0YWtlIGFkdmFudGFnZSBvZiBk
aXJlY3QgYmxvY2sgY2hhaW5pbmcKKyAgICAgICAgICovCisgICAgICAgIFRDR0xhYmVsICpza2lw
ID0gZ2VuX25ld19sYWJlbCgpOworICAgICAgICB0Y2dfZ2VuX2JyY29uZGlfdGwoVENHX0NPTkRf
TEVVLCBoZXhfZ3ByW0hFWF9SRUdfTEMwXSwgMSwgc2tpcCk7CisgICAgICAgIHRjZ19nZW5fc3Vi
aV90bChoZXhfZ3ByW0hFWF9SRUdfTEMwXSwgaGV4X2dwcltIRVhfUkVHX0xDMF0sIDEpOworICAg
ICAgICBnZW5fZ290b190YihjdHgsIDAsIGN0eC0+YmFzZS50Yi0+cGMpOworICAgICAgICBnZW5f
c2V0X2xhYmVsKHNraXApOworICAgICAgICBnZW5fZ290b190YihjdHgsIDEsIGN0eC0+bmV4dF9Q
Qyk7CiAgICAgfSBlbHNlIHsKICAgICAgICAgdGNnX2dlbl9sb29rdXBfYW5kX2dvdG9fcHRyKCk7
CiAgICAgfQpAQCAtMzM3LDYgKzM1MSwxNSBAQCBzdGF0aWMgdm9pZCBtYXJrX2ltcGxpY2l0X3Jl
Z193cml0ZShEaXNhc0NvbnRleHQgKmN0eCwgaW50IGF0dHJpYiwgaW50IHJudW0pCiAgICAgICAg
ICAqLwogICAgICAgICBib29sIGlzX3ByZWRpY2F0ZWQgPSBHRVRfQVRUUklCKG9wY29kZSwgQV9D
T05ERVhFQykgfHwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm51bSA9PSBIRVhfUkVH
X1VTUjsKKworICAgICAgICAvKiBMQzAvTEMxIGlzIGNvbmRpdGlvbmFsbHkgd3JpdHRlbiBieSBl
bmRsb29wIGluc3RydWN0aW9ucyAqLworICAgICAgICBpZiAoKHJudW0gPT0gSEVYX1JFR19MQzAg
fHwgcm51bSA9PSBIRVhfUkVHX0xDMSkgJiYKKyAgICAgICAgICAgIChvcGNvZGUgPT0gSjJfZW5k
bG9vcDAgfHwKKyAgICAgICAgICAgICBvcGNvZGUgPT0gSjJfZW5kbG9vcDEgfHwKKyAgICAgICAg
ICAgICBvcGNvZGUgPT0gSjJfZW5kbG9vcDAxKSkgeworICAgICAgICAgICAgaXNfcHJlZGljYXRl
ZCA9IHRydWU7CisgICAgICAgIH0KKwogICAgICAgICBpZiAoaXNfcHJlZGljYXRlZCAmJiAhaXNf
cHJlbG9hZGVkKGN0eCwgcm51bSkpIHsKICAgICAgICAgICAgIHRjZ19nZW5fbW92X3RsKGhleF9u
ZXdfdmFsdWVbcm51bV0sIGhleF9ncHJbcm51bV0pOwogICAgICAgICB9CkBAIC00MjAsNiArNDQz
LDE0IEBAIHN0YXRpYyB2b2lkIGdlbl9yZWdfd3JpdGVzKERpc2FzQ29udGV4dCAqY3R4KQogICAg
ICAgICBpbnQgcmVnX251bSA9IGN0eC0+cmVnX2xvZ1tpXTsKIAogICAgICAgICB0Y2dfZ2VuX21v
dl90bChoZXhfZ3ByW3JlZ19udW1dLCBoZXhfbmV3X3ZhbHVlW3JlZ19udW1dKTsKKworICAgICAg
ICAvKgorICAgICAgICAgKiBjdHgtPmlzX3RpZ2h0X2xvb3AgaXMgc2V0IHdoZW4gU0EwIHBvaW50
cyB0byB0aGUgYmVnaW5uaW5nIG9mIHRoZSBUQi4KKyAgICAgICAgICogSWYgd2Ugd3JpdGUgdG8g
U0EwLCB3ZSBoYXZlIHRvIHR1cm4gb2ZmIHRpZ2h0IGxvb3AgaGFuZGxpbmcuCisgICAgICAgICAq
LworICAgICAgICBpZiAocmVnX251bSA9PSBIRVhfUkVHX1NBMCkgeworICAgICAgICAgICAgY3R4
LT5pc190aWdodF9sb29wID0gZmFsc2U7CisgICAgICAgIH0KICAgICB9CiB9CiAKQEAgLTgzMywx
MiArODY0LDE0IEBAIHN0YXRpYyB2b2lkIGhleGFnb25fdHJfaW5pdF9kaXNhc19jb250ZXh0KERp
c2FzQ29udGV4dEJhc2UgKmRjYmFzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIENQVVN0YXRlICpjcykKIHsKICAgICBEaXNhc0NvbnRleHQgKmN0eCA9IGNvbnRh
aW5lcl9vZihkY2Jhc2UsIERpc2FzQ29udGV4dCwgYmFzZSk7CisgICAgdWludDMyX3QgaGV4X2Zs
YWdzID0gZGNiYXNlLT50Yi0+ZmxhZ3M7CiAKICAgICBjdHgtPm1lbV9pZHggPSBNTVVfVVNFUl9J
RFg7CiAgICAgY3R4LT5udW1fcGFja2V0cyA9IDA7CiAgICAgY3R4LT5udW1faW5zbnMgPSAwOwog
ICAgIGN0eC0+bnVtX2h2eF9pbnNucyA9IDA7CiAgICAgY3R4LT5icmFuY2hfY29uZCA9IFRDR19D
T05EX05FVkVSOworICAgIGN0eC0+aXNfdGlnaHRfbG9vcCA9IEZJRUxEX0VYMzIoaGV4X2ZsYWdz
LCBUQl9GTEFHUywgSVNfVElHSFRfTE9PUCk7CiB9CiAKIHN0YXRpYyB2b2lkIGhleGFnb25fdHJf
dGJfc3RhcnQoRGlzYXNDb250ZXh0QmFzZSAqZGIsIENQVVN0YXRlICpjcHUpCi0tIAoyLjE3LjEK
Cg==

