Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id C08CA6AD6D5
	for <lists+qemu-devel@lfdr.de>; Tue,  7 Mar 2023 06:36:22 +0100 (CET)
Received: from localhost ([::1] helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces@nongnu.org>)
	id 1pZPyo-0006sZ-Lq; Tue, 07 Mar 2023 00:35:19 -0500
Received: from eggs.gnu.org ([2001:470:142:3::10])
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1pZPyR-0006bV-T6
 for qemu-devel@nongnu.org; Tue, 07 Mar 2023 00:34:56 -0500
Received: from mx0a-0031df01.pphosted.com ([205.220.168.131])
 by eggs.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1pZPyJ-0006ZD-Vp
 for qemu-devel@nongnu.org; Tue, 07 Mar 2023 00:34:54 -0500
Received: from pps.filterd (m0279863.ppops.net [127.0.0.1])
 by mx0a-0031df01.pphosted.com (8.17.1.19/8.17.1.19) with ESMTP id
 3275DNn8005143; Tue, 7 Mar 2023 05:34:45 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=quicinc.com;
 h=from : to : cc :
 subject : date : message-id : in-reply-to : references : mime-version :
 content-type : content-transfer-encoding; s=qcppdkim1;
 bh=WnUL8CAWCcrIgS9mAFBn0GJef1liHH6Ay4MgRBf1FHk=;
 b=VsSl/TTspQLj5dp8ELoNYRGr9Ruj6D9A5ycQie6kqHQ/AKV41UvOSsq449983SL8X62T
 j/KXBDzFeOwGNBfTBargMOc26NNeISkH0zo3oTirIY7St8AieNrPU2miM0/H/IYOHXXT
 QKrWpr/iGlEnvwM7jhzhDVM6ECOX+MlmJ5fc61nSqNiAZ9tYN6VdTvX4j4kLi/Xe1U/4
 iEsgf0nzIb7Tx4g8DdJGg+NZ42nMEv6ACW/OH8sZSP0/JjEoiG1ErV3q1Li5zqZFcmRK
 VuSjC0jzdTCOUSxMZjAKm4v9h4GaxF4+dD7bhgRSJonKQB/3ObyJJf8SN8LeAIK/xEaZ 6w== 
Received: from nalasppmta03.qualcomm.com (Global_NAT1.qualcomm.com
 [129.46.96.20])
 by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 3p418771sw-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Tue, 07 Mar 2023 05:34:45 +0000
Received: from pps.filterd (NALASPPMTA03.qualcomm.com [127.0.0.1])
 by NALASPPMTA03.qualcomm.com (8.17.1.5/8.17.1.5) with ESMTP id 3275Yile020259; 
 Tue, 7 Mar 2023 05:34:44 GMT
Received: from pps.reinject (localhost [127.0.0.1])
 by NALASPPMTA03.qualcomm.com (PPS) with ESMTPS id 3p4fjsvd1d-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Tue, 07 Mar 2023 05:34:44 +0000
Received: from NALASPPMTA03.qualcomm.com (NALASPPMTA03.qualcomm.com
 [127.0.0.1])
 by pps.reinject (8.17.1.5/8.17.1.5) with ESMTP id 3275YhiZ020230;
 Tue, 7 Mar 2023 05:34:43 GMT
Received: from hu-devc-sd-u20-a-1.qualcomm.com (hu-tsimpson-lv.qualcomm.com
 [10.47.204.221])
 by NALASPPMTA03.qualcomm.com (PPS) with ESMTPS id 3275YhWE020225
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Tue, 07 Mar 2023 05:34:43 +0000
Received: by hu-devc-sd-u20-a-1.qualcomm.com (Postfix, from userid 47164)
 id 97BD76AD; Mon,  6 Mar 2023 21:34:42 -0800 (PST)
From: Taylor Simpson <tsimpson@quicinc.com>
To: qemu-devel@nongnu.org
Cc: tsimpson@quicinc.com, richard.henderson@linaro.org, philmd@linaro.org,
 peter.maydell@linaro.org, bcain@quicinc.com, quic_mathbern@quicinc.com,
 stefanha@redhat.com, ale@rev.ng, anjo@rev.ng
Subject: [PULL 08/17] Hexagon (target/hexagon) Analyze packet before
 generating TCG
Date: Mon,  6 Mar 2023 21:34:29 -0800
Message-Id: <20230307053438.2416629-9-tsimpson@quicinc.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20230307053438.2416629-1-tsimpson@quicinc.com>
References: <20230307053438.2416629-1-tsimpson@quicinc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
X-QCInternal: smtphost
X-QCInternal: smtphost
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-GUID: VWByU_0jwwD9DJ0nYUHbP-Ujp3B_agLe
X-Proofpoint-ORIG-GUID: VWByU_0jwwD9DJ0nYUHbP-Ujp3B_agLe
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.219,Aquarius:18.0.942,Hydra:6.0.573,FMLib:17.11.170.22
 definitions=2023-03-06_14,2023-03-06_01,2023-02-09_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 clxscore=1015 adultscore=0
 priorityscore=1501 mlxscore=0 phishscore=0 lowpriorityscore=0
 malwarescore=0 mlxlogscore=654 bulkscore=0 suspectscore=0 spamscore=0
 impostorscore=0 classifier=spam adjust=0 reason=mlx scancount=1
 engine=8.12.0-2212070000 definitions=main-2303070050
Received-SPF: pass client-ip=205.220.168.131;
 envelope-from=tsimpson@qualcomm.com; helo=mx0a-0031df01.pphosted.com
X-Spam_score_int: -24
X-Spam_score: -2.5
X-Spam_bar: --
X-Spam_report: (-2.5 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, HEADER_FROM_DIFFERENT_DOMAINS=0.25,
 RCVD_IN_DNSWL_LOW=-0.7, SPF_HELO_NONE=0.001,
 SPF_PASS=-0.001 autolearn=ham autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org

V2UgY3JlYXRlIGEgbmV3IGdlbmVyYXRvciB0aGF0IGNyZWF0ZXMgYW4gYW5hbHl6ZV88dGFnPiBm
dW5jdGlvbiBmb3IKZWFjaCBpbnN0cnVjdGlvbi4gIEN1cnJlbnRseSwgdGhlc2UgZnVuY3Rpb25z
IHJlY29yZCB0aGUgd3JpdGVzIHRvClIsIFAsIGFuZCBDIHJlZ2lzdGVycyBieSBjYWxsaW5nIGN0
eF9sb2dfcmVnX3dyaXRlW19wYWlyXSBvcgpjdHhfbG9nX3ByZWRfd3JpdGUuCgpEdXJpbmcgZ2Vu
X3N0YXJ0X3BhY2tldCwgd2UgaW52b2tlIHRoZSBhbmFseXplXzx0YWc+IGZ1bmN0aW9uIGZvcgpl
YWNoIGluc3RydWN0aW9uIGluIHRoZSBwYWNrZXQsIGFuZCB3ZSBtYXJrIHRoZSBpbXBsaWNpdCBy
ZWdpc3RlcgphbmQgcHJlZGljYXRlIHdyaXRlcy4KCkRvaW5nIHRoZSBhbmFseXNpcyB1cCBmcm9u
dCBoYXMgc2V2ZXJhbCBhZHZhbnRhZ2VzCi0gV2UgcmVtb3ZlIGNhbGxzIHRvIGN0eF9sb2dfKiBm
cm9tIGdlbl90Y2dfZnVuY3MucHkgYW5kIGdlbnB0ci5jCi0gQWZ0ZXIgdGhlIGFuYWx5c2lzIGlz
IHBlcmZvcm1lZCwgd2UgY2FuIGluaXRpYWxpemUgaGV4X25ld192YWx1ZQogIGZvciBlYWNoIG9m
IHRoZSBwcmVkaWNhdGVkIGFzc2lnbm1lbnRzIHJhdGhlciB0aGFuIGR1cmluZyBUQ0cKICBnZW5l
cmF0aW9uIGZvciB0aGUgaW5zdHJ1Y3Rpb25zCi0gVGhpcyBpcyBhIHN0ZXBwaW5nIHN0b25lIGZv
ciBmdXR1cmUgd29yayB3aGVyZSB0aGUgYW5hbHlzaXMgd2lsbAogIGluY2x1ZGUgdGhlIHNldCBv
ZiByZWdpc3RlcnMgdGhhdCBhcmUgcmVhZC4gIEluIGNhc2VzIHdoZXJlCiAgdGhlIHBhY2tldCBk
b2Vzbid0IGhhdmUgYW4gb3ZlcmxhcCBiZXR3ZWVuIHRoZSByZWdpc3RlcnMgdGhhdCBhcmUKICB3
cml0dGVuIGFuZCByZWdpc3RlcnMgdGhhdCBhcmUgcmVhZCwgd2UgY2FuIGF2b2lkIHRoZSBpbnRl
cm1lZGlhdGUKICBzdGVwIG9mIHdyaXRpbmcgdG8gaGV4X25ld192YWx1ZS4gIE5vdGUgdGhhdCBv
dGhlciBjaGVja3Mgd2lsbCBhbHNvCiAgYmUgbmVlZGVkIChlLmcuLCBubyBpbnN0cnVjdGlvbnMg
Y2FuIHJhaXNlIGFuIGV4Y2VwdGlvbikuCgpTaWduZWQtb2ZmLWJ5OiBUYXlsb3IgU2ltcHNvbiA8
dHNpbXBzb25AcXVpY2luYy5jb20+ClJldmlld2VkLWJ5OiBBbnRvbiBKb2hhbnNzb24gPGFuam9A
cmV2Lm5nPgpNZXNzYWdlLUlkOiA8MjAyMzAzMDcwMjU4MjguMTYxMjgwOS02LXRzaW1wc29uQHF1
aWNpbmMuY29tPgotLS0KIHRhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5oICAgICAgICAgICAgICAg
ICAgfCAgNDYgKystLQogdGFyZ2V0L2hleGFnb24vZ2VucHRyLmMgICAgICAgICAgICAgICAgICAg
ICB8ICAgNSArLQogdGFyZ2V0L2hleGFnb24vaWRlZi1wYXJzZXIvcGFyc2VyLWhlbHBlcnMuYyB8
ICAgNyArLQogdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmMgICAgICAgICAgICAgICAgICB8IDE2
MiArKysrKysrLS0tLS0tCiB0YXJnZXQvaGV4YWdvbi9SRUFETUUgICAgICAgICAgICAgICAgICAg
ICAgIHwgIDEwICstCiB0YXJnZXQvaGV4YWdvbi9nZW5fYW5hbHl6ZV9mdW5jcy5weSAgICAgICAg
IHwgMjM3ICsrKysrKysrKysrKysrKysrKysrCiB0YXJnZXQvaGV4YWdvbi9nZW5fdGNnX2Z1bmNz
LnB5ICAgICAgICAgICAgIHwgIDIzICstCiB0YXJnZXQvaGV4YWdvbi9tZXNvbi5idWlsZCAgICAg
ICAgICAgICAgICAgIHwgIDExICstCiA4IGZpbGVzIGNoYW5nZWQsIDM4MyBpbnNlcnRpb25zKCsp
LCAxMTggZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9kZSAxMDA3NTUgdGFyZ2V0L2hleGFnb24vZ2Vu
X2FuYWx5emVfZnVuY3MucHkKCmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUu
aCBiL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5oCmluZGV4IGQ5NzFmNGYwOTUuLmQ0NWQzYTRi
YjAgMTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5oCisrKyBiL3RhcmdldC9o
ZXhhZ29uL3RyYW5zbGF0ZS5oCkBAIC0xLDUgKzEsNSBAQAogLyoKLSAqICBDb3B5cmlnaHQoYykg
MjAxOS0yMDIyIFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFsbCBSaWdodHMgUmVz
ZXJ2ZWQuCisgKiAgQ29weXJpZ2h0KGMpIDIwMTktMjAyMyBRdWFsY29tbSBJbm5vdmF0aW9uIENl
bnRlciwgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogICoKICAqICBUaGlzIHByb2dyYW0gaXMg
ZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQogICog
IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMg
cHVibGlzaGVkIGJ5CkBAIC0zOCw2ICszOCw3IEBAIHR5cGVkZWYgc3RydWN0IERpc2FzQ29udGV4
dCB7CiAgICAgaW50IHJlZ19sb2dbUkVHX1dSSVRFU19NQVhdOwogICAgIGludCByZWdfbG9nX2lk
eDsKICAgICBERUNMQVJFX0JJVE1BUChyZWdzX3dyaXR0ZW4sIFRPVEFMX1BFUl9USFJFQURfUkVH
Uyk7CisgICAgREVDTEFSRV9CSVRNQVAocHJlZGljYXRlZF9yZWdzLCBUT1RBTF9QRVJfVEhSRUFE
X1JFR1MpOwogICAgIGludCBwcmVnX2xvZ1tQUkVEX1dSSVRFU19NQVhdOwogICAgIGludCBwcmVn
X2xvZ19pZHg7CiAgICAgREVDTEFSRV9CSVRNQVAocHJlZ3Nfd3JpdHRlbiwgTlVNX1BSRUdTKTsK
QEAgLTYyLDMyICs2MywzOSBAQCB0eXBlZGVmIHN0cnVjdCBEaXNhc0NvbnRleHQgewogICAgIGJv
b2wgaXNfdGlnaHRfbG9vcDsKIH0gRGlzYXNDb250ZXh0OwogCi1zdGF0aWMgaW5saW5lIHZvaWQg
Y3R4X2xvZ19yZWdfd3JpdGUoRGlzYXNDb250ZXh0ICpjdHgsIGludCBybnVtKQorc3RhdGljIGlu
bGluZSB2b2lkIGN0eF9sb2dfcHJlZF93cml0ZShEaXNhc0NvbnRleHQgKmN0eCwgaW50IHBudW0p
CiB7Ci0gICAgaWYgKHRlc3RfYml0KHJudW0sIGN0eC0+cmVnc193cml0dGVuKSkgewotICAgICAg
ICBIRVhfREVCVUdfTE9HKCJXQVJOSU5HOiBNdWx0aXBsZSB3cml0ZXMgdG8gciVkXG4iLCBybnVt
KTsKKyAgICBpZiAoIXRlc3RfYml0KHBudW0sIGN0eC0+cHJlZ3Nfd3JpdHRlbikpIHsKKyAgICAg
ICAgY3R4LT5wcmVnX2xvZ1tjdHgtPnByZWdfbG9nX2lkeF0gPSBwbnVtOworICAgICAgICBjdHgt
PnByZWdfbG9nX2lkeCsrOworICAgICAgICBzZXRfYml0KHBudW0sIGN0eC0+cHJlZ3Nfd3JpdHRl
bik7CiAgICAgfQotICAgIGN0eC0+cmVnX2xvZ1tjdHgtPnJlZ19sb2dfaWR4XSA9IHJudW07Ci0g
ICAgY3R4LT5yZWdfbG9nX2lkeCsrOwotICAgIHNldF9iaXQocm51bSwgY3R4LT5yZWdzX3dyaXR0
ZW4pOwotfQotCi1zdGF0aWMgaW5saW5lIHZvaWQgY3R4X2xvZ19yZWdfd3JpdGVfcGFpcihEaXNh
c0NvbnRleHQgKmN0eCwgaW50IHJudW0pCi17Ci0gICAgY3R4X2xvZ19yZWdfd3JpdGUoY3R4LCBy
bnVtKTsKLSAgICBjdHhfbG9nX3JlZ193cml0ZShjdHgsIHJudW0gKyAxKTsKIH0KIAotc3RhdGlj
IGlubGluZSB2b2lkIGN0eF9sb2dfcHJlZF93cml0ZShEaXNhc0NvbnRleHQgKmN0eCwgaW50IHBu
dW0pCitzdGF0aWMgaW5saW5lIHZvaWQgY3R4X2xvZ19yZWdfd3JpdGUoRGlzYXNDb250ZXh0ICpj
dHgsIGludCBybnVtLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wg
aXNfcHJlZGljYXRlZCkKIHsKLSAgICBjdHgtPnByZWdfbG9nW2N0eC0+cHJlZ19sb2dfaWR4XSA9
IHBudW07Ci0gICAgY3R4LT5wcmVnX2xvZ19pZHgrKzsKLSAgICBzZXRfYml0KHBudW0sIGN0eC0+
cHJlZ3Nfd3JpdHRlbik7CisgICAgaWYgKHJudW0gPT0gSEVYX1JFR19QM18wX0FMSUFTRUQpIHsK
KyAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBOVU1fUFJFR1M7IGkrKykgeworICAgICAgICAg
ICAgY3R4X2xvZ19wcmVkX3dyaXRlKGN0eCwgaSk7CisgICAgICAgIH0KKyAgICB9IGVsc2Ugewor
ICAgICAgICBpZiAoIXRlc3RfYml0KHJudW0sIGN0eC0+cmVnc193cml0dGVuKSkgeworICAgICAg
ICAgICAgY3R4LT5yZWdfbG9nW2N0eC0+cmVnX2xvZ19pZHhdID0gcm51bTsKKyAgICAgICAgICAg
IGN0eC0+cmVnX2xvZ19pZHgrKzsKKyAgICAgICAgICAgIHNldF9iaXQocm51bSwgY3R4LT5yZWdz
X3dyaXR0ZW4pOworICAgICAgICB9CisgICAgICAgIGlmIChpc19wcmVkaWNhdGVkKSB7CisgICAg
ICAgICAgICBzZXRfYml0KHJudW0sIGN0eC0+cHJlZGljYXRlZF9yZWdzKTsKKyAgICAgICAgfQor
ICAgIH0KIH0KIAotc3RhdGljIGlubGluZSBib29sIGlzX3ByZWxvYWRlZChEaXNhc0NvbnRleHQg
KmN0eCwgaW50IG51bSkKK3N0YXRpYyBpbmxpbmUgdm9pZCBjdHhfbG9nX3JlZ193cml0ZV9wYWly
KERpc2FzQ29udGV4dCAqY3R4LCBpbnQgcm51bSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGJvb2wgaXNfcHJlZGljYXRlZCkKIHsKLSAgICByZXR1cm4gdGVzdF9i
aXQobnVtLCBjdHgtPnJlZ3Nfd3JpdHRlbik7CisgICAgY3R4X2xvZ19yZWdfd3JpdGUoY3R4LCBy
bnVtLCBpc19wcmVkaWNhdGVkKTsKKyAgICBjdHhfbG9nX3JlZ193cml0ZShjdHgsIHJudW0gKyAx
LCBpc19wcmVkaWNhdGVkKTsKIH0KIAogc3RhdGljIGlubGluZSBib29sIGlzX3ZyZWdfcHJlbG9h
ZGVkKERpc2FzQ29udGV4dCAqY3R4LCBpbnQgbnVtKQpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFn
b24vZ2VucHRyLmMgYi90YXJnZXQvaGV4YWdvbi9nZW5wdHIuYwppbmRleCAzNDkwMzEwODEyLi42
MWFiOWFmOWU0IDEwMDY0NAotLS0gYS90YXJnZXQvaGV4YWdvbi9nZW5wdHIuYworKysgYi90YXJn
ZXQvaGV4YWdvbi9nZW5wdHIuYwpAQCAtMTgwLDYgKzE4MCw3IEBAIHZvaWQgZ2VuX2xvZ19wcmVk
X3dyaXRlKERpc2FzQ29udGV4dCAqY3R4LCBpbnQgcG51bSwgVENHdiB2YWwpCiAgICAgICAgICAg
ICAgICAgICAgICAgIGhleF9uZXdfcHJlZF92YWx1ZVtwbnVtXSwgYmFzZV92YWwpOwogICAgIH0K
ICAgICB0Y2dfZ2VuX29yaV90bChoZXhfcHJlZF93cml0dGVuLCBoZXhfcHJlZF93cml0dGVuLCAx
IDw8IHBudW0pOworICAgIHNldF9iaXQocG51bSwgY3R4LT5wcmVnc193cml0dGVuKTsKIH0KIAog
c3RhdGljIGlubGluZSB2b2lkIGdlbl9yZWFkX3AzXzAoVENHdiBjb250cm9sX3JlZykKQEAgLTI1
Niw3ICsyNTcsNiBAQCBzdGF0aWMgdm9pZCBnZW5fd3JpdGVfcDNfMChEaXNhc0NvbnRleHQgKmN0
eCwgVENHdiBjb250cm9sX3JlZykKICAgICBmb3IgKGludCBpID0gMDsgaSA8IE5VTV9QUkVHUzsg
aSsrKSB7CiAgICAgICAgIHRjZ19nZW5fZXh0cmFjdF90bChoZXhfcDgsIGNvbnRyb2xfcmVnLCBp
ICogOCwgOCk7CiAgICAgICAgIGdlbl9sb2dfcHJlZF93cml0ZShjdHgsIGksIGhleF9wOCk7Ci0g
ICAgICAgIGN0eF9sb2dfcHJlZF93cml0ZShjdHgsIGkpOwogICAgIH0KIH0KIApAQCAtMjc0LDcg
KzI3NCw2IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBnZW5fd3JpdGVfY3RybF9yZWcoRGlzYXNDb250
ZXh0ICpjdHgsIGludCByZWdfbnVtLAogICAgICAgICBnZW5fd3JpdGVfcDNfMChjdHgsIHZhbCk7
CiAgICAgfSBlbHNlIHsKICAgICAgICAgZ2VuX2xvZ19yZWdfd3JpdGUocmVnX251bSwgdmFsKTsK
LSAgICAgICAgY3R4X2xvZ19yZWdfd3JpdGUoY3R4LCByZWdfbnVtKTsKICAgICAgICAgaWYgKHJl
Z19udW0gPT0gSEVYX1JFR19RRU1VX1BLVF9DTlQpIHsKICAgICAgICAgICAgIGN0eC0+bnVtX3Bh
Y2tldHMgPSAwOwogICAgICAgICB9CkBAIC0yOTYsMTAgKzI5NSw4IEBAIHN0YXRpYyBpbmxpbmUg
dm9pZCBnZW5fd3JpdGVfY3RybF9yZWdfcGFpcihEaXNhc0NvbnRleHQgKmN0eCwgaW50IHJlZ19u
dW0sCiAgICAgICAgIGdlbl93cml0ZV9wM18wKGN0eCwgdmFsMzIpOwogICAgICAgICB0Y2dfZ2Vu
X2V4dHJoX2k2NF9pMzIodmFsMzIsIHZhbCk7CiAgICAgICAgIGdlbl9sb2dfcmVnX3dyaXRlKHJl
Z19udW0gKyAxLCB2YWwzMik7Ci0gICAgICAgIGN0eF9sb2dfcmVnX3dyaXRlKGN0eCwgcmVnX251
bSArIDEpOwogICAgIH0gZWxzZSB7CiAgICAgICAgIGdlbl9sb2dfcmVnX3dyaXRlX3BhaXIocmVn
X251bSwgdmFsKTsKLSAgICAgICAgY3R4X2xvZ19yZWdfd3JpdGVfcGFpcihjdHgsIHJlZ19udW0p
OwogICAgICAgICBpZiAocmVnX251bSA9PSBIRVhfUkVHX1FFTVVfUEtUX0NOVCkgewogICAgICAg
ICAgICAgY3R4LT5udW1fcGFja2V0cyA9IDA7CiAgICAgICAgICAgICBjdHgtPm51bV9pbnNucyA9
IDA7CmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi9pZGVmLXBhcnNlci9wYXJzZXItaGVscGVy
cy5jIGIvdGFyZ2V0L2hleGFnb24vaWRlZi1wYXJzZXIvcGFyc2VyLWhlbHBlcnMuYwppbmRleCBj
YzJjZDAwMGRiLi40ZTBjNjQzY2FlIDEwMDY0NAotLS0gYS90YXJnZXQvaGV4YWdvbi9pZGVmLXBh
cnNlci9wYXJzZXItaGVscGVycy5jCisrKyBiL3RhcmdldC9oZXhhZ29uL2lkZWYtcGFyc2VyL3Bh
cnNlci1oZWxwZXJzLmMKQEAgLTEsNSArMSw1IEBACiAvKgotICogIENvcHlyaWdodChjKSAyMDE5
LTIwMjIgcmV2Lm5nIExhYnMgU3JsLiBBbGwgUmlnaHRzIFJlc2VydmVkLgorICogIENvcHlyaWdo
dChjKSAyMDE5LTIwMjMgcmV2Lm5nIExhYnMgU3JsLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogICoK
ICAqICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUg
aXQgYW5kL29yIG1vZGlmeQogICogIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVy
YWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5CkBAIC0xMzIwLDEwICsxMzIwLDYgQEAg
dm9pZCBnZW5fd3JpdGVfcmVnKENvbnRleHQgKmMsIFlZTFRZUEUgKmxvY3AsIEhleFZhbHVlICpy
ZWcsIEhleFZhbHVlICp2YWx1ZSkKICAgICAgICAgbG9jcCwKICAgICAgICAgImdlbl9sb2dfcmVn
X3dyaXRlKCIsICZyZWctPnJlZy5pZCwgIiwgIiwKICAgICAgICAgJnZhbHVlX20sICIpO1xuIik7
Ci0gICAgT1VUKGMsCi0gICAgICAgIGxvY3AsCi0gICAgICAgICJjdHhfbG9nX3JlZ193cml0ZShj
dHgsICIsICZyZWctPnJlZy5pZCwKLSAgICAgICAgIik7XG4iKTsKIH0KIAogdm9pZCBnZW5fYXNz
aWduKENvbnRleHQgKmMsCkBAIC0xNzIzLDcgKzE3MTksNiBAQCB2b2lkIGdlbl9wcmVkX2Fzc2ln
bihDb250ZXh0ICpjLCBZWUxUWVBFICpsb2NwLCBIZXhWYWx1ZSAqbGVmdF9wcmVkLAogICAgIGlm
IChpc19kaXJlY3QpIHsKICAgICAgICAgT1VUKGMsIGxvY3AsICJnZW5fbG9nX3ByZWRfd3JpdGUo
Y3R4LCAiLCBwcmVkX2lkLCAiLCAiLCBsZWZ0X3ByZWQsCiAgICAgICAgICAgICAiKTtcbiIpOwot
ICAgICAgICBPVVQoYywgbG9jcCwgImN0eF9sb2dfcHJlZF93cml0ZShjdHgsICIsIHByZWRfaWQs
ICIpO1xuIik7CiAgICAgfQogfQogCmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi90cmFuc2xh
dGUuYyBiL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5jCmluZGV4IDkzZmQxYjU1ZTMuLjllNWZj
ZWUxZWUgMTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5jCisrKyBiL3Rhcmdl
dC9oZXhhZ29uL3RyYW5zbGF0ZS5jCkBAIC0xLDUgKzEsNSBAQAogLyoKLSAqICBDb3B5cmlnaHQo
YykgMjAxOS0yMDIyIFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFsbCBSaWdodHMg
UmVzZXJ2ZWQuCisgKiAgQ29weXJpZ2h0KGMpIDIwMTktMjAyMyBRdWFsY29tbSBJbm5vdmF0aW9u
IENlbnRlciwgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogICoKICAqICBUaGlzIHByb2dyYW0g
aXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQog
ICogIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2Ug
YXMgcHVibGlzaGVkIGJ5CkBAIC0yOSw2ICsyOSwxNSBAQAogI2luY2x1ZGUgInRyYW5zbGF0ZS5o
IgogI2luY2x1ZGUgInByaW50aW5zbi5oIgogCisjaW5jbHVkZSAiYW5hbHl6ZV9mdW5jc19nZW5l
cmF0ZWQuYy5pbmMiCisKK3R5cGVkZWYgdm9pZCAoKkFuYWx5emVJbnNuKShEaXNhc0NvbnRleHQg
KmN0eCk7CitzdGF0aWMgY29uc3QgQW5hbHl6ZUluc24gb3Bjb2RlX2FuYWx5emVbWFhfTEFTVF9P
UENPREVdID0geworI2RlZmluZSBPUENPREUoWCkgICAgW1hdID0gYW5hbHl6ZV8jI1gKKyNpbmNs
dWRlICJvcGNvZGVzX2RlZl9nZW5lcmF0ZWQuaC5pbmMiCisjdW5kZWYgT1BDT0RFCit9OworCiBU
Q0d2IGhleF9ncHJbVE9UQUxfUEVSX1RIUkVBRF9SRUdTXTsKIFRDR3YgaGV4X3ByZWRbTlVNX1BS
RUdTXTsKIFRDR3YgaGV4X3RoaXNfUEM7CkBAIC0yNjUsNiArMjc0LDc2IEBAIHN0YXRpYyBib29s
IG5lZWRfbmV4dF9QQyhEaXNhc0NvbnRleHQgKmN0eCkKICAgICByZXR1cm4gZmFsc2U7CiB9CiAK
Ky8qCisgKiBUaGUgb3Bjb2RlX2FuYWx5emUgZnVuY3Rpb25zIG1hcmsgbW9zdCBvZiB0aGUgd3Jp
dGVzIGluIGEgcGFja2V0CisgKiBIb3dldmVyLCB0aGVyZSBhcmUgc29tZSBpbXBsaWNpdCB3cml0
ZXMgbWFya2VkIGFzIGF0dHJpYnV0ZXMKKyAqIG9mIHRoZSBhcHBsaWNhYmxlIGluc3RydWN0aW9u
cy4KKyAqLworc3RhdGljIHZvaWQgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoRGlzYXNDb250ZXh0
ICpjdHgsIGludCBhdHRyaWIsIGludCBybnVtKQoreworICAgIHVpbnQxNl90IG9wY29kZSA9IGN0
eC0+aW5zbi0+b3Bjb2RlOworICAgIGlmIChHRVRfQVRUUklCKG9wY29kZSwgYXR0cmliKSkgewor
ICAgICAgICAvKgorICAgICAgICAgKiBVU1IgaXMgdXNlZCB0byBzZXQgb3ZlcmZsb3cgYW5kIEZQ
IGV4Y2VwdGlvbnMsCisgICAgICAgICAqIHNvIHRyZWF0IGl0IGFzIGNvbmRpdGlvbmFsCisgICAg
ICAgICAqLworICAgICAgICBib29sIGlzX3ByZWRpY2F0ZWQgPSBHRVRfQVRUUklCKG9wY29kZSwg
QV9DT05ERVhFQykgfHwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm51bSA9PSBIRVhf
UkVHX1VTUjsKKworICAgICAgICAvKiBMQzAvTEMxIGlzIGNvbmRpdGlvbmFsbHkgd3JpdHRlbiBi
eSBlbmRsb29wIGluc3RydWN0aW9ucyAqLworICAgICAgICBpZiAoKHJudW0gPT0gSEVYX1JFR19M
QzAgfHwgcm51bSA9PSBIRVhfUkVHX0xDMSkgJiYKKyAgICAgICAgICAgIChvcGNvZGUgPT0gSjJf
ZW5kbG9vcDAgfHwKKyAgICAgICAgICAgICBvcGNvZGUgPT0gSjJfZW5kbG9vcDEgfHwKKyAgICAg
ICAgICAgICBvcGNvZGUgPT0gSjJfZW5kbG9vcDAxKSkgeworICAgICAgICAgICAgaXNfcHJlZGlj
YXRlZCA9IHRydWU7CisgICAgICAgIH0KKworICAgICAgICBjdHhfbG9nX3JlZ193cml0ZShjdHgs
IHJudW0sIGlzX3ByZWRpY2F0ZWQpOworICAgIH0KK30KKworc3RhdGljIHZvaWQgbWFya19pbXBs
aWNpdF9yZWdfd3JpdGVzKERpc2FzQ29udGV4dCAqY3R4KQoreworICAgIG1hcmtfaW1wbGljaXRf
cmVnX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfRlAsICBIRVhfUkVHX0ZQKTsKKyAgICBt
YXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX1NQLCAgSEVYX1JF
R19TUCk7CisgICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRF
U19MUiwgIEhFWF9SRUdfTFIpOworICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9J
TVBMSUNJVF9XUklURVNfTEMwLCBIRVhfUkVHX0xDMCk7CisgICAgbWFya19pbXBsaWNpdF9yZWdf
d3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19TQTAsIEhFWF9SRUdfU0EwKTsKKyAgICBtYXJr
X2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX0xDMSwgSEVYX1JFR19M
QzEpOworICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNf
U0ExLCBIRVhfUkVHX1NBMSk7CisgICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0lN
UExJQ0lUX1dSSVRFU19VU1IsIEhFWF9SRUdfVVNSKTsKKyAgICBtYXJrX2ltcGxpY2l0X3JlZ193
cml0ZShjdHgsIEFfRlBPUCwgSEVYX1JFR19VU1IpOworfQorCitzdGF0aWMgdm9pZCBtYXJrX2lt
cGxpY2l0X3ByZWRfd3JpdGUoRGlzYXNDb250ZXh0ICpjdHgsIGludCBhdHRyaWIsIGludCBwbnVt
KQoreworICAgIGlmIChHRVRfQVRUUklCKGN0eC0+aW5zbi0+b3Bjb2RlLCBhdHRyaWIpKSB7Cisg
ICAgICAgIGN0eF9sb2dfcHJlZF93cml0ZShjdHgsIHBudW0pOworICAgIH0KK30KKworc3RhdGlj
IHZvaWQgbWFya19pbXBsaWNpdF9wcmVkX3dyaXRlcyhEaXNhc0NvbnRleHQgKmN0eCkKK3sKKyAg
ICBtYXJrX2ltcGxpY2l0X3ByZWRfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19QMCwgMCk7
CisgICAgbWFya19pbXBsaWNpdF9wcmVkX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfUDEs
IDEpOworICAgIG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVT
X1AyLCAyKTsKKyAgICBtYXJrX2ltcGxpY2l0X3ByZWRfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dS
SVRFU19QMywgMyk7Cit9CisKK3N0YXRpYyB2b2lkIGFuYWx5emVfcGFja2V0KERpc2FzQ29udGV4
dCAqY3R4KQoreworICAgIFBhY2tldCAqcGt0ID0gY3R4LT5wa3Q7CisgICAgZm9yIChpbnQgaSA9
IDA7IGkgPCBwa3QtPm51bV9pbnNuczsgaSsrKSB7CisgICAgICAgIEluc24gKmluc24gPSAmcGt0
LT5pbnNuW2ldOworICAgICAgICBjdHgtPmluc24gPSBpbnNuOworICAgICAgICBpZiAob3Bjb2Rl
X2FuYWx5emVbaW5zbi0+b3Bjb2RlXSkgeworICAgICAgICAgICAgb3Bjb2RlX2FuYWx5emVbaW5z
bi0+b3Bjb2RlXShjdHgpOworICAgICAgICB9CisgICAgICAgIG1hcmtfaW1wbGljaXRfcmVnX3dy
aXRlcyhjdHgpOworICAgICAgICBtYXJrX2ltcGxpY2l0X3ByZWRfd3JpdGVzKGN0eCk7CisgICAg
fQorfQorCiBzdGF0aWMgdm9pZCBnZW5fc3RhcnRfcGFja2V0KERpc2FzQ29udGV4dCAqY3R4KQog
ewogICAgIFBhY2tldCAqcGt0ID0gY3R4LT5wa3Q7CkBAIC0yNzUsNiArMzU0LDcgQEAgc3RhdGlj
IHZvaWQgZ2VuX3N0YXJ0X3BhY2tldChEaXNhc0NvbnRleHQgKmN0eCkKICAgICBjdHgtPm5leHRf
UEMgPSBuZXh0X1BDOwogICAgIGN0eC0+cmVnX2xvZ19pZHggPSAwOwogICAgIGJpdG1hcF96ZXJv
KGN0eC0+cmVnc193cml0dGVuLCBUT1RBTF9QRVJfVEhSRUFEX1JFR1MpOworICAgIGJpdG1hcF96
ZXJvKGN0eC0+cHJlZGljYXRlZF9yZWdzLCBUT1RBTF9QRVJfVEhSRUFEX1JFR1MpOwogICAgIGN0
eC0+cHJlZ19sb2dfaWR4ID0gMDsKICAgICBiaXRtYXBfemVybyhjdHgtPnByZWdzX3dyaXR0ZW4s
IE5VTV9QUkVHUyk7CiAgICAgY3R4LT5mdXR1cmVfdnJlZ3NfaWR4ID0gMDsKQEAgLTI5MSw2ICsz
NzEsMTQgQEAgc3RhdGljIHZvaWQgZ2VuX3N0YXJ0X3BhY2tldChEaXNhc0NvbnRleHQgKmN0eCkK
ICAgICBjdHgtPnMxX3N0b3JlX3Byb2Nlc3NlZCA9IGZhbHNlOwogICAgIGN0eC0+cHJlX2NvbW1p
dCA9IHRydWU7CiAKKyAgICBhbmFseXplX3BhY2tldChjdHgpOworCisgICAgLyoKKyAgICAgKiBw
cmVnc193cml0dGVuIGlzIHVzZWQgYm90aCBpbiB0aGUgYW5hbHl6ZSBwaGFzZSBhcyB3ZWxsIGFz
IHRoZSBjb2RlCisgICAgICogZ2VuIHBoYXNlLCBzbyBjbGVhciBpdCBhZ2Fpbi4KKyAgICAgKi8K
KyAgICBiaXRtYXBfemVybyhjdHgtPnByZWdzX3dyaXR0ZW4sIE5VTV9QUkVHUyk7CisKICAgICBp
ZiAoSEVYX0RFQlVHKSB7CiAgICAgICAgIC8qIEhhbmR5IHBsYWNlIHRvIHNldCBhIGJyZWFrcG9p
bnQgYmVmb3JlIHRoZSBwYWNrZXQgZXhlY3V0ZXMgKi8KICAgICAgICAgZ2VuX2hlbHBlcl9kZWJ1
Z19zdGFydF9wYWNrZXQoY3B1X2Vudik7CkBAIC0zMTMsNiArNDAxLDE2IEBAIHN0YXRpYyB2b2lk
IGdlbl9zdGFydF9wYWNrZXQoRGlzYXNDb250ZXh0ICpjdHgpCiAgICAgICAgIHRjZ19nZW5fbW92
aV90bChoZXhfcHJlZF93cml0dGVuLCAwKTsKICAgICB9CiAKKyAgICAvKiBQcmVsb2FkIHRoZSBw
cmVkaWNhdGVkIHJlZ2lzdGVycyBpbnRvIGhleF9uZXdfdmFsdWVbaV0gKi8KKyAgICBpZiAoIWJp
dG1hcF9lbXB0eShjdHgtPnByZWRpY2F0ZWRfcmVncywgVE9UQUxfUEVSX1RIUkVBRF9SRUdTKSkg
eworICAgICAgICBpbnQgaSA9IGZpbmRfZmlyc3RfYml0KGN0eC0+cHJlZGljYXRlZF9yZWdzLCBU
T1RBTF9QRVJfVEhSRUFEX1JFR1MpOworICAgICAgICB3aGlsZSAoaSA8IFRPVEFMX1BFUl9USFJF
QURfUkVHUykgeworICAgICAgICAgICAgdGNnX2dlbl9tb3ZfdGwoaGV4X25ld192YWx1ZVtpXSwg
aGV4X2dwcltpXSk7CisgICAgICAgICAgICBpID0gZmluZF9uZXh0X2JpdChjdHgtPnByZWRpY2F0
ZWRfcmVncywgVE9UQUxfUEVSX1RIUkVBRF9SRUdTLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgaSArIDEpOworICAgICAgICB9CisgICAgfQorCiAgICAgaWYgKHBrdC0+cGt0X2hhc19o
dngpIHsKICAgICAgICAgdGNnX2dlbl9tb3ZpX3RsKGhleF9WUmVnc191cGRhdGVkLCAwKTsKICAg
ICAgICAgdGNnX2dlbl9tb3ZpX3RsKGhleF9RUmVnc191cGRhdGVkLCAwKTsKQEAgLTMzNiw2NiAr
NDM0LDYgQEAgYm9vbCBpc19nYXRoZXJfc3RvcmVfaW5zbihEaXNhc0NvbnRleHQgKmN0eCkKICAg
ICByZXR1cm4gZmFsc2U7CiB9CiAKLS8qCi0gKiBUaGUgTE9HXypfV1JJVEUgbWFjcm9zIG1hcmsg
bW9zdCBvZiB0aGUgd3JpdGVzIGluIGEgcGFja2V0Ci0gKiBIb3dldmVyLCB0aGVyZSBhcmUgc29t
ZSBpbXBsaWNpdCB3cml0ZXMgbWFya2VkIGFzIGF0dHJpYnV0ZXMKLSAqIG9mIHRoZSBhcHBsaWNh
YmxlIGluc3RydWN0aW9ucy4KLSAqLwotc3RhdGljIHZvaWQgbWFya19pbXBsaWNpdF9yZWdfd3Jp
dGUoRGlzYXNDb250ZXh0ICpjdHgsIGludCBhdHRyaWIsIGludCBybnVtKQotewotICAgIHVpbnQx
Nl90IG9wY29kZSA9IGN0eC0+aW5zbi0+b3Bjb2RlOwotICAgIGlmIChHRVRfQVRUUklCKG9wY29k
ZSwgYXR0cmliKSkgewotICAgICAgICAvKgotICAgICAgICAgKiBVU1IgaXMgdXNlZCB0byBzZXQg
b3ZlcmZsb3cgYW5kIEZQIGV4Y2VwdGlvbnMsCi0gICAgICAgICAqIHNvIHRyZWF0IGl0IGFzIGNv
bmRpdGlvbmFsCi0gICAgICAgICAqLwotICAgICAgICBib29sIGlzX3ByZWRpY2F0ZWQgPSBHRVRf
QVRUUklCKG9wY29kZSwgQV9DT05ERVhFQykgfHwKLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgcm51bSA9PSBIRVhfUkVHX1VTUjsKLQotICAgICAgICAvKiBMQzAvTEMxIGlzIGNvbmRpdGlv
bmFsbHkgd3JpdHRlbiBieSBlbmRsb29wIGluc3RydWN0aW9ucyAqLwotICAgICAgICBpZiAoKHJu
dW0gPT0gSEVYX1JFR19MQzAgfHwgcm51bSA9PSBIRVhfUkVHX0xDMSkgJiYKLSAgICAgICAgICAg
IChvcGNvZGUgPT0gSjJfZW5kbG9vcDAgfHwKLSAgICAgICAgICAgICBvcGNvZGUgPT0gSjJfZW5k
bG9vcDEgfHwKLSAgICAgICAgICAgICBvcGNvZGUgPT0gSjJfZW5kbG9vcDAxKSkgewotICAgICAg
ICAgICAgaXNfcHJlZGljYXRlZCA9IHRydWU7Ci0gICAgICAgIH0KLQotICAgICAgICBpZiAoaXNf
cHJlZGljYXRlZCAmJiAhaXNfcHJlbG9hZGVkKGN0eCwgcm51bSkpIHsKLSAgICAgICAgICAgIHRj
Z19nZW5fbW92X3RsKGhleF9uZXdfdmFsdWVbcm51bV0sIGhleF9ncHJbcm51bV0pOwotICAgICAg
ICB9Ci0KLSAgICAgICAgY3R4X2xvZ19yZWdfd3JpdGUoY3R4LCBybnVtKTsKLSAgICB9Ci19Ci0K
LXN0YXRpYyB2b2lkIG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZShEaXNhc0NvbnRleHQgKmN0eCwg
aW50IGF0dHJpYiwgaW50IHBudW0pCi17Ci0gICAgaWYgKEdFVF9BVFRSSUIoY3R4LT5pbnNuLT5v
cGNvZGUsIGF0dHJpYikpIHsKLSAgICAgICAgY3R4X2xvZ19wcmVkX3dyaXRlKGN0eCwgcG51bSk7
Ci0gICAgfQotfQotCi1zdGF0aWMgdm9pZCBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZXMoRGlzYXND
b250ZXh0ICpjdHgpCi17Ci0gICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0lNUExJ
Q0lUX1dSSVRFU19GUCwgIEhFWF9SRUdfRlApOwotICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRl
KGN0eCwgQV9JTVBMSUNJVF9XUklURVNfU1AsICBIRVhfUkVHX1NQKTsKLSAgICBtYXJrX2ltcGxp
Y2l0X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX0xSLCAgSEVYX1JFR19MUik7Ci0g
ICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19MQzAsIEhF
WF9SRUdfTEMwKTsKLSAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRf
V1JJVEVTX1NBMCwgSEVYX1JFR19TQTApOwotICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0
eCwgQV9JTVBMSUNJVF9XUklURVNfTEMxLCBIRVhfUkVHX0xDMSk7Ci0gICAgbWFya19pbXBsaWNp
dF9yZWdfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19TQTEsIEhFWF9SRUdfU0ExKTsKLSAg
ICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX1VTUiwgSEVY
X1JFR19VU1IpOwotICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9GUE9QLCBIRVhf
UkVHX1VTUik7Ci19Ci0KLXN0YXRpYyB2b2lkIG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZXMoRGlz
YXNDb250ZXh0ICpjdHgpCi17Ci0gICAgbWFya19pbXBsaWNpdF9wcmVkX3dyaXRlKGN0eCwgQV9J
TVBMSUNJVF9XUklURVNfUDAsIDApOwotICAgIG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZShjdHgs
IEFfSU1QTElDSVRfV1JJVEVTX1AxLCAxKTsKLSAgICBtYXJrX2ltcGxpY2l0X3ByZWRfd3JpdGUo
Y3R4LCBBX0lNUExJQ0lUX1dSSVRFU19QMiwgMik7Ci0gICAgbWFya19pbXBsaWNpdF9wcmVkX3dy
aXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfUDMsIDMpOwotfQotCiBzdGF0aWMgdm9pZCBtYXJr
X3N0b3JlX3dpZHRoKERpc2FzQ29udGV4dCAqY3R4KQogewogICAgIHVpbnQxNl90IG9wY29kZSA9
IGN0eC0+aW5zbi0+b3Bjb2RlOwpAQCAtNDIzLDkgKzQ2MSw3IEBAIHN0YXRpYyB2b2lkIG1hcmtf
c3RvcmVfd2lkdGgoRGlzYXNDb250ZXh0ICpjdHgpCiBzdGF0aWMgdm9pZCBnZW5faW5zbihEaXNh
c0NvbnRleHQgKmN0eCkKIHsKICAgICBpZiAoY3R4LT5pbnNuLT5nZW5lcmF0ZSkgewotICAgICAg
ICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZXMoY3R4KTsKICAgICAgICAgY3R4LT5pbnNuLT5nZW5l
cmF0ZShjdHgpOwotICAgICAgICBtYXJrX2ltcGxpY2l0X3ByZWRfd3JpdGVzKGN0eCk7CiAgICAg
ICAgIG1hcmtfc3RvcmVfd2lkdGgoY3R4KTsKICAgICB9IGVsc2UgewogICAgICAgICBnZW5fZXhj
ZXB0aW9uX2VuZF90YihjdHgsIEhFWF9FWENQX0lOVkFMSURfT1BDT0RFKTsKZGlmZiAtLWdpdCBh
L3RhcmdldC9oZXhhZ29uL1JFQURNRSBiL3RhcmdldC9oZXhhZ29uL1JFQURNRQppbmRleCAyNTE5
NjBiODYyLi4zNjU2MDZmMWU2IDEwMDY0NAotLS0gYS90YXJnZXQvaGV4YWdvbi9SRUFETUUKKysr
IGIvdGFyZ2V0L2hleGFnb24vUkVBRE1FCkBAIC01Miw2ICs1Miw3IEBAIGhlYWRlciBmaWxlcyBp
biA8QlVJTERfRElSPi90YXJnZXQvaGV4YWdvbgogICAgICAgICBnZW5fdGNnX2Z1bmNfdGFibGUu
cHkgICAgICAgICAgIC0+IHRjZ19mdW5jX3RhYmxlX2dlbmVyYXRlZC5jLmluYwogICAgICAgICBn
ZW5faGVscGVyX2Z1bmNzLnB5ICAgICAgICAgICAgIC0+IGhlbHBlcl9mdW5jc19nZW5lcmF0ZWQu
Yy5pbmMKICAgICAgICAgZ2VuX2lkZWZfcGFyc2VyX2Z1bmNzLnB5ICAgICAgICAtPiBpZGVmX3Bh
cnNlcl9pbnB1dC5oCisgICAgICAgIGdlbl9hbmFseXplX2Z1bmNzLnB5ICAgICAgICAgICAgLT4g
YW5hbHl6ZV9mdW5jc19nZW5lcmF0ZWQuYy5pbmMKIAogUWVtdSBoZWxwZXIgZnVuY3Rpb25zIGhh
dmUgMyBwYXJ0cwogICAgIERFRl9IRUxQRVIgZGVjbGFyYXRpb24gaW5kaWNhdGVzIHRoZSBzaWdu
YXR1cmUgb2YgdGhlIGhlbHBlcgpAQCAtODcsNyArODgsNiBAQCB0Y2dfZnVuY3NfZ2VuZXJhdGVk
LmMuaW5jCiAgICAgICAgIFRDR3YgUnRWID0gaGV4X2dwcltpbnNuLT5yZWdub1syXV07CiAgICAg
ICAgIGdlbl9oZWxwZXJfQTJfYWRkKFJkViwgY3B1X2VudiwgUnNWLCBSdFYpOwogICAgICAgICBn
ZW5fbG9nX3JlZ193cml0ZShSZE4sIFJkVik7Ci0gICAgICAgIGN0eF9sb2dfcmVnX3dyaXRlKGN0
eCwgUmROKTsKICAgICB9CiAKIGhlbHBlcl9mdW5jc19nZW5lcmF0ZWQuYy5pbmMKQEAgLTE2MCw3
ICsxNjAsNiBAQCBpc3RydWN0aW9uLgogICAgICAgICBUQ0d2IHNsb3QgPSB0Y2dfY29uc3RhbnRf
dGwoaW5zbi0+c2xvdCk7CiAgICAgICAgIGdlbl9oZWxwZXJfVjZfdmFkZHcoY3B1X2VudiwgVmRW
LCBWdVYsIFZ2Viwgc2xvdCk7CiAgICAgICAgIGdlbl9sb2dfdnJlZ193cml0ZShjdHgsIFZkVl9v
ZmYsIFZkTiwgRVhUX0RGTCwgaW5zbi0+c2xvdCwgZmFsc2UpOwotICAgICAgICBjdHhfbG9nX3Zy
ZWdfd3JpdGUoY3R4LCBWZE4sIEVYVF9ERkwsIGZhbHNlKTsKICAgICB9CiAKIE5vdGljZSB0aGF0
IHdlIGFsc28gZ2VuZXJhdGUgYSB2YXJpYWJsZSBuYW1lZCA8b3BlcmFuZD5fb2ZmIGZvciBlYWNo
IG9wZXJhbmQgb2YKQEAgLTE5MCw5ICsxODksMTQgQEAgd2hlbiB0aGUgb3ZlcnJpZGUgaXMgcHJl
c2VudC4KICAgICAgICAgICAgIHZyZWdfc3JjX29mZihjdHgsIFZ2Tik7CiAgICAgICAgIGZHRU5f
VENHX1Y2X3ZhZGR3KHsgZkhJREUoaW50IGk7KSBmVkZPUkVBQ0goMzIsIGkpIHsgVmRWLndbaV0g
PSBWdVYud1tpXSArIFZ2Vi53W2ldIDsgfSB9KTsKICAgICAgICAgZ2VuX2xvZ192cmVnX3dyaXRl
KGN0eCwgVmRWX29mZiwgVmROLCBFWFRfREZMLCBpbnNuLT5zbG90LCBmYWxzZSk7Ci0gICAgICAg
IGN0eF9sb2dfdnJlZ193cml0ZShjdHgsIFZkTiwgRVhUX0RGTCwgZmFsc2UpOwogICAgIH0KIAor
V2UgYWxzbyBnZW5lcmF0ZSBhbiBhbmFseXplXzx0YWc+IGZ1bmN0aW9uIGZvciBlYWNoIGluc3Ry
dWN0aW9uLiAgQ3VycmVudGx5LAordGhlc2UgZnVuY3Rpb25zIHJlY29yZCB0aGUgd3JpdGVzIHRv
IHJlZ2lzdGVycyBieSBjYWxsaW5nIGN0eF9sb2dfKi4gIER1cmluZworZ2VuX3N0YXJ0X3BhY2tl
dCwgd2UgaW52b2tlIHRoZSBhbmFseXplXzx0YWc+IGZ1bmN0aW9uIGZvciBlYWNoIGluc3RydWN0
aW9uIGluCit0aGUgcGFja2V0LCBhbmQgd2UgbWFyayB0aGUgaW1wbGljaXQgd3JpdGVzLiAgQWZ0
ZXIgdGhlIGFuYWx5c2lzIGlzIHBlcmZvcm1lZCwKK3dlIGluaXRpYWxpemUgaGV4X25ld192YWx1
ZSBmb3IgZWFjaCBvZiB0aGUgcHJlZGljYXRlZCBhc3NpZ25tZW50cy4KKwogSW4gYWRkaXRpb24g
dG8gaW5zdHJ1Y3Rpb24gc2VtYW50aWNzLCB3ZSB1c2UgYSBnZW5lcmF0b3IgdG8gY3JlYXRlIHRo
ZSBkZWNvZGUKIHRyZWUuICBUaGlzIGdlbmVyYXRpb24gaXMgYWxzbyBhIHR3byBzdGVwIHByb2Nl
c3MuICBUaGUgZmlyc3Qgc3RlcCBpcyB0byBydW4KIHRhcmdldC9oZXhhZ29uL2dlbl9kZWN0cmVl
X2ltcG9ydC5jIHRvIHByb2R1Y2UKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29uL2dlbl9hbmFs
eXplX2Z1bmNzLnB5IGIvdGFyZ2V0L2hleGFnb24vZ2VuX2FuYWx5emVfZnVuY3MucHkKbmV3IGZp
bGUgbW9kZSAxMDA3NTUKaW5kZXggMDAwMDAwMDAwMC4uMzdjMTY2ZGMwZAotLS0gL2Rldi9udWxs
CisrKyBiL3RhcmdldC9oZXhhZ29uL2dlbl9hbmFseXplX2Z1bmNzLnB5CkBAIC0wLDAgKzEsMjM3
IEBACisjIS91c3IvYmluL2VudiBweXRob24zCisKKyMjCisjIyAgQ29weXJpZ2h0KGMpIDIwMjIt
MjAyMyBRdWFsY29tbSBJbm5vdmF0aW9uIENlbnRlciwgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVk
LgorIyMKKyMjICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3Ry
aWJ1dGUgaXQgYW5kL29yIG1vZGlmeQorIyMgIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05V
IEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5CisjIyAgdGhlIEZyZWUgU29m
dHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IKKyMj
ICAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorIyMKKyMjICBUaGlzIHByb2dy
YW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyMj
ICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJy
YW50eSBvZgorIyMgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIg
UFVSUE9TRS4gIFNlZSB0aGUKKyMjICBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9y
ZSBkZXRhaWxzLgorIyMKKyMjICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRo
ZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQorIyMgIGFsb25nIHdpdGggdGhpcyBwcm9ncmFt
OyBpZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCisjIworCitpbXBv
cnQgc3lzCitpbXBvcnQgcmUKK2ltcG9ydCBzdHJpbmcKK2ltcG9ydCBoZXhfY29tbW9uCisKKyMj
CisjIyBIZWxwZXJzIGZvciBnZW5fYW5hbHl6ZV9mdW5jCisjIworZGVmIGlzX3ByZWRpY2F0ZWQo
dGFnKToKKyAgICByZXR1cm4gJ0FfQ09OREVYRUMnIGluIGhleF9jb21tb24uYXR0cmliZGljdFt0
YWddCisKK2RlZiBhbmFseXplX29wbl9vbGQoZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgcmVnbm8p
OgorICAgIHJlZ04gPSAiJXMlc04iICUgKHJlZ3R5cGUsIHJlZ2lkKQorICAgIHByZWRpY2F0ZWQg
PSAidHJ1ZSIgaWYgaXNfcHJlZGljYXRlZCh0YWcpIGVsc2UgImZhbHNlIgorICAgIGlmIChyZWd0
eXBlID09ICJSIik6CisgICAgICAgIGlmIChyZWdpZCBpbiB7InNzIiwgInR0In0pOgorICAgICAg
ICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAl
IFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbGlmIChyZWdpZCBp
biB7ImRkIiwgImVlIiwgInh4IiwgInl5In0pOgorICAgICAgICAgICAgZi53cml0ZSgiICAgIGNv
bnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSAocmVnTiwgcmVnbm8pKQorICAgICAg
ICAgICAgZi53cml0ZSgiICAgIGN0eF9sb2dfcmVnX3dyaXRlX3BhaXIoY3R4LCAlcywgJXMpO1xu
IiAlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcHJlZGljYXRlZCkpCisgICAgICAgIGVsaWYg
KHJlZ2lkIGluIHsicyIsICJ0IiwgInUiLCAidiJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8v
ICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAg
ICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxpZiAocmVnaWQgaW4geyJkIiwgImUiLCAieCIs
ICJ5In0pOgorICAgICAgICAgICAgZi53cml0ZSgiICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJl
Z25vWyVkXTtcbiIgJSAocmVnTiwgcmVnbm8pKQorICAgICAgICAgICAgZi53cml0ZSgiICAgIGN0
eF9sb2dfcmVnX3dyaXRlKGN0eCwgJXMsICVzKTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJl
Z04sIHByZWRpY2F0ZWQpKQorICAgICAgICBlbHNlOgorICAgICAgICAgICAgcHJpbnQoIkJhZCBy
ZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCisgICAgZWxpZiAocmVndHlwZSA9PSAi
UCIpOgorICAgICAgICBpZiAocmVnaWQgaW4geyJzIiwgInQiLCAidSIsICJ2In0pOgorICAgICAg
ICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAl
IFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbGlmIChyZWdpZCBp
biB7ImQiLCAiZSIsICJ4In0pOgorICAgICAgICAgICAgZi53cml0ZSgiICAgIGNvbnN0IGludCAl
cyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSAocmVnTiwgcmVnbm8pKQorICAgICAgICAgICAgZi53
cml0ZSgiICAgIGN0eF9sb2dfcHJlZF93cml0ZShjdHgsICVzKTtcbiIgJSAocmVnTikpCisgICAg
ICAgIGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0
eXBlLCByZWdpZCkKKyAgICBlbGlmIChyZWd0eXBlID09ICJDIik6CisgICAgICAgIGlmIChyZWdp
ZCA9PSAic3MiKToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGlu
c24tPnJlZ25vWyVkXSArIEhFWF9SRUdfU0EwO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVn
TiwgcmVnbm8pKQorICAgICAgICBlbGlmIChyZWdpZCA9PSAiZGQiKToKKyAgICAgICAgICAgIGYu
d3JpdGUoIiAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF0gKyBIRVhfUkVHX1NBMDtc
biIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgICAgIGYud3Jp
dGUoIiAgICBjdHhfbG9nX3JlZ193cml0ZV9wYWlyKGN0eCwgJXMsICVzKTtcbiIgJSBcCisgICAg
ICAgICAgICAgICAgKHJlZ04sIHByZWRpY2F0ZWQpKQorICAgICAgICBlbGlmIChyZWdpZCA9PSAi
cyIpOgorICAgICAgICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVn
bm9bJWRdICsgSEVYX1JFR19TQTA7XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdu
bykpCisgICAgICAgIGVsaWYgKHJlZ2lkID09ICJkIik6CisgICAgICAgICAgICBmLndyaXRlKCIg
ICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdICsgSEVYX1JFR19TQTA7XG4iICUgXAor
ICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgICAgICBmLndyaXRlKCIgICAg
Y3R4X2xvZ19yZWdfd3JpdGUoY3R4LCAlcywgJXMpO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAo
cmVnTiwgcHJlZGljYXRlZCkpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFk
IHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKyAgICBlbGlmIChyZWd0eXBlID09
ICJNIik6CisgICAgICAgIGlmIChyZWdpZCA9PSAidSIpOgorICAgICAgICAgICAgZi53cml0ZSgi
Ly8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiUgXAorICAgICAgICAgICAg
ICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFk
IHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKyAgICBlbGlmIChyZWd0eXBlID09
ICJWIik6CisgICAgICAgIGlmIChyZWdpZCBpbiB7ImRkIiwgInh4In0pOgorICAgICAgICAgICAg
Zi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlXAorICAg
ICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVsaWYgKHJlZ2lkIGluIHsidXUi
LCAidnYifSk6CisgICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNu
LT5yZWdub1slZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAg
ICAgIGVsaWYgKHJlZ2lkIGluIHsicyIsICJ1IiwgInYiLCAidyJ9KToKKyAgICAgICAgICAgIGYu
d3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAg
ICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxpZiAocmVnaWQgaW4geyJkIiwg
IngiLCAieSJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGlu
c24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAg
ICAgICAgZWxzZToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJl
Z3R5cGUsIHJlZ2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIlEiKToKKyAgICAgICAgaWYgKHJl
Z2lkIGluIHsiZCIsICJlIiwgIngifSk6CisgICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25z
dCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdO
LCByZWdubykpCisgICAgICAgIGVsaWYgKHJlZ2lkIGluIHsicyIsICJ0IiwgInUiLCAidiJ9KToK
KyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVk
XTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxzZToK
KyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lk
KQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIkciKToKKyAgICAgICAgaWYgKHJlZ2lkIGluIHsiZGQi
fSk6CisgICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdu
b1slZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVs
aWYgKHJlZ2lkIGluIHsiZCJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGlu
dCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJl
Z25vKSkKKyAgICAgICAgZWxpZiAocmVnaWQgaW4geyJzcyJ9KToKKyAgICAgICAgICAgIGYud3Jp
dGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAg
ICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxpZiAocmVnaWQgaW4geyJzIn0pOgor
ICAgICAgICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRd
O1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbHNlOgor
ICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQp
CisgICAgZWxpZiAocmVndHlwZSA9PSAiUyIpOgorICAgICAgICBpZiAocmVnaWQgaW4geyJkZCJ9
KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25v
WyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxp
ZiAocmVnaWQgaW4geyJkIn0pOgorICAgICAgICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50
ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVn
bm8pKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7InNzIn0pOgorICAgICAgICAgICAgZi53cml0
ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwKKyAgICAgICAg
ICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7InMifSk6Cisg
ICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07
XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVsc2U6Cisg
ICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkK
KyAgICBlbHNlOgorICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBl
LCByZWdpZCkKKworZGVmIGFuYWx5emVfb3BuX25ldyhmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCBy
ZWdubyk6CisgICAgcmVnTiA9ICIlcyVzTiIgJSAocmVndHlwZSwgcmVnaWQpCisgICAgaWYgKHJl
Z3R5cGUgPT0gIk4iKToKKyAgICAgICAgaWYgKHJlZ2lkIGluIHsicyIsICJ0In0pOgorICAgICAg
ICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAl
IFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbHNlOgorICAgICAg
ICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCisgICAg
ZWxpZiAocmVndHlwZSA9PSAiUCIpOgorICAgICAgICBpZiAocmVnaWQgaW4geyJ0IiwgInUiLCAi
diJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJl
Z25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAg
ZWxzZToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUs
IHJlZ2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIk8iKToKKyAgICAgICAgaWYgKHJlZ2lkID09
ICJzIik6CisgICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5y
ZWdub1slZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAg
IGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBl
LCByZWdpZCkKKyAgICBlbHNlOgorICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAi
LCByZWd0eXBlLCByZWdpZCkKKworZGVmIGFuYWx5emVfb3BuKGYsIHRhZywgcmVndHlwZSwgcmVn
aWQsIHRvc3MsIG51bXJlZ3MsIGkpOgorICAgIGlmIChoZXhfY29tbW9uLmlzX3BhaXIocmVnaWQp
KToKKyAgICAgICAgYW5hbHl6ZV9vcG5fb2xkKGYsIHRhZywgcmVndHlwZSwgcmVnaWQsIGkpCisg
ICAgZWxpZiAoaGV4X2NvbW1vbi5pc19zaW5nbGUocmVnaWQpKToKKyAgICAgICAgaWYgaGV4X2Nv
bW1vbi5pc19vbGRfdmFsKHJlZ3R5cGUsIHJlZ2lkLCB0YWcpOgorICAgICAgICAgICAgYW5hbHl6
ZV9vcG5fb2xkKGYsdGFnLCByZWd0eXBlLCByZWdpZCwgaSkKKyAgICAgICAgZWxpZiBoZXhfY29t
bW9uLmlzX25ld192YWwocmVndHlwZSwgcmVnaWQsIHRhZyk6CisgICAgICAgICAgICBhbmFseXpl
X29wbl9uZXcoZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgaSkKKyAgICAgICAgZWxzZToKKyAgICAg
ICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkLCB0b3Nz
LCBudW1yZWdzKQorICAgIGVsc2U6CisgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6
ICIsIHJlZ3R5cGUsIHJlZ2lkLCB0b3NzLCBudW1yZWdzKQorCisjIworIyMgR2VuZXJhdGUgdGhl
IGNvZGUgdG8gYW5hbHl6ZSB0aGUgaW5zdHJ1Y3Rpb24KKyMjICAgICBGb3IgQTJfYWRkOiBSZDMy
PWFkZChSczMyLFJ0MzIpLCB7IFJkVj1Sc1YrUnRWO30KKyMjICAgICBXZSBwcm9kdWNlOgorIyMg
ICAgIHN0YXRpYyB2b2lkIGFuYWx5emVfQTJfYWRkKERpc2FzQ29udGV4dCAqY3R4KQorIyMgICAg
IHsKKyMjICAgICAgICAgSW5zbiAqaW5zbiBHX0dOVUNfVU5VU0VEID0gY3R4LT5pbnNuOworIyMg
ICAgICAgICBjb25zdCBpbnQgUmROID0gaW5zbi0+cmVnbm9bMF07CisjIyAgICAgICAgIGN0eF9s
b2dfcmVnX3dyaXRlKGN0eCwgUmROLCBmYWxzZSk7CisjIyAgICAgLy8gICAgY29uc3QgaW50IFJz
TiA9IGluc24tPnJlZ25vWzFdOworIyMgICAgIC8vICAgIGNvbnN0IGludCBSdE4gPSBpbnNuLT5y
ZWdub1syXTsKKyMjICAgICB9CisjIworZGVmIGdlbl9hbmFseXplX2Z1bmMoZiwgdGFnLCByZWdz
LCBpbW1zKToKKyAgICBmLndyaXRlKCJzdGF0aWMgdm9pZCBhbmFseXplXyVzKERpc2FzQ29udGV4
dCAqY3R4KVxuIiAldGFnKQorICAgIGYud3JpdGUoJ3tcbicpCisKKyAgICBmLndyaXRlKCIgICAg
SW5zbiAqaW5zbiBHX0dOVUNfVU5VU0VEID0gY3R4LT5pbnNuO1xuIikKKworICAgIGk9MAorICAg
ICMjIEFuYWx5emUgYWxsIHRoZSByZWdpc3RlcnMKKyAgICBmb3IgcmVndHlwZSwgcmVnaWQsIHRv
c3MsIG51bXJlZ3MgaW4gcmVnczoKKyAgICAgICAgYW5hbHl6ZV9vcG4oZiwgdGFnLCByZWd0eXBl
LCByZWdpZCwgdG9zcywgbnVtcmVncywgaSkKKyAgICAgICAgaSArPSAxCisKKworICAgIGYud3Jp
dGUoIn1cblxuIikKKworZGVmIG1haW4oKToKKyAgICBoZXhfY29tbW9uLnJlYWRfc2VtYW50aWNz
X2ZpbGUoc3lzLmFyZ3ZbMV0pCisgICAgaGV4X2NvbW1vbi5yZWFkX2F0dHJpYnNfZmlsZShzeXMu
YXJndlsyXSkKKyAgICBoZXhfY29tbW9uLnJlYWRfb3ZlcnJpZGVzX2ZpbGUoc3lzLmFyZ3ZbM10p
CisgICAgaGV4X2NvbW1vbi5yZWFkX292ZXJyaWRlc19maWxlKHN5cy5hcmd2WzRdKQorICAgICMj
IFdoZXRoZXIgb3Igbm90IGlkZWYtcGFyc2VyIGlzIGVuYWJsZWQgaXMKKyAgICAjIyBkZXRlcm1p
bmVkIGJ5IHRoZSBudW1iZXIgb2YgYXJndW1lbnRzIHRvCisgICAgIyMgdGhpcyBzY3JpcHQ6Cisg
ICAgIyMKKyAgICAjIyAgIDUgYXJncy4gLT4gbm90IGVuYWJsZWQsCisgICAgIyMgICA2IGFyZ3Mu
IC0+IGlkZWYtcGFyc2VyIGVuYWJsZWQuCisgICAgIyMKKyAgICAjIyBUaGUgNjp0aCBhcmcuIHRo
ZW4gaG9sZHMgYSBsaXN0IG9mIHRoZSBzdWNjZXNzZnVsbHkKKyAgICAjIyBwYXJzZWQgaW5zdHJ1
Y3Rpb25zLgorICAgIGlzX2lkZWZfcGFyc2VyX2VuYWJsZWQgPSBsZW4oc3lzLmFyZ3YpID4gNgor
ICAgIGlmIGlzX2lkZWZfcGFyc2VyX2VuYWJsZWQ6CisgICAgICAgIGhleF9jb21tb24ucmVhZF9p
ZGVmX3BhcnNlcl9lbmFibGVkX2ZpbGUoc3lzLmFyZ3ZbNV0pCisgICAgaGV4X2NvbW1vbi5jYWxj
dWxhdGVfYXR0cmlicygpCisgICAgdGFncmVncyA9IGhleF9jb21tb24uZ2V0X3RhZ3JlZ3MoKQor
ICAgIHRhZ2ltbXMgPSBoZXhfY29tbW9uLmdldF90YWdpbW1zKCkKKworICAgIHdpdGggb3Blbihz
eXMuYXJndlstMV0sICd3JykgYXMgZjoKKyAgICAgICAgZi53cml0ZSgiI2lmbmRlZiBIRVhBR09O
X1RDR19GVU5DU19IXG4iKQorICAgICAgICBmLndyaXRlKCIjZGVmaW5lIEhFWEFHT05fVENHX0ZV
TkNTX0hcblxuIikKKworICAgICAgICBmb3IgdGFnIGluIGhleF9jb21tb24udGFnczoKKyAgICAg
ICAgICAgIGdlbl9hbmFseXplX2Z1bmMoZiwgdGFnLCB0YWdyZWdzW3RhZ10sIHRhZ2ltbXNbdGFn
XSkKKworICAgICAgICBmLndyaXRlKCIjZW5kaWYgICAgLyogSEVYQUdPTl9UQ0dfRlVOQ1NfSCAq
L1xuIikKKworaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKKyAgICBtYWluKCkKZGlmZiAtLWdp
dCBhL3RhcmdldC9oZXhhZ29uL2dlbl90Y2dfZnVuY3MucHkgYi90YXJnZXQvaGV4YWdvbi9nZW5f
dGNnX2Z1bmNzLnB5CmluZGV4IDAyY2I1MmMyMWUuLjAyZmE2NWM1YzkgMTAwNzU1Ci0tLSBhL3Rh
cmdldC9oZXhhZ29uL2dlbl90Y2dfZnVuY3MucHkKKysrIGIvdGFyZ2V0L2hleGFnb24vZ2VuX3Rj
Z19mdW5jcy5weQpAQCAtMSw3ICsxLDcgQEAKICMhL3Vzci9iaW4vZW52IHB5dGhvbjMKIAogIyMK
LSMjICBDb3B5cmlnaHQoYykgMjAxOS0yMDIyIFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJ
bmMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCisjIyAgQ29weXJpZ2h0KGMpIDIwMTktMjAyMyBRdWFs
Y29tbSBJbm5vdmF0aW9uIENlbnRlciwgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogIyMKICMj
ICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQg
YW5kL29yIG1vZGlmeQogIyMgIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwg
UHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5CkBAIC0zNywxNSArMzcsNiBAQCBkZWYgZ2Vu
cHRyX2RlY2xfcGFpcl93cml0YWJsZShmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCByZWdubyk6CiAg
ICAgICAgICAgICAocmVnTiwgcmVnbm8pKQogICAgIGVsc2U6CiAgICAgICAgIGYud3JpdGUoIiAg
ICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4iICUgKHJlZ04sIHJlZ25vKSkKLSAg
ICBpZiAoJ0FfQ09OREVYRUMnIGluIGhleF9jb21tb24uYXR0cmliZGljdFt0YWddKToKLSAgICAg
ICAgZi53cml0ZSgiICAgIGlmICghaXNfcHJlbG9hZGVkKGN0eCwgJXMpKSB7XG4iICUgcmVnTikK
LSAgICAgICAgZi53cml0ZSgiICAgICAgICB0Y2dfZ2VuX21vdl90bChoZXhfbmV3X3ZhbHVlWyVz
XSwgaGV4X2dwclslc10pO1xuIiAlIFwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJl
Z04sIHJlZ04pKQotICAgICAgICBmLndyaXRlKCIgICAgfVxuIikKLSAgICAgICAgZi53cml0ZSgi
ICAgIGlmICghaXNfcHJlbG9hZGVkKGN0eCwgJXMgKyAxKSkge1xuIiAlIHJlZ04pCi0gICAgICAg
IGYud3JpdGUoIiAgICAgICAgdGNnX2dlbl9tb3ZfdGwoaGV4X25ld192YWx1ZVslcyArIDFdLCBo
ZXhfZ3ByWyVzICsgMV0pO1xuIiAlIFwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJl
Z04sIHJlZ04pKQotICAgICAgICBmLndyaXRlKCIgICAgfVxuIikKIAogZGVmIGdlbnB0cl9kZWNs
X3dyaXRhYmxlKGYsIHRhZywgcmVndHlwZSwgcmVnaWQsIHJlZ25vKToKICAgICByZWdOPSIlcyVz
TiIgJSAocmVndHlwZSxyZWdpZCkKQEAgLTU2LDExICs0Nyw2IEBAIGRlZiBnZW5wdHJfZGVjbF93
cml0YWJsZShmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCByZWdubyk6CiAgICAgICAgICAgICAocmVn
TiwgcmVnbm8pKQogICAgIGVsc2U6CiAgICAgICAgIGYud3JpdGUoIiAgICBjb25zdCBpbnQgJXMg
PSBpbnNuLT5yZWdub1slZF07XG4iICUgKHJlZ04sIHJlZ25vKSkKLSAgICBpZiAoJ0FfQ09OREVY
RUMnIGluIGhleF9jb21tb24uYXR0cmliZGljdFt0YWddKToKLSAgICAgICAgZi53cml0ZSgiICAg
IGlmICghaXNfcHJlbG9hZGVkKGN0eCwgJXMpKSB7XG4iICUgcmVnTikKLSAgICAgICAgZi53cml0
ZSgiICAgICAgICB0Y2dfZ2VuX21vdl90bChoZXhfbmV3X3ZhbHVlWyVzXSwgaGV4X2dwclslc10p
O1xuIiAlIFwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ04pKQotICAg
ICAgICBmLndyaXRlKCIgICAgfVxuIikKIAogZGVmIGdlbnB0cl9kZWNsKGYsIHRhZywgcmVndHlw
ZSwgcmVnaWQsIHJlZ25vKToKICAgICByZWdOPSIlcyVzTiIgJSAocmVndHlwZSxyZWdpZCkKQEAg
LTM5MSw4ICszNzcsNiBAQCBkZWYgZ2VucHRyX2RzdF93cml0ZV9wYWlyKGYsIHRhZywgcmVndHlw
ZSwgcmVnaWQpOgogICAgIGVsc2U6CiAgICAgICAgIGYud3JpdGUoIiAgICBnZW5fbG9nX3JlZ193
cml0ZV9wYWlyKCVzJXNOLCAlcyVzVik7XG4iICUgXAogICAgICAgICAgICAgKHJlZ3R5cGUsIHJl
Z2lkLCByZWd0eXBlLCByZWdpZCkpCi0gICAgZi53cml0ZSgiICAgIGN0eF9sb2dfcmVnX3dyaXRl
X3BhaXIoY3R4LCAlcyVzTik7XG4iICUgXAotICAgICAgICAocmVndHlwZSwgcmVnaWQpKQogCiBk
ZWYgZ2VucHRyX2RzdF93cml0ZShmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkKToKICAgICBpZiAocmVn
dHlwZSA9PSAiUiIpOgpAQCAtNDA2LDE2ICszOTAsMTIgQEAgZGVmIGdlbnB0cl9kc3Rfd3JpdGUo
ZiwgdGFnLCByZWd0eXBlLCByZWdpZCk6CiAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAg
ICAgIGYud3JpdGUoIiAgICBnZW5fbG9nX3JlZ193cml0ZSglcyVzTiwgJXMlc1YpO1xuIiAlIFwK
ICAgICAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWd0eXBlLCByZWdpZCkpCi0g
ICAgICAgICAgICBmLndyaXRlKCIgICAgY3R4X2xvZ19yZWdfd3JpdGUoY3R4LCAlcyVzTik7XG4i
ICUgXAotICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkpCiAgICAgICAgIGVsc2U6CiAg
ICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkK
ICAgICBlbGlmIChyZWd0eXBlID09ICJQIik6CiAgICAgICAgIGlmIChyZWdpZCBpbiB7ImQiLCAi
ZSIsICJ4In0pOgogICAgICAgICAgICAgZi53cml0ZSgiICAgIGdlbl9sb2dfcHJlZF93cml0ZShj
dHgsICVzJXNOLCAlcyVzVik7XG4iICUgXAogICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdp
ZCwgcmVndHlwZSwgcmVnaWQpKQotICAgICAgICAgICAgZi53cml0ZSgiICAgIGN0eF9sb2dfcHJl
ZF93cml0ZShjdHgsICVzJXNOKTtcbiIgJSBcCi0gICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJl
Z2lkKSkKICAgICAgICAgZWxzZToKICAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFy
c2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQogICAgIGVsaWYgKHJlZ3R5cGUgPT0gIkMiKToKQEAgLTUw
Nyw3ICs0ODcsNiBAQCBkZWYgZ2VucHRyX2RzdF93cml0ZV9vcG4oZixyZWd0eXBlLCByZWdpZCwg
dGFnKToKICMjICAgICAgICAgICBUQ0d2IFJ0ViA9IGhleF9ncHJbaW5zbi0+cmVnbm9bMl1dOwog
IyMgICAgICAgICAgIDxHRU4+CiAjIyAgICAgICAgICAgZ2VuX2xvZ19yZWdfd3JpdGUoUmROLCBS
ZFYpOwotIyMgICAgICAgICAgIGN0eF9sb2dfcmVnX3dyaXRlKGN0eCwgUmROKTsKICMjICAgICAg
IH0KICMjCiAjIyAgICAgICB3aGVyZSA8R0VOPiBkZXBlbmRzIG9uIGhleF9jb21tb24uc2tpcF9x
ZW11X2hlbHBlcih0YWcpCmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi9tZXNvbi5idWlsZCBi
L3RhcmdldC9oZXhhZ29uL21lc29uLmJ1aWxkCmluZGV4IGM5ZDMxZDA5NWMuLjQ4YzlmNTNjZmEg
MTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29uL21lc29uLmJ1aWxkCisrKyBiL3RhcmdldC9oZXhh
Z29uL21lc29uLmJ1aWxkCkBAIC0xLDUgKzEsNSBAQAogIyMKLSMjICBDb3B5cmlnaHQoYykgMjAy
MC0yMDIxIFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2
ZWQuCisjIyAgQ29weXJpZ2h0KGMpIDIwMjAtMjAyMyBRdWFsY29tbSBJbm5vdmF0aW9uIENlbnRl
ciwgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogIyMKICMjICBUaGlzIHByb2dyYW0gaXMgZnJl
ZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQogIyMgIGl0
IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVi
bGlzaGVkIGJ5CkBAIC0yNzYsNCArMjc2LDEzIEBAIHRjZ19mdW5jc19nZW5lcmF0ZWQgPSBjdXN0
b21fdGFyZ2V0KAogKQogaGV4YWdvbl9zcy5hZGQodGNnX2Z1bmNzX2dlbmVyYXRlZCkKIAorYW5h
bHl6ZV9mdW5jc19nZW5lcmF0ZWQgPSBjdXN0b21fdGFyZ2V0KAorICAgICdhbmFseXplX2Z1bmNz
X2dlbmVyYXRlZC5jLmluYycsCisgICAgb3V0cHV0OiAnYW5hbHl6ZV9mdW5jc19nZW5lcmF0ZWQu
Yy5pbmMnLAorICAgIGRlcGVuZHM6IGhlbHBlcl9kZXAsCisgICAgZGVwZW5kX2ZpbGVzOiBbaGV4
X2NvbW1vbl9weSwgYXR0cmlic19kZWYsIGdlbl90Y2dfaCwgZ2VuX3RjZ19odnhfaF0sCisgICAg
Y29tbWFuZDogW3B5dGhvbiwgZmlsZXMoJ2dlbl9hbmFseXplX2Z1bmNzLnB5JyksIGhlbHBlcl9p
biwgJ0BPVVRQVVRAJ10sCispCitoZXhhZ29uX3NzLmFkZChhbmFseXplX2Z1bmNzX2dlbmVyYXRl
ZCkKKwogdGFyZ2V0X2FyY2ggKz0geydoZXhhZ29uJzogaGV4YWdvbl9zc30KLS0gCjIuMjUuMQoK

