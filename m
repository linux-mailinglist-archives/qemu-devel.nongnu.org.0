Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id 59E3E6586F0
	for <lists+qemu-devel@lfdr.de>; Wed, 28 Dec 2022 22:14:30 +0100 (CET)
Received: from localhost ([::1] helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces@nongnu.org>)
	id 1pAdk6-0001VM-JZ; Wed, 28 Dec 2022 16:13:42 -0500
Received: from eggs.gnu.org ([2001:470:142:3::10])
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1pAdk2-0001Ut-8Q
 for qemu-devel@nongnu.org; Wed, 28 Dec 2022 16:13:38 -0500
Received: from mx0a-0031df01.pphosted.com ([205.220.168.131])
 by eggs.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1pAdjx-0001Ab-FH
 for qemu-devel@nongnu.org; Wed, 28 Dec 2022 16:13:37 -0500
Received: from pps.filterd (m0279862.ppops.net [127.0.0.1])
 by mx0a-0031df01.pphosted.com (8.17.1.19/8.17.1.19) with ESMTP id
 2BSKj1Qe001192; Wed, 28 Dec 2022 21:13:30 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=quicinc.com;
 h=from : to : cc :
 subject : date : message-id : in-reply-to : references : mime-version :
 content-type : content-transfer-encoding; s=qcppdkim1;
 bh=u7FfKDzyisHsJhXKiftsJCFiNfgZ3N9bBB38SNd+VOk=;
 b=BOGY07TbZ/6ia9DsKUSgclxQfEqn45d4C2U436b3jnaSS/480623lyHLzGzaKd5bk+ei
 ruSCJPxxTuvz9mtVNg/sDKTNrAr7B++YueJIxILOjtb7JBlb4F+CteObTZTOyQFTU1RG
 zZIUlL78MTHvnXq4GlWpi6Tbl0HHgfubuXulI9AxSyeOQeM9LtfNYqXjH1kddguqtOb8
 DLgy0OdNyOfICe4g2etwJp//jSCXHf4Co7YpRGte0w/rMg8iDkZoJA6uO6XIqqCAlLVL
 mqRP7iO7aEMXb7GBnOU8glhmjRcGTA/PslN1IC44yK5ObD99wHqV8vJm7XtudKy1iTHG fA== 
Received: from nalasppmta01.qualcomm.com (Global_NAT1.qualcomm.com
 [129.46.96.20])
 by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 3mr1r1jueh-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Wed, 28 Dec 2022 21:13:30 +0000
Received: from pps.filterd (NALASPPMTA01.qualcomm.com [127.0.0.1])
 by NALASPPMTA01.qualcomm.com (8.17.1.5/8.17.1.5) with ESMTP id 2BSLDTr9010155; 
 Wed, 28 Dec 2022 21:13:29 GMT
Received: from pps.reinject (localhost [127.0.0.1])
 by NALASPPMTA01.qualcomm.com (PPS) with ESMTP id 3mntgkr0nb-1;
 Wed, 28 Dec 2022 21:13:29 +0000
Received: from NALASPPMTA01.qualcomm.com (NALASPPMTA01.qualcomm.com
 [127.0.0.1])
 by pps.reinject (8.17.1.5/8.17.1.5) with ESMTP id 2BSLDTkU010139;
 Wed, 28 Dec 2022 21:13:29 GMT
Received: from hu-devc-lv-u18-c.qualcomm.com (hu-tsimpson-lv.qualcomm.com
 [10.47.235.220])
 by NALASPPMTA01.qualcomm.com (PPS) with ESMTP id 2BSLDSka010130;
 Wed, 28 Dec 2022 21:13:29 +0000
Received: by hu-devc-lv-u18-c.qualcomm.com (Postfix, from userid 47164)
 id 5E2835000B1; Wed, 28 Dec 2022 13:13:28 -0800 (PST)
From: Taylor Simpson <tsimpson@quicinc.com>
To: qemu-devel@nongnu.org
Cc: tsimpson@quicinc.com, richard.henderson@linaro.org, philmd@linaro.org,
 ale@rev.ng, anjo@rev.ng, bcain@quicinc.com, quic_mathbern@quicinc.com
Subject: [PATCH v2 5/6] Hexagon (target/hexagon) Analyze packet before
 generating TCG
Date: Wed, 28 Dec 2022 13:13:23 -0800
Message-Id: <20221228211324.26989-6-tsimpson@quicinc.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20221228211324.26989-1-tsimpson@quicinc.com>
References: <20221228211324.26989-1-tsimpson@quicinc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
X-QCInternal: smtphost
X-QCInternal: smtphost
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-GUID: x5gXKkWa9vGvpjyqESQlzdb7QxBYxGqT
X-Proofpoint-ORIG-GUID: x5gXKkWa9vGvpjyqESQlzdb7QxBYxGqT
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.205,Aquarius:18.0.923,Hydra:6.0.545,FMLib:17.11.122.1
 definitions=2022-12-28_15,2022-12-28_02,2022-06-22_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 mlxscore=0 bulkscore=0
 phishscore=0 mlxlogscore=835 lowpriorityscore=0 priorityscore=1501
 suspectscore=0 spamscore=0 impostorscore=0 adultscore=0 malwarescore=0
 clxscore=1015 classifier=spam adjust=0 reason=mlx scancount=1
 engine=8.12.0-2212070000 definitions=main-2212280182
Received-SPF: pass client-ip=205.220.168.131;
 envelope-from=tsimpson@qualcomm.com; helo=mx0a-0031df01.pphosted.com
X-Spam_score_int: -24
X-Spam_score: -2.5
X-Spam_bar: --
X-Spam_report: (-2.5 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, HEADER_FROM_DIFFERENT_DOMAINS=0.249,
 RCVD_IN_DNSWL_LOW=-0.7, SPF_HELO_NONE=0.001,
 SPF_PASS=-0.001 autolearn=ham autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org

V2UgY3JlYXRlIGEgbmV3IGdlbmVyYXRvciB0aGF0IGNyZWF0ZXMgYW4gYW5hbHl6ZV88dGFnPiBm
dW5jdGlvbiBmb3IKZWFjaCBpbnN0cnVjdGlvbi4gIEN1cnJlbnRseSwgdGhlc2UgZnVuY3Rpb25z
IHJlY29yZCB0aGUgd3JpdGVzIHRvClIsIFAsIGFuZCBDIHJlZ2lzdGVycyBieSBjYWxsaW5nIGN0
eF9sb2dfcmVnX3dyaXRlW19wYWlyXSBvcgpjdHhfbG9nX3ByZWRfd3JpdGUuCgpEdXJpbmcgZ2Vu
X3N0YXJ0X3BhY2tldCwgd2UgaW52b2tlIHRoZSBhbmFseXplXzx0YWc+IGZ1bmN0aW9uIGZvcgpl
YWNoIGluc3RydWN0aW9uIGluIHRoZSBwYWNrZXQsIGFuZCB3ZSBtYXJrIHRoZSBpbXBsaWNpdCBy
ZWdpc3RlcgphbmQgcHJlZGljYXRlIHdyaXRlcy4KCkRvaW5nIHRoZSBhbmFseXNpcyB1cCBmcm9u
dCBoYXMgc2V2ZXJhbCBhZHZhbnRhZ2VzCi0gV2UgcmVtb3ZlIGNhbGxzIHRvIGN0eF9sb2dfKiBm
cm9tIGdlbl90Y2dfZnVuY3MucHkgYW5kIGdlbnB0ci5jCi0gQWZ0ZXIgdGhlIGFuYWx5c2lzIGlz
IHBlcmZvcm1lZCwgd2UgY2FuIGluaXRpYWxpemUgaGV4X25ld192YWx1ZQogIGZvciBlYWNoIG9m
IHRoZSBwcmVkaWNhdGVkIGFzc2lnbm1lbnRzIHJhdGhlciB0aGFuIGR1cmluZyBUQ0cKICBnZW5l
cmF0aW9uIGZvciB0aGUgaW5zdHJ1Y3Rpb25zCi0gVGhpcyBpcyBhIHN0ZXBwaW5nIHN0b25lIGZv
ciBmdXR1cmUgd29yayB3aGVyZSB0aGUgYW5hbHlzaXMgd2lsbAogIGluY2x1ZGUgdGhlIHNldCBv
ZiByZWdpc3RlcnMgdGhhdCBhcmUgd3JpdHRlbi4gIEluIGNhc2VzIHdoZXJlCiAgdGhlIHBhY2tl
dCBkb2Vzbid0IGhhdmUgYW4gb3ZlcmxhcCBiZXR3ZWVuIHRoZSByZWdpc3RlcnMgdGhhdCBhcmUK
ICB3cml0dGVuIGFuZCByZWdpc3RlcnMgdGhhdCBhcmUgcmVhZCwgd2UgY2FuIGF2b2lkIHRoZSBp
bnRlcm1lZGlhdGUKICBzdGVwIG9mIHdyaXRpbmcgdG8gaGV4X25ld192YWx1ZS4gIE5vdGUgdGhh
dCBvdGhlciBjaGVja3Mgd2lsbCBhbHNvCiAgYmUgbmVlZGVkIChlLmcuLCBubyBpbnN0cnVjdGlv
bnMgY2FuIHJhaXNlIGFuIGV4Y2VwdGlvbikuCgpTaWduZWQtb2ZmLWJ5OiBUYXlsb3IgU2ltcHNv
biA8dHNpbXBzb25AcXVpY2luYy5jb20+Ci0tLQogdGFyZ2V0L2hleGFnb24vaW5zbi5oICAgICAg
ICAgICAgICAgICAgICAgICB8ICAgMyArCiB0YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuaCAgICAg
ICAgICAgICAgICAgIHwgIDQzICsrLS0KIHRhcmdldC9oZXhhZ29uL2dlbnB0ci5jICAgICAgICAg
ICAgICAgICAgICAgfCAgIDUgKy0KIHRhcmdldC9oZXhhZ29uL2lkZWYtcGFyc2VyL3BhcnNlci1o
ZWxwZXJzLmMgfCAgIDUgLQogdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmMgICAgICAgICAgICAg
ICAgICB8IDE0NSArKysrKysrLS0tLS0KIHRhcmdldC9oZXhhZ29uL1JFQURNRSAgICAgICAgICAg
ICAgICAgICAgICAgfCAgMTEgKy0KIHRhcmdldC9oZXhhZ29uL2dlbl9hbmFseXplX2Z1bmNfdGFi
bGUucHkgICAgfCAgNTIgKysrKysKIHRhcmdldC9oZXhhZ29uL2dlbl9hbmFseXplX2Z1bmNzLnB5
ICAgICAgICAgfCAyMzkgKysrKysrKysrKysrKysrKysrKysKIHRhcmdldC9oZXhhZ29uL2dlbl90
Y2dfZnVuY3MucHkgICAgICAgICAgICAgfCAgMjEgLS0KIHRhcmdldC9oZXhhZ29uL21lc29uLmJ1
aWxkICAgICAgICAgICAgICAgICAgfCAgMTggKysKIDEwIGZpbGVzIGNoYW5nZWQsIDQyOCBpbnNl
cnRpb25zKCspLCAxMTQgZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9kZSAxMDA3NTUgdGFyZ2V0L2hl
eGFnb24vZ2VuX2FuYWx5emVfZnVuY190YWJsZS5weQogY3JlYXRlIG1vZGUgMTAwNzU1IHRhcmdl
dC9oZXhhZ29uL2dlbl9hbmFseXplX2Z1bmNzLnB5CgpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFn
b24vaW5zbi5oIGIvdGFyZ2V0L2hleGFnb24vaW5zbi5oCmluZGV4IDNlN2EyMmM5MWUuLjFkZWRi
NmM0ODYgMTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29uL2luc24uaAorKysgYi90YXJnZXQvaGV4
YWdvbi9pbnNuLmgKQEAgLTI5LDYgKzI5LDcgQEAgc3RydWN0IFBhY2tldDsKIHN0cnVjdCBEaXNh
c0NvbnRleHQ7CiAKIHR5cGVkZWYgdm9pZCAoKlNlbWFudGljSW5zbikoc3RydWN0IERpc2FzQ29u
dGV4dCAqY3R4KTsKK3R5cGVkZWYgdm9pZCAoKkFuYWx5emVJbnNuKShzdHJ1Y3QgRGlzYXNDb250
ZXh0ICpjdHgpOwogCiBzdHJ1Y3QgSW5zdHJ1Y3Rpb24gewogICAgIFNlbWFudGljSW5zbiBnZW5l
cmF0ZTsgICAgICAgICAgICAvKiBwb2ludGVyIHRvIGdlbnB0ciByb3V0aW5lICovCkBAIC03NCw0
ICs3NSw2IEBAIHN0cnVjdCBQYWNrZXQgewogCiB0eXBlZGVmIHN0cnVjdCBQYWNrZXQgUGFja2V0
OwogCitleHRlcm4gY29uc3QgQW5hbHl6ZUluc24gb3Bjb2RlX2FuYWx5emVbXTsKKwogI2VuZGlm
CmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuaCBiL3RhcmdldC9oZXhhZ29u
L3RyYW5zbGF0ZS5oCmluZGV4IGQ5NzFmNGYwOTUuLjRjZGFmOWFjNzAgMTAwNjQ0Ci0tLSBhL3Rh
cmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5oCisrKyBiL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5o
CkBAIC0zOCw2ICszOCw3IEBAIHR5cGVkZWYgc3RydWN0IERpc2FzQ29udGV4dCB7CiAgICAgaW50
IHJlZ19sb2dbUkVHX1dSSVRFU19NQVhdOwogICAgIGludCByZWdfbG9nX2lkeDsKICAgICBERUNM
QVJFX0JJVE1BUChyZWdzX3dyaXR0ZW4sIFRPVEFMX1BFUl9USFJFQURfUkVHUyk7CisgICAgREVD
TEFSRV9CSVRNQVAocHJlZGljYXRlZF9yZWdzLCBUT1RBTF9QRVJfVEhSRUFEX1JFR1MpOwogICAg
IGludCBwcmVnX2xvZ1tQUkVEX1dSSVRFU19NQVhdOwogICAgIGludCBwcmVnX2xvZ19pZHg7CiAg
ICAgREVDTEFSRV9CSVRNQVAocHJlZ3Nfd3JpdHRlbiwgTlVNX1BSRUdTKTsKQEAgLTYyLDMyICs2
MywzNiBAQCB0eXBlZGVmIHN0cnVjdCBEaXNhc0NvbnRleHQgewogICAgIGJvb2wgaXNfdGlnaHRf
bG9vcDsKIH0gRGlzYXNDb250ZXh0OwogCi1zdGF0aWMgaW5saW5lIHZvaWQgY3R4X2xvZ19yZWdf
d3JpdGUoRGlzYXNDb250ZXh0ICpjdHgsIGludCBybnVtKQotewotICAgIGlmICh0ZXN0X2JpdChy
bnVtLCBjdHgtPnJlZ3Nfd3JpdHRlbikpIHsKLSAgICAgICAgSEVYX0RFQlVHX0xPRygiV0FSTklO
RzogTXVsdGlwbGUgd3JpdGVzIHRvIHIlZFxuIiwgcm51bSk7Ci0gICAgfQotICAgIGN0eC0+cmVn
X2xvZ1tjdHgtPnJlZ19sb2dfaWR4XSA9IHJudW07Ci0gICAgY3R4LT5yZWdfbG9nX2lkeCsrOwot
ICAgIHNldF9iaXQocm51bSwgY3R4LT5yZWdzX3dyaXR0ZW4pOwotfQotCi1zdGF0aWMgaW5saW5l
IHZvaWQgY3R4X2xvZ19yZWdfd3JpdGVfcGFpcihEaXNhc0NvbnRleHQgKmN0eCwgaW50IHJudW0p
Ci17Ci0gICAgY3R4X2xvZ19yZWdfd3JpdGUoY3R4LCBybnVtKTsKLSAgICBjdHhfbG9nX3JlZ193
cml0ZShjdHgsIHJudW0gKyAxKTsKLX0KLQogc3RhdGljIGlubGluZSB2b2lkIGN0eF9sb2dfcHJl
ZF93cml0ZShEaXNhc0NvbnRleHQgKmN0eCwgaW50IHBudW0pCiB7CiAgICAgY3R4LT5wcmVnX2xv
Z1tjdHgtPnByZWdfbG9nX2lkeF0gPSBwbnVtOwogICAgIGN0eC0+cHJlZ19sb2dfaWR4Kys7Ci0g
ICAgc2V0X2JpdChwbnVtLCBjdHgtPnByZWdzX3dyaXR0ZW4pOwogfQogCi1zdGF0aWMgaW5saW5l
IGJvb2wgaXNfcHJlbG9hZGVkKERpc2FzQ29udGV4dCAqY3R4LCBpbnQgbnVtKQorc3RhdGljIGlu
bGluZSB2b2lkIGN0eF9sb2dfcmVnX3dyaXRlKERpc2FzQ29udGV4dCAqY3R4LCBpbnQgcm51bSwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sIGlzX3ByZWRpY2F0ZWQp
Cit7CisgICAgaWYgKHJudW0gPT0gSEVYX1JFR19QM18wKSB7CisgICAgICAgIGZvciAoaW50IGkg
PSAwOyBpIDwgTlVNX1BSRUdTOyBpKyspIHsKKyAgICAgICAgICAgIGN0eF9sb2dfcHJlZF93cml0
ZShjdHgsIGkpOworICAgICAgICB9CisgICAgfSBlbHNlIHsKKyAgICAgICAgaWYgKCF0ZXN0X2Jp
dChybnVtLCBjdHgtPnJlZ3Nfd3JpdHRlbikpIHsKKyAgICAgICAgICAgIGN0eC0+cmVnX2xvZ1tj
dHgtPnJlZ19sb2dfaWR4XSA9IHJudW07CisgICAgICAgICAgICBjdHgtPnJlZ19sb2dfaWR4Kys7
CisgICAgICAgICAgICBzZXRfYml0KHJudW0sIGN0eC0+cmVnc193cml0dGVuKTsKKyAgICAgICAg
fQorICAgICAgICBpZiAoaXNfcHJlZGljYXRlZCkgeworICAgICAgICAgICAgc2V0X2JpdChybnVt
LCBjdHgtPnByZWRpY2F0ZWRfcmVncyk7CisgICAgICAgIH0KKyAgICB9Cit9CisKK3N0YXRpYyBp
bmxpbmUgdm9pZCBjdHhfbG9nX3JlZ193cml0ZV9wYWlyKERpc2FzQ29udGV4dCAqY3R4LCBpbnQg
cm51bSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgaXNf
cHJlZGljYXRlZCkKIHsKLSAgICByZXR1cm4gdGVzdF9iaXQobnVtLCBjdHgtPnJlZ3Nfd3JpdHRl
bik7CisgICAgY3R4X2xvZ19yZWdfd3JpdGUoY3R4LCBybnVtLCBpc19wcmVkaWNhdGVkKTsKKyAg
ICBjdHhfbG9nX3JlZ193cml0ZShjdHgsIHJudW0gKyAxLCBpc19wcmVkaWNhdGVkKTsKIH0KIAog
c3RhdGljIGlubGluZSBib29sIGlzX3ZyZWdfcHJlbG9hZGVkKERpc2FzQ29udGV4dCAqY3R4LCBp
bnQgbnVtKQpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vZ2VucHRyLmMgYi90YXJnZXQvaGV4
YWdvbi9nZW5wdHIuYwppbmRleCAxNTQ0ZDE4MWYxLi5iNzA0MDJjODE5IDEwMDY0NAotLS0gYS90
YXJnZXQvaGV4YWdvbi9nZW5wdHIuYworKysgYi90YXJnZXQvaGV4YWdvbi9nZW5wdHIuYwpAQCAt
MTQ5LDYgKzE0OSw3IEBAIHZvaWQgZ2VuX2xvZ19wcmVkX3dyaXRlKERpc2FzQ29udGV4dCAqY3R4
LCBpbnQgcG51bSwgVENHdiB2YWwpCiAgICAgICAgICAgICAgICAgICAgICAgIGhleF9uZXdfcHJl
ZF92YWx1ZVtwbnVtXSwgYmFzZV92YWwpOwogICAgIH0KICAgICB0Y2dfZ2VuX29yaV90bChoZXhf
cHJlZF93cml0dGVuLCBoZXhfcHJlZF93cml0dGVuLCAxIDw8IHBudW0pOworICAgIHNldF9iaXQo
cG51bSwgY3R4LT5wcmVnc193cml0dGVuKTsKIAogICAgIHRjZ190ZW1wX2ZyZWUoYmFzZV92YWwp
OwogfQpAQCAtMjMxLDcgKzIzMiw2IEBAIHN0YXRpYyB2b2lkIGdlbl93cml0ZV9wM18wKERpc2Fz
Q29udGV4dCAqY3R4LCBUQ0d2IGNvbnRyb2xfcmVnKQogICAgIGZvciAoaW50IGkgPSAwOyBpIDwg
TlVNX1BSRUdTOyBpKyspIHsKICAgICAgICAgdGNnX2dlbl9leHRyYWN0X3RsKGhleF9wOCwgY29u
dHJvbF9yZWcsIGkgKiA4LCA4KTsKICAgICAgICAgZ2VuX2xvZ19wcmVkX3dyaXRlKGN0eCwgaSwg
aGV4X3A4KTsKLSAgICAgICAgY3R4X2xvZ19wcmVkX3dyaXRlKGN0eCwgaSk7CiAgICAgfQogICAg
IHRjZ190ZW1wX2ZyZWUoaGV4X3A4KTsKIH0KQEAgLTI1MCw3ICsyNTAsNiBAQCBzdGF0aWMgaW5s
aW5lIHZvaWQgZ2VuX3dyaXRlX2N0cmxfcmVnKERpc2FzQ29udGV4dCAqY3R4LCBpbnQgcmVnX251
bSwKICAgICAgICAgZ2VuX3dyaXRlX3AzXzAoY3R4LCB2YWwpOwogICAgIH0gZWxzZSB7CiAgICAg
ICAgIGdlbl9sb2dfcmVnX3dyaXRlKHJlZ19udW0sIHZhbCk7Ci0gICAgICAgIGN0eF9sb2dfcmVn
X3dyaXRlKGN0eCwgcmVnX251bSk7CiAgICAgICAgIGlmIChyZWdfbnVtID09IEhFWF9SRUdfUUVN
VV9QS1RfQ05UKSB7CiAgICAgICAgICAgICBjdHgtPm51bV9wYWNrZXRzID0gMDsKICAgICAgICAg
fQpAQCAtMjczLDEwICsyNzIsOCBAQCBzdGF0aWMgaW5saW5lIHZvaWQgZ2VuX3dyaXRlX2N0cmxf
cmVnX3BhaXIoRGlzYXNDb250ZXh0ICpjdHgsIGludCByZWdfbnVtLAogICAgICAgICB0Y2dfZ2Vu
X2V4dHJoX2k2NF9pMzIodmFsMzIsIHZhbCk7CiAgICAgICAgIGdlbl9sb2dfcmVnX3dyaXRlKHJl
Z19udW0gKyAxLCB2YWwzMik7CiAgICAgICAgIHRjZ190ZW1wX2ZyZWUodmFsMzIpOwotICAgICAg
ICBjdHhfbG9nX3JlZ193cml0ZShjdHgsIHJlZ19udW0gKyAxKTsKICAgICB9IGVsc2UgewogICAg
ICAgICBnZW5fbG9nX3JlZ193cml0ZV9wYWlyKHJlZ19udW0sIHZhbCk7Ci0gICAgICAgIGN0eF9s
b2dfcmVnX3dyaXRlX3BhaXIoY3R4LCByZWdfbnVtKTsKICAgICAgICAgaWYgKHJlZ19udW0gPT0g
SEVYX1JFR19RRU1VX1BLVF9DTlQpIHsKICAgICAgICAgICAgIGN0eC0+bnVtX3BhY2tldHMgPSAw
OwogICAgICAgICAgICAgY3R4LT5udW1faW5zbnMgPSAwOwpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hl
eGFnb24vaWRlZi1wYXJzZXIvcGFyc2VyLWhlbHBlcnMuYyBiL3RhcmdldC9oZXhhZ29uL2lkZWYt
cGFyc2VyL3BhcnNlci1oZWxwZXJzLmMKaW5kZXggODExMDY4NmM1MS4uNWIyOGYzNzJhZiAxMDA2
NDQKLS0tIGEvdGFyZ2V0L2hleGFnb24vaWRlZi1wYXJzZXIvcGFyc2VyLWhlbHBlcnMuYworKysg
Yi90YXJnZXQvaGV4YWdvbi9pZGVmLXBhcnNlci9wYXJzZXItaGVscGVycy5jCkBAIC0xNDM4LDEw
ICsxNDM4LDYgQEAgdm9pZCBnZW5fd3JpdGVfcmVnKENvbnRleHQgKmMsIFlZTFRZUEUgKmxvY3As
IEhleFZhbHVlICpyZWcsIEhleFZhbHVlICp2YWx1ZSkKICAgICAgICAgbG9jcCwKICAgICAgICAg
Imdlbl9sb2dfcmVnX3dyaXRlKCIsICZyZWctPnJlZy5pZCwgIiwgIiwKICAgICAgICAgJnZhbHVl
X20sICIpO1xuIik7Ci0gICAgT1VUKGMsCi0gICAgICAgIGxvY3AsCi0gICAgICAgICJjdHhfbG9n
X3JlZ193cml0ZShjdHgsICIsICZyZWctPnJlZy5pZCwKLSAgICAgICAgIik7XG4iKTsKICAgICBn
ZW5fcnZhbHVlX2ZyZWUoYywgbG9jcCwgcmVnKTsKICAgICBnZW5fcnZhbHVlX2ZyZWUoYywgbG9j
cCwgJnZhbHVlX20pOwogfQpAQCAtMTg5NCw3ICsxODkwLDYgQEAgdm9pZCBnZW5fcHJlZF9hc3Np
Z24oQ29udGV4dCAqYywgWVlMVFlQRSAqbG9jcCwgSGV4VmFsdWUgKmxlZnRfcHJlZCwKICAgICBp
ZiAoaXNfZGlyZWN0KSB7CiAgICAgICAgIE9VVChjLCBsb2NwLCAiZ2VuX2xvZ19wcmVkX3dyaXRl
KGN0eCwgIiwgcHJlZF9pZCwgIiwgIiwgbGVmdF9wcmVkLAogICAgICAgICAgICAgIik7XG4iKTsK
LSAgICAgICAgT1VUKGMsIGxvY3AsICJjdHhfbG9nX3ByZWRfd3JpdGUoY3R4LCAiLCBwcmVkX2lk
LCAiKTtcbiIpOwogICAgICAgICBnZW5fcnZhbHVlX2ZyZWUoYywgbG9jcCwgbGVmdF9wcmVkKTsK
ICAgICB9CiAgICAgLyogRnJlZSB0ZW1wb3JhcnkgdmFsdWUgKi8KZGlmZiAtLWdpdCBhL3Rhcmdl
dC9oZXhhZ29uL3RyYW5zbGF0ZS5jIGIvdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmMKaW5kZXgg
NzVmMjhlMDhhZC4uNDc3MTExYmRhMiAxMDA2NDQKLS0tIGEvdGFyZ2V0L2hleGFnb24vdHJhbnNs
YXRlLmMKKysrIGIvdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmMKQEAgLTI4LDYgKzI4LDggQEAK
ICNpbmNsdWRlICJkZWNvZGUuaCIKICNpbmNsdWRlICJ0cmFuc2xhdGUuaCIKICNpbmNsdWRlICJw
cmludGluc24uaCIKKyNpbmNsdWRlICJhbmFseXplX2Z1bmNzX2dlbmVyYXRlZC5jLmluYyIKKyNp
bmNsdWRlICJhbmFseXplX2Z1bmNfdGFibGVfZ2VuZXJhdGVkLmMuaW5jIgogCiBUQ0d2IGhleF9n
cHJbVE9UQUxfUEVSX1RIUkVBRF9SRUdTXTsKIFRDR3YgaGV4X3ByZWRbTlVNX1BSRUdTXTsKQEAg
LTI2NSw2ICsyNjcsNzYgQEAgc3RhdGljIGJvb2wgbmVlZF9uZXh0X1BDKERpc2FzQ29udGV4dCAq
Y3R4KQogICAgIHJldHVybiBmYWxzZTsKIH0KIAorLyoKKyAqIFRoZSBpbnNuLT5hbmFseXplIGZ1
bmN0aW9ucyBtYXJrIG1vc3Qgb2YgdGhlIHdyaXRlcyBpbiBhIHBhY2tldAorICogSG93ZXZlciwg
dGhlcmUgYXJlIHNvbWUgaW1wbGljaXQgd3JpdGVzIG1hcmtlZCBhcyBhdHRyaWJ1dGVzCisgKiBv
ZiB0aGUgYXBwbGljYWJsZSBpbnN0cnVjdGlvbnMuCisgKi8KK3N0YXRpYyB2b2lkIG1hcmtfaW1w
bGljaXRfcmVnX3dyaXRlKERpc2FzQ29udGV4dCAqY3R4LCBpbnQgYXR0cmliLCBpbnQgcm51bSkK
K3sKKyAgICB1aW50MTZfdCBvcGNvZGUgPSBjdHgtPmluc24tPm9wY29kZTsKKyAgICBpZiAoR0VU
X0FUVFJJQihvcGNvZGUsIGF0dHJpYikpIHsKKyAgICAgICAgLyoKKyAgICAgICAgICogVVNSIGlz
IHVzZWQgdG8gc2V0IG92ZXJmbG93IGFuZCBGUCBleGNlcHRpb25zLAorICAgICAgICAgKiBzbyB0
cmVhdCBpdCBhcyBjb25kaXRpb25hbAorICAgICAgICAgKi8KKyAgICAgICAgYm9vbCBpc19wcmVk
aWNhdGVkID0gR0VUX0FUVFJJQihvcGNvZGUsIEFfQ09OREVYRUMpIHx8CisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHJudW0gPT0gSEVYX1JFR19VU1I7CisKKyAgICAgICAgLyogTEMwL0xD
MSBpcyBjb25kaXRpb25hbGx5IHdyaXR0ZW4gYnkgZW5kbG9vcCBpbnN0cnVjdGlvbnMgKi8KKyAg
ICAgICAgaWYgKChybnVtID09IEhFWF9SRUdfTEMwIHx8IHJudW0gPT0gSEVYX1JFR19MQzEpICYm
CisgICAgICAgICAgICAob3Bjb2RlID09IEoyX2VuZGxvb3AwIHx8CisgICAgICAgICAgICAgb3Bj
b2RlID09IEoyX2VuZGxvb3AxIHx8CisgICAgICAgICAgICAgb3Bjb2RlID09IEoyX2VuZGxvb3Aw
MSkpIHsKKyAgICAgICAgICAgIGlzX3ByZWRpY2F0ZWQgPSB0cnVlOworICAgICAgICB9CisKKyAg
ICAgICAgY3R4X2xvZ19yZWdfd3JpdGUoY3R4LCBybnVtLCBpc19wcmVkaWNhdGVkKTsKKyAgICB9
Cit9CisKK3N0YXRpYyB2b2lkIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlcyhEaXNhc0NvbnRleHQg
KmN0eCkKK3sKKyAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJ
VEVTX0ZQLCAgSEVYX1JFR19GUCk7CisgICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBB
X0lNUExJQ0lUX1dSSVRFU19TUCwgIEhFWF9SRUdfU1ApOworICAgIG1hcmtfaW1wbGljaXRfcmVn
X3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfTFIsICBIRVhfUkVHX0xSKTsKKyAgICBtYXJr
X2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX0xDMCwgSEVYX1JFR19M
QzApOworICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNf
U0EwLCBIRVhfUkVHX1NBMCk7CisgICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0lN
UExJQ0lUX1dSSVRFU19MQzEsIEhFWF9SRUdfTEMxKTsKKyAgICBtYXJrX2ltcGxpY2l0X3JlZ193
cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX1NBMSwgSEVYX1JFR19TQTEpOworICAgIG1hcmtf
aW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfVVNSLCBIRVhfUkVHX1VT
Uik7CisgICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0ZQT1AsIEhFWF9SRUdfVVNS
KTsKK30KKworc3RhdGljIHZvaWQgbWFya19pbXBsaWNpdF9wcmVkX3dyaXRlKERpc2FzQ29udGV4
dCAqY3R4LCBpbnQgYXR0cmliLCBpbnQgcG51bSkKK3sKKyAgICBpZiAoR0VUX0FUVFJJQihjdHgt
Pmluc24tPm9wY29kZSwgYXR0cmliKSkgeworICAgICAgICBjdHhfbG9nX3ByZWRfd3JpdGUoY3R4
LCBwbnVtKTsKKyAgICB9Cit9CisKK3N0YXRpYyB2b2lkIG1hcmtfaW1wbGljaXRfcHJlZF93cml0
ZXMoRGlzYXNDb250ZXh0ICpjdHgpCit7CisgICAgbWFya19pbXBsaWNpdF9wcmVkX3dyaXRlKGN0
eCwgQV9JTVBMSUNJVF9XUklURVNfUDAsIDApOworICAgIG1hcmtfaW1wbGljaXRfcHJlZF93cml0
ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX1AxLCAxKTsKKyAgICBtYXJrX2ltcGxpY2l0X3ByZWRf
d3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19QMiwgMik7CisgICAgbWFya19pbXBsaWNpdF9w
cmVkX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfUDMsIDMpOworfQorCitzdGF0aWMgdm9p
ZCBhbmFseXplX3BhY2tldChEaXNhc0NvbnRleHQgKmN0eCkKK3sKKyAgICBQYWNrZXQgKnBrdCA9
IGN0eC0+cGt0OworICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcGt0LT5udW1faW5zbnM7IGkrKykg
eworICAgICAgICBJbnNuICppbnNuID0gJnBrdC0+aW5zbltpXTsKKyAgICAgICAgY3R4LT5pbnNu
ID0gaW5zbjsKKyAgICAgICAgaWYgKG9wY29kZV9hbmFseXplW2luc24tPm9wY29kZV0pIHsKKyAg
ICAgICAgICAgIG9wY29kZV9hbmFseXplW2luc24tPm9wY29kZV0oY3R4KTsKKyAgICAgICAgfQor
ICAgICAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZXMoY3R4KTsKKyAgICAgICAgbWFya19pbXBs
aWNpdF9wcmVkX3dyaXRlcyhjdHgpOworICAgIH0KK30KKwogc3RhdGljIHZvaWQgZ2VuX3N0YXJ0
X3BhY2tldChEaXNhc0NvbnRleHQgKmN0eCkKIHsKICAgICBQYWNrZXQgKnBrdCA9IGN0eC0+cGt0
OwpAQCAtMjc1LDYgKzM0Nyw3IEBAIHN0YXRpYyB2b2lkIGdlbl9zdGFydF9wYWNrZXQoRGlzYXND
b250ZXh0ICpjdHgpCiAgICAgY3R4LT5uZXh0X1BDID0gbmV4dF9QQzsKICAgICBjdHgtPnJlZ19s
b2dfaWR4ID0gMDsKICAgICBiaXRtYXBfemVybyhjdHgtPnJlZ3Nfd3JpdHRlbiwgVE9UQUxfUEVS
X1RIUkVBRF9SRUdTKTsKKyAgICBiaXRtYXBfemVybyhjdHgtPnByZWRpY2F0ZWRfcmVncywgVE9U
QUxfUEVSX1RIUkVBRF9SRUdTKTsKICAgICBjdHgtPnByZWdfbG9nX2lkeCA9IDA7CiAgICAgYml0
bWFwX3plcm8oY3R4LT5wcmVnc193cml0dGVuLCBOVU1fUFJFR1MpOwogICAgIGN0eC0+ZnV0dXJl
X3ZyZWdzX2lkeCA9IDA7CkBAIC0yOTEsNiArMzY0LDggQEAgc3RhdGljIHZvaWQgZ2VuX3N0YXJ0
X3BhY2tldChEaXNhc0NvbnRleHQgKmN0eCkKICAgICBjdHgtPnMxX3N0b3JlX3Byb2Nlc3NlZCA9
IGZhbHNlOwogICAgIGN0eC0+cHJlX2NvbW1pdCA9IHRydWU7CiAKKyAgICBhbmFseXplX3BhY2tl
dChjdHgpOworCiAgICAgaWYgKEhFWF9ERUJVRykgewogICAgICAgICAvKiBIYW5keSBwbGFjZSB0
byBzZXQgYSBicmVha3BvaW50IGJlZm9yZSB0aGUgcGFja2V0IGV4ZWN1dGVzICovCiAgICAgICAg
IGdlbl9oZWxwZXJfZGVidWdfc3RhcnRfcGFja2V0KGNwdV9lbnYpOwpAQCAtMzEyLDYgKzM4Nywx
NCBAQCBzdGF0aWMgdm9pZCBnZW5fc3RhcnRfcGFja2V0KERpc2FzQ29udGV4dCAqY3R4KQogICAg
IGlmIChuZWVkX3ByZWRfd3JpdHRlbihwa3QpKSB7CiAgICAgICAgIHRjZ19nZW5fbW92aV90bCho
ZXhfcHJlZF93cml0dGVuLCAwKTsKICAgICB9CisgICAgaWYgKCFiaXRtYXBfZW1wdHkoY3R4LT5w
cmVkaWNhdGVkX3JlZ3MsIFRPVEFMX1BFUl9USFJFQURfUkVHUykpIHsKKyAgICAgICAgaW50IGkg
PSBmaW5kX2ZpcnN0X2JpdChjdHgtPnByZWRpY2F0ZWRfcmVncywgVE9UQUxfUEVSX1RIUkVBRF9S
RUdTKTsKKyAgICAgICAgd2hpbGUgKGkgPCBUT1RBTF9QRVJfVEhSRUFEX1JFR1MpIHsKKyAgICAg
ICAgICAgIHRjZ19nZW5fbW92X3RsKGhleF9uZXdfdmFsdWVbaV0sIGhleF9ncHJbaV0pOworICAg
ICAgICAgICAgaSA9IGZpbmRfbmV4dF9iaXQoY3R4LT5wcmVkaWNhdGVkX3JlZ3MsIFRPVEFMX1BF
Ul9USFJFQURfUkVHUywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgKyAxKTsKKyAg
ICAgICAgfQorICAgIH0KIAogICAgIGlmIChwa3QtPnBrdF9oYXNfaHZ4KSB7CiAgICAgICAgIHRj
Z19nZW5fbW92aV90bChoZXhfVlJlZ3NfdXBkYXRlZCwgMCk7CkBAIC0zMzYsNjYgKzQxOSw2IEBA
IGJvb2wgaXNfZ2F0aGVyX3N0b3JlX2luc24oRGlzYXNDb250ZXh0ICpjdHgpCiAgICAgcmV0dXJu
IGZhbHNlOwogfQogCi0vKgotICogVGhlIExPR18qX1dSSVRFIG1hY3JvcyBtYXJrIG1vc3Qgb2Yg
dGhlIHdyaXRlcyBpbiBhIHBhY2tldAotICogSG93ZXZlciwgdGhlcmUgYXJlIHNvbWUgaW1wbGlj
aXQgd3JpdGVzIG1hcmtlZCBhcyBhdHRyaWJ1dGVzCi0gKiBvZiB0aGUgYXBwbGljYWJsZSBpbnN0
cnVjdGlvbnMuCi0gKi8KLXN0YXRpYyB2b2lkIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKERpc2Fz
Q29udGV4dCAqY3R4LCBpbnQgYXR0cmliLCBpbnQgcm51bSkKLXsKLSAgICB1aW50MTZfdCBvcGNv
ZGUgPSBjdHgtPmluc24tPm9wY29kZTsKLSAgICBpZiAoR0VUX0FUVFJJQihvcGNvZGUsIGF0dHJp
YikpIHsKLSAgICAgICAgLyoKLSAgICAgICAgICogVVNSIGlzIHVzZWQgdG8gc2V0IG92ZXJmbG93
IGFuZCBGUCBleGNlcHRpb25zLAotICAgICAgICAgKiBzbyB0cmVhdCBpdCBhcyBjb25kaXRpb25h
bAotICAgICAgICAgKi8KLSAgICAgICAgYm9vbCBpc19wcmVkaWNhdGVkID0gR0VUX0FUVFJJQihv
cGNvZGUsIEFfQ09OREVYRUMpIHx8Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJudW0g
PT0gSEVYX1JFR19VU1I7Ci0KLSAgICAgICAgLyogTEMwL0xDMSBpcyBjb25kaXRpb25hbGx5IHdy
aXR0ZW4gYnkgZW5kbG9vcCBpbnN0cnVjdGlvbnMgKi8KLSAgICAgICAgaWYgKChybnVtID09IEhF
WF9SRUdfTEMwIHx8IHJudW0gPT0gSEVYX1JFR19MQzEpICYmCi0gICAgICAgICAgICAob3Bjb2Rl
ID09IEoyX2VuZGxvb3AwIHx8Ci0gICAgICAgICAgICAgb3Bjb2RlID09IEoyX2VuZGxvb3AxIHx8
Ci0gICAgICAgICAgICAgb3Bjb2RlID09IEoyX2VuZGxvb3AwMSkpIHsKLSAgICAgICAgICAgIGlz
X3ByZWRpY2F0ZWQgPSB0cnVlOwotICAgICAgICB9Ci0KLSAgICAgICAgaWYgKGlzX3ByZWRpY2F0
ZWQgJiYgIWlzX3ByZWxvYWRlZChjdHgsIHJudW0pKSB7Ci0gICAgICAgICAgICB0Y2dfZ2VuX21v
dl90bChoZXhfbmV3X3ZhbHVlW3JudW1dLCBoZXhfZ3ByW3JudW1dKTsKLSAgICAgICAgfQotCi0g
ICAgICAgIGN0eF9sb2dfcmVnX3dyaXRlKGN0eCwgcm51bSk7Ci0gICAgfQotfQotCi1zdGF0aWMg
dm9pZCBtYXJrX2ltcGxpY2l0X3ByZWRfd3JpdGUoRGlzYXNDb250ZXh0ICpjdHgsIGludCBhdHRy
aWIsIGludCBwbnVtKQotewotICAgIGlmIChHRVRfQVRUUklCKGN0eC0+aW5zbi0+b3Bjb2RlLCBh
dHRyaWIpKSB7Ci0gICAgICAgIGN0eF9sb2dfcHJlZF93cml0ZShjdHgsIHBudW0pOwotICAgIH0K
LX0KLQotc3RhdGljIHZvaWQgbWFya19pbXBsaWNpdF9yZWdfd3JpdGVzKERpc2FzQ29udGV4dCAq
Y3R4KQotewotICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklU
RVNfRlAsICBIRVhfUkVHX0ZQKTsKLSAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFf
SU1QTElDSVRfV1JJVEVTX1NQLCAgSEVYX1JFR19TUCk7Ci0gICAgbWFya19pbXBsaWNpdF9yZWdf
d3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19MUiwgIEhFWF9SRUdfTFIpOwotICAgIG1hcmtf
aW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfTEMwLCBIRVhfUkVHX0xD
MCk7Ci0gICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19T
QTAsIEhFWF9SRUdfU0EwKTsKLSAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1Q
TElDSVRfV1JJVEVTX0xDMSwgSEVYX1JFR19MQzEpOwotICAgIG1hcmtfaW1wbGljaXRfcmVnX3dy
aXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfU0ExLCBIRVhfUkVHX1NBMSk7Ci0gICAgbWFya19p
bXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19VU1IsIEhFWF9SRUdfVVNS
KTsKLSAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFfRlBPUCwgSEVYX1JFR19VU1Ip
OwotfQotCi1zdGF0aWMgdm9pZCBtYXJrX2ltcGxpY2l0X3ByZWRfd3JpdGVzKERpc2FzQ29udGV4
dCAqY3R4KQotewotICAgIG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZShjdHgsIEFfSU1QTElDSVRf
V1JJVEVTX1AwLCAwKTsKLSAgICBtYXJrX2ltcGxpY2l0X3ByZWRfd3JpdGUoY3R4LCBBX0lNUExJ
Q0lUX1dSSVRFU19QMSwgMSk7Ci0gICAgbWFya19pbXBsaWNpdF9wcmVkX3dyaXRlKGN0eCwgQV9J
TVBMSUNJVF9XUklURVNfUDIsIDIpOwotICAgIG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZShjdHgs
IEFfSU1QTElDSVRfV1JJVEVTX1AzLCAzKTsKLX0KLQogc3RhdGljIHZvaWQgbWFya19zdG9yZV93
aWR0aChEaXNhc0NvbnRleHQgKmN0eCkKIHsKICAgICB1aW50MTZfdCBvcGNvZGUgPSBjdHgtPmlu
c24tPm9wY29kZTsKQEAgLTQyMyw5ICs0NDYsNyBAQCBzdGF0aWMgdm9pZCBtYXJrX3N0b3JlX3dp
ZHRoKERpc2FzQ29udGV4dCAqY3R4KQogc3RhdGljIHZvaWQgZ2VuX2luc24oRGlzYXNDb250ZXh0
ICpjdHgpCiB7CiAgICAgaWYgKGN0eC0+aW5zbi0+Z2VuZXJhdGUpIHsKLSAgICAgICAgbWFya19p
bXBsaWNpdF9yZWdfd3JpdGVzKGN0eCk7CiAgICAgICAgIGN0eC0+aW5zbi0+Z2VuZXJhdGUoY3R4
KTsKLSAgICAgICAgbWFya19pbXBsaWNpdF9wcmVkX3dyaXRlcyhjdHgpOwogICAgICAgICBtYXJr
X3N0b3JlX3dpZHRoKGN0eCk7CiAgICAgfSBlbHNlIHsKICAgICAgICAgZ2VuX2V4Y2VwdGlvbl9l
bmRfdGIoY3R4LCBIRVhfRVhDUF9JTlZBTElEX09QQ09ERSk7CmRpZmYgLS1naXQgYS90YXJnZXQv
aGV4YWdvbi9SRUFETUUgYi90YXJnZXQvaGV4YWdvbi9SRUFETUUKaW5kZXggNmNiNWFmZmRkYi4u
ZDAwYzg1ZDU1NCAxMDA2NDQKLS0tIGEvdGFyZ2V0L2hleGFnb24vUkVBRE1FCisrKyBiL3Rhcmdl
dC9oZXhhZ29uL1JFQURNRQpAQCAtNTIsNiArNTIsOCBAQCBoZWFkZXIgZmlsZXMgaW4gPEJVSUxE
X0RJUj4vdGFyZ2V0L2hleGFnb24KICAgICAgICAgZ2VuX3RjZ19mdW5jX3RhYmxlLnB5ICAgICAg
ICAgICAtPiB0Y2dfZnVuY190YWJsZV9nZW5lcmF0ZWQuYy5pbmMKICAgICAgICAgZ2VuX2hlbHBl
cl9mdW5jcy5weSAgICAgICAgICAgICAtPiBoZWxwZXJfZnVuY3NfZ2VuZXJhdGVkLmMuaW5jCiAg
ICAgICAgIGdlbl9pZGVmX3BhcnNlcl9mdW5jcy5weSAgICAgICAgLT4gaWRlZl9wYXJzZXJfaW5w
dXQuaAorICAgICAgICBnZW5fYW5hbHl6ZV9mdW5jcy5weSAgICAgICAgICAgIC0+IGFuYWx5emVf
ZnVuY3NfZ2VuZXJhdGVkLmMuaW5jCisgICAgICAgIGdlbl9hbmFseXplX2Z1bmNfdGFibGUucHkg
ICAgICAgLT4gYW5hbHl6ZV9mdW5jX3RhYmxlLmMuaW5jCiAKIFFlbXUgaGVscGVyIGZ1bmN0aW9u
cyBoYXZlIDMgcGFydHMKICAgICBERUZfSEVMUEVSIGRlY2xhcmF0aW9uIGluZGljYXRlcyB0aGUg
c2lnbmF0dXJlIG9mIHRoZSBoZWxwZXIKQEAgLTg3LDcgKzg5LDYgQEAgdGNnX2Z1bmNzX2dlbmVy
YXRlZC5jLmluYwogICAgICAgICBUQ0d2IFJ0ViA9IGhleF9ncHJbaW5zbi0+cmVnbm9bMl1dOwog
ICAgICAgICBnZW5faGVscGVyX0EyX2FkZChSZFYsIGNwdV9lbnYsIFJzViwgUnRWKTsKICAgICAg
ICAgZ2VuX2xvZ19yZWdfd3JpdGUoUmROLCBSZFYpOwotICAgICAgICBjdHhfbG9nX3JlZ193cml0
ZShjdHgsIFJkTik7CiAgICAgICAgIHRjZ190ZW1wX2ZyZWUoUmRWKTsKICAgICB9CiAKQEAgLTE2
Miw3ICsxNjMsNiBAQCBpc3RydWN0aW9uLgogICAgICAgICBnZW5faGVscGVyX1Y2X3ZhZGR3KGNw
dV9lbnYsIFZkViwgVnVWLCBWdlYsIHNsb3QpOwogICAgICAgICB0Y2dfdGVtcF9mcmVlKHNsb3Qp
OwogICAgICAgICBnZW5fbG9nX3ZyZWdfd3JpdGUoY3R4LCBWZFZfb2ZmLCBWZE4sIEVYVF9ERkws
IGluc24tPnNsb3QsIGZhbHNlKTsKLSAgICAgICAgY3R4X2xvZ192cmVnX3dyaXRlKGN0eCwgVmRO
LCBFWFRfREZMLCBmYWxzZSk7CiAgICAgICAgIHRjZ190ZW1wX2ZyZWVfcHRyKFZkVik7CiAgICAg
ICAgIHRjZ190ZW1wX2ZyZWVfcHRyKFZ1Vik7CiAgICAgICAgIHRjZ190ZW1wX2ZyZWVfcHRyKFZ2
Vik7CkBAIC0xOTUsOSArMTk1LDE0IEBAIHdoZW4gdGhlIG92ZXJyaWRlIGlzIHByZXNlbnQuCiAg
ICAgICAgICAgICB2cmVnX3NyY19vZmYoY3R4LCBWdk4pOwogICAgICAgICBmR0VOX1RDR19WNl92
YWRkdyh7IGZISURFKGludCBpOykgZlZGT1JFQUNIKDMyLCBpKSB7IFZkVi53W2ldID0gVnVWLndb
aV0gKyBWdlYud1tpXSA7IH0gfSk7CiAgICAgICAgIGdlbl9sb2dfdnJlZ193cml0ZShjdHgsIFZk
Vl9vZmYsIFZkTiwgRVhUX0RGTCwgaW5zbi0+c2xvdCwgZmFsc2UpOwotICAgICAgICBjdHhfbG9n
X3ZyZWdfd3JpdGUoY3R4LCBWZE4sIEVYVF9ERkwsIGZhbHNlKTsKICAgICB9CiAKK1dlIGFsc28g
Z2VuZXJhdGUgYW4gYW5hbHl6ZV88dGFnPiBmdW5jdGlvbiBmb3IgZWFjaCBpbnN0cnVjdGlvbi4g
IEN1cnJlbnRseSwKK3RoZXNlIGZ1bmN0aW9ucyByZWNvcmQgdGhlIHdyaXRlcyB0byByZWdpc3Rl
cnMgYnkgY2FsbGluZyBjdHhfbG9nXyouICBEdXJpbmcKK2dlbl9zdGFydF9wYWNrZXQsIHdlIGlu
dm9rZSB0aGUgYW5hbHl6ZV88dGFnPiBmdW5jdGlvbiBmb3IgZWFjaCBpbnN0cnVjdGlvbiBpbgor
dGhlIHBhY2tldCwgYW5kIHdlIG1hcmsgdGhlIGltcGxpY2l0IHdyaXRlcy4gIEFmdGVyIHRoZSBh
bmFseXNpcyBpcyBwZXJmb3JtZWQsCit3ZSBpbml0aWFsaXplIGhleF9uZXdfdmFsdWUgZm9yIGVh
Y2ggb2YgdGhlIHByZWRpY2F0ZWQgYXNzaWdubWVudHMuCisKIEluIGFkZGl0aW9uIHRvIGluc3Ry
dWN0aW9uIHNlbWFudGljcywgd2UgdXNlIGEgZ2VuZXJhdG9yIHRvIGNyZWF0ZSB0aGUgZGVjb2Rl
CiB0cmVlLiAgVGhpcyBnZW5lcmF0aW9uIGlzIGFsc28gYSB0d28gc3RlcCBwcm9jZXNzLiAgVGhl
IGZpcnN0IHN0ZXAgaXMgdG8gcnVuCiB0YXJnZXQvaGV4YWdvbi9nZW5fZGVjdHJlZV9pbXBvcnQu
YyB0byBwcm9kdWNlCmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi9nZW5fYW5hbHl6ZV9mdW5j
X3RhYmxlLnB5IGIvdGFyZ2V0L2hleGFnb24vZ2VuX2FuYWx5emVfZnVuY190YWJsZS5weQpuZXcg
ZmlsZSBtb2RlIDEwMDc1NQppbmRleCAwMDAwMDAwMDAwLi42ZmFiOTA2YWQzCi0tLSAvZGV2L251
bGwKKysrIGIvdGFyZ2V0L2hleGFnb24vZ2VuX2FuYWx5emVfZnVuY190YWJsZS5weQpAQCAtMCww
ICsxLDUyIEBACisjIS91c3IvYmluL2VudiBweXRob24zCisKKyMjCisjIyAgQ29weXJpZ2h0KGMp
IDIwMjIgUXVhbGNvbW0gSW5ub3ZhdGlvbiBDZW50ZXIsIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZl
ZC4KKyMjCisjIyAgVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0
cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKKyMjICBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdO
VSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQorIyMgIHRoZSBGcmVlIFNv
ZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yCisj
IyAgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KKyMjCisjIyAgVGhpcyBwcm9n
cmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisj
IyAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2Fy
cmFudHkgb2YKKyMjICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFS
IFBVUlBPU0UuICBTZWUgdGhlCisjIyAgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1v
cmUgZGV0YWlscy4KKyMjCisjIyAgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0
aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKKyMjICBhbG9uZyB3aXRoIHRoaXMgcHJvZ3Jh
bTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgorIyMKKworaW1w
b3J0IHN5cworaW1wb3J0IHJlCitpbXBvcnQgc3RyaW5nCitpbXBvcnQgaGV4X2NvbW1vbgorCitk
ZWYgbWFpbigpOgorICAgIGhleF9jb21tb24ucmVhZF9zZW1hbnRpY3NfZmlsZShzeXMuYXJndlsx
XSkKKyAgICBoZXhfY29tbW9uLnJlYWRfYXR0cmlic19maWxlKHN5cy5hcmd2WzJdKQorICAgIGhl
eF9jb21tb24uY2FsY3VsYXRlX2F0dHJpYnMoKQorICAgIHRhZ3JlZ3MgPSBoZXhfY29tbW9uLmdl
dF90YWdyZWdzKCkKKyAgICB0YWdpbW1zID0gaGV4X2NvbW1vbi5nZXRfdGFnaW1tcygpCisKKyAg
ICB3aXRoIG9wZW4oc3lzLmFyZ3ZbM10sICd3JykgYXMgZjoKKyAgICAgICAgZi53cml0ZSgiI2lm
bmRlZiBIRVhBR09OX0FOQUxZWkVfVEFCTEVfSFxuIikKKyAgICAgICAgZi53cml0ZSgiI2RlZmlu
ZSBIRVhBR09OX0FOQUxZWkVfVEFCTEVfSFxuXG4iKQorCisgICAgICAgIGYud3JpdGUoImNvbnN0
IEFuYWx5emVJbnNuIG9wY29kZV9hbmFseXplW1hYX0xBU1RfT1BDT0RFXSA9IHtcbiIpCisgICAg
ICAgIGZvciB0YWcgaW4gaGV4X2NvbW1vbi50YWdzOgorICAgICAgICAgICAgIyMgU2tpcCB0aGUg
ZGlhZyBpbnN0cnVjdGlvbnMKKyAgICAgICAgICAgIGlmICggdGFnID09ICJZNl9kaWFnIiApIDoK
KyAgICAgICAgICAgICAgICBjb250aW51ZQorICAgICAgICAgICAgaWYgKCB0YWcgPT0gIlk2X2Rp
YWcwIiApIDoKKyAgICAgICAgICAgICAgICBjb250aW51ZQorICAgICAgICAgICAgaWYgKCB0YWcg
PT0gIlk2X2RpYWcxIiApIDoKKyAgICAgICAgICAgICAgICBjb250aW51ZQorCisgICAgICAgICAg
ICBmLndyaXRlKCIgICAgWyVzXSA9IGFuYWx5emVfJXMsXG4iICUgKHRhZywgdGFnKSkKKyAgICAg
ICAgZi53cml0ZSgifTtcblxuIikKKworICAgICAgICBmLndyaXRlKCIjZW5kaWYgICAgLyogSEVY
QUdPTl9BTkFMWVpFX1RBQkxFX0ggKi9cbiIpCisKK2lmIF9fbmFtZV9fID09ICJfX21haW5fXyI6
CisgICAgbWFpbigpCmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi9nZW5fYW5hbHl6ZV9mdW5j
cy5weSBiL3RhcmdldC9oZXhhZ29uL2dlbl9hbmFseXplX2Z1bmNzLnB5Cm5ldyBmaWxlIG1vZGUg
MTAwNzU1CmluZGV4IDAwMDAwMDAwMDAuLmM4ZWIxZDUyMTkKLS0tIC9kZXYvbnVsbAorKysgYi90
YXJnZXQvaGV4YWdvbi9nZW5fYW5hbHl6ZV9mdW5jcy5weQpAQCAtMCwwICsxLDIzOSBAQAorIyEv
dXNyL2Jpbi9lbnYgcHl0aG9uMworCisjIworIyMgIENvcHlyaWdodChjKSAyMDIyIFF1YWxjb21t
IElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCisjIworIyMgIFRo
aXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQv
b3IgbW9kaWZ5CisjIyAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJs
aWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKKyMjICB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0
aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvcgorIyMgIChhdCB5b3VyIG9w
dGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisjIworIyMgIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmli
dXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorIyMgIGJ1dCBXSVRIT1VU
IEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisjIyAg
TUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2Vl
IHRoZQorIyMgIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisj
IworIyMgIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFs
IFB1YmxpYyBMaWNlbnNlCisjIyAgYWxvbmcgd2l0aCB0aGlzIHByb2dyYW07IGlmIG5vdCwgc2Vl
IDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KKyMjCisKK2ltcG9ydCBzeXMKK2ltcG9y
dCByZQoraW1wb3J0IHN0cmluZworaW1wb3J0IGhleF9jb21tb24KKworIyMKKyMjIEhlbHBlcnMg
Zm9yIGdlbl9hbmFseXplX2Z1bmMKKyMjCitkZWYgaXNfcHJlZGljYXRlZCh0YWcpOgorICAgIHJl
dHVybiAnQV9DT05ERVhFQycgaW4gaGV4X2NvbW1vbi5hdHRyaWJkaWN0W3RhZ10KKworZGVmIGFu
YWx5emVfb3BuX29sZChmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCByZWdubyk6CisgICAgcmVnTiA9
ICIlcyVzTiIgJSAocmVndHlwZSwgcmVnaWQpCisgICAgcHJlZGljYXRlZCA9ICJ0cnVlIiBpZiBp
c19wcmVkaWNhdGVkKHRhZykgZWxzZSAiZmFsc2UiCisgICAgaWYgKHJlZ3R5cGUgPT0gIlIiKToK
KyAgICAgICAgaWYgKHJlZ2lkIGluIHsic3MiLCAidHQifSk6CisgICAgICAgICAgICBmLndyaXRl
KCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4iICUgXAorICAgICAgICAg
ICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVsaWYgKHJlZ2lkIGluIHsiZGQiLCAiZWUi
LCAieHgiLCAieXkifSk6CisgICAgICAgICAgICBmLndyaXRlKCIgICAgY29uc3QgaW50ICVzID0g
aW5zbi0+cmVnbm9bJWRdO1xuIiAlIChyZWdOLCByZWdubykpCisgICAgICAgICAgICBmLndyaXRl
KCIgICAgY3R4X2xvZ19yZWdfd3JpdGVfcGFpcihjdHgsICVzLCAlcyk7XG4iICUgXAorICAgICAg
ICAgICAgICAgIChyZWdOLCBwcmVkaWNhdGVkKSkKKyAgICAgICAgZWxpZiAocmVnaWQgaW4geyJz
IiwgInQiLCAidSIsICJ2In0pOgorICAgICAgICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50
ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVn
bm8pKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7ImQiLCAiZSIsICJ4IiwgInkifSk6CisgICAg
ICAgICAgICBmLndyaXRlKCIgICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAl
IChyZWdOLCByZWdubykpCisgICAgICAgICAgICBmLndyaXRlKCIgICAgY3R4X2xvZ19yZWdfd3Jp
dGUoY3R4LCAlcywgJXMpO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcHJlZGljYXRl
ZCkpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNl
OiAiLCByZWd0eXBlLCByZWdpZCkKKyAgICBlbGlmIChyZWd0eXBlID09ICJQIik6CisgICAgICAg
IGlmIChyZWdpZCBpbiB7InMiLCAidCIsICJ1IiwgInYifSk6CisgICAgICAgICAgICBmLndyaXRl
KCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4iICUgXAorICAgICAgICAg
ICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVsaWYgKHJlZ2lkIGluIHsiZCIsICJlIiwg
IngifSk6CisgICAgICAgICAgICBmLndyaXRlKCIgICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVn
bm9bJWRdO1xuIiAlIChyZWdOLCByZWdubykpCisgICAgICAgICAgICBmLndyaXRlKCIgICAgY3R4
X2xvZ19wcmVkX3dyaXRlKGN0eCwgJXMpO1xuIiAlIChyZWdOKSkKKyAgICAgICAgZWxzZToKKyAg
ICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQor
ICAgIGVsaWYgKHJlZ3R5cGUgPT0gIkMiKToKKyAgICAgICAgaWYgKHJlZ2lkID09ICJzcyIpOgor
ICAgICAgICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRd
ICsgSEVYX1JFR19TQTA7XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisg
ICAgICAgIGVsaWYgKHJlZ2lkID09ICJkZCIpOgorICAgICAgICAgICAgZi53cml0ZSgiICAgIGNv
bnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVkXSArIEhFWF9SRUdfU0EwO1xuIiAlIFwKKyAgICAg
ICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICAgICAgZi53cml0ZSgiICAgIGN0eF9s
b2dfcmVnX3dyaXRlX3BhaXIoY3R4LCAlcywgJXMpO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAo
cmVnTiwgcHJlZGljYXRlZCkpCisgICAgICAgIGVsaWYgKHJlZ2lkID09ICJzIik6CisgICAgICAg
ICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMlc04gPSBpbnNuLT5yZWdub1slZF0gKyBI
RVhfUkVHX1NBMDtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWdu
bykpCisgICAgICAgIGVsaWYgKHJlZ2lkID09ICJkIik6CisgICAgICAgICAgICBmLndyaXRlKCIg
ICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdICsgSEVYX1JFR19TQTA7XG4iICUgXAor
ICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgICAgICBmLndyaXRlKCIgICAg
Y3R4X2xvZ19yZWdfd3JpdGUoY3R4LCAlcywgJXMpO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAo
cmVnTiwgcHJlZGljYXRlZCkpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFk
IHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKyAgICBlbGlmIChyZWd0eXBlID09
ICJNIik6CisgICAgICAgIGlmIChyZWdpZCA9PSAidSIpOgorICAgICAgICAgICAgZi53cml0ZSgi
Ly8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiUgXAorICAgICAgICAgICAg
ICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFk
IHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKKyAgICBlbGlmIChyZWd0eXBlID09
ICJWIik6CisgICAgICAgIGlmIChyZWdpZCBpbiB7ImRkIiwgInh4In0pOgorICAgICAgICAgICAg
Zi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlXAorICAg
ICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVsaWYgKHJlZ2lkIGluIHsidXUi
LCAidnYifSk6CisgICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNu
LT5yZWdub1slZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAg
ICAgIGVsaWYgKHJlZ2lkIGluIHsicyIsICJ1IiwgInYiLCAidyJ9KToKKyAgICAgICAgICAgIGYu
d3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAg
ICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxpZiAocmVnaWQgaW4geyJkIiwg
IngiLCAieSJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGlu
c24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAg
ICAgICAgZWxzZToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJl
Z3R5cGUsIHJlZ2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIlEiKToKKyAgICAgICAgaWYgKHJl
Z2lkIGluIHsiZCIsICJlIiwgIngifSk6CisgICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25z
dCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdO
LCByZWdubykpCisgICAgICAgIGVsaWYgKHJlZ2lkIGluIHsicyIsICJ0IiwgInUiLCAidiJ9KToK
KyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVk
XTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxzZToK
KyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lk
KQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIkciKToKKyAgICAgICAgaWYgKHJlZ2lkIGluIHsiZGQi
fSk6CisgICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdu
b1slZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVs
aWYgKHJlZ2lkIGluIHsiZCJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGlu
dCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJl
Z25vKSkKKyAgICAgICAgZWxpZiAocmVnaWQgaW4geyJzcyJ9KToKKyAgICAgICAgICAgIGYud3Jp
dGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAg
ICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxpZiAocmVnaWQgaW4geyJzIn0pOgor
ICAgICAgICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRd
O1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbHNlOgor
ICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQp
CisgICAgZWxpZiAocmVndHlwZSA9PSAiUyIpOgorICAgICAgICBpZiAocmVnaWQgaW4geyJkZCJ9
KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25v
WyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAgZWxp
ZiAocmVnaWQgaW4geyJkIn0pOgorICAgICAgICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50
ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVn
bm8pKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7InNzIn0pOgorICAgICAgICAgICAgZi53cml0
ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwKKyAgICAgICAg
ICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7InMifSk6Cisg
ICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdub1slZF07
XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAgIGVsc2U6Cisg
ICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkK
KyAgICBlbHNlOgorICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBl
LCByZWdpZCkKKworZGVmIGFuYWx5emVfb3BuX25ldyhmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCBy
ZWdubyk6CisgICAgcmVnTiA9ICIlcyVzTiIgJSAocmVndHlwZSwgcmVnaWQpCisgICAgaWYgKHJl
Z3R5cGUgPT0gIk4iKToKKyAgICAgICAgaWYgKHJlZ2lkIGluIHsicyIsICJ0In0pOgorICAgICAg
ICAgICAgZi53cml0ZSgiLy8gICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAl
IFwKKyAgICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQorICAgICAgICBlbHNlOgorICAgICAg
ICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCisgICAg
ZWxpZiAocmVndHlwZSA9PSAiUCIpOgorICAgICAgICBpZiAocmVnaWQgaW4geyJ0IiwgInUiLCAi
diJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIi8vICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJl
Z25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ04sIHJlZ25vKSkKKyAgICAgICAg
ZWxzZToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUs
IHJlZ2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIk8iKToKKyAgICAgICAgaWYgKHJlZ2lkID09
ICJzIik6CisgICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5y
ZWdub1slZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCisgICAgICAg
IGVsc2U6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBl
LCByZWdpZCkKKyAgICBlbHNlOgorICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAi
LCByZWd0eXBlLCByZWdpZCkKKworZGVmIGFuYWx5emVfb3BuKGYsIHRhZywgcmVndHlwZSwgcmVn
aWQsIHRvc3MsIG51bXJlZ3MsIGkpOgorICAgIGlmIChoZXhfY29tbW9uLmlzX3BhaXIocmVnaWQp
KToKKyAgICAgICAgYW5hbHl6ZV9vcG5fb2xkKGYsIHRhZywgcmVndHlwZSwgcmVnaWQsIGkpCisg
ICAgZWxpZiAoaGV4X2NvbW1vbi5pc19zaW5nbGUocmVnaWQpKToKKyAgICAgICAgaWYgaGV4X2Nv
bW1vbi5pc19vbGRfdmFsKHJlZ3R5cGUsIHJlZ2lkLCB0YWcpOgorICAgICAgICAgICAgYW5hbHl6
ZV9vcG5fb2xkKGYsdGFnLCByZWd0eXBlLCByZWdpZCwgaSkKKyAgICAgICAgZWxpZiBoZXhfY29t
bW9uLmlzX25ld192YWwocmVndHlwZSwgcmVnaWQsIHRhZyk6CisgICAgICAgICAgICBhbmFseXpl
X29wbl9uZXcoZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgaSkKKyAgICAgICAgZWxzZToKKyAgICAg
ICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIscmVndHlwZSxyZWdpZCx0b3NzLG51
bXJlZ3MpCisgICAgZWxzZToKKyAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIixy
ZWd0eXBlLHJlZ2lkLHRvc3MsbnVtcmVncykKKworIyMKKyMjIEdlbmVyYXRlIHRoZSBjb2RlIHRv
IGFuYWx5emUgdGhlIGluc3RydWN0aW9uCisjIyAgICAgRm9yIEEyX2FkZDogUmQzMj1hZGQoUnMz
MixSdDMyKSwgeyBSZFY9UnNWK1J0Vjt9CisjIyAgICAgV2UgcHJvZHVjZToKKyMjICAgICBzdGF0
aWMgdm9pZCBhbmFseXplX0EyX2FkZChEaXNhc0NvbnRleHQgKmN0eCkKKyMjICAgICB7CisjIyAg
ICAgICAgIEluc24gKmluc24gX19hdHRyaWJ1dGVfXygodW51c2VkKSkgPSBjdHgtPmluc247Cisj
IyAgICAgICAgIGNvbnN0IGludCBSZE4gPSBpbnNuLT5yZWdub1swXTsKKyMjICAgICAgICAgY3R4
X2xvZ19yZWdfd3JpdGUoY3R4LCBSZE4sIGZhbHNlKTsKKyMjICAgICAvLyAgICBjb25zdCBpbnQg
UnNOID0gaW5zbi0+cmVnbm9bMV07CisjIyAgICAgLy8gICAgY29uc3QgaW50IFJ0TiA9IGluc24t
PnJlZ25vWzJdOworIyMgICAgIH0KKyMjCitkZWYgZ2VuX2FuYWx5emVfZnVuYyhmLCB0YWcsIHJl
Z3MsIGltbXMpOgorICAgIGYud3JpdGUoInN0YXRpYyB2b2lkIGFuYWx5emVfJXMoRGlzYXNDb250
ZXh0ICpjdHgpXG4iICV0YWcpCisgICAgZi53cml0ZSgne1xuJykKKworICAgIGYud3JpdGUoIiAg
ICBJbnNuICppbnNuIF9fYXR0cmlidXRlX18oKHVudXNlZCkpID0gY3R4LT5pbnNuO1xuIikKKwor
ICAgIGk9MAorICAgICMjIEFuYWx5emUgYWxsIHRoZSByZWdpc3RlcnMKKyAgICBmb3IgcmVndHlw
ZSxyZWdpZCx0b3NzLG51bXJlZ3MgaW4gcmVnczoKKyAgICAgICAgYW5hbHl6ZV9vcG4oZiwgdGFn
LCByZWd0eXBlLCByZWdpZCwgdG9zcywgbnVtcmVncywgaSkKKyAgICAgICAgaSArPSAxCisKKwor
ICAgIGYud3JpdGUoIn1cblxuIikKKworZGVmIGdlbl9kZWZfYW5hbHl6ZV9mdW5jKGYsIHRhZywg
dGFncmVncywgdGFnaW1tcyk6CisgICAgcmVncyA9IHRhZ3JlZ3NbdGFnXQorICAgIGltbXMgPSB0
YWdpbW1zW3RhZ10KKworICAgIGdlbl9hbmFseXplX2Z1bmMoZiwgdGFnLCByZWdzLCBpbW1zKQor
CitkZWYgbWFpbigpOgorICAgIGhleF9jb21tb24ucmVhZF9zZW1hbnRpY3NfZmlsZShzeXMuYXJn
dlsxXSkKKyAgICBoZXhfY29tbW9uLnJlYWRfYXR0cmlic19maWxlKHN5cy5hcmd2WzJdKQorICAg
IGhleF9jb21tb24ucmVhZF9vdmVycmlkZXNfZmlsZShzeXMuYXJndlszXSkKKyAgICBoZXhfY29t
bW9uLnJlYWRfb3ZlcnJpZGVzX2ZpbGUoc3lzLmFyZ3ZbNF0pCisgICAgaGV4X2NvbW1vbi5jYWxj
dWxhdGVfYXR0cmlicygpCisgICAgdGFncmVncyA9IGhleF9jb21tb24uZ2V0X3RhZ3JlZ3MoKQor
ICAgIHRhZ2ltbXMgPSBoZXhfY29tbW9uLmdldF90YWdpbW1zKCkKKworICAgIHdpdGggb3Blbihz
eXMuYXJndls1XSwgJ3cnKSBhcyBmOgorICAgICAgICBmLndyaXRlKCIjaWZuZGVmIEhFWEFHT05f
VENHX0ZVTkNTX0hcbiIpCisgICAgICAgIGYud3JpdGUoIiNkZWZpbmUgSEVYQUdPTl9UQ0dfRlVO
Q1NfSFxuXG4iKQorCisgICAgICAgIGZvciB0YWcgaW4gaGV4X2NvbW1vbi50YWdzOgorICAgICAg
ICAgICAgIyMgU2tpcCB0aGUgZGlhZyBpbnN0cnVjdGlvbnMKKyAgICAgICAgICAgIGlmICggdGFn
ID09ICJZNl9kaWFnIiApIDoKKyAgICAgICAgICAgICAgICBjb250aW51ZQorICAgICAgICAgICAg
aWYgKCB0YWcgPT0gIlk2X2RpYWcwIiApIDoKKyAgICAgICAgICAgICAgICBjb250aW51ZQorICAg
ICAgICAgICAgaWYgKCB0YWcgPT0gIlk2X2RpYWcxIiApIDoKKyAgICAgICAgICAgICAgICBjb250
aW51ZQorCisgICAgICAgICAgICBnZW5fZGVmX2FuYWx5emVfZnVuYyhmLCB0YWcsIHRhZ3JlZ3Ms
IHRhZ2ltbXMpCisKKyAgICAgICAgZi53cml0ZSgiI2VuZGlmICAgIC8qIEhFWEFHT05fVENHX0ZV
TkNTX0ggKi9cbiIpCisKK2lmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CisgICAgbWFpbigpCmRp
ZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi9nZW5fdGNnX2Z1bmNzLnB5IGIvdGFyZ2V0L2hleGFn
b24vZ2VuX3RjZ19mdW5jcy5weQppbmRleCA3ZThiYTE3Y2EyLi42MTViNjBhNjdiIDEwMDc1NQot
LS0gYS90YXJnZXQvaGV4YWdvbi9nZW5fdGNnX2Z1bmNzLnB5CisrKyBiL3RhcmdldC9oZXhhZ29u
L2dlbl90Y2dfZnVuY3MucHkKQEAgLTQ0LDE1ICs0NCw2IEBAIGRlZiBnZW5wdHJfZGVjbF9wYWly
X3dyaXRhYmxlKGYsIHRhZywgcmVndHlwZSwgcmVnaWQsIHJlZ25vKToKICAgICAgICAgICAgIChy
ZWdOLCByZWdubykpCiAgICAgZWxzZToKICAgICAgICAgZi53cml0ZSgiICAgIGNvbnN0IGludCAl
cyA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSAocmVnTiwgcmVnbm8pKQotICAgIGlmICgnQV9DT05E
RVhFQycgaW4gaGV4X2NvbW1vbi5hdHRyaWJkaWN0W3RhZ10pOgotICAgICAgICBmLndyaXRlKCIg
ICAgaWYgKCFpc19wcmVsb2FkZWQoY3R4LCAlcykpIHtcbiIgJSByZWdOKQotICAgICAgICBmLndy
aXRlKCIgICAgICAgIHRjZ19nZW5fbW92X3RsKGhleF9uZXdfdmFsdWVbJXNdLCBoZXhfZ3ByWyVz
XSk7XG4iICUgXAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAocmVnTiwgcmVnTikpCi0g
ICAgICAgIGYud3JpdGUoIiAgICB9XG4iKQotICAgICAgICBmLndyaXRlKCIgICAgaWYgKCFpc19w
cmVsb2FkZWQoY3R4LCAlcyArIDEpKSB7XG4iICUgcmVnTikKLSAgICAgICAgZi53cml0ZSgiICAg
ICAgICB0Y2dfZ2VuX21vdl90bChoZXhfbmV3X3ZhbHVlWyVzICsgMV0sIGhleF9ncHJbJXMgKyAx
XSk7XG4iICUgXAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAocmVnTiwgcmVnTikpCi0g
ICAgICAgIGYud3JpdGUoIiAgICB9XG4iKQogCiBkZWYgZ2VucHRyX2RlY2xfd3JpdGFibGUoZiwg
dGFnLCByZWd0eXBlLCByZWdpZCwgcmVnbm8pOgogICAgIHJlZ049IiVzJXNOIiAlIChyZWd0eXBl
LHJlZ2lkKQpAQCAtNjMsMTEgKzU0LDYgQEAgZGVmIGdlbnB0cl9kZWNsX3dyaXRhYmxlKGYsIHRh
ZywgcmVndHlwZSwgcmVnaWQsIHJlZ25vKToKICAgICAgICAgICAgIChyZWdOLCByZWdubykpCiAg
ICAgZWxzZToKICAgICAgICAgZi53cml0ZSgiICAgIGNvbnN0IGludCAlcyA9IGluc24tPnJlZ25v
WyVkXTtcbiIgJSAocmVnTiwgcmVnbm8pKQotICAgIGlmICgnQV9DT05ERVhFQycgaW4gaGV4X2Nv
bW1vbi5hdHRyaWJkaWN0W3RhZ10pOgotICAgICAgICBmLndyaXRlKCIgICAgaWYgKCFpc19wcmVs
b2FkZWQoY3R4LCAlcykpIHtcbiIgJSByZWdOKQotICAgICAgICBmLndyaXRlKCIgICAgICAgIHRj
Z19nZW5fbW92X3RsKGhleF9uZXdfdmFsdWVbJXNdLCBoZXhfZ3ByWyVzXSk7XG4iICUgXAotICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAocmVnTiwgcmVnTikpCi0gICAgICAgIGYud3JpdGUo
IiAgICB9XG4iKQogCiBkZWYgZ2VucHRyX2RlY2woZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgcmVn
bm8pOgogICAgIHJlZ049IiVzJXNOIiAlIChyZWd0eXBlLHJlZ2lkKQpAQCAtNDY1LDggKzQ1MSw2
IEBAIGRlZiBnZW5wdHJfZHN0X3dyaXRlX3BhaXIoZiwgdGFnLCByZWd0eXBlLCByZWdpZCk6CiAg
ICAgZWxzZToKICAgICAgICAgZi53cml0ZSgiICAgIGdlbl9sb2dfcmVnX3dyaXRlX3BhaXIoJXMl
c04sICVzJXNWKTtcbiIgJSBcCiAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQsIHJlZ3R5cGUs
IHJlZ2lkKSkKLSAgICBmLndyaXRlKCIgICAgY3R4X2xvZ19yZWdfd3JpdGVfcGFpcihjdHgsICVz
JXNOKTtcbiIgJSBcCi0gICAgICAgIChyZWd0eXBlLCByZWdpZCkpCiAKIGRlZiBnZW5wdHJfZHN0
X3dyaXRlKGYsIHRhZywgcmVndHlwZSwgcmVnaWQpOgogICAgIGlmIChyZWd0eXBlID09ICJSIik6
CkBAIC00ODAsMTYgKzQ2NCwxMiBAQCBkZWYgZ2VucHRyX2RzdF93cml0ZShmLCB0YWcsIHJlZ3R5
cGUsIHJlZ2lkKToKICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgZi53cml0ZSgi
ICAgIGdlbl9sb2dfcmVnX3dyaXRlKCVzJXNOLCAlcyVzVik7XG4iICUgXAogICAgICAgICAgICAg
ICAgICAgICAocmVndHlwZSwgcmVnaWQsIHJlZ3R5cGUsIHJlZ2lkKSkKLSAgICAgICAgICAgIGYu
d3JpdGUoIiAgICBjdHhfbG9nX3JlZ193cml0ZShjdHgsICVzJXNOKTtcbiIgJSBcCi0gICAgICAg
ICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkKICAgICAgICAgZWxzZToKICAgICAgICAgICAgIHBy
aW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQogICAgIGVsaWYgKHJl
Z3R5cGUgPT0gIlAiKToKICAgICAgICAgaWYgKHJlZ2lkIGluIHsiZCIsICJlIiwgIngifSk6CiAg
ICAgICAgICAgICBmLndyaXRlKCIgICAgZ2VuX2xvZ19wcmVkX3dyaXRlKGN0eCwgJXMlc04sICVz
JXNWKTtcbiIgJSBcCiAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWd0eXBlLCBy
ZWdpZCkpCi0gICAgICAgICAgICBmLndyaXRlKCIgICAgY3R4X2xvZ19wcmVkX3dyaXRlKGN0eCwg
JXMlc04pO1xuIiAlIFwKLSAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQpKQogICAgICAg
ICBlbHNlOgogICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlw
ZSwgcmVnaWQpCiAgICAgZWxpZiAocmVndHlwZSA9PSAiQyIpOgpAQCAtNTgxLDcgKzU2MSw2IEBA
IGRlZiBnZW5wdHJfZHN0X3dyaXRlX29wbihmLHJlZ3R5cGUsIHJlZ2lkLCB0YWcpOgogIyMgICAg
ICAgICAgIFRDR3YgUnRWID0gaGV4X2dwcltpbnNuLT5yZWdub1syXV07CiAjIyAgICAgICAgICAg
PEdFTj4KICMjICAgICAgICAgICBnZW5fbG9nX3JlZ193cml0ZShSZE4sIFJkVik7Ci0jIyAgICAg
ICAgICAgY3R4X2xvZ19yZWdfd3JpdGUoY3R4LCBSZE4pOwogIyMgICAgICAgICAgIHRjZ190ZW1w
X2ZyZWUoUmRWKTsKICMjICAgICAgIH0KICMjCmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi9t
ZXNvbi5idWlsZCBiL3RhcmdldC9oZXhhZ29uL21lc29uLmJ1aWxkCmluZGV4IGU4ZjI1MGZjYWMu
Ljg3YWVmNjI4M2UgMTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29uL21lc29uLmJ1aWxkCisrKyBi
L3RhcmdldC9oZXhhZ29uL21lc29uLmJ1aWxkCkBAIC02Nyw2ICs2NywyNCBAQCB0Y2dfZnVuY190
YWJsZV9nZW5lcmF0ZWQgPSBjdXN0b21fdGFyZ2V0KAogKQogaGV4YWdvbl9zcy5hZGQodGNnX2Z1
bmNfdGFibGVfZ2VuZXJhdGVkKQogCithbmFseXplX2Z1bmNzX2dlbmVyYXRlZCA9IGN1c3RvbV90
YXJnZXQoCisgICAgJ2FuYWx5emVfZnVuY3NfZ2VuZXJhdGVkLmMuaW5jJywKKyAgICBvdXRwdXQ6
ICdhbmFseXplX2Z1bmNzX2dlbmVyYXRlZC5jLmluYycsCisgICAgZGVwZW5kczogW3NlbWFudGlj
c19nZW5lcmF0ZWRdLAorICAgIGRlcGVuZF9maWxlczogW2hleF9jb21tb25fcHksIGF0dHJpYnNf
ZGVmLCBnZW5fdGNnX2gsIGdlbl90Y2dfaHZ4X2hdLAorICAgIGNvbW1hbmQ6IFtweXRob24sIGZp
bGVzKCdnZW5fYW5hbHl6ZV9mdW5jcy5weScpLCBzZW1hbnRpY3NfZ2VuZXJhdGVkLCBhdHRyaWJz
X2RlZiwgZ2VuX3RjZ19oLCBnZW5fdGNnX2h2eF9oLCAnQE9VVFBVVEAnXSwKKykKK2hleGFnb25f
c3MuYWRkKGFuYWx5emVfZnVuY3NfZ2VuZXJhdGVkKQorCithbmFseXplX2Z1bmNfdGFibGVfZ2Vu
ZXJhdGVkID0gY3VzdG9tX3RhcmdldCgKKyAgICAnYW5hbHl6ZV9mdW5jX3RhYmxlX2dlbmVyYXRl
ZC5jLmluYycsCisgICAgb3V0cHV0OiAnYW5hbHl6ZV9mdW5jX3RhYmxlX2dlbmVyYXRlZC5jLmlu
YycsCisgICAgZGVwZW5kczogW3NlbWFudGljc19nZW5lcmF0ZWRdLAorICAgIGRlcGVuZF9maWxl
czogW2hleF9jb21tb25fcHksIGF0dHJpYnNfZGVmXSwKKyAgICBjb21tYW5kOiBbcHl0aG9uLCBm
aWxlcygnZ2VuX2FuYWx5emVfZnVuY190YWJsZS5weScpLCBzZW1hbnRpY3NfZ2VuZXJhdGVkLCBh
dHRyaWJzX2RlZiwgJ0BPVVRQVVRAJ10sCispCitoZXhhZ29uX3NzLmFkZChhbmFseXplX2Z1bmNf
dGFibGVfZ2VuZXJhdGVkKQorCiBwcmludGluc25fZ2VuZXJhdGVkID0gY3VzdG9tX3RhcmdldCgK
ICAgICAncHJpbnRpbnNuX2dlbmVyYXRlZC5oLmluYycsCiAgICAgb3V0cHV0OiAncHJpbnRpbnNu
X2dlbmVyYXRlZC5oLmluYycsCi0tIAoyLjE3LjEKCg==

