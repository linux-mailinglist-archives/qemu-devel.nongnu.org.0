Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id D09E542A2A4
	for <lists+qemu-devel@lfdr.de>; Tue, 12 Oct 2021 12:50:36 +0200 (CEST)
Received: from localhost ([::1]:35716 helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>)
	id 1maFMf-0002s4-GW
	for lists+qemu-devel@lfdr.de; Tue, 12 Oct 2021 06:50:33 -0400
Received: from eggs.gnu.org ([2001:470:142:3::10]:50400)
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1maEl2-0000bB-Vs
 for qemu-devel@nongnu.org; Tue, 12 Oct 2021 06:11:42 -0400
Received: from alexa-out-sd-02.qualcomm.com ([199.106.114.39]:64100)
 by eggs.gnu.org with esmtps (TLS1.2:RSA_AES_256_CBC_SHA1:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1maEkw-0007Fq-2I
 for qemu-devel@nongnu.org; Tue, 12 Oct 2021 06:11:40 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=quicinc.com; i=@quicinc.com; q=dns/txt; s=qcdkim;
 t=1634033494; x=1665569494;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version:content-transfer-encoding;
 bh=krnfHXX7Bpa7mmfdNIpVbByrgfnRBpJq8hqQRE2k1mQ=;
 b=n9FbgbDp6ccxgWGVHuiN3CsiwGQapLgfX1VVNIBNDyZUFpWmilesN5Fc
 eJ+xbSfC3nUwnMFZ7f6yGNrcpB5b47n1pW+GaTs2Qumfvt5o9YKSXqul+
 QyZlswt6csnpJDVEEmHmJgnqo9vzCt9VX5RWztWDNe5Bb1pN7gOMPUOfV M=;
Received: from unknown (HELO ironmsg01-sd.qualcomm.com) ([10.53.140.141])
 by alexa-out-sd-02.qualcomm.com with ESMTP; 12 Oct 2021 03:11:24 -0700
X-QCInternal: smtphost
Received: from vu-tsimpson-aus.qualcomm.com (HELO
 vu-tsimpson1-aus.qualcomm.com) ([10.222.150.1])
 by ironmsg01-sd.qualcomm.com with ESMTP; 12 Oct 2021 03:11:23 -0700
Received: by vu-tsimpson1-aus.qualcomm.com (Postfix, from userid 47164)
 id 4C21514A5; Tue, 12 Oct 2021 05:11:22 -0500 (CDT)
From: Taylor Simpson <tsimpson@quicinc.com>
To: qemu-devel@nongnu.org
Subject: [PATCH v4 08/30] Hexagon HVX (target/hexagon) semantics generator -
 part 2
Date: Tue, 12 Oct 2021 05:10:46 -0500
Message-Id: <1634033468-23566-9-git-send-email-tsimpson@quicinc.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1634033468-23566-1-git-send-email-tsimpson@quicinc.com>
References: <1634033468-23566-1-git-send-email-tsimpson@quicinc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Received-SPF: pass client-ip=199.106.114.39;
 envelope-from=tsimpson@qualcomm.com; helo=alexa-out-sd-02.qualcomm.com
X-Spam_score_int: -21
X-Spam_score: -2.2
X-Spam_bar: --
X-Spam_report: (-2.2 / 5.0 requ) DKIM_SIGNED=0.1, DKIM_VALID=-0.1,
 DKIM_VALID_AU=-0.1, HEADER_FROM_DIFFERENT_DOMAINS=0.249,
 RCVD_IN_DNSWL_MED=-2.3, SPF_HELO_NONE=0.001,
 SPF_PASS=-0.001 autolearn=ham autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Cc: ale@rev.ng, bcain@quicinc.com, tsimpson@quicinc.com,
 richard.henderson@linaro.org, f4bug@amsat.org
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: "Qemu-devel" <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>

QWNrZWQtYnk6IFJpY2hhcmQgSGVuZGVyc29uIDxyaWNoYXJkLmhlbmRlcnNvbkBsaW5hcm8ub3Jn
PgpTaWduZWQtb2ZmLWJ5OiBUYXlsb3IgU2ltcHNvbiA8dHNpbXBzb25AcXVpY2luYy5jb20+Ci0t
LQogdGFyZ2V0L2hleGFnb24vZ2VuX2hlbHBlcl9mdW5jcy5weSAgfCAxMTIgKysrKysrKysrKysr
KystLQogdGFyZ2V0L2hleGFnb24vZ2VuX2hlbHBlcl9wcm90b3MucHkgfCAgMTYgKystCiB0YXJn
ZXQvaGV4YWdvbi9nZW5fdGNnX2Z1bmNzLnB5ICAgICB8IDI1NCArKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrLS0KIDMgZmlsZXMgY2hhbmdlZCwgMzYwIGluc2VydGlvbnMoKyksIDIy
IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29uL2dlbl9oZWxwZXJfZnVu
Y3MucHkgYi90YXJnZXQvaGV4YWdvbi9nZW5faGVscGVyX2Z1bmNzLnB5CmluZGV4IDJiMWM1ZDgu
LmFjNWNlMTAgMTAwNzU1Ci0tLSBhL3RhcmdldC9oZXhhZ29uL2dlbl9oZWxwZXJfZnVuY3MucHkK
KysrIGIvdGFyZ2V0L2hleGFnb24vZ2VuX2hlbHBlcl9mdW5jcy5weQpAQCAtNDgsMTIgKzQ4LDI2
IEBAIGRlZiBnZW5faGVscGVyX2FyZ19wYWlyKGYscmVndHlwZSxyZWdpZCxyZWdubyk6CiAgICAg
aWYgcmVnbm8gPj0gMCA6IGYud3JpdGUoIiwgIikKICAgICBmLndyaXRlKCJpbnQ2NF90ICVzJXNW
IiAlIChyZWd0eXBlLHJlZ2lkKSkKIAorZGVmIGdlbl9oZWxwZXJfYXJnX2V4dChmLHJlZ3R5cGUs
cmVnaWQscmVnbm8pOgorICAgIGlmIHJlZ25vID4gMCA6IGYud3JpdGUoIiwgIikKKyAgICBmLndy
aXRlKCJ2b2lkIColcyVzVl92b2lkIiAlIChyZWd0eXBlLHJlZ2lkKSkKKworZGVmIGdlbl9oZWxw
ZXJfYXJnX2V4dF9wYWlyKGYscmVndHlwZSxyZWdpZCxyZWdubyk6CisgICAgaWYgcmVnbm8gPiAw
IDogZi53cml0ZSgiLCAiKQorICAgIGYud3JpdGUoInZvaWQgKiVzJXNWX3ZvaWQiICUgKHJlZ3R5
cGUscmVnaWQpKQorCiBkZWYgZ2VuX2hlbHBlcl9hcmdfb3BuKGYscmVndHlwZSxyZWdpZCxpLHRh
Zyk6CiAgICAgaWYgKGhleF9jb21tb24uaXNfcGFpcihyZWdpZCkpOgotICAgICAgICBnZW5faGVs
cGVyX2FyZ19wYWlyKGYscmVndHlwZSxyZWdpZCxpKQorICAgICAgICBpZiAoaGV4X2NvbW1vbi5p
c19odnhfcmVnKHJlZ3R5cGUpKToKKyAgICAgICAgICAgIGdlbl9oZWxwZXJfYXJnX2V4dF9wYWly
KGYscmVndHlwZSxyZWdpZCxpKQorICAgICAgICBlbHNlOgorICAgICAgICAgICAgZ2VuX2hlbHBl
cl9hcmdfcGFpcihmLHJlZ3R5cGUscmVnaWQsaSkKICAgICBlbGlmIChoZXhfY29tbW9uLmlzX3Np
bmdsZShyZWdpZCkpOgogICAgICAgICBpZiBoZXhfY29tbW9uLmlzX29sZF92YWwocmVndHlwZSwg
cmVnaWQsIHRhZyk6Ci0gICAgICAgICAgICBnZW5faGVscGVyX2FyZyhmLHJlZ3R5cGUscmVnaWQs
aSkKKyAgICAgICAgICAgIGlmIChoZXhfY29tbW9uLmlzX2h2eF9yZWcocmVndHlwZSkpOgorICAg
ICAgICAgICAgICAgIGdlbl9oZWxwZXJfYXJnX2V4dChmLHJlZ3R5cGUscmVnaWQsaSkKKyAgICAg
ICAgICAgIGVsc2U6CisgICAgICAgICAgICAgICAgZ2VuX2hlbHBlcl9hcmcoZixyZWd0eXBlLHJl
Z2lkLGkpCiAgICAgICAgIGVsaWYgaGV4X2NvbW1vbi5pc19uZXdfdmFsKHJlZ3R5cGUsIHJlZ2lk
LCB0YWcpOgogICAgICAgICAgICAgZ2VuX2hlbHBlcl9hcmdfbmV3KGYscmVndHlwZSxyZWdpZCxp
KQogICAgICAgICBlbHNlOgpAQCAtNzIsMjUgKzg2LDY3IEBAIGRlZiBnZW5faGVscGVyX2Rlc3Rf
ZGVjbF9wYWlyKGYscmVndHlwZSxyZWdpZCxyZWdubyxzdWJmaWVsZD0iIik6CiAgICAgZi53cml0
ZSgiICAgIGludDY0X3QgJXMlc1YlcyA9IDA7XG4iICUgXAogICAgICAgICAocmVndHlwZSxyZWdp
ZCxzdWJmaWVsZCkpCiAKK2RlZiBnZW5faGVscGVyX2Rlc3RfZGVjbF9leHQoZixyZWd0eXBlLHJl
Z2lkKToKKyAgICBpZiAocmVndHlwZSA9PSAiUSIpOgorICAgICAgICBmLndyaXRlKCIgICAgLyog
JXMlc1YgaXMgKihNTVFSZWcgKikoJXMlc1Zfdm9pZCkgKi9cbiIgJSBcCisgICAgICAgICAgICAo
cmVndHlwZSxyZWdpZCxyZWd0eXBlLHJlZ2lkKSkKKyAgICBlbHNlOgorICAgICAgICBmLndyaXRl
KCIgICAgLyogJXMlc1YgaXMgKihNTVZlY3RvciAqKSglcyVzVl92b2lkKSAqL1xuIiAlIFwKKyAg
ICAgICAgICAgIChyZWd0eXBlLHJlZ2lkLHJlZ3R5cGUscmVnaWQpKQorCitkZWYgZ2VuX2hlbHBl
cl9kZXN0X2RlY2xfZXh0X3BhaXIoZixyZWd0eXBlLHJlZ2lkLHJlZ25vKToKKyAgICBmLndyaXRl
KCIgICAgLyogJXMlc1YgaXMgKihNTVZlY3RvclBhaXIgKikpJXMlc1Zfdm9pZCkgKi9cbiIgJSBc
CisgICAgICAgIChyZWd0eXBlLHJlZ2lkLHJlZ3R5cGUsIHJlZ2lkKSkKKwogZGVmIGdlbl9oZWxw
ZXJfZGVzdF9kZWNsX29wbihmLHJlZ3R5cGUscmVnaWQsaSk6CiAgICAgaWYgKGhleF9jb21tb24u
aXNfcGFpcihyZWdpZCkpOgotICAgICAgICBnZW5faGVscGVyX2Rlc3RfZGVjbF9wYWlyKGYscmVn
dHlwZSxyZWdpZCxpKQorICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc19odnhfcmVnKHJlZ3R5cGUp
KToKKyAgICAgICAgICAgIGdlbl9oZWxwZXJfZGVzdF9kZWNsX2V4dF9wYWlyKGYscmVndHlwZSxy
ZWdpZCwgaSkKKyAgICAgICAgZWxzZToKKyAgICAgICAgICAgIGdlbl9oZWxwZXJfZGVzdF9kZWNs
X3BhaXIoZixyZWd0eXBlLHJlZ2lkLGkpCiAgICAgZWxpZiAoaGV4X2NvbW1vbi5pc19zaW5nbGUo
cmVnaWQpKToKLSAgICAgICAgZ2VuX2hlbHBlcl9kZXN0X2RlY2woZixyZWd0eXBlLHJlZ2lkLGkp
CisgICAgICAgIGlmIChoZXhfY29tbW9uLmlzX2h2eF9yZWcocmVndHlwZSkpOgorICAgICAgICAg
ICAgZ2VuX2hlbHBlcl9kZXN0X2RlY2xfZXh0KGYscmVndHlwZSxyZWdpZCkKKyAgICAgICAgZWxz
ZToKKyAgICAgICAgICAgIGdlbl9oZWxwZXJfZGVzdF9kZWNsKGYscmVndHlwZSxyZWdpZCxpKQog
ICAgIGVsc2U6CiAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIscmVndHlwZSxy
ZWdpZCx0b3NzLG51bXJlZ3MpCiAKK2RlZiBnZW5faGVscGVyX3NyY192YXJfZXh0KGYscmVndHlw
ZSxyZWdpZCk6CisgICAgaWYgKHJlZ3R5cGUgPT0gIlEiKToKKyAgICAgICBmLndyaXRlKCIgICAg
LyogJXMlc1YgaXMgKihNTVFSZWcgKikoJXMlc1Zfdm9pZCkgKi9cbiIgJSBcCisgICAgICAgICAg
IChyZWd0eXBlLHJlZ2lkLHJlZ3R5cGUscmVnaWQpKQorICAgIGVsc2U6CisgICAgICAgZi53cml0
ZSgiICAgIC8qICVzJXNWIGlzICooTU1WZWN0b3IgKikoJXMlc1Zfdm9pZCkgKi9cbiIgJSBcCisg
ICAgICAgICAgIChyZWd0eXBlLHJlZ2lkLHJlZ3R5cGUscmVnaWQpKQorCitkZWYgZ2VuX2hlbHBl
cl9zcmNfdmFyX2V4dF9wYWlyKGYscmVndHlwZSxyZWdpZCxyZWdubyk6CisgICAgZi53cml0ZSgi
ICAgIC8qICVzJXNWJXMgaXMgKihNTVZlY3RvclBhaXIgKikoJXMlc1Ylc192b2lkKSAqL1xuIiAl
IFwKKyAgICAgICAgKHJlZ3R5cGUscmVnaWQscmVnbm8scmVndHlwZSxyZWdpZCxyZWdubykpCisK
IGRlZiBnZW5faGVscGVyX3JldHVybihmLHJlZ3R5cGUscmVnaWQscmVnbm8pOgogICAgIGYud3Jp
dGUoIiAgICByZXR1cm4gJXMlc1Y7XG4iICUgKHJlZ3R5cGUscmVnaWQpKQogCiBkZWYgZ2VuX2hl
bHBlcl9yZXR1cm5fcGFpcihmLHJlZ3R5cGUscmVnaWQscmVnbm8pOgogICAgIGYud3JpdGUoIiAg
ICByZXR1cm4gJXMlc1Y7XG4iICUgKHJlZ3R5cGUscmVnaWQpKQogCitkZWYgZ2VuX2hlbHBlcl9k
c3Rfd3JpdGVfZXh0KGYscmVndHlwZSxyZWdpZCk6CisgICAgcmV0dXJuCisKK2RlZiBnZW5faGVs
cGVyX2RzdF93cml0ZV9leHRfcGFpcihmLHJlZ3R5cGUscmVnaWQpOgorICAgIHJldHVybgorCiBk
ZWYgZ2VuX2hlbHBlcl9yZXR1cm5fb3BuKGYsIHJlZ3R5cGUsIHJlZ2lkLCBpKToKICAgICBpZiAo
aGV4X2NvbW1vbi5pc19wYWlyKHJlZ2lkKSk6Ci0gICAgICAgIGdlbl9oZWxwZXJfcmV0dXJuX3Bh
aXIoZixyZWd0eXBlLHJlZ2lkLGkpCisgICAgICAgIGlmIChoZXhfY29tbW9uLmlzX2h2eF9yZWco
cmVndHlwZSkpOgorICAgICAgICAgICAgZ2VuX2hlbHBlcl9kc3Rfd3JpdGVfZXh0X3BhaXIoZixy
ZWd0eXBlLHJlZ2lkKQorICAgICAgICBlbHNlOgorICAgICAgICAgICAgZ2VuX2hlbHBlcl9yZXR1
cm5fcGFpcihmLHJlZ3R5cGUscmVnaWQsaSkKICAgICBlbGlmIChoZXhfY29tbW9uLmlzX3Npbmds
ZShyZWdpZCkpOgotICAgICAgICBnZW5faGVscGVyX3JldHVybihmLHJlZ3R5cGUscmVnaWQsaSkK
KyAgICAgICAgaWYgKGhleF9jb21tb24uaXNfaHZ4X3JlZyhyZWd0eXBlKSk6CisgICAgICAgICAg
ICBnZW5faGVscGVyX2RzdF93cml0ZV9leHQoZixyZWd0eXBlLHJlZ2lkKQorICAgICAgICBlbHNl
OgorICAgICAgICAgICAgZ2VuX2hlbHBlcl9yZXR1cm4oZixyZWd0eXBlLHJlZ2lkLGkpCiAgICAg
ZWxzZToKICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIixyZWd0eXBlLHJlZ2lk
LHRvc3MsbnVtcmVncykKIApAQCAtMTI5LDE0ICsxODUsMjAgQEAgZGVmIGdlbl9oZWxwZXJfZnVu
Y3Rpb24oZiwgdGFnLCB0YWdyZWdzLCB0YWdpbW1zKToKICAgICAgICAgICAgICAgICAlICh0YWcs
IHRhZykpCiAgICAgZWxzZToKICAgICAgICAgIyMgVGhlIHJldHVybiB0eXBlIG9mIHRoZSBmdW5j
dGlvbiBpcyB0aGUgdHlwZSBvZiB0aGUgZGVzdGluYXRpb24KLSAgICAgICAgIyMgcmVnaXN0ZXIK
KyAgICAgICAgIyMgcmVnaXN0ZXIgKGlmIHNjYWxhcikKICAgICAgICAgaT0wCiAgICAgICAgIGZv
ciByZWd0eXBlLHJlZ2lkLHRvc3MsbnVtcmVncyBpbiByZWdzOgogICAgICAgICAgICAgaWYgKGhl
eF9jb21tb24uaXNfd3JpdHRlbihyZWdpZCkpOgogICAgICAgICAgICAgICAgIGlmIChoZXhfY29t
bW9uLmlzX3BhaXIocmVnaWQpKToKLSAgICAgICAgICAgICAgICAgICAgZ2VuX2hlbHBlcl9yZXR1
cm5fdHlwZV9wYWlyKGYscmVndHlwZSxyZWdpZCxpKQorICAgICAgICAgICAgICAgICAgICBpZiAo
aGV4X2NvbW1vbi5pc19odnhfcmVnKHJlZ3R5cGUpKToKKyAgICAgICAgICAgICAgICAgICAgICAg
IGNvbnRpbnVlCisgICAgICAgICAgICAgICAgICAgIGVsc2U6CisgICAgICAgICAgICAgICAgICAg
ICAgICBnZW5faGVscGVyX3JldHVybl90eXBlX3BhaXIoZixyZWd0eXBlLHJlZ2lkLGkpCiAgICAg
ICAgICAgICAgICAgZWxpZiAoaGV4X2NvbW1vbi5pc19zaW5nbGUocmVnaWQpKToKLSAgICAgICAg
ICAgICAgICAgICAgZ2VuX2hlbHBlcl9yZXR1cm5fdHlwZShmLHJlZ3R5cGUscmVnaWQsaSkKKyAg
ICAgICAgICAgICAgICAgICAgaWYgKGhleF9jb21tb24uaXNfaHZ4X3JlZyhyZWd0eXBlKSk6Cisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUKKyAgICAgICAgICAgICAgICAgICAg
ZWxzZToKKyAgICAgICAgICAgICAgICAgICAgICAgIGdlbl9oZWxwZXJfcmV0dXJuX3R5cGUoZixy
ZWd0eXBlLHJlZ2lkLGkpCiAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAg
ICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIixyZWd0eXBlLHJlZ2lkLHRvc3MsbnVtcmVn
cykKICAgICAgICAgICAgIGkgKz0gMQpAQCAtMTQ1LDE2ICsyMDcsMzcgQEAgZGVmIGdlbl9oZWxw
ZXJfZnVuY3Rpb24oZiwgdGFnLCB0YWdyZWdzLCB0YWdpbW1zKToKICAgICAgICAgICAgIGYud3Jp
dGUoInZvaWQiKQogICAgICAgICBmLndyaXRlKCIgSEVMUEVSKCVzKShDUFVIZXhhZ29uU3RhdGUg
KmVudiIgJSB0YWcpCiAKKyAgICAgICAgIyMgQXJndW1lbnRzIGluY2x1ZGUgdGhlIHZlY3RvciBk
ZXN0aW5hdGlvbiBvcGVyYW5kcwogICAgICAgICBpID0gMQorICAgICAgICBmb3IgcmVndHlwZSxy
ZWdpZCx0b3NzLG51bXJlZ3MgaW4gcmVnczoKKyAgICAgICAgICAgIGlmIChoZXhfY29tbW9uLmlz
X3dyaXR0ZW4ocmVnaWQpKToKKyAgICAgICAgICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc19wYWly
KHJlZ2lkKSk6CisgICAgICAgICAgICAgICAgICAgIGlmIChoZXhfY29tbW9uLmlzX2h2eF9yZWco
cmVndHlwZSkpOgorICAgICAgICAgICAgICAgICAgICAgICAgZ2VuX2hlbHBlcl9hcmdfZXh0X3Bh
aXIoZixyZWd0eXBlLHJlZ2lkLGkpCisgICAgICAgICAgICAgICAgICAgIGVsc2U6CisgICAgICAg
ICAgICAgICAgICAgICAgICBjb250aW51ZQorICAgICAgICAgICAgICAgIGVsaWYgKGhleF9jb21t
b24uaXNfc2luZ2xlKHJlZ2lkKSk6CisgICAgICAgICAgICAgICAgICAgIGlmIChoZXhfY29tbW9u
LmlzX2h2eF9yZWcocmVndHlwZSkpOgorICAgICAgICAgICAgICAgICAgICAgICAgZ2VuX2hlbHBl
cl9hcmdfZXh0KGYscmVndHlwZSxyZWdpZCxpKQorICAgICAgICAgICAgICAgICAgICBlbHNlOgor
ICAgICAgICAgICAgICAgICAgICAgICAgIyBUaGlzIGlzIHRoZSByZXR1cm4gdmFsdWUgb2YgdGhl
IGZ1bmN0aW9uCisgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZQorICAgICAgICAgICAg
ICAgIGVsc2U6CisgICAgICAgICAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6
ICIscmVndHlwZSxyZWdpZCx0b3NzLG51bXJlZ3MpCisgICAgICAgICAgICAgICAgaSArPSAxCiAK
ICAgICAgICAgIyMgQXJndW1lbnRzIHRvIHRoZSBoZWxwZXIgZnVuY3Rpb24gYXJlIHRoZSBzb3Vy
Y2UgcmVncyBhbmQgaW1tZWRpYXRlcwogICAgICAgICBmb3IgcmVndHlwZSxyZWdpZCx0b3NzLG51
bXJlZ3MgaW4gcmVnczoKICAgICAgICAgICAgIGlmIChoZXhfY29tbW9uLmlzX3JlYWQocmVnaWQp
KToKKyAgICAgICAgICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc19odnhfcmVnKHJlZ3R5cGUpIGFu
ZAorICAgICAgICAgICAgICAgICAgICBoZXhfY29tbW9uLmlzX3JlYWR3cml0ZShyZWdpZCkpOgor
ICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgIGdlbl9oZWxwZXJf
YXJnX29wbihmLHJlZ3R5cGUscmVnaWQsaSx0YWcpCiAgICAgICAgICAgICAgICAgaSArPSAxCiAg
ICAgICAgIGZvciBpbW1sZXR0LGJpdHMsaW1tc2hpZnQgaW4gaW1tczoKICAgICAgICAgICAgIGdl
bl9oZWxwZXJfYXJnX2ltbShmLGltbWxldHQpCiAgICAgICAgICAgICBpICs9IDEKKwogICAgICAg
ICBpZiBoZXhfY29tbW9uLm5lZWRfc2xvdCh0YWcpOgogICAgICAgICAgICAgaWYgaSA+IDA6IGYu
d3JpdGUoIiwgIikKICAgICAgICAgICAgIGYud3JpdGUoInVpbnQzMl90IHNsb3QiKQpAQCAtMTcz
LDYgKzI1NiwxNyBAQCBkZWYgZ2VuX2hlbHBlcl9mdW5jdGlvbihmLCB0YWcsIHRhZ3JlZ3MsIHRh
Z2ltbXMpOgogICAgICAgICAgICAgICAgIGdlbl9oZWxwZXJfZGVzdF9kZWNsX29wbihmLHJlZ3R5
cGUscmVnaWQsaSkKICAgICAgICAgICAgIGkgKz0gMQogCisgICAgICAgIGZvciByZWd0eXBlLHJl
Z2lkLHRvc3MsbnVtcmVncyBpbiByZWdzOgorICAgICAgICAgICAgaWYgKGhleF9jb21tb24uaXNf
cmVhZChyZWdpZCkpOgorICAgICAgICAgICAgICAgIGlmIChoZXhfY29tbW9uLmlzX3BhaXIocmVn
aWQpKToKKyAgICAgICAgICAgICAgICAgICAgaWYgKGhleF9jb21tb24uaXNfaHZ4X3JlZyhyZWd0
eXBlKSk6CisgICAgICAgICAgICAgICAgICAgICAgICBnZW5faGVscGVyX3NyY192YXJfZXh0X3Bh
aXIoZixyZWd0eXBlLHJlZ2lkLGkpCisgICAgICAgICAgICAgICAgZWxpZiAoaGV4X2NvbW1vbi5p
c19zaW5nbGUocmVnaWQpKToKKyAgICAgICAgICAgICAgICAgICAgaWYgKGhleF9jb21tb24uaXNf
aHZ4X3JlZyhyZWd0eXBlKSk6CisgICAgICAgICAgICAgICAgICAgICAgICBnZW5faGVscGVyX3Ny
Y192YXJfZXh0KGYscmVndHlwZSxyZWdpZCkKKyAgICAgICAgICAgICAgICBlbHNlOgorICAgICAg
ICAgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLHJlZ3R5cGUscmVnaWQs
dG9zcyxudW1yZWdzKQorCiAgICAgICAgIGlmICdBX0ZQT1AnIGluIGhleF9jb21tb24uYXR0cmli
ZGljdFt0YWddOgogICAgICAgICAgICAgZi53cml0ZSgnICAgIGFyY2hfZnBvcF9zdGFydChlbnYp
O1xuJyk7CiAKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29uL2dlbl9oZWxwZXJfcHJvdG9zLnB5
IGIvdGFyZ2V0L2hleGFnb24vZ2VuX2hlbHBlcl9wcm90b3MucHkKaW5kZXggZWE0MTAwNy4uMjI5
ZWY4ZCAxMDA3NTUKLS0tIGEvdGFyZ2V0L2hleGFnb24vZ2VuX2hlbHBlcl9wcm90b3MucHkKKysr
IGIvdGFyZ2V0L2hleGFnb24vZ2VuX2hlbHBlcl9wcm90b3MucHkKQEAgLTk0LDE5ICs5NCwzMyBA
QCBkZWYgZ2VuX2hlbHBlcl9wcm90b3R5cGUoZiwgdGFnLCB0YWdyZWdzLCB0YWdpbW1zKToKICAg
ICAgICAgICAgIGYud3JpdGUoJ0RFRl9IRUxQRVJfJXMoJXMnICUgKGRlZl9oZWxwZXJfc2l6ZSwg
dGFnKSkKIAogICAgICAgICAjIyBHZW5lcmF0ZSB0aGUgcWVtdSBERUZfSEVMUEVSIHR5cGUgZm9y
IGVhY2ggcmVzdWx0CisgICAgICAgICMjIEl0ZXJhdGUgb3ZlciB0aGlzIGxpc3QgdHdpY2UKKyAg
ICAgICAgIyMgLSBFbWl0IHRoZSBzY2FsYXIgcmVzdWx0CisgICAgICAgICMjIC0gRW1pdCB0aGUg
dmVjdG9yIHJlc3VsdAogICAgICAgICBpPTAKICAgICAgICAgZm9yIHJlZ3R5cGUscmVnaWQsdG9z
cyxudW1yZWdzIGluIHJlZ3M6CiAgICAgICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc193cml0dGVu
KHJlZ2lkKSk6Ci0gICAgICAgICAgICAgICAgZ2VuX2RlZl9oZWxwZXJfb3BuKGYsIHRhZywgcmVn
dHlwZSwgcmVnaWQsIHRvc3MsIG51bXJlZ3MsIGkpCisgICAgICAgICAgICAgICAgaWYgKG5vdCBo
ZXhfY29tbW9uLmlzX2h2eF9yZWcocmVndHlwZSkpOgorICAgICAgICAgICAgICAgICAgICBnZW5f
ZGVmX2hlbHBlcl9vcG4oZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgdG9zcywgbnVtcmVncywgaSkK
ICAgICAgICAgICAgICAgICBpICs9IDEKIAogICAgICAgICAjIyBQdXQgdGhlIGVudiBiZXR3ZWVu
IHRoZSBvdXRwdXRzIGFuZCBpbnB1dHMKICAgICAgICAgZi53cml0ZSgnLCBlbnYnICkKICAgICAg
ICAgaSArPSAxCiAKKyAgICAgICAgIyBTZWNvbmQgcGFzcworICAgICAgICBmb3IgcmVndHlwZSxy
ZWdpZCx0b3NzLG51bXJlZ3MgaW4gcmVnczoKKyAgICAgICAgICAgIGlmIChoZXhfY29tbW9uLmlz
X3dyaXR0ZW4ocmVnaWQpKToKKyAgICAgICAgICAgICAgICBpZiAoaGV4X2NvbW1vbi5pc19odnhf
cmVnKHJlZ3R5cGUpKToKKyAgICAgICAgICAgICAgICAgICAgZ2VuX2RlZl9oZWxwZXJfb3BuKGYs
IHRhZywgcmVndHlwZSwgcmVnaWQsIHRvc3MsIG51bXJlZ3MsIGkpCisgICAgICAgICAgICAgICAg
ICAgIGkgKz0gMQorCiAgICAgICAgICMjIEdlbmVyYXRlIHRoZSBxZW11IHR5cGUgZm9yIGVhY2gg
aW5wdXQgb3BlcmFuZCAocmVncyBhbmQgaW1tZWRpYXRlcykKICAgICAgICAgZm9yIHJlZ3R5cGUs
cmVnaWQsdG9zcyxudW1yZWdzIGluIHJlZ3M6CiAgICAgICAgICAgICBpZiAoaGV4X2NvbW1vbi5p
c19yZWFkKHJlZ2lkKSk6CisgICAgICAgICAgICAgICAgaWYgKGhleF9jb21tb24uaXNfaHZ4X3Jl
ZyhyZWd0eXBlKSBhbmQKKyAgICAgICAgICAgICAgICAgICAgaGV4X2NvbW1vbi5pc19yZWFkd3Jp
dGUocmVnaWQpKToKKyAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAg
ICBnZW5fZGVmX2hlbHBlcl9vcG4oZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgdG9zcywgbnVtcmVn
cywgaSkKICAgICAgICAgICAgICAgICBpICs9IDEKICAgICAgICAgZm9yIGltbWxldHQsYml0cyxp
bW1zaGlmdCBpbiBpbW1zOgpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vZ2VuX3RjZ19mdW5j
cy5weSBiL3RhcmdldC9oZXhhZ29uL2dlbl90Y2dfZnVuY3MucHkKaW5kZXggY2E4YTgwMS4uNDhi
Y2Y4OSAxMDA3NTUKLS0tIGEvdGFyZ2V0L2hleGFnb24vZ2VuX3RjZ19mdW5jcy5weQorKysgYi90
YXJnZXQvaGV4YWdvbi9nZW5fdGNnX2Z1bmNzLnB5CkBAIC0xMTksMTAgKzExOSw5NSBAQCBkZWYg
Z2VucHRyX2RlY2woZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgcmVnbm8pOgogICAgICAgICAgICAg
ICAgIChyZWd0eXBlLCByZWdpZCwgcmVndHlwZSwgcmVnaWQpKQogICAgICAgICBlbHNlOgogICAg
ICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCisg
ICAgZWxpZiAocmVndHlwZSA9PSAiViIpOgorICAgICAgICBpZiAocmVnaWQgaW4geyJkZCJ9KToK
KyAgICAgICAgICAgIGYud3JpdGUoIiAgICBjb25zdCBpbnQgJXMlc04gPSBpbnNuLT5yZWdub1sl
ZF07XG4iICVcCisgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWdubykpCisgICAg
ICAgICAgICBmLndyaXRlKCIgICAgY29uc3QgaW50cHRyX3QgJXMlc1Zfb2ZmID1cbiIgJVwKKyAg
ICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgICAgIGlmIChoZXhfY29t
bW9uLmlzX3RtcF9yZXN1bHQodGFnKSk6CisgICAgICAgICAgICAgICAgZi53cml0ZSgiICAgICAg
ICBjdHhfdG1wX3ZyZWdfb2ZmKGN0eCwgJXMlc04sIDIsIHRydWUpO1xuIiAlIFwKKyAgICAgICAg
ICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkpCisgICAgICAgICAgICBlbHNlOgorICAgICAg
ICAgICAgICAgIGYud3JpdGUoIiAgICAgICAgY3R4X2Z1dHVyZV92cmVnX29mZihjdHgsICVzJXNO
LCIgJSBcCisgICAgICAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICAg
ICAgICAgIGYud3JpdGUoIiAyLCB0cnVlKTtcbiIpCisgICAgICAgICAgICBpZiAobm90IGhleF9j
b21tb24uc2tpcF9xZW11X2hlbHBlcih0YWcpKToKKyAgICAgICAgICAgICAgICBmLndyaXRlKCIg
ICAgVENHdl9wdHIgJXMlc1YgPSB0Y2dfdGVtcF9uZXdfcHRyKCk7XG4iICUgXAorICAgICAgICAg
ICAgICAgICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICAgICAgICAgIGYud3JpdGUoIiAg
ICB0Y2dfZ2VuX2FkZGlfcHRyKCVzJXNWLCBjcHVfZW52LCAlcyVzVl9vZmYpO1xuIiAlIFwKKyAg
ICAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWd0eXBlLCByZWdpZCkpCisgICAg
ICAgIGVsaWYgKHJlZ2lkIGluIHsidXUiLCAidnYiLCAieHgifSk6CisgICAgICAgICAgICBmLndy
aXRlKCIgICAgY29uc3QgaW50ICVzJXNOID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlXAorICAgICAg
ICAgICAgICAgIChyZWd0eXBlLCByZWdpZCwgcmVnbm8pKQorICAgICAgICAgICAgZi53cml0ZSgi
ICAgIGNvbnN0IGludHB0cl90ICVzJXNWX29mZiA9XG4iICUgXAorICAgICAgICAgICAgICAgICAo
cmVndHlwZSwgcmVnaWQpKQorICAgICAgICAgICAgZi53cml0ZSgiICAgICAgICBvZmZzZXRvZihD
UFVIZXhhZ29uU3RhdGUsICVzJXNWKTtcbiIgJSBcCisgICAgICAgICAgICAgICAgIChyZWd0eXBl
LCByZWdpZCkpCisgICAgICAgICAgICBpZiAobm90IGhleF9jb21tb24uc2tpcF9xZW11X2hlbHBl
cih0YWcpKToKKyAgICAgICAgICAgICAgICBmLndyaXRlKCIgICAgVENHdl9wdHIgJXMlc1YgPSB0
Y2dfdGVtcF9uZXdfcHRyKCk7XG4iICUgXAorICAgICAgICAgICAgICAgICAgICAocmVndHlwZSwg
cmVnaWQpKQorICAgICAgICAgICAgICAgIGYud3JpdGUoIiAgICB0Y2dfZ2VuX2FkZGlfcHRyKCVz
JXNWLCBjcHVfZW52LCAlcyVzVl9vZmYpO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAgICAgKHJl
Z3R5cGUsIHJlZ2lkLCByZWd0eXBlLCByZWdpZCkpCisgICAgICAgIGVsaWYgKHJlZ2lkIGluIHsi
cyIsICJ1IiwgInYiLCAidyJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICBjb25zdCBpbnQg
JXMlc04gPSBpbnNuLT5yZWdub1slZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWd0eXBl
LCByZWdpZCwgcmVnbm8pKQorICAgICAgICAgICAgZi53cml0ZSgiICAgIGNvbnN0IGludHB0cl90
ICVzJXNWX29mZiA9XG4iICUgXAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlZ3R5
cGUsIHJlZ2lkKSkKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICAgICAgdnJlZ19zcmNfb2ZmKGN0
eCwgJXMlc04pO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChyZWd0eXBl
LCByZWdpZCkpCisgICAgICAgICAgICBpZiAobm90IGhleF9jb21tb24uc2tpcF9xZW11X2hlbHBl
cih0YWcpKToKKyAgICAgICAgICAgICAgICBmLndyaXRlKCIgICAgVENHdl9wdHIgJXMlc1YgPSB0
Y2dfdGVtcF9uZXdfcHRyKCk7XG4iICUgXAorICAgICAgICAgICAgICAgICAgICAocmVndHlwZSwg
cmVnaWQpKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7ImQiLCAieCIsICJ5In0pOgorICAgICAg
ICAgICAgZi53cml0ZSgiICAgIGNvbnN0IGludCAlcyVzTiA9IGluc24tPnJlZ25vWyVkXTtcbiIg
JSBcCisgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWdubykpCisgICAgICAgICAg
ICBmLndyaXRlKCIgICAgY29uc3QgaW50cHRyX3QgJXMlc1Zfb2ZmID1cbiIgJSBcCisgICAgICAg
ICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgICAgIGlmIChoZXhfY29tbW9uLmlz
X3RtcF9yZXN1bHQodGFnKSk6CisgICAgICAgICAgICAgICAgZi53cml0ZSgiICAgICAgICBjdHhf
dG1wX3ZyZWdfb2ZmKGN0eCwgJXMlc04sIDEsIHRydWUpO1xuIiAlIFwKKyAgICAgICAgICAgICAg
ICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgICAgIGVsc2U6CisgICAgICAgICAgICAg
ICAgZi53cml0ZSgiICAgICAgICBjdHhfZnV0dXJlX3ZyZWdfb2ZmKGN0eCwgJXMlc04sIiAlXAor
ICAgICAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICAgICAgICAgIGYu
d3JpdGUoIiAxLCB0cnVlKTtcbiIpOworICAgICAgICAgICAgaWYgKG5vdCBoZXhfY29tbW9uLnNr
aXBfcWVtdV9oZWxwZXIodGFnKSk6CisgICAgICAgICAgICAgICAgZi53cml0ZSgiICAgIFRDR3Zf
cHRyICVzJXNWID0gdGNnX3RlbXBfbmV3X3B0cigpO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAg
ICAgKHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgICAgICAgICBmLndyaXRlKCIgICAgdGNnX2dl
bl9hZGRpX3B0ciglcyVzViwgY3B1X2VudiwgJXMlc1Zfb2ZmKTtcbiIgJSBcCisgICAgICAgICAg
ICAgICAgICAgIChyZWd0eXBlLCByZWdpZCwgcmVndHlwZSwgcmVnaWQpKQorICAgICAgICBlbHNl
OgorICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVn
aWQpCisgICAgZWxpZiAocmVndHlwZSA9PSAiUSIpOgorICAgICAgICBpZiAocmVnaWQgaW4geyJk
IiwgImUiLCAieCJ9KToKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICBjb25zdCBpbnQgJXMlc04g
PSBpbnNuLT5yZWdub1slZF07XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdp
ZCwgcmVnbm8pKQorICAgICAgICAgICAgZi53cml0ZSgiICAgIGNvbnN0IGludHB0cl90ICVzJXNW
X29mZiA9XG4iICUgXAorICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkpCisgICAgICAg
ICAgICBmLndyaXRlKCIgICAgICAgIG9mZnNldG9mKENQVUhleGFnb25TdGF0ZSxcbiIpCisgICAg
ICAgICAgICBmLndyaXRlKCIgICAgICAgICAgICAgICAgIGZ1dHVyZV9RUmVnc1slcyVzTl0pO1xu
IiAlIFwKKyAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICAgICAgaWYg
KG5vdCBoZXhfY29tbW9uLnNraXBfcWVtdV9oZWxwZXIodGFnKSk6CisgICAgICAgICAgICAgICAg
Zi53cml0ZSgiICAgIFRDR3ZfcHRyICVzJXNWID0gdGNnX3RlbXBfbmV3X3B0cigpO1xuIiAlIFwK
KyAgICAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgICAgICAgICBm
LndyaXRlKCIgICAgdGNnX2dlbl9hZGRpX3B0ciglcyVzViwgY3B1X2VudiwgJXMlc1Zfb2ZmKTtc
biIgJSBcCisgICAgICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCwgcmVndHlwZSwgcmVn
aWQpKQorICAgICAgICBlbGlmIChyZWdpZCBpbiB7InMiLCAidCIsICJ1IiwgInYifSk6CisgICAg
ICAgICAgICBmLndyaXRlKCIgICAgY29uc3QgaW50ICVzJXNOID0gaW5zbi0+cmVnbm9bJWRdO1xu
IiAlIFwKKyAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQsIHJlZ25vKSkKKyAgICAgICAg
ICAgIGYud3JpdGUoIiAgICBjb25zdCBpbnRwdHJfdCAlcyVzVl9vZmYgPVxuIiAlXAorICAgICAg
ICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkpCisgICAgICAgICAgICBmLndyaXRlKCIgICAgICAg
IG9mZnNldG9mKENQVUhleGFnb25TdGF0ZSwgUVJlZ3NbJXMlc05dKTtcbiIgJSBcCisgICAgICAg
ICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgICAgIGlmIChub3QgaGV4X2NvbW1v
bi5za2lwX3FlbXVfaGVscGVyKHRhZykpOgorICAgICAgICAgICAgICAgIGYud3JpdGUoIiAgICBU
Q0d2X3B0ciAlcyVzViA9IHRjZ190ZW1wX25ld19wdHIoKTtcbiIgJSBcCisgICAgICAgICAgICAg
ICAgICAgIChyZWd0eXBlLCByZWdpZCkpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBwcmlu
dCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKICAgICBlbHNlOgogICAg
ICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKIAotZGVm
IGdlbnB0cl9kZWNsX25ldyhmLHJlZ3R5cGUscmVnaWQscmVnbm8pOgorZGVmIGdlbnB0cl9kZWNs
X25ldyhmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCByZWdubyk6CiAgICAgaWYgKHJlZ3R5cGUgPT0g
Ik4iKToKICAgICAgICAgaWYgKHJlZ2lkIGluIHsicyIsICJ0In0pOgogICAgICAgICAgICAgZi53
cml0ZSgiICAgIFRDR3YgJXMlc04gPSBoZXhfbmV3X3ZhbHVlW2luc24tPnJlZ25vWyVkXV07XG4i
ICUgXApAQCAtMTM1LDYgKzIyMCwyMSBAQCBkZWYgZ2VucHRyX2RlY2xfbmV3KGYscmVndHlwZSxy
ZWdpZCxyZWdubyk6CiAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWdubykpCiAg
ICAgICAgIGVsc2U6CiAgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCBy
ZWd0eXBlLCByZWdpZCkKKyAgICBlbGlmIChyZWd0eXBlID09ICJPIik6CisgICAgICAgIGlmIChy
ZWdpZCA9PSAicyIpOgorICAgICAgICAgICAgZi53cml0ZSgiICAgIGNvbnN0IGludHB0cl90ICVz
JXNOX251bSA9IGluc24tPnJlZ25vWyVkXTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ3R5
cGUsIHJlZ2lkLCByZWdubykpCisgICAgICAgICAgICBpZiAoaGV4X2NvbW1vbi5za2lwX3FlbXVf
aGVscGVyKHRhZykpOgorICAgICAgICAgICAgICAgIGYud3JpdGUoIiAgICBjb25zdCBpbnRwdHJf
dCAlcyVzTl9vZmYgPVxuIiAlIFwKKyAgICAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lk
KSkKKyAgICAgICAgICAgICAgICBmLndyaXRlKCIgICAgICAgICBjdHhfZnV0dXJlX3ZyZWdfb2Zm
KGN0eCwgJXMlc05fbnVtLCIgJSBcCisgICAgICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdp
ZCkpCisgICAgICAgICAgICAgICAgZi53cml0ZSgiIDEsIHRydWUpO1xuIikKKyAgICAgICAgICAg
IGVsc2U6CisgICAgICAgICAgICAgICAgZi53cml0ZSgiICAgIFRDR3YgJXMlc04gPSB0Y2dfY29u
c3RhbnRfdGwoJXMlc05fbnVtKTsgLyogSEVSRSAqL1xuIiAlIFwKKyAgICAgICAgICAgICAgICAg
ICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWd0eXBlLCByZWdpZCkpCisgICAgICAgIGVsc2U6CisgICAg
ICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKICAg
ICBlbHNlOgogICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCBy
ZWdpZCkKIApAQCAtMTQ1LDcgKzI0NSw3IEBAIGRlZiBnZW5wdHJfZGVjbF9vcG4oZiwgdGFnLCBy
ZWd0eXBlLCByZWdpZCwgdG9zcywgbnVtcmVncywgaSk6CiAgICAgICAgIGlmIGhleF9jb21tb24u
aXNfb2xkX3ZhbChyZWd0eXBlLCByZWdpZCwgdGFnKToKICAgICAgICAgICAgIGdlbnB0cl9kZWNs
KGYsdGFnLCByZWd0eXBlLCByZWdpZCwgaSkKICAgICAgICAgZWxpZiBoZXhfY29tbW9uLmlzX25l
d192YWwocmVndHlwZSwgcmVnaWQsIHRhZyk6Ci0gICAgICAgICAgICBnZW5wdHJfZGVjbF9uZXco
ZixyZWd0eXBlLHJlZ2lkLGkpCisgICAgICAgICAgICBnZW5wdHJfZGVjbF9uZXcoZiwgdGFnLCBy
ZWd0eXBlLCByZWdpZCwgaSkKICAgICAgICAgZWxzZToKICAgICAgICAgICAgIHByaW50KCJCYWQg
cmVnaXN0ZXIgcGFyc2U6ICIscmVndHlwZSxyZWdpZCx0b3NzLG51bXJlZ3MpCiAgICAgZWxzZToK
QEAgLTE1OSw3ICsyNTksNyBAQCBkZWYgZ2VucHRyX2RlY2xfaW1tKGYsaW1tbGV0dCk6CiAgICAg
Zi53cml0ZSgiICAgIGludCAlcyA9IGluc24tPmltbWVkWyVkXTtcbiIgJSBcCiAgICAgICAgICho
ZXhfY29tbW9uLmltbV9uYW1lKGltbWxldHQpLCBpKSkKIAotZGVmIGdlbnB0cl9mcmVlKGYscmVn
dHlwZSxyZWdpZCxyZWdubyk6CitkZWYgZ2VucHRyX2ZyZWUoZiwgdGFnLCByZWd0eXBlLCByZWdp
ZCwgcmVnbm8pOgogICAgIGlmIChyZWd0eXBlID09ICJSIik6CiAgICAgICAgIGlmIChyZWdpZCBp
biB7ImRkIiwgInNzIiwgInR0IiwgInh4IiwgInl5In0pOgogICAgICAgICAgICAgZi53cml0ZSgi
ICAgIHRjZ190ZW1wX2ZyZWVfaTY0KCVzJXNWKTtcbiIgJSAocmVndHlwZSwgcmVnaWQpKQpAQCAt
MTgyLDMzICsyODIsNTEgQEAgZGVmIGdlbnB0cl9mcmVlKGYscmVndHlwZSxyZWdpZCxyZWdubyk6
CiAgICAgZWxpZiAocmVndHlwZSA9PSAiTSIpOgogICAgICAgICBpZiAocmVnaWQgIT0gInUiKToK
ICAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lk
KQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIlYiKToKKyAgICAgICAgaWYgKHJlZ2lkIGluIHsiZGQi
LCAidXUiLCAidnYiLCAieHgiLCBcCisgICAgICAgICAgICAgICAgICAgICAgImQiLCAicyIsICJ1
IiwgInYiLCAidyIsICJ4IiwgInkifSk6CisgICAgICAgICAgICBpZiAobm90IGhleF9jb21tb24u
c2tpcF9xZW11X2hlbHBlcih0YWcpKToKKyAgICAgICAgICAgICAgICBmLndyaXRlKCIgICAgdGNn
X3RlbXBfZnJlZV9wdHIoJXMlc1YpO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAgICAgKHJlZ3R5
cGUsIHJlZ2lkKSkKKyAgICAgICAgZWxzZToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0
ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIlEiKToK
KyAgICAgICAgaWYgKHJlZ2lkIGluIHsiZCIsICJlIiwgInMiLCAidCIsICJ1IiwgInYiLCAieCJ9
KToKKyAgICAgICAgICAgIGlmIChub3QgaGV4X2NvbW1vbi5za2lwX3FlbXVfaGVscGVyKHRhZykp
OgorICAgICAgICAgICAgICAgIGYud3JpdGUoIiAgICB0Y2dfdGVtcF9mcmVlX3B0ciglcyVzVik7
XG4iICUgXAorICAgICAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICBl
bHNlOgorICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwg
cmVnaWQpCiAgICAgZWxzZToKICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwg
cmVndHlwZSwgcmVnaWQpCiAKLWRlZiBnZW5wdHJfZnJlZV9uZXcoZixyZWd0eXBlLHJlZ2lkLHJl
Z25vKToKK2RlZiBnZW5wdHJfZnJlZV9uZXcoZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgcmVnbm8p
OgogICAgIGlmIChyZWd0eXBlID09ICJOIik6CiAgICAgICAgIGlmIChyZWdpZCBub3QgaW4geyJz
IiwgInQifSk6CiAgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0
eXBlLCByZWdpZCkKICAgICBlbGlmIChyZWd0eXBlID09ICJQIik6CiAgICAgICAgIGlmIChyZWdp
ZCBub3QgaW4geyJ0IiwgInUiLCAidiJ9KToKICAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0
ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQorICAgIGVsaWYgKHJlZ3R5cGUgPT0gIk8iKToK
KyAgICAgICAgaWYgKHJlZ2lkICE9ICJzIik6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lz
dGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKICAgICBlbHNlOgogICAgICAgICBwcmludCgi
QmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKIAogZGVmIGdlbnB0cl9mcmVl
X29wbihmLHJlZ3R5cGUscmVnaWQsaSx0YWcpOgogICAgIGlmIChoZXhfY29tbW9uLmlzX3BhaXIo
cmVnaWQpKToKLSAgICAgICAgZ2VucHRyX2ZyZWUoZixyZWd0eXBlLHJlZ2lkLGkpCisgICAgICAg
IGdlbnB0cl9mcmVlKGYsIHRhZywgcmVndHlwZSwgcmVnaWQsIGkpCiAgICAgZWxpZiAoaGV4X2Nv
bW1vbi5pc19zaW5nbGUocmVnaWQpKToKICAgICAgICAgaWYgaGV4X2NvbW1vbi5pc19vbGRfdmFs
KHJlZ3R5cGUsIHJlZ2lkLCB0YWcpOgotICAgICAgICAgICAgZ2VucHRyX2ZyZWUoZixyZWd0eXBl
LHJlZ2lkLGkpCisgICAgICAgICAgICBnZW5wdHJfZnJlZShmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lk
LCBpKQogICAgICAgICBlbGlmIGhleF9jb21tb24uaXNfbmV3X3ZhbChyZWd0eXBlLCByZWdpZCwg
dGFnKToKLSAgICAgICAgICAgIGdlbnB0cl9mcmVlX25ldyhmLHJlZ3R5cGUscmVnaWQsaSkKKyAg
ICAgICAgICAgIGdlbnB0cl9mcmVlX25ldyhmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCBpKQogICAg
ICAgICBlbHNlOgogICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIixyZWd0
eXBlLHJlZ2lkLHRvc3MsbnVtcmVncykKICAgICBlbHNlOgogICAgICAgICBwcmludCgiQmFkIHJl
Z2lzdGVyIHBhcnNlOiAiLHJlZ3R5cGUscmVnaWQsdG9zcyxudW1yZWdzKQogCi1kZWYgZ2VucHRy
X3NyY19yZWFkKGYscmVndHlwZSxyZWdpZCk6CitkZWYgZ2VucHRyX3NyY19yZWFkKGYsIHRhZywg
cmVndHlwZSwgcmVnaWQpOgogICAgIGlmIChyZWd0eXBlID09ICJSIik6CiAgICAgICAgIGlmIChy
ZWdpZCBpbiB7InNzIiwgInR0IiwgInh4IiwgInl5In0pOgogICAgICAgICAgICAgZi53cml0ZSgi
ICAgIHRjZ19nZW5fY29uY2F0X2kzMl9pNjQoJXMlc1YsIGhleF9ncHJbJXMlc05dLFxuIiAlIFwK
QEAgLTIzOCw2ICszNTYsNDcgQEAgZGVmIGdlbnB0cl9zcmNfcmVhZChmLHJlZ3R5cGUscmVnaWQp
OgogICAgIGVsaWYgKHJlZ3R5cGUgPT0gIk0iKToKICAgICAgICAgaWYgKHJlZ2lkICE9ICJ1Iik6
CiAgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdp
ZCkKKyAgICBlbGlmIChyZWd0eXBlID09ICJWIik6CisgICAgICAgIGlmIChyZWdpZCBpbiB7InV1
IiwgInZ2IiwgInh4In0pOgorICAgICAgICAgICAgZi53cml0ZSgiICAgIHRjZ19nZW5fZ3ZlY19t
b3YoTU9fNjQsICVzJXNWX29mZixcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJl
Z2lkKSkKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICAgICAgdnJlZ19zcmNfb2ZmKGN0eCwgJXMl
c04pLFxuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQpKQorICAgICAgICAg
ICAgZi53cml0ZSgiICAgICAgICBzaXplb2YoTU1WZWN0b3IpLCBzaXplb2YoTU1WZWN0b3IpKTtc
biIpCisgICAgICAgICAgICBmLndyaXRlKCIgICAgdGNnX2dlbl9ndmVjX21vdihNT182NCxcbiIp
CisgICAgICAgICAgICBmLndyaXRlKCIgICAgICAgICVzJXNWX29mZiArIHNpemVvZihNTVZlY3Rv
ciksXG4iICUgXAorICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkpCisgICAgICAgICAg
ICBmLndyaXRlKCIgICAgICAgIHZyZWdfc3JjX29mZihjdHgsICVzJXNOIF4gMSksXG4iICUgXAor
ICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkpCisgICAgICAgICAgICBmLndyaXRlKCIg
ICAgICAgIHNpemVvZihNTVZlY3RvciksIHNpemVvZihNTVZlY3RvcikpO1xuIikKKyAgICAgICAg
ZWxpZiAocmVnaWQgaW4geyJzIiwgInUiLCAidiIsICJ3In0pOgorICAgICAgICAgICAgaWYgKG5v
dCBoZXhfY29tbW9uLnNraXBfcWVtdV9oZWxwZXIodGFnKSk6CisgICAgICAgICAgICAgICAgZi53
cml0ZSgiICAgIHRjZ19nZW5fYWRkaV9wdHIoJXMlc1YsIGNwdV9lbnYsICVzJXNWX29mZik7XG4i
ICUgXAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCBy
ZWd0eXBlLCByZWdpZCkpCisgICAgICAgIGVsaWYgKHJlZ2lkIGluIHsieCIsICJ5In0pOgorICAg
ICAgICAgICAgZi53cml0ZSgiICAgIHRjZ19nZW5fZ3ZlY19tb3YoTU9fNjQsICVzJXNWX29mZixc
biIgJSBcCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkpCisg
ICAgICAgICAgICBmLndyaXRlKCIgICAgICAgIHZyZWdfc3JjX29mZihjdHgsICVzJXNOKSxcbiIg
JSBcCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkpCisgICAg
ICAgICAgICBmLndyaXRlKCIgICAgICAgIHNpemVvZihNTVZlY3RvciksIHNpemVvZihNTVZlY3Rv
cikpO1xuIikKKyAgICAgICAgICAgIGlmIChub3QgaGV4X2NvbW1vbi5za2lwX3FlbXVfaGVscGVy
KHRhZykpOgorICAgICAgICAgICAgICAgIGYud3JpdGUoIiAgICB0Y2dfZ2VuX2FkZGlfcHRyKCVz
JXNWLCBjcHVfZW52LCAlcyVzVl9vZmYpO1xuIiAlIFwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIChyZWd0eXBlLCByZWdpZCwgcmVndHlwZSwgcmVnaWQpKQorICAgICAgICBlbHNl
OgorICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVn
aWQpCisgICAgZWxpZiAocmVndHlwZSA9PSAiUSIpOgorICAgICAgICBpZiAocmVnaWQgaW4geyJz
IiwgInQiLCAidSIsICJ2In0pOgorICAgICAgICAgICAgaWYgKG5vdCBoZXhfY29tbW9uLnNraXBf
cWVtdV9oZWxwZXIodGFnKSk6CisgICAgICAgICAgICAgICAgZi53cml0ZSgiICAgIHRjZ19nZW5f
YWRkaV9wdHIoJXMlc1YsIGNwdV9lbnYsICVzJXNWX29mZik7XG4iICUgXAorICAgICAgICAgICAg
ICAgICAgICAocmVndHlwZSwgcmVnaWQsIHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAgZWxpZiAo
cmVnaWQgaW4geyJ4In0pOgorICAgICAgICAgICAgZi53cml0ZSgiICAgIHRjZ19nZW5fZ3ZlY19t
b3YoTU9fNjQsICVzJXNWX29mZixcbiIgJSBcCisgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJl
Z2lkKSkKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICAgICAgb2Zmc2V0b2YoQ1BVSGV4YWdvblN0
YXRlLCBRUmVnc1slcyVzTl0pLFxuIiAlIFwKKyAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVn
aWQpKQorICAgICAgICAgICAgZi53cml0ZSgiICAgICAgICBzaXplb2YoTU1RUmVnKSwgc2l6ZW9m
KE1NUVJlZykpO1xuIikKKyAgICAgICAgZWxzZToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVn
aXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQogICAgIGVsc2U6CiAgICAgICAgIHByaW50
KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQogCkBAIC0yNDgsMTUgKzQw
NywxOCBAQCBkZWYgZ2VucHRyX3NyY19yZWFkX25ldyhmLHJlZ3R5cGUscmVnaWQpOgogICAgIGVs
aWYgKHJlZ3R5cGUgPT0gIlAiKToKICAgICAgICAgaWYgKHJlZ2lkIG5vdCBpbiB7InQiLCAidSIs
ICJ2In0pOgogICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlw
ZSwgcmVnaWQpCisgICAgZWxpZiAocmVndHlwZSA9PSAiTyIpOgorICAgICAgICBpZiAocmVnaWQg
IT0gInMiKToKKyAgICAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6ICIsIHJlZ3R5
cGUsIHJlZ2lkKQogICAgIGVsc2U6CiAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFyc2U6
ICIsIHJlZ3R5cGUsIHJlZ2lkKQogCiBkZWYgZ2VucHRyX3NyY19yZWFkX29wbihmLHJlZ3R5cGUs
cmVnaWQsdGFnKToKICAgICBpZiAoaGV4X2NvbW1vbi5pc19wYWlyKHJlZ2lkKSk6Ci0gICAgICAg
IGdlbnB0cl9zcmNfcmVhZChmLHJlZ3R5cGUscmVnaWQpCisgICAgICAgIGdlbnB0cl9zcmNfcmVh
ZChmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkKQogICAgIGVsaWYgKGhleF9jb21tb24uaXNfc2luZ2xl
KHJlZ2lkKSk6CiAgICAgICAgIGlmIGhleF9jb21tb24uaXNfb2xkX3ZhbChyZWd0eXBlLCByZWdp
ZCwgdGFnKToKLSAgICAgICAgICAgIGdlbnB0cl9zcmNfcmVhZChmLHJlZ3R5cGUscmVnaWQpCisg
ICAgICAgICAgICBnZW5wdHJfc3JjX3JlYWQoZiwgdGFnLCByZWd0eXBlLCByZWdpZCkKICAgICAg
ICAgZWxpZiBoZXhfY29tbW9uLmlzX25ld192YWwocmVndHlwZSwgcmVnaWQsIHRhZyk6CiAgICAg
ICAgICAgICBnZW5wdHJfc3JjX3JlYWRfbmV3KGYscmVndHlwZSxyZWdpZCkKICAgICAgICAgZWxz
ZToKQEAgLTMzNCwxMSArNDk2LDY4IEBAIGRlZiBnZW5wdHJfZHN0X3dyaXRlKGYsIHRhZywgcmVn
dHlwZSwgcmVnaWQpOgogICAgIGVsc2U6CiAgICAgICAgIHByaW50KCJCYWQgcmVnaXN0ZXIgcGFy
c2U6ICIsIHJlZ3R5cGUsIHJlZ2lkKQogCitkZWYgZ2VucHRyX2RzdF93cml0ZV9leHQoZiwgdGFn
LCByZWd0eXBlLCByZWdpZCwgbmV3dj0iMCIpOgorICAgIGlmIChyZWd0eXBlID09ICJWIik6Cisg
ICAgICAgIGlmIChyZWdpZCBpbiB7ImRkIiwgInh4IiwgInl5In0pOgorICAgICAgICAgICAgaWYg
KCdBX0NPTkRFWEVDJyBpbiBoZXhfY29tbW9uLmF0dHJpYmRpY3RbdGFnXSk6CisgICAgICAgICAg
ICAgICAgaXNfcHJlZGljYXRlZCA9ICJ0cnVlIgorICAgICAgICAgICAgZWxzZToKKyAgICAgICAg
ICAgICAgICBpc19wcmVkaWNhdGVkID0gImZhbHNlIgorICAgICAgICAgICAgZi53cml0ZSgiICAg
IGdlbl9sb2dfdnJlZ193cml0ZV9wYWlyKGN0eCwgJXMlc1Zfb2ZmLCAlcyVzTiwgIiAlIFwKKyAg
ICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQsIHJlZ3R5cGUsIHJlZ2lkKSkKKyAgICAgICAg
ICAgIGYud3JpdGUoIiVzLCBpbnNuLT5zbG90LCAlcyk7XG4iICUgXAorICAgICAgICAgICAgICAg
IChuZXd2LCBpc19wcmVkaWNhdGVkKSkKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICBjdHhfbG9n
X3ZyZWdfd3JpdGVfcGFpcihjdHgsICVzJXNOLCAlcyxcbiIgJSBcCisgICAgICAgICAgICAgICAg
KHJlZ3R5cGUsIHJlZ2lkLCBuZXd2KSkKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICAgICAgJXMp
O1xuIiAlIChpc19wcmVkaWNhdGVkKSkKKyAgICAgICAgZWxpZiAocmVnaWQgaW4geyJkIiwgIngi
LCAieSJ9KToKKyAgICAgICAgICAgIGlmICgnQV9DT05ERVhFQycgaW4gaGV4X2NvbW1vbi5hdHRy
aWJkaWN0W3RhZ10pOgorICAgICAgICAgICAgICAgIGlzX3ByZWRpY2F0ZWQgPSAidHJ1ZSIKKyAg
ICAgICAgICAgIGVsc2U6CisgICAgICAgICAgICAgICAgaXNfcHJlZGljYXRlZCA9ICJmYWxzZSIK
KyAgICAgICAgICAgIGYud3JpdGUoIiAgICBnZW5fbG9nX3ZyZWdfd3JpdGUoY3R4LCAlcyVzVl9v
ZmYsICVzJXNOLCAlcywgIiAlIFwKKyAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQsIHJl
Z3R5cGUsIHJlZ2lkLCBuZXd2KSkKKyAgICAgICAgICAgIGYud3JpdGUoImluc24tPnNsb3QsICVz
KTtcbiIgJSBcCisgICAgICAgICAgICAgICAgKGlzX3ByZWRpY2F0ZWQpKQorICAgICAgICAgICAg
Zi53cml0ZSgiICAgIGN0eF9sb2dfdnJlZ193cml0ZShjdHgsICVzJXNOLCAlcywgJXMpO1xuIiAl
IFwKKyAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQsIG5ld3YsIGlzX3ByZWRpY2F0ZWQp
KQorICAgICAgICBlbHNlOgorICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3RlciBwYXJzZTog
IiwgcmVndHlwZSwgcmVnaWQpCisgICAgZWxpZiAocmVndHlwZSA9PSAiUSIpOgorICAgICAgICBp
ZiAocmVnaWQgaW4geyJkIiwgImUiLCAieCJ9KToKKyAgICAgICAgICAgIGlmICgnQV9DT05ERVhF
QycgaW4gaGV4X2NvbW1vbi5hdHRyaWJkaWN0W3RhZ10pOgorICAgICAgICAgICAgICAgIGlzX3By
ZWRpY2F0ZWQgPSAidHJ1ZSIKKyAgICAgICAgICAgIGVsc2U6CisgICAgICAgICAgICAgICAgaXNf
cHJlZGljYXRlZCA9ICJmYWxzZSIKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICBnZW5fbG9nX3Fy
ZWdfd3JpdGUoJXMlc1Zfb2ZmLCAlcyVzTiwgJXMsICIgJSBcCisgICAgICAgICAgICAgICAgKHJl
Z3R5cGUsIHJlZ2lkLCByZWd0eXBlLCByZWdpZCwgbmV3dikpCisgICAgICAgICAgICBmLndyaXRl
KCJpbnNuLT5zbG90LCAlcyk7XG4iICUgKGlzX3ByZWRpY2F0ZWQpKQorICAgICAgICAgICAgZi53
cml0ZSgiICAgIGN0eF9sb2dfcXJlZ193cml0ZShjdHgsICVzJXNOLCAlcyk7XG4iICUgXAorICAg
ICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCwgaXNfcHJlZGljYXRlZCkpCisgICAgICAgIGVs
c2U6CisgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCBy
ZWdpZCkKKyAgICBlbHNlOgorICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCBy
ZWd0eXBlLCByZWdpZCkKKwogZGVmIGdlbnB0cl9kc3Rfd3JpdGVfb3BuKGYscmVndHlwZSwgcmVn
aWQsIHRhZyk6CiAgICAgaWYgKGhleF9jb21tb24uaXNfcGFpcihyZWdpZCkpOgotICAgICAgICBn
ZW5wdHJfZHN0X3dyaXRlKGYsIHRhZywgcmVndHlwZSwgcmVnaWQpCisgICAgICAgIGlmIChoZXhf
Y29tbW9uLmlzX2h2eF9yZWcocmVndHlwZSkpOgorICAgICAgICAgICAgaWYgKGhleF9jb21tb24u
aXNfdG1wX3Jlc3VsdCh0YWcpKToKKyAgICAgICAgICAgICAgICBnZW5wdHJfZHN0X3dyaXRlX2V4
dChmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCAiRVhUX1RNUCIpCisgICAgICAgICAgICBlbHNlOgor
ICAgICAgICAgICAgICAgIGdlbnB0cl9kc3Rfd3JpdGVfZXh0KGYsIHRhZywgcmVndHlwZSwgcmVn
aWQpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBnZW5wdHJfZHN0X3dyaXRlKGYsIHRhZywg
cmVndHlwZSwgcmVnaWQpCiAgICAgZWxpZiAoaGV4X2NvbW1vbi5pc19zaW5nbGUocmVnaWQpKToK
LSAgICAgICAgZ2VucHRyX2RzdF93cml0ZShmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkKQorICAgICAg
ICBpZiAoaGV4X2NvbW1vbi5pc19odnhfcmVnKHJlZ3R5cGUpKToKKyAgICAgICAgICAgIGlmICho
ZXhfY29tbW9uLmlzX25ld19yZXN1bHQodGFnKSk6CisgICAgICAgICAgICAgICAgZ2VucHRyX2Rz
dF93cml0ZV9leHQoZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgIkVYVF9ORVciKQorICAgICAgICAg
ICAgaWYgKGhleF9jb21tb24uaXNfdG1wX3Jlc3VsdCh0YWcpKToKKyAgICAgICAgICAgICAgICBn
ZW5wdHJfZHN0X3dyaXRlX2V4dChmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCAiRVhUX1RNUCIpCisg
ICAgICAgICAgICBlbHNlOgorICAgICAgICAgICAgICAgIGdlbnB0cl9kc3Rfd3JpdGVfZXh0KGYs
IHRhZywgcmVndHlwZSwgcmVnaWQsICJFWFRfREZMIikKKyAgICAgICAgZWxzZToKKyAgICAgICAg
ICAgIGdlbnB0cl9kc3Rfd3JpdGUoZiwgdGFnLCByZWd0eXBlLCByZWdpZCkKICAgICBlbHNlOgog
ICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLHJlZ3R5cGUscmVnaWQsdG9zcyxu
dW1yZWdzKQogCkBAIC00MDksMTMgKzYyOCwyNCBAQCBkZWYgZ2VuX3RjZ19mdW5jKGYsIHRhZywg
cmVncywgaW1tcyk6CiAgICAgICAgICMjIElmIHRoZXJlIGlzIGEgc2NhbGFyIHJlc3VsdCwgaXQg
aXMgdGhlIHJldHVybiB0eXBlCiAgICAgICAgIGZvciByZWd0eXBlLHJlZ2lkLHRvc3MsbnVtcmVn
cyBpbiByZWdzOgogICAgICAgICAgICAgaWYgKGhleF9jb21tb24uaXNfd3JpdHRlbihyZWdpZCkp
OgorICAgICAgICAgICAgICAgIGlmIChoZXhfY29tbW9uLmlzX2h2eF9yZWcocmVndHlwZSkpOgor
ICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgIGdlbl9oZWxwZXJf
Y2FsbF9vcG4oZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgdG9zcywgbnVtcmVncywgaSkKICAgICAg
ICAgICAgICAgICBpICs9IDEKICAgICAgICAgaWYgKGkgPiAwKTogZi53cml0ZSgiLCAiKQogICAg
ICAgICBmLndyaXRlKCJjcHVfZW52IikKICAgICAgICAgaT0xCiAgICAgICAgIGZvciByZWd0eXBl
LHJlZ2lkLHRvc3MsbnVtcmVncyBpbiByZWdzOgorICAgICAgICAgICAgaWYgKGhleF9jb21tb24u
aXNfd3JpdHRlbihyZWdpZCkpOgorICAgICAgICAgICAgICAgIGlmIChub3QgaGV4X2NvbW1vbi5p
c19odnhfcmVnKHJlZ3R5cGUpKToKKyAgICAgICAgICAgICAgICAgICAgY29udGludWUKKyAgICAg
ICAgICAgICAgICBnZW5faGVscGVyX2NhbGxfb3BuKGYsIHRhZywgcmVndHlwZSwgcmVnaWQsIHRv
c3MsIG51bXJlZ3MsIGkpCisgICAgICAgICAgICAgICAgaSArPSAxCisgICAgICAgIGZvciByZWd0
eXBlLHJlZ2lkLHRvc3MsbnVtcmVncyBpbiByZWdzOgogICAgICAgICAgICAgaWYgKGhleF9jb21t
b24uaXNfcmVhZChyZWdpZCkpOgorICAgICAgICAgICAgICAgIGlmIChoZXhfY29tbW9uLmlzX2h2
eF9yZWcocmVndHlwZSkgYW5kCisgICAgICAgICAgICAgICAgICAgIGhleF9jb21tb24uaXNfcmVh
ZHdyaXRlKHJlZ2lkKSk6CisgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAg
ICAgICAgZ2VuX2hlbHBlcl9jYWxsX29wbihmLCB0YWcsIHJlZ3R5cGUsIHJlZ2lkLCB0b3NzLCBu
dW1yZWdzLCBpKQogICAgICAgICAgICAgICAgIGkgKz0gMQogICAgICAgICBmb3IgaW1tbGV0dCxi
aXRzLGltbXNoaWZ0IGluIGltbXM6Ci0tIAoyLjcuNAoK

