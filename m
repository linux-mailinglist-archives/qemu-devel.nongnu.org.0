Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id AC10E67A8EB
	for <lists+qemu-devel@lfdr.de>; Wed, 25 Jan 2023 03:43:54 +0100 (CET)
Received: from localhost ([::1] helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces@nongnu.org>)
	id 1pKVkF-0006kt-4h; Tue, 24 Jan 2023 21:42:39 -0500
Received: from eggs.gnu.org ([2001:470:142:3::10])
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1pKVk9-0006ic-OB
 for qemu-devel@nongnu.org; Tue, 24 Jan 2023 21:42:34 -0500
Received: from mx0b-0031df01.pphosted.com ([205.220.180.131])
 by eggs.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1pKVk5-0007A2-SU
 for qemu-devel@nongnu.org; Tue, 24 Jan 2023 21:42:33 -0500
Received: from pps.filterd (m0279871.ppops.net [127.0.0.1])
 by mx0a-0031df01.pphosted.com (8.17.1.19/8.17.1.19) with ESMTP id
 30P2NWYp004563; Wed, 25 Jan 2023 02:42:19 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=quicinc.com;
 h=from : to : cc :
 subject : date : message-id : in-reply-to : references : mime-version :
 content-type : content-transfer-encoding; s=qcppdkim1;
 bh=++v0VdKe81M38SJcDDTMFvWXyiH04obubmNtH3vn+jA=;
 b=ZRCJsa9cIxXtOPY7aUkWFxmZlWvGRUhf1s1TbXZ3mm01LqPcEGIEGFW0FoEZD/nhmFCN
 WSrL2u9XHO30JBRTdF5sC7OMx53/ayTfMEYK3goIGQcGk0+kCH8nVAL6ZHk+qYiEKNY0
 n/JjpJmqHUPzzzpgfljKUSCxpDWghZwI3rgTEw8dbBUExqBYXLj9VLZM/HoVynGxFBfg
 X2rFKGZCmh3mOIfHp+6Mh/uhJqnO4QlUKUq9LzekbQATPhhQCea0OM3MnV54aTF37KW2
 AQcOQXYT98mIAqG0stfQYvO2T6aEywFBaqCQAXQyTmaDnN70vK5/iQkS9Nq/xJ7PU0+V FA== 
Received: from nalasppmta02.qualcomm.com (Global_NAT1.qualcomm.com
 [129.46.96.20])
 by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 3nag309bk0-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Wed, 25 Jan 2023 02:42:18 +0000
Received: from pps.filterd (NALASPPMTA02.qualcomm.com [127.0.0.1])
 by NALASPPMTA02.qualcomm.com (8.17.1.5/8.17.1.5) with ESMTP id 30P2bZuf030899; 
 Wed, 25 Jan 2023 02:42:17 GMT
Received: from pps.reinject (localhost [127.0.0.1])
 by NALASPPMTA02.qualcomm.com (PPS) with ESMTP id 3n894kr7ep-1;
 Wed, 25 Jan 2023 02:42:17 +0000
Received: from NALASPPMTA02.qualcomm.com (NALASPPMTA02.qualcomm.com
 [127.0.0.1])
 by pps.reinject (8.17.1.5/8.17.1.5) with ESMTP id 30P2gHvm002334;
 Wed, 25 Jan 2023 02:42:17 GMT
Received: from hu-devc-lv-u18-c.qualcomm.com (hu-tsimpson-lv.qualcomm.com
 [10.47.235.220])
 by NALASPPMTA02.qualcomm.com (PPS) with ESMTP id 30P2gHZJ002321;
 Wed, 25 Jan 2023 02:42:17 +0000
Received: by hu-devc-lv-u18-c.qualcomm.com (Postfix, from userid 47164)
 id 9535150011A; Tue, 24 Jan 2023 18:42:16 -0800 (PST)
From: Taylor Simpson <tsimpson@quicinc.com>
To: qemu-devel@nongnu.org
Cc: tsimpson@quicinc.com, richard.henderson@linaro.org, philmd@linaro.org,
 ale@rev.ng, anjo@rev.ng, bcain@quicinc.com, quic_mathbern@quicinc.com
Subject: [PATCH v4 13/13] Hexagon (target/hexagon) Improve code gen for
 predicated HVX instructions
Date: Tue, 24 Jan 2023 18:42:15 -0800
Message-Id: <20230125024215.10430-14-tsimpson@quicinc.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20230125024215.10430-1-tsimpson@quicinc.com>
References: <20230125024215.10430-1-tsimpson@quicinc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
X-QCInternal: smtphost
X-QCInternal: smtphost
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-ORIG-GUID: -CGvrWL0EzP3y7QnFvUnRDaCvbD15cuC
X-Proofpoint-GUID: -CGvrWL0EzP3y7QnFvUnRDaCvbD15cuC
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.219,Aquarius:18.0.930,Hydra:6.0.562,FMLib:17.11.122.1
 definitions=2023-01-24_17,2023-01-24_01,2022-06-22_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 spamscore=0 mlxscore=0
 suspectscore=0 bulkscore=0 adultscore=0 phishscore=0 lowpriorityscore=0
 mlxlogscore=379 clxscore=1015 priorityscore=1501 impostorscore=0
 malwarescore=0 classifier=spam adjust=0 reason=mlx scancount=1
 engine=8.12.0-2212070000 definitions=main-2301250020
Received-SPF: pass client-ip=205.220.180.131;
 envelope-from=tsimpson@qualcomm.com; helo=mx0b-0031df01.pphosted.com
X-Spam_score_int: -17
X-Spam_score: -1.8
X-Spam_bar: -
X-Spam_report: (-1.8 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, HEADER_FROM_DIFFERENT_DOMAINS=0.248,
 SPF_HELO_NONE=0.001, SPF_PASS=-0.001 autolearn=no autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org

VGhlIGZvbGxvd2luZyBpbXByb3ZlbWVudHMgYXJlIG1hZGUgZm9yIHByZWRpY2F0ZWQgSFZYIGlu
c3RydWN0aW9ucwogICAgRHVyaW5nIGdlbl9jb21taXRfaHZ4LCB1bmNvbmRpdGlvbmFsbHkgbW92
ZSB0aGUgIm5ldyIgdmFsdWUgaW50bwogICAgICAgIHRoZSBkZXN0CiAgICBEb24ndCBzZXQgc2xv
dF9jYW5jZWxsZWQKICAgIFJlbW92ZSBydW50aW1lIGJvb2trZWVwaW5nIG9mIHdoaWNoIHJlZ2lz
dGVycyB3ZXJlIHVwZGF0ZWQKICAgIFJlZHVjZSB0aGUgY2FzZXMgd2hlcmUgZ2VuX2xvZ192cmVn
X3dyaXRlW19wYWlyXSBpcyBjYWxsZWQKICAgICAgICBJdCdzIG9ubHkgbmVlZGVkIGZvciBzcGVj
aWFsIG9wZXJhbmRzIFZ4eFYgYW5kIFZ5VgogICAgUmVtb3ZlIGdlbl9sb2dfcXJlZ193cml0ZQoK
U2lnbmVkLW9mZi1ieTogVGF5bG9yIFNpbXBzb24gPHRzaW1wc29uQHF1aWNpbmMuY29tPgotLS0K
IHRhcmdldC9oZXhhZ29uL2NwdS5oICAgICAgICAgICAgICAgIHwgIDMgLS0KIHRhcmdldC9oZXhh
Z29uL2dlbl90Y2dfaHZ4LmggICAgICAgIHwgMTcgKy0tLS0tLS0KIHRhcmdldC9oZXhhZ29uL3Ry
YW5zbGF0ZS5oICAgICAgICAgIHwgMTYgKysrLS0tLS0KIHRhcmdldC9oZXhhZ29uL2dlbnB0ci5j
ICAgICAgICAgICAgIHwgNTEgKystLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiB0YXJnZXQvaGV4YWdv
bi90cmFuc2xhdGUuYyAgICAgICAgICB8IDYwICsrKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
CiB0YXJnZXQvaGV4YWdvbi9SRUFETUUgICAgICAgICAgICAgICB8IDI4ICsrKystLS0tLS0tLS0t
CiB0YXJnZXQvaGV4YWdvbi9nZW5fYW5hbHl6ZV9mdW5jcy5weSB8ICAzICstCiB0YXJnZXQvaGV4
YWdvbi9nZW5fdGNnX2Z1bmNzLnB5ICAgICB8IDMyICsrKystLS0tLS0tLS0tLQogOCBmaWxlcyBj
aGFuZ2VkLCAzMyBpbnNlcnRpb25zKCspLCAxNzcgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEv
dGFyZ2V0L2hleGFnb24vY3B1LmggYi90YXJnZXQvaGV4YWdvbi9jcHUuaAppbmRleCA4ZGY1YjVh
MjM2Li40MzIwNmY4YmNlIDEwMDY0NAotLS0gYS90YXJnZXQvaGV4YWdvbi9jcHUuaAorKysgYi90
YXJnZXQvaGV4YWdvbi9jcHUuaApAQCAtMTEwLDExICsxMTAsOCBAQCB0eXBlZGVmIHN0cnVjdCBD
UFVBcmNoU3RhdGUgewogICAgIE1NVmVjdG9yIGZ1dHVyZV9WUmVnc1tWRUNUT1JfVEVNUFNfTUFY
XSBRRU1VX0FMSUdORUQoMTYpOwogICAgIE1NVmVjdG9yIHRtcF9WUmVnc1tWRUNUT1JfVEVNUFNf
TUFYXSBRRU1VX0FMSUdORUQoMTYpOwogCi0gICAgVlJlZ01hc2sgVlJlZ3NfdXBkYXRlZDsKLQog
ICAgIE1NUVJlZyBRUmVnc1tOVU1fUVJFR1NdIFFFTVVfQUxJR05FRCgxNik7CiAgICAgTU1RUmVn
IGZ1dHVyZV9RUmVnc1tOVU1fUVJFR1NdIFFFTVVfQUxJR05FRCgxNik7Ci0gICAgUVJlZ01hc2sg
UVJlZ3NfdXBkYXRlZDsKIAogICAgIC8qIFRlbXBvcmFyaWVzIHVzZWQgd2l0aGluIGluc3RydWN0
aW9ucyAqLwogICAgIE1NVmVjdG9yUGFpciBWdXVWIFFFTVVfQUxJR05FRCgxNik7CmRpZmYgLS1n
aXQgYS90YXJnZXQvaGV4YWdvbi9nZW5fdGNnX2h2eC5oIGIvdGFyZ2V0L2hleGFnb24vZ2VuX3Rj
Z19odnguaAppbmRleCAwODNmNGQ5MmM2Li4zMTU0YzY1Y2UxIDEwMDY0NAotLS0gYS90YXJnZXQv
aGV4YWdvbi9nZW5fdGNnX2h2eC5oCisrKyBiL3RhcmdldC9oZXhhZ29uL2dlbl90Y2dfaHZ4LmgK
QEAgLTEsNSArMSw1IEBACiAvKgotICogIENvcHlyaWdodChjKSAyMDE5LTIwMjIgUXVhbGNvbW0g
SW5ub3ZhdGlvbiBDZW50ZXIsIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KKyAqICBDb3B5cmln
aHQoYykgMjAxOS0yMDIzIFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFsbCBSaWdo
dHMgUmVzZXJ2ZWQuCiAgKgogICogIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3Ug
Y2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAgKiAgaXQgdW5kZXIgdGhlIHRlcm1z
IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKQEAgLTEz
MywxNyArMTMzLDEyIEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBhc3NlcnRfdmhpc3RfdG1wKERpc2Fz
Q29udGV4dCAqY3R4KQogICAgIGRvIHsgXAogICAgICAgICBUQ0d2IGxzYiA9IHRjZ190ZW1wX25l
dygpOyBcCiAgICAgICAgIFRDR0xhYmVsICpmYWxzZV9sYWJlbCA9IGdlbl9uZXdfbGFiZWwoKTsg
XAotICAgICAgICBUQ0dMYWJlbCAqZW5kX2xhYmVsID0gZ2VuX25ld19sYWJlbCgpOyBcCiAgICAg
ICAgIHRjZ19nZW5fYW5kaV90bChsc2IsIFBzViwgMSk7IFwKICAgICAgICAgdGNnX2dlbl9icmNv
bmRpX3RsKFRDR19DT05EX05FLCBsc2IsIFBSRUQsIGZhbHNlX2xhYmVsKTsgXAogICAgICAgICB0
Y2dfdGVtcF9mcmVlKGxzYik7IFwKICAgICAgICAgdGNnX2dlbl9ndmVjX21vdihNT182NCwgVmRW
X29mZiwgVnVWX29mZiwgXAogICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVvZihNTVZlY3Rv
ciksIHNpemVvZihNTVZlY3RvcikpOyBcCi0gICAgICAgIHRjZ19nZW5fYnIoZW5kX2xhYmVsKTsg
XAogICAgICAgICBnZW5fc2V0X2xhYmVsKGZhbHNlX2xhYmVsKTsgXAotICAgICAgICB0Y2dfZ2Vu
X29yaV90bChoZXhfc2xvdF9jYW5jZWxsZWQsIGhleF9zbG90X2NhbmNlbGxlZCwgXAotICAgICAg
ICAgICAgICAgICAgICAgICAxIDw8IGluc24tPnNsb3QpOyBcCi0gICAgICAgIGdlbl9zZXRfbGFi
ZWwoZW5kX2xhYmVsKTsgXAogICAgIH0gd2hpbGUgKDApCiAKIApAQCAtNTYwLDE4ICs1NTUsMTMg
QEAgc3RhdGljIGlubGluZSB2b2lkIGFzc2VydF92aGlzdF90bXAoRGlzYXNDb250ZXh0ICpjdHgp
CiAgICAgZG8geyBcCiAgICAgICAgIFRDR3YgTFNCID0gdGNnX3RlbXBfbmV3KCk7IFwKICAgICAg
ICAgVENHTGFiZWwgKmZhbHNlX2xhYmVsID0gZ2VuX25ld19sYWJlbCgpOyBcCi0gICAgICAgIFRD
R0xhYmVsICplbmRfbGFiZWwgPSBnZW5fbmV3X2xhYmVsKCk7IFwKICAgICAgICAgR0VUX0VBOyBc
CiAgICAgICAgIFBSRUQ7IFwKICAgICAgICAgdGNnX2dlbl9icmNvbmRpX3RsKFRDR19DT05EX0VR
LCBMU0IsIDAsIGZhbHNlX2xhYmVsKTsgXAogICAgICAgICB0Y2dfdGVtcF9mcmVlKExTQik7IFwK
ICAgICAgICAgZ2VuX3ZyZWdfbG9hZChjdHgsIERTVE9GRiwgRUEsIHRydWUpOyBcCiAgICAgICAg
IElOQzsgXAotICAgICAgICB0Y2dfZ2VuX2JyKGVuZF9sYWJlbCk7IFwKICAgICAgICAgZ2VuX3Nl
dF9sYWJlbChmYWxzZV9sYWJlbCk7IFwKLSAgICAgICAgdGNnX2dlbl9vcmlfdGwoaGV4X3Nsb3Rf
Y2FuY2VsbGVkLCBoZXhfc2xvdF9jYW5jZWxsZWQsIFwKLSAgICAgICAgICAgICAgICAgICAgICAg
MSA8PCBpbnNuLT5zbG90KTsgXAotICAgICAgICBnZW5fc2V0X2xhYmVsKGVuZF9sYWJlbCk7IFwK
ICAgICB9IHdoaWxlICgwKQogCiAjZGVmaW5lIGZHRU5fVENHX1BSRURfVkVDX0xPQURfcHJlZF9w
aSBcCkBAIC03MzEsMTggKzcyMSwxMyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgYXNzZXJ0X3ZoaXN0
X3RtcChEaXNhc0NvbnRleHQgKmN0eCkKICAgICBkbyB7IFwKICAgICAgICAgVENHdiBMU0IgPSB0
Y2dfdGVtcF9uZXcoKTsgXAogICAgICAgICBUQ0dMYWJlbCAqZmFsc2VfbGFiZWwgPSBnZW5fbmV3
X2xhYmVsKCk7IFwKLSAgICAgICAgVENHTGFiZWwgKmVuZF9sYWJlbCA9IGdlbl9uZXdfbGFiZWwo
KTsgXAogICAgICAgICBHRVRfRUE7IFwKICAgICAgICAgUFJFRDsgXAogICAgICAgICB0Y2dfZ2Vu
X2JyY29uZGlfdGwoVENHX0NPTkRfRVEsIExTQiwgMCwgZmFsc2VfbGFiZWwpOyBcCiAgICAgICAg
IHRjZ190ZW1wX2ZyZWUoTFNCKTsgXAogICAgICAgICBnZW5fdnJlZ19zdG9yZShjdHgsIEVBLCBT
UkNPRkYsIGluc24tPnNsb3QsIEFMSUdOKTsgXAogICAgICAgICBJTkM7IFwKLSAgICAgICAgdGNn
X2dlbl9icihlbmRfbGFiZWwpOyBcCiAgICAgICAgIGdlbl9zZXRfbGFiZWwoZmFsc2VfbGFiZWwp
OyBcCi0gICAgICAgIHRjZ19nZW5fb3JpX3RsKGhleF9zbG90X2NhbmNlbGxlZCwgaGV4X3Nsb3Rf
Y2FuY2VsbGVkLCBcCi0gICAgICAgICAgICAgICAgICAgICAgIDEgPDwgaW5zbi0+c2xvdCk7IFwK
LSAgICAgICAgZ2VuX3NldF9sYWJlbChlbmRfbGFiZWwpOyBcCiAgICAgfSB3aGlsZSAoMCkKIAog
I2RlZmluZSBmR0VOX1RDR19QUkVEX1ZFQ19TVE9SRV9wcmVkX3BpKEFMSUdOKSBcCmRpZmYgLS1n
aXQgYS90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuaCBiL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0
ZS5oCmluZGV4IGU5OTdmNzQyNzguLjg5NzYxMjczYmUgMTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhh
Z29uL3RyYW5zbGF0ZS5oCisrKyBiL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5oCkBAIC00OSw3
ICs0OSw2IEBAIHR5cGVkZWYgc3RydWN0IERpc2FzQ29udGV4dCB7CiAgICAgaW50IHRtcF92cmVn
c19pZHg7CiAgICAgaW50IHRtcF92cmVnc19udW1bVkVDVE9SX1RFTVBTX01BWF07CiAgICAgaW50
IHZyZWdfbG9nW05VTV9WUkVHU107Ci0gICAgYm9vbCB2cmVnX2lzX3ByZWRpY2F0ZWRbTlVNX1ZS
RUdTXTsKICAgICBpbnQgdnJlZ19sb2dfaWR4OwogICAgIERFQ0xBUkVfQklUTUFQKHZyZWdzX3Vw
ZGF0ZWRfdG1wLCBOVU1fVlJFR1MpOwogICAgIERFQ0xBUkVfQklUTUFQKHZyZWdzX3VwZGF0ZWQs
IE5VTV9WUkVHUyk7CkBAIC01Nyw3ICs1Niw2IEBAIHR5cGVkZWYgc3RydWN0IERpc2FzQ29udGV4
dCB7CiAgICAgREVDTEFSRV9CSVRNQVAocHJlZGljYXRlZF9mdXR1cmVfdnJlZ3MsIE5VTV9WUkVH
Uyk7CiAgICAgREVDTEFSRV9CSVRNQVAocHJlZGljYXRlZF90bXBfdnJlZ3MsIE5VTV9WUkVHUyk7
CiAgICAgaW50IHFyZWdfbG9nW05VTV9RUkVHU107Ci0gICAgYm9vbCBxcmVnX2lzX3ByZWRpY2F0
ZWRbTlVNX1FSRUdTXTsKICAgICBpbnQgcXJlZ19sb2dfaWR4OwogICAgIGJvb2wgcHJlX2NvbW1p
dDsKICAgICBUQ0dDb25kIGJyYW5jaF9jb25kOwpAQCAtMTEwLDExICsxMDgsMTIgQEAgc3RhdGlj
IGlubGluZSB2b2lkIGN0eF9sb2dfdnJlZ193cml0ZShEaXNhc0NvbnRleHQgKmN0eCwKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCBpc19wcmVkaWNhdGVkKQogewog
ICAgIGlmICh0eXBlICE9IEVYVF9UTVApIHsKLSAgICAgICAgY3R4LT52cmVnX2xvZ1tjdHgtPnZy
ZWdfbG9nX2lkeF0gPSBybnVtOwotICAgICAgICBjdHgtPnZyZWdfaXNfcHJlZGljYXRlZFtjdHgt
PnZyZWdfbG9nX2lkeF0gPSBpc19wcmVkaWNhdGVkOwotICAgICAgICBjdHgtPnZyZWdfbG9nX2lk
eCsrOworICAgICAgICBpZiAoIXRlc3RfYml0KHJudW0sIGN0eC0+dnJlZ3NfdXBkYXRlZCkpIHsK
KyAgICAgICAgICAgIGN0eC0+dnJlZ19sb2dbY3R4LT52cmVnX2xvZ19pZHhdID0gcm51bTsKKyAg
ICAgICAgICAgIGN0eC0+dnJlZ19sb2dfaWR4Kys7CisgICAgICAgICAgICBzZXRfYml0KHJudW0s
IGN0eC0+dnJlZ3NfdXBkYXRlZCk7CisgICAgICAgIH0KIAotICAgICAgICBzZXRfYml0KHJudW0s
IGN0eC0+dnJlZ3NfdXBkYXRlZCk7CiAgICAgICAgIGlmIChpc19wcmVkaWNhdGVkKSB7CiAgICAg
ICAgICAgICBzZXRfYml0KHJudW0sIGN0eC0+cHJlZGljYXRlZF9mdXR1cmVfdnJlZ3MpOwogICAg
ICAgICB9CkBAIC0xMzksMTAgKzEzOCw5IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBjdHhfbG9nX3Zy
ZWdfd3JpdGVfcGFpcihEaXNhc0NvbnRleHQgKmN0eCwKIH0KIAogc3RhdGljIGlubGluZSB2b2lk
IGN0eF9sb2dfcXJlZ193cml0ZShEaXNhc0NvbnRleHQgKmN0eCwKLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgaW50IHJudW0sIGJvb2wgaXNfcHJlZGljYXRlZCkKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IHJudW0pCiB7CiAgICAgY3R4LT5x
cmVnX2xvZ1tjdHgtPnFyZWdfbG9nX2lkeF0gPSBybnVtOwotICAgIGN0eC0+cXJlZ19pc19wcmVk
aWNhdGVkW2N0eC0+cXJlZ19sb2dfaWR4XSA9IGlzX3ByZWRpY2F0ZWQ7CiAgICAgY3R4LT5xcmVn
X2xvZ19pZHgrKzsKIH0KIApAQCAtMTYzLDggKzE2MSw2IEBAIGV4dGVybiBUQ0d2IGhleF9kY3pl
cm9fYWRkcjsKIGV4dGVybiBUQ0d2IGhleF9sbHNjX2FkZHI7CiBleHRlcm4gVENHdiBoZXhfbGxz
Y192YWw7CiBleHRlcm4gVENHdl9pNjQgaGV4X2xsc2NfdmFsX2k2NDsKLWV4dGVybiBUQ0d2IGhl
eF9WUmVnc191cGRhdGVkOwotZXh0ZXJuIFRDR3YgaGV4X1FSZWdzX3VwZGF0ZWQ7CiBleHRlcm4g
VENHdiBoZXhfdnN0b3JlX2FkZHJbVlNUT1JFU19NQVhdOwogZXh0ZXJuIFRDR3YgaGV4X3ZzdG9y
ZV9zaXplW1ZTVE9SRVNfTUFYXTsKIGV4dGVybiBUQ0d2IGhleF92c3RvcmVfcGVuZGluZ1tWU1RP
UkVTX01BWF07CmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi9nZW5wdHIuYyBiL3RhcmdldC9o
ZXhhZ29uL2dlbnB0ci5jCmluZGV4IGY5MzdhMTdiMjQuLmI1NWFlZWM0MTMgMTAwNjQ0Ci0tLSBh
L3RhcmdldC9oZXhhZ29uL2dlbnB0ci5jCisrKyBiL3RhcmdldC9oZXhhZ29uL2dlbnB0ci5jCkBA
IC0xMDI5LDcwICsxMDI5LDI3IEBAIHN0YXRpYyBpbnRwdHJfdCB2cmVnX3NyY19vZmYoRGlzYXND
b250ZXh0ICpjdHgsIGludCBudW0pCiB9CiAKIHN0YXRpYyB2b2lkIGdlbl9sb2dfdnJlZ193cml0
ZShEaXNhc0NvbnRleHQgKmN0eCwgaW50cHRyX3Qgc3Jjb2ZmLCBpbnQgbnVtLAotICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFZSZWdXcml0ZVR5cGUgdHlwZSwgaW50IHNsb3RfbnVtLAot
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgaXNfcHJlZGljYXRlZCkKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBWUmVnV3JpdGVUeXBlIHR5cGUpCiB7Ci0gICAgVENH
TGFiZWwgKmxhYmVsX2VuZCA9IE5VTEw7CiAgICAgaW50cHRyX3QgZHN0b2ZmOwogCi0gICAgaWYg
KGlzX3ByZWRpY2F0ZWQpIHsKLSAgICAgICAgVENHdiBjYW5jZWxsZWQgPSB0Y2dfdGVtcF9sb2Nh
bF9uZXcoKTsKLSAgICAgICAgbGFiZWxfZW5kID0gZ2VuX25ld19sYWJlbCgpOwotCi0gICAgICAg
IC8qIERvbid0IGRvIGFueXRoaW5nIGlmIHRoZSBzbG90IHdhcyBjYW5jZWxsZWQgKi8KLSAgICAg
ICAgdGNnX2dlbl9leHRyYWN0X3RsKGNhbmNlbGxlZCwgaGV4X3Nsb3RfY2FuY2VsbGVkLCBzbG90
X251bSwgMSk7Ci0gICAgICAgIHRjZ19nZW5fYnJjb25kaV90bChUQ0dfQ09ORF9ORSwgY2FuY2Vs
bGVkLCAwLCBsYWJlbF9lbmQpOwotICAgICAgICB0Y2dfdGVtcF9mcmVlKGNhbmNlbGxlZCk7Ci0g
ICAgfQotCiAgICAgaWYgKHR5cGUgIT0gRVhUX1RNUCkgewogICAgICAgICBkc3RvZmYgPSBjdHhf
ZnV0dXJlX3ZyZWdfb2ZmKGN0eCwgbnVtLCAxLCB0cnVlKTsKICAgICAgICAgdGNnX2dlbl9ndmVj
X21vdihNT182NCwgZHN0b2ZmLCBzcmNvZmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6
ZW9mKE1NVmVjdG9yKSwgc2l6ZW9mKE1NVmVjdG9yKSk7Ci0gICAgICAgIHRjZ19nZW5fb3JpX3Rs
KGhleF9WUmVnc191cGRhdGVkLCBoZXhfVlJlZ3NfdXBkYXRlZCwgMSA8PCBudW0pOwogICAgIH0g
ZWxzZSB7CiAgICAgICAgIGRzdG9mZiA9IGN0eF90bXBfdnJlZ19vZmYoY3R4LCBudW0sIDEsIGZh
bHNlKTsKICAgICAgICAgdGNnX2dlbl9ndmVjX21vdihNT182NCwgZHN0b2ZmLCBzcmNvZmYsCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZW9mKE1NVmVjdG9yKSwgc2l6ZW9mKE1NVmVjdG9y
KSk7CiAgICAgfQotCi0gICAgaWYgKGlzX3ByZWRpY2F0ZWQpIHsKLSAgICAgICAgZ2VuX3NldF9s
YWJlbChsYWJlbF9lbmQpOwotICAgIH0KIH0KIAogc3RhdGljIHZvaWQgZ2VuX2xvZ192cmVnX3dy
aXRlX3BhaXIoRGlzYXNDb250ZXh0ICpjdHgsIGludHB0cl90IHNyY29mZiwgaW50IG51bSwKLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZSZWdXcml0ZVR5cGUgdHlwZSwgaW50
IHNsb3RfbnVtLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCBpc19w
cmVkaWNhdGVkKQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVlJlZ1dyaXRl
VHlwZSB0eXBlKQogewotICAgIGdlbl9sb2dfdnJlZ193cml0ZShjdHgsIHNyY29mZiwgbnVtIF4g
MCwgdHlwZSwgc2xvdF9udW0sIGlzX3ByZWRpY2F0ZWQpOworICAgIGdlbl9sb2dfdnJlZ193cml0
ZShjdHgsIHNyY29mZiwgbnVtIF4gMCwgdHlwZSk7CiAgICAgc3Jjb2ZmICs9IHNpemVvZihNTVZl
Y3Rvcik7Ci0gICAgZ2VuX2xvZ192cmVnX3dyaXRlKGN0eCwgc3Jjb2ZmLCBudW0gXiAxLCB0eXBl
LCBzbG90X251bSwgaXNfcHJlZGljYXRlZCk7Ci19Ci0KLXN0YXRpYyB2b2lkIGdlbl9sb2dfcXJl
Z193cml0ZShpbnRwdHJfdCBzcmNvZmYsIGludCBudW0sIGludCB2bmV3LAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGludCBzbG90X251bSwgYm9vbCBpc19wcmVkaWNhdGVkKQotewot
ICAgIFRDR0xhYmVsICpsYWJlbF9lbmQgPSBOVUxMOwotICAgIGludHB0cl90IGRzdG9mZjsKLQot
ICAgIGlmIChpc19wcmVkaWNhdGVkKSB7Ci0gICAgICAgIFRDR3YgY2FuY2VsbGVkID0gdGNnX3Rl
bXBfbG9jYWxfbmV3KCk7Ci0gICAgICAgIGxhYmVsX2VuZCA9IGdlbl9uZXdfbGFiZWwoKTsKLQot
ICAgICAgICAvKiBEb24ndCBkbyBhbnl0aGluZyBpZiB0aGUgc2xvdCB3YXMgY2FuY2VsbGVkICov
Ci0gICAgICAgIHRjZ19nZW5fZXh0cmFjdF90bChjYW5jZWxsZWQsIGhleF9zbG90X2NhbmNlbGxl
ZCwgc2xvdF9udW0sIDEpOwotICAgICAgICB0Y2dfZ2VuX2JyY29uZGlfdGwoVENHX0NPTkRfTkUs
IGNhbmNlbGxlZCwgMCwgbGFiZWxfZW5kKTsKLSAgICAgICAgdGNnX3RlbXBfZnJlZShjYW5jZWxs
ZWQpOwotICAgIH0KLQotICAgIGRzdG9mZiA9IG9mZnNldG9mKENQVUhleGFnb25TdGF0ZSwgZnV0
dXJlX1FSZWdzW251bV0pOwotICAgIHRjZ19nZW5fZ3ZlY19tb3YoTU9fNjQsIGRzdG9mZiwgc3Jj
b2ZmLCBzaXplb2YoTU1RUmVnKSwgc2l6ZW9mKE1NUVJlZykpOwotCi0gICAgaWYgKGlzX3ByZWRp
Y2F0ZWQpIHsKLSAgICAgICAgdGNnX2dlbl9vcmlfdGwoaGV4X1FSZWdzX3VwZGF0ZWQsIGhleF9R
UmVnc191cGRhdGVkLCAxIDw8IG51bSk7Ci0gICAgICAgIGdlbl9zZXRfbGFiZWwobGFiZWxfZW5k
KTsKLSAgICB9CisgICAgZ2VuX2xvZ192cmVnX3dyaXRlKGN0eCwgc3Jjb2ZmLCBudW0gXiAxLCB0
eXBlKTsKIH0KIAogc3RhdGljIHZvaWQgZ2VuX3ZyZWdfbG9hZChEaXNhc0NvbnRleHQgKmN0eCwg
aW50cHRyX3QgZHN0b2ZmLCBUQ0d2IHNyYywKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29uL3Ry
YW5zbGF0ZS5jIGIvdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmMKaW5kZXggOGFjMWY1Y2FiYy4u
YTdiOThkODNmOSAxMDA2NDQKLS0tIGEvdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmMKKysrIGIv
dGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmMKQEAgLTU1LDggKzU1LDYgQEAgVENHdiBoZXhfZGN6
ZXJvX2FkZHI7CiBUQ0d2IGhleF9sbHNjX2FkZHI7CiBUQ0d2IGhleF9sbHNjX3ZhbDsKIFRDR3Zf
aTY0IGhleF9sbHNjX3ZhbF9pNjQ7Ci1UQ0d2IGhleF9WUmVnc191cGRhdGVkOwotVENHdiBoZXhf
UVJlZ3NfdXBkYXRlZDsKIFRDR3YgaGV4X3ZzdG9yZV9hZGRyW1ZTVE9SRVNfTUFYXTsKIFRDR3Yg
aGV4X3ZzdG9yZV9zaXplW1ZTVE9SRVNfTUFYXTsKIFRDR3YgaGV4X3ZzdG9yZV9wZW5kaW5nW1ZT
VE9SRVNfTUFYXTsKQEAgLTI0NywxMiArMjQ1LDExIEBAIHN0YXRpYyBib29sIGNoZWNrX2Zvcl9h
dHRyaWIoUGFja2V0ICpwa3QsIGludCBhdHRyaWIpCiAKIHN0YXRpYyBib29sIG5lZWRfc2xvdF9j
YW5jZWxsZWQoUGFja2V0ICpwa3QpCiB7Ci0gICAgLyogV2Ugb25seSBuZWVkIHNsb3RfY2FuY2Vs
bGVkIGZvciBjb25kaXRpb25hbCBzdG9yZSBhbmQgSFZYIGluc3RydWN0aW9ucyAqLworICAgIC8q
IFdlIG9ubHkgbmVlZCBzbG90X2NhbmNlbGxlZCBmb3IgY29uZGl0aW9uYWwgc3RvcmUgaW5zdHJ1
Y3Rpb25zICovCiAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBwa3QtPm51bV9pbnNuczsgaSsrKSB7
CiAgICAgICAgIHVpbnQxNl90IG9wY29kZSA9IHBrdC0+aW5zbltpXS5vcGNvZGU7CiAgICAgICAg
IGlmIChHRVRfQVRUUklCKG9wY29kZSwgQV9DT05ERVhFQykgJiYKLSAgICAgICAgICAgIChHRVRf
QVRUUklCKG9wY29kZSwgQV9TVE9SRSkgfHwKLSAgICAgICAgICAgICBHRVRfQVRUUklCKG9wY29k
ZSwgQV9DVkkpKSkgeworICAgICAgICAgICAgR0VUX0FUVFJJQihvcGNvZGUsIEFfU0NBTEFSX1NU
T1JFKSkgewogICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgIH0KICAgICB9CkBAIC00
NDcsMTEgKzQ0NCw2IEBAIHN0YXRpYyB2b2lkIGdlbl9zdGFydF9wYWNrZXQoRGlzYXNDb250ZXh0
ICpjdHgpCiAgICAgICAgICAgICBpID0gZmluZF9uZXh0X2JpdChjdHgtPnByZWRpY2F0ZWRfdG1w
X3ZyZWdzLCBOVU1fVlJFR1MsIGkgKyAxKTsKICAgICAgICAgfQogICAgIH0KLQotICAgIGlmIChw
a3QtPnBrdF9oYXNfaHZ4KSB7Ci0gICAgICAgIHRjZ19nZW5fbW92aV90bChoZXhfVlJlZ3NfdXBk
YXRlZCwgMCk7Ci0gICAgICAgIHRjZ19nZW5fbW92aV90bChoZXhfUVJlZ3NfdXBkYXRlZCwgMCk7
Ci0gICAgfQogfQogCiBib29sIGlzX2dhdGhlcl9zdG9yZV9pbnNuKERpc2FzQ29udGV4dCAqY3R4
KQpAQCAtNzI0LDY3ICs3MTYsMzEgQEAgc3RhdGljIHZvaWQgZ2VuX2NvbW1pdF9odngoRGlzYXND
b250ZXh0ICpjdHgpCiAgICAgLyoKICAgICAgKiAgICBmb3IgKGkgPSAwOyBpIDwgY3R4LT52cmVn
X2xvZ19pZHg7IGkrKykgewogICAgICAqICAgICAgICBpbnQgcm51bSA9IGN0eC0+dnJlZ19sb2db
aV07Ci0gICAgICogICAgICAgIGlmIChjdHgtPnZyZWdfaXNfcHJlZGljYXRlZFtpXSkgewotICAg
ICAqICAgICAgICAgICAgaWYgKGVudi0+VlJlZ3NfdXBkYXRlZCAmICgxIDw8IHJudW0pKSB7Ci0g
ICAgICogICAgICAgICAgICAgICAgZW52LT5WUmVnc1tybnVtXSA9IGVudi0+ZnV0dXJlX1ZSZWdz
W3JudW1dOwotICAgICAqICAgICAgICAgICAgfQotICAgICAqICAgICAgICB9IGVsc2UgewotICAg
ICAqICAgICAgICAgICAgZW52LT5WUmVnc1tybnVtXSA9IGVudi0+ZnV0dXJlX1ZSZWdzW3JudW1d
OwotICAgICAqICAgICAgICB9CisgICAgICogICAgICAgIGVudi0+VlJlZ3Nbcm51bV0gPSBlbnYt
PmZ1dHVyZV9WUmVnc1tybnVtXTsKICAgICAgKiAgICB9CiAgICAgICovCiAgICAgZm9yIChpID0g
MDsgaSA8IGN0eC0+dnJlZ19sb2dfaWR4OyBpKyspIHsKICAgICAgICAgaW50IHJudW0gPSBjdHgt
PnZyZWdfbG9nW2ldOwotICAgICAgICBib29sIGlzX3ByZWRpY2F0ZWQgPSBjdHgtPnZyZWdfaXNf
cHJlZGljYXRlZFtpXTsKICAgICAgICAgaW50cHRyX3QgZHN0b2ZmID0gb2Zmc2V0b2YoQ1BVSGV4
YWdvblN0YXRlLCBWUmVnc1tybnVtXSk7CiAgICAgICAgIGludHB0cl90IHNyY29mZiA9IGN0eF9m
dXR1cmVfdnJlZ19vZmYoY3R4LCBybnVtLCAxLCBmYWxzZSk7CiAgICAgICAgIHNpemVfdCBzaXpl
ID0gc2l6ZW9mKE1NVmVjdG9yKTsKIAotICAgICAgICBpZiAoaXNfcHJlZGljYXRlZCkgewotICAg
ICAgICAgICAgVENHdiBjbXAgPSB0Y2dfdGVtcF9uZXcoKTsKLSAgICAgICAgICAgIFRDR0xhYmVs
ICpsYWJlbF9za2lwID0gZ2VuX25ld19sYWJlbCgpOwotCi0gICAgICAgICAgICB0Y2dfZ2VuX2Fu
ZGlfdGwoY21wLCBoZXhfVlJlZ3NfdXBkYXRlZCwgMSA8PCBybnVtKTsKLSAgICAgICAgICAgIHRj
Z19nZW5fYnJjb25kaV90bChUQ0dfQ09ORF9FUSwgY21wLCAwLCBsYWJlbF9za2lwKTsKLSAgICAg
ICAgICAgIHRjZ190ZW1wX2ZyZWUoY21wKTsKLSAgICAgICAgICAgIHRjZ19nZW5fZ3ZlY19tb3Yo
TU9fNjQsIGRzdG9mZiwgc3Jjb2ZmLCBzaXplLCBzaXplKTsKLSAgICAgICAgICAgIGdlbl9zZXRf
bGFiZWwobGFiZWxfc2tpcCk7Ci0gICAgICAgIH0gZWxzZSB7Ci0gICAgICAgICAgICB0Y2dfZ2Vu
X2d2ZWNfbW92KE1PXzY0LCBkc3RvZmYsIHNyY29mZiwgc2l6ZSwgc2l6ZSk7Ci0gICAgICAgIH0K
KyAgICAgICAgdGNnX2dlbl9ndmVjX21vdihNT182NCwgZHN0b2ZmLCBzcmNvZmYsIHNpemUsIHNp
emUpOwogICAgIH0KIAogICAgIC8qCiAgICAgICogICAgZm9yIChpID0gMDsgaSA8IGN0eC0+cXJl
Z19sb2dfaWR4OyBpKyspIHsKICAgICAgKiAgICAgICAgaW50IHJudW0gPSBjdHgtPnFyZWdfbG9n
W2ldOwotICAgICAqICAgICAgICBpZiAoY3R4LT5xcmVnX2lzX3ByZWRpY2F0ZWRbaV0pIHsKLSAg
ICAgKiAgICAgICAgICAgIGlmIChlbnYtPlFSZWdzX3VwZGF0ZWQpICYgKDEgPDwgcm51bSkpIHsK
LSAgICAgKiAgICAgICAgICAgICAgICBlbnYtPlFSZWdzW3JudW1dID0gZW52LT5mdXR1cmVfUVJl
Z3Nbcm51bV07Ci0gICAgICogICAgICAgICAgICB9Ci0gICAgICogICAgICAgIH0gZWxzZSB7Ci0g
ICAgICogICAgICAgICAgICBlbnYtPlFSZWdzW3JudW1dID0gZW52LT5mdXR1cmVfUVJlZ3Nbcm51
bV07Ci0gICAgICogICAgICAgIH0KKyAgICAgKiAgICAgICAgZW52LT5RUmVnc1tybnVtXSA9IGVu
di0+ZnV0dXJlX1FSZWdzW3JudW1dOwogICAgICAqICAgIH0KICAgICAgKi8KICAgICBmb3IgKGkg
PSAwOyBpIDwgY3R4LT5xcmVnX2xvZ19pZHg7IGkrKykgewogICAgICAgICBpbnQgcm51bSA9IGN0
eC0+cXJlZ19sb2dbaV07Ci0gICAgICAgIGJvb2wgaXNfcHJlZGljYXRlZCA9IGN0eC0+cXJlZ19p
c19wcmVkaWNhdGVkW2ldOwogICAgICAgICBpbnRwdHJfdCBkc3RvZmYgPSBvZmZzZXRvZihDUFVI
ZXhhZ29uU3RhdGUsIFFSZWdzW3JudW1dKTsKICAgICAgICAgaW50cHRyX3Qgc3Jjb2ZmID0gb2Zm
c2V0b2YoQ1BVSGV4YWdvblN0YXRlLCBmdXR1cmVfUVJlZ3Nbcm51bV0pOwogICAgICAgICBzaXpl
X3Qgc2l6ZSA9IHNpemVvZihNTVFSZWcpOwogCi0gICAgICAgIGlmIChpc19wcmVkaWNhdGVkKSB7
Ci0gICAgICAgICAgICBUQ0d2IGNtcCA9IHRjZ190ZW1wX25ldygpOwotICAgICAgICAgICAgVENH
TGFiZWwgKmxhYmVsX3NraXAgPSBnZW5fbmV3X2xhYmVsKCk7Ci0KLSAgICAgICAgICAgIHRjZ19n
ZW5fYW5kaV90bChjbXAsIGhleF9RUmVnc191cGRhdGVkLCAxIDw8IHJudW0pOwotICAgICAgICAg
ICAgdGNnX2dlbl9icmNvbmRpX3RsKFRDR19DT05EX0VRLCBjbXAsIDAsIGxhYmVsX3NraXApOwot
ICAgICAgICAgICAgdGNnX3RlbXBfZnJlZShjbXApOwotICAgICAgICAgICAgdGNnX2dlbl9ndmVj
X21vdihNT182NCwgZHN0b2ZmLCBzcmNvZmYsIHNpemUsIHNpemUpOwotICAgICAgICAgICAgZ2Vu
X3NldF9sYWJlbChsYWJlbF9za2lwKTsKLSAgICAgICAgfSBlbHNlIHsKLSAgICAgICAgICAgIHRj
Z19nZW5fZ3ZlY19tb3YoTU9fNjQsIGRzdG9mZiwgc3Jjb2ZmLCBzaXplLCBzaXplKTsKLSAgICAg
ICAgfQorICAgICAgICB0Y2dfZ2VuX2d2ZWNfbW92KE1PXzY0LCBkc3RvZmYsIHNyY29mZiwgc2l6
ZSwgc2l6ZSk7CiAgICAgfQogCiAgICAgaWYgKHBrdF9oYXNfaHZ4X3N0b3JlKGN0eC0+cGt0KSkg
ewpAQCAtMTExNywxMCArMTA3Myw2IEBAIHZvaWQgaGV4YWdvbl90cmFuc2xhdGVfaW5pdCh2b2lk
KQogICAgICAgICBvZmZzZXRvZihDUFVIZXhhZ29uU3RhdGUsIGxsc2NfdmFsKSwgImxsc2NfdmFs
Iik7CiAgICAgaGV4X2xsc2NfdmFsX2k2NCA9IHRjZ19nbG9iYWxfbWVtX25ld19pNjQoY3B1X2Vu
diwKICAgICAgICAgb2Zmc2V0b2YoQ1BVSGV4YWdvblN0YXRlLCBsbHNjX3ZhbF9pNjQpLCAibGxz
Y192YWxfaTY0Iik7Ci0gICAgaGV4X1ZSZWdzX3VwZGF0ZWQgPSB0Y2dfZ2xvYmFsX21lbV9uZXco
Y3B1X2VudiwKLSAgICAgICAgb2Zmc2V0b2YoQ1BVSGV4YWdvblN0YXRlLCBWUmVnc191cGRhdGVk
KSwgIlZSZWdzX3VwZGF0ZWQiKTsKLSAgICBoZXhfUVJlZ3NfdXBkYXRlZCA9IHRjZ19nbG9iYWxf
bWVtX25ldyhjcHVfZW52LAotICAgICAgICBvZmZzZXRvZihDUFVIZXhhZ29uU3RhdGUsIFFSZWdz
X3VwZGF0ZWQpLCAiUVJlZ3NfdXBkYXRlZCIpOwogICAgIGZvciAoaSA9IDA7IGkgPCBTVE9SRVNf
TUFYOyBpKyspIHsKICAgICAgICAgc25wcmludGYoc3RvcmVfYWRkcl9uYW1lc1tpXSwgTkFNRV9M
RU4sICJzdG9yZV9hZGRyXyVkIiwgaSk7CiAgICAgICAgIGhleF9zdG9yZV9hZGRyW2ldID0gdGNn
X2dsb2JhbF9tZW1fbmV3KGNwdV9lbnYsCmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi9SRUFE
TUUgYi90YXJnZXQvaGV4YWdvbi9SRUFETUUKaW5kZXggZDkyNzMxZTM0Ni4uNmE5ZWZiNmZjZiAx
MDA2NDQKLS0tIGEvdGFyZ2V0L2hleGFnb24vUkVBRE1FCisrKyBiL3RhcmdldC9oZXhhZ29uL1JF
QURNRQpAQCAtMTM3LDMxICsxMzcsMjUgQEAgRm9yIEhWWCB2ZWN0b3JzLCB0aGUgZ2VuZXJhdG9y
IGJlaGF2ZXMgc2xpZ2h0bHkgZGlmZmVyZW50bHkuICBUaGUgd2lkZSB2ZWN0b3JzCiB3b24ndCBm
aXQgaW4gYSBUQ0d2IG9yIFRDR3ZfaTY0LCBzbyB3ZSBwYXNzIFRDR3ZfcHRyIHZhcmlhYmxlcyB0
byBwYXNzIHRoZQogYWRkcmVzcyB0byBoZWxwZXIgZnVuY3Rpb25zLiAgSGVyZSdzIGFuIGV4YW1w
bGUgZm9yIGFuIEhWWCB2ZWN0b3ItYWRkLXdvcmQKIGlzdHJ1Y3Rpb24uCi0gICAgc3RhdGljIHZv
aWQgZ2VuZXJhdGVfVjZfdmFkZHcoCi0gICAgICAgICAgICAgICAgICAgIENQVUhleGFnb25TdGF0
ZSAqZW52LAotICAgICAgICAgICAgICAgICAgICBEaXNhc0NvbnRleHQgKmN0eCwKLSAgICAgICAg
ICAgICAgICAgICAgSW5zbiAqaW5zbiwKLSAgICAgICAgICAgICAgICAgICAgUGFja2V0ICpwa3Qp
CisgICAgc3RhdGljIHZvaWQgZ2VuZXJhdGVfVjZfdmFkZHcoRGlzYXNDb250ZXh0ICpjdHgpCiAg
ICAgeworICAgICAgICBJbnNuICppbnNuIF9fYXR0cmlidXRlX18oKHVudXNlZCkpID0gY3R4LT5p
bnNuOwogICAgICAgICBjb25zdCBpbnQgVmROID0gaW5zbi0+cmVnbm9bMF07CiAgICAgICAgIGNv
bnN0IGludHB0cl90IFZkVl9vZmYgPQogICAgICAgICAgICAgY3R4X2Z1dHVyZV92cmVnX29mZihj
dHgsIFZkTiwgMSwgdHJ1ZSk7Ci0gICAgICAgIFRDR3ZfcHRyIFZkViA9IHRjZ190ZW1wX2xvY2Fs
X25ld19wdHIoKTsKKyAgICAgICAgVENHdl9wdHIgVmRWID0gdGNnX3RlbXBfbmV3X3B0cigpOwog
ICAgICAgICB0Y2dfZ2VuX2FkZGlfcHRyKFZkViwgY3B1X2VudiwgVmRWX29mZik7CiAgICAgICAg
IGNvbnN0IGludCBWdU4gPSBpbnNuLT5yZWdub1sxXTsKICAgICAgICAgY29uc3QgaW50cHRyX3Qg
VnVWX29mZiA9CiAgICAgICAgICAgICB2cmVnX3NyY19vZmYoY3R4LCBWdU4pOwotICAgICAgICBU
Q0d2X3B0ciBWdVYgPSB0Y2dfdGVtcF9sb2NhbF9uZXdfcHRyKCk7CisgICAgICAgIFRDR3ZfcHRy
IFZ1ViA9IHRjZ190ZW1wX25ld19wdHIoKTsKICAgICAgICAgY29uc3QgaW50IFZ2TiA9IGluc24t
PnJlZ25vWzJdOwogICAgICAgICBjb25zdCBpbnRwdHJfdCBWdlZfb2ZmID0KICAgICAgICAgICAg
IHZyZWdfc3JjX29mZihjdHgsIFZ2Tik7Ci0gICAgICAgIFRDR3ZfcHRyIFZ2ViA9IHRjZ190ZW1w
X2xvY2FsX25ld19wdHIoKTsKKyAgICAgICAgVENHdl9wdHIgVnZWID0gdGNnX3RlbXBfbmV3X3B0
cigpOwogICAgICAgICB0Y2dfZ2VuX2FkZGlfcHRyKFZ1ViwgY3B1X2VudiwgVnVWX29mZik7CiAg
ICAgICAgIHRjZ19nZW5fYWRkaV9wdHIoVnZWLCBjcHVfZW52LCBWdlZfb2ZmKTsKLSAgICAgICAg
VENHdiBzbG90ID0gdGNnX2NvbnN0YW50X3RsKGluc24tPnNsb3QpOwotICAgICAgICBnZW5faGVs
cGVyX1Y2X3ZhZGR3KGNwdV9lbnYsIFZkViwgVnVWLCBWdlYsIHNsb3QpOwotICAgICAgICB0Y2df
dGVtcF9mcmVlKHNsb3QpOwotICAgICAgICBnZW5fbG9nX3ZyZWdfd3JpdGUoY3R4LCBWZFZfb2Zm
LCBWZE4sIEVYVF9ERkwsIGluc24tPnNsb3QsIGZhbHNlKTsKKyAgICAgICAgZ2VuX2hlbHBlcl9W
Nl92YWRkdyhjcHVfZW52LCBWZFYsIFZ1ViwgVnZWKTsKICAgICAgICAgdGNnX3RlbXBfZnJlZV9w
dHIoVmRWKTsKICAgICAgICAgdGNnX3RlbXBfZnJlZV9wdHIoVnVWKTsKICAgICAgICAgdGNnX3Rl
bXBfZnJlZV9wdHIoVnZWKTsKQEAgLTE3NywxMiArMTcxLDkgQEAgZnVuY3Rpb25zIGZyb20gdGNn
LW9wLWd2ZWMuaC4gIEhlcmUncyB0aGUgb3ZlcnJpZGUgZm9yIHRoaXMgaW5zdHJ1Y3Rpb24uCiBG
aW5hbGx5LCB3ZSBub3RpY2UgdGhhdCB0aGUgb3ZlcnJpZGUgZG9lc24ndCB1c2UgdGhlIFRDR3Zf
cHRyIHZhcmlhYmxlcywgc28KIHdlIGRvbid0IGdlbmVyYXRlIHRoZW0gd2hlbiBhbiBvdmVycmlk
ZSBpcyBwcmVzZW50LiAgSGVyZSBpcyB3aGF0IHdlIGdlbmVyYXRlCiB3aGVuIHRoZSBvdmVycmlk
ZSBpcyBwcmVzZW50LgotICAgIHN0YXRpYyB2b2lkIGdlbmVyYXRlX1Y2X3ZhZGR3KAotICAgICAg
ICAgICAgICAgICAgICBDUFVIZXhhZ29uU3RhdGUgKmVudiwKLSAgICAgICAgICAgICAgICAgICAg
RGlzYXNDb250ZXh0ICpjdHgsCi0gICAgICAgICAgICAgICAgICAgIEluc24gKmluc24sCi0gICAg
ICAgICAgICAgICAgICAgIFBhY2tldCAqcGt0KQorICAgIHN0YXRpYyB2b2lkIGdlbmVyYXRlX1Y2
X3ZhZGR3KERpc2FzQ29udGV4dCAqY3R4KQogICAgIHsKKyAgICAgICAgSW5zbiAqaW5zbiBfX2F0
dHJpYnV0ZV9fKCh1bnVzZWQpKSA9IGN0eC0+aW5zbjsKICAgICAgICAgY29uc3QgaW50IFZkTiA9
IGluc24tPnJlZ25vWzBdOwogICAgICAgICBjb25zdCBpbnRwdHJfdCBWZFZfb2ZmID0KICAgICAg
ICAgICAgIGN0eF9mdXR1cmVfdnJlZ19vZmYoY3R4LCBWZE4sIDEsIHRydWUpOwpAQCAtMTkzLDcg
KzE4NCw2IEBAIHdoZW4gdGhlIG92ZXJyaWRlIGlzIHByZXNlbnQuCiAgICAgICAgIGNvbnN0IGlu
dHB0cl90IFZ2Vl9vZmYgPQogICAgICAgICAgICAgdnJlZ19zcmNfb2ZmKGN0eCwgVnZOKTsKICAg
ICAgICAgZkdFTl9UQ0dfVjZfdmFkZHcoeyBmSElERShpbnQgaTspIGZWRk9SRUFDSCgzMiwgaSkg
eyBWZFYud1tpXSA9IFZ1Vi53W2ldICsgVnZWLndbaV0gOyB9IH0pOwotICAgICAgICBnZW5fbG9n
X3ZyZWdfd3JpdGUoY3R4LCBWZFZfb2ZmLCBWZE4sIEVYVF9ERkwsIGluc24tPnNsb3QsIGZhbHNl
KTsKICAgICB9CiAKIFdlIGFsc28gZ2VuZXJhdGUgYW4gYW5hbHl6ZV88dGFnPiBmdW5jdGlvbiBm
b3IgZWFjaCBpbnN0cnVjdGlvbi4gIEN1cnJlbnRseSwKQEAgLTI4NiwxMCArMjc2LDggQEAgRm9y
IEhleGFnb24gVmVjdG9yIGVYdGVuc2lvbnMgKEhWWCksIHRoZSBmb2xsb3dpbmcgZmllbGRzIGFy
ZSB1c2VkCiAgICAgVlJlZ3MgICAgICAgICAgICAgICAgICAgICAgIFZlY3RvciByZWdpc3RlcnMK
ICAgICBmdXR1cmVfVlJlZ3MgICAgICAgICAgICAgICAgUmVnaXN0ZXJzIHRvIGJlIHN0b3JlZCBk
dXJpbmcgcGFja2V0IGNvbW1pdAogICAgIHRtcF9WUmVncyAgICAgICAgICAgICAgICAgICBUZW1w
b3JhcnkgcmVnaXN0ZXJzICpub3QqIHN0b3JlZCBkdXJpbmcgY29tbWl0Ci0gICAgVlJlZ3NfdXBk
YXRlZCAgICAgICAgICAgICAgIE1hc2sgb2YgcHJlZGljYXRlZCB2ZWN0b3Igd3JpdGVzCiAgICAg
UVJlZ3MgICAgICAgICAgICAgICAgICAgICAgIFEgKHZlY3RvciBwcmVkaWNhdGUpIHJlZ2lzdGVy
cwogICAgIGZ1dHVyZV9RUmVncyAgICAgICAgICAgICAgICBSZWdpc3RlcnMgdG8gYmUgc3RvcmVk
IGR1cmluZyBwYWNrZXQgY29tbWl0Ci0gICAgUVJlZ3NfdXBkYXRlZCAgICAgICAgICAgICAgIE1h
c2sgb2YgcHJlZGljYXRlZCB2ZWN0b3Igd3JpdGVzCiAKICoqKiBEZWJ1Z2dpbmcgKioqCiAKZGlm
ZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29uL2dlbl9hbmFseXplX2Z1bmNzLnB5IGIvdGFyZ2V0L2hl
eGFnb24vZ2VuX2FuYWx5emVfZnVuY3MucHkKaW5kZXggN2IwNWIxNjVhMS4uYjk0MGI1YjFhYSAx
MDA3NTUKLS0tIGEvdGFyZ2V0L2hleGFnb24vZ2VuX2FuYWx5emVfZnVuY3MucHkKKysrIGIvdGFy
Z2V0L2hleGFnb24vZ2VuX2FuYWx5emVfZnVuY3MucHkKQEAgLTExMCw4ICsxMTAsNyBAQCBkZWYg
YW5hbHl6ZV9vcG5fb2xkKGYsIHRhZywgcmVndHlwZSwgcmVnaWQsIHJlZ25vKToKICAgICAgICAg
aWYgKHJlZ2lkIGluIHsiZCIsICJlIiwgIngifSk6CiAgICAgICAgICAgICBmLndyaXRlKCIgICAg
Y29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwKICAgICAgICAgICAgICAgICAo
cmVnTiwgcmVnbm8pKQotICAgICAgICAgICAgZi53cml0ZSgiICAgIGN0eF9sb2dfcXJlZ193cml0
ZShjdHgsICVzLCAlcyk7XG4iICUgXAotICAgICAgICAgICAgICAgIChyZWdOLCBwcmVkaWNhdGVk
KSkKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICBjdHhfbG9nX3FyZWdfd3JpdGUoY3R4LCAlcyk7
XG4iICUgKHJlZ04pKQogICAgICAgICBlbGlmIChyZWdpZCBpbiB7InMiLCAidCIsICJ1IiwgInYi
fSk6CiAgICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQgJXMgPSBpbnNuLT5yZWdu
b1slZF07XG4iICUgXAogICAgICAgICAgICAgICAgIChyZWdOLCByZWdubykpCmRpZmYgLS1naXQg
YS90YXJnZXQvaGV4YWdvbi9nZW5fdGNnX2Z1bmNzLnB5IGIvdGFyZ2V0L2hleGFnb24vZ2VuX3Rj
Z19mdW5jcy5weQppbmRleCAxNDhlNjQwMWZmLi5lZDlhZjczOTBlIDEwMDc1NQotLS0gYS90YXJn
ZXQvaGV4YWdvbi9nZW5fdGNnX2Z1bmNzLnB5CisrKyBiL3RhcmdldC9oZXhhZ29uL2dlbl90Y2df
ZnVuY3MucHkKQEAgLTQ3MiwzNiArNDcyLDE4IEBAIGRlZiBnZW5wdHJfZHN0X3dyaXRlKGYsIHRh
ZywgcmVndHlwZSwgcmVnaWQpOgogCiBkZWYgZ2VucHRyX2RzdF93cml0ZV9leHQoZiwgdGFnLCBy
ZWd0eXBlLCByZWdpZCwgbmV3dj0iRVhUX0RGTCIpOgogICAgIGlmIChyZWd0eXBlID09ICJWIik6
Ci0gICAgICAgIGlmIChyZWdpZCBpbiB7ImRkIiwgInh4IiwgInl5In0pOgotICAgICAgICAgICAg
aWYgKCdBX0NPTkRFWEVDJyBpbiBoZXhfY29tbW9uLmF0dHJpYmRpY3RbdGFnXSk6Ci0gICAgICAg
ICAgICAgICAgaXNfcHJlZGljYXRlZCA9ICJ0cnVlIgotICAgICAgICAgICAgZWxzZToKLSAgICAg
ICAgICAgICAgICBpc19wcmVkaWNhdGVkID0gImZhbHNlIgorICAgICAgICBpZiAocmVnaWQgaW4g
eyJ4eCJ9KToKICAgICAgICAgICAgIGYud3JpdGUoIiAgICBnZW5fbG9nX3ZyZWdfd3JpdGVfcGFp
cihjdHgsICVzJXNWX29mZiwgJXMlc04sICIgJSBcCiAgICAgICAgICAgICAgICAgKHJlZ3R5cGUs
IHJlZ2lkLCByZWd0eXBlLCByZWdpZCkpCi0gICAgICAgICAgICBmLndyaXRlKCIlcywgaW5zbi0+
c2xvdCwgJXMpO1xuIiAlIFwKLSAgICAgICAgICAgICAgICAobmV3diwgaXNfcHJlZGljYXRlZCkp
Ci0gICAgICAgIGVsaWYgKHJlZ2lkIGluIHsiZCIsICJ4IiwgInkifSk6Ci0gICAgICAgICAgICBp
ZiAoJ0FfQ09OREVYRUMnIGluIGhleF9jb21tb24uYXR0cmliZGljdFt0YWddKToKLSAgICAgICAg
ICAgICAgICBpc19wcmVkaWNhdGVkID0gInRydWUiCi0gICAgICAgICAgICBlbHNlOgotICAgICAg
ICAgICAgICAgIGlzX3ByZWRpY2F0ZWQgPSAiZmFsc2UiCi0gICAgICAgICAgICBmLndyaXRlKCIg
ICAgZ2VuX2xvZ192cmVnX3dyaXRlKGN0eCwgJXMlc1Zfb2ZmLCAlcyVzTiwgJXMsICIgJSBcCisg
ICAgICAgICAgICBmLndyaXRlKCIlcyk7XG4iICUgXAorICAgICAgICAgICAgICAgIChuZXd2KSkK
KyAgICAgICAgZWxpZiAocmVnaWQgaW4geyJ5In0pOgorICAgICAgICAgICAgZi53cml0ZSgiICAg
IGdlbl9sb2dfdnJlZ193cml0ZShjdHgsICVzJXNWX29mZiwgJXMlc04sICVzKTtcbiIgJSBcCiAg
ICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWd0eXBlLCByZWdpZCwgbmV3dikpCi0g
ICAgICAgICAgICBmLndyaXRlKCJpbnNuLT5zbG90LCAlcyk7XG4iICUgXAotICAgICAgICAgICAg
ICAgIChpc19wcmVkaWNhdGVkKSkKLSAgICAgICAgZWxzZToKKyAgICAgICAgZWxpZiAocmVnaWQg
bm90IGluIHsiZGQiLCAiZCIsICJ4In0pOgogICAgICAgICAgICAgcHJpbnQoIkJhZCByZWdpc3Rl
ciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCiAgICAgZWxpZiAocmVndHlwZSA9PSAiUSIpOgot
ICAgICAgICBpZiAocmVnaWQgaW4geyJkIiwgImUiLCAieCJ9KToKLSAgICAgICAgICAgIGlmICgn
QV9DT05ERVhFQycgaW4gaGV4X2NvbW1vbi5hdHRyaWJkaWN0W3RhZ10pOgotICAgICAgICAgICAg
ICAgIGlzX3ByZWRpY2F0ZWQgPSAidHJ1ZSIKLSAgICAgICAgICAgIGVsc2U6Ci0gICAgICAgICAg
ICAgICAgaXNfcHJlZGljYXRlZCA9ICJmYWxzZSIKLSAgICAgICAgICAgIGYud3JpdGUoIiAgICBn
ZW5fbG9nX3FyZWdfd3JpdGUoJXMlc1Zfb2ZmLCAlcyVzTiwgJXMsICIgJSBcCi0gICAgICAgICAg
ICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWd0eXBlLCByZWdpZCwgbmV3dikpCi0gICAgICAgICAg
ICBmLndyaXRlKCJpbnNuLT5zbG90LCAlcyk7XG4iICUgKGlzX3ByZWRpY2F0ZWQpKQotICAgICAg
ICBlbHNlOgorICAgICAgICBpZiAocmVnaWQgbm90IGluIHsiZCIsICJlIiwgIngifSk6CiAgICAg
ICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCByZWdpZCkKICAg
ICBlbHNlOgogICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCBy
ZWdpZCkKLS0gCjIuMTcuMQoK

