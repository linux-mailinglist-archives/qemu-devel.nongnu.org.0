Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id 05B576032DB
	for <lists+qemu-devel@lfdr.de>; Tue, 18 Oct 2022 20:54:06 +0200 (CEST)
Received: from localhost ([::1]:58282 helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>)
	id 1okrj2-0005IG-0P
	for lists+qemu-devel@lfdr.de; Tue, 18 Oct 2022 14:54:04 -0400
Received: from eggs.gnu.org ([2001:470:142:3::10]:33816)
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1okrXv-0000bk-Vn
 for qemu-devel@nongnu.org; Tue, 18 Oct 2022 14:42:36 -0400
Received: from mx0a-0031df01.pphosted.com ([205.220.168.131]:33754)
 by eggs.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1okrXt-0005mu-Dx
 for qemu-devel@nongnu.org; Tue, 18 Oct 2022 14:42:35 -0400
Received: from pps.filterd (m0279863.ppops.net [127.0.0.1])
 by mx0a-0031df01.pphosted.com (8.17.1.5/8.17.1.5) with ESMTP id 29IEvVmx025979;
 Tue, 18 Oct 2022 18:42:30 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=quicinc.com;
 h=from : to : cc :
 subject : date : message-id : in-reply-to : references : mime-version :
 content-type : content-transfer-encoding; s=qcppdkim1;
 bh=FyUo99frVeubCa8jBP5Txw6UVGuGsE1clKz6m1XXl2s=;
 b=cpbJp9BYGX6JmQ8oOSSwmdWOGiTfeFjjeDKPKdZKUgUGtmnpIEHtNIf8zw42cy2SnIdH
 FtL1rcmqylB9dTsQ6B8Ii1+QgTI+uotdMDmN2AG3WEvFFSvzK+RmDyhNuSieKWjWGB1i
 Mlc73ncjIKlN/XqgiOl1OwfwCWv1nuIEvHFWeYXQ6M9Vp0iFAAblEgkgCvvbcfaBP6J4
 Ekupj3lxG57yfvnQGS8OzClfTqjV29sXVa2FTpbzKzJ7JslGDbSsBLk6y1RSvJKqPGX7
 +m6uSdLLSxCnvO+e4Z6F6ZysTrAn8TAgo2Qqg4N7X1CXiZqWz8KYtLBku+sqDkklKPon cQ== 
Received: from nalasppmta03.qualcomm.com (Global_NAT1.qualcomm.com
 [129.46.96.20])
 by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 3k9n2p2k77-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Tue, 18 Oct 2022 18:42:30 +0000
Received: from pps.filterd (NALASPPMTA03.qualcomm.com [127.0.0.1])
 by NALASPPMTA03.qualcomm.com (8.17.1.5/8.17.1.5) with ESMTP id 29IIgTCE007138; 
 Tue, 18 Oct 2022 18:42:29 GMT
Received: from pps.reinject (localhost [127.0.0.1])
 by NALASPPMTA03.qualcomm.com (PPS) with ESMTP id 3k7nxkq8nc-1;
 Tue, 18 Oct 2022 18:42:29 +0000
Received: from NALASPPMTA03.qualcomm.com (NALASPPMTA03.qualcomm.com
 [127.0.0.1])
 by pps.reinject (8.17.1.5/8.17.1.5) with ESMTP id 29IIgTXV007133;
 Tue, 18 Oct 2022 18:42:29 GMT
Received: from hu-devc-lv-u18-c.qualcomm.com (hu-tsimpson-lv.qualcomm.com
 [10.47.235.220])
 by NALASPPMTA03.qualcomm.com (PPS) with ESMTP id 29IIgSM5007132;
 Tue, 18 Oct 2022 18:42:29 +0000
Received: by hu-devc-lv-u18-c.qualcomm.com (Postfix, from userid 47164)
 id 99A8A5000A7; Tue, 18 Oct 2022 11:42:28 -0700 (PDT)
From: Taylor Simpson <tsimpson@quicinc.com>
To: qemu-devel@nongnu.org
Cc: tsimpson@quicinc.com, richard.henderson@linaro.org, f4bug@amsat.org,
 ale@rev.ng, anjo@rev.ng, bcain@quicinc.com, quic_mathbern@quicinc.com
Subject: [PATCH] Hexagon (target/hexagon) Add pkt and insn to DisasContext
Date: Tue, 18 Oct 2022 11:42:18 -0700
Message-Id: <20221018184218.32056-2-tsimpson@quicinc.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20221018184218.32056-1-tsimpson@quicinc.com>
References: <20221018184218.32056-1-tsimpson@quicinc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
X-QCInternal: smtphost
X-QCInternal: smtphost
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-ORIG-GUID: C7PZjBt3dKSzQwfv-C5xuzKSOVUg-CrR
X-Proofpoint-GUID: C7PZjBt3dKSzQwfv-C5xuzKSOVUg-CrR
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.205,Aquarius:18.0.895,Hydra:6.0.545,FMLib:17.11.122.1
 definitions=2022-10-18_07,2022-10-18_01,2022-06-22_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 impostorscore=0 clxscore=1015
 mlxscore=0 lowpriorityscore=0 suspectscore=0 bulkscore=0 malwarescore=0
 priorityscore=1501 phishscore=0 mlxlogscore=429 adultscore=0 spamscore=0
 classifier=spam adjust=0 reason=mlx scancount=1 engine=8.12.0-2209130000
 definitions=main-2210180105
Received-SPF: pass client-ip=205.220.168.131;
 envelope-from=tsimpson@qualcomm.com; helo=mx0a-0031df01.pphosted.com
X-Spam_score_int: -24
X-Spam_score: -2.5
X-Spam_bar: --
X-Spam_report: (-2.5 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, HEADER_FROM_DIFFERENT_DOMAINS=0.25,
 RCVD_IN_DNSWL_LOW=-0.7, SPF_HELO_NONE=0.001,
 SPF_PASS=-0.001 autolearn=ham autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: "Qemu-devel" <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>

VGhpcyBlbmFibGVzIHVzIHRvIHJlZHVjZSB0aGUgbnVtYmVyIG9mIHBhcmFtZXRlcnMgdG8gbWFu
eSBmdW5jdGlvbnMKSW4gcGFydGljdWxhciwgdGhlIGdlbmVyYXRlZCBmdW5jdGlvbnMgcHJldmlv
dXNseSB0b29rIGFsbCAzIGFzIGFyZ3VtZW50cwoKTm90IG9ubHkgZG9lcyB0aGlzIHNpbXBsaWZ5
IHRoZSBjb2RlLCBpdCBpbXByb3ZlcyB0aGUgdHJhbnNsYXRpb24gdGltZQoKU2lnbmVkLW9mZi1i
eTogVGF5bG9yIFNpbXBzb24gPHRzaW1wc29uQHF1aWNpbmMuY29tPgotLS0KIHRhcmdldC9oZXhh
Z29uL2dlbl90Y2dfaHZ4LmggICAgfCAgIDQgKy0KIHRhcmdldC9oZXhhZ29uL2luc24uaCAgICAg
ICAgICAgfCAgIDUgKy0KIHRhcmdldC9oZXhhZ29uL21hY3Jvcy5oICAgICAgICAgfCAgMTAgKy0t
CiB0YXJnZXQvaGV4YWdvbi9tbXZlYy9tYWNyb3MuaCAgIHwgICA0ICstCiB0YXJnZXQvaGV4YWdv
bi90cmFuc2xhdGUuaCAgICAgIHwgICA3ICstCiB0YXJnZXQvaGV4YWdvbi9nZW5wdHIuYyAgICAg
ICAgIHwgICA2ICstCiB0YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuYyAgICAgIHwgMTIwICsrKysr
KysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0tCiB0YXJnZXQvaGV4YWdvbi9nZW5fdGNnX2Z1bmNz
LnB5IHwgIDE1ICsrLS0KIDggZmlsZXMgY2hhbmdlZCwgODYgaW5zZXJ0aW9ucygrKSwgODUgZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vZ2VuX3RjZ19odnguaCBiL3Rh
cmdldC9oZXhhZ29uL2dlbl90Y2dfaHZ4LmgKaW5kZXggY2RjYzkzODJiYi4uYzRmYjAwNWE4ZCAx
MDA2NDQKLS0tIGEvdGFyZ2V0L2hleGFnb24vZ2VuX3RjZ19odnguaAorKysgYi90YXJnZXQvaGV4
YWdvbi9nZW5fdGNnX2h2eC5oCkBAIC02OTcsNyArNjk3LDcgQEAgc3RhdGljIGlubGluZSB2b2lk
IGFzc2VydF92aGlzdF90bXAoRGlzYXNDb250ZXh0ICpjdHgpCiAjZGVmaW5lIGZHRU5fVENHX05F
V1ZBTF9WRUNfU1RPUkUoR0VUX0VBLCBJTkMpIFwKICAgICBkbyB7IFwKICAgICAgICAgR0VUX0VB
OyBcCi0gICAgICAgIGdlbl92cmVnX3N0b3JlKGN0eCwgaW5zbiwgcGt0LCBFQSwgT3NOX29mZiwg
aW5zbi0+c2xvdCwgdHJ1ZSk7IFwKKyAgICAgICAgZ2VuX3ZyZWdfc3RvcmUoY3R4LCBFQSwgT3NO
X29mZiwgaW5zbi0+c2xvdCwgdHJ1ZSk7IFwKICAgICAgICAgSU5DOyBcCiAgICAgfSB3aGlsZSAo
MCkKIApAQCAtNzM2LDcgKzczNiw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBhc3NlcnRfdmhpc3Rf
dG1wKERpc2FzQ29udGV4dCAqY3R4KQogICAgICAgICBQUkVEOyBcCiAgICAgICAgIHRjZ19nZW5f
YnJjb25kaV90bChUQ0dfQ09ORF9FUSwgTFNCLCAwLCBmYWxzZV9sYWJlbCk7IFwKICAgICAgICAg
dGNnX3RlbXBfZnJlZShMU0IpOyBcCi0gICAgICAgIGdlbl92cmVnX3N0b3JlKGN0eCwgaW5zbiwg
cGt0LCBFQSwgU1JDT0ZGLCBpbnNuLT5zbG90LCBBTElHTik7IFwKKyAgICAgICAgZ2VuX3ZyZWdf
c3RvcmUoY3R4LCBFQSwgU1JDT0ZGLCBpbnNuLT5zbG90LCBBTElHTik7IFwKICAgICAgICAgSU5D
OyBcCiAgICAgICAgIHRjZ19nZW5fYnIoZW5kX2xhYmVsKTsgXAogICAgICAgICBnZW5fc2V0X2xh
YmVsKGZhbHNlX2xhYmVsKTsgXApkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vaW5zbi5oIGIv
dGFyZ2V0L2hleGFnb24vaW5zbi5oCmluZGV4IGFhMjYzODkxNDcuLmE5MzAxMTg4ODYgMTAwNjQ0
Ci0tLSBhL3RhcmdldC9oZXhhZ29uL2luc24uaAorKysgYi90YXJnZXQvaGV4YWdvbi9pbnNuLmgK
QEAgLTI4LDEwICsyOCw3IEBAIHN0cnVjdCBJbnN0cnVjdGlvbjsKIHN0cnVjdCBQYWNrZXQ7CiBz
dHJ1Y3QgRGlzYXNDb250ZXh0OwogCi10eXBlZGVmIHZvaWQgKCpTZW1hbnRpY0luc24pKENQVUhl
eGFnb25TdGF0ZSAqZW52LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgRGlz
YXNDb250ZXh0ICpjdHgsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBJbnN0
cnVjdGlvbiAqaW5zbiwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IFBhY2tl
dCAqcGt0KTsKK3R5cGVkZWYgdm9pZCAoKlNlbWFudGljSW5zbikoc3RydWN0IERpc2FzQ29udGV4
dCAqY3R4KTsKIAogc3RydWN0IEluc3RydWN0aW9uIHsKICAgICBTZW1hbnRpY0luc24gZ2VuZXJh
dGU7ICAgICAgICAgICAgLyogcG9pbnRlciB0byBnZW5wdHIgcm91dGluZSAqLwpkaWZmIC0tZ2l0
IGEvdGFyZ2V0L2hleGFnb24vbWFjcm9zLmggYi90YXJnZXQvaGV4YWdvbi9tYWNyb3MuaAppbmRl
eCBjODgwNWJkYWViLi45M2VlNDczOWExIDEwMDY0NAotLS0gYS90YXJnZXQvaGV4YWdvbi9tYWNy
b3MuaAorKysgYi90YXJnZXQvaGV4YWdvbi9tYWNyb3MuaApAQCAtOTQsOSArOTQsOSBAQAogICov
CiAjZGVmaW5lIENIRUNLX05PU0hVRihWQSwgU0laRSkgXAogICAgIGRvIHsgXAotICAgICAgICBp
ZiAoaW5zbi0+c2xvdCA9PSAwICYmIHBrdC0+cGt0X2hhc19zdG9yZV9zMSkgeyBcCisgICAgICAg
IGlmIChpbnNuLT5zbG90ID09IDAgJiYgY3R4LT5wa3QtPnBrdF9oYXNfc3RvcmVfczEpIHsgXAog
ICAgICAgICAgICAgcHJvYmVfbm9zaHVmX2xvYWQoVkEsIFNJWkUsIGN0eC0+bWVtX2lkeCk7IFwK
LSAgICAgICAgICAgIHByb2Nlc3Nfc3RvcmUoY3R4LCBwa3QsIDEpOyBcCisgICAgICAgICAgICBw
cm9jZXNzX3N0b3JlKGN0eCwgMSk7IFwKICAgICAgICAgfSBcCiAgICAgfSB3aGlsZSAoMCkKIApA
QCAtMTA1LDEyICsxMDUsMTIgQEAKICAgICAgICAgVENHTGFiZWwgKmxhYmVsID0gZ2VuX25ld19s
YWJlbCgpOyBcCiAgICAgICAgIHRjZ19nZW5fYnJjb25kaV90bChUQ0dfQ09ORF9FUSwgUFJFRCwg
MCwgbGFiZWwpOyBcCiAgICAgICAgIEdFVF9FQTsgXAotICAgICAgICBpZiAoaW5zbi0+c2xvdCA9
PSAwICYmIHBrdC0+cGt0X2hhc19zdG9yZV9zMSkgeyBcCisgICAgICAgIGlmIChpbnNuLT5zbG90
ID09IDAgJiYgY3R4LT5wa3QtPnBrdF9oYXNfc3RvcmVfczEpIHsgXAogICAgICAgICAgICAgcHJv
YmVfbm9zaHVmX2xvYWQoRUEsIFNJWkUsIGN0eC0+bWVtX2lkeCk7IFwKICAgICAgICAgfSBcCiAg
ICAgICAgIGdlbl9zZXRfbGFiZWwobGFiZWwpOyBcCi0gICAgICAgIGlmIChpbnNuLT5zbG90ID09
IDAgJiYgcGt0LT5wa3RfaGFzX3N0b3JlX3MxKSB7IFwKLSAgICAgICAgICAgIHByb2Nlc3Nfc3Rv
cmUoY3R4LCBwa3QsIDEpOyBcCisgICAgICAgIGlmIChpbnNuLT5zbG90ID09IDAgJiYgY3R4LT5w
a3QtPnBrdF9oYXNfc3RvcmVfczEpIHsgXAorICAgICAgICAgICAgcHJvY2Vzc19zdG9yZShjdHgs
IDEpOyBcCiAgICAgICAgIH0gXAogICAgIH0gd2hpbGUgKDApCiAKZGlmZiAtLWdpdCBhL3Rhcmdl
dC9oZXhhZ29uL21tdmVjL21hY3Jvcy5oIGIvdGFyZ2V0L2hleGFnb24vbW12ZWMvbWFjcm9zLmgK
aW5kZXggODM0NTc1MzU4MC4uOGM4NjRlOGM2OCAxMDA2NDQKLS0tIGEvdGFyZ2V0L2hleGFnb24v
bW12ZWMvbWFjcm9zLmgKKysrIGIvdGFyZ2V0L2hleGFnb24vbW12ZWMvbWFjcm9zLmgKQEAgLTI4
OCw3ICsyODgsNyBAQAogI2VuZGlmCiAjaWZkZWYgUUVNVV9HRU5FUkFURQogI2RlZmluZSBmU1RP
UkVNTVYoRUEsIFNSQykgXAotICAgIGdlbl92cmVnX3N0b3JlKGN0eCwgaW5zbiwgcGt0LCBFQSwg
U1JDIyNfb2ZmLCBpbnNuLT5zbG90LCB0cnVlKQorICAgIGdlbl92cmVnX3N0b3JlKGN0eCwgRUEs
IFNSQyMjX29mZiwgaW5zbi0+c2xvdCwgdHJ1ZSkKICNlbmRpZgogI2lmZGVmIFFFTVVfR0VORVJB
VEUKICNkZWZpbmUgZlNUT1JFTU1WUShFQSwgU1JDLCBNQVNLKSBcCkBAIC0zMDAsNyArMzAwLDcg
QEAKICNlbmRpZgogI2lmZGVmIFFFTVVfR0VORVJBVEUKICNkZWZpbmUgZlNUT1JFTU1WVShFQSwg
U1JDKSBcCi0gICAgZ2VuX3ZyZWdfc3RvcmUoY3R4LCBpbnNuLCBwa3QsIEVBLCBTUkMjI19vZmYs
IGluc24tPnNsb3QsIGZhbHNlKQorICAgIGdlbl92cmVnX3N0b3JlKGN0eCwgRUEsIFNSQyMjX29m
ZiwgaW5zbi0+c2xvdCwgZmFsc2UpCiAjZW5kaWYKICNkZWZpbmUgZlZGT1JFQUNIKFdJRFRILCBW
QVIpIGZvciAoVkFSID0gMDsgVkFSIDwgZlZFTEVNKFdJRFRIKTsgVkFSKyspCiAjZGVmaW5lIGZW
QVJSQVlfRUxFTUVOVF9BQ0NFU1MoQVJSQVksIFRZUEUsIElOREVYKSBcCmRpZmYgLS1naXQgYS90
YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuaCBiL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5oCmlu
ZGV4IGEyNDUxNzI4MjcuLjU4ZGJlZDcxY2YgMTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29uL3Ry
YW5zbGF0ZS5oCisrKyBiL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5oCkBAIC0yMywxMCArMjMs
MTMgQEAKICNpbmNsdWRlICJjcHUuaCIKICNpbmNsdWRlICJleGVjL3RyYW5zbGF0b3IuaCIKICNp
bmNsdWRlICJ0Y2cvdGNnLW9wLmgiCisjaW5jbHVkZSAiaW5zbi5oIgogI2luY2x1ZGUgImludGVy
bmFsLmgiCiAKIHR5cGVkZWYgc3RydWN0IERpc2FzQ29udGV4dCB7CiAgICAgRGlzYXNDb250ZXh0
QmFzZSBiYXNlOworICAgIFBhY2tldCAqcGt0OworICAgIEluc24gKmluc247CiAgICAgdWludDMy
X3QgbWVtX2lkeDsKICAgICB1aW50MzJfdCBudW1fcGFja2V0czsKICAgICB1aW50MzJfdCBudW1f
aW5zbnM7CkBAIC0xNDcsNiArMTUwLDYgQEAgZXh0ZXJuIFRDR3YgaGV4X3ZzdG9yZV9hZGRyW1ZT
VE9SRVNfTUFYXTsKIGV4dGVybiBUQ0d2IGhleF92c3RvcmVfc2l6ZVtWU1RPUkVTX01BWF07CiBl
eHRlcm4gVENHdiBoZXhfdnN0b3JlX3BlbmRpbmdbVlNUT1JFU19NQVhdOwogCi1ib29sIGlzX2dh
dGhlcl9zdG9yZV9pbnNuKEluc24gKmluc24sIFBhY2tldCAqcGt0KTsKLXZvaWQgcHJvY2Vzc19z
dG9yZShEaXNhc0NvbnRleHQgKmN0eCwgUGFja2V0ICpwa3QsIGludCBzbG90X251bSk7Citib29s
IGlzX2dhdGhlcl9zdG9yZV9pbnNuKERpc2FzQ29udGV4dCAqY3R4KTsKK3ZvaWQgcHJvY2Vzc19z
dG9yZShEaXNhc0NvbnRleHQgKmN0eCwgaW50IHNsb3RfbnVtKTsKICNlbmRpZgpkaWZmIC0tZ2l0
IGEvdGFyZ2V0L2hleGFnb24vZ2VucHRyLmMgYi90YXJnZXQvaGV4YWdvbi9nZW5wdHIuYwppbmRl
eCA4MDZkMDk3NGZmLi44NTQxNmRkNTMwIDEwMDY0NAotLS0gYS90YXJnZXQvaGV4YWdvbi9nZW5w
dHIuYworKysgYi90YXJnZXQvaGV4YWdvbi9nZW5wdHIuYwpAQCAtNTUxLDEzICs1NTEsMTMgQEAg
c3RhdGljIHZvaWQgZ2VuX3ZyZWdfbG9hZChEaXNhc0NvbnRleHQgKmN0eCwgaW50cHRyX3QgZHN0
b2ZmLCBUQ0d2IHNyYywKICAgICB0Y2dfdGVtcF9mcmVlX2k2NCh0bXApOwogfQogCi1zdGF0aWMg
dm9pZCBnZW5fdnJlZ19zdG9yZShEaXNhc0NvbnRleHQgKmN0eCwgSW5zbiAqaW5zbiwgUGFja2V0
ICpwa3QsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICBUQ0d2IEVBLCBpbnRwdHJfdCBzcmNv
ZmYsIGludCBzbG90LCBib29sIGFsaWduZWQpCitzdGF0aWMgdm9pZCBnZW5fdnJlZ19zdG9yZShE
aXNhc0NvbnRleHQgKmN0eCwgVENHdiBFQSwgaW50cHRyX3Qgc3Jjb2ZmLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgaW50IHNsb3QsIGJvb2wgYWxpZ25lZCkKIHsKICAgICBpbnRwdHJfdCBk
c3RvZmYgPSBvZmZzZXRvZihDUFVIZXhhZ29uU3RhdGUsIHZzdG9yZVtzbG90XS5kYXRhKTsKICAg
ICBpbnRwdHJfdCBtYXNrb2ZmID0gb2Zmc2V0b2YoQ1BVSGV4YWdvblN0YXRlLCB2c3RvcmVbc2xv
dF0ubWFzayk7CiAKLSAgICBpZiAoaXNfZ2F0aGVyX3N0b3JlX2luc24oaW5zbiwgcGt0KSkgewor
ICAgIGlmIChpc19nYXRoZXJfc3RvcmVfaW5zbihjdHgpKSB7CiAgICAgICAgIFRDR3Ygc2wgPSB0
Y2dfY29uc3RhbnRfdGwoc2xvdCk7CiAgICAgICAgIGdlbl9oZWxwZXJfZ2F0aGVyX3N0b3JlKGNw
dV9lbnYsIEVBLCBzbCk7CiAgICAgICAgIHJldHVybjsKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhh
Z29uL3RyYW5zbGF0ZS5jIGIvdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmMKaW5kZXggMjMyOTE3
NzUzNy4uMDk0MGQwZjJjMSAxMDA2NDQKLS0tIGEvdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmMK
KysrIGIvdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmMKQEAgLTIwOSw4ICsyMDksOSBAQCBzdGF0
aWMgYm9vbCBuZWVkX3ByZWRfd3JpdHRlbihQYWNrZXQgKnBrdCkKICAgICByZXR1cm4gY2hlY2tf
Zm9yX2F0dHJpYihwa3QsIEFfV1JJVEVTX1BSRURfUkVHKTsKIH0KIAotc3RhdGljIHZvaWQgZ2Vu
X3N0YXJ0X3BhY2tldChEaXNhc0NvbnRleHQgKmN0eCwgUGFja2V0ICpwa3QpCitzdGF0aWMgdm9p
ZCBnZW5fc3RhcnRfcGFja2V0KERpc2FzQ29udGV4dCAqY3R4KQogeworICAgIFBhY2tldCAqcGt0
ID0gY3R4LT5wa3Q7CiAgICAgdGFyZ2V0X3Vsb25nIG5leHRfUEMgPSBjdHgtPmJhc2UucGNfbmV4
dCArIHBrdC0+ZW5jb2RfcGt0X3NpemVfaW5fYnl0ZXM7CiAgICAgaW50IGk7CiAKQEAgLTI2MCw4
ICsyNjEsMTAgQEAgc3RhdGljIHZvaWQgZ2VuX3N0YXJ0X3BhY2tldChEaXNhc0NvbnRleHQgKmN0
eCwgUGFja2V0ICpwa3QpCiAgICAgfQogfQogCi1ib29sIGlzX2dhdGhlcl9zdG9yZV9pbnNuKElu
c24gKmluc24sIFBhY2tldCAqcGt0KQorYm9vbCBpc19nYXRoZXJfc3RvcmVfaW5zbihEaXNhc0Nv
bnRleHQgKmN0eCkKIHsKKyAgICBQYWNrZXQgKnBrdCA9IGN0eC0+cGt0OworICAgIEluc24gKmlu
c24gPSBjdHgtPmluc247CiAgICAgaWYgKEdFVF9BVFRSSUIoaW5zbi0+b3Bjb2RlLCBBX0NWSV9O
RVcpICYmCiAgICAgICAgIGluc24tPm5ld192YWx1ZV9wcm9kdWNlcl9zbG90ID09IDEpIHsKICAg
ICAgICAgLyogTG9vayBmb3IgZ2F0aGVyIGluc3RydWN0aW9uICovCkBAIC0yODAsMTUgKzI4Mywx
NSBAQCBib29sIGlzX2dhdGhlcl9zdG9yZV9pbnNuKEluc24gKmluc24sIFBhY2tldCAqcGt0KQog
ICogSG93ZXZlciwgdGhlcmUgYXJlIHNvbWUgaW1wbGljaXQgd3JpdGVzIG1hcmtlZCBhcyBhdHRy
aWJ1dGVzCiAgKiBvZiB0aGUgYXBwbGljYWJsZSBpbnN0cnVjdGlvbnMuCiAgKi8KLXN0YXRpYyB2
b2lkIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKERpc2FzQ29udGV4dCAqY3R4LCBJbnNuICppbnNu
LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGF0dHJpYiwgaW50IHJu
dW0pCitzdGF0aWMgdm9pZCBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShEaXNhc0NvbnRleHQgKmN0
eCwgaW50IGF0dHJpYiwgaW50IHJudW0pCiB7Ci0gICAgaWYgKEdFVF9BVFRSSUIoaW5zbi0+b3Bj
b2RlLCBhdHRyaWIpKSB7CisgICAgdWludDE2X3Qgb3Bjb2RlID0gY3R4LT5pbnNuLT5vcGNvZGU7
CisgICAgaWYgKEdFVF9BVFRSSUIob3Bjb2RlLCBhdHRyaWIpKSB7CiAgICAgICAgIC8qCiAgICAg
ICAgICAqIFVTUiBpcyB1c2VkIHRvIHNldCBvdmVyZmxvdyBhbmQgRlAgZXhjZXB0aW9ucywKICAg
ICAgICAgICogc28gdHJlYXQgaXQgYXMgY29uZGl0aW9uYWwKICAgICAgICAgICovCi0gICAgICAg
IGJvb2wgaXNfcHJlZGljYXRlZCA9IEdFVF9BVFRSSUIoaW5zbi0+b3Bjb2RlLCBBX0NPTkRFWEVD
KSB8fAorICAgICAgICBib29sIGlzX3ByZWRpY2F0ZWQgPSBHRVRfQVRUUklCKG9wY29kZSwgQV9D
T05ERVhFQykgfHwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm51bSA9PSBIRVhfUkVH
X1VTUjsKICAgICAgICAgaWYgKGlzX3ByZWRpY2F0ZWQgJiYgIWlzX3ByZWxvYWRlZChjdHgsIHJu
dW0pKSB7CiAgICAgICAgICAgICB0Y2dfZ2VuX21vdl90bChoZXhfbmV3X3ZhbHVlW3JudW1dLCBo
ZXhfZ3ByW3JudW1dKTsKQEAgLTI5OCwzOSArMzAxLDM4IEBAIHN0YXRpYyB2b2lkIG1hcmtfaW1w
bGljaXRfcmVnX3dyaXRlKERpc2FzQ29udGV4dCAqY3R4LCBJbnNuICppbnNuLAogICAgIH0KIH0K
IAotc3RhdGljIHZvaWQgbWFya19pbXBsaWNpdF9wcmVkX3dyaXRlKERpc2FzQ29udGV4dCAqY3R4
LCBJbnNuICppbnNuLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBh
dHRyaWIsIGludCBwbnVtKQorc3RhdGljIHZvaWQgbWFya19pbXBsaWNpdF9wcmVkX3dyaXRlKERp
c2FzQ29udGV4dCAqY3R4LCBpbnQgYXR0cmliLCBpbnQgcG51bSkKIHsKLSAgICBpZiAoR0VUX0FU
VFJJQihpbnNuLT5vcGNvZGUsIGF0dHJpYikpIHsKKyAgICBpZiAoR0VUX0FUVFJJQihjdHgtPmlu
c24tPm9wY29kZSwgYXR0cmliKSkgewogICAgICAgICBjdHhfbG9nX3ByZWRfd3JpdGUoY3R4LCBw
bnVtKTsKICAgICB9CiB9CiAKLXN0YXRpYyB2b2lkIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlcyhE
aXNhc0NvbnRleHQgKmN0eCwgSW5zbiAqaW5zbikKK3N0YXRpYyB2b2lkIG1hcmtfaW1wbGljaXRf
cmVnX3dyaXRlcyhEaXNhc0NvbnRleHQgKmN0eCkKIHsKLSAgICBtYXJrX2ltcGxpY2l0X3JlZ193
cml0ZShjdHgsIGluc24sIEFfSU1QTElDSVRfV1JJVEVTX0ZQLCAgSEVYX1JFR19GUCk7Ci0gICAg
bWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBpbnNuLCBBX0lNUExJQ0lUX1dSSVRFU19TUCwg
IEhFWF9SRUdfU1ApOwotICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgaW5zbiwgQV9J
TVBMSUNJVF9XUklURVNfTFIsICBIRVhfUkVHX0xSKTsKLSAgICBtYXJrX2ltcGxpY2l0X3JlZ193
cml0ZShjdHgsIGluc24sIEFfSU1QTElDSVRfV1JJVEVTX0xDMCwgSEVYX1JFR19MQzApOwotICAg
IG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgaW5zbiwgQV9JTVBMSUNJVF9XUklURVNfU0Ew
LCBIRVhfUkVHX1NBMCk7Ci0gICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBpbnNuLCBB
X0lNUExJQ0lUX1dSSVRFU19MQzEsIEhFWF9SRUdfTEMxKTsKLSAgICBtYXJrX2ltcGxpY2l0X3Jl
Z193cml0ZShjdHgsIGluc24sIEFfSU1QTElDSVRfV1JJVEVTX1NBMSwgSEVYX1JFR19TQTEpOwot
ICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgaW5zbiwgQV9JTVBMSUNJVF9XUklURVNf
VVNSLCBIRVhfUkVHX1VTUik7Ci0gICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBpbnNu
LCBBX0ZQT1AsIEhFWF9SRUdfVVNSKTsKKyAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgs
IEFfSU1QTElDSVRfV1JJVEVTX0ZQLCAgSEVYX1JFR19GUCk7CisgICAgbWFya19pbXBsaWNpdF9y
ZWdfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19TUCwgIEhFWF9SRUdfU1ApOworICAgIG1h
cmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfTFIsICBIRVhfUkVH
X0xSKTsKKyAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVT
X0xDMCwgSEVYX1JFR19MQzApOworICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9J
TVBMSUNJVF9XUklURVNfU0EwLCBIRVhfUkVHX1NBMCk7CisgICAgbWFya19pbXBsaWNpdF9yZWdf
d3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19MQzEsIEhFWF9SRUdfTEMxKTsKKyAgICBtYXJr
X2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX1NBMSwgSEVYX1JFR19T
QTEpOworICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNf
VVNSLCBIRVhfUkVHX1VTUik7CisgICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0ZQ
T1AsIEhFWF9SRUdfVVNSKTsKIH0KIAotc3RhdGljIHZvaWQgbWFya19pbXBsaWNpdF9wcmVkX3dy
aXRlcyhEaXNhc0NvbnRleHQgKmN0eCwgSW5zbiAqaW5zbikKK3N0YXRpYyB2b2lkIG1hcmtfaW1w
bGljaXRfcHJlZF93cml0ZXMoRGlzYXNDb250ZXh0ICpjdHgpCiB7Ci0gICAgbWFya19pbXBsaWNp
dF9wcmVkX3dyaXRlKGN0eCwgaW5zbiwgQV9JTVBMSUNJVF9XUklURVNfUDAsIDApOwotICAgIG1h
cmtfaW1wbGljaXRfcHJlZF93cml0ZShjdHgsIGluc24sIEFfSU1QTElDSVRfV1JJVEVTX1AxLCAx
KTsKLSAgICBtYXJrX2ltcGxpY2l0X3ByZWRfd3JpdGUoY3R4LCBpbnNuLCBBX0lNUExJQ0lUX1dS
SVRFU19QMiwgMik7Ci0gICAgbWFya19pbXBsaWNpdF9wcmVkX3dyaXRlKGN0eCwgaW5zbiwgQV9J
TVBMSUNJVF9XUklURVNfUDMsIDMpOworICAgIG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZShjdHgs
IEFfSU1QTElDSVRfV1JJVEVTX1AwLCAwKTsKKyAgICBtYXJrX2ltcGxpY2l0X3ByZWRfd3JpdGUo
Y3R4LCBBX0lNUExJQ0lUX1dSSVRFU19QMSwgMSk7CisgICAgbWFya19pbXBsaWNpdF9wcmVkX3dy
aXRlKGN0eCwgQV9JTVBMSUNJVF9XUklURVNfUDIsIDIpOworICAgIG1hcmtfaW1wbGljaXRfcHJl
ZF93cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX1AzLCAzKTsKIH0KIAotc3RhdGljIHZvaWQg
bWFya19zdG9yZV93aWR0aChEaXNhc0NvbnRleHQgKmN0eCwgSW5zbiAqaW5zbikKK3N0YXRpYyB2
b2lkIG1hcmtfc3RvcmVfd2lkdGgoRGlzYXNDb250ZXh0ICpjdHgpCiB7Ci0gICAgdWludDE2X3Qg
b3Bjb2RlID0gaW5zbi0+b3Bjb2RlOwotICAgIHVpbnQzMl90IHNsb3QgPSBpbnNuLT5zbG90Owor
ICAgIHVpbnQxNl90IG9wY29kZSA9IGN0eC0+aW5zbi0+b3Bjb2RlOworICAgIHVpbnQzMl90IHNs
b3QgPSBjdHgtPmluc24tPnNsb3Q7CiAgICAgdWludDhfdCB3aWR0aCA9IDA7CiAKICAgICBpZiAo
R0VUX0FUVFJJQihvcGNvZGUsIEFfU0NBTEFSX1NUT1JFKSkgewpAQCAtMzUxLDE0ICszNTMsMTMg
QEAgc3RhdGljIHZvaWQgbWFya19zdG9yZV93aWR0aChEaXNhc0NvbnRleHQgKmN0eCwgSW5zbiAq
aW5zbikKICAgICB9CiB9CiAKLXN0YXRpYyB2b2lkIGdlbl9pbnNuKENQVUhleGFnb25TdGF0ZSAq
ZW52LCBEaXNhc0NvbnRleHQgKmN0eCwKLSAgICAgICAgICAgICAgICAgICAgIEluc24gKmluc24s
IFBhY2tldCAqcGt0KQorc3RhdGljIHZvaWQgZ2VuX2luc24oRGlzYXNDb250ZXh0ICpjdHgpCiB7
Ci0gICAgaWYgKGluc24tPmdlbmVyYXRlKSB7Ci0gICAgICAgIG1hcmtfaW1wbGljaXRfcmVnX3dy
aXRlcyhjdHgsIGluc24pOwotICAgICAgICBpbnNuLT5nZW5lcmF0ZShlbnYsIGN0eCwgaW5zbiwg
cGt0KTsKLSAgICAgICAgbWFya19pbXBsaWNpdF9wcmVkX3dyaXRlcyhjdHgsIGluc24pOwotICAg
ICAgICBtYXJrX3N0b3JlX3dpZHRoKGN0eCwgaW5zbik7CisgICAgaWYgKGN0eC0+aW5zbi0+Z2Vu
ZXJhdGUpIHsKKyAgICAgICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGVzKGN0eCk7CisgICAgICAg
IGN0eC0+aW5zbi0+Z2VuZXJhdGUoY3R4KTsKKyAgICAgICAgbWFya19pbXBsaWNpdF9wcmVkX3dy
aXRlcyhjdHgpOworICAgICAgICBtYXJrX3N0b3JlX3dpZHRoKGN0eCk7CiAgICAgfSBlbHNlIHsK
ICAgICAgICAgZ2VuX2V4Y2VwdGlvbl9lbmRfdGIoY3R4LCBIRVhfRVhDUF9JTlZBTElEX09QQ09E
RSk7CiAgICAgfQpAQCAtMzc4LDcgKzM3OSw3IEBAIHN0YXRpYyB2b2lkIGdlbl9yZWdfd3JpdGVz
KERpc2FzQ29udGV4dCAqY3R4KQogICAgIH0KIH0KIAotc3RhdGljIHZvaWQgZ2VuX3ByZWRfd3Jp
dGVzKERpc2FzQ29udGV4dCAqY3R4LCBQYWNrZXQgKnBrdCkKK3N0YXRpYyB2b2lkIGdlbl9wcmVk
X3dyaXRlcyhEaXNhc0NvbnRleHQgKmN0eCkKIHsKICAgICBpbnQgaTsKIApAQCAtMzkzLDcgKzM5
NCw3IEBAIHN0YXRpYyB2b2lkIGdlbl9wcmVkX3dyaXRlcyhEaXNhc0NvbnRleHQgKmN0eCwgUGFj
a2V0ICpwa3QpCiAgICAgICogaW5zdHJ1Y3Rpb25zLCB3ZSBjYW4gdXNlIHRoZSBub24tY29uZGl0
aW9uYWwKICAgICAgKiB3cml0ZSBvZiB0aGUgcHJlZGljYXRlcy4KICAgICAgKi8KLSAgICBpZiAo
cGt0LT5wa3RfaGFzX2VuZGxvb3ApIHsKKyAgICBpZiAoY3R4LT5wa3QtPnBrdF9oYXNfZW5kbG9v
cCkgewogICAgICAgICBUQ0d2IHplcm8gPSB0Y2dfY29uc3RhbnRfdGwoMCk7CiAgICAgICAgIFRD
R3YgcHJlZF93cml0dGVuID0gdGNnX3RlbXBfbmV3KCk7CiAgICAgICAgIGZvciAoaSA9IDA7IGkg
PCBjdHgtPnByZWdfbG9nX2lkeDsgaSsrKSB7CkBAIC00MzksOSArNDQwLDkgQEAgc3RhdGljIGJv
b2wgc2xvdF9pc19wcmVkaWNhdGVkKFBhY2tldCAqcGt0LCBpbnQgc2xvdF9udW0pCiAgICAgZ19h
c3NlcnRfbm90X3JlYWNoZWQoKTsKIH0KIAotdm9pZCBwcm9jZXNzX3N0b3JlKERpc2FzQ29udGV4
dCAqY3R4LCBQYWNrZXQgKnBrdCwgaW50IHNsb3RfbnVtKQordm9pZCBwcm9jZXNzX3N0b3JlKERp
c2FzQ29udGV4dCAqY3R4LCBpbnQgc2xvdF9udW0pCiB7Ci0gICAgYm9vbCBpc19wcmVkaWNhdGVk
ID0gc2xvdF9pc19wcmVkaWNhdGVkKHBrdCwgc2xvdF9udW0pOworICAgIGJvb2wgaXNfcHJlZGlj
YXRlZCA9IHNsb3RfaXNfcHJlZGljYXRlZChjdHgtPnBrdCwgc2xvdF9udW0pOwogICAgIFRDR0xh
YmVsICpsYWJlbF9lbmQgPSBOVUxMOwogCiAgICAgLyoKQEAgLTUxNywyNyArNTE4LDI4IEBAIHZv
aWQgcHJvY2Vzc19zdG9yZShEaXNhc0NvbnRleHQgKmN0eCwgUGFja2V0ICpwa3QsIGludCBzbG90
X251bSkKICAgICB9CiB9CiAKLXN0YXRpYyB2b2lkIHByb2Nlc3Nfc3RvcmVfbG9nKERpc2FzQ29u
dGV4dCAqY3R4LCBQYWNrZXQgKnBrdCkKK3N0YXRpYyB2b2lkIHByb2Nlc3Nfc3RvcmVfbG9nKERp
c2FzQ29udGV4dCAqY3R4KQogewogICAgIC8qCiAgICAgICogIFdoZW4gYSBwYWNrZXQgaGFzIHR3
byBzdG9yZXMsIHRoZSBoYXJkd2FyZSBwcm9jZXNzZXMKICAgICAgKiAgc2xvdCAxIGFuZCB0aGVu
IHNsb3QgMC4gIFRoaXMgd2lsbCBiZSBpbXBvcnRhbnQgd2hlbgogICAgICAqICB0aGUgbWVtb3J5
IGFjY2Vzc2VzIG92ZXJsYXAuCiAgICAgICovCisgICAgUGFja2V0ICpwa3QgPSBjdHgtPnBrdDsK
ICAgICBpZiAocGt0LT5wa3RfaGFzX3N0b3JlX3MxKSB7CiAgICAgICAgIGdfYXNzZXJ0KCFwa3Qt
PnBrdF9oYXNfZGN6ZXJvYSk7Ci0gICAgICAgIHByb2Nlc3Nfc3RvcmUoY3R4LCBwa3QsIDEpOwor
ICAgICAgICBwcm9jZXNzX3N0b3JlKGN0eCwgMSk7CiAgICAgfQogICAgIGlmIChwa3QtPnBrdF9o
YXNfc3RvcmVfczApIHsKICAgICAgICAgZ19hc3NlcnQoIXBrdC0+cGt0X2hhc19kY3plcm9hKTsK
LSAgICAgICAgcHJvY2Vzc19zdG9yZShjdHgsIHBrdCwgMCk7CisgICAgICAgIHByb2Nlc3Nfc3Rv
cmUoY3R4LCAwKTsKICAgICB9CiB9CiAKIC8qIFplcm8gb3V0IGEgMzItYml0IGNhY2hlIGxpbmUg
Ki8KLXN0YXRpYyB2b2lkIHByb2Nlc3NfZGN6ZXJvYShEaXNhc0NvbnRleHQgKmN0eCwgUGFja2V0
ICpwa3QpCitzdGF0aWMgdm9pZCBwcm9jZXNzX2RjemVyb2EoRGlzYXNDb250ZXh0ICpjdHgpCiB7
Ci0gICAgaWYgKHBrdC0+cGt0X2hhc19kY3plcm9hKSB7CisgICAgaWYgKGN0eC0+cGt0LT5wa3Rf
aGFzX2RjemVyb2EpIHsKICAgICAgICAgLyogU3RvcmUgMzIgYnl0ZXMgb2YgemVybyBzdGFydGlu
ZyBhdCAoYWRkciAmIH4weDFmKSAqLwogICAgICAgICBUQ0d2IGFkZHIgPSB0Y2dfdGVtcF9uZXco
KTsKICAgICAgICAgVENHdl9pNjQgemVybyA9IHRjZ19jb25zdGFudF9pNjQoMCk7CkBAIC01Njcs
NyArNTY5LDcgQEAgc3RhdGljIGJvb2wgcGt0X2hhc19odnhfc3RvcmUoUGFja2V0ICpwa3QpCiAg
ICAgcmV0dXJuIGZhbHNlOwogfQogCi1zdGF0aWMgdm9pZCBnZW5fY29tbWl0X2h2eChEaXNhc0Nv
bnRleHQgKmN0eCwgUGFja2V0ICpwa3QpCitzdGF0aWMgdm9pZCBnZW5fY29tbWl0X2h2eChEaXNh
c0NvbnRleHQgKmN0eCkKIHsKICAgICBpbnQgaTsKIApAQCAtNjM3LDEzICs2MzksMTQgQEAgc3Rh
dGljIHZvaWQgZ2VuX2NvbW1pdF9odngoRGlzYXNDb250ZXh0ICpjdHgsIFBhY2tldCAqcGt0KQog
ICAgICAgICB9CiAgICAgfQogCi0gICAgaWYgKHBrdF9oYXNfaHZ4X3N0b3JlKHBrdCkpIHsKKyAg
ICBpZiAocGt0X2hhc19odnhfc3RvcmUoY3R4LT5wa3QpKSB7CiAgICAgICAgIGdlbl9oZWxwZXJf
Y29tbWl0X2h2eF9zdG9yZXMoY3B1X2Vudik7CiAgICAgfQogfQogCi1zdGF0aWMgdm9pZCB1cGRh
dGVfZXhlY19jb3VudGVycyhEaXNhc0NvbnRleHQgKmN0eCwgUGFja2V0ICpwa3QpCitzdGF0aWMg
dm9pZCB1cGRhdGVfZXhlY19jb3VudGVycyhEaXNhc0NvbnRleHQgKmN0eCkKIHsKKyAgICBQYWNr
ZXQgKnBrdCA9IGN0eC0+cGt0OwogICAgIGludCBudW1faW5zbnMgPSBwa3QtPm51bV9pbnNuczsK
ICAgICBpbnQgbnVtX3JlYWxfaW5zbnMgPSAwOwogICAgIGludCBudW1faHZ4X2luc25zID0gMDsK
QEAgLTY2NCw4ICs2NjcsNyBAQCBzdGF0aWMgdm9pZCB1cGRhdGVfZXhlY19jb3VudGVycyhEaXNh
c0NvbnRleHQgKmN0eCwgUGFja2V0ICpwa3QpCiAgICAgY3R4LT5udW1faHZ4X2luc25zICs9IG51
bV9odnhfaW5zbnM7CiB9CiAKLXN0YXRpYyB2b2lkIGdlbl9jb21taXRfcGFja2V0KENQVUhleGFn
b25TdGF0ZSAqZW52LCBEaXNhc0NvbnRleHQgKmN0eCwKLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIFBhY2tldCAqcGt0KQorc3RhdGljIHZvaWQgZ2VuX2NvbW1pdF9wYWNrZXQoRGlzYXND
b250ZXh0ICpjdHgpCiB7CiAgICAgLyoKICAgICAgKiBJZiB0aGVyZSBpcyBtb3JlIHRoYW4gb25l
IHN0b3JlIGluIGEgcGFja2V0LCBtYWtlIHN1cmUgdGhleSBhcmUgYWxsIE9LCkBAIC02ODQsNiAr
Njg2LDcgQEAgc3RhdGljIHZvaWQgZ2VuX2NvbW1pdF9wYWNrZXQoQ1BVSGV4YWdvblN0YXRlICpl
bnYsIERpc2FzQ29udGV4dCAqY3R4LAogICAgICAqIHN0b3JlLiAgVGhlcmVmb3JlLCB3ZSBjYWxs
IHByb2Nlc3Nfc3RvcmVfbG9nIGJlZm9yZSBhbnl0aGluZyBlbHNlCiAgICAgICogaW52b2x2ZWQg
aW4gY29tbWl0dGluZyB0aGUgcGFja2V0LgogICAgICAqLworICAgIFBhY2tldCAqcGt0ID0gY3R4
LT5wa3Q7CiAgICAgYm9vbCBoYXNfc3RvcmVfczAgPSBwa3QtPnBrdF9oYXNfc3RvcmVfczA7CiAg
ICAgYm9vbCBoYXNfc3RvcmVfczEgPSAocGt0LT5wa3RfaGFzX3N0b3JlX3MxICYmICFjdHgtPnMx
X3N0b3JlX3Byb2Nlc3NlZCk7CiAgICAgYm9vbCBoYXNfaHZ4X3N0b3JlID0gcGt0X2hhc19odnhf
c3RvcmUocGt0KTsKQEAgLTY5Myw3ICs2OTYsNyBAQCBzdGF0aWMgdm9pZCBnZW5fY29tbWl0X3Bh
Y2tldChDUFVIZXhhZ29uU3RhdGUgKmVudiwgRGlzYXNDb250ZXh0ICpjdHgsCiAgICAgICAgICAq
IGEgc3RvcmUgaW4gc2xvdCAxIG9yIGFuIEhWWCBzdG9yZS4KICAgICAgICAgICovCiAgICAgICAg
IGdfYXNzZXJ0KCFoYXNfc3RvcmVfczEgJiYgIWhhc19odnhfc3RvcmUpOwotICAgICAgICBwcm9j
ZXNzX2RjemVyb2EoY3R4LCBwa3QpOworICAgICAgICBwcm9jZXNzX2RjemVyb2EoY3R4KTsKICAg
ICB9IGVsc2UgaWYgKGhhc19odnhfc3RvcmUpIHsKICAgICAgICAgVENHdiBtZW1faWR4ID0gdGNn
X2NvbnN0YW50X3RsKGN0eC0+bWVtX2lkeCk7CiAKQEAgLTcyNCwxNCArNzI3LDE0IEBAIHN0YXRp
YyB2b2lkIGdlbl9jb21taXRfcGFja2V0KENQVUhleGFnb25TdGF0ZSAqZW52LCBEaXNhc0NvbnRl
eHQgKmN0eCwKICAgICAgICAgZ2VuX2hlbHBlcl9wcm9iZV9wa3Rfc2NhbGFyX3N0b3JlX3MwKGNw
dV9lbnYsIG1lbV9pZHgpOwogICAgIH0KIAotICAgIHByb2Nlc3Nfc3RvcmVfbG9nKGN0eCwgcGt0
KTsKKyAgICBwcm9jZXNzX3N0b3JlX2xvZyhjdHgpOwogCiAgICAgZ2VuX3JlZ193cml0ZXMoY3R4
KTsKLSAgICBnZW5fcHJlZF93cml0ZXMoY3R4LCBwa3QpOworICAgIGdlbl9wcmVkX3dyaXRlcyhj
dHgpOwogICAgIGlmIChwa3QtPnBrdF9oYXNfaHZ4KSB7Ci0gICAgICAgIGdlbl9jb21taXRfaHZ4
KGN0eCwgcGt0KTsKKyAgICAgICAgZ2VuX2NvbW1pdF9odngoY3R4KTsKICAgICB9Ci0gICAgdXBk
YXRlX2V4ZWNfY291bnRlcnMoY3R4LCBwa3QpOworICAgIHVwZGF0ZV9leGVjX2NvdW50ZXJzKGN0
eCk7CiAgICAgaWYgKEhFWF9ERUJVRykgewogICAgICAgICBUQ0d2IGhhc19zdDAgPQogICAgICAg
ICAgICAgdGNnX2NvbnN0YW50X3RsKHBrdC0+cGt0X2hhc19zdG9yZV9zMCAmJiAhcGt0LT5wa3Rf
aGFzX2RjemVyb2EpOwpAQCAtNzQ0LDcgKzc0Nyw4IEBAIHN0YXRpYyB2b2lkIGdlbl9jb21taXRf
cGFja2V0KENQVUhleGFnb25TdGF0ZSAqZW52LCBEaXNhc0NvbnRleHQgKmN0eCwKIAogICAgIGlm
IChwa3QtPnZoaXN0X2luc24gIT0gTlVMTCkgewogICAgICAgICBjdHgtPnByZV9jb21taXQgPSBm
YWxzZTsKLSAgICAgICAgcGt0LT52aGlzdF9pbnNuLT5nZW5lcmF0ZShlbnYsIGN0eCwgcGt0LT52
aGlzdF9pbnNuLCBwa3QpOworICAgICAgICBjdHgtPmluc24gPSBwa3QtPnZoaXN0X2luc247Cisg
ICAgICAgIHBrdC0+dmhpc3RfaW5zbi0+Z2VuZXJhdGUoY3R4KTsKICAgICB9CiAKICAgICBpZiAo
cGt0LT5wa3RfaGFzX2NvZikgewpAQCAtNzY3LDExICs3NzEsMTMgQEAgc3RhdGljIHZvaWQgZGVj
b2RlX2FuZF90cmFuc2xhdGVfcGFja2V0KENQVUhleGFnb25TdGF0ZSAqZW52LCBEaXNhc0NvbnRl
eHQgKmN0eCkKIAogICAgIGlmIChkZWNvZGVfcGFja2V0KG53b3Jkcywgd29yZHMsICZwa3QsIGZh
bHNlKSA+IDApIHsKICAgICAgICAgSEVYX0RFQlVHX1BSSU5UX1BLVCgmcGt0KTsKLSAgICAgICAg
Z2VuX3N0YXJ0X3BhY2tldChjdHgsICZwa3QpOworICAgICAgICBjdHgtPnBrdCA9ICZwa3Q7Cisg
ICAgICAgIGdlbl9zdGFydF9wYWNrZXQoY3R4KTsKICAgICAgICAgZm9yIChpID0gMDsgaSA8IHBr
dC5udW1faW5zbnM7IGkrKykgewotICAgICAgICAgICAgZ2VuX2luc24oZW52LCBjdHgsICZwa3Qu
aW5zbltpXSwgJnBrdCk7CisgICAgICAgICAgICBjdHgtPmluc24gPSAmcGt0Lmluc25baV07Cisg
ICAgICAgICAgICBnZW5faW5zbihjdHgpOwogICAgICAgICB9Ci0gICAgICAgIGdlbl9jb21taXRf
cGFja2V0KGVudiwgY3R4LCAmcGt0KTsKKyAgICAgICAgZ2VuX2NvbW1pdF9wYWNrZXQoY3R4KTsK
ICAgICAgICAgY3R4LT5iYXNlLnBjX25leHQgKz0gcGt0LmVuY29kX3BrdF9zaXplX2luX2J5dGVz
OwogICAgIH0gZWxzZSB7CiAgICAgICAgIGdlbl9leGNlcHRpb25fZW5kX3RiKGN0eCwgSEVYX0VY
Q1BfSU5WQUxJRF9QQUNLRVQpOwpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vZ2VuX3RjZ19m
dW5jcy5weSBiL3RhcmdldC9oZXhhZ29uL2dlbl90Y2dfZnVuY3MucHkKaW5kZXggNmRlYTAyYjBi
OS4uMDJhNjU2NTY4NSAxMDA3NTUKLS0tIGEvdGFyZ2V0L2hleGFnb24vZ2VuX3RjZ19mdW5jcy5w
eQorKysgYi90YXJnZXQvaGV4YWdvbi9nZW5fdGNnX2Z1bmNzLnB5CkBAIC01NjEsMTEgKzU2MSw3
IEBAIGRlZiBnZW5wdHJfZHN0X3dyaXRlX29wbihmLHJlZ3R5cGUsIHJlZ2lkLCB0YWcpOgogIyMg
R2VuZXJhdGUgdGhlIFRDRyBjb2RlIHRvIGNhbGwgdGhlIGhlbHBlcgogIyMgICAgIEZvciBBMl9h
ZGQ6IFJkMzI9YWRkKFJzMzIsUnQzMiksIHsgUmRWPVJzVitSdFY7fQogIyMgICAgIFdlIHByb2R1
Y2U6Ci0jIyAgICBzdGF0aWMgdm9pZCBnZW5lcmF0ZV9BMl9hZGQoKQotIyMgICAgICAgICAgICAg
ICAgICAgIENQVUhleGFnb25TdGF0ZSAqZW52Ci0jIyAgICAgICAgICAgICAgICAgICAgRGlzYXND
b250ZXh0ICpjdHgsCi0jIyAgICAgICAgICAgICAgICAgICAgSW5zbiAqaW5zbiwKLSMjICAgICAg
ICAgICAgICAgICAgICBQYWNrZXQgKnBrdCkKKyMjICAgIHN0YXRpYyB2b2lkIGdlbmVyYXRlX0Ey
X2FkZChEaXNhc0NvbnRleHQgKmN0eCkKICMjICAgICAgIHsKICMjICAgICAgICAgICBUQ0d2IFJk
ViA9IHRjZ190ZW1wX2xvY2FsX25ldygpOwogIyMgICAgICAgICAgIGNvbnN0IGludCBSZE4gPSBp
bnNuLT5yZWdub1swXTsKQEAgLTU4NCwxMiArNTgwLDExIEBAIGRlZiBnZW5wdHJfZHN0X3dyaXRl
X29wbihmLHJlZ3R5cGUsIHJlZ2lkLCB0YWcpOgogIyMgICAgICAgPEdFTj4gIGlzIGdlbl9oZWxw
ZXJfQTJfYWRkKFJkViwgY3B1X2VudiwgUnNWLCBSdFYpOwogIyMKIGRlZiBnZW5fdGNnX2Z1bmMo
ZiwgdGFnLCByZWdzLCBpbW1zKToKLSAgICBmLndyaXRlKCJzdGF0aWMgdm9pZCBnZW5lcmF0ZV8l
cyhcbiIgJXRhZykKLSAgICBmLndyaXRlKCIgICAgICAgICAgICAgICAgQ1BVSGV4YWdvblN0YXRl
ICplbnYsXG4iKQotICAgIGYud3JpdGUoIiAgICAgICAgICAgICAgICBEaXNhc0NvbnRleHQgKmN0
eCxcbiIpCi0gICAgZi53cml0ZSgiICAgICAgICAgICAgICAgIEluc24gKmluc24sXG4iKQotICAg
IGYud3JpdGUoIiAgICAgICAgICAgICAgICBQYWNrZXQgKnBrdClcbiIpCisgICAgZi53cml0ZSgi
c3RhdGljIHZvaWQgZ2VuZXJhdGVfJXMoRGlzYXNDb250ZXh0ICpjdHgpXG4iICV0YWcpCiAgICAg
Zi53cml0ZSgne1xuJykKKworICAgIGYud3JpdGUoIiAgICBJbnNuICppbnNuIF9fYXR0cmlidXRl
X18oKHVudXNlZCkpID0gY3R4LT5pbnNuO1xuIikKKwogICAgIGlmIGhleF9jb21tb24ubmVlZF9l
YSh0YWcpOiBnZW5fZGVjbF9lYV90Y2coZiwgdGFnKQogICAgIGk9MAogICAgICMjIERlY2xhcmUg
YWxsIHRoZSBvcGVyYW5kcyAocmVncyBhbmQgaW1tZWRpYXRlcykKLS0gCjIuMTcuMQoK

