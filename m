Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id 3B6D46AD6DB
	for <lists+qemu-devel@lfdr.de>; Tue,  7 Mar 2023 06:37:28 +0100 (CET)
Received: from localhost ([::1] helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces@nongnu.org>)
	id 1pZPye-0006ns-3P; Tue, 07 Mar 2023 00:35:08 -0500
Received: from eggs.gnu.org ([2001:470:142:3::10])
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1pZPyO-0006XR-Dr
 for qemu-devel@nongnu.org; Tue, 07 Mar 2023 00:34:53 -0500
Received: from mx0b-0031df01.pphosted.com ([205.220.180.131])
 by eggs.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1pZPyJ-0006Z7-H2
 for qemu-devel@nongnu.org; Tue, 07 Mar 2023 00:34:51 -0500
Received: from pps.filterd (m0279871.ppops.net [127.0.0.1])
 by mx0a-0031df01.pphosted.com (8.17.1.19/8.17.1.19) with ESMTP id
 3274uqTs026951; Tue, 7 Mar 2023 05:34:46 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=quicinc.com;
 h=from : to : cc :
 subject : date : message-id : in-reply-to : references : mime-version :
 content-type : content-transfer-encoding; s=qcppdkim1;
 bh=TLra6tVbkztUxznnaIQdKAMj1MhvtKnNo86q2igw7A0=;
 b=fFJECq6SQ5axGI+lsDxhVqrGp4YHlORCp9PPPAVtxBtAC7y8XIoU+aDENZfyP2ZpU/37
 r2sVaAmFIDvDNblW3r3LY2yxtbobn/2PltENIn9d6f7Lizn6pml6tu9MFg1hwisovJ1S
 QN5SpVkxo2VhhiV+oOjPc+/5TgFmqhSOauMmfarmvkDJ+w41rJMglcDP0Vk2JIhHrbTT
 3xvVvbS3LlRf+P/O1/z4r/2NEuA6/JBBkAA/awbi3w7W/60KFjaEE3YrveXtgDX2Mqs/
 9t9Z1+cl9IEufJeiPg3WnuTuJHY5fjGQK8NdjYAa6eDDNTsu+xc8LFs8aEwTBNnCoXQx rQ== 
Received: from nalasppmta02.qualcomm.com (Global_NAT1.qualcomm.com
 [129.46.96.20])
 by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 3p5wee8831-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Tue, 07 Mar 2023 05:34:46 +0000
Received: from pps.filterd (NALASPPMTA02.qualcomm.com [127.0.0.1])
 by NALASPPMTA02.qualcomm.com (8.17.1.5/8.17.1.5) with ESMTP id 3275YiA4031947; 
 Tue, 7 Mar 2023 05:34:44 GMT
Received: from pps.reinject (localhost [127.0.0.1])
 by NALASPPMTA02.qualcomm.com (PPS) with ESMTPS id 3p4fg0ca7s-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Tue, 07 Mar 2023 05:34:44 +0000
Received: from NALASPPMTA02.qualcomm.com (NALASPPMTA02.qualcomm.com
 [127.0.0.1])
 by pps.reinject (8.17.1.5/8.17.1.5) with ESMTP id 3275YiYZ031928;
 Tue, 7 Mar 2023 05:34:44 GMT
Received: from hu-devc-sd-u20-a-1.qualcomm.com (hu-tsimpson-lv.qualcomm.com
 [10.47.204.221])
 by NALASPPMTA02.qualcomm.com (PPS) with ESMTPS id 3275YhH7031915
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Tue, 07 Mar 2023 05:34:44 +0000
Received: by hu-devc-sd-u20-a-1.qualcomm.com (Postfix, from userid 47164)
 id AF70AA8A; Mon,  6 Mar 2023 21:34:42 -0800 (PST)
From: Taylor Simpson <tsimpson@quicinc.com>
To: qemu-devel@nongnu.org
Cc: tsimpson@quicinc.com, richard.henderson@linaro.org, philmd@linaro.org,
 peter.maydell@linaro.org, bcain@quicinc.com, quic_mathbern@quicinc.com,
 stefanha@redhat.com, ale@rev.ng, anjo@rev.ng
Subject: [PULL 17/17] Hexagon (target/hexagon) Improve code gen for predicated
 HVX instructions
Date: Mon,  6 Mar 2023 21:34:38 -0800
Message-Id: <20230307053438.2416629-18-tsimpson@quicinc.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20230307053438.2416629-1-tsimpson@quicinc.com>
References: <20230307053438.2416629-1-tsimpson@quicinc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
X-QCInternal: smtphost
X-QCInternal: smtphost
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-GUID: g9f-uGrPXgBv8T-EKud9vsmAFdyflA_i
X-Proofpoint-ORIG-GUID: g9f-uGrPXgBv8T-EKud9vsmAFdyflA_i
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.219,Aquarius:18.0.942,Hydra:6.0.573,FMLib:17.11.170.22
 definitions=2023-03-06_14,2023-03-06_01,2023-02-09_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 mlxscore=0 suspectscore=0
 spamscore=0 lowpriorityscore=0 impostorscore=0 adultscore=0
 mlxlogscore=237 priorityscore=1501 phishscore=0 clxscore=1015 bulkscore=0
 malwarescore=0 classifier=spam adjust=0 reason=mlx scancount=1
 engine=8.12.0-2212070000 definitions=main-2303070049
Received-SPF: pass client-ip=205.220.180.131;
 envelope-from=tsimpson@qualcomm.com; helo=mx0b-0031df01.pphosted.com
X-Spam_score_int: -17
X-Spam_score: -1.8
X-Spam_bar: -
X-Spam_report: (-1.8 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, HEADER_FROM_DIFFERENT_DOMAINS=0.25,
 SPF_HELO_NONE=0.001, SPF_PASS=-0.001 autolearn=no autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org

VGhlIGZvbGxvd2luZyBpbXByb3ZlbWVudHMgYXJlIG1hZGUgZm9yIHByZWRpY2F0ZWQgSFZYIGlu
c3RydWN0aW9ucwogICAgRHVyaW5nIGdlbl9jb21taXRfaHZ4LCB1bmNvbmRpdGlvbmFsbHkgbW92
ZSB0aGUgIm5ldyIgdmFsdWUgaW50bwogICAgICAgIHRoZSBkZXN0CiAgICBEb24ndCBzZXQgc2xv
dF9jYW5jZWxsZWQKICAgIFJlbW92ZSBydW50aW1lIGJvb2trZWVwaW5nIG9mIHdoaWNoIHJlZ2lz
dGVycyB3ZXJlIHVwZGF0ZWQKICAgIFJlZHVjZSB0aGUgY2FzZXMgd2hlcmUgZ2VuX2xvZ192cmVn
X3dyaXRlW19wYWlyXSBpcyBjYWxsZWQKICAgICAgICBJdCdzIG9ubHkgbmVlZGVkIGZvciBzcGVj
aWFsIG9wZXJhbmRzIFZ4eFYgYW5kIFZ5VgogICAgUmVtb3ZlIGdlbl9sb2dfcXJlZ193cml0ZQoK
U2lnbmVkLW9mZi1ieTogVGF5bG9yIFNpbXBzb24gPHRzaW1wc29uQHF1aWNpbmMuY29tPgpSZXZp
ZXdlZC1ieTogQW50b24gSm9oYW5zc29uIDxhbmpvQHJldi5uZz4KTWVzc2FnZS1JZDogPDIwMjMw
MzA3MDI1ODI4LjE2MTI4MDktMTUtdHNpbXBzb25AcXVpY2luYy5jb20+Ci0tLQogdGFyZ2V0L2hl
eGFnb24vY3B1LmggICAgICAgICAgICAgICAgfCAgNSArLS0KIHRhcmdldC9oZXhhZ29uL2dlbl90
Y2dfaHZ4LmggICAgICAgIHwgMTcgKy0tLS0tLS0tCiB0YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUu
aCAgICAgICAgICB8IDE1ICsrKy0tLS0tCiB0YXJnZXQvaGV4YWdvbi9nZW5wdHIuYyAgICAgICAg
ICAgICB8IDQ4ICsrKy0tLS0tLS0tLS0tLS0tLS0tLS0tLQogdGFyZ2V0L2hleGFnb24vdHJhbnNs
YXRlLmMgICAgICAgICAgfCA1OCArKystLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogdGFyZ2V0
L2hleGFnb24vUkVBRE1FICAgICAgICAgICAgICAgfCAyMSArKystLS0tLS0tLQogdGFyZ2V0L2hl
eGFnb24vZ2VuX2FuYWx5emVfZnVuY3MucHkgfCAgMyArLQogdGFyZ2V0L2hleGFnb24vZ2VuX3Rj
Z19mdW5jcy5weSAgICAgfCAzNSArKysrLS0tLS0tLS0tLS0tLQogOCBmaWxlcyBjaGFuZ2VkLCAz
NCBpbnNlcnRpb25zKCspLCAxNjggZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hl
eGFnb24vY3B1LmggYi90YXJnZXQvaGV4YWdvbi9jcHUuaAppbmRleCAzNGMwYWUwYTY3Li44MWI2
NjNlY2ZiIDEwMDY0NAotLS0gYS90YXJnZXQvaGV4YWdvbi9jcHUuaAorKysgYi90YXJnZXQvaGV4
YWdvbi9jcHUuaApAQCAtMSw1ICsxLDUgQEAKIC8qCi0gKiAgQ29weXJpZ2h0KGMpIDIwMTktMjAy
MiBRdWFsY29tbSBJbm5vdmF0aW9uIENlbnRlciwgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLgor
ICogIENvcHlyaWdodChjKSAyMDE5LTIwMjMgUXVhbGNvbW0gSW5ub3ZhdGlvbiBDZW50ZXIsIElu
Yy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KICAqCiAgKiAgVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29m
dHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKICAqICBpdCB1bmRl
ciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hl
ZCBieQpAQCAtMTExLDExICsxMTEsOCBAQCB0eXBlZGVmIHN0cnVjdCBDUFVBcmNoU3RhdGUgewog
ICAgIE1NVmVjdG9yIGZ1dHVyZV9WUmVnc1tWRUNUT1JfVEVNUFNfTUFYXSBRRU1VX0FMSUdORUQo
MTYpOwogICAgIE1NVmVjdG9yIHRtcF9WUmVnc1tWRUNUT1JfVEVNUFNfTUFYXSBRRU1VX0FMSUdO
RUQoMTYpOwogCi0gICAgVlJlZ01hc2sgVlJlZ3NfdXBkYXRlZDsKLQogICAgIE1NUVJlZyBRUmVn
c1tOVU1fUVJFR1NdIFFFTVVfQUxJR05FRCgxNik7CiAgICAgTU1RUmVnIGZ1dHVyZV9RUmVnc1tO
VU1fUVJFR1NdIFFFTVVfQUxJR05FRCgxNik7Ci0gICAgUVJlZ01hc2sgUVJlZ3NfdXBkYXRlZDsK
IAogICAgIC8qIFRlbXBvcmFyaWVzIHVzZWQgd2l0aGluIGluc3RydWN0aW9ucyAqLwogICAgIE1N
VmVjdG9yUGFpciBWdXVWIFFFTVVfQUxJR05FRCgxNik7CmRpZmYgLS1naXQgYS90YXJnZXQvaGV4
YWdvbi9nZW5fdGNnX2h2eC5oIGIvdGFyZ2V0L2hleGFnb24vZ2VuX3RjZ19odnguaAppbmRleCA5
NGYyNzJlMjg2Li5kNGFlZmU4ZTNmIDEwMDY0NAotLS0gYS90YXJnZXQvaGV4YWdvbi9nZW5fdGNn
X2h2eC5oCisrKyBiL3RhcmdldC9oZXhhZ29uL2dlbl90Y2dfaHZ4LmgKQEAgLTEsNSArMSw1IEBA
CiAvKgotICogIENvcHlyaWdodChjKSAyMDE5LTIwMjIgUXVhbGNvbW0gSW5ub3ZhdGlvbiBDZW50
ZXIsIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KKyAqICBDb3B5cmlnaHQoYykgMjAxOS0yMDIz
IFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAg
KgogICogIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0
ZSBpdCBhbmQvb3IgbW9kaWZ5CiAgKiAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2Vu
ZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKQEAgLTEzMywxNiArMTMzLDExIEBA
IHN0YXRpYyBpbmxpbmUgdm9pZCBhc3NlcnRfdmhpc3RfdG1wKERpc2FzQ29udGV4dCAqY3R4KQog
ICAgIGRvIHsgXAogICAgICAgICBUQ0d2IGxzYiA9IHRjZ190ZW1wX25ldygpOyBcCiAgICAgICAg
IFRDR0xhYmVsICpmYWxzZV9sYWJlbCA9IGdlbl9uZXdfbGFiZWwoKTsgXAotICAgICAgICBUQ0dM
YWJlbCAqZW5kX2xhYmVsID0gZ2VuX25ld19sYWJlbCgpOyBcCiAgICAgICAgIHRjZ19nZW5fYW5k
aV90bChsc2IsIFBzViwgMSk7IFwKICAgICAgICAgdGNnX2dlbl9icmNvbmRpX3RsKFRDR19DT05E
X05FLCBsc2IsIFBSRUQsIGZhbHNlX2xhYmVsKTsgXAogICAgICAgICB0Y2dfZ2VuX2d2ZWNfbW92
KE1PXzY0LCBWZFZfb2ZmLCBWdVZfb2ZmLCBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6
ZW9mKE1NVmVjdG9yKSwgc2l6ZW9mKE1NVmVjdG9yKSk7IFwKLSAgICAgICAgdGNnX2dlbl9icihl
bmRfbGFiZWwpOyBcCiAgICAgICAgIGdlbl9zZXRfbGFiZWwoZmFsc2VfbGFiZWwpOyBcCi0gICAg
ICAgIHRjZ19nZW5fb3JpX3RsKGhleF9zbG90X2NhbmNlbGxlZCwgaGV4X3Nsb3RfY2FuY2VsbGVk
LCBcCi0gICAgICAgICAgICAgICAgICAgICAgIDEgPDwgaW5zbi0+c2xvdCk7IFwKLSAgICAgICAg
Z2VuX3NldF9sYWJlbChlbmRfbGFiZWwpOyBcCiAgICAgfSB3aGlsZSAoMCkKIAogCkBAIC01NDcs
MTcgKzU0MiwxMiBAQCBzdGF0aWMgaW5saW5lIHZvaWQgYXNzZXJ0X3ZoaXN0X3RtcChEaXNhc0Nv
bnRleHQgKmN0eCkKICAgICBkbyB7IFwKICAgICAgICAgVENHdiBMU0IgPSB0Y2dfdGVtcF9uZXco
KTsgXAogICAgICAgICBUQ0dMYWJlbCAqZmFsc2VfbGFiZWwgPSBnZW5fbmV3X2xhYmVsKCk7IFwK
LSAgICAgICAgVENHTGFiZWwgKmVuZF9sYWJlbCA9IGdlbl9uZXdfbGFiZWwoKTsgXAogICAgICAg
ICBHRVRfRUE7IFwKICAgICAgICAgUFJFRDsgXAogICAgICAgICB0Y2dfZ2VuX2JyY29uZGlfdGwo
VENHX0NPTkRfRVEsIExTQiwgMCwgZmFsc2VfbGFiZWwpOyBcCiAgICAgICAgIGdlbl92cmVnX2xv
YWQoY3R4LCBEU1RPRkYsIEVBLCB0cnVlKTsgXAogICAgICAgICBJTkM7IFwKLSAgICAgICAgdGNn
X2dlbl9icihlbmRfbGFiZWwpOyBcCiAgICAgICAgIGdlbl9zZXRfbGFiZWwoZmFsc2VfbGFiZWwp
OyBcCi0gICAgICAgIHRjZ19nZW5fb3JpX3RsKGhleF9zbG90X2NhbmNlbGxlZCwgaGV4X3Nsb3Rf
Y2FuY2VsbGVkLCBcCi0gICAgICAgICAgICAgICAgICAgICAgIDEgPDwgaW5zbi0+c2xvdCk7IFwK
LSAgICAgICAgZ2VuX3NldF9sYWJlbChlbmRfbGFiZWwpOyBcCiAgICAgfSB3aGlsZSAoMCkKIAog
I2RlZmluZSBmR0VOX1RDR19QUkVEX1ZFQ19MT0FEX3ByZWRfcGkgXApAQCAtNzE3LDE3ICs3MDcs
MTIgQEAgc3RhdGljIGlubGluZSB2b2lkIGFzc2VydF92aGlzdF90bXAoRGlzYXNDb250ZXh0ICpj
dHgpCiAgICAgZG8geyBcCiAgICAgICAgIFRDR3YgTFNCID0gdGNnX3RlbXBfbmV3KCk7IFwKICAg
ICAgICAgVENHTGFiZWwgKmZhbHNlX2xhYmVsID0gZ2VuX25ld19sYWJlbCgpOyBcCi0gICAgICAg
IFRDR0xhYmVsICplbmRfbGFiZWwgPSBnZW5fbmV3X2xhYmVsKCk7IFwKICAgICAgICAgR0VUX0VB
OyBcCiAgICAgICAgIFBSRUQ7IFwKICAgICAgICAgdGNnX2dlbl9icmNvbmRpX3RsKFRDR19DT05E
X0VRLCBMU0IsIDAsIGZhbHNlX2xhYmVsKTsgXAogICAgICAgICBnZW5fdnJlZ19zdG9yZShjdHgs
IEVBLCBTUkNPRkYsIGluc24tPnNsb3QsIEFMSUdOKTsgXAogICAgICAgICBJTkM7IFwKLSAgICAg
ICAgdGNnX2dlbl9icihlbmRfbGFiZWwpOyBcCiAgICAgICAgIGdlbl9zZXRfbGFiZWwoZmFsc2Vf
bGFiZWwpOyBcCi0gICAgICAgIHRjZ19nZW5fb3JpX3RsKGhleF9zbG90X2NhbmNlbGxlZCwgaGV4
X3Nsb3RfY2FuY2VsbGVkLCBcCi0gICAgICAgICAgICAgICAgICAgICAgIDEgPDwgaW5zbi0+c2xv
dCk7IFwKLSAgICAgICAgZ2VuX3NldF9sYWJlbChlbmRfbGFiZWwpOyBcCiAgICAgfSB3aGlsZSAo
MCkKIAogI2RlZmluZSBmR0VOX1RDR19QUkVEX1ZFQ19TVE9SRV9wcmVkX3BpKEFMSUdOKSBcCmRp
ZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuaCBiL3RhcmdldC9oZXhhZ29uL3Ry
YW5zbGF0ZS5oCmluZGV4IDZlNTlhOTBjNDEuLmRiODMyYjBmODggMTAwNjQ0Ci0tLSBhL3Rhcmdl
dC9oZXhhZ29uL3RyYW5zbGF0ZS5oCisrKyBiL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5oCkBA
IC00OSw3ICs0OSw2IEBAIHR5cGVkZWYgc3RydWN0IERpc2FzQ29udGV4dCB7CiAgICAgaW50IHRt
cF92cmVnc19pZHg7CiAgICAgaW50IHRtcF92cmVnc19udW1bVkVDVE9SX1RFTVBTX01BWF07CiAg
ICAgaW50IHZyZWdfbG9nW05VTV9WUkVHU107Ci0gICAgYm9vbCB2cmVnX2lzX3ByZWRpY2F0ZWRb
TlVNX1ZSRUdTXTsKICAgICBpbnQgdnJlZ19sb2dfaWR4OwogICAgIERFQ0xBUkVfQklUTUFQKHZy
ZWdzX3VwZGF0ZWRfdG1wLCBOVU1fVlJFR1MpOwogICAgIERFQ0xBUkVfQklUTUFQKHZyZWdzX3Vw
ZGF0ZWQsIE5VTV9WUkVHUyk7CkBAIC01Nyw3ICs1Niw2IEBAIHR5cGVkZWYgc3RydWN0IERpc2Fz
Q29udGV4dCB7CiAgICAgREVDTEFSRV9CSVRNQVAocHJlZGljYXRlZF9mdXR1cmVfdnJlZ3MsIE5V
TV9WUkVHUyk7CiAgICAgREVDTEFSRV9CSVRNQVAocHJlZGljYXRlZF90bXBfdnJlZ3MsIE5VTV9W
UkVHUyk7CiAgICAgaW50IHFyZWdfbG9nW05VTV9RUkVHU107Ci0gICAgYm9vbCBxcmVnX2lzX3By
ZWRpY2F0ZWRbTlVNX1FSRUdTXTsKICAgICBpbnQgcXJlZ19sb2dfaWR4OwogICAgIGJvb2wgcHJl
X2NvbW1pdDsKICAgICBUQ0dDb25kIGJyYW5jaF9jb25kOwpAQCAtMTExLDkgKzEwOSwxMSBAQCBz
dGF0aWMgaW5saW5lIHZvaWQgY3R4X2xvZ192cmVnX3dyaXRlKERpc2FzQ29udGV4dCAqY3R4LAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sIGlzX3ByZWRpY2F0ZWQp
CiB7CiAgICAgaWYgKHR5cGUgIT0gRVhUX1RNUCkgewotICAgICAgICBjdHgtPnZyZWdfbG9nW2N0
eC0+dnJlZ19sb2dfaWR4XSA9IHJudW07Ci0gICAgICAgIGN0eC0+dnJlZ19pc19wcmVkaWNhdGVk
W2N0eC0+dnJlZ19sb2dfaWR4XSA9IGlzX3ByZWRpY2F0ZWQ7Ci0gICAgICAgIGN0eC0+dnJlZ19s
b2dfaWR4Kys7CisgICAgICAgIGlmICghdGVzdF9iaXQocm51bSwgY3R4LT52cmVnc191cGRhdGVk
KSkgeworICAgICAgICAgICAgY3R4LT52cmVnX2xvZ1tjdHgtPnZyZWdfbG9nX2lkeF0gPSBybnVt
OworICAgICAgICAgICAgY3R4LT52cmVnX2xvZ19pZHgrKzsKKyAgICAgICAgICAgIHNldF9iaXQo
cm51bSwgY3R4LT52cmVnc191cGRhdGVkKTsKKyAgICAgICAgfQogCiAgICAgICAgIHNldF9iaXQo
cm51bSwgY3R4LT52cmVnc191cGRhdGVkKTsKICAgICAgICAgaWYgKGlzX3ByZWRpY2F0ZWQpIHsK
QEAgLTE0MCwxMCArMTQwLDkgQEAgc3RhdGljIGlubGluZSB2b2lkIGN0eF9sb2dfdnJlZ193cml0
ZV9wYWlyKERpc2FzQ29udGV4dCAqY3R4LAogfQogCiBzdGF0aWMgaW5saW5lIHZvaWQgY3R4X2xv
Z19xcmVnX3dyaXRlKERpc2FzQ29udGV4dCAqY3R4LAotICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBpbnQgcm51bSwgYm9vbCBpc19wcmVkaWNhdGVkKQorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgcm51bSkKIHsKICAgICBjdHgtPnFyZWdfbG9n
W2N0eC0+cXJlZ19sb2dfaWR4XSA9IHJudW07Ci0gICAgY3R4LT5xcmVnX2lzX3ByZWRpY2F0ZWRb
Y3R4LT5xcmVnX2xvZ19pZHhdID0gaXNfcHJlZGljYXRlZDsKICAgICBjdHgtPnFyZWdfbG9nX2lk
eCsrOwogfQogCkBAIC0xNjQsOCArMTYzLDYgQEAgZXh0ZXJuIFRDR3YgaGV4X2RjemVyb19hZGRy
OwogZXh0ZXJuIFRDR3YgaGV4X2xsc2NfYWRkcjsKIGV4dGVybiBUQ0d2IGhleF9sbHNjX3ZhbDsK
IGV4dGVybiBUQ0d2X2k2NCBoZXhfbGxzY192YWxfaTY0OwotZXh0ZXJuIFRDR3YgaGV4X1ZSZWdz
X3VwZGF0ZWQ7Ci1leHRlcm4gVENHdiBoZXhfUVJlZ3NfdXBkYXRlZDsKIGV4dGVybiBUQ0d2IGhl
eF92c3RvcmVfYWRkcltWU1RPUkVTX01BWF07CiBleHRlcm4gVENHdiBoZXhfdnN0b3JlX3NpemVb
VlNUT1JFU19NQVhdOwogZXh0ZXJuIFRDR3YgaGV4X3ZzdG9yZV9wZW5kaW5nW1ZTVE9SRVNfTUFY
XTsKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29uL2dlbnB0ci5jIGIvdGFyZ2V0L2hleGFnb24v
Z2VucHRyLmMKaW5kZXggZGE1ZGJjODNjZi4uYmIyNzRkNGE3MSAxMDA2NDQKLS0tIGEvdGFyZ2V0
L2hleGFnb24vZ2VucHRyLmMKKysrIGIvdGFyZ2V0L2hleGFnb24vZ2VucHRyLmMKQEAgLTk4NSw2
OCArOTg1LDMyIEBAIHN0YXRpYyBpbnRwdHJfdCB2cmVnX3NyY19vZmYoRGlzYXNDb250ZXh0ICpj
dHgsIGludCBudW0pCiB9CiAKIHN0YXRpYyB2b2lkIGdlbl9sb2dfdnJlZ193cml0ZShEaXNhc0Nv
bnRleHQgKmN0eCwgaW50cHRyX3Qgc3Jjb2ZmLCBpbnQgbnVtLAotICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFZSZWdXcml0ZVR5cGUgdHlwZSwgaW50IHNsb3RfbnVtLAotICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGJvb2wgaXNfcHJlZGljYXRlZCkKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBWUmVnV3JpdGVUeXBlIHR5cGUpCiB7Ci0gICAgVENHTGFiZWwgKmxh
YmVsX2VuZCA9IE5VTEw7CiAgICAgaW50cHRyX3QgZHN0b2ZmOwogCi0gICAgaWYgKGlzX3ByZWRp
Y2F0ZWQpIHsKLSAgICAgICAgVENHdiBjYW5jZWxsZWQgPSB0Y2dfdGVtcF9uZXcoKTsKLSAgICAg
ICAgbGFiZWxfZW5kID0gZ2VuX25ld19sYWJlbCgpOwotCi0gICAgICAgIC8qIERvbid0IGRvIGFu
eXRoaW5nIGlmIHRoZSBzbG90IHdhcyBjYW5jZWxsZWQgKi8KLSAgICAgICAgdGNnX2dlbl9leHRy
YWN0X3RsKGNhbmNlbGxlZCwgaGV4X3Nsb3RfY2FuY2VsbGVkLCBzbG90X251bSwgMSk7Ci0gICAg
ICAgIHRjZ19nZW5fYnJjb25kaV90bChUQ0dfQ09ORF9ORSwgY2FuY2VsbGVkLCAwLCBsYWJlbF9l
bmQpOwotICAgIH0KLQogICAgIGlmICh0eXBlICE9IEVYVF9UTVApIHsKICAgICAgICAgZHN0b2Zm
ID0gY3R4X2Z1dHVyZV92cmVnX29mZihjdHgsIG51bSwgMSwgdHJ1ZSk7CiAgICAgICAgIHRjZ19n
ZW5fZ3ZlY19tb3YoTU9fNjQsIGRzdG9mZiwgc3Jjb2ZmLAogICAgICAgICAgICAgICAgICAgICAg
ICAgIHNpemVvZihNTVZlY3RvciksIHNpemVvZihNTVZlY3RvcikpOwotICAgICAgICB0Y2dfZ2Vu
X29yaV90bChoZXhfVlJlZ3NfdXBkYXRlZCwgaGV4X1ZSZWdzX3VwZGF0ZWQsIDEgPDwgbnVtKTsK
ICAgICB9IGVsc2UgewogICAgICAgICBkc3RvZmYgPSBjdHhfdG1wX3ZyZWdfb2ZmKGN0eCwgbnVt
LCAxLCBmYWxzZSk7CiAgICAgICAgIHRjZ19nZW5fZ3ZlY19tb3YoTU9fNjQsIGRzdG9mZiwgc3Jj
b2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVvZihNTVZlY3RvciksIHNpemVvZihN
TVZlY3RvcikpOwogICAgIH0KLQotICAgIGlmIChpc19wcmVkaWNhdGVkKSB7Ci0gICAgICAgIGdl
bl9zZXRfbGFiZWwobGFiZWxfZW5kKTsKLSAgICB9CiB9CiAKIHN0YXRpYyB2b2lkIGdlbl9sb2df
dnJlZ193cml0ZV9wYWlyKERpc2FzQ29udGV4dCAqY3R4LCBpbnRwdHJfdCBzcmNvZmYsIGludCBu
dW0sCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWUmVnV3JpdGVUeXBlIHR5
cGUsIGludCBzbG90X251bSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJv
b2wgaXNfcHJlZGljYXRlZCkKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZS
ZWdXcml0ZVR5cGUgdHlwZSkKIHsKLSAgICBnZW5fbG9nX3ZyZWdfd3JpdGUoY3R4LCBzcmNvZmYs
IG51bSBeIDAsIHR5cGUsIHNsb3RfbnVtLCBpc19wcmVkaWNhdGVkKTsKKyAgICBnZW5fbG9nX3Zy
ZWdfd3JpdGUoY3R4LCBzcmNvZmYsIG51bSBeIDAsIHR5cGUpOwogICAgIHNyY29mZiArPSBzaXpl
b2YoTU1WZWN0b3IpOwotICAgIGdlbl9sb2dfdnJlZ193cml0ZShjdHgsIHNyY29mZiwgbnVtIF4g
MSwgdHlwZSwgc2xvdF9udW0sIGlzX3ByZWRpY2F0ZWQpOworICAgIGdlbl9sb2dfdnJlZ193cml0
ZShjdHgsIHNyY29mZiwgbnVtIF4gMSwgdHlwZSk7CiB9CiAKLXN0YXRpYyB2b2lkIGdlbl9sb2df
cXJlZ193cml0ZShpbnRwdHJfdCBzcmNvZmYsIGludCBudW0sIGludCB2bmV3LAotICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGludCBzbG90X251bSwgYm9vbCBpc19wcmVkaWNhdGVkKQor
c3RhdGljIGludHB0cl90IGdldF9yZXN1bHRfcXJlZyhEaXNhc0NvbnRleHQgKmN0eCwgaW50IHFu
dW0pCiB7Ci0gICAgVENHTGFiZWwgKmxhYmVsX2VuZCA9IE5VTEw7Ci0gICAgaW50cHRyX3QgZHN0
b2ZmOwotCi0gICAgaWYgKGlzX3ByZWRpY2F0ZWQpIHsKLSAgICAgICAgVENHdiBjYW5jZWxsZWQg
PSB0Y2dfdGVtcF9uZXcoKTsKLSAgICAgICAgbGFiZWxfZW5kID0gZ2VuX25ld19sYWJlbCgpOwot
Ci0gICAgICAgIC8qIERvbid0IGRvIGFueXRoaW5nIGlmIHRoZSBzbG90IHdhcyBjYW5jZWxsZWQg
Ki8KLSAgICAgICAgdGNnX2dlbl9leHRyYWN0X3RsKGNhbmNlbGxlZCwgaGV4X3Nsb3RfY2FuY2Vs
bGVkLCBzbG90X251bSwgMSk7Ci0gICAgICAgIHRjZ19nZW5fYnJjb25kaV90bChUQ0dfQ09ORF9O
RSwgY2FuY2VsbGVkLCAwLCBsYWJlbF9lbmQpOwotICAgIH0KLQotICAgIGRzdG9mZiA9IG9mZnNl
dG9mKENQVUhleGFnb25TdGF0ZSwgZnV0dXJlX1FSZWdzW251bV0pOwotICAgIHRjZ19nZW5fZ3Zl
Y19tb3YoTU9fNjQsIGRzdG9mZiwgc3Jjb2ZmLCBzaXplb2YoTU1RUmVnKSwgc2l6ZW9mKE1NUVJl
ZykpOwotCi0gICAgaWYgKGlzX3ByZWRpY2F0ZWQpIHsKLSAgICAgICAgdGNnX2dlbl9vcmlfdGwo
aGV4X1FSZWdzX3VwZGF0ZWQsIGhleF9RUmVnc191cGRhdGVkLCAxIDw8IG51bSk7Ci0gICAgICAg
IGdlbl9zZXRfbGFiZWwobGFiZWxfZW5kKTsKLSAgICB9CisgICAgcmV0dXJuICBvZmZzZXRvZihD
UFVIZXhhZ29uU3RhdGUsIGZ1dHVyZV9RUmVnc1txbnVtXSk7CiB9CiAKIHN0YXRpYyB2b2lkIGdl
bl92cmVnX2xvYWQoRGlzYXNDb250ZXh0ICpjdHgsIGludHB0cl90IGRzdG9mZiwgVENHdiBzcmMs
CmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuYyBiL3RhcmdldC9oZXhhZ29u
L3RyYW5zbGF0ZS5jCmluZGV4IDFlM2E3NmFlY2UuLjY2NTQ3NmFiNDggMTAwNjQ0Ci0tLSBhL3Rh
cmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5jCisrKyBiL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5j
CkBAIC01Niw4ICs1Niw2IEBAIFRDR3YgaGV4X2RjemVyb19hZGRyOwogVENHdiBoZXhfbGxzY19h
ZGRyOwogVENHdiBoZXhfbGxzY192YWw7CiBUQ0d2X2k2NCBoZXhfbGxzY192YWxfaTY0OwotVENH
diBoZXhfVlJlZ3NfdXBkYXRlZDsKLVRDR3YgaGV4X1FSZWdzX3VwZGF0ZWQ7CiBUQ0d2IGhleF92
c3RvcmVfYWRkcltWU1RPUkVTX01BWF07CiBUQ0d2IGhleF92c3RvcmVfc2l6ZVtWU1RPUkVTX01B
WF07CiBUQ0d2IGhleF92c3RvcmVfcGVuZGluZ1tWU1RPUkVTX01BWF07CkBAIC0yNDgsMTIgKzI0
NiwxMSBAQCBzdGF0aWMgYm9vbCBjaGVja19mb3JfYXR0cmliKFBhY2tldCAqcGt0LCBpbnQgYXR0
cmliKQogCiBzdGF0aWMgYm9vbCBuZWVkX3Nsb3RfY2FuY2VsbGVkKFBhY2tldCAqcGt0KQogewot
ICAgIC8qIFdlIG9ubHkgbmVlZCBzbG90X2NhbmNlbGxlZCBmb3IgY29uZGl0aW9uYWwgc3RvcmUg
YW5kIEhWWCBpbnN0cnVjdGlvbnMgKi8KKyAgICAvKiBXZSBvbmx5IG5lZWQgc2xvdF9jYW5jZWxs
ZWQgZm9yIGNvbmRpdGlvbmFsIHN0b3JlIGluc3RydWN0aW9ucyAqLwogICAgIGZvciAoaW50IGkg
PSAwOyBpIDwgcGt0LT5udW1faW5zbnM7IGkrKykgewogICAgICAgICB1aW50MTZfdCBvcGNvZGUg
PSBwa3QtPmluc25baV0ub3Bjb2RlOwogICAgICAgICBpZiAoR0VUX0FUVFJJQihvcGNvZGUsIEFf
Q09OREVYRUMpICYmCi0gICAgICAgICAgICAoR0VUX0FUVFJJQihvcGNvZGUsIEFfU1RPUkUpIHx8
Ci0gICAgICAgICAgICAgR0VUX0FUVFJJQihvcGNvZGUsIEFfQ1ZJKSkpIHsKKyAgICAgICAgICAg
IEdFVF9BVFRSSUIob3Bjb2RlLCBBX1NDQUxBUl9TVE9SRSkpIHsKICAgICAgICAgICAgIHJldHVy
biB0cnVlOwogICAgICAgICB9CiAgICAgfQpAQCAtNDUzLDExICs0NTAsNiBAQCBzdGF0aWMgdm9p
ZCBnZW5fc3RhcnRfcGFja2V0KERpc2FzQ29udGV4dCAqY3R4KQogICAgICAgICAgICAgaSA9IGZp
bmRfbmV4dF9iaXQoY3R4LT5wcmVkaWNhdGVkX3RtcF92cmVncywgTlVNX1ZSRUdTLCBpICsgMSk7
CiAgICAgICAgIH0KICAgICB9Ci0KLSAgICBpZiAocGt0LT5wa3RfaGFzX2h2eCkgewotICAgICAg
ICB0Y2dfZ2VuX21vdmlfdGwoaGV4X1ZSZWdzX3VwZGF0ZWQsIDApOwotICAgICAgICB0Y2dfZ2Vu
X21vdmlfdGwoaGV4X1FSZWdzX3VwZGF0ZWQsIDApOwotICAgIH0KIH0KIAogYm9vbCBpc19nYXRo
ZXJfc3RvcmVfaW5zbihEaXNhc0NvbnRleHQgKmN0eCkKQEAgLTcyNSw2NSArNzE3LDMxIEBAIHN0
YXRpYyB2b2lkIGdlbl9jb21taXRfaHZ4KERpc2FzQ29udGV4dCAqY3R4KQogICAgIC8qCiAgICAg
ICogICAgZm9yIChpID0gMDsgaSA8IGN0eC0+dnJlZ19sb2dfaWR4OyBpKyspIHsKICAgICAgKiAg
ICAgICAgaW50IHJudW0gPSBjdHgtPnZyZWdfbG9nW2ldOwotICAgICAqICAgICAgICBpZiAoY3R4
LT52cmVnX2lzX3ByZWRpY2F0ZWRbaV0pIHsKLSAgICAgKiAgICAgICAgICAgIGlmIChlbnYtPlZS
ZWdzX3VwZGF0ZWQgJiAoMSA8PCBybnVtKSkgewotICAgICAqICAgICAgICAgICAgICAgIGVudi0+
VlJlZ3Nbcm51bV0gPSBlbnYtPmZ1dHVyZV9WUmVnc1tybnVtXTsKLSAgICAgKiAgICAgICAgICAg
IH0KLSAgICAgKiAgICAgICAgfSBlbHNlIHsKLSAgICAgKiAgICAgICAgICAgIGVudi0+VlJlZ3Nb
cm51bV0gPSBlbnYtPmZ1dHVyZV9WUmVnc1tybnVtXTsKLSAgICAgKiAgICAgICAgfQorICAgICAq
ICAgICAgICBlbnYtPlZSZWdzW3JudW1dID0gZW52LT5mdXR1cmVfVlJlZ3Nbcm51bV07CiAgICAg
ICogICAgfQogICAgICAqLwogICAgIGZvciAoaSA9IDA7IGkgPCBjdHgtPnZyZWdfbG9nX2lkeDsg
aSsrKSB7CiAgICAgICAgIGludCBybnVtID0gY3R4LT52cmVnX2xvZ1tpXTsKLSAgICAgICAgYm9v
bCBpc19wcmVkaWNhdGVkID0gY3R4LT52cmVnX2lzX3ByZWRpY2F0ZWRbaV07CiAgICAgICAgIGlu
dHB0cl90IGRzdG9mZiA9IG9mZnNldG9mKENQVUhleGFnb25TdGF0ZSwgVlJlZ3Nbcm51bV0pOwog
ICAgICAgICBpbnRwdHJfdCBzcmNvZmYgPSBjdHhfZnV0dXJlX3ZyZWdfb2ZmKGN0eCwgcm51bSwg
MSwgZmFsc2UpOwogICAgICAgICBzaXplX3Qgc2l6ZSA9IHNpemVvZihNTVZlY3Rvcik7CiAKLSAg
ICAgICAgaWYgKGlzX3ByZWRpY2F0ZWQpIHsKLSAgICAgICAgICAgIFRDR3YgY21wID0gdGNnX3Rl
bXBfbmV3KCk7Ci0gICAgICAgICAgICBUQ0dMYWJlbCAqbGFiZWxfc2tpcCA9IGdlbl9uZXdfbGFi
ZWwoKTsKLQotICAgICAgICAgICAgdGNnX2dlbl9hbmRpX3RsKGNtcCwgaGV4X1ZSZWdzX3VwZGF0
ZWQsIDEgPDwgcm51bSk7Ci0gICAgICAgICAgICB0Y2dfZ2VuX2JyY29uZGlfdGwoVENHX0NPTkRf
RVEsIGNtcCwgMCwgbGFiZWxfc2tpcCk7Ci0gICAgICAgICAgICB0Y2dfZ2VuX2d2ZWNfbW92KE1P
XzY0LCBkc3RvZmYsIHNyY29mZiwgc2l6ZSwgc2l6ZSk7Ci0gICAgICAgICAgICBnZW5fc2V0X2xh
YmVsKGxhYmVsX3NraXApOwotICAgICAgICB9IGVsc2UgewotICAgICAgICAgICAgdGNnX2dlbl9n
dmVjX21vdihNT182NCwgZHN0b2ZmLCBzcmNvZmYsIHNpemUsIHNpemUpOwotICAgICAgICB9Cisg
ICAgICAgIHRjZ19nZW5fZ3ZlY19tb3YoTU9fNjQsIGRzdG9mZiwgc3Jjb2ZmLCBzaXplLCBzaXpl
KTsKICAgICB9CiAKICAgICAvKgogICAgICAqICAgIGZvciAoaSA9IDA7IGkgPCBjdHgtPnFyZWdf
bG9nX2lkeDsgaSsrKSB7CiAgICAgICogICAgICAgIGludCBybnVtID0gY3R4LT5xcmVnX2xvZ1tp
XTsKLSAgICAgKiAgICAgICAgaWYgKGN0eC0+cXJlZ19pc19wcmVkaWNhdGVkW2ldKSB7Ci0gICAg
ICogICAgICAgICAgICBpZiAoZW52LT5RUmVnc191cGRhdGVkKSAmICgxIDw8IHJudW0pKSB7Ci0g
ICAgICogICAgICAgICAgICAgICAgZW52LT5RUmVnc1tybnVtXSA9IGVudi0+ZnV0dXJlX1FSZWdz
W3JudW1dOwotICAgICAqICAgICAgICAgICAgfQotICAgICAqICAgICAgICB9IGVsc2UgewotICAg
ICAqICAgICAgICAgICAgZW52LT5RUmVnc1tybnVtXSA9IGVudi0+ZnV0dXJlX1FSZWdzW3JudW1d
OwotICAgICAqICAgICAgICB9CisgICAgICogICAgICAgIGVudi0+UVJlZ3Nbcm51bV0gPSBlbnYt
PmZ1dHVyZV9RUmVnc1tybnVtXTsKICAgICAgKiAgICB9CiAgICAgICovCiAgICAgZm9yIChpID0g
MDsgaSA8IGN0eC0+cXJlZ19sb2dfaWR4OyBpKyspIHsKICAgICAgICAgaW50IHJudW0gPSBjdHgt
PnFyZWdfbG9nW2ldOwotICAgICAgICBib29sIGlzX3ByZWRpY2F0ZWQgPSBjdHgtPnFyZWdfaXNf
cHJlZGljYXRlZFtpXTsKICAgICAgICAgaW50cHRyX3QgZHN0b2ZmID0gb2Zmc2V0b2YoQ1BVSGV4
YWdvblN0YXRlLCBRUmVnc1tybnVtXSk7CiAgICAgICAgIGludHB0cl90IHNyY29mZiA9IG9mZnNl
dG9mKENQVUhleGFnb25TdGF0ZSwgZnV0dXJlX1FSZWdzW3JudW1dKTsKICAgICAgICAgc2l6ZV90
IHNpemUgPSBzaXplb2YoTU1RUmVnKTsKIAotICAgICAgICBpZiAoaXNfcHJlZGljYXRlZCkgewot
ICAgICAgICAgICAgVENHdiBjbXAgPSB0Y2dfdGVtcF9uZXcoKTsKLSAgICAgICAgICAgIFRDR0xh
YmVsICpsYWJlbF9za2lwID0gZ2VuX25ld19sYWJlbCgpOwotCi0gICAgICAgICAgICB0Y2dfZ2Vu
X2FuZGlfdGwoY21wLCBoZXhfUVJlZ3NfdXBkYXRlZCwgMSA8PCBybnVtKTsKLSAgICAgICAgICAg
IHRjZ19nZW5fYnJjb25kaV90bChUQ0dfQ09ORF9FUSwgY21wLCAwLCBsYWJlbF9za2lwKTsKLSAg
ICAgICAgICAgIHRjZ19nZW5fZ3ZlY19tb3YoTU9fNjQsIGRzdG9mZiwgc3Jjb2ZmLCBzaXplLCBz
aXplKTsKLSAgICAgICAgICAgIGdlbl9zZXRfbGFiZWwobGFiZWxfc2tpcCk7Ci0gICAgICAgIH0g
ZWxzZSB7Ci0gICAgICAgICAgICB0Y2dfZ2VuX2d2ZWNfbW92KE1PXzY0LCBkc3RvZmYsIHNyY29m
Ziwgc2l6ZSwgc2l6ZSk7Ci0gICAgICAgIH0KKyAgICAgICAgdGNnX2dlbl9ndmVjX21vdihNT182
NCwgZHN0b2ZmLCBzcmNvZmYsIHNpemUsIHNpemUpOwogICAgIH0KIAogICAgIGlmIChwa3RfaGFz
X2h2eF9zdG9yZShjdHgtPnBrdCkpIHsKQEAgLTExMjksMTAgKzEwODcsNiBAQCB2b2lkIGhleGFn
b25fdHJhbnNsYXRlX2luaXQodm9pZCkKICAgICAgICAgb2Zmc2V0b2YoQ1BVSGV4YWdvblN0YXRl
LCBsbHNjX3ZhbCksICJsbHNjX3ZhbCIpOwogICAgIGhleF9sbHNjX3ZhbF9pNjQgPSB0Y2dfZ2xv
YmFsX21lbV9uZXdfaTY0KGNwdV9lbnYsCiAgICAgICAgIG9mZnNldG9mKENQVUhleGFnb25TdGF0
ZSwgbGxzY192YWxfaTY0KSwgImxsc2NfdmFsX2k2NCIpOwotICAgIGhleF9WUmVnc191cGRhdGVk
ID0gdGNnX2dsb2JhbF9tZW1fbmV3KGNwdV9lbnYsCi0gICAgICAgIG9mZnNldG9mKENQVUhleGFn
b25TdGF0ZSwgVlJlZ3NfdXBkYXRlZCksICJWUmVnc191cGRhdGVkIik7Ci0gICAgaGV4X1FSZWdz
X3VwZGF0ZWQgPSB0Y2dfZ2xvYmFsX21lbV9uZXcoY3B1X2VudiwKLSAgICAgICAgb2Zmc2V0b2Yo
Q1BVSGV4YWdvblN0YXRlLCBRUmVnc191cGRhdGVkKSwgIlFSZWdzX3VwZGF0ZWQiKTsKICAgICBm
b3IgKGkgPSAwOyBpIDwgU1RPUkVTX01BWDsgaSsrKSB7CiAgICAgICAgIHNucHJpbnRmKHN0b3Jl
X2FkZHJfbmFtZXNbaV0sIE5BTUVfTEVOLCAic3RvcmVfYWRkcl8lZCIsIGkpOwogICAgICAgICBo
ZXhfc3RvcmVfYWRkcltpXSA9IHRjZ19nbG9iYWxfbWVtX25ldyhjcHVfZW52LApkaWZmIC0tZ2l0
IGEvdGFyZ2V0L2hleGFnb24vUkVBRE1FIGIvdGFyZ2V0L2hleGFnb24vUkVBRE1FCmluZGV4IDM2
NTYwNmYxZTYuLmViYWZjNzhiMWMgMTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29uL1JFQURNRQor
KysgYi90YXJnZXQvaGV4YWdvbi9SRUFETUUKQEAgLTEzNiwxMiArMTM2LDkgQEAgRm9yIEhWWCB2
ZWN0b3JzLCB0aGUgZ2VuZXJhdG9yIGJlaGF2ZXMgc2xpZ2h0bHkgZGlmZmVyZW50bHkuICBUaGUg
d2lkZSB2ZWN0b3JzCiB3b24ndCBmaXQgaW4gYSBUQ0d2IG9yIFRDR3ZfaTY0LCBzbyB3ZSBwYXNz
IFRDR3ZfcHRyIHZhcmlhYmxlcyB0byBwYXNzIHRoZQogYWRkcmVzcyB0byBoZWxwZXIgZnVuY3Rp
b25zLiAgSGVyZSdzIGFuIGV4YW1wbGUgZm9yIGFuIEhWWCB2ZWN0b3ItYWRkLXdvcmQKIGlzdHJ1
Y3Rpb24uCi0gICAgc3RhdGljIHZvaWQgZ2VuZXJhdGVfVjZfdmFkZHcoCi0gICAgICAgICAgICAg
ICAgICAgIENQVUhleGFnb25TdGF0ZSAqZW52LAotICAgICAgICAgICAgICAgICAgICBEaXNhc0Nv
bnRleHQgKmN0eCwKLSAgICAgICAgICAgICAgICAgICAgSW5zbiAqaW5zbiwKLSAgICAgICAgICAg
ICAgICAgICAgUGFja2V0ICpwa3QpCisgICAgc3RhdGljIHZvaWQgZ2VuZXJhdGVfVjZfdmFkZHco
RGlzYXNDb250ZXh0ICpjdHgpCiAgICAgeworICAgICAgICBJbnNuICppbnNuIF9fYXR0cmlidXRl
X18oKHVudXNlZCkpID0gY3R4LT5pbnNuOwogICAgICAgICBjb25zdCBpbnQgVmROID0gaW5zbi0+
cmVnbm9bMF07CiAgICAgICAgIGNvbnN0IGludHB0cl90IFZkVl9vZmYgPQogICAgICAgICAgICAg
Y3R4X2Z1dHVyZV92cmVnX29mZihjdHgsIFZkTiwgMSwgdHJ1ZSk7CkBAIC0xNTcsOSArMTU0LDcg
QEAgaXN0cnVjdGlvbi4KICAgICAgICAgVENHdl9wdHIgVnZWID0gdGNnX3RlbXBfbmV3X3B0cigp
OwogICAgICAgICB0Y2dfZ2VuX2FkZGlfcHRyKFZ1ViwgY3B1X2VudiwgVnVWX29mZik7CiAgICAg
ICAgIHRjZ19nZW5fYWRkaV9wdHIoVnZWLCBjcHVfZW52LCBWdlZfb2ZmKTsKLSAgICAgICAgVENH
diBzbG90ID0gdGNnX2NvbnN0YW50X3RsKGluc24tPnNsb3QpOwotICAgICAgICBnZW5faGVscGVy
X1Y2X3ZhZGR3KGNwdV9lbnYsIFZkViwgVnVWLCBWdlYsIHNsb3QpOwotICAgICAgICBnZW5fbG9n
X3ZyZWdfd3JpdGUoY3R4LCBWZFZfb2ZmLCBWZE4sIEVYVF9ERkwsIGluc24tPnNsb3QsIGZhbHNl
KTsKKyAgICAgICAgZ2VuX2hlbHBlcl9WNl92YWRkdyhjcHVfZW52LCBWZFYsIFZ1ViwgVnZWKTsK
ICAgICB9CiAKIE5vdGljZSB0aGF0IHdlIGFsc28gZ2VuZXJhdGUgYSB2YXJpYWJsZSBuYW1lZCA8
b3BlcmFuZD5fb2ZmIGZvciBlYWNoIG9wZXJhbmQgb2YKQEAgLTE3MiwxMiArMTY3LDkgQEAgZnVu
Y3Rpb25zIGZyb20gdGNnLW9wLWd2ZWMuaC4gIEhlcmUncyB0aGUgb3ZlcnJpZGUgZm9yIHRoaXMg
aW5zdHJ1Y3Rpb24uCiBGaW5hbGx5LCB3ZSBub3RpY2UgdGhhdCB0aGUgb3ZlcnJpZGUgZG9lc24n
dCB1c2UgdGhlIFRDR3ZfcHRyIHZhcmlhYmxlcywgc28KIHdlIGRvbid0IGdlbmVyYXRlIHRoZW0g
d2hlbiBhbiBvdmVycmlkZSBpcyBwcmVzZW50LiAgSGVyZSBpcyB3aGF0IHdlIGdlbmVyYXRlCiB3
aGVuIHRoZSBvdmVycmlkZSBpcyBwcmVzZW50LgotICAgIHN0YXRpYyB2b2lkIGdlbmVyYXRlX1Y2
X3ZhZGR3KAotICAgICAgICAgICAgICAgICAgICBDUFVIZXhhZ29uU3RhdGUgKmVudiwKLSAgICAg
ICAgICAgICAgICAgICAgRGlzYXNDb250ZXh0ICpjdHgsCi0gICAgICAgICAgICAgICAgICAgIElu
c24gKmluc24sCi0gICAgICAgICAgICAgICAgICAgIFBhY2tldCAqcGt0KQorICAgIHN0YXRpYyB2
b2lkIGdlbmVyYXRlX1Y2X3ZhZGR3KERpc2FzQ29udGV4dCAqY3R4KQogICAgIHsKKyAgICAgICAg
SW5zbiAqaW5zbiBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSA9IGN0eC0+aW5zbjsKICAgICAgICAg
Y29uc3QgaW50IFZkTiA9IGluc24tPnJlZ25vWzBdOwogICAgICAgICBjb25zdCBpbnRwdHJfdCBW
ZFZfb2ZmID0KICAgICAgICAgICAgIGN0eF9mdXR1cmVfdnJlZ19vZmYoY3R4LCBWZE4sIDEsIHRy
dWUpOwpAQCAtMTg4LDcgKzE4MCw2IEBAIHdoZW4gdGhlIG92ZXJyaWRlIGlzIHByZXNlbnQuCiAg
ICAgICAgIGNvbnN0IGludHB0cl90IFZ2Vl9vZmYgPQogICAgICAgICAgICAgdnJlZ19zcmNfb2Zm
KGN0eCwgVnZOKTsKICAgICAgICAgZkdFTl9UQ0dfVjZfdmFkZHcoeyBmSElERShpbnQgaTspIGZW
Rk9SRUFDSCgzMiwgaSkgeyBWZFYud1tpXSA9IFZ1Vi53W2ldICsgVnZWLndbaV0gOyB9IH0pOwot
ICAgICAgICBnZW5fbG9nX3ZyZWdfd3JpdGUoY3R4LCBWZFZfb2ZmLCBWZE4sIEVYVF9ERkwsIGlu
c24tPnNsb3QsIGZhbHNlKTsKICAgICB9CiAKIFdlIGFsc28gZ2VuZXJhdGUgYW4gYW5hbHl6ZV88
dGFnPiBmdW5jdGlvbiBmb3IgZWFjaCBpbnN0cnVjdGlvbi4gIEN1cnJlbnRseSwKQEAgLTI4MSwx
MCArMjcyLDggQEAgRm9yIEhleGFnb24gVmVjdG9yIGVYdGVuc2lvbnMgKEhWWCksIHRoZSBmb2xs
b3dpbmcgZmllbGRzIGFyZSB1c2VkCiAgICAgVlJlZ3MgICAgICAgICAgICAgICAgICAgICAgIFZl
Y3RvciByZWdpc3RlcnMKICAgICBmdXR1cmVfVlJlZ3MgICAgICAgICAgICAgICAgUmVnaXN0ZXJz
IHRvIGJlIHN0b3JlZCBkdXJpbmcgcGFja2V0IGNvbW1pdAogICAgIHRtcF9WUmVncyAgICAgICAg
ICAgICAgICAgICBUZW1wb3JhcnkgcmVnaXN0ZXJzICpub3QqIHN0b3JlZCBkdXJpbmcgY29tbWl0
Ci0gICAgVlJlZ3NfdXBkYXRlZCAgICAgICAgICAgICAgIE1hc2sgb2YgcHJlZGljYXRlZCB2ZWN0
b3Igd3JpdGVzCiAgICAgUVJlZ3MgICAgICAgICAgICAgICAgICAgICAgIFEgKHZlY3RvciBwcmVk
aWNhdGUpIHJlZ2lzdGVycwogICAgIGZ1dHVyZV9RUmVncyAgICAgICAgICAgICAgICBSZWdpc3Rl
cnMgdG8gYmUgc3RvcmVkIGR1cmluZyBwYWNrZXQgY29tbWl0Ci0gICAgUVJlZ3NfdXBkYXRlZCAg
ICAgICAgICAgICAgIE1hc2sgb2YgcHJlZGljYXRlZCB2ZWN0b3Igd3JpdGVzCiAKICoqKiBEZWJ1
Z2dpbmcgKioqCiAKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29uL2dlbl9hbmFseXplX2Z1bmNz
LnB5IGIvdGFyZ2V0L2hleGFnb24vZ2VuX2FuYWx5emVfZnVuY3MucHkKaW5kZXggMGJiNGZjYjQ3
Ni4uZWJkM2U3YWZiOSAxMDA3NTUKLS0tIGEvdGFyZ2V0L2hleGFnb24vZ2VuX2FuYWx5emVfZnVu
Y3MucHkKKysrIGIvdGFyZ2V0L2hleGFnb24vZ2VuX2FuYWx5emVfZnVuY3MucHkKQEAgLTExMCw4
ICsxMTAsNyBAQCBkZWYgYW5hbHl6ZV9vcG5fb2xkKGYsIHRhZywgcmVndHlwZSwgcmVnaWQsIHJl
Z25vKToKICAgICAgICAgaWYgKHJlZ2lkIGluIHsiZCIsICJlIiwgIngifSk6CiAgICAgICAgICAg
ICBmLndyaXRlKCIgICAgY29uc3QgaW50ICVzID0gaW5zbi0+cmVnbm9bJWRdO1xuIiAlIFwKICAg
ICAgICAgICAgICAgICAocmVnTiwgcmVnbm8pKQotICAgICAgICAgICAgZi53cml0ZSgiICAgIGN0
eF9sb2dfcXJlZ193cml0ZShjdHgsICVzLCAlcyk7XG4iICUgXAotICAgICAgICAgICAgICAgIChy
ZWdOLCBwcmVkaWNhdGVkKSkKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICBjdHhfbG9nX3FyZWdf
d3JpdGUoY3R4LCAlcyk7XG4iICUgKHJlZ04pKQogICAgICAgICBlbGlmIChyZWdpZCBpbiB7InMi
LCAidCIsICJ1IiwgInYifSk6CiAgICAgICAgICAgICBmLndyaXRlKCIvLyAgICBjb25zdCBpbnQg
JXMgPSBpbnNuLT5yZWdub1slZF07XG4iICUgXAogICAgICAgICAgICAgICAgIChyZWdOLCByZWdu
bykpCmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi9nZW5fdGNnX2Z1bmNzLnB5IGIvdGFyZ2V0
L2hleGFnb24vZ2VuX3RjZ19mdW5jcy5weQppbmRleCA5MzM2NTI4ZTUwLi5mYTkzZTE4NWNlIDEw
MDc1NQotLS0gYS90YXJnZXQvaGV4YWdvbi9nZW5fdGNnX2Z1bmNzLnB5CisrKyBiL3RhcmdldC9o
ZXhhZ29uL2dlbl90Y2dfZnVuY3MucHkKQEAgLTE3Niw4ICsxNzYsNyBAQCBkZWYgZ2VucHRyX2Rl
Y2woZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgcmVnbm8pOgogICAgICAgICAgICAgICAgIChyZWd0
eXBlLCByZWdpZCwgcmVnbm8pKQogICAgICAgICAgICAgZi53cml0ZSgiICAgIGNvbnN0IGludHB0
cl90ICVzJXNWX29mZiA9XG4iICUgXAogICAgICAgICAgICAgICAgIChyZWd0eXBlLCByZWdpZCkp
Ci0gICAgICAgICAgICBmLndyaXRlKCIgICAgICAgIG9mZnNldG9mKENQVUhleGFnb25TdGF0ZSxc
biIpCi0gICAgICAgICAgICBmLndyaXRlKCIgICAgICAgICAgICAgICAgIGZ1dHVyZV9RUmVnc1sl
cyVzTl0pO1xuIiAlIFwKKyAgICAgICAgICAgIGYud3JpdGUoIiAgICAgICAgZ2V0X3Jlc3VsdF9x
cmVnKGN0eCwgJXMlc04pO1xuIiAlIFwKICAgICAgICAgICAgICAgICAocmVndHlwZSwgcmVnaWQp
KQogICAgICAgICAgICAgaWYgKG5vdCBoZXhfY29tbW9uLnNraXBfcWVtdV9oZWxwZXIodGFnKSk6
CiAgICAgICAgICAgICAgICAgZi53cml0ZSgiICAgIFRDR3ZfcHRyICVzJXNWID0gdGNnX3RlbXBf
bmV3X3B0cigpO1xuIiAlIFwKQEAgLTQwNiwzNiArNDA1LDE4IEBAIGRlZiBnZW5wdHJfZHN0X3dy
aXRlKGYsIHRhZywgcmVndHlwZSwgcmVnaWQpOgogCiBkZWYgZ2VucHRyX2RzdF93cml0ZV9leHQo
ZiwgdGFnLCByZWd0eXBlLCByZWdpZCwgbmV3dj0iRVhUX0RGTCIpOgogICAgIGlmIChyZWd0eXBl
ID09ICJWIik6Ci0gICAgICAgIGlmIChyZWdpZCBpbiB7ImRkIiwgInh4IiwgInl5In0pOgotICAg
ICAgICAgICAgaWYgKCdBX0NPTkRFWEVDJyBpbiBoZXhfY29tbW9uLmF0dHJpYmRpY3RbdGFnXSk6
Ci0gICAgICAgICAgICAgICAgaXNfcHJlZGljYXRlZCA9ICJ0cnVlIgotICAgICAgICAgICAgZWxz
ZToKLSAgICAgICAgICAgICAgICBpc19wcmVkaWNhdGVkID0gImZhbHNlIgorICAgICAgICBpZiAo
cmVnaWQgaW4geyJ4eCJ9KToKICAgICAgICAgICAgIGYud3JpdGUoIiAgICBnZW5fbG9nX3ZyZWdf
d3JpdGVfcGFpcihjdHgsICVzJXNWX29mZiwgJXMlc04sICIgJSBcCiAgICAgICAgICAgICAgICAg
KHJlZ3R5cGUsIHJlZ2lkLCByZWd0eXBlLCByZWdpZCkpCi0gICAgICAgICAgICBmLndyaXRlKCIl
cywgaW5zbi0+c2xvdCwgJXMpO1xuIiAlIFwKLSAgICAgICAgICAgICAgICAobmV3diwgaXNfcHJl
ZGljYXRlZCkpCi0gICAgICAgIGVsaWYgKHJlZ2lkIGluIHsiZCIsICJ4IiwgInkifSk6Ci0gICAg
ICAgICAgICBpZiAoJ0FfQ09OREVYRUMnIGluIGhleF9jb21tb24uYXR0cmliZGljdFt0YWddKToK
LSAgICAgICAgICAgICAgICBpc19wcmVkaWNhdGVkID0gInRydWUiCi0gICAgICAgICAgICBlbHNl
OgotICAgICAgICAgICAgICAgIGlzX3ByZWRpY2F0ZWQgPSAiZmFsc2UiCi0gICAgICAgICAgICBm
LndyaXRlKCIgICAgZ2VuX2xvZ192cmVnX3dyaXRlKGN0eCwgJXMlc1Zfb2ZmLCAlcyVzTiwgJXMs
ICIgJSBcCisgICAgICAgICAgICBmLndyaXRlKCIlcyk7XG4iICUgXAorICAgICAgICAgICAgICAg
IChuZXd2KSkKKyAgICAgICAgZWxpZiAocmVnaWQgaW4geyJ5In0pOgorICAgICAgICAgICAgZi53
cml0ZSgiICAgIGdlbl9sb2dfdnJlZ193cml0ZShjdHgsICVzJXNWX29mZiwgJXMlc04sICVzKTtc
biIgJSBcCiAgICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWd0eXBlLCByZWdpZCwg
bmV3dikpCi0gICAgICAgICAgICBmLndyaXRlKCJpbnNuLT5zbG90LCAlcyk7XG4iICUgXAotICAg
ICAgICAgICAgICAgIChpc19wcmVkaWNhdGVkKSkKLSAgICAgICAgZWxzZToKKyAgICAgICAgZWxp
ZiAocmVnaWQgbm90IGluIHsiZGQiLCAiZCIsICJ4In0pOgogICAgICAgICAgICAgcHJpbnQoIkJh
ZCByZWdpc3RlciBwYXJzZTogIiwgcmVndHlwZSwgcmVnaWQpCiAgICAgZWxpZiAocmVndHlwZSA9
PSAiUSIpOgotICAgICAgICBpZiAocmVnaWQgaW4geyJkIiwgImUiLCAieCJ9KToKLSAgICAgICAg
ICAgIGlmICgnQV9DT05ERVhFQycgaW4gaGV4X2NvbW1vbi5hdHRyaWJkaWN0W3RhZ10pOgotICAg
ICAgICAgICAgICAgIGlzX3ByZWRpY2F0ZWQgPSAidHJ1ZSIKLSAgICAgICAgICAgIGVsc2U6Ci0g
ICAgICAgICAgICAgICAgaXNfcHJlZGljYXRlZCA9ICJmYWxzZSIKLSAgICAgICAgICAgIGYud3Jp
dGUoIiAgICBnZW5fbG9nX3FyZWdfd3JpdGUoJXMlc1Zfb2ZmLCAlcyVzTiwgJXMsICIgJSBcCi0g
ICAgICAgICAgICAgICAgKHJlZ3R5cGUsIHJlZ2lkLCByZWd0eXBlLCByZWdpZCwgbmV3dikpCi0g
ICAgICAgICAgICBmLndyaXRlKCJpbnNuLT5zbG90LCAlcyk7XG4iICUgKGlzX3ByZWRpY2F0ZWQp
KQotICAgICAgICBlbHNlOgorICAgICAgICBpZiAocmVnaWQgbm90IGluIHsiZCIsICJlIiwgIngi
fSk6CiAgICAgICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCByZWd0eXBlLCBy
ZWdpZCkKICAgICBlbHNlOgogICAgICAgICBwcmludCgiQmFkIHJlZ2lzdGVyIHBhcnNlOiAiLCBy
ZWd0eXBlLCByZWdpZCkKLS0gCjIuMjUuMQoK

