Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id 232C0312A51
	for <lists+qemu-devel@lfdr.de>; Mon,  8 Feb 2021 06:59:02 +0100 (CET)
Received: from localhost ([::1]:39804 helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>)
	id 1l8zZd-0004Xz-52
	for lists+qemu-devel@lfdr.de; Mon, 08 Feb 2021 00:59:01 -0500
Received: from eggs.gnu.org ([2001:470:142:3::10]:55942)
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1l8zO4-0007ky-Jq
 for qemu-devel@nongnu.org; Mon, 08 Feb 2021 00:47:05 -0500
Received: from alexa-out-sd-01.qualcomm.com ([199.106.114.38]:14431)
 by eggs.gnu.org with esmtps (TLS1.2:RSA_AES_256_CBC_SHA1:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1l8zNt-0006S5-Kz
 for qemu-devel@nongnu.org; Mon, 08 Feb 2021 00:47:04 -0500
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
 d=quicinc.com; i=@quicinc.com; q=dns/txt; s=qcdkim;
 t=1612763213; x=1644299213;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version:content-transfer-encoding;
 bh=NXPYkjxcecHyTVxV93SAqhn5MLveV56rZl3ZVvQOL2c=;
 b=qyC4V40Wl8FqqAWjpaQjZG1vVPCVPkYMXfVKlYtQBAxcyY3pPnKr9Nmw
 43Vn7EDUvMVdhXuX8TY0rGzmj2VzvS77vsp6OKKSFfANjjdcA+cQpYo7S
 lGCquRWYafo0ijrzgFaltLqahRxqS3/8ImQDUjn/fOvur/XkgQ5VXKVLt 8=;
Received: from unknown (HELO ironmsg04-sd.qualcomm.com) ([10.53.140.144])
 by alexa-out-sd-01.qualcomm.com with ESMTP; 07 Feb 2021 21:46:31 -0800
X-QCInternal: smtphost
Received: from vu-tsimpson-aus.qualcomm.com (HELO
 vu-tsimpson1-aus.qualcomm.com) ([10.222.150.1])
 by ironmsg04-sd.qualcomm.com with ESMTP; 07 Feb 2021 21:46:30 -0800
Received: by vu-tsimpson1-aus.qualcomm.com (Postfix, from userid 47164)
 id 937921266; Sun,  7 Feb 2021 23:46:29 -0600 (CST)
From: Taylor Simpson <tsimpson@quicinc.com>
To: qemu-devel@nongnu.org
Subject: [PATCH v8 15/35] Hexagon (target/hexagon/arch.[ch]) utility functions
Date: Sun,  7 Feb 2021 23:46:05 -0600
Message-Id: <1612763186-18161-16-git-send-email-tsimpson@quicinc.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1612763186-18161-1-git-send-email-tsimpson@quicinc.com>
References: <1612763186-18161-1-git-send-email-tsimpson@quicinc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Received-SPF: pass client-ip=199.106.114.38;
 envelope-from=tsimpson@qualcomm.com; helo=alexa-out-sd-01.qualcomm.com
X-Spam_score_int: -40
X-Spam_score: -4.1
X-Spam_bar: ----
X-Spam_report: (-4.1 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, HEADER_FROM_DIFFERENT_DOMAINS=0.248,
 RCVD_IN_DNSWL_MED=-2.3, SPF_HELO_NONE=0.001,
 SPF_PASS=-0.001 autolearn=ham autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Cc: ale@rev.ng, bcain@quicinc.com, philmd@redhat.com,
 richard.henderson@linaro.org, laurent@vivier.eu, tsimpson@quicinc.com,
 alex.bennee@linaro.org
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: "Qemu-devel" <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>

U2lnbmVkLW9mZi1ieTogVGF5bG9yIFNpbXBzb24gPHRzaW1wc29uQHF1aWNpbmMuY29tPgotLS0K
IHRhcmdldC9oZXhhZ29uL2FyY2guaCB8ICAzNCArKysrKysKIHRhcmdldC9oZXhhZ29uL2FyY2gu
YyB8IDMwMCArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KwogMiBmaWxlcyBjaGFuZ2VkLCAzMzQgaW5zZXJ0aW9ucygrKQogY3JlYXRlIG1vZGUgMTAwNjQ0
IHRhcmdldC9oZXhhZ29uL2FyY2guaAogY3JlYXRlIG1vZGUgMTAwNjQ0IHRhcmdldC9oZXhhZ29u
L2FyY2guYwoKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29uL2FyY2guaCBiL3RhcmdldC9oZXhh
Z29uL2FyY2guaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi4xZjdmMDM2Ci0t
LSAvZGV2L251bGwKKysrIGIvdGFyZ2V0L2hleGFnb24vYXJjaC5oCkBAIC0wLDAgKzEsMzQgQEAK
Ky8qCisgKiAgQ29weXJpZ2h0KGMpIDIwMTktMjAyMSBRdWFsY29tbSBJbm5vdmF0aW9uIENlbnRl
ciwgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLgorICoKKyAqICBUaGlzIHByb2dyYW0gaXMgZnJl
ZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQorICogIGl0
IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVi
bGlzaGVkIGJ5CisgKiAgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNp
b24gMiBvZiB0aGUgTGljZW5zZSwgb3IKKyAqICAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2
ZXJzaW9uLgorICoKKyAqICBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUg
dGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyAqICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdp
dGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgorICogIE1FUkNIQU5UQUJJTElUWSBv
ciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKKyAqICBHTlUgR2Vu
ZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorICoKKyAqICBZb3Ugc2hvdWxk
IGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQor
ICogIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtOyBpZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUu
b3JnL2xpY2Vuc2VzLz4uCisgKi8KKworI2lmbmRlZiBIRVhBR09OX0FSQ0hfSAorI2RlZmluZSBI
RVhBR09OX0FSQ0hfSAorCisjaW5jbHVkZSAicWVtdS9pbnQxMjguaCIKKwordWludDY0X3QgaW50
ZXJsZWF2ZSh1aW50MzJfdCBvZGQsIHVpbnQzMl90IGV2ZW4pOwordWludDY0X3QgZGVpbnRlcmxl
YXZlKHVpbnQ2NF90IHNyYyk7Cit1aW50MzJfdCBjYXJyeV9mcm9tX2FkZDY0KHVpbnQ2NF90IGEs
IHVpbnQ2NF90IGIsIHVpbnQzMl90IGMpOworaW50MzJfdCBjb252X3JvdW5kKGludDMyX3QgYSwg
aW50IG4pOwordm9pZCBhcmNoX2Zwb3Bfc3RhcnQoQ1BVSGV4YWdvblN0YXRlICplbnYpOwordm9p
ZCBhcmNoX2Zwb3BfZW5kKENQVUhleGFnb25TdGF0ZSAqZW52KTsKK2ludCBhcmNoX3NmX3JlY2lw
X2NvbW1vbihmbG9hdDMyICpScywgZmxvYXQzMiAqUnQsIGZsb2F0MzIgKlJkLAorICAgICAgICAg
ICAgICAgICAgICAgICAgIGludCAqYWRqdXN0LCBmbG9hdF9zdGF0dXMgKmZwX3N0YXR1cyk7Citp
bnQgYXJjaF9zZl9pbnZzcXJ0X2NvbW1vbihmbG9hdDMyICpScywgZmxvYXQzMiAqUmQsIGludCAq
YWRqdXN0LAorICAgICAgICAgICAgICAgICAgICAgICAgICBmbG9hdF9zdGF0dXMgKmZwX3N0YXR1
cyk7CisKKyNlbmRpZgpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vYXJjaC5jIGIvdGFyZ2V0
L2hleGFnb24vYXJjaC5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLjA5ZGUx
MjQKLS0tIC9kZXYvbnVsbAorKysgYi90YXJnZXQvaGV4YWdvbi9hcmNoLmMKQEAgLTAsMCArMSwz
MDAgQEAKKy8qCisgKiAgQ29weXJpZ2h0KGMpIDIwMTktMjAyMSBRdWFsY29tbSBJbm5vdmF0aW9u
IENlbnRlciwgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLgorICoKKyAqICBUaGlzIHByb2dyYW0g
aXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQor
ICogIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2Ug
YXMgcHVibGlzaGVkIGJ5CisgKiAgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVy
IHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IKKyAqICAoYXQgeW91ciBvcHRpb24pIGFueSBs
YXRlciB2ZXJzaW9uLgorICoKKyAqICBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhl
IGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyAqICBidXQgV0lUSE9VVCBBTlkgV0FSUkFO
VFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgorICogIE1FUkNIQU5UQUJJ
TElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKKyAqICBH
TlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorICoKKyAqICBZb3Ug
c2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGlj
ZW5zZQorICogIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtOyBpZiBub3QsIHNlZSA8aHR0cDovL3d3
dy5nbnUub3JnL2xpY2Vuc2VzLz4uCisgKi8KKworI2luY2x1ZGUgInFlbXUvb3NkZXAuaCIKKyNp
bmNsdWRlICJmcHUvc29mdGZsb2F0LmgiCisjaW5jbHVkZSAiY3B1LmgiCisjaW5jbHVkZSAiZm1h
X2VtdS5oIgorI2luY2x1ZGUgImFyY2guaCIKKyNpbmNsdWRlICJtYWNyb3MuaCIKKworI2RlZmlu
ZSBTRl9CSUFTICAgICAgICAxMjcKKyNkZWZpbmUgU0ZfTUFYRVhQICAgICAgMjU0CisjZGVmaW5l
IFNGX01BTlRCSVRTICAgIDIzCisjZGVmaW5lIGZsb2F0MzJfbmFuICAgIG1ha2VfZmxvYXQzMigw
eGZmZmZmZmZmKQorCisjZGVmaW5lIEJJVFNfTUFTS184IDB4NTU1NTU1NTU1NTU1NTU1NVVMTAor
I2RlZmluZSBQQUlSX01BU0tfOCAweDMzMzMzMzMzMzMzMzMzMzNVTEwKKyNkZWZpbmUgTllCTF9N
QVNLXzggMHgwZjBmMGYwZjBmMGYwZjBmVUxMCisjZGVmaW5lIEJZVEVfTUFTS184IDB4MDBmZjAw
ZmYwMGZmMDBmZlVMTAorI2RlZmluZSBIQUxGX01BU0tfOCAweDAwMDBmZmZmMDAwMGZmZmZVTEwK
KyNkZWZpbmUgV09SRF9NQVNLXzggMHgwMDAwMDAwMGZmZmZmZmZmVUxMCisKK3VpbnQ2NF90IGlu
dGVybGVhdmUodWludDMyX3Qgb2RkLCB1aW50MzJfdCBldmVuKQoreworICAgIC8qIENvbnZlcnQg
dG8gbG9uZyBsb25nICovCisgICAgdWludDY0X3QgbXlvZGQgPSBvZGQ7CisgICAgdWludDY0X3Qg
bXlldmVuID0gZXZlbjsKKyAgICAvKiBGaXJzdCwgc3ByZWFkIGJpdHMgb3V0ICovCisgICAgbXlv
ZGQgPSAobXlvZGQgfCAobXlvZGQgPDwgMTYpKSAmIEhBTEZfTUFTS184OworICAgIG15ZXZlbiA9
IChteWV2ZW4gfCAobXlldmVuIDw8IDE2KSkgJiBIQUxGX01BU0tfODsKKyAgICBteW9kZCA9ICht
eW9kZCB8IChteW9kZCA8PCA4KSkgJiBCWVRFX01BU0tfODsKKyAgICBteWV2ZW4gPSAobXlldmVu
IHwgKG15ZXZlbiA8PCA4KSkgJiBCWVRFX01BU0tfODsKKyAgICBteW9kZCA9IChteW9kZCB8ICht
eW9kZCA8PCA0KSkgJiBOWUJMX01BU0tfODsKKyAgICBteWV2ZW4gPSAobXlldmVuIHwgKG15ZXZl
biA8PCA0KSkgJiBOWUJMX01BU0tfODsKKyAgICBteW9kZCA9IChteW9kZCB8IChteW9kZCA8PCAy
KSkgJiBQQUlSX01BU0tfODsKKyAgICBteWV2ZW4gPSAobXlldmVuIHwgKG15ZXZlbiA8PCAyKSkg
JiBQQUlSX01BU0tfODsKKyAgICBteW9kZCA9IChteW9kZCB8IChteW9kZCA8PCAxKSkgJiBCSVRT
X01BU0tfODsKKyAgICBteWV2ZW4gPSAobXlldmVuIHwgKG15ZXZlbiA8PCAxKSkgJiBCSVRTX01B
U0tfODsKKyAgICAvKiBOb3cgT1IgdG9nZXRoZXIgKi8KKyAgICByZXR1cm4gbXlldmVuIHwgKG15
b2RkIDw8IDEpOworfQorCit1aW50NjRfdCBkZWludGVybGVhdmUodWludDY0X3Qgc3JjKQorewor
ICAgIC8qIEdldCBvZGQgYW5kIGV2ZW4gYml0cyAqLworICAgIHVpbnQ2NF90IG15b2RkID0gKChz
cmMgPj4gMSkgJiBCSVRTX01BU0tfOCk7CisgICAgdWludDY0X3QgbXlldmVuID0gKHNyYyAmIEJJ
VFNfTUFTS184KTsKKworICAgIC8qIFVuc3ByZWFkIGJpdHMgKi8KKyAgICBteWV2ZW4gPSAobXll
dmVuIHwgKG15ZXZlbiA+PiAxKSkgJiBQQUlSX01BU0tfODsKKyAgICBteW9kZCA9IChteW9kZCB8
IChteW9kZCA+PiAxKSkgJiBQQUlSX01BU0tfODsKKyAgICBteWV2ZW4gPSAobXlldmVuIHwgKG15
ZXZlbiA+PiAyKSkgJiBOWUJMX01BU0tfODsKKyAgICBteW9kZCA9IChteW9kZCB8IChteW9kZCA+
PiAyKSkgJiBOWUJMX01BU0tfODsKKyAgICBteWV2ZW4gPSAobXlldmVuIHwgKG15ZXZlbiA+PiA0
KSkgJiBCWVRFX01BU0tfODsKKyAgICBteW9kZCA9IChteW9kZCB8IChteW9kZCA+PiA0KSkgJiBC
WVRFX01BU0tfODsKKyAgICBteWV2ZW4gPSAobXlldmVuIHwgKG15ZXZlbiA+PiA4KSkgJiBIQUxG
X01BU0tfODsKKyAgICBteW9kZCA9IChteW9kZCB8IChteW9kZCA+PiA4KSkgJiBIQUxGX01BU0tf
ODsKKyAgICBteWV2ZW4gPSAobXlldmVuIHwgKG15ZXZlbiA+PiAxNikpICYgV09SRF9NQVNLXzg7
CisgICAgbXlvZGQgPSAobXlvZGQgfCAobXlvZGQgPj4gMTYpKSAmIFdPUkRfTUFTS184OworCisg
ICAgLyogUmV0dXJuIG9kZCBiaXRzIGluIHVwcGVyIGhhbGYgKi8KKyAgICByZXR1cm4gbXlldmVu
IHwgKG15b2RkIDw8IDMyKTsKK30KKwordWludDMyX3QgY2FycnlfZnJvbV9hZGQ2NCh1aW50NjRf
dCBhLCB1aW50NjRfdCBiLCB1aW50MzJfdCBjKQoreworICAgIHVpbnQ2NF90IHRtcGEsIHRtcGIs
IHRtcGM7CisgICAgdG1wYSA9IGZHRVRVV09SRCgwLCBhKTsKKyAgICB0bXBiID0gZkdFVFVXT1JE
KDAsIGIpOworICAgIHRtcGMgPSB0bXBhICsgdG1wYiArIGM7CisgICAgdG1wYSA9IGZHRVRVV09S
RCgxLCBhKTsKKyAgICB0bXBiID0gZkdFVFVXT1JEKDEsIGIpOworICAgIHRtcGMgPSB0bXBhICsg
dG1wYiArIGZHRVRVV09SRCgxLCB0bXBjKTsKKyAgICB0bXBjID0gZkdFVFVXT1JEKDEsIHRtcGMp
OworICAgIHJldHVybiB0bXBjOworfQorCitpbnQzMl90IGNvbnZfcm91bmQoaW50MzJfdCBhLCBp
bnQgbikKK3sKKyAgICBpbnQ2NF90IHZhbDsKKworICAgIGlmIChuID09IDApIHsKKyAgICAgICAg
dmFsID0gYTsKKyAgICB9IGVsc2UgaWYgKChhICYgKCgxIDw8IChuIC0gMSkpIC0gMSkpID09IDAp
IHsgICAgLyogTi0xLi4wIGFsbCB6ZXJvPyAqLworICAgICAgICAvKiBBZGQgTFNCIGZyb20gaW50
IHBhcnQgKi8KKyAgICAgICAgdmFsID0gKChmU0UzMl82NChhKSkgKyAoaW50NjRfdCkgKCgodWlu
dDMyX3QpICgoMSA8PCBuKSAmIGEpKSA+PiAxKSk7CisgICAgfSBlbHNlIHsKKyAgICAgICAgdmFs
ID0gKChmU0UzMl82NChhKSkgKyAoMSA8PCAobiAtIDEpKSk7CisgICAgfQorCisgICAgdmFsID0g
dmFsID4+IG47CisgICAgcmV0dXJuIChpbnQzMl90KXZhbDsKK30KKworLyogRmxvYXRpbmcgUG9p
bnQgU3R1ZmYgKi8KKworc3RhdGljIGNvbnN0IGludCBzb2Z0ZmxvYXRfcm91bmRpbmdtb2Rlc1td
ID0geworICAgIGZsb2F0X3JvdW5kX25lYXJlc3RfZXZlbiwKKyAgICBmbG9hdF9yb3VuZF90b196
ZXJvLAorICAgIGZsb2F0X3JvdW5kX2Rvd24sCisgICAgZmxvYXRfcm91bmRfdXAsCit9OworCit2
b2lkIGFyY2hfZnBvcF9zdGFydChDUFVIZXhhZ29uU3RhdGUgKmVudikKK3sKKyAgICBzZXRfZmxv
YXRfZXhjZXB0aW9uX2ZsYWdzKDAsICZlbnYtPmZwX3N0YXR1cyk7CisgICAgc2V0X2Zsb2F0X3Jv
dW5kaW5nX21vZGUoCisgICAgICAgIHNvZnRmbG9hdF9yb3VuZGluZ21vZGVzW2ZSRUFEX1JFR19G
SUVMRChVU1IsIFVTUl9GUFJORCldLAorICAgICAgICAmZW52LT5mcF9zdGF0dXMpOworfQorCisj
aWZkZWYgQ09ORklHX1VTRVJfT05MWQorLyoKKyAqIEhleGFnb24gTGludXgga2VybmVsIG9ubHkg
c2V0cyB0aGUgcmVsZXZhbnQgYml0cyBpbiBVU1IgKHVzZXIgc3RhdHVzCisgKiByZWdpc3Rlciku
ICBUaGUgZXhjZXB0aW9uIGlzbid0IHJhaXNlZCB0byB1c2VyIG1vZGUsIHNvIHdlIGRvbid0Cisg
KiBtb2RlbCBpdCBpbiBxZW11IHVzZXIgbW9kZS4KKyAqLworI2RlZmluZSBSQUlTRV9GUF9FWENF
UFRJT04gICBkbyB7fSB3aGlsZSAoMCkKKyNlbmRpZgorCisjZGVmaW5lIFNPRlRGTE9BVF9URVNU
X0ZMQUcoRkxBRywgTVlGLCBNWUUpIFwKKyAgICBkbyB7IFwKKyAgICAgICAgaWYgKGZsYWdzICYg
RkxBRykgeyBcCisgICAgICAgICAgICBpZiAoR0VUX1VTUl9GSUVMRChVU1JfIyNNWUYpID09IDAp
IHsgXAorICAgICAgICAgICAgICAgIFNFVF9VU1JfRklFTEQoVVNSXyMjTVlGLCAxKTsgXAorICAg
ICAgICAgICAgICAgIGlmIChHRVRfVVNSX0ZJRUxEKFVTUl8jI01ZRSkpIHsgXAorICAgICAgICAg
ICAgICAgICAgICBSQUlTRV9GUF9FWENFUFRJT047IFwKKyAgICAgICAgICAgICAgICB9IFwKKyAg
ICAgICAgICAgIH0gXAorICAgICAgICB9IFwKKyAgICB9IHdoaWxlICgwKQorCit2b2lkIGFyY2hf
ZnBvcF9lbmQoQ1BVSGV4YWdvblN0YXRlICplbnYpCit7CisgICAgaW50IGZsYWdzID0gZ2V0X2Zs
b2F0X2V4Y2VwdGlvbl9mbGFncygmZW52LT5mcF9zdGF0dXMpOworICAgIGlmIChmbGFncyAhPSAw
KSB7CisgICAgICAgIFNPRlRGTE9BVF9URVNUX0ZMQUcoZmxvYXRfZmxhZ19pbmV4YWN0LCBGUElO
UEYsIEZQSU5QRSk7CisgICAgICAgIFNPRlRGTE9BVF9URVNUX0ZMQUcoZmxvYXRfZmxhZ19kaXZi
eXplcm8sIEZQREJaRiwgRlBEQlpFKTsKKyAgICAgICAgU09GVEZMT0FUX1RFU1RfRkxBRyhmbG9h
dF9mbGFnX2ludmFsaWQsIEZQSU5WRiwgRlBJTlZFKTsKKyAgICAgICAgU09GVEZMT0FUX1RFU1Rf
RkxBRyhmbG9hdF9mbGFnX292ZXJmbG93LCBGUE9WRkYsIEZQT1ZGRSk7CisgICAgICAgIFNPRlRG
TE9BVF9URVNUX0ZMQUcoZmxvYXRfZmxhZ191bmRlcmZsb3csIEZQVU5GRiwgRlBVTkZFKTsKKyAg
ICB9Cit9CisKK3N0YXRpYyBmbG9hdDMyIGZsb2F0MzJfbXVsX3BvdzIoZmxvYXQzMiBhLCB1aW50
MzJfdCBwLCBmbG9hdF9zdGF0dXMgKmZwX3N0YXR1cykKK3sKKyAgICBmbG9hdDMyIGIgPSBtYWtl
X2Zsb2F0MzIoKFNGX0JJQVMgKyBwKSA8PCBTRl9NQU5UQklUUyk7CisgICAgcmV0dXJuIGZsb2F0
MzJfbXVsKGEsIGIsIGZwX3N0YXR1cyk7Cit9CisKK2ludCBhcmNoX3NmX3JlY2lwX2NvbW1vbihm
bG9hdDMyICpScywgZmxvYXQzMiAqUnQsIGZsb2F0MzIgKlJkLCBpbnQgKmFkanVzdCwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICBmbG9hdF9zdGF0dXMgKmZwX3N0YXR1cykKK3sKKyAgICBpbnQg
bl9leHA7CisgICAgaW50IGRfZXhwOworICAgIGludCByZXQgPSAwOworICAgIGZsb2F0MzIgUnNW
LCBSdFYsIFJkVjsKKyAgICBpbnQgUGVWID0gMDsKKyAgICBSc1YgPSAqUnM7CisgICAgUnRWID0g
KlJ0OworICAgIGlmIChmbG9hdDMyX2lzX2FueV9uYW4oUnNWKSAmJiBmbG9hdDMyX2lzX2FueV9u
YW4oUnRWKSkgeworICAgICAgICBpZiAoZXh0cmFjdDMyKFJzViAmIFJ0ViwgMjIsIDEpID09IDAp
IHsKKyAgICAgICAgICAgIGZsb2F0X3JhaXNlKGZsb2F0X2ZsYWdfaW52YWxpZCwgZnBfc3RhdHVz
KTsKKyAgICAgICAgfQorICAgICAgICBSZFYgPSBSc1YgPSBSdFYgPSBmbG9hdDMyX25hbjsKKyAg
ICB9IGVsc2UgaWYgKGZsb2F0MzJfaXNfYW55X25hbihSc1YpKSB7CisgICAgICAgIGlmIChleHRy
YWN0MzIoUnNWLCAyMiwgMSkgPT0gMCkgeworICAgICAgICAgICAgZmxvYXRfcmFpc2UoZmxvYXRf
ZmxhZ19pbnZhbGlkLCBmcF9zdGF0dXMpOworICAgICAgICB9CisgICAgICAgIFJkViA9IFJzViA9
IFJ0ViA9IGZsb2F0MzJfbmFuOworICAgIH0gZWxzZSBpZiAoZmxvYXQzMl9pc19hbnlfbmFuKFJ0
VikpIHsKKyAgICAgICAgLyogb3IgcHV0IE5hTiBpbiBudW0vZGVuIGZpeHVwPyAqLworICAgICAg
ICBpZiAoZXh0cmFjdDMyKFJ0ViwgMjIsIDEpID09IDApIHsKKyAgICAgICAgICAgIGZsb2F0X3Jh
aXNlKGZsb2F0X2ZsYWdfaW52YWxpZCwgZnBfc3RhdHVzKTsKKyAgICAgICAgfQorICAgICAgICBS
ZFYgPSBSc1YgPSBSdFYgPSBmbG9hdDMyX25hbjsKKyAgICB9IGVsc2UgaWYgKGZsb2F0MzJfaXNf
aW5maW5pdHkoUnNWKSAmJiBmbG9hdDMyX2lzX2luZmluaXR5KFJ0VikpIHsKKyAgICAgICAgLyog
b3IgcHV0IEluZiBpbiBudW0gZml4dXA/ICovCisgICAgICAgIFJkViA9IFJzViA9IFJ0ViA9IGZs
b2F0MzJfbmFuOworICAgICAgICBmbG9hdF9yYWlzZShmbG9hdF9mbGFnX2ludmFsaWQsIGZwX3N0
YXR1cyk7CisgICAgfSBlbHNlIGlmIChmbG9hdDMyX2lzX3plcm8oUnNWKSAmJiBmbG9hdDMyX2lz
X3plcm8oUnRWKSkgeworICAgICAgICAvKiBvciBwdXQgemVybyBpbiBudW0gZml4dXA/ICovCisg
ICAgICAgIFJkViA9IFJzViA9IFJ0ViA9IGZsb2F0MzJfbmFuOworICAgICAgICBmbG9hdF9yYWlz
ZShmbG9hdF9mbGFnX2ludmFsaWQsIGZwX3N0YXR1cyk7CisgICAgfSBlbHNlIGlmIChmbG9hdDMy
X2lzX3plcm8oUnRWKSkgeworICAgICAgICAvKiBvciBwdXQgSW5mIGluIG51bSBmaXh1cD8gKi8K
KyAgICAgICAgdWludDhfdCBSc1Zfc2lnbiA9IGZsb2F0MzJfaXNfbmVnKFJzVik7CisgICAgICAg
IHVpbnQ4X3QgUnRWX3NpZ24gPSBmbG9hdDMyX2lzX25lZyhSdFYpOworICAgICAgICBSc1YgPSBp
bmZpbml0ZV9mbG9hdDMyKFJzVl9zaWduIF4gUnRWX3NpZ24pOworICAgICAgICBSdFYgPSBmbG9h
dDMyX29uZTsKKyAgICAgICAgUmRWID0gZmxvYXQzMl9vbmU7CisgICAgICAgIGlmIChmbG9hdDMy
X2lzX2luZmluaXR5KFJzVikpIHsKKyAgICAgICAgICAgIGZsb2F0X3JhaXNlKGZsb2F0X2ZsYWdf
ZGl2Ynl6ZXJvLCBmcF9zdGF0dXMpOworICAgICAgICB9CisgICAgfSBlbHNlIGlmIChmbG9hdDMy
X2lzX2luZmluaXR5KFJ0VikpIHsKKyAgICAgICAgUnNWID0gbWFrZV9mbG9hdDMyKDB4ODAwMDAw
MDAgJiAoUnNWIF4gUnRWKSk7CisgICAgICAgIFJ0ViA9IGZsb2F0MzJfb25lOworICAgICAgICBS
ZFYgPSBmbG9hdDMyX29uZTsKKyAgICB9IGVsc2UgaWYgKGZsb2F0MzJfaXNfemVybyhSc1YpKSB7
CisgICAgICAgIC8qIERvZXMgdGhpcyBqdXN0IHdvcmsgaXRzZWxmIG91dD8gKi8KKyAgICAgICAg
LyogTm8sIDAvSW5mIGNhdXNlcyBwcm9ibGVtcy4gKi8KKyAgICAgICAgUnNWID0gbWFrZV9mbG9h
dDMyKDB4ODAwMDAwMDAgJiAoUnNWIF4gUnRWKSk7CisgICAgICAgIFJ0ViA9IGZsb2F0MzJfb25l
OworICAgICAgICBSZFYgPSBmbG9hdDMyX29uZTsKKyAgICB9IGVsc2UgaWYgKGZsb2F0MzJfaXNf
aW5maW5pdHkoUnNWKSkgeworICAgICAgICB1aW50OF90IFJzVl9zaWduID0gZmxvYXQzMl9pc19u
ZWcoUnNWKTsKKyAgICAgICAgdWludDhfdCBSdFZfc2lnbiA9IGZsb2F0MzJfaXNfbmVnKFJ0Vik7
CisgICAgICAgIFJzViA9IGluZmluaXRlX2Zsb2F0MzIoUnNWX3NpZ24gXiBSdFZfc2lnbik7Cisg
ICAgICAgIFJ0ViA9IGZsb2F0MzJfb25lOworICAgICAgICBSZFYgPSBmbG9hdDMyX29uZTsKKyAg
ICB9IGVsc2UgeworICAgICAgICBQZVYgPSAweDAwOworICAgICAgICAvKiBCYXNpYyBjaGVja3Mg
cGFzc2VkICovCisgICAgICAgIG5fZXhwID0gZmxvYXQzMl9nZXRleHAoUnNWKTsKKyAgICAgICAg
ZF9leHAgPSBmbG9hdDMyX2dldGV4cChSdFYpOworICAgICAgICBpZiAoKG5fZXhwIC0gZF9leHAg
KyBTRl9CSUFTKSA8PSBTRl9NQU5UQklUUykgeworICAgICAgICAgICAgLyogTmVhciBxdW90aWVu
dCB1bmRlcmZsb3cgLyBpbmV4YWN0IFEgKi8KKyAgICAgICAgICAgIFBlViA9IDB4ODA7CisgICAg
ICAgICAgICBSdFYgPSBmbG9hdDMyX211bF9wb3cyKFJ0ViwgLTY0LCBmcF9zdGF0dXMpOworICAg
ICAgICAgICAgUnNWID0gZmxvYXQzMl9tdWxfcG93MihSc1YsIDY0LCBmcF9zdGF0dXMpOworICAg
ICAgICB9IGVsc2UgaWYgKChuX2V4cCAtIGRfZXhwICsgU0ZfQklBUykgPiAoU0ZfTUFYRVhQIC0g
MjQpKSB7CisgICAgICAgICAgICAvKiBOZWFyIHF1b3RpZW50IG92ZXJmbG93ICovCisgICAgICAg
ICAgICBQZVYgPSAweDQwOworICAgICAgICAgICAgUnRWID0gZmxvYXQzMl9tdWxfcG93MihSdFYs
IDMyLCBmcF9zdGF0dXMpOworICAgICAgICAgICAgUnNWID0gZmxvYXQzMl9tdWxfcG93MihSc1Ys
IC0zMiwgZnBfc3RhdHVzKTsKKyAgICAgICAgfSBlbHNlIGlmIChuX2V4cCA8PSBTRl9NQU5UQklU
UyArIDIpIHsKKyAgICAgICAgICAgIFJ0ViA9IGZsb2F0MzJfbXVsX3BvdzIoUnRWLCA2NCwgZnBf
c3RhdHVzKTsKKyAgICAgICAgICAgIFJzViA9IGZsb2F0MzJfbXVsX3BvdzIoUnNWLCA2NCwgZnBf
c3RhdHVzKTsKKyAgICAgICAgfSBlbHNlIGlmIChkX2V4cCA8PSAxKSB7CisgICAgICAgICAgICBS
dFYgPSBmbG9hdDMyX211bF9wb3cyKFJ0ViwgMzIsIGZwX3N0YXR1cyk7CisgICAgICAgICAgICBS
c1YgPSBmbG9hdDMyX211bF9wb3cyKFJzViwgMzIsIGZwX3N0YXR1cyk7CisgICAgICAgIH0gZWxz
ZSBpZiAoZF9leHAgPiAyNTIpIHsKKyAgICAgICAgICAgIFJ0ViA9IGZsb2F0MzJfbXVsX3BvdzIo
UnRWLCAtMzIsIGZwX3N0YXR1cyk7CisgICAgICAgICAgICBSc1YgPSBmbG9hdDMyX211bF9wb3cy
KFJzViwgLTMyLCBmcF9zdGF0dXMpOworICAgICAgICB9CisgICAgICAgIFJkViA9IDA7CisgICAg
ICAgIHJldCA9IDE7CisgICAgfQorICAgICpScyA9IFJzVjsKKyAgICAqUnQgPSBSdFY7CisgICAg
KlJkID0gUmRWOworICAgICphZGp1c3QgPSBQZVY7CisgICAgcmV0dXJuIHJldDsKK30KKworaW50
IGFyY2hfc2ZfaW52c3FydF9jb21tb24oZmxvYXQzMiAqUnMsIGZsb2F0MzIgKlJkLCBpbnQgKmFk
anVzdCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsb2F0X3N0YXR1cyAqZnBfc3RhdHVz
KQoreworICAgIGZsb2F0MzIgUnNWLCBSZFY7CisgICAgaW50IFBlViA9IDA7CisgICAgaW50IHJf
ZXhwOworICAgIGludCByZXQgPSAwOworICAgIFJzViA9ICpSczsKKyAgICBpZiAoZmxvYXQzMl9p
c19pbmZpbml0eShSc1YpKSB7CisgICAgICAgIGlmIChleHRyYWN0MzIoUnNWLCAyMiwgMSkgPT0g
MCkgeworICAgICAgICAgICAgZmxvYXRfcmFpc2UoZmxvYXRfZmxhZ19pbnZhbGlkLCBmcF9zdGF0
dXMpOworICAgICAgICB9CisgICAgICAgIFJkViA9IFJzViA9IGZsb2F0MzJfbmFuOworICAgIH0g
ZWxzZSBpZiAoZmxvYXQzMl9sdChSc1YsIGZsb2F0MzJfemVybywgZnBfc3RhdHVzKSkgeworICAg
ICAgICAvKiBOZWdhdGl2ZSBub256ZXJvIHZhbHVlcyBhcmUgTmFOICovCisgICAgICAgIGZsb2F0
X3JhaXNlKGZsb2F0X2ZsYWdfaW52YWxpZCwgZnBfc3RhdHVzKTsKKyAgICAgICAgUnNWID0gZmxv
YXQzMl9uYW47CisgICAgICAgIFJkViA9IGZsb2F0MzJfbmFuOworICAgIH0gZWxzZSBpZiAoZmxv
YXQzMl9pc19pbmZpbml0eShSc1YpKSB7CisgICAgICAgIC8qIG9yIHB1dCBJbmYgaW4gbnVtIGZp
eHVwPyAqLworICAgICAgICBSc1YgPSBpbmZpbml0ZV9mbG9hdDMyKDEpOworICAgICAgICBSZFYg
PSBpbmZpbml0ZV9mbG9hdDMyKDEpOworICAgIH0gZWxzZSBpZiAoZmxvYXQzMl9pc196ZXJvKFJz
VikpIHsKKyAgICAgICAgLyogb3IgcHV0IHplcm8gaW4gbnVtIGZpeHVwPyAqLworICAgICAgICBS
ZFYgPSBmbG9hdDMyX29uZTsKKyAgICB9IGVsc2UgeworICAgICAgICBQZVYgPSAweDAwOworICAg
ICAgICAvKiBCYXNpYyBjaGVja3MgcGFzc2VkICovCisgICAgICAgIHJfZXhwID0gZmxvYXQzMl9n
ZXRleHAoUnNWKTsKKyAgICAgICAgaWYgKHJfZXhwIDw9IDI0KSB7CisgICAgICAgICAgICBSc1Yg
PSBmbG9hdDMyX211bF9wb3cyKFJzViwgNjQsIGZwX3N0YXR1cyk7CisgICAgICAgICAgICBQZVYg
PSAweGUwOworICAgICAgICB9CisgICAgICAgIFJkViA9IDA7CisgICAgICAgIHJldCA9IDE7Cisg
ICAgfQorICAgICpScyA9IFJzVjsKKyAgICAqUmQgPSBSZFY7CisgICAgKmFkanVzdCA9IFBlVjsK
KyAgICByZXR1cm4gcmV0OworfQotLSAKMi43LjQKCg==

