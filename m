Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id A4D7C65AEDA
	for <lists+qemu-devel@lfdr.de>; Mon,  2 Jan 2023 10:46:35 +0100 (CET)
Received: from localhost ([::1] helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces@nongnu.org>)
	id 1pCHNY-00051K-SR; Mon, 02 Jan 2023 04:45:12 -0500
Received: from eggs.gnu.org ([2001:470:142:3::10])
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <fanwj@mail.ustc.edu.cn>)
 id 1pCHNS-000516-Hx
 for qemu-devel@nongnu.org; Mon, 02 Jan 2023 04:45:09 -0500
Received: from email6.ustc.edu.cn ([2001:da8:d800::8] helo=ustc.edu.cn)
 by eggs.gnu.org with esmtp (Exim 4.90_1)
 (envelope-from <fanwj@mail.ustc.edu.cn>) id 1pCHNO-000050-12
 for qemu-devel@nongnu.org; Mon, 02 Jan 2023 04:45:06 -0500
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=mail.ustc.edu.cn; s=dkim; h=Received:Date:From:To:Subject:
 Content-Type:MIME-Version:Message-ID; bh=emH/Z1Ok7nmH9kNpK5wVN6q
 rAmY+tMS404YV7dgmiq0=; b=q2WK07JgiRxrwKminNSiLHnt7dQypqF3z77Cxzw
 yik3mgbbmW8X3yDzMXgGrqQVV8lvlGBwqYOYNWDlb2sr/97blYI+xiRsazDPfue2
 3yqhc1ss8GedHdxX4uopUqzEO3nfDtQaQi26B4GB7X3YcoANXw5VyhzXnC7OZf1I
 bqec=
Received: by ajax-webmail-newmailweb.ustc.edu.cn (Coremail) ; Mon, 2 Jan
 2023 17:44:49 +0800 (GMT+08:00)
X-Originating-IP: [120.204.77.150]
Date: Mon, 2 Jan 2023 17:44:49 +0800 (GMT+08:00)
X-CM-HeaderCharset: UTF-8
From: fanwj@mail.ustc.edu.cn
To: qemu-devel@nongnu.org
Subject: [PATCH] linux-user: fix bug about incorrect base addresss of idt
 and gdt on i386 and x86_64
X-Priority: 3
X-Mailer: Coremail Webmail Server Version XT3.0.8 dev build
 20210401(c5ff3689) Copyright (c) 2002-2023 www.mailtech.cn ustccn
X-SendMailWithSms: false
Content-Type: multipart/alternative; 
 boundary="----=_Part_464412_1830862569.1672652689268"
MIME-Version: 1.0
Message-ID: <5c354035.20760.18571de8f74.Coremail.fanwj@mail.ustc.edu.cn>
X-Coremail-Locale: zh_CN
X-CM-TRANSID: LkAmygAXGn6Rp7JjiPGLAA--.3W
X-CM-SenderInfo: pidq4yo6pdxzwoxv3uoohg3hdfq/1tbiAQwTEFQhoPOJ6QAIsA
X-Coremail-Antispam: 1Ur529EdanIXcx71UUUUU7IcSsGvfJ3iIAIbVAYjsxI4VWxJw
 CS07vEb4IE77IF4wCS07vE1I0E4x80FVAKz4kxMIAIbVAFxVCaYxvI4VCIwcAKzIAtYxBI
 daVFxhVjvjDU=
Received-SPF: pass client-ip=2001:da8:d800::8;
 envelope-from=fanwj@mail.ustc.edu.cn; helo=ustc.edu.cn
X-Spam_score_int: -19
X-Spam_score: -2.0
X-Spam_bar: --
X-Spam_report: (-2.0 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, HTML_MESSAGE=0.001, SPF_HELO_PASS=-0.001,
 SPF_PASS=-0.001 autolearn=ham autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org

------=_Part_464412_1830862569.1672652689268
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: base64

T24gbGludXggdXNlciBtb2RlLCBDUFVYODZTdGF0ZTo6aWR0OjpiYXNlIGFuZCBDUFVYODZTdGF0
ZTo6Z2R0OjpiYXNlIGZyb20gRGlmZmVyZW50IENQVVg4NlN0YXRlIE9iamVjdHMgaGF2ZSBzYW1l
IHZhbHVlLCBJdCBpcyBpbmNvcnJlY3QhIEV2ZXJ5IENQVVg4NlN0YXRlOjppZHQ6OmJhc2UgYW5k
IEV2ZXJ5IENQVVg4NlN0YXRlOjpnZHQ6OmJhc2UgTXVzdCBwb2ludHMgdG8gaW5kZXBlbmRlbnQg
bWVtb3J5IHNwYWNlLiBSZXNvbHZlczogaHR0cHM6Ly9naXRsYWIuY29tL3FlbXUtcHJvamVjdC9x
ZW11Ly0vaXNzdWVzLzE0MDUgU2lnbmVkLW9mZi1ieTogZmFud2VuamllIC0tLSBsaW51eC11c2Vy
L2kzODYvY3B1X2xvb3AuYyB8IDEwICsrKysrKysrKysgbGludXgtdXNlci9tYWluLmMgfCAxMSAr
KysrKysrKysrKyAyIGZpbGVzIGNoYW5nZWQsIDIxIGluc2VydGlvbnMoKykgZGlmZiAtLWdpdCBh
L2xpbnV4LXVzZXIvaTM4Ni9jcHVfbG9vcC5jIGIvbGludXgtdXNlci9pMzg2L2NwdV9sb29wLmMg
aW5kZXggODY1NDEzYzA4Zi4uMWYyM2JjNWUzYSAxMDA2NDQgLS0tIGEvbGludXgtdXNlci9pMzg2
L2NwdV9sb29wLmMgKysrIGIvbGludXgtdXNlci9pMzg2L2NwdV9sb29wLmMgQEAgLTMxNCw4ICsz
MTQsMTggQEAgdm9pZCBjcHVfbG9vcChDUFVYODZTdGF0ZSAqZW52KSB9IH0gK3N0YXRpYyB2b2lk
IHRhcmdldF9jcHVfZnJlZSh2b2lkICpvYmopICt7ICsgQ1BVQXJjaFN0YXRlKiBlbnYgPSAoKENQ
VVN0YXRlKilvYmopLT5lbnZfcHRyOyArIHRhcmdldF9tdW5tYXAoZW52LT5pZHQuYmFzZSwgc2l6
ZW9mKHVpbnQ2NF90KSAqIChlbnYtPmlkdC5saW1pdCArIDEpKTsgKyB0YXJnZXRfbXVubWFwKGVu
di0+Z2R0LmJhc2UsIHNpemVvZih1aW50NjRfdCkgKiBUQVJHRVRfR0RUX0VOVFJJRVMpOyArIGdf
ZnJlZShvYmopOyArfSArIHZvaWQgdGFyZ2V0X2NwdV9jb3B5X3JlZ3MoQ1BVQXJjaFN0YXRlICpl
bnYsIHN0cnVjdCB0YXJnZXRfcHRfcmVncyAqcmVncykgeyArIENQVVN0YXRlKiBjcHUgPSBlbnZf
Y3B1KGVudik7ICsgT0JKRUNUKGNwdSktPmZyZWUgPSB0YXJnZXRfY3B1X2ZyZWU7IGVudi0+Y3Jb
MF0gPSBDUjBfUEdfTUFTSyB8IENSMF9XUF9NQVNLIHwgQ1IwX1BFX01BU0s7IGVudi0+aGZsYWdz
IHw9IEhGX1BFX01BU0sgfCBIRl9DUExfTUFTSzsgaWYgKGVudi0+ZmVhdHVyZXNbRkVBVF8xX0VE
WF0gJiBDUFVJRF9TU0UpIHsgZGlmZiAtLWdpdCBhL2xpbnV4LXVzZXIvbWFpbi5jIGIvbGludXgt
dXNlci9tYWluLmMgaW5kZXggYTE3ZmVkMDQ1Yi4uMjI3NjA0MDU0OCAxMDA2NDQgLS0tIGEvbGlu
dXgtdXNlci9tYWluLmMgKysrIGIvbGludXgtdXNlci9tYWluLmMgQEAgLTIzNCw2ICsyMzQsMTcg
QEAgQ1BVQXJjaFN0YXRlICpjcHVfY29weShDUFVBcmNoU3RhdGUgKmVudikgbmV3X2NwdS0+dGNn
X2NmbGFncyA9IGNwdS0+dGNnX2NmbGFnczsgbWVtY3B5KG5ld19lbnYsIGVudiwgc2l6ZW9mKENQ
VUFyY2hTdGF0ZSkpOyArI2lmIGRlZmluZWQoVEFSR0VUX0kzODYpIHx8IGRlZmluZWQoVEFSR0VU
X1g4Nl82NCkgKyBuZXdfZW52LT5nZHQuYmFzZSA9IHRhcmdldF9tbWFwKDAsIHNpemVvZih1aW50
NjRfdCkgKiBUQVJHRVRfR0RUX0VOVFJJRVMsICsgUFJPVF9SRUFEfFBST1RfV1JJVEUsICsgTUFQ
X0FOT05ZTU9VU3xNQVBfUFJJVkFURSwgLTEsIDApOyArIG5ld19lbnYtPmlkdC5iYXNlID0gdGFy
Z2V0X21tYXAoMCwgc2l6ZW9mKHVpbnQ2NF90KSAqIChlbnYtPmlkdC5saW1pdCArIDEpLCArIFBS
T1RfUkVBRHxQUk9UX1dSSVRFLCArIE1BUF9BTk9OWU1PVVN8TUFQX1BSSVZBVEUsIC0xLCAwKTsg
KyBtZW1jcHkoKHZvaWQqKW5ld19lbnYtPmdkdC5iYXNlLCAodm9pZCopZW52LT5nZHQuYmFzZSwg
c2l6ZW9mKHVpbnQ2NF90KSAqIFRBUkdFVF9HRFRfRU5UUklFUyk7ICsgbWVtY3B5KCh2b2lkKilu
ZXdfZW52LT5pZHQuYmFzZSwgKHZvaWQqKWVudi0+aWR0LmJhc2UsIHNpemVvZih1aW50NjRfdCkg
KiAoZW52LT5pZHQubGltaXQgKyAxKSk7ICsgT0JKRUNUKG5ld19jcHUpLT5mcmVlID0gT0JKRUNU
KGNwdSktPmZyZWU7ICsjZW5kaWYgLyogQ2xvbmUgYWxsIGJyZWFrL3dhdGNocG9pbnRzLiBOb3Rl
OiBPbmNlIHdlIHN1cHBvcnQgcHRyYWNlIHdpdGggaHctZGVidWcgcmVnaXN0ZXIgYWNjZXNzLCBt
YWtlIHN1cmUgLS0gMi4zNC4x
------=_Part_464412_1830862569.1672652689268
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: base64

T24gbGludXggdXNlciBtb2RlLCBDUFVYODZTdGF0ZTo6aWR0OjpiYXNlIGFuZCBDUFVYODZTdGF0
ZTo6Z2R0OjpiYXNlIGZyb20gRGlmZmVyZW50IENQVVg4NlN0YXRlIE9iamVjdHMgaGF2ZSBzYW1l
IHZhbHVlLCBJdCBpcyBpbmNvcnJlY3QhIEV2ZXJ5IENQVVg4NlN0YXRlOjppZHQ6OmJhc2UgYW5k
IEV2ZXJ5IENQVVg4NlN0YXRlOjpnZHQ6OmJhc2UgTXVzdCBwb2ludHMgdG8gaW5kZXBlbmRlbnQg
bWVtb3J5IHNwYWNlLiAgCgpSZXNvbHZlczogaHR0cHM6Ly9naXRsYWIuY29tL3FlbXUtcHJvamVj
dC9xZW11Ly0vaXNzdWVzLzE0MDUKU2lnbmVkLW9mZi1ieTogZmFud2VuamllIDxmYW53aj4KCi0t
LQogbGludXgtdXNlci9pMzg2L2NwdV9sb29wLmMgfCAxMCArKysrKysrKysrCiBsaW51eC11c2Vy
L21haW4uYyAgICAgICAgICB8IDExICsrKysrKysrKysrCiAyIGZpbGVzIGNoYW5nZWQsIDIxIGlu
c2VydGlvbnMoKykKCmRpZmYgLS1naXQgYS9saW51eC11c2VyL2kzODYvY3B1X2xvb3AuYyBiL2xp
bnV4LXVzZXIvaTM4Ni9jcHVfbG9vcC5jCmluZGV4IDg2NTQxM2MwOGYuLjFmMjNiYzVlM2EgMTAw
NjQ0Ci0tLSBhL2xpbnV4LXVzZXIvaTM4Ni9jcHVfbG9vcC5jCisrKyBiL2xpbnV4LXVzZXIvaTM4
Ni9jcHVfbG9vcC5jCkBAIC0zMTQsOCArMzE0LDE4IEBAIHZvaWQgY3B1X2xvb3AoQ1BVWDg2U3Rh
dGUgKmVudikKICAgICB9CiB9CiAKK3N0YXRpYyB2b2lkIHRhcmdldF9jcHVfZnJlZSh2b2lkICpv
YmopCit7CisgICAgQ1BVQXJjaFN0YXRlKiBlbnYgPSAoKENQVVN0YXRlKilvYmopLSZndDtlbnZf
cHRyOworICAgIHRhcmdldF9tdW5tYXAoZW52LSZndDtpZHQuYmFzZSwgc2l6ZW9mKHVpbnQ2NF90
KSAqIChlbnYtJmd0O2lkdC5saW1pdCArIDEpKTsKKyAgICB0YXJnZXRfbXVubWFwKGVudi0mZ3Q7
Z2R0LmJhc2UsIHNpemVvZih1aW50NjRfdCkgKiBUQVJHRVRfR0RUX0VOVFJJRVMpOworICAgIGdf
ZnJlZShvYmopOworfQorCiB2b2lkIHRhcmdldF9jcHVfY29weV9yZWdzKENQVUFyY2hTdGF0ZSAq
ZW52LCBzdHJ1Y3QgdGFyZ2V0X3B0X3JlZ3MgKnJlZ3MpCiB7CisgICAgQ1BVU3RhdGUqIGNwdSA9
IGVudl9jcHUoZW52KTsKKyAgICBPQkpFQ1QoY3B1KS0mZ3Q7ZnJlZSA9IHRhcmdldF9jcHVfZnJl
ZTsKICAgICBlbnYtJmd0O2NyWzBdID0gQ1IwX1BHX01BU0sgfCBDUjBfV1BfTUFTSyB8IENSMF9Q
RV9NQVNLOwogICAgIGVudi0mZ3Q7aGZsYWdzIHw9IEhGX1BFX01BU0sgfCBIRl9DUExfTUFTSzsK
ICAgICBpZiAoZW52LSZndDtmZWF0dXJlc1tGRUFUXzFfRURYXSAmYW1wOyBDUFVJRF9TU0UpIHsK
ZGlmZiAtLWdpdCBhL2xpbnV4LXVzZXIvbWFpbi5jIGIvbGludXgtdXNlci9tYWluLmMKaW5kZXgg
YTE3ZmVkMDQ1Yi4uMjI3NjA0MDU0OCAxMDA2NDQKLS0tIGEvbGludXgtdXNlci9tYWluLmMKKysr
IGIvbGludXgtdXNlci9tYWluLmMKQEAgLTIzNCw2ICsyMzQsMTcgQEAgQ1BVQXJjaFN0YXRlICpj
cHVfY29weShDUFVBcmNoU3RhdGUgKmVudikKIAogICAgIG5ld19jcHUtJmd0O3RjZ19jZmxhZ3Mg
PSBjcHUtJmd0O3RjZ19jZmxhZ3M7CiAgICAgbWVtY3B5KG5ld19lbnYsIGVudiwgc2l6ZW9mKENQ
VUFyY2hTdGF0ZSkpOworI2lmIGRlZmluZWQoVEFSR0VUX0kzODYpIHx8IGRlZmluZWQoVEFSR0VU
X1g4Nl82NCkKKyAgICBuZXdfZW52LSZndDtnZHQuYmFzZSA9IHRhcmdldF9tbWFwKDAsIHNpemVv
Zih1aW50NjRfdCkgKiBUQVJHRVRfR0RUX0VOVFJJRVMsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBQUk9UX1JFQUR8UFJPVF9XUklURSwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIE1BUF9BTk9OWU1PVVN8TUFQX1BSSVZBVEUsIC0xLCAwKTsKKyAgICBu
ZXdfZW52LSZndDtpZHQuYmFzZSA9IHRhcmdldF9tbWFwKDAsIHNpemVvZih1aW50NjRfdCkgKiAo
ZW52LSZndDtpZHQubGltaXQgKyAxKSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
UFJPVF9SRUFEfFBST1RfV1JJVEUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1B
UF9BTk9OWU1PVVN8TUFQX1BSSVZBVEUsIC0xLCAwKTsKKyAgICBtZW1jcHkoKHZvaWQqKW5ld19l
bnYtJmd0O2dkdC5iYXNlLCAodm9pZCopZW52LSZndDtnZHQuYmFzZSwgc2l6ZW9mKHVpbnQ2NF90
KSAqIFRBUkdFVF9HRFRfRU5UUklFUyk7CisgICAgbWVtY3B5KCh2b2lkKiluZXdfZW52LSZndDtp
ZHQuYmFzZSwgKHZvaWQqKWVudi0mZ3Q7aWR0LmJhc2UsIHNpemVvZih1aW50NjRfdCkgKiAoZW52
LSZndDtpZHQubGltaXQgKyAxKSk7CisgICAgT0JKRUNUKG5ld19jcHUpLSZndDtmcmVlID0gT0JK
RUNUKGNwdSktJmd0O2ZyZWU7CisjZW5kaWYKIAogICAgIC8qIENsb25lIGFsbCBicmVhay93YXRj
aHBvaW50cy4KICAgICAgICBOb3RlOiBPbmNlIHdlIHN1cHBvcnQgcHRyYWNlIHdpdGggaHctZGVi
dWcgcmVnaXN0ZXIgYWNjZXNzLCBtYWtlIHN1cmUKLS0gCjIuMzQuMTwvZmFud2o+
------=_Part_464412_1830862569.1672652689268--


