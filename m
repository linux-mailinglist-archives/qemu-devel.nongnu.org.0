Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id B787461A0FE
	for <lists+qemu-devel@lfdr.de>; Fri,  4 Nov 2022 20:28:53 +0100 (CET)
Received: from localhost ([::1] helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces@nongnu.org>)
	id 1or2L7-0001d3-2x; Fri, 04 Nov 2022 15:26:53 -0400
Received: from eggs.gnu.org ([2001:470:142:3::10])
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1or2Ky-0001Ya-TI
 for qemu-devel@nongnu.org; Fri, 04 Nov 2022 15:26:45 -0400
Received: from mx0b-0031df01.pphosted.com ([205.220.180.131])
 by eggs.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <tsimpson@qualcomm.com>)
 id 1or2Kt-0002Lj-Lc
 for qemu-devel@nongnu.org; Fri, 04 Nov 2022 15:26:44 -0400
Received: from pps.filterd (m0279872.ppops.net [127.0.0.1])
 by mx0a-0031df01.pphosted.com (8.17.1.19/8.17.1.19) with ESMTP id
 2A4J6sMj001601; Fri, 4 Nov 2022 19:26:36 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=quicinc.com;
 h=from : to : cc :
 subject : date : message-id : in-reply-to : references : mime-version :
 content-type : content-transfer-encoding; s=qcppdkim1;
 bh=jYQK+tIyuUqjGvd4REY8bMAvGlvK1uAzqDkYlacFGeQ=;
 b=BhZ3bw6z6HiP+4Up6KfaK6PZaagZjsJpG2CKHrH+qlGw/bAuzlqEHie69PT+7GZU+zYi
 1YJy57xAteFtarnsV2MFATaYdFo/6oAcfB65OZQrWU2X75zuuMZy7euiR73oDaoHLcIf
 JBr4StABbp4yqgG6tugQrkn7pPj1Cj9gxR6XpmF2jMQt6OnJZM1EK/wELpRn5jY+AxhR
 7N00XzlZdQaS8PNAgYvqAi5TFuWTK0H79f6ZbnqSb2WEp/uFWk775r5wz4rrRdjgkwUf
 S+HcjB4LGH6Vz9IUuT6qWnpvDSeom6daIkcGmnPQfLpSMuu3toUcqVdnFUv/6c+Wh6VV Ww== 
Received: from nalasppmta05.qualcomm.com (Global_NAT1.qualcomm.com
 [129.46.96.20])
 by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 3kmvgk9njq-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Fri, 04 Nov 2022 19:26:35 +0000
Received: from pps.filterd (NALASPPMTA05.qualcomm.com [127.0.0.1])
 by NALASPPMTA05.qualcomm.com (8.17.1.5/8.17.1.5) with ESMTP id 2A4JQYNg001488; 
 Fri, 4 Nov 2022 19:26:34 GMT
Received: from pps.reinject (localhost [127.0.0.1])
 by NALASPPMTA05.qualcomm.com (PPS) with ESMTPS id 3khdmjykjq-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NO);
 Fri, 04 Nov 2022 19:26:34 +0000
Received: from NALASPPMTA05.qualcomm.com (NALASPPMTA05.qualcomm.com
 [127.0.0.1])
 by pps.reinject (8.17.1.5/8.17.1.5) with ESMTP id 2A4JQXPZ001464;
 Fri, 4 Nov 2022 19:26:33 GMT
Received: from hu-devc-lv-u18-c.qualcomm.com (hu-tsimpson-lv.qualcomm.com
 [10.47.235.220])
 by NALASPPMTA05.qualcomm.com (PPS) with ESMTP id 2A4JQXlH001462;
 Fri, 04 Nov 2022 19:26:33 +0000
Received: by hu-devc-lv-u18-c.qualcomm.com (Postfix, from userid 47164)
 id F050F5000A8; Fri,  4 Nov 2022 12:26:32 -0700 (PDT)
From: Taylor Simpson <tsimpson@quicinc.com>
To: qemu-devel@nongnu.org
Cc: tsimpson@quicinc.com, richard.henderson@linaro.org, philmd@linaro.org,
 ale@rev.ng, anjo@rev.ng, bcain@quicinc.com, quic_mathbern@quicinc.com
Subject: [PATCH v3 01/11] Hexagon (target/hexagon) Add pkt and insn to
 DisasContext
Date: Fri,  4 Nov 2022 12:26:21 -0700
Message-Id: <20221104192631.29434-2-tsimpson@quicinc.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20221104192631.29434-1-tsimpson@quicinc.com>
References: <20221104192631.29434-1-tsimpson@quicinc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
X-QCInternal: smtphost
X-QCInternal: smtphost
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-ORIG-GUID: Eg4yZlcfAr85fsZwulvnNK94ovrFpoUl
X-Proofpoint-GUID: Eg4yZlcfAr85fsZwulvnNK94ovrFpoUl
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.219,Aquarius:18.0.895,Hydra:6.0.545,FMLib:17.11.122.1
 definitions=2022-11-04_11,2022-11-03_01,2022-06-22_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 priorityscore=1501
 suspectscore=0 impostorscore=0 lowpriorityscore=0 malwarescore=0
 spamscore=0 clxscore=1015 bulkscore=0 mlxlogscore=492 phishscore=0
 mlxscore=0 adultscore=0 classifier=spam adjust=0 reason=mlx scancount=1
 engine=8.12.0-2210170000 definitions=main-2211040121
Received-SPF: pass client-ip=205.220.180.131;
 envelope-from=tsimpson@qualcomm.com; helo=mx0b-0031df01.pphosted.com
X-Spam_score_int: -17
X-Spam_score: -1.8
X-Spam_bar: -
X-Spam_report: (-1.8 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, HEADER_FROM_DIFFERENT_DOMAINS=0.249,
 RCVD_IN_DNSWL_NONE=-0.0001, SPF_HELO_NONE=0.001,
 SPF_PASS=-0.001 autolearn=no autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Sender: "Qemu-devel" <qemu-devel-bounces@nongnu.org>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org

VGhpcyBlbmFibGVzIHVzIHRvIHJlZHVjZSB0aGUgbnVtYmVyIG9mIHBhcmFtZXRlcnMgdG8gbWFu
eSBmdW5jdGlvbnMKSW4gcGFydGljdWxhciwgdGhlIGdlbmVyYXRlZCBmdW5jdGlvbnMgcHJldmlv
dXNseSB0b29rIGFsbCAzIGFzIGFyZ3VtZW50cwoKTm90IG9ubHkgZG9lcyB0aGlzIHNpbXBsaWZ5
IHRoZSBjb2RlLCBpdCBpbXByb3ZlcyB0aGUgdHJhbnNsYXRpb24gdGltZQoKU2lnbmVkLW9mZi1i
eTogVGF5bG9yIFNpbXBzb24gPHRzaW1wc29uQHF1aWNpbmMuY29tPgotLS0KIHRhcmdldC9oZXhh
Z29uL2dlbl90Y2dfaHZ4LmggICAgfCAgIDYgKy0KIHRhcmdldC9oZXhhZ29uL2luc24uaCAgICAg
ICAgICAgfCAgIDcgKy0KIHRhcmdldC9oZXhhZ29uL21hY3Jvcy5oICAgICAgICAgfCAgMTAgKy0t
CiB0YXJnZXQvaGV4YWdvbi9tbXZlYy9tYWNyb3MuaCAgIHwgICA0ICstCiB0YXJnZXQvaGV4YWdv
bi90cmFuc2xhdGUuaCAgICAgIHwgICA5ICsrLQogdGFyZ2V0L2hleGFnb24vZ2VucHRyLmMgICAg
ICAgICB8ICAgNiArLQogdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmMgICAgICB8IDEyMCArKysr
KysrKysrKysrKysrKy0tLS0tLS0tLS0tLS0tLQogdGFyZ2V0L2hleGFnb24vZ2VuX3RjZ19mdW5j
cy5weSB8ICAxNSArKy0tCiA4IGZpbGVzIGNoYW5nZWQsIDg5IGluc2VydGlvbnMoKyksIDg4IGRl
bGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29uL2dlbl90Y2dfaHZ4LmggYi90
YXJnZXQvaGV4YWdvbi9nZW5fdGNnX2h2eC5oCmluZGV4IGNkY2M5MzgyYmIuLjA4M2Y0ZDkyYzYg
MTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29uL2dlbl90Y2dfaHZ4LmgKKysrIGIvdGFyZ2V0L2hl
eGFnb24vZ2VuX3RjZ19odnguaApAQCAtMSw1ICsxLDUgQEAKIC8qCi0gKiAgQ29weXJpZ2h0KGMp
IDIwMTktMjAyMSBRdWFsY29tbSBJbm5vdmF0aW9uIENlbnRlciwgSW5jLiBBbGwgUmlnaHRzIFJl
c2VydmVkLgorICogIENvcHlyaWdodChjKSAyMDE5LTIwMjIgUXVhbGNvbW0gSW5ub3ZhdGlvbiBD
ZW50ZXIsIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KICAqCiAgKiAgVGhpcyBwcm9ncmFtIGlz
IGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKICAq
ICBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFz
IHB1Ymxpc2hlZCBieQpAQCAtNjk3LDcgKzY5Nyw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBhc3Nl
cnRfdmhpc3RfdG1wKERpc2FzQ29udGV4dCAqY3R4KQogI2RlZmluZSBmR0VOX1RDR19ORVdWQUxf
VkVDX1NUT1JFKEdFVF9FQSwgSU5DKSBcCiAgICAgZG8geyBcCiAgICAgICAgIEdFVF9FQTsgXAot
ICAgICAgICBnZW5fdnJlZ19zdG9yZShjdHgsIGluc24sIHBrdCwgRUEsIE9zTl9vZmYsIGluc24t
PnNsb3QsIHRydWUpOyBcCisgICAgICAgIGdlbl92cmVnX3N0b3JlKGN0eCwgRUEsIE9zTl9vZmYs
IGluc24tPnNsb3QsIHRydWUpOyBcCiAgICAgICAgIElOQzsgXAogICAgIH0gd2hpbGUgKDApCiAK
QEAgLTczNiw3ICs3MzYsNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgYXNzZXJ0X3ZoaXN0X3RtcChE
aXNhc0NvbnRleHQgKmN0eCkKICAgICAgICAgUFJFRDsgXAogICAgICAgICB0Y2dfZ2VuX2JyY29u
ZGlfdGwoVENHX0NPTkRfRVEsIExTQiwgMCwgZmFsc2VfbGFiZWwpOyBcCiAgICAgICAgIHRjZ190
ZW1wX2ZyZWUoTFNCKTsgXAotICAgICAgICBnZW5fdnJlZ19zdG9yZShjdHgsIGluc24sIHBrdCwg
RUEsIFNSQ09GRiwgaW5zbi0+c2xvdCwgQUxJR04pOyBcCisgICAgICAgIGdlbl92cmVnX3N0b3Jl
KGN0eCwgRUEsIFNSQ09GRiwgaW5zbi0+c2xvdCwgQUxJR04pOyBcCiAgICAgICAgIElOQzsgXAog
ICAgICAgICB0Y2dfZ2VuX2JyKGVuZF9sYWJlbCk7IFwKICAgICAgICAgZ2VuX3NldF9sYWJlbChm
YWxzZV9sYWJlbCk7IFwKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29uL2luc24uaCBiL3Rhcmdl
dC9oZXhhZ29uL2luc24uaAppbmRleCBhYTI2Mzg5MTQ3Li5jYjkyNTg2ODAyIDEwMDY0NAotLS0g
YS90YXJnZXQvaGV4YWdvbi9pbnNuLmgKKysrIGIvdGFyZ2V0L2hleGFnb24vaW5zbi5oCkBAIC0x
LDUgKzEsNSBAQAogLyoKLSAqICBDb3B5cmlnaHQoYykgMjAxOS0yMDIxIFF1YWxjb21tIElubm92
YXRpb24gQ2VudGVyLCBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCisgKiAgQ29weXJpZ2h0KGMp
IDIwMTktMjAyMiBRdWFsY29tbSBJbm5vdmF0aW9uIENlbnRlciwgSW5jLiBBbGwgUmlnaHRzIFJl
c2VydmVkLgogICoKICAqICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiBy
ZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQogICogIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0
aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5CkBAIC0yOCwxMCAr
MjgsNyBAQCBzdHJ1Y3QgSW5zdHJ1Y3Rpb247CiBzdHJ1Y3QgUGFja2V0Owogc3RydWN0IERpc2Fz
Q29udGV4dDsKIAotdHlwZWRlZiB2b2lkICgqU2VtYW50aWNJbnNuKShDUFVIZXhhZ29uU3RhdGUg
KmVudiwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IERpc2FzQ29udGV4dCAq
Y3R4LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgSW5zdHJ1Y3Rpb24gKmlu
c24sCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBQYWNrZXQgKnBrdCk7Cit0
eXBlZGVmIHZvaWQgKCpTZW1hbnRpY0luc24pKHN0cnVjdCBEaXNhc0NvbnRleHQgKmN0eCk7CiAK
IHN0cnVjdCBJbnN0cnVjdGlvbiB7CiAgICAgU2VtYW50aWNJbnNuIGdlbmVyYXRlOyAgICAgICAg
ICAgIC8qIHBvaW50ZXIgdG8gZ2VucHRyIHJvdXRpbmUgKi8KZGlmZiAtLWdpdCBhL3RhcmdldC9o
ZXhhZ29uL21hY3Jvcy5oIGIvdGFyZ2V0L2hleGFnb24vbWFjcm9zLmgKaW5kZXggYzg4MDViZGFl
Yi4uOTNlZTQ3MzlhMSAxMDA2NDQKLS0tIGEvdGFyZ2V0L2hleGFnb24vbWFjcm9zLmgKKysrIGIv
dGFyZ2V0L2hleGFnb24vbWFjcm9zLmgKQEAgLTk0LDkgKzk0LDkgQEAKICAqLwogI2RlZmluZSBD
SEVDS19OT1NIVUYoVkEsIFNJWkUpIFwKICAgICBkbyB7IFwKLSAgICAgICAgaWYgKGluc24tPnNs
b3QgPT0gMCAmJiBwa3QtPnBrdF9oYXNfc3RvcmVfczEpIHsgXAorICAgICAgICBpZiAoaW5zbi0+
c2xvdCA9PSAwICYmIGN0eC0+cGt0LT5wa3RfaGFzX3N0b3JlX3MxKSB7IFwKICAgICAgICAgICAg
IHByb2JlX25vc2h1Zl9sb2FkKFZBLCBTSVpFLCBjdHgtPm1lbV9pZHgpOyBcCi0gICAgICAgICAg
ICBwcm9jZXNzX3N0b3JlKGN0eCwgcGt0LCAxKTsgXAorICAgICAgICAgICAgcHJvY2Vzc19zdG9y
ZShjdHgsIDEpOyBcCiAgICAgICAgIH0gXAogICAgIH0gd2hpbGUgKDApCiAKQEAgLTEwNSwxMiAr
MTA1LDEyIEBACiAgICAgICAgIFRDR0xhYmVsICpsYWJlbCA9IGdlbl9uZXdfbGFiZWwoKTsgXAog
ICAgICAgICB0Y2dfZ2VuX2JyY29uZGlfdGwoVENHX0NPTkRfRVEsIFBSRUQsIDAsIGxhYmVsKTsg
XAogICAgICAgICBHRVRfRUE7IFwKLSAgICAgICAgaWYgKGluc24tPnNsb3QgPT0gMCAmJiBwa3Qt
PnBrdF9oYXNfc3RvcmVfczEpIHsgXAorICAgICAgICBpZiAoaW5zbi0+c2xvdCA9PSAwICYmIGN0
eC0+cGt0LT5wa3RfaGFzX3N0b3JlX3MxKSB7IFwKICAgICAgICAgICAgIHByb2JlX25vc2h1Zl9s
b2FkKEVBLCBTSVpFLCBjdHgtPm1lbV9pZHgpOyBcCiAgICAgICAgIH0gXAogICAgICAgICBnZW5f
c2V0X2xhYmVsKGxhYmVsKTsgXAotICAgICAgICBpZiAoaW5zbi0+c2xvdCA9PSAwICYmIHBrdC0+
cGt0X2hhc19zdG9yZV9zMSkgeyBcCi0gICAgICAgICAgICBwcm9jZXNzX3N0b3JlKGN0eCwgcGt0
LCAxKTsgXAorICAgICAgICBpZiAoaW5zbi0+c2xvdCA9PSAwICYmIGN0eC0+cGt0LT5wa3RfaGFz
X3N0b3JlX3MxKSB7IFwKKyAgICAgICAgICAgIHByb2Nlc3Nfc3RvcmUoY3R4LCAxKTsgXAogICAg
ICAgICB9IFwKICAgICB9IHdoaWxlICgwKQogCmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi9t
bXZlYy9tYWNyb3MuaCBiL3RhcmdldC9oZXhhZ29uL21tdmVjL21hY3Jvcy5oCmluZGV4IDgzNDU3
NTM1ODAuLjhjODY0ZThjNjggMTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29uL21tdmVjL21hY3Jv
cy5oCisrKyBiL3RhcmdldC9oZXhhZ29uL21tdmVjL21hY3Jvcy5oCkBAIC0yODgsNyArMjg4LDcg
QEAKICNlbmRpZgogI2lmZGVmIFFFTVVfR0VORVJBVEUKICNkZWZpbmUgZlNUT1JFTU1WKEVBLCBT
UkMpIFwKLSAgICBnZW5fdnJlZ19zdG9yZShjdHgsIGluc24sIHBrdCwgRUEsIFNSQyMjX29mZiwg
aW5zbi0+c2xvdCwgdHJ1ZSkKKyAgICBnZW5fdnJlZ19zdG9yZShjdHgsIEVBLCBTUkMjI19vZmYs
IGluc24tPnNsb3QsIHRydWUpCiAjZW5kaWYKICNpZmRlZiBRRU1VX0dFTkVSQVRFCiAjZGVmaW5l
IGZTVE9SRU1NVlEoRUEsIFNSQywgTUFTSykgXApAQCAtMzAwLDcgKzMwMCw3IEBACiAjZW5kaWYK
ICNpZmRlZiBRRU1VX0dFTkVSQVRFCiAjZGVmaW5lIGZTVE9SRU1NVlUoRUEsIFNSQykgXAotICAg
IGdlbl92cmVnX3N0b3JlKGN0eCwgaW5zbiwgcGt0LCBFQSwgU1JDIyNfb2ZmLCBpbnNuLT5zbG90
LCBmYWxzZSkKKyAgICBnZW5fdnJlZ19zdG9yZShjdHgsIEVBLCBTUkMjI19vZmYsIGluc24tPnNs
b3QsIGZhbHNlKQogI2VuZGlmCiAjZGVmaW5lIGZWRk9SRUFDSChXSURUSCwgVkFSKSBmb3IgKFZB
UiA9IDA7IFZBUiA8IGZWRUxFTShXSURUSCk7IFZBUisrKQogI2RlZmluZSBmVkFSUkFZX0VMRU1F
TlRfQUNDRVNTKEFSUkFZLCBUWVBFLCBJTkRFWCkgXApkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFn
b24vdHJhbnNsYXRlLmggYi90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuaAppbmRleCBhMjQ1MTcy
ODI3Li4xMTVlMjliODRmIDEwMDY0NAotLS0gYS90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuaAor
KysgYi90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuaApAQCAtMSw1ICsxLDUgQEAKIC8qCi0gKiAg
Q29weXJpZ2h0KGMpIDIwMTktMjAyMSBRdWFsY29tbSBJbm5vdmF0aW9uIENlbnRlciwgSW5jLiBB
bGwgUmlnaHRzIFJlc2VydmVkLgorICogIENvcHlyaWdodChjKSAyMDE5LTIwMjIgUXVhbGNvbW0g
SW5ub3ZhdGlvbiBDZW50ZXIsIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KICAqCiAgKiAgVGhp
cyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9v
ciBtb2RpZnkKICAqICBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1Ymxp
YyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQpAQCAtMjMsMTAgKzIzLDEzIEBACiAjaW5jbHVkZSAi
Y3B1LmgiCiAjaW5jbHVkZSAiZXhlYy90cmFuc2xhdG9yLmgiCiAjaW5jbHVkZSAidGNnL3RjZy1v
cC5oIgorI2luY2x1ZGUgImluc24uaCIKICNpbmNsdWRlICJpbnRlcm5hbC5oIgogCiB0eXBlZGVm
IHN0cnVjdCBEaXNhc0NvbnRleHQgewogICAgIERpc2FzQ29udGV4dEJhc2UgYmFzZTsKKyAgICBQ
YWNrZXQgKnBrdDsKKyAgICBJbnNuICppbnNuOwogICAgIHVpbnQzMl90IG1lbV9pZHg7CiAgICAg
dWludDMyX3QgbnVtX3BhY2tldHM7CiAgICAgdWludDMyX3QgbnVtX2luc25zOwpAQCAtMTQ3LDYg
KzE1MCw2IEBAIGV4dGVybiBUQ0d2IGhleF92c3RvcmVfYWRkcltWU1RPUkVTX01BWF07CiBleHRl
cm4gVENHdiBoZXhfdnN0b3JlX3NpemVbVlNUT1JFU19NQVhdOwogZXh0ZXJuIFRDR3YgaGV4X3Zz
dG9yZV9wZW5kaW5nW1ZTVE9SRVNfTUFYXTsKIAotYm9vbCBpc19nYXRoZXJfc3RvcmVfaW5zbihJ
bnNuICppbnNuLCBQYWNrZXQgKnBrdCk7Ci12b2lkIHByb2Nlc3Nfc3RvcmUoRGlzYXNDb250ZXh0
ICpjdHgsIFBhY2tldCAqcGt0LCBpbnQgc2xvdF9udW0pOworYm9vbCBpc19nYXRoZXJfc3RvcmVf
aW5zbihEaXNhc0NvbnRleHQgKmN0eCk7Cit2b2lkIHByb2Nlc3Nfc3RvcmUoRGlzYXNDb250ZXh0
ICpjdHgsIGludCBzbG90X251bSk7CiAjZW5kaWYKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29u
L2dlbnB0ci5jIGIvdGFyZ2V0L2hleGFnb24vZ2VucHRyLmMKaW5kZXggODA2ZDA5NzRmZi4uODU0
MTZkZDUzMCAxMDA2NDQKLS0tIGEvdGFyZ2V0L2hleGFnb24vZ2VucHRyLmMKKysrIGIvdGFyZ2V0
L2hleGFnb24vZ2VucHRyLmMKQEAgLTU1MSwxMyArNTUxLDEzIEBAIHN0YXRpYyB2b2lkIGdlbl92
cmVnX2xvYWQoRGlzYXNDb250ZXh0ICpjdHgsIGludHB0cl90IGRzdG9mZiwgVENHdiBzcmMsCiAg
ICAgdGNnX3RlbXBfZnJlZV9pNjQodG1wKTsKIH0KIAotc3RhdGljIHZvaWQgZ2VuX3ZyZWdfc3Rv
cmUoRGlzYXNDb250ZXh0ICpjdHgsIEluc24gKmluc24sIFBhY2tldCAqcGt0LAotICAgICAgICAg
ICAgICAgICAgICAgICAgICAgVENHdiBFQSwgaW50cHRyX3Qgc3Jjb2ZmLCBpbnQgc2xvdCwgYm9v
bCBhbGlnbmVkKQorc3RhdGljIHZvaWQgZ2VuX3ZyZWdfc3RvcmUoRGlzYXNDb250ZXh0ICpjdHgs
IFRDR3YgRUEsIGludHB0cl90IHNyY29mZiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgIGlu
dCBzbG90LCBib29sIGFsaWduZWQpCiB7CiAgICAgaW50cHRyX3QgZHN0b2ZmID0gb2Zmc2V0b2Yo
Q1BVSGV4YWdvblN0YXRlLCB2c3RvcmVbc2xvdF0uZGF0YSk7CiAgICAgaW50cHRyX3QgbWFza29m
ZiA9IG9mZnNldG9mKENQVUhleGFnb25TdGF0ZSwgdnN0b3JlW3Nsb3RdLm1hc2spOwogCi0gICAg
aWYgKGlzX2dhdGhlcl9zdG9yZV9pbnNuKGluc24sIHBrdCkpIHsKKyAgICBpZiAoaXNfZ2F0aGVy
X3N0b3JlX2luc24oY3R4KSkgewogICAgICAgICBUQ0d2IHNsID0gdGNnX2NvbnN0YW50X3RsKHNs
b3QpOwogICAgICAgICBnZW5faGVscGVyX2dhdGhlcl9zdG9yZShjcHVfZW52LCBFQSwgc2wpOwog
ICAgICAgICByZXR1cm47CmRpZmYgLS1naXQgYS90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuYyBi
L3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5jCmluZGV4IDIzMjkxNzc1MzcuLjA5NDBkMGYyYzEg
MTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5jCisrKyBiL3RhcmdldC9oZXhh
Z29uL3RyYW5zbGF0ZS5jCkBAIC0yMDksOCArMjA5LDkgQEAgc3RhdGljIGJvb2wgbmVlZF9wcmVk
X3dyaXR0ZW4oUGFja2V0ICpwa3QpCiAgICAgcmV0dXJuIGNoZWNrX2Zvcl9hdHRyaWIocGt0LCBB
X1dSSVRFU19QUkVEX1JFRyk7CiB9CiAKLXN0YXRpYyB2b2lkIGdlbl9zdGFydF9wYWNrZXQoRGlz
YXNDb250ZXh0ICpjdHgsIFBhY2tldCAqcGt0KQorc3RhdGljIHZvaWQgZ2VuX3N0YXJ0X3BhY2tl
dChEaXNhc0NvbnRleHQgKmN0eCkKIHsKKyAgICBQYWNrZXQgKnBrdCA9IGN0eC0+cGt0OwogICAg
IHRhcmdldF91bG9uZyBuZXh0X1BDID0gY3R4LT5iYXNlLnBjX25leHQgKyBwa3QtPmVuY29kX3Br
dF9zaXplX2luX2J5dGVzOwogICAgIGludCBpOwogCkBAIC0yNjAsOCArMjYxLDEwIEBAIHN0YXRp
YyB2b2lkIGdlbl9zdGFydF9wYWNrZXQoRGlzYXNDb250ZXh0ICpjdHgsIFBhY2tldCAqcGt0KQog
ICAgIH0KIH0KIAotYm9vbCBpc19nYXRoZXJfc3RvcmVfaW5zbihJbnNuICppbnNuLCBQYWNrZXQg
KnBrdCkKK2Jvb2wgaXNfZ2F0aGVyX3N0b3JlX2luc24oRGlzYXNDb250ZXh0ICpjdHgpCiB7Cisg
ICAgUGFja2V0ICpwa3QgPSBjdHgtPnBrdDsKKyAgICBJbnNuICppbnNuID0gY3R4LT5pbnNuOwog
ICAgIGlmIChHRVRfQVRUUklCKGluc24tPm9wY29kZSwgQV9DVklfTkVXKSAmJgogICAgICAgICBp
bnNuLT5uZXdfdmFsdWVfcHJvZHVjZXJfc2xvdCA9PSAxKSB7CiAgICAgICAgIC8qIExvb2sgZm9y
IGdhdGhlciBpbnN0cnVjdGlvbiAqLwpAQCAtMjgwLDE1ICsyODMsMTUgQEAgYm9vbCBpc19nYXRo
ZXJfc3RvcmVfaW5zbihJbnNuICppbnNuLCBQYWNrZXQgKnBrdCkKICAqIEhvd2V2ZXIsIHRoZXJl
IGFyZSBzb21lIGltcGxpY2l0IHdyaXRlcyBtYXJrZWQgYXMgYXR0cmlidXRlcwogICogb2YgdGhl
IGFwcGxpY2FibGUgaW5zdHJ1Y3Rpb25zLgogICovCi1zdGF0aWMgdm9pZCBtYXJrX2ltcGxpY2l0
X3JlZ193cml0ZShEaXNhc0NvbnRleHQgKmN0eCwgSW5zbiAqaW5zbiwKLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGludCBhdHRyaWIsIGludCBybnVtKQorc3RhdGljIHZvaWQg
bWFya19pbXBsaWNpdF9yZWdfd3JpdGUoRGlzYXNDb250ZXh0ICpjdHgsIGludCBhdHRyaWIsIGlu
dCBybnVtKQogewotICAgIGlmIChHRVRfQVRUUklCKGluc24tPm9wY29kZSwgYXR0cmliKSkgewor
ICAgIHVpbnQxNl90IG9wY29kZSA9IGN0eC0+aW5zbi0+b3Bjb2RlOworICAgIGlmIChHRVRfQVRU
UklCKG9wY29kZSwgYXR0cmliKSkgewogICAgICAgICAvKgogICAgICAgICAgKiBVU1IgaXMgdXNl
ZCB0byBzZXQgb3ZlcmZsb3cgYW5kIEZQIGV4Y2VwdGlvbnMsCiAgICAgICAgICAqIHNvIHRyZWF0
IGl0IGFzIGNvbmRpdGlvbmFsCiAgICAgICAgICAqLwotICAgICAgICBib29sIGlzX3ByZWRpY2F0
ZWQgPSBHRVRfQVRUUklCKGluc24tPm9wY29kZSwgQV9DT05ERVhFQykgfHwKKyAgICAgICAgYm9v
bCBpc19wcmVkaWNhdGVkID0gR0VUX0FUVFJJQihvcGNvZGUsIEFfQ09OREVYRUMpIHx8CiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHJudW0gPT0gSEVYX1JFR19VU1I7CiAgICAgICAgIGlm
IChpc19wcmVkaWNhdGVkICYmICFpc19wcmVsb2FkZWQoY3R4LCBybnVtKSkgewogICAgICAgICAg
ICAgdGNnX2dlbl9tb3ZfdGwoaGV4X25ld192YWx1ZVtybnVtXSwgaGV4X2dwcltybnVtXSk7CkBA
IC0yOTgsMzkgKzMwMSwzOCBAQCBzdGF0aWMgdm9pZCBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShE
aXNhc0NvbnRleHQgKmN0eCwgSW5zbiAqaW5zbiwKICAgICB9CiB9CiAKLXN0YXRpYyB2b2lkIG1h
cmtfaW1wbGljaXRfcHJlZF93cml0ZShEaXNhc0NvbnRleHQgKmN0eCwgSW5zbiAqaW5zbiwKLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgYXR0cmliLCBpbnQgcG51bSkK
K3N0YXRpYyB2b2lkIG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZShEaXNhc0NvbnRleHQgKmN0eCwg
aW50IGF0dHJpYiwgaW50IHBudW0pCiB7Ci0gICAgaWYgKEdFVF9BVFRSSUIoaW5zbi0+b3Bjb2Rl
LCBhdHRyaWIpKSB7CisgICAgaWYgKEdFVF9BVFRSSUIoY3R4LT5pbnNuLT5vcGNvZGUsIGF0dHJp
YikpIHsKICAgICAgICAgY3R4X2xvZ19wcmVkX3dyaXRlKGN0eCwgcG51bSk7CiAgICAgfQogfQog
Ci1zdGF0aWMgdm9pZCBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZXMoRGlzYXNDb250ZXh0ICpjdHgs
IEluc24gKmluc24pCitzdGF0aWMgdm9pZCBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZXMoRGlzYXND
b250ZXh0ICpjdHgpCiB7Ci0gICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBpbnNuLCBB
X0lNUExJQ0lUX1dSSVRFU19GUCwgIEhFWF9SRUdfRlApOwotICAgIG1hcmtfaW1wbGljaXRfcmVn
X3dyaXRlKGN0eCwgaW5zbiwgQV9JTVBMSUNJVF9XUklURVNfU1AsICBIRVhfUkVHX1NQKTsKLSAg
ICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIGluc24sIEFfSU1QTElDSVRfV1JJVEVTX0xS
LCAgSEVYX1JFR19MUik7Ci0gICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBpbnNuLCBB
X0lNUExJQ0lUX1dSSVRFU19MQzAsIEhFWF9SRUdfTEMwKTsKLSAgICBtYXJrX2ltcGxpY2l0X3Jl
Z193cml0ZShjdHgsIGluc24sIEFfSU1QTElDSVRfV1JJVEVTX1NBMCwgSEVYX1JFR19TQTApOwot
ICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgaW5zbiwgQV9JTVBMSUNJVF9XUklURVNf
TEMxLCBIRVhfUkVHX0xDMSk7Ci0gICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBpbnNu
LCBBX0lNUExJQ0lUX1dSSVRFU19TQTEsIEhFWF9SRUdfU0ExKTsKLSAgICBtYXJrX2ltcGxpY2l0
X3JlZ193cml0ZShjdHgsIGluc24sIEFfSU1QTElDSVRfV1JJVEVTX1VTUiwgSEVYX1JFR19VU1Ip
OwotICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgaW5zbiwgQV9GUE9QLCBIRVhfUkVH
X1VTUik7CisgICAgbWFya19pbXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRF
U19GUCwgIEhFWF9SRUdfRlApOworICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9J
TVBMSUNJVF9XUklURVNfU1AsICBIRVhfUkVHX1NQKTsKKyAgICBtYXJrX2ltcGxpY2l0X3JlZ193
cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX0xSLCAgSEVYX1JFR19MUik7CisgICAgbWFya19p
bXBsaWNpdF9yZWdfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19MQzAsIEhFWF9SRUdfTEMw
KTsKKyAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX1NB
MCwgSEVYX1JFR19TQTApOworICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9JTVBM
SUNJVF9XUklURVNfTEMxLCBIRVhfUkVHX0xDMSk7CisgICAgbWFya19pbXBsaWNpdF9yZWdfd3Jp
dGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRFU19TQTEsIEhFWF9SRUdfU0ExKTsKKyAgICBtYXJrX2lt
cGxpY2l0X3JlZ193cml0ZShjdHgsIEFfSU1QTElDSVRfV1JJVEVTX1VTUiwgSEVYX1JFR19VU1Ip
OworICAgIG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlKGN0eCwgQV9GUE9QLCBIRVhfUkVHX1VTUik7
CiB9CiAKLXN0YXRpYyB2b2lkIG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZXMoRGlzYXNDb250ZXh0
ICpjdHgsIEluc24gKmluc24pCitzdGF0aWMgdm9pZCBtYXJrX2ltcGxpY2l0X3ByZWRfd3JpdGVz
KERpc2FzQ29udGV4dCAqY3R4KQogewotICAgIG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZShjdHgs
IGluc24sIEFfSU1QTElDSVRfV1JJVEVTX1AwLCAwKTsKLSAgICBtYXJrX2ltcGxpY2l0X3ByZWRf
d3JpdGUoY3R4LCBpbnNuLCBBX0lNUExJQ0lUX1dSSVRFU19QMSwgMSk7Ci0gICAgbWFya19pbXBs
aWNpdF9wcmVkX3dyaXRlKGN0eCwgaW5zbiwgQV9JTVBMSUNJVF9XUklURVNfUDIsIDIpOwotICAg
IG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZShjdHgsIGluc24sIEFfSU1QTElDSVRfV1JJVEVTX1Az
LCAzKTsKKyAgICBtYXJrX2ltcGxpY2l0X3ByZWRfd3JpdGUoY3R4LCBBX0lNUExJQ0lUX1dSSVRF
U19QMCwgMCk7CisgICAgbWFya19pbXBsaWNpdF9wcmVkX3dyaXRlKGN0eCwgQV9JTVBMSUNJVF9X
UklURVNfUDEsIDEpOworICAgIG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZShjdHgsIEFfSU1QTElD
SVRfV1JJVEVTX1AyLCAyKTsKKyAgICBtYXJrX2ltcGxpY2l0X3ByZWRfd3JpdGUoY3R4LCBBX0lN
UExJQ0lUX1dSSVRFU19QMywgMyk7CiB9CiAKLXN0YXRpYyB2b2lkIG1hcmtfc3RvcmVfd2lkdGgo
RGlzYXNDb250ZXh0ICpjdHgsIEluc24gKmluc24pCitzdGF0aWMgdm9pZCBtYXJrX3N0b3JlX3dp
ZHRoKERpc2FzQ29udGV4dCAqY3R4KQogewotICAgIHVpbnQxNl90IG9wY29kZSA9IGluc24tPm9w
Y29kZTsKLSAgICB1aW50MzJfdCBzbG90ID0gaW5zbi0+c2xvdDsKKyAgICB1aW50MTZfdCBvcGNv
ZGUgPSBjdHgtPmluc24tPm9wY29kZTsKKyAgICB1aW50MzJfdCBzbG90ID0gY3R4LT5pbnNuLT5z
bG90OwogICAgIHVpbnQ4X3Qgd2lkdGggPSAwOwogCiAgICAgaWYgKEdFVF9BVFRSSUIob3Bjb2Rl
LCBBX1NDQUxBUl9TVE9SRSkpIHsKQEAgLTM1MSwxNCArMzUzLDEzIEBAIHN0YXRpYyB2b2lkIG1h
cmtfc3RvcmVfd2lkdGgoRGlzYXNDb250ZXh0ICpjdHgsIEluc24gKmluc24pCiAgICAgfQogfQog
Ci1zdGF0aWMgdm9pZCBnZW5faW5zbihDUFVIZXhhZ29uU3RhdGUgKmVudiwgRGlzYXNDb250ZXh0
ICpjdHgsCi0gICAgICAgICAgICAgICAgICAgICBJbnNuICppbnNuLCBQYWNrZXQgKnBrdCkKK3N0
YXRpYyB2b2lkIGdlbl9pbnNuKERpc2FzQ29udGV4dCAqY3R4KQogewotICAgIGlmIChpbnNuLT5n
ZW5lcmF0ZSkgewotICAgICAgICBtYXJrX2ltcGxpY2l0X3JlZ193cml0ZXMoY3R4LCBpbnNuKTsK
LSAgICAgICAgaW5zbi0+Z2VuZXJhdGUoZW52LCBjdHgsIGluc24sIHBrdCk7Ci0gICAgICAgIG1h
cmtfaW1wbGljaXRfcHJlZF93cml0ZXMoY3R4LCBpbnNuKTsKLSAgICAgICAgbWFya19zdG9yZV93
aWR0aChjdHgsIGluc24pOworICAgIGlmIChjdHgtPmluc24tPmdlbmVyYXRlKSB7CisgICAgICAg
IG1hcmtfaW1wbGljaXRfcmVnX3dyaXRlcyhjdHgpOworICAgICAgICBjdHgtPmluc24tPmdlbmVy
YXRlKGN0eCk7CisgICAgICAgIG1hcmtfaW1wbGljaXRfcHJlZF93cml0ZXMoY3R4KTsKKyAgICAg
ICAgbWFya19zdG9yZV93aWR0aChjdHgpOwogICAgIH0gZWxzZSB7CiAgICAgICAgIGdlbl9leGNl
cHRpb25fZW5kX3RiKGN0eCwgSEVYX0VYQ1BfSU5WQUxJRF9PUENPREUpOwogICAgIH0KQEAgLTM3
OCw3ICszNzksNyBAQCBzdGF0aWMgdm9pZCBnZW5fcmVnX3dyaXRlcyhEaXNhc0NvbnRleHQgKmN0
eCkKICAgICB9CiB9CiAKLXN0YXRpYyB2b2lkIGdlbl9wcmVkX3dyaXRlcyhEaXNhc0NvbnRleHQg
KmN0eCwgUGFja2V0ICpwa3QpCitzdGF0aWMgdm9pZCBnZW5fcHJlZF93cml0ZXMoRGlzYXNDb250
ZXh0ICpjdHgpCiB7CiAgICAgaW50IGk7CiAKQEAgLTM5Myw3ICszOTQsNyBAQCBzdGF0aWMgdm9p
ZCBnZW5fcHJlZF93cml0ZXMoRGlzYXNDb250ZXh0ICpjdHgsIFBhY2tldCAqcGt0KQogICAgICAq
IGluc3RydWN0aW9ucywgd2UgY2FuIHVzZSB0aGUgbm9uLWNvbmRpdGlvbmFsCiAgICAgICogd3Jp
dGUgb2YgdGhlIHByZWRpY2F0ZXMuCiAgICAgICovCi0gICAgaWYgKHBrdC0+cGt0X2hhc19lbmRs
b29wKSB7CisgICAgaWYgKGN0eC0+cGt0LT5wa3RfaGFzX2VuZGxvb3ApIHsKICAgICAgICAgVENH
diB6ZXJvID0gdGNnX2NvbnN0YW50X3RsKDApOwogICAgICAgICBUQ0d2IHByZWRfd3JpdHRlbiA9
IHRjZ190ZW1wX25ldygpOwogICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY3R4LT5wcmVnX2xvZ19p
ZHg7IGkrKykgewpAQCAtNDM5LDkgKzQ0MCw5IEBAIHN0YXRpYyBib29sIHNsb3RfaXNfcHJlZGlj
YXRlZChQYWNrZXQgKnBrdCwgaW50IHNsb3RfbnVtKQogICAgIGdfYXNzZXJ0X25vdF9yZWFjaGVk
KCk7CiB9CiAKLXZvaWQgcHJvY2Vzc19zdG9yZShEaXNhc0NvbnRleHQgKmN0eCwgUGFja2V0ICpw
a3QsIGludCBzbG90X251bSkKK3ZvaWQgcHJvY2Vzc19zdG9yZShEaXNhc0NvbnRleHQgKmN0eCwg
aW50IHNsb3RfbnVtKQogewotICAgIGJvb2wgaXNfcHJlZGljYXRlZCA9IHNsb3RfaXNfcHJlZGlj
YXRlZChwa3QsIHNsb3RfbnVtKTsKKyAgICBib29sIGlzX3ByZWRpY2F0ZWQgPSBzbG90X2lzX3By
ZWRpY2F0ZWQoY3R4LT5wa3QsIHNsb3RfbnVtKTsKICAgICBUQ0dMYWJlbCAqbGFiZWxfZW5kID0g
TlVMTDsKIAogICAgIC8qCkBAIC01MTcsMjcgKzUxOCwyOCBAQCB2b2lkIHByb2Nlc3Nfc3RvcmUo
RGlzYXNDb250ZXh0ICpjdHgsIFBhY2tldCAqcGt0LCBpbnQgc2xvdF9udW0pCiAgICAgfQogfQog
Ci1zdGF0aWMgdm9pZCBwcm9jZXNzX3N0b3JlX2xvZyhEaXNhc0NvbnRleHQgKmN0eCwgUGFja2V0
ICpwa3QpCitzdGF0aWMgdm9pZCBwcm9jZXNzX3N0b3JlX2xvZyhEaXNhc0NvbnRleHQgKmN0eCkK
IHsKICAgICAvKgogICAgICAqICBXaGVuIGEgcGFja2V0IGhhcyB0d28gc3RvcmVzLCB0aGUgaGFy
ZHdhcmUgcHJvY2Vzc2VzCiAgICAgICogIHNsb3QgMSBhbmQgdGhlbiBzbG90IDAuICBUaGlzIHdp
bGwgYmUgaW1wb3J0YW50IHdoZW4KICAgICAgKiAgdGhlIG1lbW9yeSBhY2Nlc3NlcyBvdmVybGFw
LgogICAgICAqLworICAgIFBhY2tldCAqcGt0ID0gY3R4LT5wa3Q7CiAgICAgaWYgKHBrdC0+cGt0
X2hhc19zdG9yZV9zMSkgewogICAgICAgICBnX2Fzc2VydCghcGt0LT5wa3RfaGFzX2RjemVyb2Ep
OwotICAgICAgICBwcm9jZXNzX3N0b3JlKGN0eCwgcGt0LCAxKTsKKyAgICAgICAgcHJvY2Vzc19z
dG9yZShjdHgsIDEpOwogICAgIH0KICAgICBpZiAocGt0LT5wa3RfaGFzX3N0b3JlX3MwKSB7CiAg
ICAgICAgIGdfYXNzZXJ0KCFwa3QtPnBrdF9oYXNfZGN6ZXJvYSk7Ci0gICAgICAgIHByb2Nlc3Nf
c3RvcmUoY3R4LCBwa3QsIDApOworICAgICAgICBwcm9jZXNzX3N0b3JlKGN0eCwgMCk7CiAgICAg
fQogfQogCiAvKiBaZXJvIG91dCBhIDMyLWJpdCBjYWNoZSBsaW5lICovCi1zdGF0aWMgdm9pZCBw
cm9jZXNzX2RjemVyb2EoRGlzYXNDb250ZXh0ICpjdHgsIFBhY2tldCAqcGt0KQorc3RhdGljIHZv
aWQgcHJvY2Vzc19kY3plcm9hKERpc2FzQ29udGV4dCAqY3R4KQogewotICAgIGlmIChwa3QtPnBr
dF9oYXNfZGN6ZXJvYSkgeworICAgIGlmIChjdHgtPnBrdC0+cGt0X2hhc19kY3plcm9hKSB7CiAg
ICAgICAgIC8qIFN0b3JlIDMyIGJ5dGVzIG9mIHplcm8gc3RhcnRpbmcgYXQgKGFkZHIgJiB+MHgx
ZikgKi8KICAgICAgICAgVENHdiBhZGRyID0gdGNnX3RlbXBfbmV3KCk7CiAgICAgICAgIFRDR3Zf
aTY0IHplcm8gPSB0Y2dfY29uc3RhbnRfaTY0KDApOwpAQCAtNTY3LDcgKzU2OSw3IEBAIHN0YXRp
YyBib29sIHBrdF9oYXNfaHZ4X3N0b3JlKFBhY2tldCAqcGt0KQogICAgIHJldHVybiBmYWxzZTsK
IH0KIAotc3RhdGljIHZvaWQgZ2VuX2NvbW1pdF9odngoRGlzYXNDb250ZXh0ICpjdHgsIFBhY2tl
dCAqcGt0KQorc3RhdGljIHZvaWQgZ2VuX2NvbW1pdF9odngoRGlzYXNDb250ZXh0ICpjdHgpCiB7
CiAgICAgaW50IGk7CiAKQEAgLTYzNywxMyArNjM5LDE0IEBAIHN0YXRpYyB2b2lkIGdlbl9jb21t
aXRfaHZ4KERpc2FzQ29udGV4dCAqY3R4LCBQYWNrZXQgKnBrdCkKICAgICAgICAgfQogICAgIH0K
IAotICAgIGlmIChwa3RfaGFzX2h2eF9zdG9yZShwa3QpKSB7CisgICAgaWYgKHBrdF9oYXNfaHZ4
X3N0b3JlKGN0eC0+cGt0KSkgewogICAgICAgICBnZW5faGVscGVyX2NvbW1pdF9odnhfc3RvcmVz
KGNwdV9lbnYpOwogICAgIH0KIH0KIAotc3RhdGljIHZvaWQgdXBkYXRlX2V4ZWNfY291bnRlcnMo
RGlzYXNDb250ZXh0ICpjdHgsIFBhY2tldCAqcGt0KQorc3RhdGljIHZvaWQgdXBkYXRlX2V4ZWNf
Y291bnRlcnMoRGlzYXNDb250ZXh0ICpjdHgpCiB7CisgICAgUGFja2V0ICpwa3QgPSBjdHgtPnBr
dDsKICAgICBpbnQgbnVtX2luc25zID0gcGt0LT5udW1faW5zbnM7CiAgICAgaW50IG51bV9yZWFs
X2luc25zID0gMDsKICAgICBpbnQgbnVtX2h2eF9pbnNucyA9IDA7CkBAIC02NjQsOCArNjY3LDcg
QEAgc3RhdGljIHZvaWQgdXBkYXRlX2V4ZWNfY291bnRlcnMoRGlzYXNDb250ZXh0ICpjdHgsIFBh
Y2tldCAqcGt0KQogICAgIGN0eC0+bnVtX2h2eF9pbnNucyArPSBudW1faHZ4X2luc25zOwogfQog
Ci1zdGF0aWMgdm9pZCBnZW5fY29tbWl0X3BhY2tldChDUFVIZXhhZ29uU3RhdGUgKmVudiwgRGlz
YXNDb250ZXh0ICpjdHgsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYWNrZXQgKnBr
dCkKK3N0YXRpYyB2b2lkIGdlbl9jb21taXRfcGFja2V0KERpc2FzQ29udGV4dCAqY3R4KQogewog
ICAgIC8qCiAgICAgICogSWYgdGhlcmUgaXMgbW9yZSB0aGFuIG9uZSBzdG9yZSBpbiBhIHBhY2tl
dCwgbWFrZSBzdXJlIHRoZXkgYXJlIGFsbCBPSwpAQCAtNjg0LDYgKzY4Niw3IEBAIHN0YXRpYyB2
b2lkIGdlbl9jb21taXRfcGFja2V0KENQVUhleGFnb25TdGF0ZSAqZW52LCBEaXNhc0NvbnRleHQg
KmN0eCwKICAgICAgKiBzdG9yZS4gIFRoZXJlZm9yZSwgd2UgY2FsbCBwcm9jZXNzX3N0b3JlX2xv
ZyBiZWZvcmUgYW55dGhpbmcgZWxzZQogICAgICAqIGludm9sdmVkIGluIGNvbW1pdHRpbmcgdGhl
IHBhY2tldC4KICAgICAgKi8KKyAgICBQYWNrZXQgKnBrdCA9IGN0eC0+cGt0OwogICAgIGJvb2wg
aGFzX3N0b3JlX3MwID0gcGt0LT5wa3RfaGFzX3N0b3JlX3MwOwogICAgIGJvb2wgaGFzX3N0b3Jl
X3MxID0gKHBrdC0+cGt0X2hhc19zdG9yZV9zMSAmJiAhY3R4LT5zMV9zdG9yZV9wcm9jZXNzZWQp
OwogICAgIGJvb2wgaGFzX2h2eF9zdG9yZSA9IHBrdF9oYXNfaHZ4X3N0b3JlKHBrdCk7CkBAIC02
OTMsNyArNjk2LDcgQEAgc3RhdGljIHZvaWQgZ2VuX2NvbW1pdF9wYWNrZXQoQ1BVSGV4YWdvblN0
YXRlICplbnYsIERpc2FzQ29udGV4dCAqY3R4LAogICAgICAgICAgKiBhIHN0b3JlIGluIHNsb3Qg
MSBvciBhbiBIVlggc3RvcmUuCiAgICAgICAgICAqLwogICAgICAgICBnX2Fzc2VydCghaGFzX3N0
b3JlX3MxICYmICFoYXNfaHZ4X3N0b3JlKTsKLSAgICAgICAgcHJvY2Vzc19kY3plcm9hKGN0eCwg
cGt0KTsKKyAgICAgICAgcHJvY2Vzc19kY3plcm9hKGN0eCk7CiAgICAgfSBlbHNlIGlmIChoYXNf
aHZ4X3N0b3JlKSB7CiAgICAgICAgIFRDR3YgbWVtX2lkeCA9IHRjZ19jb25zdGFudF90bChjdHgt
Pm1lbV9pZHgpOwogCkBAIC03MjQsMTQgKzcyNywxNCBAQCBzdGF0aWMgdm9pZCBnZW5fY29tbWl0
X3BhY2tldChDUFVIZXhhZ29uU3RhdGUgKmVudiwgRGlzYXNDb250ZXh0ICpjdHgsCiAgICAgICAg
IGdlbl9oZWxwZXJfcHJvYmVfcGt0X3NjYWxhcl9zdG9yZV9zMChjcHVfZW52LCBtZW1faWR4KTsK
ICAgICB9CiAKLSAgICBwcm9jZXNzX3N0b3JlX2xvZyhjdHgsIHBrdCk7CisgICAgcHJvY2Vzc19z
dG9yZV9sb2coY3R4KTsKIAogICAgIGdlbl9yZWdfd3JpdGVzKGN0eCk7Ci0gICAgZ2VuX3ByZWRf
d3JpdGVzKGN0eCwgcGt0KTsKKyAgICBnZW5fcHJlZF93cml0ZXMoY3R4KTsKICAgICBpZiAocGt0
LT5wa3RfaGFzX2h2eCkgewotICAgICAgICBnZW5fY29tbWl0X2h2eChjdHgsIHBrdCk7CisgICAg
ICAgIGdlbl9jb21taXRfaHZ4KGN0eCk7CiAgICAgfQotICAgIHVwZGF0ZV9leGVjX2NvdW50ZXJz
KGN0eCwgcGt0KTsKKyAgICB1cGRhdGVfZXhlY19jb3VudGVycyhjdHgpOwogICAgIGlmIChIRVhf
REVCVUcpIHsKICAgICAgICAgVENHdiBoYXNfc3QwID0KICAgICAgICAgICAgIHRjZ19jb25zdGFu
dF90bChwa3QtPnBrdF9oYXNfc3RvcmVfczAgJiYgIXBrdC0+cGt0X2hhc19kY3plcm9hKTsKQEAg
LTc0NCw3ICs3NDcsOCBAQCBzdGF0aWMgdm9pZCBnZW5fY29tbWl0X3BhY2tldChDUFVIZXhhZ29u
U3RhdGUgKmVudiwgRGlzYXNDb250ZXh0ICpjdHgsCiAKICAgICBpZiAocGt0LT52aGlzdF9pbnNu
ICE9IE5VTEwpIHsKICAgICAgICAgY3R4LT5wcmVfY29tbWl0ID0gZmFsc2U7Ci0gICAgICAgIHBr
dC0+dmhpc3RfaW5zbi0+Z2VuZXJhdGUoZW52LCBjdHgsIHBrdC0+dmhpc3RfaW5zbiwgcGt0KTsK
KyAgICAgICAgY3R4LT5pbnNuID0gcGt0LT52aGlzdF9pbnNuOworICAgICAgICBwa3QtPnZoaXN0
X2luc24tPmdlbmVyYXRlKGN0eCk7CiAgICAgfQogCiAgICAgaWYgKHBrdC0+cGt0X2hhc19jb2Yp
IHsKQEAgLTc2NywxMSArNzcxLDEzIEBAIHN0YXRpYyB2b2lkIGRlY29kZV9hbmRfdHJhbnNsYXRl
X3BhY2tldChDUFVIZXhhZ29uU3RhdGUgKmVudiwgRGlzYXNDb250ZXh0ICpjdHgpCiAKICAgICBp
ZiAoZGVjb2RlX3BhY2tldChud29yZHMsIHdvcmRzLCAmcGt0LCBmYWxzZSkgPiAwKSB7CiAgICAg
ICAgIEhFWF9ERUJVR19QUklOVF9QS1QoJnBrdCk7Ci0gICAgICAgIGdlbl9zdGFydF9wYWNrZXQo
Y3R4LCAmcGt0KTsKKyAgICAgICAgY3R4LT5wa3QgPSAmcGt0OworICAgICAgICBnZW5fc3RhcnRf
cGFja2V0KGN0eCk7CiAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBwa3QubnVtX2luc25zOyBpKysp
IHsKLSAgICAgICAgICAgIGdlbl9pbnNuKGVudiwgY3R4LCAmcGt0Lmluc25baV0sICZwa3QpOwor
ICAgICAgICAgICAgY3R4LT5pbnNuID0gJnBrdC5pbnNuW2ldOworICAgICAgICAgICAgZ2VuX2lu
c24oY3R4KTsKICAgICAgICAgfQotICAgICAgICBnZW5fY29tbWl0X3BhY2tldChlbnYsIGN0eCwg
JnBrdCk7CisgICAgICAgIGdlbl9jb21taXRfcGFja2V0KGN0eCk7CiAgICAgICAgIGN0eC0+YmFz
ZS5wY19uZXh0ICs9IHBrdC5lbmNvZF9wa3Rfc2l6ZV9pbl9ieXRlczsKICAgICB9IGVsc2Ugewog
ICAgICAgICBnZW5fZXhjZXB0aW9uX2VuZF90YihjdHgsIEhFWF9FWENQX0lOVkFMSURfUEFDS0VU
KTsKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29uL2dlbl90Y2dfZnVuY3MucHkgYi90YXJnZXQv
aGV4YWdvbi9nZW5fdGNnX2Z1bmNzLnB5CmluZGV4IDZkZWEwMmIwYjkuLjAyYTY1NjU2ODUgMTAw
NzU1Ci0tLSBhL3RhcmdldC9oZXhhZ29uL2dlbl90Y2dfZnVuY3MucHkKKysrIGIvdGFyZ2V0L2hl
eGFnb24vZ2VuX3RjZ19mdW5jcy5weQpAQCAtNTYxLDExICs1NjEsNyBAQCBkZWYgZ2VucHRyX2Rz
dF93cml0ZV9vcG4oZixyZWd0eXBlLCByZWdpZCwgdGFnKToKICMjIEdlbmVyYXRlIHRoZSBUQ0cg
Y29kZSB0byBjYWxsIHRoZSBoZWxwZXIKICMjICAgICBGb3IgQTJfYWRkOiBSZDMyPWFkZChSczMy
LFJ0MzIpLCB7IFJkVj1Sc1YrUnRWO30KICMjICAgICBXZSBwcm9kdWNlOgotIyMgICAgc3RhdGlj
IHZvaWQgZ2VuZXJhdGVfQTJfYWRkKCkKLSMjICAgICAgICAgICAgICAgICAgICBDUFVIZXhhZ29u
U3RhdGUgKmVudgotIyMgICAgICAgICAgICAgICAgICAgIERpc2FzQ29udGV4dCAqY3R4LAotIyMg
ICAgICAgICAgICAgICAgICAgIEluc24gKmluc24sCi0jIyAgICAgICAgICAgICAgICAgICAgUGFj
a2V0ICpwa3QpCisjIyAgICBzdGF0aWMgdm9pZCBnZW5lcmF0ZV9BMl9hZGQoRGlzYXNDb250ZXh0
ICpjdHgpCiAjIyAgICAgICB7CiAjIyAgICAgICAgICAgVENHdiBSZFYgPSB0Y2dfdGVtcF9sb2Nh
bF9uZXcoKTsKICMjICAgICAgICAgICBjb25zdCBpbnQgUmROID0gaW5zbi0+cmVnbm9bMF07CkBA
IC01ODQsMTIgKzU4MCwxMSBAQCBkZWYgZ2VucHRyX2RzdF93cml0ZV9vcG4oZixyZWd0eXBlLCBy
ZWdpZCwgdGFnKToKICMjICAgICAgIDxHRU4+ICBpcyBnZW5faGVscGVyX0EyX2FkZChSZFYsIGNw
dV9lbnYsIFJzViwgUnRWKTsKICMjCiBkZWYgZ2VuX3RjZ19mdW5jKGYsIHRhZywgcmVncywgaW1t
cyk6Ci0gICAgZi53cml0ZSgic3RhdGljIHZvaWQgZ2VuZXJhdGVfJXMoXG4iICV0YWcpCi0gICAg
Zi53cml0ZSgiICAgICAgICAgICAgICAgIENQVUhleGFnb25TdGF0ZSAqZW52LFxuIikKLSAgICBm
LndyaXRlKCIgICAgICAgICAgICAgICAgRGlzYXNDb250ZXh0ICpjdHgsXG4iKQotICAgIGYud3Jp
dGUoIiAgICAgICAgICAgICAgICBJbnNuICppbnNuLFxuIikKLSAgICBmLndyaXRlKCIgICAgICAg
ICAgICAgICAgUGFja2V0ICpwa3QpXG4iKQorICAgIGYud3JpdGUoInN0YXRpYyB2b2lkIGdlbmVy
YXRlXyVzKERpc2FzQ29udGV4dCAqY3R4KVxuIiAldGFnKQogICAgIGYud3JpdGUoJ3tcbicpCisK
KyAgICBmLndyaXRlKCIgICAgSW5zbiAqaW5zbiBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSA9IGN0
eC0+aW5zbjtcbiIpCisKICAgICBpZiBoZXhfY29tbW9uLm5lZWRfZWEodGFnKTogZ2VuX2RlY2xf
ZWFfdGNnKGYsIHRhZykKICAgICBpPTAKICAgICAjIyBEZWNsYXJlIGFsbCB0aGUgb3BlcmFuZHMg
KHJlZ3MgYW5kIGltbWVkaWF0ZXMpCi0tIAoyLjE3LjEKCg==

