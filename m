Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id 7E9C3190C0D
	for <lists+qemu-devel@lfdr.de>; Tue, 24 Mar 2020 12:10:59 +0100 (CET)
Received: from localhost ([::1]:46820 helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>)
	id 1jGhSU-0006bx-Jk
	for lists+qemu-devel@lfdr.de; Tue, 24 Mar 2020 07:10:58 -0400
Received: from eggs.gnu.org ([2001:470:142:3::10]:60773)
 by lists.gnu.org with esmtp (Exim 4.90_1)
 (envelope-from <yangke27@huawei.com>) id 1jGhQm-0004zQ-Of
 for qemu-devel@nongnu.org; Tue, 24 Mar 2020 07:09:14 -0400
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
 (envelope-from <yangke27@huawei.com>) id 1jGhQh-0004Sn-DW
 for qemu-devel@nongnu.org; Tue, 24 Mar 2020 07:09:12 -0400
Received: from szxga02-in.huawei.com ([45.249.212.188]:2512 helo=huawei.com)
 by eggs.gnu.org with esmtps (TLS1.0:DHE_RSA_AES_256_CBC_SHA1:32)
 (Exim 4.71) (envelope-from <yangke27@huawei.com>) id 1jGhQg-0004QI-RS
 for qemu-devel@nongnu.org; Tue, 24 Mar 2020 07:09:07 -0400
Received: from DGGEMM402-HUB.china.huawei.com (unknown [172.30.72.56])
 by Forcepoint Email with ESMTP id C92A1B319EC38950ECAC;
 Tue, 24 Mar 2020 19:08:55 +0800 (CST)
Received: from DGGEMM421-HUB.china.huawei.com (10.1.198.38) by
 DGGEMM402-HUB.china.huawei.com (10.3.20.210) with Microsoft SMTP Server (TLS)
 id 14.3.487.0; Tue, 24 Mar 2020 19:08:55 +0800
Received: from DGGEMM532-MBS.china.huawei.com ([169.254.8.60]) by
 dggemm421-hub.china.huawei.com ([10.1.198.38]) with mapi id 14.03.0487.000;
 Tue, 24 Mar 2020 19:08:47 +0800
From: "yangke (J)" <yangke27@huawei.com>
To: Jason Wang <jasowang@redhat.com>, "qemu-devel@nongnu.org"
 <qemu-devel@nongnu.org>
Subject: =?utf-8?B?562U5aSNOiBbcXVlc3Rpb25ddmhvc3QtdXNlcjogYXR1byBmaXggbmV0d29y?=
 =?utf-8?Q?k_link_broken_during_migration?=
Thread-Topic: [question]vhost-user: atuo fix network link broken during
 migration
Thread-Index: AdYA62Eje0lIFlEcTKSTWbnCiLhZ0AAcZrWAABvgYtA=
Date: Tue, 24 Mar 2020 11:08:47 +0000
Message-ID: <0CC1E03725E48D478F815032182740230A42C15B@DGGEMM532-MBS.china.huawei.com>
References: <0CC1E03725E48D478F815032182740230A42A312@DGGEMM532-MBS.china.huawei.com>
 <47abadbd-c559-1900-f3b1-3697f9e7c0b5@redhat.com>
In-Reply-To: <47abadbd-c559-1900-f3b1-3697f9e7c0b5@redhat.com>
Accept-Language: zh-CN, en-US
Content-Language: zh-CN
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [10.133.210.146]
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-CFilter-Loop: Reflected
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.2.x-3.x [generic]
 [fuzzy]
X-Received-From: 45.249.212.188
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Cc: "wangxin \(U\)" <wangxinxin.wang@huawei.com>,
 "quintela@redhat.com" <quintela@redhat.com>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: "Qemu-devel" <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>

PiA+IFdlIGZpbmQgYW4gaXNzdWUgd2hlbiBob3N0IG1jZSB0cmlnZ2VyIG9wZW52c3dpdGNoKGRw
ZGspIHJlc3RhcnQgaW4gDQo+ID4gc291cmNlIGhvc3QgZHVyaW5nIGd1ZXN0IG1pZ3JhdGlvbiwN
Cj4NCj4NCj4gRGlkIHlvdSBtZWFuIHRoZSB2aG9zdC11c2VyIG5ldGV2IHdhcyBkZWxldGVkIGZy
b20gdGhlIHNvdXJjZSBob3N0Pw0KDQoNClRoZSB2aG9zdC11c2VyIG5ldGV2IHdhcyBub3QgZGVs
ZXRlZCBmcm9tIHRoZSBzb3VyY2UgaG9zdC4gSSBtZWFuIHRoYXTvvJoNCmluIG5vcm1hbCBzY2Vu
YXJpbywgT1ZTKERQREspIGJlZ2luIHRvIHJlc3RhcnQsIHRoZW4gcWVtdV9jaHIgZGlzY29ubmVj
dCB0byBPVlMgYW5kIGxpbmsgc3RhdHVzIGlzIHNldCB0byBsaW5rIGRvd247IE9WUyhEUERLKSBz
dGFydGVkLCB0aGVuIHFlbXVfY2hyIHJlY29ubmVjdCB0byBPVlMgYW5kIGxpbmsgc3RhdHVzIGlz
IHNldCB0byBsaW5rIHVwLiBCdXQgaW4gb3VyIHNjZW5hcmlvLCBiZWZvcmUgcWVtdV9jaHIgcmVj
b25uZWN0IHRvIE9WUywgdGhlIFZNIG1pZ3JhdGUgaXMgZmluaXNoZWQuIFRoZSBsaW5rX2Rvd24g
b2YgZnJvbnRlbmQgd2FzIGxvYWRlZCBmcm9tIG4tPnN0YXR1cyBpbiBkZXN0aW5hdGlvbiwgaXQg
Y2F1c2UgdGhlIG5ldHdvcmsgaW4gZ3VzdCBuZXZlciBiZSB1cCBhZ2Fpbi4NCg0KcWVtdV9jaHIg
ZGlzY29ubmVjdDoNCiMwICB2aG9zdF91c2VyX3dyaXRlIChtc2c9bXNnQGVudHJ5PTB4N2ZmZjU5
ZWNiMmIwLCBmZHM9ZmRzQGVudHJ5PTB4MCwgZmRfbnVtPWZkX251bUBlbnRyeT0wLCBkZXY9MHgy
OTVjNzMwLCBkZXY9MHgyOTVjNzMwKQ0KICAgIGF0IC91c3Ivc3JjL2RlYnVnL3FlbXUta3ZtLTIu
OC4xL2h3L3ZpcnRpby92aG9zdF91c2VyLmM6MjM5DQojMSAgMHgwMDAwMDAwMDAwNGU2YmFkIGlu
IHZob3N0X3VzZXJfZ2V0X3ZyaW5nX2Jhc2UgKGRldj0weDI5NWM3MzAsIHJpbmc9MHg3ZmZmNTll
Y2I1MTApDQogICAgYXQgL3Vzci9zcmMvZGVidWcvcWVtdS1rdm0tMi44LjEvaHcvdmlydGlvL3Zo
b3N0X3VzZXIuYzo0OTcNCiMyICAweDAwMDAwMDAwMDA0ZTJlODggaW4gdmhvc3RfdmlydHF1ZXVl
X3N0b3AgKGRldj1kZXZAZW50cnk9MHgyOTVjNzMwLCB2ZGV2PXZkZXZAZW50cnk9MHgyY2EzNmMw
LCB2cT0weDI5NWM4OTgsIGlkeD0wKQ0KICAgIGF0IC91c3Ivc3JjL2RlYnVnL3FlbXUta3ZtLTIu
OC4xL2h3L3ZpcnRpby92aG9zdC5jOjEwMzYNCiMzICAweDAwMDAwMDAwMDA0ZTQ1YWIgaW4gdmhv
c3RfZGV2X3N0b3AgKGhkZXY9aGRldkBlbnRyeT0weDI5NWM3MzAsIHZkZXY9dmRldkBlbnRyeT0w
eDJjYTM2YzApDQogICAgYXQgL3Vzci9zcmMvZGVidWcvcWVtdS1rdm0tMi44LjEvaHcvdmlydGlv
L3Zob3N0LmM6MTU1Ng0KIzQgIDB4MDAwMDAwMDAwMDRiYzU2YSBpbiB2aG9zdF9uZXRfc3RvcF9v
bmUgKG5ldD0weDI5NWM3MzAsIGRldj1kZXZAZW50cnk9MHgyY2EzNmMwKQ0KICAgIGF0IC91c3Iv
c3JjL2RlYnVnL3FlbXUta3ZtLTIuOC4xL2h3L25ldC92aG9zdF9uZXQuYzozMjYNCiM1ICAweDAw
MDAwMDAwMDA0YmNjM2IgaW4gdmhvc3RfbmV0X3N0b3AgKGRldj1kZXZAZW50cnk9MHgyY2EzNmMw
LCBuY3M9PG9wdGltaXplZCBvdXQ+LAl0b3RhbF9xdWV1ZXM9NCkNCiAgICBhdCAvdXNyL3NyYy9k
ZWJ1Zy9xZW11LWt2bS0yLjguMS9ody9uZXQvdmhvc3RfbmV0LmM6NDA3DQojNiAgMHgwMDAwMDAw
MDAwNGI4NWY2IGluIHZpcnRpb19uZXRfdmhvc3Rfc3RhdHVzIChuPW5AZW50cnk9MHgyY2EzNmMw
LAlzdGF0dXM9c3RhdHVzQGVudHJ5PTcgJ1xhJykNCiAgICBhdCAvdXNyL3NyYy9kZWJ1Zy9xZW11
LWt2bS0yLjguMS9ody9uZXQvdmlydGlvX25ldC5jOjE3Nw0KIzcgIDB4MDAwMDAwMDAwMDRiODY5
ZiBpbiB2aXJ0aW9fbmV0X3NldF9zdGF0dXMgKHZkZXY9PG9wdGltaXplZCBvdXQ+LCBzdGF0dXM9
PG9wdGltaXplZCBvdXQ+KQ0KICAgIGF0IC91c3Ivc3JjL2RlYnVnL3FlbXUta3ZtLTIuOC4xL2h3
L25ldC92aXJ0aW9fbmV0LmM6MjQzDQojOCAgMHgwMDAwMDAwMDAwNzNkMDBkIGluIHFtcF9zZXRf
bGluayAobmFtZT1uYW1lQGVudHJ5PTB4Mjk1NmQ0MCAiaG9zdG5ldDAiLCB1cD11cEBlbnRyeT1m
YWxzZSwgZXJycD1lcnJwQGVudHJ5PTB4N2ZmZjU5ZWNkNzE4KQ0KICAgIGF0IG5ldC9uZXQuYzox
NDM3DQojOSAgMHgwMDAwMDAwMDAwNzQ2MGMxIGluIG5ldF92aG9zdF91c2VyX2V2ZW50IChvcGFx
dWU9MHgyOTU2ZDQwLCBldmVudD00KSBhdCBuZXQvdmhvc3RfdXNlci5jOjIxNy8vcWVtdV9jaHJf
YmVfZXZlbnQNCiMxMCAweDAwMDAwMDAwMDA1NzRmMGQgaW4gdGNwX2Nocl9kaXNjb25uZWN0IChj
aHI9MHgyOTUxYTQwKSBhdCBxZW11X2NoYXIuYzozMjIwDQojMTEgMHgwMDAwMDAwMDAwNTc1MTFm
IGluIHRjcF9jaHJfaHVwIChjaGFubmVsPTxvcHRpbWl6ZWQgb3V0PiwJY29uZD08b3B0aW1pemVk
IG91dD4sIG9wYXF1ZT08b3B0aW1pemVkIG91dD4pIGF0IHFlbXVfY2hhci5jOjMyNjUNCg0KDQo+
DQo+DQo+ID4gVk0gaXMgc3RpbGwgbGluayBkb3duIGluIGZyb250ZW5kIGFmdGVyIG1pZ3JhdGlv
biwgaXQgY2F1c2UgdGhlIG5ldHdvcmsgaW4gVk0gbmV2ZXIgYmUgdXAgYWdhaW4uDQo+ID4NCj4g
PiB2aXJ0aW9fbmV0X2xvYWRfZGV2aWNlOg0KPiA+ICAgICAgLyogbmMubGlua19kb3duIGNhbid0
IGJlIG1pZ3JhdGVkLCBzbyBpbmZlciBsaW5rX2Rvd24gYWNjb3JkaW5nDQo+ID4gICAgICAgKiB0
byBsaW5rIHN0YXR1cyBiaXQgaW4gbi0+c3RhdHVzICovDQo+ID4gICAgICBsaW5rX2Rvd24gPSAo
bi0+c3RhdHVzICYgVklSVElPX05FVF9TX0xJTktfVVApID09IDA7DQo+ID4gICAgICBmb3IgKGkg
PSAwOyBpIDwgbi0+bWF4X3F1ZXVlczsgaSsrKSB7DQo+ID4gICAgICAgICAgcWVtdV9nZXRfc3Vi
cXVldWUobi0+bmljLCBpKS0+bGlua19kb3duID0gbGlua19kb3duOw0KPiA+ICAgICAgfQ0KPiA+
DQo+ID4gZ3VzZXQ6ICAgICAgICAgICAgICAgbWlncmF0ZSBiZWdpbiAtLS0tLT4gdkNQVSBwYXVz
ZSAtLS0+IHZtc2F0ZSBsb2FkIC0tLT4gbWlncmF0ZSBmaW5pc2gNCj4gPiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgXiAgICAgICAgICAgICAgICBeICAgICAgICAgICAgICAg
IF4NCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAg
ICAgICB8ICAgICAgICAgICAgICAgIHwNCj4gPiBvcGVudnN3aXRjaCBpbiBzb3VyY2UgaG9zdDog
ICBiZWdpbiB0byByZXN0YXJ0ICAgcmVzdGFydGluZyAgICAgICAgc3RhcnRlZA0KPiA+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBeICAgICAgICAgICAgICAgIF4gICAgICAg
ICAgICAgICAgXg0KPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAg
ICAgICAgICAgICAgIHwgICAgICAgICAgICAgICAgfA0KPiA+IG5jIGluIGZyb250ZW5kIGluIHNv
dXJjZTogICAgICAgIGxpbmsgZG93biAgICAgICAgbGluayBkb3duICAgICAgICBsaW5rIGRvd24N
Cj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXiAgICAgICAgICAgICAg
ICBeICAgICAgICAgICAgICAgIF4NCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgfCAgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgIHwNCj4gPiBuYyBpbiBmcm9u
dGVuZCBpbiBkZXN0aW5hdGlvbjogICBsaW5rIHVwICAgICAgICAgIGxpbmsgdXAgICAgICAgICAg
bGluayBkb3duDQo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF4gICAg
ICAgICAgICAgICAgXiAgICAgICAgICAgICAgICBeDQo+ID4gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHwgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICB8DQo+ID4g
Z3VzZXQgbmV0d29yazogICAgICAgICAgICAgICAgICAgIGJyb2tlbiAgICAgICAgICAgYnJva2Vu
ICAgICAgICAgICBicm9rZW4NCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXiAgICAgICAgICAgICAgICBeICAgICAgICAgICAgICAgIF4NCj4gPiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAg
IHwNCj4gPiBuYyBpbiBiYWNrZW5kIGluIHNvdXJjZTogICAgICAgICBsaW5rIGRvd24gICAgICAg
IGxpbmsgZG93biAgICAgICAgbGluayB1cA0KPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBeICAgICAgICAgICAgICAgIF4gICAgICAgICAgICAgICAgXg0KPiA+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgIHwgICAgICAg
ICAgICAgICAgfA0KPiA+IG5jIGluIGJhY2tlbmQgaW4gZGVzdGluYXRpb246ICAgIGxpbmsgdXAg
ICAgICAgICAgbGluayB1cCAgICAgICAgICBsaW5rIHVwDQo+ID4NCj4gPiBUaGUgbGlua19kb3du
IG9mIGZyb250ZW5kIHdhcyBsb2FkZWQgZnJvbSBuLT5zdGF0dXMsIG4tPnN0YXR1cyBpcyBsaW5r
IA0KPiA+IGRvd24gaW4gc291cmNlLCBzbyB0aGUgbGlua19kb3duIG9mIGZyb250ZW5kIGlzIHRy
dWUuIFRoZSBiYWNrZW5kIGluIA0KPiA+IGRlc3RpbmF0aW9uIGhvc3QgaXMgbGluayB1cCwgYnV0
IHRoZSBmcm9udGVuZCBpbiBkZXN0aW5hdGlvbiBob3N0IGlzIGxpbmsgZG93biwgaXQgY2F1c2Ug
dGhlIG5ldHdvcmsgaW4gZ3VzdCBuZXZlciBiZSB1cCBhZ2FpbiB1bnRpbCBhbiBndWVzdCBjb2xk
IHJlYm9vdC4NCj4gPg0KPiA+IElzIHRoZXJlIGEgd2F5IHRvIGF1dG8gZml4IHRoZSBsaW5rIHN0
YXR1cz8gb3IganVzdCBhYm9ydCB0aGUgbWlncmF0aW9uIGluIHZpcnRpbyBuZXQgZGV2aWNlIGxv
YWQ/DQo+DQo+DQo+IE1heWJlIHdlIGNhbiB0cnkgdG8gc3luYyBsaW5rIHN0YXR1cyBhZnRlciBt
aWdyYXRpb24/DQo+DQo+IFRoYW5rcw0KDQoNCkluIGV4dHJlbWUgc2NlbmFyaW8sIGFmdGVyIG1p
Z3JhdGlvbiB0aGUgT1ZTKERQREspIGluIHNvdXJjZSBtYXkgYmUgc3RpbGwgbm90IHN0YXJ0ZWQu
DQoNCg0KT3VyIHBsYW4gaXMgdG8gY2hlY2sgdGhlIGxpbmsgc3RhdGUgb2YgYmFja2VuZCB3aGVu
IGxvYWQgdGhlIGxpbmtfZG93biBvZiBmcm9udGVuZC4NCiAgICAgLyogbmMubGlua19kb3duIGNh
bid0IGJlIG1pZ3JhdGVkLCBzbyBpbmZlciBsaW5rX2Rvd24gYWNjb3JkaW5nDQogICAgICAqIHRv
IGxpbmsgc3RhdHVzIGJpdCBpbiBuLT5zdGF0dXMgKi8NCi0gICAgbGlua19kb3duID0gKG4tPnN0
YXR1cyAmIFZJUlRJT19ORVRfU19MSU5LX1VQKSA9PSAwOw0KKyAgICBpZiAocWVtdV9nZXRfcXVl
dWUobi0+bmljKS0+cGVlci0+aW5mby0+dHlwZSA9PSBORVRfQ0xJRU5UX0RSSVZFUl9WSE9TVF9V
U0VSKSB7DQorICAgICAgICBsaW5rX2Rvd24gPSAobi0+c3RhdHVzICYgVklSVElPX05FVF9TX0xJ
TktfVVAgfCAhcWVtdV9nZXRfcXVldWUobi0+bmljKS0+cGVlci0+bGlua19kb3duKSA9PSAwOw0K
KyAgICB9IGVsc2Ugew0KKyAgICAgICAgbGlua19kb3duID0gKG4tPnN0YXR1cyAmIFZJUlRJT19O
RVRfU19MSU5LX1VQKSA9PSAwOw0KKyAgICB9DQogICAgIGZvciAoaSA9IDA7IGkgPCBuLT5tYXhf
cXVldWVzOyBpKyspIHsNCiAgICAgICAgIHFlbXVfZ2V0X3N1YnF1ZXVlKG4tPm5pYywgaSktPmxp
bmtfZG93biA9IGxpbmtfZG93bjsNCiAgICAgfQ0KDQpJcyBnb29kIGVub3VnaCB0byBhdXRvIGZp
eCB0aGUgbGluayBzdGF0dXM/DQoNClRoYW5rcw0K

